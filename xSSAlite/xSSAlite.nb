(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    274959,       6790]
NotebookOptionsPosition[    265939,       6490]
NotebookOutlinePosition[    266499,       6510]
CellTagsIndexPosition[    266456,       6507]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[StyleBox["xSSAlite.nb",
 FontSize->36]], "Subtitle",
 CellChangeTimes->{{3.455473454395235*^9, 3.45547345512598*^9}, {
  3.508522922219301*^9, 3.508522922616919*^9}}],

Cell[TextData[{
 StyleBox[" ",
  FontSize->16],
 StyleBox["Filename:\txSSAlite.nb\n Description:\tStochastic Biochemcial \
Simulator for ",
  FontSize->12],
 StyleBox["Mathematica",
  FontSize->12,
  FontSlant->"Italic"],
 StyleBox["\n Organization: \tCaltech Biological Network Modeling Center\n \
License: \tGPL \n \nThis notebook is free software; you can redistribute it \
and/or modify it under the terms of the GNU  General Public License as \
published by the Free Software Foundation; either version 3.0 of the License, \
or any later version.\n\nSee",
  FontSize->12],
 ButtonBox[" http://creativecommons.org/licenses/LGPL/2.1/ ",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://creativecommons.org/licenses/LGPL/2.1/"], None},
  ButtonNote->"http://creativecommons.org/licenses/LGPL/2.1/"],
 StyleBox["for a copy of the license.\n \nThis library is distributed in the \
hope that it will be useful, but WITHOUT ANY WARRANTY, WITHOUT EVEN THE \
IMPLIED WARRANTY OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.  The \
software and  documentation provided hereunder is on an \"as is\" basis, and \
both the developers and California Institute of Technology have no obligation \
to provide maintenance, support, updates, enhancements or modifications.  In \
no event shall either the developers or the California Institute of \
Technology be liable to any party for direct, indirect, special, incidental \
or consequential damages, including lost profits, arising  out of the use of \
this software and its documentation, even if the developers or California \
Institute of Technology have been advised of the possibility of such damage.\n\
\n The original code contained here was initially developed by:\n\n \tBruce \
E. Shapiro\n \tBiological Network Modeling Center\n \tThe Beckman Institute \
at Caltech\n \tMail Code 139-74\n \tCalifornia Institute of Technology\n \t\
Pasadena, CA, 91125-7400, USA\n \n Reference for original ssa algorithm:\n \n\
(1) Gillespie DT (1977) Exact Stochastic Simulation of Coupled Chemical \
Reactions, J. Physical Chem. 81(25):2340-2361\n\nReference for extended SSA \
algorithm:\n\n(2) TR- Under development\n\nThis file has been developed and \
tested in ",
  FontSize->12],
 StyleBox["Mathematica",
  FontSize->12,
  FontSlant->"Italic"],
 StyleBox[" Verison 7 and 8 and may not work under earlier or later versions. \
",
  FontSize->12]
}], "Text",
 CellChangeTimes->{{3.442865446124479*^9, 3.442865446680416*^9}, {
   3.442865493336697*^9, 3.442865622681231*^9}, {3.446309325306012*^9, 
   3.446309365266209*^9}, {3.455473458351225*^9, 3.455473458944656*^9}, {
   3.4559846910712957`*^9, 3.4559847311227283`*^9}, {3.4622046932170143`*^9, 
   3.462204694018691*^9}, {3.508522925697897*^9, 3.508522926073139*^9}, {
   3.529776567449328*^9, 3.529776578161333*^9}, {3.5593035364842043`*^9, 
   3.559303549882123*^9}, 3.559303812705681*^9},
 FontSize->10,
 Background->None],

Cell[CellGroupData[{

Cell["Begin, Needs", "Section",
 CellChangeTimes->{{3.457441156135787*^9, 3.457441158083991*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"BeginPackage", "[", "\"\<xSSA`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.427493864302244*^9, 3.427493868001633*^9}, {
   3.442695316276213*^9, 3.442695316715841*^9}, 3.4554732601429653`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"$xSSA$Version", " ", "=", " ", "\"\<1.3.2\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwdz21I01EYBfAxVr6sRAp0JdlmIVGW2iLSwX+7BbFWqZWJYZCOjGq2TYpm
LLacNbfMWbOgkWhhzVqbVBi9GG5plHMp1dyijKUVtbso7UVzmtF97ofDj/Pt
HIFctb2czWKxlpOAjMzGO2TGiN/USm30X1kESjgFqeDxuZ8tCjtGR+acawD/
pHFU94mtWRuo+4Q/HriJtzJiH4KHS/KNjW0YpTsuUV+KvcoQcTUzRd013TH7
9nWMchfzY0CP0SzIvIFRtfUbVePTC+4Q+XtqqO2O6rKdDoxWbp2gfoqxjXQS
1w39phazU7XZNzGq615CZQ92vkl3YvSTK34LZujjmLvEhQWFVA9nVDNN7PUs
qwJ5kqWueBdGUjNDrZ2cz2wmXq1UUU/r3f19XRipkfMFyFH9U7jdpPu2KcHm
nNqZKHTNR2rwizea4iF74ldNgcHSsor9xBCzVw12FXGb6roxKn0ko4ZfJ0rU
PvL3SS/1aezlpJTnGBXp+6gJyTlVJ/oxsoTzqYF3Qd15onQ4QnX+3aE78wqj
xPdhqqmk457Qj9HBlii1Yrchd5h4VHxBBK5tCI+YBjEa6NF9AF152nF5AKN5
45kTIJ93bFKYFkEiR2UUlOe1Se3E7/bkTeCowVLuJfJN16gJp2bqfxHtTest
4Flr0sWaLRFklPXYwBWK9mZucQTNUmpbQOuBsazAyQhawFJng4/rDSKwMO4Z
VekPDA1s/IrWjHFC4H+PMmdl
  "]],

Cell[BoxData[
 RowBox[{"Needs", "[", 
  "\"\<DifferentialEquations`InterpolatingFunctionAnatomy`\>\"", 
  "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.444757532742412*^9, 3.444757541818031*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"Names", "[", "\"\<FLAGS`ECHOLOAD\>\"", "]"}], "]"}], ">", 
     "0"}], ",", "\[IndentingNewLine]", 
    RowBox[{"xSSA`Private`msgflag", "=", 
     RowBox[{"ToExpression", "[", "\"\<FLAGS`ECHOLOAD\>\"", "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"xSSA`Private`msgflag", "=", "True"}], ";"}]}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FLAGS`ECHOLOAD", "=", "False"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "insert", " ", "any", " ", "loads", " ", "that", " ", "you", " ", "want", 
    " ", "to", " ", "keep", " ", "quiet", " ", "here"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FLAGS`ECHOLOAD", "=", "xSSA`Private`msgflag"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.457441060933208*^9, 3.457441125878078*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["xSSAlite Revision Log", "Section",
 CellChangeTimes->{{3.4554733171941223`*^9, 3.455473318551916*^9}, {
  3.508522975264619*^9, 3.5085229756633663`*^9}}],

Cell["\<\

1.3.2 (5 Jan 2016) cadlag correction of SSA and appending final value for \
premature end of trajectory
1.3.1 (11/11/12) Allow ShortRightArrow as wellas Rule for Mass Action 
1.3.0 - (10/15/2012) return to earlier versioning system as the ymd was \
confusing
12.01.1 - change in version numbering: 12.01.1 means 2012/January/First \
Revision. Minor changes in install script.
1.2.02 11.8.11 - SSAMean: allow input to be interpolating functions. New \
option \[OpenCurlyDoubleQuote]Rates\[CloseCurlyDoubleQuote] on SSAMean \
includes \[OpenCurlyDoubleQuote]MeanRates\[CloseCurlyDoubleQuote] on output. \
New function PlotStats, (SSAMean --> PlotStats) produces plot with +/- 1 \
sigma envelope.
1.2.01 3/8/11 (a) change BoundComplex to Diamond[a,b] uniformly for \
consistency; (b) include ExpandReaction in SSAtoXLR8R Catch-all for mass \
action.
1.2.01 3/7/11  fork from xSSA-1.2.01 - to only include Cellerator Mass Action \
Reactions and not other Cellerator arrows \
\>", "Text",
 CellChangeTimes->{{3.427494111044536*^9, 3.427494121737145*^9}, {
   3.427496587270049*^9, 3.427496595029597*^9}, {3.442861766186744*^9, 
   3.442861831411569*^9}, {3.443207253523873*^9, 3.443207286734915*^9}, {
   3.443211973091017*^9, 3.443211984202463*^9}, {3.443462025244989*^9, 
   3.443462026171533*^9}, {3.44346329041478*^9, 3.443463396691101*^9}, {
   3.443887424286532*^9, 3.443887499292871*^9}, {3.444412659878309*^9, 
   3.444412679319146*^9}, {3.444413411692148*^9, 3.444413424120459*^9}, {
   3.444856921859857*^9, 3.444856941742273*^9}, {3.44495687834283*^9, 
   3.444956934221539*^9}, {3.44519977706261*^9, 3.445199794822202*^9}, {
   3.445700309387826*^9, 3.44570031615824*^9}, {3.445706008102658*^9, 
   3.445706039151218*^9}, {3.446135682521677*^9, 3.446135698461945*^9}, {
   3.446135747357192*^9, 3.446135748443859*^9}, {3.446166980366105*^9, 
   3.446167010081027*^9}, {3.446167043748241*^9, 3.446167062582361*^9}, {
   3.446167124290015*^9, 3.44616712932725*^9}, {3.446299131552359*^9, 
   3.44629914386742*^9}, {3.446303579478149*^9, 3.446303584752823*^9}, {
   3.446309291458226*^9, 3.446309303784496*^9}, {3.455473293413197*^9, 
   3.455473344282539*^9}, {3.455984641733183*^9, 3.455984677217434*^9}, {
   3.456098737428193*^9, 3.45609893875809*^9}, {3.456164484001355*^9, 
   3.456164529621035*^9}, {3.456165957933104*^9, 3.456165971715777*^9}, {
   3.4561660720853777`*^9, 3.4561660777680483`*^9}, {3.456167404700532*^9, 
   3.456167413805401*^9}, {3.456324672423585*^9, 3.456324703362892*^9}, {
   3.457440973173437*^9, 3.457440985782132*^9}, {3.462204357961204*^9, 
   3.462204378729495*^9}, {3.462453390399083*^9, 3.462453402481082*^9}, {
   3.462453493759068*^9, 3.462453496162095*^9}, {3.462537050852581*^9, 
   3.462537075828944*^9}, {3.463185349600539*^9, 3.463185359344904*^9}, {
   3.463226343701417*^9, 3.463226354759712*^9}, {3.463242342820484*^9, 
   3.4632423838185263`*^9}, {3.466180694715489*^9, 3.466180723157495*^9}, {
   3.466528592281889*^9, 3.466528627184577*^9}, {3.466873371411684*^9, 
   3.466873396182562*^9}, {3.507593103583325*^9, 3.507593142524335*^9}, {
   3.507985726945415*^9, 3.50798574409501*^9}, {3.5085229834108953`*^9, 
   3.508523029782686*^9}, 3.508524065830824*^9, {3.508592545577004*^9, 
   3.5085925628389273`*^9}, 3.529776273260406*^9, {3.535822084374051*^9, 
   3.5358221257482777`*^9}, {3.535822174696168*^9, 3.5358221788843927`*^9}, {
   3.559303594523013*^9, 3.559303636689118*^9}, {3.5616563125157127`*^9, 
   3.56165633164835*^9}, {3.661002483746134*^9, 3.6610025222658367`*^9}, {
   3.661002557062615*^9, 3.6610025594430304`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Entry Points", "Section"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SSA", "::", "usage"}], "=", 
    RowBox[{
    "\"\<SSA[reactions, tmax, initialConditiosn]\\nSSA[reactions, tmax, \
initialConditions, rates]\\nSSA[reactions, tmax, initialConditions, rates, \
MaxSteps:10^6]\\nSSA[reactions, {tmin,tmax}, initialConditions, rates, \
MaxSteps:10^6]\\nSSA[reactions, tmax]\\nSSA[reactions]\\n\\nreactions is \
{\!\(\*SubscriptBox[\(r\), \(1\)]\),\!\(\*SubscriptBox[\(r\), \(2\)]\),...,\!\
\(\*SubscriptBox[\(r\), \(n\)]\)} where (in BNF) each \
\\n\!\(\*SubscriptBox[\(r\), \(\(i\)\(\\\ \
\)\)]\)::={\!\(\*SubscriptBox[\(R\), \(1\)]\)[+\!\(\*SubscriptBox[\(R\), \
\(2\)]\)]\[Rule]\!\(\*SubscriptBox[\(R\), \(3\)]\)[+\!\(\*SubscriptBox[\(R\), \
\(4\)]\)] [,k]}\\nIf omitted, k defaults to 1.\\nReactions {0\[Rule]A, k} or \
{A\[Rule]0, k} [or {\[EmptySet]\[Rule]A,k}, {A\[Rule]\[EmptySet],k}] \
designate creation and annihilation.\\nHigher order reactions (e.g., \
trimolecular) are not \
supported.\\n\\nOptions:\\n\\\"MaxSteps\\\"->10^6\\n\\\"Mode\\\"\[Rule]\\\"\
List\\\" (list of every calculation),\\n\\\"Mode\\\"\[Rule]\\\"SparseList\\\" \
(list only when there are \
changes),\\n\\\"Mode\\\"\[Rule]\\\"Interpolation\\\" (fit interpolation \
function to results),\\n\\\"Mode\\\"\[Rule]\\\"Table\\\" (return a \
rectangular table of values as a \
list),\\n\\\"Mode\\\"\[Rule]\\\"TableFile\\\" (Save a table of values to a \
file), \\n\\\"Mode\\\"\[Rule]\\\"Variable\\\" (return a list of {t,X} \
values), \\n\\\"Mode\\\"\[Rule]\\\"Variables\\\" (return a list of \
{t,X1,X2,...} values) \\n\\\"OutputVariable\\\"\[Rule]variablename (for \
\\\"Mode\\\"\[Rule]\\\"Variable\\\")\\n\\\"Variables\\\"\[Rule]{var1,var2,...}\
 (for \\\"Mode\\\"\[Rule]\\\"Variables\\\".\\n\\\"Sample\\\"\[Rule]1 (only \
output if this many calculations have occurred since the last output). \
\\n\\\"Summary\\\"\[Rule]True (Print a summary message when done).\>\"", 
     "<>", 
     "\"\<\\n\\\"Summarize\\\"\[Rule]False, Print a more detailed summary \
(final time, values, transitions)\\n\\\"Rates\\\"\[Rule]{}, List of numbers \
between zero and 1, will calculate least squares fit of (dv/dt) in  V = V0 + \
(dV/dt) * t for each variable using the last fraction of data specified; .5 = \
use last 50%; 1 = use all data; only valid if the production rate is in the \
steady state (linear) range. Requires \\\"Summarize\\\" and \\\"Mode\\\"\
\[Rule]\\\"Variables\\\". Value of Rates will be ignored if a value is used \
for SteadyStateStart.\>\"", "<>", 
     "\"\<\\n\\\"SteadyStateStart\\\"\[Rule]\[Infinity], time value when to \
start estimating steady state and rates in \\\"variables\\\" mode\>\"", "<>", 
     "\"\<\\n\\\"TimeCourse\\\"\[Rule]True, when False, suppresses return of \
timecourse data (typically used when only the summary is wanted).\>\""}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SSAPlot", "::", "usage"}], "=", 
   "\"\<SSAPlot[solution, variable, options]\\nSSAPlot[solution, {variables}, \
options]\\n\\nOptions: SSAPlotType, SSAPlotStyles, any option for \
ListPlot\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SSALinePlot", "::", "usage"}], "=", 
   "\"\<SSALinePlot[solution, variable, options]\\nSSALinePlot[solution, \
{variables}, options]\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SSADotPlot", "::", "usage"}], "=", 
   "\"\<SSADotPlot[solution, variable, options]\\nSSADotPlot[solution, \
{variables}, options]\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SSAPhasePlot", "::", "usage"}], "=", 
    "\"\<SSAPhasePlot[solution, {X,Y}, OptionalGraphicsDirectives] \
\\nSSAPhasePlot[solution, {X,Y}, Options]\\nSSAPhasePlot[solution, {X,Y}, \
\\\"Directives\\\"\[Rule]{dir,...}] is equivalent to SSAPhasePlot[solution, \
{X,Y}, dir], where dir is a list of Graphics Directives. Any valid option for \
Graphics may be used.\>\""}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SSAPhaseCurve", "::", "usage"}], "=", 
    "\"\<SSAPhaseCurve[solution, {X,Y}, OptionalGraphicsDirectives] is \
equivalent to SSAPhasePlot[solution, {X,Y}, Axes\[Rule]False, \
\\\"Directives\\\"\[Rule]OptionalGraphicsDirectives]\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SSAPlotStyles", "::", "usage"}], "=", 
    "\"\<An option for SSAPlot. A list of values for PlotStyle, when multiple \
variables are being plotted on the same figure. If omitted, random hues are \
used to color the curves.\>\""}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"SSAPhaseCurveData", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"SSAPhaseArrayPlot", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
   " ", "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SSAMean", "::", "usage"}], "=", 
   "\"\<SSAMean[simulation,tmax, options]\\n\\nReturns a list of \
interpolations of the mean and standard deviation of the data. The simulation \
\\\"Mode\\\" should  either be not specified in SSA, or selected as \
\\\"Interpolation\\\". The output is returned in the form \
\\n\\n{\\\"Means\\\"{variable\[Rule]InterpolatingFunction[...], variable\
\[Rule]...}, \\n\\\"StandardDeviations\\\"\[Rule]{ ... \
}\\n\\\"MeanPlusSigma\\\"\[Rule]{ ... }\\n\\\"MeanMinusSigma\[Rule]{ ... }, \
...}\\n\\nOptions:\\n\\n\\\"Rates\\\"\[Rule]False, If True, includes \
\\\"MeanRates\\\" as variables \[Delta]var\[Delta]t for each variable var.\\n\
\\\"Points\\\"\[Rule]100, number of points to calculate the statistics at. \
The statistics are interpolated at n equally spaced intervals. \>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SSAFit", "::", "usage"}], "=", 
   "\"\<SSAFit[simulations,tmax]\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PlotStats", "::", "usage"}], "=", 
    "\"\<PlotStats[var, stats, options]\\n\\nPlots the mean and +/- one-sigma \
shaded envelope.\\n\\nstats is the output of SSAMean\\nvar is any variable in \
the simulation\\noptions are any options for \
Plot\\n\\nExample:\\nsimlations=Table[SSA[... simulation parameters \
...],{1000}];\\nmystats=SSAMean[simulations];\\nPlotStats[X, mystats, \
PlotStyle -> {{ Red}, { Red}, {Thick, Red}}, FillingStyle -> Lighter[Pink]]\>\
\""}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SSAPlotType", "::", "usage"}], "=", 
   "\"\<An option for SSAPlot, values are \\\"Line\\\", \\\"Dot\\\". \>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "SSAPlot", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"SSAPlotStyles", "\[Rule]", " ", "Automatic"}], ",", " ", 
      RowBox[{"SSAPlotType", "\[Rule]", " ", "\"\<Line\>\""}]}], "}"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ExpandReactions", "::", "usage"}], "=", 
    "\"\<ExpandReactions[{r1,r2, ...}] returns the list of base reactions \
that the list of input reactions is reduced to by ExpandReaction. \>\""}], 
   ";"}], " ", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ExpandReaction", "::", "usage"}], "=", 
    "\"\<ExpandReaction[reaction] returns  the list of base reactions that \
the high level reaction represets, for example, ExpandReaction[{A\
\[RightArrowLeftArrow]B, kf, kr}] returns \
{{A\[Rule]B,kf},{B\[Rule]A,kr}}.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UmbralPower", "::", "usage"}], "=", "\"\<\>\""}], ";"}]}], "Input",\

 InitializationCell->True,
 CellChangeTimes->{
  3.427494457885914*^9, {3.442699198393879*^9, 3.442699225404162*^9}, {
   3.442699474742008*^9, 3.442699479514509*^9}, {3.442715198729712*^9, 
   3.442715206640276*^9}, {3.442858791298436*^9, 3.442858813755464*^9}, {
   3.44285923194452*^9, 3.442859347972819*^9}, {3.442859715707811*^9, 
   3.442859743844819*^9}, {3.442863938510693*^9, 3.442863939940148*^9}, {
   3.442864735128131*^9, 3.442864829680919*^9}, {3.442864875487553*^9, 
   3.44286509727775*^9}, {3.443207165153766*^9, 3.443207168866301*^9}, {
   3.443209613258804*^9, 3.443209618662565*^9}, {3.443210704678034*^9, 
   3.443210714326411*^9}, 3.443210774801692*^9, {3.443211932605059*^9, 
   3.443211965239298*^9}, {3.443277142045322*^9, 3.443277151443409*^9}, {
   3.443278063624461*^9, 3.443278128376484*^9}, {3.443278176017219*^9, 
   3.443278294737638*^9}, {3.443278500282951*^9, 3.443278509426575*^9}, {
   3.443278928117314*^9, 3.443278952331863*^9}, {3.443278982652559*^9, 
   3.443279016393393*^9}, {3.44327921862244*^9, 3.44327922233771*^9}, {
   3.443280421674628*^9, 3.44328043986828*^9}, {3.443297668555257*^9, 
   3.443297676405879*^9}, {3.4433014393604*^9, 3.443301444383301*^9}, {
   3.443301512555016*^9, 3.443301610965837*^9}, {3.443462037589422*^9, 
   3.443462048651234*^9}, {3.443462111232901*^9, 3.443462171598004*^9}, {
   3.443462733229647*^9, 3.443462818921478*^9}, {3.443462867010123*^9, 
   3.44346299766025*^9}, {3.443463119472841*^9, 3.443463253887061*^9}, {
   3.443888969483601*^9, 3.443888990919766*^9}, {3.444154899721193*^9, 
   3.444155007329365*^9}, {3.444155590834093*^9, 3.444155597713456*^9}, {
   3.444157555657697*^9, 3.444158019025695*^9}, {3.44415805623965*^9, 
   3.444158210180224*^9}, {3.444478231095536*^9, 3.444478240385774*^9}, {
   3.444747045131124*^9, 3.444747085038434*^9}, {3.444748681325004*^9, 
   3.444748863500333*^9}, {3.444749124965438*^9, 3.444749223973566*^9}, {
   3.444756511466855*^9, 3.444756519383762*^9}, {3.444756606200599*^9, 
   3.444756609997685*^9}, {3.444781595436168*^9, 3.444781599152207*^9}, {
   3.444781935544785*^9, 3.444781939971821*^9}, {3.44614570831758*^9, 
   3.446145710383328*^9}, {3.446145791483828*^9, 3.44614579483869*^9}, {
   3.44629868802918*^9, 3.446298703161757*^9}, {3.456167587817917*^9, 
   3.456167638899274*^9}, {3.4631853020101423`*^9, 3.4631853088655767`*^9}, {
   3.463241829866057*^9, 3.4632419390791483`*^9}, {3.463241980237145*^9, 
   3.463242013066659*^9}, {3.463242050773543*^9, 3.4632421178655577`*^9}, {
   3.463242167542891*^9, 3.46324224106913*^9}, {3.463242272956697*^9, 
   3.463242288934307*^9}, {3.4661793581259317`*^9, 3.466179586337803*^9}, {
   3.507827421424363*^9, 3.5078274939875927`*^9}, {3.50789984837705*^9, 
   3.5078999163494453`*^9}, {3.507901584397546*^9, 3.507901628581348*^9}, {
   3.508523985747612*^9, 3.508524050802372*^9}, 3.529776301078351*^9, {
   3.6610024154768343`*^9, 3.6610024304188757`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"XLR8RtoSSA", "::", "usage"}], "=", 
    "\"\<XLR8RtoSSA[{r1,r2,...}] where r1, r2, ... are each cellerator \
reactions returns a list of SSA-compatible reactions.\\nXLR8RtoSSA[{reaction, \
rates}] converts a single reaction from xlr8r format to SSA format, e.g., \
XLR8RtoSSA[{A+B\[Rule]C, k}]\\nAny unidentifable (or unimplemented) reactions \
are returned as Indeterminate[reaction].\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SSAtoXLR8R", "::", "usage"}], "=", 
    "\"\<SSAtoXLR8R[{r1,r2, ..}] returns a list of reactions  in Cellerator \
format.\\nSSAtoXLR8R[{reaction, rates} converts a single reaction from SSA \
format to xlr8r format, e.g., SSAtoXLR8R[{A+B\[Rule]C, k}]\>\""}], ";"}], 
  " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.444144417900294*^9, 3.444144487363729*^9}, {
  3.444413591903403*^9, 3.44441369942104*^9}, {3.445701251519517*^9, 
  3.445701326203492*^9}, {3.445705915925894*^9, 3.445705933443067*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SSASave", "::", "usage"}], "=", 
    RowBox[{
    "\"\<SSASave[model, options] converts the model to xlr8r form and saves \
it as CelleratorML. An interactive file name dialog will be opened to \
determine the output file name. The file can be read back in and \
automatically converted to SSA form using SSAGet.\\n\>\"", "<>", 
     "\"\<\\nSSASave[filename, model, options] will open the specified file\>\
\"", "<>", "\"\<\\nOptions:\>\"", "<>", "\[IndentingNewLine]", 
     "\"\<\\n\\\"File\\\"\[Rule]filename (screen if not specified)\>\"", "<>",
      "\[IndentingNewLine]", 
     "\"\<\\n\\\"InitialConditions\\\"\[Rule] list of initial conditions as \
rules\>\"", "<>", "\[IndentingNewLine]", 
     "\"\<\\n\\\"Parameters\\\"\[Rule] list of parameter rules\>\"", "<>", 
     "\[IndentingNewLine]", 
     "\"\<\\n\\\"Description\\\"\[Rule] any text string describing the \
model\>\"", "<>", "\[IndentingNewLine]", 
     "\"\<\\n\\\"Name\\\"\[Rule] any indentifier to use as the model \
name\>\"", "<>", "\[IndentingNewLine]", 
     "\"\<\\n\\nNote: If \
CelleratorML.m,xlr8r.m,MathSBML.m,Cellzilla.m,mPower.m cannot be found this \
will generate an error message.\>\""}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SSAGet", "::", "usage"}], "=", 
    RowBox[{
    "\"\<SSAGet[filename] reads the specified CelleratorML file\\nSSAGet[] \
first opens an interactive file name dialog to determine the file, and then \
reads the file.\\n\\nThe file is read, converted from XLR8R form to SSA form, \
and returned as the following list: \\n\>\"", "<>", 
     "\"\<{\\\"Name\\\"\[Rule]modelname\\n \\\"Model\\\"\[Rule]list of \
reactions\\n \\\"Parameters\\\"\[Rule] list of parameter assignments as a \
rule list\\n \\\"InitialConditions\\\"\[Rule]Initial conditions as a rule \
list}\\n\\nOptions:\\n\\\"Quiet\\\"\[Rule]False, if True, suppresse printing \
a statistical summary.\>\""}]}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ResetNaive", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NewFileName", "::", "usage"}], "=", 
    "\"\<NewFileName[options]\\nGenerates a unique file name based on the \
current system time. Options are\\n\\\"FilePrefix\\\"\[Rule]\\\"SSA-\\\"\\n\\\
\"FileType\\\"\[Rule]\\\"dat\\\"\\nThe file name is SSA-yymmddThhmmss.dat \
with the defaults.\>\""}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OpenSSAFile", "::", "usage"}], "=", 
    "\"\<OpenSSAFile[options]\\nOpens a unique file for writing with a name \
based on the current system time. Prints the file name and returns the stream \
name. Options for NewFileName or OpenWrite can be used\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"WriteTSV", "::", "usage"}], "=", 
    "\"\<WriteTSV[stream, data, ... ] writes a line of data in TSV form to \
the specified stream. Multiple items may be listed. They are combinded in a \
single list to put them on the line. \>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"WriteCSV", "::", "usage"}], "=", 
   "\"\<WriteCSV[stream, data, ...] writes a line of data in CSV form to the \
specified stream.\>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.446167155408727*^9, 3.446167181663588*^9}, {
  3.446167225835834*^9, 3.446167253996578*^9}, {3.446168274919259*^9, 
  3.446168613069263*^9}, {3.446168643768694*^9, 3.446168665679629*^9}, {
  3.446302480841129*^9, 3.446302603823333*^9}, {3.446302800520547*^9, 
  3.446302992700564*^9}, {3.446303068767183*^9, 3.446303105263418*^9}, {
  3.45609584831894*^9, 3.456095910427305*^9}, {3.4631853212062187`*^9, 
  3.4631853266538677`*^9}, {3.4632256270446243`*^9, 3.4632256346081257`*^9}, {
  3.463225894781637*^9, 3.463225909690806*^9}, {3.463226029373509*^9, 
  3.4632263313513927`*^9}, {3.508592274726721*^9, 3.508592274732707*^9}, {
  3.5085923274076767`*^9, 3.508592328279758*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["Utilities", "Section"],

Cell[CellGroupData[{

Cell["version 6 stuff", "Subsection",
 CellChangeTimes->{{3.3882539890884542`*^9, 3.388253996291641*^9}}],

Cell["This is a version 6 compatibility thing", "Text",
 CellChangeTimes->{{3.3882505605676813`*^9, 3.388250566204318*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MyFilterOptions", "[", 
     RowBox[{"f_", ",", " ", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"$VersionNumber", "<", "6"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Utilities`FilterOptions`FilterOptions", "[", 
       RowBox[{"f", ",", " ", "opt"}], "]"}], "\[IndentingNewLine]", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Sequence", "@@", 
       RowBox[{"FilterRules", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"{", "opt", "}"}], "]"}], ",", 
         RowBox[{"Options", "[", "f", "]"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.3882504595856752`*^9, 3.3882504978792353`*^9}, {
   3.3882540222844973`*^9, 3.388254031666307*^9}, {3.3882542187827377`*^9, 
   3.388254332839521*^9}, 3.388254374222191*^9, {3.3882614191671343`*^9, 
   3.388261441730834*^9}, {3.388261631791882*^9, 3.388261656988212*^9}, {
   3.388318829904943*^9, 3.3883189461200333`*^9}, {3.388319240852165*^9, 
   3.388319292009931*^9}, {3.388319359026918*^9, 3.388319360077533*^9}, {
   3.3883194175486097`*^9, 3.3883194508735437`*^9}, {3.3883194854584837`*^9, 
   3.388319527917027*^9}, {3.3883196296372004`*^9, 3.388319639414143*^9}, {
   3.388319717672534*^9, 3.388319769681662*^9}, {3.388320078377129*^9, 
   3.3883200826608877`*^9}, {3.388320139413718*^9, 3.388320176703384*^9}, {
   3.388320251968589*^9, 3.38832025776324*^9}, {3.388320458987941*^9, 
   3.38832050141164*^9}, {3.388320679379107*^9, 3.388320717242478*^9}, {
   3.388320819519843*^9, 3.388320843174108*^9}, 3.3883209250219107`*^9, {
   3.3883209646283216`*^9, 3.388320997026855*^9}, {3.388321180719509*^9, 
   3.388321219770446*^9}, 3.388321280011972*^9, {3.388321334353608*^9, 
   3.388321450465458*^9}, {3.388321533908236*^9, 3.388321544300967*^9}, {
   3.388321617667096*^9, 3.388321691949287*^9}, {3.388321771119731*^9, 
   3.388321859598996*^9}, {3.388341249728394*^9, 3.388341298728224*^9}, {
   3.388341368222883*^9, 3.388341432374724*^9}, {3.388341641800812*^9, 
   3.388341645612159*^9}, {3.388343439894812*^9, 3.388343440007737*^9}, 
   3.3883434965742893`*^9, {3.3883435350151043`*^9, 3.388343535538432*^9}, {
   3.389720714628471*^9, 3.389720718662982*^9}, {3.389720767182125*^9, 
   3.389720786677952*^9}, {3.3897217372062483`*^9, 3.389721804977943*^9}, {
   3.389722343812415*^9, 3.389722404203517*^9}, {3.389722552946127*^9, 
   3.3897225561074963`*^9}, {3.424614812681766*^9, 3.424614892750532*^9}, {
   3.427494138691592*^9, 3.427494154513891*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["now", "Subsection",
 CellChangeTimes->{{3.427494202470671*^9, 3.427494202808886*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"now", "::", "usage"}], "=", 
    "\"\<now[] returns the date and time as a string\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"now", "[", "]"}], ":=", " ", 
  RowBox[{"StringReplace", "[", 
   RowBox[{
    RowBox[{"DateString", "[", "]"}], ",", " ", 
    RowBox[{"\"\< \>\"", "\[Rule]", " ", "\"\<-\>\""}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.427493936462132*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["OpenSSAFile", "Subsection",
 CellChangeTimes->{{3.4632253694288673`*^9, 3.4632253726311903`*^9}, {
  3.4632254152062798`*^9, 3.463225426731634*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"OpenSSAFile", "[", 
    RowBox[{"opt___", "?", "OptionQ"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"fname", ",", " ", "stream"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fname", "=", 
       RowBox[{"NewFileName", "[", "opt", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"fopt", "=", 
          RowBox[{"MyFilterOptions", "[", 
           RowBox[{"OpenWrite", ",", "opt"}], "]"}]}], "}"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"stream", "=", 
          RowBox[{"OpenWrite", "[", 
           RowBox[{"fname", ",", " ", "fopt", ",", " ", 
            RowBox[{"FormatType", "\[Rule]", " ", "StandardForm"}], ",", " ", 
            
            RowBox[{"PageWidth", "\[Rule]", " ", "Infinity"}]}], "]"}]}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"fname", ",", "\"\< opened.\>\""}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "stream", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"WriteCSV", "[", 
    RowBox[{"stream_", ",", " ", "data__"}], "]"}], ":=", " ", 
   RowBox[{"Write", "[", 
    RowBox[{"stream", ",", " ", 
     RowBox[{"ExportString", "[", 
      RowBox[{
       RowBox[{"{", "data", "}"}], ",", " ", "\"\<csv\>\""}], "]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"WriteTSV", "[", 
     RowBox[{"stream_", ",", " ", "data__"}], "]"}], ":=", " ", 
    RowBox[{"Write", "[", 
     RowBox[{"stream", ",", " ", 
      RowBox[{"ExportString", "[", 
       RowBox[{
        RowBox[{"{", "data", "}"}], ",", " ", "\"\<tsv\>\""}], "]"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.46322542904531*^9, 3.463225640531733*^9}, {
  3.4632257894170103`*^9, 3.463225882953245*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["NewFileName", "Subsection",
 CellChangeTimes->{{3.444936923700613*^9, 3.444936924915679*^9}, {
  3.444937137804814*^9, 3.444937138210702*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NewFileName", "[", 
   RowBox[{"opt___", "?", "OptionQ"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "f", ",", "file", ",", " ", "prefix", ",", " ", "type", ",", " ", "n"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"prefix", " ", "=", " ", 
      RowBox[{
       RowBox[{"\"\<FilePrefix\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<FilePrefix\>\"", "\[Rule]", " ", "\"\<SSA-\>\""}], 
        "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"type", " ", "=", " ", 
      RowBox[{
       RowBox[{"\"\<FileType\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<FileType\>\"", "\[Rule]", " ", "\"\<dat\>\""}], 
        "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringLength", "[", "type", "]"}], "<", "1"}], ",", " ", 
       RowBox[{"type", "=", "\"\<.\>\""}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{"type", ",", " ", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}]}], "]"}], "\[NotEqual]", " ", 
        "\"\<.\>\""}], ",", " ", 
       RowBox[{"type", " ", "=", " ", 
        RowBox[{"\"\<.\>\"", "<>", "type"}]}]}], "]"}], ";", "  ", 
     "\[IndentingNewLine]", 
     RowBox[{"file", "=", 
      RowBox[{"DateString", "[", 
       RowBox[{"{", 
        RowBox[{
        "\"\<YearShort\>\"", ",", " ", "\"\<Month\>\"", ",", " ", 
         "\"\<Day\>\"", ",", "\"\<T\>\"", ",", "\"\<Hour\>\"", ",", 
         "\"\<Minute\>\"", ",", " ", "\"\<Second\>\""}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"n", "=", "1"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"f", "=", " ", 
      RowBox[{"prefix", "<>", "file", "<>", "type"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"FileNames", "[", "f", "]"}], "]"}], ">", "0"}], " ", 
        "\[And]", " ", 
        RowBox[{"n", "<", " ", "1000"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"f", "=", 
         RowBox[{"prefix", "<>", "file", "<>", "\"\<-\>\"", "<>", 
          RowBox[{"ToString", "[", "n", "]"}], "<>", "type"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"n", "=", 
         RowBox[{"n", "+", "1"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"FileNames", "[", "f", "]"}], "]"}], ">", "0"}], ",", " ", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<Warning: file \>\"", ",", " ", "f", ",", " ", 
         "\"\< will be overwritten.\>\""}], "]"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "f", "]"}], ";"}]}], " ", "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.44493693154012*^9, 3.444937157875895*^9}, {
  3.444937213749386*^9, 3.444937348928302*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Umbral Transformations", "Section",
 CellChangeTimes->{{3.50852359827699*^9, 3.5085236082368383`*^9}}],

Cell[CellGroupData[{

Cell["Positive/Negative Integer", "Subsection",
 CellChangeTimes->{{3.508523638285458*^9, 3.5085236497790194`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PositiveInteger", "[", "x_", "]"}], ":=", 
   RowBox[{"And", "[", 
    RowBox[{
     RowBox[{"IntegerQ", "[", "x", "]"}], ",", 
     RowBox[{"Positive", "[", "x", "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"NegativeInteger", "[", "x_", "]"}], ":=", 
   RowBox[{"And", "[", 
    RowBox[{
     RowBox[{"IntegerQ", "[", "x", "]"}], ",", 
     RowBox[{"Negative", "[", "x", "]"}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.508523619927229*^9, 3.508523655763232*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["UmbralPower", "Subsection",
 CellChangeTimes->{{3.508523665308526*^9, 3.508523669645122*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"UmbralPower", "[", 
    RowBox[{"x_", ",", "0"}], "]"}], ":=", "1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"UmbralPower", "[", 
    RowBox[{"x_", ",", "1"}], "]"}], ":=", "x"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"UmbralPower", "[", 
    RowBox[{"x_", ",", 
     RowBox[{"n_", "?", "PositiveInteger"}]}], "]"}], ":=", 
   RowBox[{"x", "*", 
    RowBox[{"UmbralPower", "[", 
     RowBox[{
      RowBox[{"x", "-", "1"}], ",", 
      RowBox[{"n", "-", "1"}]}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"UmbralPower", "[", 
    RowBox[{
     RowBox[{"x_", "?", "ListQ"}], ",", 
     RowBox[{"{", 
      RowBox[{"n__", "?", "PositiveInteger"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "powers", "}"}], ",", 
     RowBox[{
      RowBox[{"powers", "=", 
       RowBox[{"PadRight", "[", 
        RowBox[{
         RowBox[{"{", "n", "}"}], ",", 
         RowBox[{"Length", "[", "x", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"MapThread", "[", 
        RowBox[{"UmbralPower", ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "powers"}], "}"}]}], "]"}], "]"}], ";"}]}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UmbralPower", "[", 
     RowBox[{"x_", ",", 
      RowBox[{"n_", "?", "Positive"}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Gamma", "[", 
      RowBox[{"x", "+", "1"}], "]"}], "/", 
     RowBox[{"Gamma", "[", 
      RowBox[{"x", "+", "1", "-", "n"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"UmbralPower", "[", 
    RowBox[{"x_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<Error: UmbralPower undefined for power \>\"", ",", "n", ",", 
       "\"\< (must be a positive integer).\>\""}], "]"}], ";", "$Failed"}], 
    ")"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5085236856497173`*^9, 3.5085236856507874`*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Arrow Conversion", "Section",
 CellChangeTimes->{{3.444591004527063*^9, 3.444591006477046*^9}}],

Cell[CellGroupData[{

Cell["ListToSum", "Subsubsection",
 CellChangeTimes->{{3.427491842956947*^9, 3.427491844505204*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ListToSum", "[", 
     RowBox[{"Rule", "[", 
      RowBox[{"a_", ",", " ", "b_"}], "]"}], "]"}], ":=", " ", 
    RowBox[{"Rule", "[", 
     RowBox[{
      RowBox[{"ListToSum", "[", "a", "]"}], ",", " ", 
      RowBox[{"ListToSum", "[", "b", "]"}]}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ListToSum", "[", "x_", "]"}], ":=", " ", 
   RowBox[{"Plus", "@@", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{"x", "/.", 
       RowBox[{"{", 
        RowBox[{"Plus", "\[Rule]", "List"}], "}"}]}], "}"}], "]"}]}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.427490540182323*^9, 3.427490562131124*^9}, {
  3.427495222352452*^9, 3.427495246941425*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["ReactantQ, ReactionQ (private functions, used by SSACheck)", \
"Subsubsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ReactantQ", "[", 
    RowBox[{"A_", "?", "AtomQ"}], "]"}], ":=", "True"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReactantQ", "[", 
    RowBox[{"HoldPattern", "[", 
     RowBox[{"Plus", "[", "Q___", "]"}], "]"}], "]"}], ":=", "False"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReactantQ", "[", 
    RowBox[{
     RowBox[{"A_", "?", "AtomQ"}], "[", "B__", "]"}], "]"}], ":=", "True"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReactantQ", "[", "A___", "]"}], ":=", "False"}], ";"}]}], "Input",\

 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ReactionQ", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"A_", "\[Rule]", "B_"}], ",", " ", "k_"}], "}"}], "]"}], ":=", 
   "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReactionQ", "[", 
    RowBox[{"{", 
     RowBox[{"A_", "\[Rule]", "B_"}], "}"}], "]"}], ":=", "True"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReactionQ", "[", "A___", "]"}], ":=", "False"}], ";"}]}], "Input",\

 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["SSACheck (private)", "Subsubsection"],

Cell["checks the validity of a list of reactions input to SSA", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"SSACheck", "[", 
          RowBox[{"r_", ",", " ", 
           RowBox[{"dbg_:", "False"}]}], "]"}], ":=", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "ok", ",", " ", "notok", ",", " ", "listifyReaction", ",", " ", 
             "dPrint"}], "}"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"dPrint", "[", "x___", "]"}], ":=", " ", 
             RowBox[{"If", "[", 
              RowBox[{"dbg", ",", " ", 
               RowBox[{"Print", "[", 
                RowBox[{"\"\<SSACheck: \>\"", ",", " ", "x"}], "]"}]}], 
              "]"}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            StyleBox[
             RowBox[{
              RowBox[{"listifyReaction", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"A_", "\[Rule]", " ", "B_"}], ",", "k_"}], "}"}], 
               "]"}], ":=", 
              RowBox[{"Module", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "rs", ",", "p", ",", " ", "myTimes", ",", " ", "c", ",", " ",
                   "k2c", ",", " ", "ok"}], "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"myTimes", "[", 
                   RowBox[{
                    RowBox[{"n_", "?", "IntegerQ"}], ",", 
                    RowBox[{"x_", "?", "ReactantQ"}]}], "]"}], ":=", 
                  RowBox[{"Table", "[", 
                   RowBox[{"x", ",", 
                    RowBox[{"{", "n", "}"}]}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"myTimes", "[", 
                   RowBox[{
                    RowBox[{"x_", "?", "ReactantQ"}], ",", 
                    RowBox[{"n_", "?", "IntegerQ"}]}], "]"}], ":=", 
                  RowBox[{"Table", "[", 
                   RowBox[{"x", ",", 
                    RowBox[{"{", "n", "}"}]}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"myTimes", "[", 
                   RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}]}], ";", 
                 "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 "\[IndentingNewLine]", 
                 RowBox[{"rs", "=", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"A", "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Plus", "\[Rule]", " ", "List"}], ",", 
                    RowBox[{"Times", "\[Rule]", " ", "myTimes"}]}], "}"}]}], 
                    ")"}], "//", "List"}], "//", "Flatten"}], "//", 
                   "Sort"}]}], ";", "\[IndentingNewLine]", 
                 "\[IndentingNewLine]", 
                 RowBox[{"dPrint", "[", 
                  RowBox[{"\"\<rs=\>\"", ",", " ", "rs"}], "]"}], ";", " ", 
                 "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"p", "=", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"B", "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Plus", "\[Rule]", " ", "List"}], ",", 
                    RowBox[{"Times", "\[Rule]", " ", "myTimes"}]}], "}"}]}], 
                    ")"}], "//", "List"}], "//", "Flatten"}], "//", 
                   "Sort"}]}], ";", "\[IndentingNewLine]", 
                 "\[IndentingNewLine]", 
                 RowBox[{"dPrint", "[", 
                  RowBox[{"\"\<p=\>\"", ",", " ", "p"}], "]"}], ";", " ", 
                 "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"ok", "=", "True"}], ";", "\[IndentingNewLine]", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(", 
                  RowBox[{"*", "\[IndentingNewLine]", 
                   RowBox[{"Note", ":", " ", 
                    RowBox[{
                    "there", " ", "is", " ", "no", " ", "factorial", " ", 
                    "here", " ", "because", " ", "the", " ", "factorials", 
                    " ", "in", " ", "equations", " ", 
                    RowBox[{"(", 
                    RowBox[{"6", "b"}], ")"}], " ", "and", " ", 
                    RowBox[{"(", "15", ")"}], " ", "cancel", " ", "out", " ", 
                    "in", " ", "reference", " ", 
                    RowBox[{
                    RowBox[{"(", "1", ")"}], ".", "  ", "This"}], " ", "is", 
                    " ", "because", " ", "k", " ", "in", " ", "the", " ", 
                    "input", " ", "reactions", " ", "is", " ", "the", " ", 
                    "usual", " ", "rate", " ", "constant", " ", "expressed", 
                    " ", "in", " ", "units", " ", "of", " ", "amount", " ", 
                    RowBox[{"(", 
                    RowBox[{"not", " ", "concentration"}], ")"}], " ", "and", 
                    " ", "is", " ", "not", " ", "the", " ", "stochastic", " ",
                     "rate", " ", 
                    RowBox[{"constant", "."}]}]}]}], "\[IndentingNewLine]", 
                  "\[IndentingNewLine]"}]}]}]}]}],
             FontColor->RGBColor[0, 0.4, 1]]}]}]}]}], 
        StyleBox["*)",
         FontColor->RGBColor[0, 0.4, 1]]}], 
       StyleBox[" ",
        FontColor->RGBColor[0, 0.4, 1]], 
       StyleBox["\[IndentingNewLine]",
        FontColor->RGBColor[0, 0.4, 1]], 
       StyleBox["\[IndentingNewLine]",
        FontColor->RGBColor[0, 0.4, 1]], 
       StyleBox["\[IndentingNewLine]",
        FontColor->RGBColor[0, 0.4, 1]], 
       StyleBox[
        RowBox[{
         RowBox[{
          RowBox[{"k2c", "[", 
           RowBox[{"{", "0", "}"}], "]"}], ":=", "k"}], ";"}],
        FontColor->RGBColor[0, 0.4, 1]], 
       StyleBox["\[IndentingNewLine]",
        FontColor->RGBColor[0, 0.4, 1]], 
       RowBox[{
        RowBox[{
         StyleBox[
          RowBox[{"k2c", "[", 
           RowBox[{"s_", "?", "ListQ"}], "]"}],
          FontColor->RGBColor[0, 0.4, 1]], 
         StyleBox[":=",
          FontColor->RGBColor[0, 0.4, 1]], 
         RowBox[{
          StyleBox["k",
           FontColor->RGBColor[0, 0.4, 1]], 
          StyleBox["*",
           FontColor->RGBColor[0, 0.4, 1]], 
          RowBox[{
           StyleBox["(",
            FontColor->RGBColor[0, 0.4, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[0, 0.4, 1]], 
           RowBox[{
            RowBox[{
             StyleBox["(",
              FontColor->RGBColor[0, 0.4, 1]], 
             RowBox[{
              StyleBox["Times",
               FontColor->RGBColor[0, 0.4, 1]], 
              StyleBox["@@",
               FontColor->RGBColor[0, 0.4, 1]], 
              RowBox[{
               StyleBox["Sort",
                FontColor->RGBColor[0, 0.4, 1]], 
               StyleBox["[",
                FontColor->RGBColor[0, 0.4, 1]], 
               RowBox[{
                StyleBox["s",
                 FontColor->RGBColor[0, 0.4, 1]], 
                StyleBox["/.",
                 FontColor->RGBColor[0, 0.4, 1]], 
                RowBox[{
                 StyleBox["{",
                  FontColor->RGBColor[0, 0.4, 1]], 
                 RowBox[{
                  StyleBox["Global`\[EmptySet]",
                   FontColor->RGBColor[0, 0.4, 1]], 
                  StyleBox["\[Rule]",
                   FontColor->RGBColor[0, 0.4, 1]], " ", "1"}], "}"}]}], 
               StyleBox["]",
                FontColor->RGBColor[0, 0.4, 1]]}]}], 
             StyleBox[")",
              FontColor->RGBColor[0, 0.4, 1]]}], 
            StyleBox["/.",
             FontColor->RGBColor[0, 0.4, 1]], 
            RowBox[{
             StyleBox["{",
              FontColor->RGBColor[0, 0.4, 1]], 
             RowBox[{
              StyleBox["Power",
               FontColor->RGBColor[0, 0.4, 1]], 
              StyleBox["\[Rule]",
               FontColor->RGBColor[0, 0.4, 1]], " ", "UmbralPower"}], "}"}]}],
            ")"}]}]}], " ", ";"}], " ", 
       StyleBox["\[IndentingNewLine]",
        FontColor->RGBColor[0, 0.4, 1]], 
       StyleBox["\[IndentingNewLine]",
        FontColor->RGBColor[0, 0.4, 1]], 
       StyleBox[
        RowBox[{
         RowBox[{"c", "=", 
          RowBox[{"k2c", "[", "rs", "]"}]}], ";"}],
        FontColor->RGBColor[0, 0.4, 1]], 
       StyleBox["\[IndentingNewLine]",
        FontColor->RGBColor[0, 0.4, 1]], 
       StyleBox[
        RowBox[{
         RowBox[{"c", "=", 
          RowBox[{"removeExplicitTimeDependence", "[", 
           RowBox[{"c", ",", " ", "Global`t"}], "]"}]}], ";"}],
        FontColor->RGBColor[0, 0.4, 1]], 
       StyleBox[" ",
        FontColor->RGBColor[0, 0.4, 1]], 
       StyleBox["\[IndentingNewLine]",
        FontColor->RGBColor[0, 0.4, 1]], 
       StyleBox["\[IndentingNewLine]",
        FontColor->RGBColor[0, 0.4, 1]], 
       StyleBox[
        RowBox[{
         RowBox[{"dPrint", "[", 
          RowBox[{"\"\<c=\>\"", ",", " ", "c"}], "]"}], ";"}],
        FontColor->RGBColor[0, 0.4, 1]], 
       StyleBox[" ",
        FontColor->RGBColor[0, 0.4, 1]], 
       StyleBox["\[IndentingNewLine]",
        FontColor->RGBColor[0, 0.4, 1]], 
       StyleBox["\[IndentingNewLine]",
        FontColor->RGBColor[0, 0.4, 1]], 
       StyleBox[
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{"rs", ",", "p", " ", ",", "c", ",", "ok"}], "}"}], "]"}],
        FontColor->RGBColor[0, 0.4, 1]], 
       StyleBox["\[IndentingNewLine]",
        FontColor->RGBColor[0, 0.4, 1]], 
       StyleBox["\[IndentingNewLine]",
        FontColor->RGBColor[0, 0.4, 1]]}], 
      StyleBox["]",
       FontColor->RGBColor[0, 0.4, 1]]}], 
     StyleBox[";",
      FontColor->RGBColor[0, 0.4, 1]]}], 
    StyleBox["\[IndentingNewLine]",
     FontColor->RGBColor[0, 0.4, 1]], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"listifyReaction", "[", 
       RowBox[{"{", 
        RowBox[{"A_", "\[Rule]", " ", "B_"}], "}"}], "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Warning: The reaction \>\"", ",", " ", 
           RowBox[{"{", 
            RowBox[{"A", "\[Rule]", " ", "B"}], "}"}], ",", " ", 
           "\"\< does not have a rate constant specified, and was interpreted \
as \>\"", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"A", "\[Rule]", " ", "B"}], ",", " ", "1"}], "}"}]}], 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"listifyReaction", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"A", "\[Rule]", " ", "B"}], ",", "1"}], "}"}], "]"}], 
          "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ok", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"r", ",", "ReactionQ"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"notok", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{"r", ",", "ok"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<The reaction \>\"", ",", "#", ",", 
          "\"\< is incorrectly formatted and will be ignored.\>\""}], "]"}], 
        "&"}], ",", "notok"}], "]"}], ";"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ok", "=", 
      RowBox[{"listifyReaction", "/@", "ok"}]}], ";"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"notok", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"ok", ",", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"Last", "[", "#", "]"}]}], "&"}]}], "]"}]}], ";"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<The following reaction is neither unimolecular nor bimolecular \
and will be ignored: \>\"", ",", " ", 
          RowBox[{"Rule", "[", 
           RowBox[{
            RowBox[{"Plus", "@@", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"Plus", "@@", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}], "]"}], "&"}], ",", 
       "notok"}], "]"}], ";"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ok", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{"ok", ",", "notok"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<ok=\>\"", ",", " ", "ok"}], "]"}], ";"}], " ", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dPrint", "[", 
      RowBox[{"Transpose", "[", 
       RowBox[{"Most", "/@", "ok"}], "]"}], "]"}], ";"}], " ", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "ok", "]"}], ">", "0"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ok", " ", "=", 
         RowBox[{"Most", "/@", "ok"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"Transpose", "[", "ok", "]"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Return", "[", "Null", "]"}], ";"}], "\[IndentingNewLine]"}], 
   "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQA2IQHbRaRGPjipeOwQ4e2iD65ZEkKxD9ZOERaxC95ih3
CIh+nXIRTHNe3JkMoi80uOWBaAF5pVIQzf1nNpi+wGtRBaI3WAWA6fSdnyaD
6PMsf8G0upFcBueql47Pn5yuAtE5fxzudgHpNJHK+yD6VxDXCxBd3poMpqe+
D/sJoiWm/fkFooviDv4D0eYFjEzdQPrNaUOxI/tfOqa+iwTT3/gbw0H0tCOL
I0H0yRt7skF0wDadHBAt8KOvS+bAS8cjk2R6QTTTy4bLIDpF8fkVEL3pjklH
UOcrx1civmA64LNFL4jOevdlAoh2OrJ2OojmEKqcAaKnRJ5eBaKVtnWuAdF5
0VyXQPTMk2pgGgAHEMHC
  "]],

Cell["\<\

Its possible that (from Cellerator) some rates will have explicit time \
dependence in terms of references to other variables, e.g., k --> k1*A[t], \
etc. This will be replaced with k--> K1*A. This will not fix references that \
actually use the variable t, such at k--> k1*(1+t). 

added 1.1.\[Alpha].1 July 7 2009\
\>", "Text",
 CellChangeTimes->{{3.45598422807852*^9, 3.455984297371142*^9}, {
  3.4559846062970667`*^9, 3.455984615986676*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"removeExplicitTimeDependence", "[", 
    RowBox[{"a_", ",", " ", 
     RowBox[{"t_:", "Global`t"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dbg", "=", "False"}], ",", " ", "dPrint", ",", " ", "fixrate",
        ",", " ", "tstring", ",", " ", "fixed"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"dPrint", "[", "x___", "]"}], ":=", " ", 
       RowBox[{"If", "[", 
        RowBox[{"dbg", ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<removeExplicitTimeDependence:\>\"", ",", " ", "x"}], 
          "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tstring", "=", 
       RowBox[{"\"\<[\>\"", "<>", 
        RowBox[{"ToString", "[", "t", "]"}], "<>", "\"\<]\>\""}]}], ";", "  ",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fixrate", "[", "x_", "]"}], ":=", 
       RowBox[{"ToExpression", "[", 
        RowBox[{"StringReplace", "[", " ", 
         RowBox[{
          RowBox[{"ToString", "[", 
           RowBox[{"InputForm", "[", "x", "]"}], "]"}], ",", " ", 
          RowBox[{"tstring", "\[Rule]", " ", "\"\<\>\""}]}], "]"}], "]"}]}], 
      ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<a:\>\"", ",", " ", "a"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fixed", " ", "=", " ", 
       RowBox[{"fixrate", "/@", "a"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<fixed: \>\"", ",", " ", "fixed"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "fixed", "]"}], ";"}]}], " ", 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.455983505509356*^9, 3.455983567971485*^9}, {
  3.455983950959901*^9, 3.455983951236905*^9}, {3.455983989630666*^9, 
  3.455984154348928*^9}, {3.4559841847869377`*^9, 3.4559842223882113`*^9}, {
  3.455984419426796*^9, 3.4559844204223948`*^9}, {3.455984509671948*^9, 
  3.4559845107611513`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Conversion of Cellerator-like arrows ", "Subsection",
 CellChangeTimes->{{3.443296598485436*^9, 3.443296620754595*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ResetNaive", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", " ", 
      RowBox[{"NaiveWarnings", "=", "0"}]}], "]"}]}], ";"}], 
  "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NaiveWarnings", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NaiveMax", "=", "5"}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.463185090737872*^9, 3.463185111646226*^9}, {
  3.463185167394462*^9, 3.4631851755432568`*^9}, {3.463185279902688*^9, 
  3.463185291919737*^9}, {3.463185433213543*^9, 3.463185457059061*^9}}],

Cell[CellGroupData[{

Cell["ExpandReactions", "Subsubsection",
 CellChangeTimes->{{3.442855629871851*^9, 3.44285563178902*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExpandReactions", "[", "r_", "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "rexp", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rexp", " ", "=", " ", 
       RowBox[{"ExpandReaction", "/@", "r"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rexp", " ", "=", " ", 
       RowBox[{"Join", "@@", "rexp"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Print", "[", "rexp", "]"}], ";"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "rexp", "]"}], ";"}]}], " ", 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.44285562382088*^9, 3.442855706417789*^9}, {
  3.442856067988309*^9, 3.442856103904189*^9}, {3.442856152232442*^9, 
  3.442856155115716*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["ExpandReaction {A\[ShortRightArrow]B,k}", "Subsubsection",
 CellChangeTimes->{{3.442856547070634*^9, 3.442856548814187*^9}, {
  3.44285707425652*^9, 3.442857082305923*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ExpandReaction", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"A_", "\[Rule]", " ", "B_"}], ",", " ", "x___"}], "}"}], "]"}], 
   ":=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"A", "\[Rule]", " ", "B"}], " ", ",", " ", "x"}], "}"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExpandReaction", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"A_", "\[ShortRightArrow]", " ", "B_"}], ",", " ", "x___"}], 
     "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"A", "\[Rule]", " ", "B"}], " ", ",", " ", "x"}], "}"}], 
    "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.442857086646092*^9, 3.442857096662749*^9}, {
  3.561656241105454*^9, 3.561656262700944*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["ExpandReaction {A\[RightArrowLeftArrow]B, k}", "Subsubsection",
 CellChangeTimes->{{3.442857105490749*^9, 3.442857147239703*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExpandReaction", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"A_", "\[RightArrowLeftArrow]", "B_"}], ",", "x___"}], "}"}], 
    "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"r", ",", "k", ",", " ", "kin"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"kin", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", "x", "}"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"k", "=", 
       RowBox[{"PadRight", "[", 
        RowBox[{"kin", ",", " ", "2"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "k", "]"}], ">", " ", 
         RowBox[{"Length", "[", "kin", "]"}]}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Warning: Missing rate constants in the reaction \>\"", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"A", "\[RightArrowLeftArrow]", "B"}], ",", "x"}], "}"}], 
           ",", " ", "\"\< are assumed to be zero: \>\"", ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"A", "\[RightArrowLeftArrow]", "B"}], ",", 
             RowBox[{"Sequence", "@@", "k"}]}], "}"}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "k", "]"}], "<", " ", 
         RowBox[{"Length", "[", "kin", "]"}]}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Warning: Extra rate constants in the reaction \>\"", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"A", "\[RightArrowLeftArrow]", "B"}], ",", "x"}], "}"}], 
           ",", " ", "\"\< were ignored: \>\"", ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"A", "\[RightArrowLeftArrow]", "B"}], ",", 
             RowBox[{"Sequence", "@@", "k"}]}], "}"}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"r", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"A", "\[Rule]", " ", "B"}], ",", " ", 
           RowBox[{"k", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"B", "\[Rule]", " ", "A"}], ",", " ", 
           RowBox[{"k", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "r", "]"}], ";"}]}], " ", "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "ExpandReaction ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     OverscriptBox[
      RowBox[{"A", "\[ShortRightArrow]", "B"}], "e"], ",", "k"}], "}"}], 
   TraditionalForm]]]
}], "Subsubsection",
 CellChangeTimes->{{3.442857152348924*^9, 3.442857160571239*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ExpandReaction", "[", 
      RowBox[{"{", 
       RowBox[{
        OverscriptBox[
         RowBox[{"A_", "\[Rule]", " ", "B_"}], "e_"], ",", " ", "x___"}], 
       "}"}], "]"}], ":=", " ", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"r", ",", " ", "kin"}], "}"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"kin", "=", 
         RowBox[{
          RowBox[{"{", "x", "}"}], "//", "Flatten"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"PadRight", "[", 
          RowBox[{"kin", ",", " ", "1"}], "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "k", "]"}], ">", " ", 
           RowBox[{"Length", "[", "kin", "]"}]}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Warning: Missing rate constants in the reaction \>\"", ",", 
             RowBox[{"{", 
              RowBox[{
               OverscriptBox[
                RowBox[{"A", "\[Rule]", " ", "B"}], "e"], ",", "x"}], "}"}], 
             ",", " ", "\"\< are assumed to be zero: \>\"", ",", " ", 
             RowBox[{"{", 
              RowBox[{
               OverscriptBox[
                RowBox[{"A", "\[Rule]", " ", "B"}], "e"], ",", " ", 
               RowBox[{"Sequence", "@@", "k"}]}], "}"}]}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "k", "]"}], "<", " ", 
           RowBox[{"Length", "[", "kin", "]"}]}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Warning: Extra rate constants in the reaction \>\"", ",", 
             RowBox[{"{", 
              RowBox[{
               OverscriptBox[
                RowBox[{"A", "\[Rule]", " ", "B"}], "e"], ",", "x"}], "}"}], 
             ",", " ", "\"\< were ignored: \>\"", ",", " ", 
             RowBox[{"{", 
              RowBox[{
               OverscriptBox[
                RowBox[{"A", "\[Rule]", " ", "B"}], "e"], ",", " ", 
               RowBox[{"Sequence", "@@", "k"}]}], "}"}]}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"r", "=", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"A", "+", "e"}], "\[Rule]", " ", 
             RowBox[{"B", "+", "e"}]}], ",", " ", 
            RowBox[{"k", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "}"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "r", "]"}]}]}], "]"}]}], ";"}], " ", 
   "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.442857816105737*^9, 3.442857837427602*^9}, {
  3.442859573795901*^9, 3.442859574069237*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "ExpandReaction ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     OverscriptBox[
      RowBox[{"A", "\[RightArrowLeftArrow]", "B"}], "e"], ",", "k"}], "}"}], 
   TraditionalForm]]]
}], "Subsubsection",
 CellChangeTimes->{{3.442857166027108*^9, 3.442857176573594*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ExpandReaction", "[", 
     RowBox[{"{", 
      RowBox[{
       OverscriptBox[
        RowBox[{"A_", "\[RightArrowLeftArrow]", " ", "B_"}], "e_"], ",", " ", 
       "x___"}], "}"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"r", ",", " ", "kin"}], "}"}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"kin", "=", 
        RowBox[{
         RowBox[{"{", "x", "}"}], "//", "Flatten"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"k", "=", 
        RowBox[{"PadRight", "[", 
         RowBox[{"kin", ",", " ", "4"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "k", "]"}], ">", " ", 
          RowBox[{"Length", "[", "kin", "]"}]}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Let", " ", "it", " ", "be", " ", "OK", " ", "to", " ", "drop", " ",
            "the", " ", "4", "th", " ", "rate", " ", "constant", " ", "and", 
           " ", "default", " ", "to", " ", "zero"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "kin", "]"}], "<", "3"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Print", "[", 
             RowBox[{
             "\"\<Warning: Missing rate constants in the reaction \>\"", ",", 
              
              RowBox[{"{", 
               RowBox[{
                OverscriptBox[
                 RowBox[{"A", "\[RightArrowLeftArrow]", " ", "B"}], "e"], ",",
                 "x"}], "}"}], ",", " ", "\"\< are assumed to be zero: \>\"", 
              ",", " ", 
              RowBox[{"{", 
               RowBox[{
                OverscriptBox[
                 RowBox[{"A", "\[RightArrowLeftArrow]", " ", "B"}], "e"], ",",
                 " ", 
                RowBox[{"Sequence", "@@", "k"}]}], "}"}]}], "]"}]}], "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "k", "]"}], "<", " ", 
          RowBox[{"Length", "[", "kin", "]"}]}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Warning: Extra rate constants in the reaction \>\"", ",", 
            RowBox[{"{", 
             RowBox[{
              OverscriptBox[
               RowBox[{"A", "\[RightArrowLeftArrow]", " ", "B"}], "e"], ",", 
              "x"}], "}"}], ",", " ", "\"\< were ignored: \>\"", ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"A", "\[Rule]", " ", "B"}], ",", " ", 
              RowBox[{"Sequence", "@@", "k"}]}], "}"}]}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"r", "=", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"A", "+", "e"}], "\[Rule]", " ", 
             RowBox[{"Diamond", "[", 
              RowBox[{"A", ",", "e"}], "]"}]}], ",", " ", 
            RowBox[{"k", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Diamond", "[", 
              RowBox[{"A", ",", "e"}], "]"}], "\[Rule]", " ", 
             RowBox[{"e", "+", "A"}]}], ",", " ", 
            RowBox[{"k", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Diamond", "[", 
              RowBox[{"A", ",", "e"}], "]"}], "\[Rule]", " ", 
             RowBox[{"B", "+", "e"}]}], ",", " ", 
            RowBox[{"k", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"B", "\[Rule]", " ", 
             RowBox[{
              RowBox[{"Diamond", "[", 
               RowBox[{"A", ",", " ", "e"}], "]"}], " ", "+", " ", "e"}]}], 
            ",", " ", 
            RowBox[{"k", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]",
          "}"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "r", "]"}]}]}], "]"}]}], ";"}], " "}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.442855707812359*^9, 3.442855733191951*^9}, {
   3.442855770837026*^9, 3.442855999803258*^9}, {3.44285627479751*^9, 
   3.44285641553778*^9}, {3.442856457512668*^9, 3.442856478223338*^9}, {
   3.442856515090425*^9, 3.442856533131548*^9}, {3.442856644890959*^9, 
   3.442856646556291*^9}, {3.442856707416807*^9, 3.442856724687321*^9}, {
   3.442856845143148*^9, 3.442856847422606*^9}, {3.442856896646492*^9, 
   3.442857000793293*^9}, 3.442857093814884*^9, 3.442857128006597*^9, {
   3.442857182149704*^9, 3.442857204628417*^9}, {3.442857681822545*^9, 
   3.442857682075146*^9}, {3.442857776951956*^9, 3.442857794646693*^9}, {
   3.507592901941702*^9, 3.507592930220017*^9}, {3.5075929774160833`*^9, 
   3.507593062401753*^9}, {3.507593495265513*^9, 3.507593497395339*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "ExpandReaction ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     UnderoverscriptBox[
      RowBox[{"A", "\[RightArrowLeftArrow]", "B"}], "rev", "fwd"], ",", "k"}],
     "}"}], TraditionalForm]]]
}], "Subsubsection",
 CellChangeTimes->{{3.442857166027108*^9, 3.442857176573594*^9}, {
  3.442857222814565*^9, 3.442857232892288*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ExpandReaction", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Underoverscript", "[", 
        RowBox[{
         RowBox[{"RightArrowLeftArrow", "[", 
          RowBox[{"A_", ",", "B_"}], "]"}], ",", "rev_", ",", "fwd_"}], "]"}],
        ",", " ", "x___"}], "}"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "r", ",", " ", "kin", ",", " ", "rf", ",", " ", "rr", ",", " ", "kf", 
        ",", " ", "kr"}], "}"}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"kin", "=", 
        RowBox[{
         RowBox[{"{", "x", "}"}], "//", "Flatten"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"k", "=", 
        RowBox[{"PadRight", "[", 
         RowBox[{"kin", ",", " ", "8"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "k", "]"}], ">", " ", 
          RowBox[{"Length", "[", "kin", "]"}]}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Warning: Missing rate constants in the reaction \>\"", ",", 
            " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Underoverscript", "[", 
               RowBox[{
                RowBox[{"RightArrowLeftArrow", "[", 
                 RowBox[{"A", ",", "B"}], "]"}], ",", "rev", ",", "fwd"}], 
               "]"}], ",", "x"}], "}"}], ",", " ", 
            "\"\< are assumed to be zero: \>\"", ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Underoverscript", "[", 
               RowBox[{
                RowBox[{"RightArrowLeftArrow", "[", 
                 RowBox[{"A", ",", "B"}], "]"}], ",", "rev", ",", "fwd"}], 
               "]"}], ",", " ", 
              RowBox[{"Sequence", "@@", "k"}]}], "}"}]}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "k", "]"}], "<", " ", 
          RowBox[{"Length", "[", "kin", "]"}]}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Warning: Extra rate constants in the reaction \>\"", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Underoverscript", "[", 
               RowBox[{
                RowBox[{"RightArrowLeftArrow", "[", 
                 RowBox[{"A", ",", "B"}], "]"}], ",", "rev", ",", "fwd"}], 
               "]"}], ",", "x"}], "}"}], ",", " ", "\"\< were ignored: \>\"", 
            ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Underoverscript", "[", 
               RowBox[{
                RowBox[{"RightArrowLeftArrow", "[", 
                 RowBox[{"A", ",", "B"}], "]"}], ",", "rev", ",", "fwd"}], 
               "]"}], ",", " ", 
              RowBox[{"Sequence", "@@", "k"}]}], "}"}]}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"kf", "=", " ", 
        RowBox[{"Sequence", "@@", 
         RowBox[{"Take", "[", 
          RowBox[{"k", ",", " ", "4"}], "]"}]}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"kr", " ", "=", " ", 
        RowBox[{"Sequence", "@@", 
         RowBox[{"Take", "[", 
          RowBox[{"k", ",", " ", 
           RowBox[{"-", "4"}]}], "]"}]}]}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"rf", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Overscript", "[", 
           RowBox[{
            RowBox[{"RightArrowLeftArrow", "[", 
             RowBox[{"A", ",", "B"}], "]"}], ",", "fwd"}], "]"}], ",", " ", 
          "kf"}], "}"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"rr", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Overscript", "[", 
           RowBox[{
            RowBox[{"RightArrowLeftArrow", "[", 
             RowBox[{"B", ",", "A"}], "]"}], ",", "rev"}], "]"}], " ", ",", 
          "kr"}], "}"}]}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"rf", "=", 
        RowBox[{"ExpandReaction", "[", "rf", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"rr", "=", 
        RowBox[{"ExpandReaction", "[", "rr", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"r", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"rf", ",", " ", "rr"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "r", "]"}]}]}], "]"}]}], ";"}], " "}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.442855707812359*^9, 3.442855733191951*^9}, {
   3.442855770837026*^9, 3.442855999803258*^9}, {3.44285627479751*^9, 
   3.44285641553778*^9}, {3.442856457512668*^9, 3.442856478223338*^9}, {
   3.442856515090425*^9, 3.442856533131548*^9}, {3.442856644890959*^9, 
   3.442856646556291*^9}, {3.442856707416807*^9, 3.442856724687321*^9}, {
   3.442856845143148*^9, 3.442856847422606*^9}, {3.442856896646492*^9, 
   3.442857000793293*^9}, 3.442857093814884*^9, 3.442857128006597*^9, {
   3.442857182149704*^9, 3.442857204628417*^9}, {3.44285723745553*^9, 
   3.442857289346981*^9}, {3.442857358924855*^9, 3.442857426048357*^9}, {
   3.442857475520528*^9, 3.442857577751481*^9}, {3.442857614516169*^9, 
   3.44285765433108*^9}, {3.442857875233018*^9, 3.44285790205375*^9}, {
   3.442857983818308*^9, 3.442858090963737*^9}, {3.442858135293795*^9, 
   3.442858195988769*^9}, {3.442858231867415*^9, 3.442858238828261*^9}, {
   3.442858284944786*^9, 3.442858321124755*^9}, {3.442858411288807*^9, 
   3.442858478354939*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "ExpandReaction ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     OverscriptBox[
      RowBox[{"A", "\[Equilibrium]", "B"}], "e"], ",", "k"}], "}"}], 
   TraditionalForm]]]
}], "Subsubsection",
 CellChangeTimes->{{3.442857166027108*^9, 3.442857176573594*^9}, {
  3.442858550901985*^9, 3.442858575980329*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ExpandReaction", "[", 
     RowBox[{"{", 
      RowBox[{
       OverscriptBox[
        RowBox[{"A_", "\[Equilibrium]", "B_"}], "e_"], ",", " ", "x___"}], 
      "}"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"r", ",", " ", "kin"}], "}"}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"kin", "=", 
        RowBox[{
         RowBox[{"{", "x", "}"}], "//", "Flatten"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"k", "=", 
        RowBox[{"PadRight", "[", 
         RowBox[{"kin", ",", " ", "6"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "k", "]"}], ">", " ", 
          RowBox[{"Length", "[", "kin", "]"}]}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Warning: Missing rate constants in the reaction \>\"", ",", 
            RowBox[{"{", 
             RowBox[{
              OverscriptBox[
               RowBox[{"A", "\[Equilibrium]", " ", "B"}], "e"], ",", "x"}], 
             "}"}], ",", " ", "\"\< are assumed to be zero: \>\"", ",", " ", 
            RowBox[{"{", 
             RowBox[{
              OverscriptBox[
               RowBox[{"A", "\[Equilibrium]", " ", "B"}], "e"], ",", " ", 
              RowBox[{"Sequence", "@@", "k"}]}], "}"}]}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "k", "]"}], "<", " ", 
          RowBox[{"Length", "[", "kin", "]"}]}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Warning: Extra rate constants in the reaction \>\"", ",", 
            RowBox[{"{", 
             RowBox[{
              OverscriptBox[
               RowBox[{"A", "\[Equilibrium]", " ", "B"}], "e"], ",", "x"}], 
             "}"}], ",", " ", "\"\< were ignored: \>\"", ",", " ", 
            RowBox[{"{", 
             RowBox[{
              OverscriptBox[
               RowBox[{"A", "\[Equilibrium]", " ", "B"}], "e"], " ", ",", 
              RowBox[{"Sequence", "@@", "k"}]}], "}"}]}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"r", "=", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"A", "+", "e"}], "\[Rule]", " ", 
             RowBox[{"Diamond", "[", 
              RowBox[{"A", ",", "e"}], "]"}]}], ",", " ", 
            RowBox[{"k", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Diamond", "[", 
              RowBox[{"A", ",", "e"}], "]"}], "\[Rule]", " ", 
             RowBox[{"e", "+", "A"}]}], ",", " ", 
            RowBox[{"k", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Diamond", "[", 
              RowBox[{"A", ",", " ", "e"}], "]"}], "\[Rule]", " ", 
             RowBox[{"Diamond", "[", 
              RowBox[{"B", ",", " ", "e"}], "]"}]}], ",", " ", 
            RowBox[{"k", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Diamond", "[", 
              RowBox[{"B", ",", "e"}], "]"}], "\[Rule]", " ", 
             RowBox[{"Diamond", "[", 
              RowBox[{"A", ",", " ", "e"}], "]"}]}], ",", " ", 
            RowBox[{"k", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Diamond", "[", 
              RowBox[{"B", ",", "e"}], "]"}], "\[Rule]", " ", 
             RowBox[{"e", "+", "B"}]}], ",", " ", 
            RowBox[{"k", "[", 
             RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"e", "+", "B"}], "\[Rule]", " ", 
             RowBox[{"Diamond", "[", 
              RowBox[{"B", ",", " ", "e"}], "]"}]}], ",", " ", 
            RowBox[{"k", "[", 
             RowBox[{"[", "6", "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]",
          "}"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "r", "]"}]}]}], "]"}]}], ";"}], " "}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.442855707812359*^9, 3.442855733191951*^9}, {
   3.442855770837026*^9, 3.442855999803258*^9}, {3.44285627479751*^9, 
   3.44285641553778*^9}, {3.442856457512668*^9, 3.442856478223338*^9}, {
   3.442856515090425*^9, 3.442856533131548*^9}, {3.442856644890959*^9, 
   3.442856646556291*^9}, {3.442856707416807*^9, 3.442856724687321*^9}, {
   3.442856845143148*^9, 3.442856847422606*^9}, {3.442856896646492*^9, 
   3.442857000793293*^9}, 3.442857093814884*^9, 3.442857128006597*^9, {
   3.442857182149704*^9, 3.442857204628417*^9}, {3.442857681822545*^9, 
   3.442857682075146*^9}, {3.442857776951956*^9, 3.442857794646693*^9}, {
   3.442858554447895*^9, 3.442858654532866*^9}, {3.442858747306207*^9, 
   3.442858759156047*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["ExpandReaction   (unknown)", "Subsubsection",
 CellChangeTimes->{{3.44285888736004*^9, 3.442858894967963*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExpandReaction", "[", "x___", "]"}], ":=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<Error: ExpandReaction: Unknown reaction: \>\"", ",", " ", "x"}], 
      "]"}], ";", " ", 
     RowBox[{"Return", "[", "$Failed", "]"}]}], ")"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.442858896196021*^9, 3.442858929491706*^9}}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["SSA", "Section",
 CellChangeTimes->{{3.444590999706682*^9, 3.444591000768157*^9}}],

Cell["Main SSA Implementation", "Subsection",
 CellChangeTimes->{{3.443296574954145*^9, 3.443296579221047*^9}}],

Cell[CellGroupData[{

Cell["SSA ", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SSA", "[", 
    RowBox[{"r_", "?", "ListQ"}], "]"}], ":=", 
   RowBox[{"SSA", "[", 
    RowBox[{"r", ",", " ", "100", ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SSA", "[", 
    RowBox[{
     RowBox[{"r_", "?", "ListQ"}], ",", " ", 
     RowBox[{"tmax_", "?", "AtomQ"}]}], "]"}], ":=", 
   RowBox[{"SSA", "[", 
    RowBox[{"r", ",", " ", "tmax", ",", " ", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SSA", "[", 
     RowBox[{
      RowBox[{"r_", "?", "ListQ"}], ",", " ", 
      RowBox[{"tmax_", "?", "AtomQ"}], ",", " ", 
      RowBox[{"ic_", "?", "ListQ"}]}], "]"}], ":=", " ", 
    RowBox[{"SSA", "[", 
     RowBox[{"r", ",", " ", "tmax", ",", " ", "ic", ",", " ", 
      RowBox[{"{", "}"}]}], "]"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SSA", "[", 
    RowBox[{
     RowBox[{"r_", "?", "ListQ"}], ",", " ", 
     RowBox[{"tmax_", "?", "AtomQ"}], ",", " ", "ic_", ",", " ", "rates_", 
     ",", " ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"SSA", "[", 
    RowBox[{"r", ",", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "tmax"}], "}"}], ",", "ic", ",", "rates", ",", " ", 
     "opt"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SSA", "[", 
    RowBox[{
     RowBox[{"rin_", "?", "ListQ"}], ",", 
     RowBox[{"{", 
      RowBox[{"tmin_", ",", "tmax_"}], "}"}], ",", " ", "icInput_", ",", " ", 
     "ratesInput_", ",", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ok", ",", " ", "reac", ",", " ", "prods", ",", " ", "X", ",", "a", ",",
        " ", "anow", ",", " ", "Xnow", ",", " ", "xrules", ",", "defineX", 
       ",", " ", "t", ",", " ", "nmax", ",", " ", "ran", ",", " ", "r1", ",", 
       " ", "r2", ",", " ", "tau", ",", "sums", ",", "flags", ",", "mu", ",", 
       "k", ",", "i", ",", " ", "reactants", ",", " ", "products", ",", " ", 
       "results", ",", 
       RowBox[{"dbg", "=", " ", "True"}], ",", "dPrint", ",", " ", "icVar", 
       ",", "missingIC", ",", "ic", ",", "acheck", ",", "rates", ",", " ", 
       "nvars", ",", " ", "r", ",", " ", "mode", ",", " ", "s", ",", " ", "f",
        ",", " ", "xbefore", ",", " ", "changed", ",", " ", "newvalues", ",", 
       " ", "newnames", ",", " ", "indices", ",", " ", "ymin", ",", " ", 
       "ymax", ",", " ", "gfile", ",", " ", "sample", ",", " ", "tused", ",", 
       " ", "iused", ",", " ", "OutputVariable", ",", " ", "iv", ",", " ", 
       "summary", ",", "   ", "summarize", ",", " ", "itransitions", ",", " ",
        "findrates", ",", " ", "TimeCourse", ",", " ", "Quiet", ",", " ", 
       "averages", ",", "SSstart", ",", " ", "ss0", ",", " ", "SSMODE", ",", 
       " ", "qPrint", ",", " ", "nss"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"qPrint", "[", "x___", "]"}], ":=", " ", 
       RowBox[{"If", "[", 
        RowBox[{"False", ",", " ", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<SSA:\>\"", ",", "x"}], "]"}], ";"}]}], " ", "]"}]}], 
      ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"tused", "=", 
       RowBox[{"SessionTime", "[", "]"}]}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"nmax", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<MaxSteps\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<MaxSteps\>\"", "\[Rule]", " ", 
          RowBox[{"10", "^", "6"}]}], "}"}]}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"mode", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<Mode\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Mode\>\"", "\[Rule]", " ", "\"\<List\>\""}], "}"}]}]}], 
      ";", " ", "\[IndentingNewLine]", 
      RowBox[{"dbg", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<Debug\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Debug\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sample", " ", "=", " ", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"\"\<Sample\>\"", "/.", 
           RowBox[{"{", "opt", "}"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{"\"\<Sample\>\"", "\[Rule]", " ", "1"}], "}"}]}], ",", " ",
          "1"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"summary", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<Summary\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Summary\>\"", "\[Rule]", " ", "True"}], "}"}]}]}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{"summarize", "=", 
       RowBox[{
        RowBox[{"\"\<Summarize\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Summarize\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], 
      ";", " ", "\[IndentingNewLine]", 
      RowBox[{"summarize", "=", 
       RowBox[{"oksummarize", "[", 
        RowBox[{"summarize", ",", "mode"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"SSstart", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<SteadyStateStart\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<SteadyStateStart\>\"", "\[Rule]", " ", "\[Infinity]"}], 
         "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"findrates", "=", 
       RowBox[{
        RowBox[{"\"\<Rates\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Rates\>\"", "\[Rule]", " ", 
          RowBox[{"{", "}"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SSstart", "<", "Infinity"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"findrates", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{"SSstart", "/", "tmax"}], "}"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"rates", " ", "=", " ", 
       RowBox[{"okfindrates", "[", 
        RowBox[{"findrates", ",", " ", "mode"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"TimeCourse", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<TimeCourse\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<TimeCourse\>\"", "\[Rule]", " ", "True"}], "}"}]}]}], 
      ";", " ", "\[IndentingNewLine]", 
      RowBox[{"Quiet", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<Quiet\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Quiet\>\"", "->", " ", "False"}], "}"}]}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"SSMODE", "=", "False"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"nss", "=", "0"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dPrint", "[", "x___", "]"}], ":=", " ", 
       RowBox[{"If", "[", 
        RowBox[{"dbg", ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<SSA: \>\"", ",", " ", "x"}], "]"}]}], "]"}]}], ";", 
      " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ran", ":=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       StyleBox[" ",
        Background->GrayLevel[1]], 
       StyleBox[
        RowBox[{
         RowBox[{
          RowBox[{
          "X", " ", "is", " ", "the", " ", "vector", " ", "of", " ", 
           "species"}], ",", " ", "and"}], " ", "\[IndentingNewLine]", " ", 
         RowBox[{
         "a", " ", "the", " ", "vector", " ", "or", " ", "propensities", " ", 
          "as", " ", "defined", " ", "by", " ", 
          RowBox[{"Gillespie", "'"}], "s", " ", "SSA"}]}],
        Background->GrayLevel[1]], 
       StyleBox[" ",
        Background->GrayLevel[1]], "\[IndentingNewLine]", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"r", "=", 
       RowBox[{
        RowBox[{"rin", "/.", 
         RowBox[{"{", 
          RowBox[{"ShortRightArrow", "\[Rule]", " ", "Rule"}], "}"}]}], "/.", 
        "ratesInput"}]}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"r", "=", 
       RowBox[{"ExpandReactions", "[", "r", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"ok", "=", 
       RowBox[{"SSACheck", "[", "r", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "ok", "]"}], "\[Equal]", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", "\"\<Error: SSA: No valid reactions in model.\>\"", 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<ok: \>\"", ",", " ", "ok"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"reac", ",", " ", "prods", ",", " ", "a"}], "}"}], "=", 
       "ok"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<a=\>\"", ",", " ", "a"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"X", "=", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{"reac", ",", "prods"}], "]"}], "//", "Flatten"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"X", "=", 
       RowBox[{"Sort", "[", 
        RowBox[{"Complement", "[", 
         RowBox[{"X", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "Global`\[EmptySet]"}], "}"}]}], "]"}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<X:\>\"", ",", "X"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       StyleBox[" ",
        Background->GrayLevel[1]], 
       StyleBox[
        RowBox[{
        "check", " ", "for", " ", "missing", " ", "initial", " ", 
         "conditions"}],
        Background->GrayLevel[1]], 
       StyleBox[" ",
        Background->GrayLevel[1]], 
       StyleBox["*)",
        Background->GrayLevel[1]]}], "\[IndentingNewLine]", 
      RowBox[{"ic", "=", "icInput"}], ";", "\[IndentingNewLine]", 
      RowBox[{"icVar", "=", 
       RowBox[{"First", "/@", "ic"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<icVar:\>\"", ",", " ", "icVar"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"missingIC", "=", 
       RowBox[{"Complement", "[", 
        RowBox[{"X", ",", "icVar"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "missingIC", "]"}], ">", "0"}], ",", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<Warning: \>\"", ",", " ", "Red"}], "]"}], ",", " ", 
            
            RowBox[{"Style", "[", 
             RowBox[{
             "\"\< the following variables are missing initial condtions, \
which are all assumed to be zero: \>\"", ",", "Blue"}], "]"}], ",", " ", 
            RowBox[{"Style", "[", 
             RowBox[{"missingIC", ",", " ", "Black"}], "]"}]}], "]"}], ";"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"missingIC", "=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "\[Rule]", " ", "0"}], "&"}], ",", "missingIC"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"ic", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"ic", ",", "missingIC"}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<ic:\>\"", ",", " ", "ic"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"rates", "=", "ratesInput"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"a", "=", 
       RowBox[{"a", "/.", "rates"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<a:\>\"", ",", " ", "a"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<a/.ic:\>\"", ",", " ", 
        RowBox[{"a", "/.", "ic"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       StyleBox[
        RowBox[{
        "check", " ", "for", " ", "missing", " ", "rate", " ", "constants"}],
        Background->GrayLevel[1]], 
       StyleBox[" ",
        Background->GrayLevel[1]], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"acheck", " ", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"a", "/.", "ic"}], ")"}], "/.", 
           RowBox[{"{", 
            RowBox[{"Times", "\[Rule]", " ", "List"}], "}"}]}], "]"}], ",", 
         " ", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"NumericQ", "[", "#", "]"}]}], "&"}]}], "]"}]}], " ", ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "acheck", "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Warning: the following rates are undefined and are assumed to \
be one: \>\"", ",", "acheck"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"acheck", " ", "=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "\[Rule]", " ", "1"}], "&"}], ",", " ", "acheck"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"rates", "=", 
          RowBox[{"Join", "[", " ", 
           RowBox[{"acheck", ",", "rates"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"a", "=", 
          RowBox[{"a", "/.", "rates"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"dPrint", "[", 
          RowBox[{"\"\<a(corrected):\>\"", ",", " ", "a"}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"XIndex", "[", "variable", "]"}], " ", "gives", " ", "the", 
        " ", "position", " ", "in", " ", "the", " ", "list", " ", "X", " ", 
        "of", " ", "the", " ", 
        RowBox[{"variable", "'"}], "s", " ", 
        RowBox[{"value", ".", " ", "It"}], " ", "is", " ", "done", " ", 
        "through", " ", "a", " ", "function", " ", "for", " ", "faster", " ", 
        "referencing"}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"defineX", "[", 
        RowBox[{"x_", ",", "y_"}], "]"}], ":=", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"XIndex", "[", "x", "]"}], "=", "y"}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Clear", "[", "XIndex", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"nvars", "=", 
       RowBox[{"Length", "[", "X", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"MapThread", "[", 
       RowBox[{"defineX", ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", 
          RowBox[{"Range", "[", "nvars", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"add", " ", "dummy", " ", "counters", " ", "for", " ", 
        RowBox[{"creation", "/", "annihilation"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"defineX", "[", 
       RowBox[{"0", ",", 
        RowBox[{"nvars", "+", "1"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"defineX", "[", 
       RowBox[{"Global`EmptySet", ",", " ", 
        RowBox[{"nvars", "+", "2"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Here", " ", "is", " ", "where", " ", "the", " ", "Gillespie", " ", 
        "algorithm", " ", "begins"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Xnow", " ", "contains", " ", "the", " ", "vector", " ", "of", " ", 
        "molecule", " ", "numbers", " ", "at", " ", "any", " ", "given", " ", 
        "time"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "anow", " ", "contains", " ", "the", " ", "vector", " ", "of", " ", 
        "propensity", " ", "values", " ", "at", " ", "any", " ", "given", " ",
         "time"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      
      RowBox[{"Xnow", "=", 
       RowBox[{"X", "/.", "ic"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"t", "=", "tmin"}], ";", "\[IndentingNewLine]", 
      RowBox[{"xrules", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Rule", ",", 
         RowBox[{"{", 
          RowBox[{"X", ",", "Xnow"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<xrules: \>\"", ",", " ", "xrules"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"indices", " ", "=", " ", 
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", "X", "]"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"ymin", " ", "=", " ", 
       RowBox[{"Min", "[", "Xnow", "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"ymax", " ", "=", " ", 
       RowBox[{"Max", "[", "Xnow", "]"}]}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"itransitions", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"{", 
          RowBox[{"Length", "[", "X", "]"}], "}"}]}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"averages", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"{", 
          RowBox[{"Length", "[", "X", "]"}], "}"}]}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"qPrint", "[", 
       RowBox[{"\"\<averages: \>\"", ",", " ", "averages"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "initialize", " ", "data", " ", "collection", " ", "data", " ", 
        "structure", " ", "or", " ", "file"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"iused", "=", "0"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"Switch", "[", 
       RowBox[{
       "mode", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\"\<List\>\"", ",", " ", 
        RowBox[{"results", "=", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"t", ",", "Xnow"}], "}"}], "}"}]}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\"\<SparseList\>\"", 
        ",", 
        RowBox[{
         RowBox[{"xbefore", "=", "Xnow"}], ";", "  ", "\[IndentingNewLine]", 
         RowBox[{"results", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"t", ",", " ", "#"}], "}"}], "}"}], "&"}], "/@", 
           "Xnow"}]}], ";"}], "\[IndentingNewLine]", ",", " ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\"\<Interpolation\>\"",
         ",", 
        RowBox[{
         RowBox[{"xbefore", "=", "Xnow"}], ";", "  ", "\[IndentingNewLine]", 
         RowBox[{"results", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"t", ",", " ", "#"}], "}"}], "}"}], "&"}], "/@", 
           "Xnow"}]}], ";"}], "\[IndentingNewLine]", ",", " ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\"\<Table\>\"", ",", " ", 
        RowBox[{"results", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<time\>\"", ",", "X"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"t", ",", " ", "Xnow"}], "}"}]}], "}"}]}], ",", " ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\"\<TableFile\>\"", 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"f", "=", 
          RowBox[{"NewFileName", "[", 
           RowBox[{"\"\<FileType\>\"", "\[Rule]", " ", "\"\<dat\>\""}], 
           "]"}]}], ";", " ", 
         RowBox[{"s", "=", 
          RowBox[{"OpenWrite", "[", "f", "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"gfile", "=", 
          RowBox[{"StringReplace", "[", 
           RowBox[{"f", ",", " ", 
            RowBox[{"\"\<.dat\>\"", "\[Rule]", " ", "\"\<.p\>\""}]}], "]"}]}],
          ";", " ", "\[IndentingNewLine]", 
         RowBox[{"SetOptions", "[", 
          RowBox[{"s", ",", " ", 
           RowBox[{"FormatType", "\[Rule]", " ", "StandardForm"}]}], "]"}], 
         ";", " ", "\[IndentingNewLine]", 
         RowBox[{"results", "=", "f"}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "results", " ", "are", " ", "not", " ", "recorded", " ", 
           "internally", " ", "so", " ", "return", " ", "file", " ", "name"}],
           " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Write", "[", 
          RowBox[{"s", ",", " ", 
           RowBox[{"ExportString", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{"\"\<# time\>\"", ",", " ", "X"}], "}"}], "]"}], 
              "}"}], ",", " ", "\"\<tsv\>\""}], "]"}]}], "]"}], ";"}], 
        "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\"\<Variable\>\"", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"xbefore", "=", "Xnow"}], ";", "\[IndentingNewLine]", 
         RowBox[{"OutputVariable", "=", 
          RowBox[{
           RowBox[{"\"\<OutputVariable\>\"", "/.", 
            RowBox[{"{", "opt", "}"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{
            "\"\<OutputVariable\>\"", "\[Rule]", " ", "\"\<Unknown\>\""}], 
            "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"X", ",", "OutputVariable"}], "]"}]}], ",", " ", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<Error: SSA: \>\"", ",", " ", "Red"}], "]"}], ",", 
              " ", 
              RowBox[{
              "\"\<In \\\"Variable\\\" mode, selected \\\"OutputVariable\\\"\
\[Rule]\\\"\>\"", "<>", 
               RowBox[{"ToString", "[", "OutputVariable", "]"}], "<>", 
               "\"\<\\\" unspecified or not found\>\""}]}], "]"}], ";", " ", 
            RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"iv", "=", 
          RowBox[{"Position", "[", 
           RowBox[{"X", ",", " ", "OutputVariable"}], "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{"ListQ", "[", "iv", "]"}], ",", " ", 
           RowBox[{"iv", "=", 
            RowBox[{"First", "[", "iv", "]"}]}]}], "]"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"results", "=", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"t", ",", 
             RowBox[{"Xnow", "[", 
              RowBox[{"[", "iv", "]"}], "]"}]}], "}"}], "}"}]}], ";"}], 
        "\[IndentingNewLine]", " ", ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\"\<Variables\>\"", ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"xbefore", "=", "Xnow"}], ";", "\[IndentingNewLine]", 
         RowBox[{"OutputVariable", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<Variables\>\"", "/.", 
              RowBox[{"{", "opt", "}"}]}], "/.", 
             RowBox[{"{", 
              RowBox[{"\"\<Variables\>\"", "\[Rule]", " ", 
               RowBox[{"{", "}"}]}], "}"}]}], "}"}], "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "OutputVariable", "]"}], "<", "1"}], ",", 
           " ", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<Error: SSA: \>\"", ",", " ", "Red"}], "]"}], ",", 
              " ", 
              RowBox[{"Style", "[", 
               RowBox[{"\"\<\\\"Variables\\\"\>\"", ",", " ", "Blue"}], "]"}],
               ",", " ", 
              "\"\< not specified in \
\\\"Mode\\\"\[Rule]\\\"Variables\\\"\>\""}], "]"}], ";", " ", 
            RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", " ", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{"X", ",", "#"}], "]"}]}], ",", " ", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<Error: SSA:\>\"", ",", "Red"}], "]"}], ",", 
                 "   ", 
                 RowBox[{
                 "\"\< In \\\"Variables\\\" mode, selected \\\"OutputVariable\
\\\"\[Rule]\>\"", "<>", 
                  RowBox[{"ToString", "[", "#", "]"}], "<>", " ", 
                  "\"\< does not exist in model.\>\""}]}], "]"}], ";", " ", 
               RowBox[{"Abort", "[", "]"}]}]}], "]"}], ")"}], "&"}], "/@", 
          "OutputVariable"}], ";", " ", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"iv", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{"X", ",", " ", "#"}], "]"}], "&"}], "/@", 
           "OutputVariable"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"iv", "=", 
          RowBox[{"Flatten", "[", "iv", "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"results", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{"\"\<t\>\"", ",", " ", 
               RowBox[{"ToString", "/@", 
                RowBox[{"X", "[", 
                 RowBox[{"[", "iv", "]"}], "]"}]}]}], "}"}], "]"}], ",", " ", 
            
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{"t", ",", 
               RowBox[{"Xnow", "[", 
                RowBox[{"[", "iv", "]"}], "]"}]}], "}"}], "]"}]}], "}"}]}], 
         ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "_", ",", " ", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Error: SSA: Unknown mode: \>\"", ",", " ", "mode", ",", " ", 
           "\"\< valid modes are : List, SparseList, Interpolation, Table, \
TableFile\>\""}], "]"}], ";", " ", 
         RowBox[{"Return", "[", "$Failed", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"i", "=", "0"}], ";", 
      RowBox[{"a0", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"i", "++"}], "<", "nmax"}], "&&", 
         RowBox[{"t", "<", "tmax"}], "  ", "&&", " ", 
         RowBox[{"a0", ">", "0"}]}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Step", " ", "1", " ", "of", " ", "figure", " ", "2"}], ",",
           " ", 
          RowBox[{"page", " ", "2341"}]}], " ", "*)"}], "\[IndentingNewLine]",
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"xrules", "=", 
          RowBox[{"MapThread", "[", 
           RowBox[{"Rule", ",", 
            RowBox[{"{", 
             RowBox[{"X", ",", "Xnow"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"anow", "=", 
          RowBox[{"a", "/.", "xrules"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"a0", "=", 
          RowBox[{"Plus", "@@", "anow"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"dbg", ",", " ", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<t,a=\>\"", ",", "t", ",", "\"\<,\>\"", ",", "anow"}],
             "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"dbg", ",", " ", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<xrules=\>\"", ",", "xrules"}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"a0", ">", "0"}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"Step", " ", "2"}], ":", " ", 
             RowBox[{
             "generate", " ", "random", " ", "numbers", " ", "r1", " ", "and",
               " ", "r2", " ", "to", " ", "calculate", " ", "mu", " ", 
              RowBox[{"(", 
               RowBox[{"here", " ", "called", " ", "k"}], ")"}], " ", "and", 
              " ", "tau"}]}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"r1", "=", "ran"}], ";", "\[IndentingNewLine]", 
            RowBox[{"tau", "=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "/", "a0"}], ")"}], 
              RowBox[{"Log", "[", 
               RowBox[{"1", "/", "r1"}], "]"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"t", "=", 
             RowBox[{"t", "+", "tau"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"sums", "=", 
             RowBox[{"Rest", "[", 
              RowBox[{"FoldList", "[", 
               RowBox[{"Plus", ",", "0", ",", "anow"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"update", " ", "running", " ", "averages", " ", 
               RowBox[{"(", "numerater", ")"}], " ", "if", " ", "needed"}], 
              ",", " ", "or"}], " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "set", " ", "start", " ", "time", " ", "of", " ", "steady", " ", 
              "state", " ", "average", " ", "calculation", " ", "if", " ", 
              "required", " ", "and", " ", "turn", " ", "on", " ", "SSMODE"}],
              " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{"SSMODE", ",", " ", "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{"\"\<averages:\>\"", ",", " ", "averages"}], "]"}], 
                ";", " ", "\[IndentingNewLine]", 
                RowBox[{"Print", "[", 
                 RowBox[{"\"\<Xnow:\>\"", ",", " ", "Xnow"}], "]"}], ";", " ",
                 "\[IndentingNewLine]", 
                RowBox[{"Print", "[", 
                 RowBox[{"\"\<tau: \>\"", ",", " ", "tau"}], "]"}], ";", " ", 
                "\[IndentingNewLine]", 
                RowBox[{"Abort", "[", "]"}], ";"}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"nss", "++"}], ";", " ", "\[IndentingNewLine]", 
               RowBox[{"averages", " ", "=", " ", 
                RowBox[{"averages", " ", "+", " ", 
                 RowBox[{"Xnow", "*", "tau"}]}]}], ";", " ", 
               "\[IndentingNewLine]", 
               RowBox[{"qPrint", "[", 
                RowBox[{
                "\"\<tau=\>\"", ",", " ", "tau", ",", "\"\< averages: \>\"", 
                 ",", 
                 RowBox[{"MapThread", "[", 
                  RowBox[{"Rule", ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"X", ",", " ", "averages"}], "}"}]}], "]"}]}], 
                "]"}], ";"}], " ", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", " ", 
              RowBox[{"(*", " ", 
               RowBox[{"use", " ", "old", " ", "Xvalues"}], " ", "*)"}], ",", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{"when", " ", "first", " ", "past", " ", "SSstart"}], 
                ",", " ", 
                RowBox[{
                "set", " ", "start", " ", "time", " ", "to", " ", "next", " ",
                  "time", " ", "point"}]}], " ", "*)"}], " ", 
              "\[IndentingNewLine]", " ", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"t", "-", "tau"}], "\[GreaterEqual]", " ", 
                  "SSstart"}], ",", " ", 
                 RowBox[{
                  RowBox[{"SSstart", " ", "=", " ", "t"}], ";", " ", 
                  RowBox[{"SSMODE", "=", "True"}], ";", " ", 
                  RowBox[{"qPrint", "[", 
                   RowBox[{"\"\<SSstart=\>\"", ",", "SSstart"}], "]"}]}]}], 
                "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "continue", " ", "with", " ", "Gillespie", " ", "Algorithm"}], 
             " ", "*)"}], "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
            RowBox[{"r2", "=", "ran"}], ";", "\[IndentingNewLine]", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"k", "=", "1"}], ",", " ", 
              RowBox[{
               RowBox[{"sums", "[", 
                RowBox[{"[", "k", "]"}], "]"}], "<", 
               RowBox[{"a0", "*", "r2"}]}], ",", " ", 
              RowBox[{"k", "++"}]}], "]"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"step", " ", "3"}], " ", "-", " ", 
              RowBox[{
              "increment", " ", "appropriate", " ", "molecule", " ", 
               "numbers"}]}], " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"reac", "[", 
                 RowBox[{"[", "k", "]"}], "]"}], " ", "and", " ", 
                RowBox[{"prods", "[", 
                 RowBox[{"[", "k", "]"}], "]"}], " ", "gives", " ", "the", 
                " ", "LHS"}], " ", "&"}], " ", "RHS", " ", "species", " ", 
              "in", " ", "reaction", " ", "k"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"but", " ", 
              RowBox[{"don", "'"}], "t", " ", "bother", " ", "counting", " ", 
              "the", " ", "empty", " ", "sets", " ", "and", " ", "zeroes"}], 
             " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"reactants", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"XIndex", "/@", 
                RowBox[{"reac", "[", 
                 RowBox[{"[", "k", "]"}], "]"}]}], ",", " ", 
               RowBox[{
                RowBox[{"#", "\[LessEqual]", "nvars"}], "&"}]}], "]"}]}], ";",
             "\[IndentingNewLine]", 
            RowBox[{"products", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"XIndex", "/@", 
                RowBox[{"prods", "[", 
                 RowBox[{"[", "k", "]"}], "]"}]}], ",", " ", 
               RowBox[{
                RowBox[{"#", "\[LessEqual]", "nvars"}], "&"}]}], "]"}]}], ";",
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "Increment", " ", "all", " ", "the", " ", "products", " ", "and",
               " ", "decrement", " ", "all", " ", "reactants"}], "*)"}], 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"dPrint", "[", 
             RowBox[{"\"\<reactants: \>\"", ",", " ", "reactants"}], "]"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"dPrint", "[", 
             RowBox[{"\"\<products:  \>\"", ",", "products"}], "]"}], ";", 
            " ", "\[IndentingNewLine]", 
            RowBox[{"dPrint", "[", 
             RowBox[{"\"\<Xnow: \>\"", ",", " ", "Xnow"}], "]"}], ";", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Xnow", "[", 
                 RowBox[{"[", "#", "]"}], "]"}], "--"}], "&"}], ",", 
              "reactants"}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Xnow", "[", 
                 RowBox[{"[", "#", "]"}], "]"}], "++"}], "&"}], ",", 
              "products"}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"dPrint", "[", 
             RowBox[{"\"\<Xnow: \>\"", ",", " ", "Xnow"}], "]"}], ";", " ", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"save", " ", "the", " ", "data", " ", "vales"}], " ", 
             "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Mod", "[", 
                RowBox[{"i", ",", " ", "sample"}], "]"}], "\[Equal]", "0"}], 
              ",", " ", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"iused", "++"}], ";", " ", "\[IndentingNewLine]", 
               RowBox[{
               "Which", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{"save", " ", "values", " ", "internally"}], " ", 
                 "*)"}], "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"mode", " ", "\[Equal]", " ", "\"\<List\>\""}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"AppendTo", "[", 
                  RowBox[{"results", ",", 
                   RowBox[{"{", 
                    RowBox[{"t", ",", "Xnow"}], "}"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", 
                  RowBox[{
                  "save", " ", "only", " ", "changed", " ", "values", " ", 
                   "internally"}], " ", "*)"}], "\[IndentingNewLine]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"mode", "\[Equal]", " ", "\"\<SparseList\>\""}], 
                   " ", "\[Or]", " ", 
                   RowBox[{"mode", "\[Equal]", "\"\<Interpolation\>\""}]}], 
                  ")"}], ",", " ", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"changed", " ", "=", " ", 
                   RowBox[{"Not", "/@", 
                    RowBox[{"MapThread", "[", 
                    RowBox[{"Equal", ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"xbefore", ",", " ", "Xnow"}], "}"}]}], "]"}]}]}],
                   ";", " ", "\[IndentingNewLine]", 
                  RowBox[{"newvalues", " ", "=", " ", 
                   RowBox[{"Pick", "[", 
                    RowBox[{"Xnow", ",", " ", "changed"}], "]"}]}], ";", " ", 
                  "\[IndentingNewLine]", 
                  RowBox[{"newnames", "=", 
                   RowBox[{"Pick", "[", 
                    RowBox[{"indices", ",", " ", "changed"}], "]"}]}], ";", 
                  " ", "\[IndentingNewLine]", 
                  RowBox[{"For", "[", 
                   RowBox[{
                    RowBox[{"j", "=", "1"}], ",", " ", 
                    RowBox[{"j", "\[LessEqual]", " ", 
                    RowBox[{"Length", "[", "newnames", "]"}]}], ",", " ", 
                    RowBox[{"j", "++"}], ",", " ", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{
                    RowBox[{"results", "[", 
                    RowBox[{"[", 
                    RowBox[{"newnames", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"t", ",", " ", 
                    RowBox[{"newvalues", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}],
                   ";", " ", "\[IndentingNewLine]", " ", 
                  RowBox[{"dPrint", "[", 
                   RowBox[{
                   "\"\<changed: \>\"", ",", " ", "changed", ",", " ", 
                    "\"\< newvalues: \>\"", ",", " ", "newvalues", ",", " ", 
                    "\"\< newnames: \>\"", ",", " ", "newnames"}], "]"}], ";",
                   " ", "\[IndentingNewLine]", " ", 
                  RowBox[{"xbefore", "=", "Xnow"}], ";"}], 
                 "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", 
                  RowBox[{
                  "save", " ", "table", " ", "of", " ", "values", " ", 
                   "internally"}], " ", "*)"}], "\[IndentingNewLine]", 
                 RowBox[{"(", 
                  RowBox[{"mode", "\[Equal]", " ", "\"\<Table\>\""}], ")"}], 
                 ",", " ", "\[IndentingNewLine]", 
                 RowBox[{"AppendTo", "[", 
                  RowBox[{"results", ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"t", ",", " ", "Xnow"}], "}"}]}], "]"}], ",", " ",
                  "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", 
                  RowBox[{
                  "write", " ", "line", " ", "of", " ", "data", " ", "to", 
                   " ", "file"}], " ", "*)"}], "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", 
                  RowBox[{
                   RowBox[{"Table", " ", "File"}], ",", " ", 
                   RowBox[{
                    RowBox[{"determine", " ", "y"}], "-", 
                    RowBox[{"ranges", " ", "for", " ", "gnuplot"}]}]}], " ", 
                  "*)"}], " ", "\[IndentingNewLine]", 
                 RowBox[{"(", 
                  RowBox[{"mode", "==", "\"\<TableFile\>\""}], ")"}], ",", 
                 " ", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Write", "[", 
                   RowBox[{"s", ",", " ", 
                    RowBox[{"ExportString", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"{", 
                    RowBox[{"t", ",", " ", "Xnow"}], "}"}], "]"}], "}"}], ",",
                     " ", "\"\<tsv\>\""}], "]"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"ymin", "  ", "=", " ", 
                   RowBox[{"Min", " ", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"{", 
                    RowBox[{"ymin", ",", " ", "Xnow"}], "}"}], "]"}], "]"}]}],
                   ";", " ", "\[IndentingNewLine]", 
                  RowBox[{"ymax", "  ", "=", " ", 
                   RowBox[{"Max", " ", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"{", 
                    RowBox[{"ymax", ",", " ", "Xnow"}], "}"}], "]"}], "]"}]}],
                   ";"}], " ", "\[IndentingNewLine]", ",", 
                 "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"(", 
                  RowBox[{"mode", "\[Equal]", "\"\<Variable\>\""}], ")"}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"itransitions", " ", "+=", " ", 
                   RowBox[{"Abs", "/@", 
                    RowBox[{"(", 
                    RowBox[{"Xnow", "-", "xbefore"}], ")"}]}]}], ";", " ", 
                  "\[IndentingNewLine]", 
                  RowBox[{"changed", "=", 
                   RowBox[{
                    RowBox[{"Xnow", "[", 
                    RowBox[{"[", "iv", "]"}], "]"}], "\[NotEqual]", " ", 
                    RowBox[{"xbefore", "[", 
                    RowBox[{"[", "iv", "]"}], "]"}]}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{"changed", ",", "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"results", ",", 
                    RowBox[{"{", 
                    RowBox[{"t", ",", 
                    RowBox[{"Xnow", "[", 
                    RowBox[{"[", "iv", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"iused", "=", 
                    RowBox[{"iused", "-", "1"}]}]}], "\[IndentingNewLine]", 
                   "]"}], ";", " ", "\[IndentingNewLine]", 
                  RowBox[{"xbefore", "=", "Xnow"}], ";"}], 
                 "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(", 
                  RowBox[{"mode", "\[Equal]", "\"\<Variables\>\""}], ")"}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"itransitions", " ", "+=", " ", 
                   RowBox[{"Abs", "/@", 
                    RowBox[{"(", 
                    RowBox[{"Xnow", "-", "xbefore"}], ")"}]}]}], ";", " ", 
                  "\[IndentingNewLine]", 
                  RowBox[{"changed", "=", 
                   RowBox[{
                    RowBox[{"Xnow", "[", 
                    RowBox[{"[", "iv", "]"}], "]"}], "\[NotEqual]", " ", 
                    RowBox[{"xbefore", "[", 
                    RowBox[{"[", "iv", "]"}], "]"}]}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{"changed", ",", "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"results", ",", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"{", 
                    RowBox[{"t", ",", 
                    RowBox[{"Xnow", "[", 
                    RowBox[{"[", "iv", "]"}], "]"}]}], "}"}], "]"}]}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"iused", "=", 
                    RowBox[{"iused", "-", "1"}]}]}], "\[IndentingNewLine]", 
                   "]"}], ";", " ", "\[IndentingNewLine]", 
                  RowBox[{"xbefore", "=", "Xnow"}], ";"}], 
                 "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                 "\[IndentingNewLine]", "True", ",", " ", 
                 RowBox[{
                  RowBox[{"Print", "[", 
                   RowBox[{
                   "\"\<Error: SSA: Unimplemented mode (normal step): \>\"", 
                    ",", " ", "mode"}], " ", "]"}], ";", " ", 
                  RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]",
                 "]"}]}]}], " ", 
             RowBox[{"(*", " ", 
              RowBox[{"end", " ", "Which"}], " ", "*)"}], 
             "\[IndentingNewLine]", "]"}]}]}], "   ", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"End", " ", "if", " ", 
             RowBox[{"Mod", " ", "[", 
              RowBox[{"i", ",", " ", "sample"}], "]"}]}], " ", ".."}], " ", 
           "*)"}], "\[IndentingNewLine]", "]"}]}]}], "    ", 
       RowBox[{"(*", " ", 
        RowBox[{"End", " ", "For"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
       "]"}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"End", " ", "If", " ", "a0"}], " ", ".."}], " ", "*)"}], " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"handle", " ", "max", " ", "reaction", " ", "count"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"t", "<", "tmax"}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{"True", " ", 
           RowBox[{"(*", " ", "dbg", " ", "*)"}], ",", "\[IndentingNewLine]", 
           
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"a0", ">", "0"}], ",", 
             RowBox[{"Print", "[", 
              RowBox[{
              "nmax", ",", "\"\< reactions at t=\>\"", ",", " ", "t"}], "]"}],
              ",", "\[IndentingNewLine]", 
             RowBox[{"Print", "[", 
              RowBox[{"\"\<a0 = 0 at t=\>\"", ",", "t"}], "]"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"SSMODE", ",", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"averages", " ", "=", " ", 
          RowBox[{"averages", "/", 
           RowBox[{"(", 
            RowBox[{"t", "-", "SSstart"}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"qPrint", "[", 
          RowBox[{"\"\<averages: \>\"", ",", " ", 
           RowBox[{"MapThread", "[", 
            RowBox[{"Rule", ",", " ", 
             RowBox[{"{", 
              RowBox[{"X", ",", " ", "averages"}], "}"}]}], "]"}]}], "]"}], 
         ";"}]}], " ", "\[IndentingNewLine]", "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<results: \>\"", ",", " ", "results"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "finish", " ", "up", " ", "data", " ", "or", " ", "data", " ", 
        "file"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Switch", "[", 
       RowBox[{
       "mode", ",", "\[IndentingNewLine]", "\"\<List\>\"", ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"t", "=", 
          RowBox[{"First", "/@", "results"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"results", "=", 
          RowBox[{"Last", "/@", "results"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"results", "=", 
          RowBox[{"Transpose", "[", "results", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"results", "=", 
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Rule", "[", 
              RowBox[{"#1", ",", " ", 
               RowBox[{"Transpose", "[", 
                RowBox[{"{", 
                 RowBox[{"t", ",", "#2"}], "}"}], "]"}]}], "]"}], "&"}], ",", 
            
            RowBox[{"{", 
             RowBox[{"X", ",", "results"}], "}"}]}], "]"}]}], ";"}], 
        "\[IndentingNewLine]", ",", " ", "\[IndentingNewLine]", 
        "\"\<SparseList\>\"", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"results", " ", "=", " ", 
          RowBox[{"MapThread", "[", 
           RowBox[{"Rule", ",", " ", 
            RowBox[{"{", 
             RowBox[{"X", ",", " ", "results"}], "}"}]}], "]"}]}], ";"}], " ",
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        "\"\<Interpolation\>\"", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"results", " ", "=", " ", 
          RowBox[{"MapThread", "[", 
           RowBox[{"Rule", ",", " ", 
            RowBox[{"{", 
             RowBox[{"X", ",", " ", "results"}], "}"}]}], "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"results", "=", 
          RowBox[{"SSAFit", "[", "results", "]"}]}], ";"}], " ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
        "\[IndentingNewLine]", "\"\<Table\>\"", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"results", " ", "=", " ", 
          RowBox[{"Flatten", "/@", "results"}]}], ";"}], 
        "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Write", " ", "out", " ", "the", " ", "TSV", " ", "file", " ", "and",
           " ", "a", " ", "GNUPLOT", " ", "file"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\"\<TableFile\>\"", ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Close", "[", "s", "]"}], ";", " ", "\[IndentingNewLine]", 
         RowBox[{"results", "=", 
          RowBox[{"ToFileName", "[", 
           RowBox[{
            RowBox[{"Directory", "[", "]"}], ",", " ", "f"}], "]"}]}], ";", 
         " ", "\[IndentingNewLine]", 
         RowBox[{"Export", "[", 
          RowBox[{"gfile", ",", " ", 
           RowBox[{"gnuplotheader", "[", 
            RowBox[{
            "tmin", ",", "tmax", ",", " ", "ymin", ",", " ", "ymax", ",", " ",
              "X", ",", " ", "f"}], "]"}], ",", " ", "\"\<text\>\""}], "]"}], 
         ";"}], " ", "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\"\<Variable\>\"", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AppendTo", "[", 
          RowBox[{"results", ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", 
             RowBox[{"Xnow", "[", 
              RowBox[{"[", "iv", "]"}], "]"}]}], "}"}]}], "]"}], ";"}], " ", 
        "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\"\<Variables\>\"", ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AppendTo", "[", 
          RowBox[{"results", ",", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"t", ",", 
              RowBox[{"Xnow", "[", 
               RowBox[{"[", "iv", "]"}], "]"}]}], "}"}], "]"}]}], "]"}], 
         ";"}], " ", "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "_", ",", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Error: SSA: unimplemented mode (file termination): \>\"", ",", 
          " ", "mode"}], "]"}]}], "\[IndentingNewLine]", "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"summarize", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Block", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"info", ",", " ", "sim"}], "}"}], ",", " ", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"sim", " ", "=", " ", "results"}], ";", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"info", "=", 
             RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"info", ",", " ", 
              RowBox[{"\"\<Steps\>\"", "\[Rule]", " ", "i"}]}], "]"}], ";", 
            " ", "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"info", ",", " ", 
              RowBox[{"\"\<FinalValues\>\"", "\[Rule]", " ", 
               RowBox[{"MapThread", "[", 
                RowBox[{"Rule", ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"X", ",", " ", "Xnow"}], "}"}]}], "]"}]}]}], "]"}], 
            ";", " ", "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"info", ",", 
              RowBox[{"\"\<FinalTime\>\"", "\[Rule]", " ", "t"}]}], "]"}], 
            ";", " ", "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"info", ",", " ", 
              RowBox[{"\"\<Transitions\>\"", "\[Rule]", " ", 
               RowBox[{"MapThread", "[", 
                RowBox[{"Rule", ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"X", ",", " ", "itransitions"}], "}"}]}], "]"}]}]}],
              "]"}], ";", " ", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{"SSMODE", ",", " ", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"AppendTo", "[", 
                RowBox[{"info", ",", " ", 
                 RowBox[{"\"\<SteadyStates\>\"", "\[Rule]", " ", 
                  RowBox[{"MapThread", "[", 
                   RowBox[{"Rule", ",", 
                    RowBox[{"{", 
                    RowBox[{"X", ",", " ", "averages"}], "}"}]}], "]"}]}]}], 
                "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"info", ",", " ", 
                 RowBox[{
                 "\"\<SteadyStateStart\>\"", "\[Rule]", " ", "SSstart"}]}], 
                "]"}], ";", " ", "\[IndentingNewLine]", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"info", ",", " ", 
                 RowBox[{
                 "\"\<SteadyStatePoints\>\"", "\[Rule]", " ", "nss"}]}], 
                "]"}], ";"}]}], " ", "\[IndentingNewLine]", "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "findrates", "]"}], ">", "0"}], ",", 
              " ", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"dPrint", "[", 
                RowBox[{"\"\<finding rates: \>\"", ",", " ", "findrates"}], 
                "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"Block", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "amount2Take", ",", " ", "rateresults", ",", " ", 
                   "variable", ",", " ", "header", ",", " ", "data", ",", " ",
                    "variables", " ", ",", " ", "times", ",", " ", "n", ",", 
                   " ", "TakeAmounts", ",", " ", "TheRates", ",", 
                   "TheIntcpts", ",", "Sigmas", ",", "  ", "m", ",", " ", "b",
                    ",", " ", "ratesigs"}], "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"rateresults", "=", 
                   RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
                  RowBox[{"ratesigs", "=", 
                   RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
                  "\[IndentingNewLine]", 
                  RowBox[{"header", " ", "=", " ", 
                   RowBox[{"sim", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", 
                  "\[IndentingNewLine]", 
                  RowBox[{"variables", " ", "=", " ", 
                   RowBox[{"Rest", "[", "header", "]"}]}], ";", " ", 
                  "\[IndentingNewLine]", 
                  RowBox[{"variables", " ", "=", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"\"\<d\>\"", "<>", "#", "<>", "\"\</dt\>\""}], 
                    "&"}], "/@", "variables"}]}], ";", " ", 
                  "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{"dPrint", "[", "variables", "]"}], ";", " ", 
                  "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{"(*", " ", 
                   RowBox[{
                   "Convert", " ", "data", " ", "to", " ", "sets", " ", "of", 
                    " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"t", ",", "x"}], "}"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"t", ",", "x"}], "}"}], ",", " ", "..."}], "}"}], 
                    " ", "for", " ", "each", " ", "variable"}], " ", "*)"}], 
                  " ", "\[IndentingNewLine]", 
                  RowBox[{"data", " ", "=", " ", 
                   RowBox[{"Most", "[", 
                    RowBox[{"Rest", "[", "sim", "]"}], "]"}]}], ";", " ", 
                  "\[IndentingNewLine]", 
                  RowBox[{"n", "=", 
                   RowBox[{"Length", "[", "data", "]"}]}], ";", " ", 
                  "\[IndentingNewLine]", 
                  RowBox[{"dPrint", "[", 
                   RowBox[{"\"\<n=\>\"", ",", " ", "n"}], "]"}], ";", " ", 
                  "\[IndentingNewLine]", 
                  RowBox[{"TakeAmounts", " ", "=", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Floor", "[", 
                    RowBox[{"#", "*", "n"}], "]"}], "&"}], "/@", 
                    "findrates"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"dPrint", "[", 
                   RowBox[{"\"\<TakeAmounts:\>\"", ",", " ", "TakeAmounts"}], 
                   "]"}], ";", " ", "\[IndentingNewLine]", 
                  RowBox[{"data", " ", "=", " ", 
                   RowBox[{"Transpose", "[", "data", "]"}]}], ";", " ", 
                  "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{"times", " ", "=", " ", 
                   RowBox[{"First", "[", "data", "]"}]}], ";", " ", 
                  "\[IndentingNewLine]", 
                  RowBox[{"data", " ", "=", " ", 
                   RowBox[{"Rest", "[", "data", "]"}]}], ";", " ", 
                  "\[IndentingNewLine]", 
                  RowBox[{"data", " ", "=", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"times", ",", " ", "#"}], "}"}], "&"}], "/@", 
                    "data"}]}], ";", " ", "\[IndentingNewLine]", 
                  RowBox[{"data", " ", "=", " ", 
                   RowBox[{"Transpose", "/@", "data"}]}], ";", " ", 
                  "\[IndentingNewLine]", 
                  RowBox[{"dPrint", "[", 
                   RowBox[{"\"\<Data:\\n\>\"", ",", " ", "data"}], "]"}], ";",
                   " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{"While", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "TakeAmounts", "]"}], ">", "0"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"amount2Take", "=", 
                    RowBox[{"First", "[", "TakeAmounts", "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"TakeAmounts", "=", 
                    RowBox[{"Rest", "[", "TakeAmounts", "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"dPrint", "[", 
                    RowBox[{"\"\<amount2Take=\>\"", ",", "amount2Take"}], 
                    "]"}], ";", " ", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"TheRates", "=", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"m", "/.", 
                    RowBox[{"FindFit", "[", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"-", "amount2Take"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"m", "*", "x"}], "+", "b"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "b"}], "}"}], ",", " ", "x"}], "]"}]}], 
                    "&"}], ",", " ", "data"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"TheIntcpts", "=", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", "/.", 
                    RowBox[{"FindFit", "[", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"-", "amount2Take"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"m", "*", "x"}], "+", "b"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "b"}], "}"}], ",", " ", "x"}], "]"}]}], 
                    "&"}], ",", " ", "data"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"Sigmas", "=", 
                    RowBox[{"MapThread", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"RSSError", "[", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{"#1", ",", 
                    RowBox[{"-", "amount2Take"}]}], "]"}], ",", "#2", ",", 
                    "#3"}], "]"}], "&"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"data", ",", "TheRates", ",", "TheIntcpts"}], 
                    "}"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    RowBox[{"TheRates", "=", 
                    RowBox[{"MapThread", "[", 
                    RowBox[{"Rule", ",", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Prepend", "[", 
                    RowBox[{"variables", ",", "\"\<n\>\""}], "]"}], ",", " ", 
                    
                    RowBox[{"Prepend", "[", 
                    RowBox[{"TheRates", ",", "amount2Take"}], "]"}]}], 
                    "}"}]}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"TheRates", "=", 
                    RowBox[{"MapThread", "[", 
                    RowBox[{"Rule", ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"variables", ",", " ", "TheRates"}], "}"}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Sigmas", "=", 
                    RowBox[{"MapThread", "[", 
                    RowBox[{"Rule", ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"variables", ",", " ", "Sigmas"}], "}"}]}], 
                    "]"}]}], ";", " ", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"dPrint", "[", 
                    RowBox[{"\"\<TheRates=\>\"", ",", " ", "TheRates"}], 
                    "]"}], ";", " ", "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"rateresults", ",", " ", "TheRates"}], "]"}], ";",
                     "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"ratesigs", ",", "Sigmas"}], "]"}], ";"}]}], " ", 
                   "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                  RowBox[{"rateresults", "=", 
                   RowBox[{"Flatten", "[", "rateresults", "]"}]}], ";", " ", 
                  "\[IndentingNewLine]", 
                  RowBox[{"ratesigs", " ", "=", " ", 
                   RowBox[{"Flatten", "[", "ratesigs", "]"}]}], ";", " ", 
                  "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"info", ",", " ", 
                    RowBox[{
                    "\"\<MeanProductionRates\>\"", "\[Rule]", " ", 
                    "rateresults"}]}], "]"}], ";", "\[IndentingNewLine]", 
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"info", ",", " ", 
                    RowBox[{"\"\<RatePoints\>\"", "\[Rule]", " ", "n"}]}], 
                   "]"}], ";", "\[IndentingNewLine]", 
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"info", ",", " ", 
                    RowBox[{
                    "\"\<RateRSSError\>\"", "\[Rule]", " ", "ratesigs"}]}], 
                   "]"}], ";"}]}], " ", "\[IndentingNewLine]", "]"}]}]}], " ", 
             RowBox[{"(*", " ", 
              RowBox[{"end", " ", "findrates", " ", "Block"}], " ", "*)"}], 
             "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", " ", 
            RowBox[{"(*", " ", 
             RowBox[{"end", " ", "if", " ", "length", " ", "findrates"}], " ",
              "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"results", " ", "=", " ", 
             RowBox[{"{", 
              RowBox[{"\"\<Summary\>\"", "\[Rule]", " ", "info"}], "}"}]}], 
            ";", " ", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{"TimeCourse", ",", " ", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"results", ",", " ", 
                RowBox[{"\"\<Simulation\>\"", "\[Rule]", " ", "sim"}]}], 
               "]"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"summary", " ", "\[And]", " ", 
               RowBox[{"Not", "[", "Quiet", "]"}]}], ",", " ", 
              RowBox[{"Print", "[", 
               RowBox[{"info", "//", "TableForm"}], "]"}]}], "]"}], ";"}]}], 
          " ", "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}]}], 
       " ", 
       RowBox[{"(*", " ", 
        RowBox[{"end", " ", "summarize", " ", "block"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"summary", " ", "\[And]", " ", 
         RowBox[{"Not", "[", "Quiet", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<xSSA Exit. \>\"", ",", " ", "i", ",", " ", "\"\< steps.  \>\"",
            ",", "iused", ",", " ", "\"\< points sampled.  \>\"", ",", " ", 
           RowBox[{
            RowBox[{"SessionTime", "[", "]"}], "-", "tused"}], ",", " ", 
           "\"\< seconds.\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "results", "]"}], ";"}]}], "\[IndentingNewLine]",
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SSA", "[", "r___", "]"}], ":=", 
   RowBox[{
   "Print", "[", 
    "\"\<Incorrect format for SSA. Correct Format is SSA[reactions, tmax, ic, \
rates, options]\>\"", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.427494035528177*^9, 3.427494042387604*^9}, {
   3.427495016212461*^9, 3.427495038710772*^9}, {3.427497478654315*^9, 
   3.427497485013328*^9}, 3.427497528078362*^9, {3.427497632588839*^9, 
   3.427497635189932*^9}, {3.427498046942844*^9, 3.427498047372003*^9}, {
   3.442855596391523*^9, 3.442855618754741*^9}, {3.442860779369353*^9, 
   3.442860782512627*^9}, {3.443455149799113*^9, 3.443455152669338*^9}, {
   3.443475407296425*^9, 3.443475419868902*^9}, {3.443887211958906*^9, 
   3.443887212832762*^9}, {3.443888743039858*^9, 3.44388877509288*^9}, {
   3.444591271923926*^9, 3.444591276254221*^9}, {3.44493542117944*^9, 
   3.444935512268149*^9}, {3.444937650418723*^9, 3.444937676788643*^9}, {
   3.444939113277124*^9, 3.444939123016393*^9}, {3.444939153553243*^9, 
   3.444939182728668*^9}, {3.444939235804837*^9, 3.444939261331243*^9}, {
   3.44493929660722*^9, 3.444939304795281*^9}, {3.444939362661343*^9, 
   3.444939412126159*^9}, {3.44493944312722*^9, 3.444939500173064*^9}, {
   3.444939551514743*^9, 3.444939763204968*^9}, {3.444939874476524*^9, 
   3.444939884543309*^9}, {3.444939939481822*^9, 3.444939959482068*^9}, {
   3.444940000359763*^9, 3.444940231630022*^9}, {3.444940287384375*^9, 
   3.444940294379632*^9}, {3.444940339276728*^9, 3.444940359433835*^9}, {
   3.444940457905642*^9, 3.444940477663628*^9}, {3.444940734711356*^9, 
   3.444940746653071*^9}, {3.444940851983444*^9, 3.444940907238269*^9}, 
   3.444940950096616*^9, {3.444941005933825*^9, 3.444941047378698*^9}, {
   3.444941136245728*^9, 3.444941137973573*^9}, {3.44494118644506*^9, 
   3.444941264625141*^9}, {3.444941325748586*^9, 3.444941329308039*^9}, {
   3.44494137194052*^9, 3.444941471777252*^9}, {3.444941618264986*^9, 
   3.44494163422715*^9}, {3.444941679437711*^9, 3.444941720138779*^9}, {
   3.444941760579227*^9, 3.444941793020262*^9}, {3.444941850148633*^9, 
   3.444941850364133*^9}, {3.444942155135095*^9, 3.444942204425144*^9}, {
   3.444942258190789*^9, 3.444942447790337*^9}, {3.444942478863783*^9, 
   3.444942502281707*^9}, {3.44494261896196*^9, 3.444942626223915*^9}, {
   3.444942958629719*^9, 3.444942977623353*^9}, {3.444953348688155*^9, 
   3.444953363664659*^9}, {3.444953461830138*^9, 3.444953475152536*^9}, {
   3.444953722348565*^9, 3.444953787288835*^9}, {3.4449538771039*^9, 
   3.444953909183515*^9}, {3.444953949883842*^9, 3.444954176400485*^9}, {
   3.444954220905727*^9, 3.444954519861902*^9}, {3.444954585968322*^9, 
   3.444954687497807*^9}, {3.444954725354254*^9, 3.444954725599947*^9}, {
   3.444954769913848*^9, 3.444954781628793*^9}, {3.444954917578618*^9, 
   3.44495491802893*^9}, {3.444954995796627*^9, 3.444955140182121*^9}, 
   3.444955183482608*^9, {3.444955229726866*^9, 3.444955233176286*^9}, {
   3.444955751342621*^9, 3.444955764413203*^9}, {3.444956094613714*^9, 
   3.444956193188747*^9}, {3.444956258868896*^9, 3.444956426929035*^9}, {
   3.444956477825902*^9, 3.444956611816995*^9}, {3.444956644546128*^9, 
   3.444956748423959*^9}, {3.44495683949719*^9, 3.444956843537973*^9}, {
   3.446298968077642*^9, 3.446298970669604*^9}, {3.44629900479377*^9, 
   3.446299024616571*^9}, {3.44629907349854*^9, 3.446299074168407*^9}, {
   3.4559823359441433`*^9, 3.455982537334922*^9}, {3.455982588800415*^9, 
   3.455982598218214*^9}, 3.45616705099293*^9, {3.4561671258284807`*^9, 
   3.456167278060358*^9}, {3.456167335628333*^9, 3.456167382643683*^9}, {
   3.462197571207752*^9, 3.462197604915597*^9}, {3.46219769271323*^9, 
   3.462197704408016*^9}, {3.462197968595656*^9, 3.462197974185567*^9}, {
   3.4621980671098423`*^9, 3.4621981216783237`*^9}, {3.462200026079343*^9, 
   3.4622002698197203`*^9}, {3.462202737463485*^9, 3.462202758478397*^9}, {
   3.4624075488466*^9, 3.4624076807867813`*^9}, {3.4624077268637*^9, 
   3.462407768942052*^9}, {3.462407814784643*^9, 3.4624078358223743`*^9}, {
   3.462407881661128*^9, 3.4624078836812563`*^9}, {3.462452212940217*^9, 
   3.4624522842064333`*^9}, {3.462452328107894*^9, 3.4624524756782084`*^9}, {
   3.462452536556258*^9, 3.462452579645109*^9}, {3.462452613469905*^9, 
   3.462452642258842*^9}, {3.462452692602357*^9, 3.4624527498073177`*^9}, {
   3.462452803638112*^9, 3.4624529634946537`*^9}, {3.462453008256778*^9, 
   3.462453060943042*^9}, {3.46245309105331*^9, 3.46245320679322*^9}, {
   3.462453277378499*^9, 3.4624532777635717`*^9}, {3.4624533630897827`*^9, 
   3.462453364498888*^9}, {3.462453448741094*^9, 3.4624534829228697`*^9}, {
   3.462454127297206*^9, 3.462454141864263*^9}, {3.4625375613719187`*^9, 
   3.462537609485691*^9}, {3.4632406882175426`*^9, 3.463240904284898*^9}, 
   3.463240978575858*^9, {3.4632410164803057`*^9, 3.4632410544550743`*^9}, {
   3.4632411254742613`*^9, 3.463241158590177*^9}, {3.463241204640423*^9, 
   3.4632414359615726`*^9}, {3.463241469836412*^9, 3.463241605070931*^9}, {
   3.463241639727551*^9, 3.463241685914034*^9}, {3.463241721977447*^9, 
   3.463241726169541*^9}, {3.4632417801906433`*^9, 3.4632417916248198`*^9}, {
   3.465831467670279*^9, 3.4658315413527117`*^9}, {3.465831575190445*^9, 
   3.46583178196041*^9}, {3.465831824179316*^9, 3.465831914007224*^9}, {
   3.4658319718611107`*^9, 3.465831973738933*^9}, {3.465833315840023*^9, 
   3.4658333385545*^9}, {3.466173977834112*^9, 3.466174032004801*^9}, {
   3.466174070657298*^9, 3.4661740748513823`*^9}, {3.4661742019364653`*^9, 
   3.4661742800519857`*^9}, {3.466174399996675*^9, 3.466174400590618*^9}, {
   3.466175785425487*^9, 3.466175848754774*^9}, {3.466175882564839*^9, 
   3.466175940326597*^9}, {3.466175977126944*^9, 3.466176069883909*^9}, 
   3.466176121064495*^9, {3.466176175786727*^9, 3.466176176036982*^9}, {
   3.466176219699291*^9, 3.466176379806325*^9}, {3.466176414571398*^9, 
   3.466176449945848*^9}, {3.46617649015629*^9, 3.466176807332981*^9}, {
   3.466176979514406*^9, 3.466176996063678*^9}, {3.466177031900866*^9, 
   3.466177132945503*^9}, {3.466177203114575*^9, 3.466177231912714*^9}, {
   3.466177301715494*^9, 3.466177327935894*^9}, {3.466177406092965*^9, 
   3.46617740665845*^9}, {3.4661774962512093`*^9, 3.466177509494999*^9}, {
   3.466177541187922*^9, 3.466177541795183*^9}, {3.466177639765666*^9, 
   3.46617769792241*^9}, {3.466177730422759*^9, 3.466177738578158*^9}, {
   3.466177792876556*^9, 3.466177941920734*^9}, {3.466178085199361*^9, 
   3.466178262868744*^9}, {3.4661782968925457`*^9, 3.466178446295184*^9}, {
   3.46617849683962*^9, 3.466178604748579*^9}, {3.466178637352334*^9, 
   3.4661787673718987`*^9}, {3.466178827147377*^9, 3.466178890229814*^9}, {
   3.4661789317991343`*^9, 3.466179007193819*^9}, {3.466179080192977*^9, 
   3.4661791614167023`*^9}, 3.4661792156050577`*^9, {3.466179276633422*^9, 
   3.466179295277177*^9}, {3.466179891246851*^9, 3.466179990972967*^9}, {
   3.466180281818987*^9, 3.466180448903504*^9}, {3.4661805130998573`*^9, 
   3.466180521689623*^9}, 3.466180555472768*^9, {3.4661805914339437`*^9, 
   3.4661805922409267`*^9}, {3.4661822456942863`*^9, 3.466182293837*^9}, {
   3.466527214571419*^9, 3.4665273429542837`*^9}, {3.466527373432233*^9, 
   3.466527395299539*^9}, {3.4665274253095827`*^9, 3.466527499451469*^9}, {
   3.466527545841832*^9, 3.46652769671432*^9}, {3.466527730961616*^9, 
   3.4665278791291037`*^9}, {3.466527910326008*^9, 3.466527973076552*^9}, {
   3.466528185579522*^9, 3.466528263534388*^9}, {3.4668726607980213`*^9, 
   3.466872693156098*^9}, {3.466872734116918*^9, 3.466872754930375*^9}, {
   3.4668728448956137`*^9, 3.466872859751749*^9}, {3.4668731667108383`*^9, 
   3.4668731872047367`*^9}, {3.466873223568017*^9, 3.466873235257255*^9}, {
   3.4668732782572737`*^9, 3.466873280531395*^9}, {3.4668813596580772`*^9, 
   3.46688136263153*^9}, {3.4668815590614223`*^9, 3.466881578134452*^9}, {
   3.4668818668590183`*^9, 3.466881885869507*^9}, {3.467319452494306*^9, 
   3.4673195683886337`*^9}, {3.4673197140135736`*^9, 3.467319732783469*^9}, 
   3.467319873234213*^9, {3.467320042311357*^9, 3.467320047101296*^9}, {
   3.467320449257504*^9, 3.4673204544982452`*^9}, {3.467320541330017*^9, 
   3.467320541982205*^9}, {3.467320661627248*^9, 3.4673206889032373`*^9}, {
   3.467321595129739*^9, 3.467321595892639*^9}, {3.4673218236570177`*^9, 
   3.4673218479745293`*^9}, {3.467321937134452*^9, 3.467321953629231*^9}, {
   3.4673221991184053`*^9, 3.467322200166828*^9}, {3.507899347285735*^9, 
   3.5078994192554007`*^9}, {3.507899812330635*^9, 3.5078998177662*^9}, {
   3.507900196777014*^9, 3.507900221172721*^9}, {3.507900262795115*^9, 
   3.507900265993635*^9}, {3.507900301555072*^9, 3.507900317454771*^9}, {
   3.5079004317644253`*^9, 3.507900452812696*^9}, {3.507900509364964*^9, 
   3.5079006949361267`*^9}, {3.50790073823193*^9, 3.507900739575651*^9}, {
   3.507900834621378*^9, 3.507900836666975*^9}, {3.5079013776286287`*^9, 
   3.5079014475915337`*^9}, {3.507984291917447*^9, 3.5079843186852083`*^9}, {
   3.507984363184248*^9, 3.507984444631257*^9}, {3.507984967297613*^9, 
   3.5079850064067507`*^9}, {3.507985057832241*^9, 3.5079850964837112`*^9}, {
   3.5079851308075047`*^9, 3.5079851319123173`*^9}, {3.507985182813616*^9, 
   3.507985269881242*^9}, {3.507985321243973*^9, 3.5079853704193993`*^9}, {
   3.5079854046373663`*^9, 3.5079854828632107`*^9}, {3.5616572582891283`*^9, 
   3.5616572784668427`*^9}, {3.561657323290804*^9, 3.5616573773221416`*^9}, {
   3.561657634582759*^9, 3.5616576455324497`*^9}, 3.561657772891328*^9, 
   3.561657988325728*^9, 3.56165802994243*^9}],

Cell[TextData[{
 "\nBased on ",
 StyleBox["MathWorld",
  FontSlant->"Italic"],
 " http://mathworld.wolfram.com/LeastSquaresFitting.html\n",
 "Weisstein, Eric W. \[OpenCurlyDoubleQuote]Least Squares Fitting.\
\[CloseCurlyDoubleQuote] From MathWorld--A Wolfram Web Resource. \
http://mathworld.wolfram.com/LeastSquaresFitting.html \n\nMay not be \
meaningful because: on any given run the RSSError may be very low but there \
may be large variation from one run to the next. ",
 "\n"
}], "Text",
 CellChangeTimes->{{3.507986058005879*^9, 3.507986064741485*^9}, {
  3.507987582792781*^9, 3.507987625488618*^9}, {3.5079877577249823`*^9, 
  3.507987776242371*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RSSError", "[", 
    RowBox[{"xydata_", ",", " ", "m_", ",", "b_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "npts", ",", " ", "xpts", ",", " ", "ypts", ",", " ", "xmean", ",", " ",
        "ymean", ",", " ", "ssxx", ",", "ssyy", ",", "ssxy", ",", "s", ",", 
       " ", "SEm", ",", "seslope"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"npts", " ", "=", " ", 
       RowBox[{"Length", "[", "xydata", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"xpts", ",", " ", "ypts"}], "}"}], " ", "=", 
       RowBox[{"Transpose", "[", "xydata", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"xmean", " ", "=", " ", 
       RowBox[{"Mean", "[", "xpts", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ymean", " ", "=", " ", 
       RowBox[{"Mean", "[", "ypts", "]"}]}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"xpts", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"#", "-", "xmean"}], ")"}], "&"}], "/@", "xpts"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ypts", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"#", "-", "ymean"}], ")"}], "&"}], "/@", "ypts"}]}], ";", 
      " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ssyy", " ", "=", " ", 
       RowBox[{"ypts", ".", "ypts"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"ssxx", " ", "=", " ", 
       RowBox[{"xpts", ".", "xpts"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ssxy", " ", "=", " ", 
       RowBox[{"xpts", ".", "ypts"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"s", "=", 
       SqrtBox[
        FractionBox[
         RowBox[{
          RowBox[{"ssxx", "*", "ssyy"}], "-", 
          SuperscriptBox["ssxy", "2"]}], 
         RowBox[{"ssxx", 
          RowBox[{"(", 
           RowBox[{"npts", "-", "2"}], ")"}]}]]]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"seslope", " ", "=", " ", 
       FractionBox["s", 
        SqrtBox["ssxx"]]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "seslope", "]"}], ";"}]}], "\[IndentingNewLine]",
     "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.507984459123784*^9, 3.507984463698987*^9}, {
  3.507984545433445*^9, 3.5079846245884457`*^9}, {3.507984897028904*^9, 
  3.507984940348935*^9}, {3.507987309143647*^9, 3.507987578808509*^9}}],

Cell[CellGroupData[{

Cell["oksummarize,okfindrates", "Subsubsection",
 CellChangeTimes->{{3.50789923804674*^9, 3.507899245318348*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"oksummarize", "[", 
     RowBox[{"summarize_", ",", " ", "mode_"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "sum", "}"}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sum", " ", "=", " ", "summarize"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"sum", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"Not", "[", 
             RowBox[{"MemberQ", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\"\<Variable\>\"", ",", " ", "\"\<Variables\>\""}], 
                "}"}], ",", "mode"}], "]"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{
                "\"\<Warning: \>\"", ",", " ", "Red", ",", " ", "Bold"}], 
                "]"}], ",", " ", 
               "\"\<SSA: \\\"Summarize\\\" option requires \
\\\"Mode\\\"=\\\"Variable\\\" or \\\"Variables\\\", and will be \
ignored.\>\""}], "]"}], ";", " ", "\[IndentingNewLine]", 
             RowBox[{"sum", "=", "False"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "sum", "]"}], ";"}]}], " ", 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"okfindrates", "[", 
     RowBox[{"findrates_", ",", " ", "mode_"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "rates", "}"}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rates", " ", "=", " ", "findrates"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"rates", " ", "=", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", "rates", "}"}], "]"}]}], ";", "  ", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "rates", "]"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"Not", "[", 
             RowBox[{"MemberQ", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\"\<Variable\>\"", ",", " ", "\"\<Variables\>\""}], 
                "}"}], ",", "mode"}], "]"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{
                "\"\<Warning: \>\"", ",", " ", "Red", ",", " ", "Bold"}], 
                "]"}], ",", " ", 
               "\"\<SSA: \\\"Rates\\\" option requires \
\\\"Mode\\\"=\\\"Variable\\\" or \\\"Variables\\\", and will be \
ignored.\>\""}], "]"}], ";", " ", "\[IndentingNewLine]", 
             RowBox[{"rates", "=", 
              RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"NumberQ", "[", "#", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<Error: \>\"", ",", "Red", ",", " ", "Bold"}], 
                  "]"}], ",", " ", "\"\< SSA: \\\"Rates\\\" value = \>\"", 
                 ",", " ", "#", ",", " ", 
                 "\"\< is not a number. \\\"Rates\\\" must be a list of \
numbers.\>\""}], "]"}], ";", " ", "\[IndentingNewLine]", 
               RowBox[{"Abort", "[", "]"}], ";"}]}], "]"}], "&"}], "/@", 
           "rates"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"#", ">", "1"}], ")"}], "\[Or]", " ", 
               RowBox[{"(", 
                RowBox[{"#", "<", "0"}], ")"}]}], ",", " ", 
              RowBox[{"Print", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<Error: \>\"", ",", "Red", ",", " ", "Bold"}], 
                 "]"}], ",", " ", "\"\<SSA: \\\"Rates\\\" value = \>\"", ",", 
                "#", ",", " ", 
                "\"\< is not in the range [0,1] and will be truncated.\>\""}],
                "]"}]}], "]"}], "&"}], "/@", "rates"}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"rates", " ", "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"Min", "[", 
                RowBox[{"#", ",", " ", "1"}], "]"}], ",", "0"}], "]"}], "&"}],
             "/@", "rates"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "rates", "]"}], ";"}]}], " ", 
     "\[IndentingNewLine]", "]"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.466177251753701*^9, 3.466177288258603*^9}, {
  3.4661773495443087`*^9, 3.4661773842311773`*^9}, {3.466177435956687*^9, 
  3.466177485143197*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
gnuplotheader
\
\>", "Subsection",
 CellChangeTimes->{{3.444956219053993*^9, 3.444956227188947*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"gnuplotheader", "[", 
   RowBox[{
   "xmin_", ",", "xmax_", ",", " ", "ymin_", ",", " ", "ymax_", ",", " ", 
    "variables_", ",", " ", "title_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"gnuplot", ",", " ", "gp"}], "}"}], ",", " ", 
    RowBox[{
     RowBox[{"gnuplot", " ", "=", " ", 
      RowBox[{"\"\<# gnuplot script generated \>\"", "<>", 
       RowBox[{"DateString", "[", "]"}], "<>", 
       "\"\<\\n#\\nset xlabel 'time'\\n\>\"", "<>", 
       "\"\<set ylabel 'number of molecules'\\n\>\"", "<>", 
       "\"\<set title '\>\"", "<>", "title", "<>", "\"\<'\\n\>\"", "<>", 
       "\[IndentingNewLine]", "\"\<set xrange [\>\"", "<>", 
       RowBox[{"ToString", "[", "xmin", "]"}], "<>", "\"\<:\>\"", "<>", 
       RowBox[{"ToString", "[", "xmax", "]"}], "<>", "\"\<]\\n\>\"", "<>", 
       "\"\<set yrange [\>\"", "<>", 
       RowBox[{"ToString", "[", "ymin", "]"}], "<>", "\"\<:\>\"", "<>", 
       RowBox[{"ToString", "[", "ymax", "]"}], "<>", "\"\<]\\nplot\>\""}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"gp", "=", "\[IndentingNewLine]", 
      RowBox[{"StringDrop", "[", 
       RowBox[{
        RowBox[{"StringJoin", "@@", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\"\< '\>\"", "<>", "title", "<>", "\"\<' using 1:\>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"1", "+", "#1"}], "]"}], "<>", "\"\< title '\>\"", "<>", 
             RowBox[{"ToString", "[", "#2", "]"}], "<>", 
             "\"\<' with lines ,\\\\\\n\>\""}], "&"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "variables", "]"}], "]"}], ",", " ", 
             "variables"}], "}"}]}], "]"}]}], ",", " ", 
        RowBox[{"-", "4"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"gnuplot", " ", "=", " ", 
      RowBox[{"gnuplot", "<>", "gp"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "gnuplot", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.444955654617762*^9, 3.444955744433282*^9}, {
  3.444955795375739*^9, 3.444955826505565*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Conversions XLR8R arrows \[DoubleLongLeftRightArrow] SSA arrows", \
"Section",
 CellChangeTimes->{{3.444144505596148*^9, 3.444144506775491*^9}, {
  3.446308511643207*^9, 3.446308540037234*^9}}],

Cell[CellGroupData[{

Cell["XLR8RtoSSA", "Subsection",
 CellChangeTimes->{{3.444144770976033*^9, 3.444144775928308*^9}}],

Cell[CellGroupData[{

Cell["mass-action  simple", "Subsubsection",
 CellChangeTimes->{{3.444145777229489*^9, 3.444145780062494*^9}, {
  3.456096142281848*^9, 3.456096150954378*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"XLR8RtoSSA", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"A_", "\[Rule]", " ", "B_"}], ",", " ", "k___"}], "}"}], "]"}],
     ":=", " ", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"A", "\[Rule]", " ", "B"}], ",", " ", "k"}], "}"}], "}"}]}], 
   ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"XLR8RtoSSA", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"A_", "\[ShortRightArrow]", "B_"}], ",", " ", "k___"}], "}"}], 
     "]"}], ":=", " ", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"A", "\[Rule]", " ", "B"}], ",", " ", "k"}], "}"}], "}"}]}], 
   ";"}], " ", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XLR8RtoSSA", "[", 
    RowBox[{"{", 
     RowBox[{"A_", "\[RightArrowLeftArrow]", "B_"}], "}"}], "]"}], ":=", " ", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"A", "\[Rule]", " ", "B"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"B", "\[Rule]", " ", "A"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XLR8RtoSSA", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"A_", "\[RightArrowLeftArrow]", "B_"}], " ", ",", " ", "k1_", 
      ",", " ", "k2___"}], "}"}], "]"}], ":=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"A", "\[Rule]", "B"}], ",", " ", "k1"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"B", "\[Rule]", " ", "A"}], ",", " ", "k2"}], "}"}]}], "}"}]}],
   ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.444144512682804*^9, 3.44414451829461*^9}, {
   3.444144569528516*^9, 3.444144637318364*^9}, {3.444145425962321*^9, 
   3.444145435003669*^9}, {3.444154375341627*^9, 3.444154376415082*^9}, {
   3.4560951416980124`*^9, 3.456095270042357*^9}, 3.4560954694678917`*^9, {
   3.4561644617200127`*^9, 3.4561644652788*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "mass-action ",
 Cell[BoxData[
  FormBox[
   OverscriptBox[
    RowBox[{"A", "\[ShortRightArrow]", "B"}], "C"], TraditionalForm]]]
}], "Subsubsection",
 CellChangeTimes->{{3.456096157841408*^9, 3.456096172187142*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"XLR8RtoSSA", "[", 
     RowBox[{"{", 
      RowBox[{
       OverscriptBox[
        RowBox[{"A_", "\[ShortRightArrow]", "B_"}], "via_"], ",", " ", 
       "k___"}], "}"}], "]"}], ":=", " ", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"A", "+", "via"}], " ", "\[Rule]", " ", 
        RowBox[{"B", "+", "via"}]}], ",", " ", "k"}], "}"}], "}"}]}], ";"}], 
  " "}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.456095471617627*^9, 3.456095484653926*^9}, {
  3.456095576340691*^9, 3.4560956013073463`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "mass-action ",
 Cell[BoxData[
  FormBox[
   OverscriptBox[
    RowBox[{"A", "\[RightArrowLeftArrow]", "B"}], "C"], TraditionalForm]]]
}], "Subsubsection",
 CellChangeTimes->{{3.456096174375988*^9, 3.456096185234106*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"XLR8RtoSSA", "[", 
   RowBox[{"{", 
    OverscriptBox[
     RowBox[{"A_", "\[RightArrowLeftArrow]", "B_"}], "enzyme_"], "}"}], "]"}],
   ":=", " ", "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"A", "+", "enzyme"}], "\[ShortRightArrow]", 
      RowBox[{"Diamond", "[", 
       RowBox[{"A", ",", "enzyme"}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Diamond", "[", 
       RowBox[{"A", ",", "enzyme"}], "]"}], "\[ShortRightArrow]", 
      RowBox[{"A", "+", "enzyme"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Diamond", "[", 
       RowBox[{"A", ",", "enzyme"}], "]"}], "\[ShortRightArrow]", 
      RowBox[{"B", "+", "enzyme"}]}], "}"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XLR8RtoSSA", "[", 
   RowBox[{"{", 
    RowBox[{
     OverscriptBox[
      RowBox[{"A_", "\[RightArrowLeftArrow]", "B_"}], "enzyme_"], ",", " ", 
     "k1_"}], "}"}], "]"}], ":=", " ", "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"A", "+", "enzyme"}], "\[ShortRightArrow]", 
       RowBox[{"Diamond", "[", 
        RowBox[{"A", ",", "enzyme"}], "]"}]}], ",", "k1"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Diamond", "[", 
       RowBox[{"A", ",", "enzyme"}], "]"}], "\[ShortRightArrow]", 
      RowBox[{"A", "+", "enzyme"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Diamond", "[", 
       RowBox[{"A", ",", "enzyme"}], "]"}], "\[ShortRightArrow]", 
      RowBox[{"B", "+", "enzyme"}]}], "}"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XLR8RtoSSA", "[", 
    RowBox[{"{", 
     RowBox[{
      OverscriptBox[
       RowBox[{"A_", "\[RightArrowLeftArrow]", "B_"}], "enzyme_"], ",", " ", 
      "k1_", ",", " ", "k2_"}], "}"}], "]"}], ":=", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"A", "+", "enzyme"}], "\[ShortRightArrow]", 
        RowBox[{"Diamond", "[", 
         RowBox[{"A", ",", "enzyme"}], "]"}]}], ",", "k1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Diamond", "[", 
         RowBox[{"A", ",", "enzyme"}], "]"}], "\[ShortRightArrow]", 
        RowBox[{"A", "+", "enzyme"}]}], ",", "k2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Diamond", "[", 
        RowBox[{"A", ",", "enzyme"}], "]"}], "\[ShortRightArrow]", 
       RowBox[{"B", "+", "enzyme"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XLR8RtoSSA", "[", 
    RowBox[{"{", 
     RowBox[{
      OverscriptBox[
       RowBox[{"A_", "\[RightArrowLeftArrow]", "B_"}], "enzyme_"], ",", " ", 
      "k1_", ",", " ", "k2_", ",", " ", "k3_"}], "}"}], "]"}], ":=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"A", "+", "enzyme"}], "\[ShortRightArrow]", 
        RowBox[{"Diamond", "[", 
         RowBox[{"A", ",", "enzyme"}], "]"}]}], ",", "k1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Diamond", "[", 
         RowBox[{"A", ",", "enzyme"}], "]"}], "\[ShortRightArrow]", 
        RowBox[{"A", "+", "enzyme"}]}], ",", "k2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Diamond", "[", 
         RowBox[{"A", ",", "enzyme"}], "]"}], "\[ShortRightArrow]", 
        RowBox[{"B", "+", "enzyme"}]}], ",", "k3"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XLR8RtoSSA", "[", 
    RowBox[{"{", 
     RowBox[{
      OverscriptBox[
       RowBox[{"A_", "\[RightArrowLeftArrow]", "B_"}], "enzyme_"], ",", " ", 
      "k1_", ",", " ", "k2_", ",", " ", "k3_", ",", " ", "k4___"}], "}"}], 
    "]"}], ":=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"A", "+", "enzyme"}], "\[ShortRightArrow]", 
        RowBox[{"Diamond", "[", 
         RowBox[{"A", ",", "enzyme"}], "]"}]}], ",", "k1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Diamond", "[", 
         RowBox[{"A", ",", "enzyme"}], "]"}], "\[ShortRightArrow]", 
        RowBox[{"A", "+", "enzyme"}]}], ",", "k2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Diamond", "[", 
         RowBox[{"A", ",", "enzyme"}], "]"}], "\[ShortRightArrow]", 
        RowBox[{"B", "+", "enzyme"}]}], ",", "k3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"B", "+", "enzyme"}], "\[ShortRightArrow]", 
        RowBox[{"Diamond", "[", 
         RowBox[{"A", ",", "enzyme"}], "]"}]}], ",", "k4"}], "}"}]}], "}"}]}],
   ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.45609571935376*^9, 3.456095818543116*^9}, {
  3.4560959379762774`*^9, 3.4560961150763397`*^9}, {3.50859227333986*^9, 
  3.508592274195775*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "mass action ",
 Cell[BoxData[
  FormBox[
   UnderoverscriptBox[
    RowBox[{"A", "\[RightArrowLeftArrow]", "B"}], "R", "F"], TraditionalForm]]]
}], "Subsubsection",
 CellChangeTimes->{{3.456096226856619*^9, 3.456096241507565*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"XLR8RtoSSA", "[", 
    RowBox[{"{", 
     StyleBox[
      RowBox[{
       RowBox[{"Underoverscript", "[", 
        RowBox[{
         RowBox[{"RightArrowLeftArrow", "[", 
          RowBox[{"A_", ",", "B_"}], "]"}], ",", "Reverse_", ",", 
         "Forward_"}], "]"}], ",", " ", "rates___"}],
      ShowSpecialCharacters->False,
      ShowStringCharacters->True,
      NumberMarks->True], "}"}], "]"}], ":=", " ", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"k", ",", " ", "result"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"k", "=", 
       RowBox[{"{", "rates", "}"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"Switch", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Length", "[", "k", "]"}], ",", "\[IndentingNewLine]", " ", 
        "6", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"result", "=", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"XLR8RtoSSA", "[", 
             RowBox[{"{", 
              RowBox[{
               OverscriptBox[
                RowBox[{"A", "\[RightArrowLeftArrow]", "B"}], "Forward"], ",",
                " ", 
               RowBox[{"Sequence", "@@", 
                RowBox[{"Take", "[", 
                 RowBox[{"k", ",", "3"}], "]"}]}]}], "}"}], "]"}], ",", " ", 
            RowBox[{"XLR8RtoSSA", "[", 
             RowBox[{"{", " ", 
              RowBox[{
               OverscriptBox[
                RowBox[{"B", "\[RightArrowLeftArrow]", "A"}], "Reverse"], ",",
                " ", 
               RowBox[{"Sequence", "@@", 
                RowBox[{"Drop", "[", 
                 RowBox[{"k", ",", "3"}], "]"}]}]}], "}"}], "]"}]}], "]"}]}], 
         ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", " ", "8", 
        ",", 
        RowBox[{
         RowBox[{"result", "=", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"XLR8RtoSSA", "[", 
             RowBox[{"{", 
              RowBox[{
               OverscriptBox[
                RowBox[{"A", "\[RightArrowLeftArrow]", "B"}], "Forward"], ",",
                " ", 
               RowBox[{"Sequence", "@@", 
                RowBox[{"Take", "[", 
                 RowBox[{"k", ",", "4"}], "]"}]}]}], "}"}], "]"}], ",", " ", 
            RowBox[{"XLR8RtoSSA", "[", 
             RowBox[{"{", 
              RowBox[{
               OverscriptBox[
                RowBox[{"B", "\[RightArrowLeftArrow]", "A"}], "Reverse"], ",",
                " ", 
               RowBox[{"Sequence", "@@", 
                RowBox[{"Drop", "[", 
                 RowBox[{"k", ",", "4"}], "]"}]}]}], "}"}], "]"}]}], "]"}]}], 
         ";"}], "\[IndentingNewLine]", ",", " ", "\[IndentingNewLine]", "_", 
        ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Error: XLR8RtoSSA: unable to parse rate constants; there must \
be either six or eight for the reaction \>\"", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Underoverscript", "[", 
              RowBox[{
               RowBox[{"RightArrowLeftArrow", "[", 
                RowBox[{"A", ",", "B"}], "]"}], ",", "Reverse", ",", " ", 
               "Forward"}], "]"}], " ", ",", " ", "rates"}], "}"}]}], "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"result", "=", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"Indeterminate", "[", 
             RowBox[{"{", " ", 
              RowBox[{
               RowBox[{"Underoverscript", "[", 
                RowBox[{
                 RowBox[{"RightArrowLeftArrow", "[", 
                  RowBox[{"A", ",", "B"}], "]"}], ",", "Reverse", ",", " ", 
                 "Forward"}], "]"}], " ", ",", " ", "rates"}], "}"}], "]"}], 
            "}"}], "}"}]}], ";"}]}], " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "result", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.456096246055573*^9, 3.456096248882804*^9}, {
  3.456097118588705*^9, 3.456097147304027*^9}, {3.456097190255752*^9, 
  3.4560976139116583`*^9}, {3.456097661926466*^9, 3.456097737305552*^9}, {
  3.4560977800056953`*^9, 3.456097998021744*^9}, {3.456098036382564*^9, 
  3.456098113224717*^9}, {3.456098550706882*^9, 3.456098561365991*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "mass action ",
 Cell[BoxData[
  FormBox[
   OverscriptBox[
    RowBox[{"A", "\[Equilibrium]", "B"}], "C"], TraditionalForm]]]
}], "Subsubsection",
 CellChangeTimes->{{3.456098153738715*^9, 3.456098155932968*^9}, {
  3.456098195370761*^9, 3.456098195398542*^9}, {3.4560982513706636`*^9, 
  3.456098255332933*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"XLR8RtoSSA", "[", 
    RowBox[{"{", 
     RowBox[{
      OverscriptBox[
       RowBox[{"A_", "\[Equilibrium]", "B_"}], "enzyme_"], ",", " ", "k1_", 
      ",", " ", "k2_", ",", " ", "k3_", ",", "k4_", ",", "k5_", ",", "k6_"}], 
     "}"}], "]"}], ":=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"A", "+", "enzyme"}], "\[ShortRightArrow]", 
        RowBox[{"Diamond", "[", 
         RowBox[{"A", ",", "enzyme"}], "]"}]}], ",", "k1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Diamond", "[", 
         RowBox[{"A", ",", "enzyme"}], "]"}], "\[ShortRightArrow]", 
        RowBox[{"A", "+", "enzyme"}]}], ",", "k2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Diamond", "[", 
         RowBox[{"A", ",", "enzyme"}], "]"}], "\[ShortRightArrow]", 
        RowBox[{"Diamond", "[", 
         RowBox[{"B", ",", "enzyme"}], "]"}]}], ",", "k3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Diamond", "[", 
         RowBox[{"B", ",", "enzyme"}], "]"}], "\[ShortRightArrow]", 
        RowBox[{"Diamond", "[", 
         RowBox[{"A", ",", "enzyme"}], "]"}]}], ",", "k4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Diamond", "[", 
         RowBox[{"B", ",", "enzyme"}], "]"}], "\[ShortRightArrow]", 
        RowBox[{"B", "+", "enzyme"}]}], ",", "k5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"B", "+", "enzyme"}], "\[ShortRightArrow]", 
        RowBox[{"Diamond", "[", 
         RowBox[{"B", ",", "enzyme"}], "]"}]}], ",", "k6"}], "}"}]}], "}"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XLR8RtoSSA", "[", 
    RowBox[{"{", 
     RowBox[{
      OverscriptBox[
       RowBox[{"A_", "\[Equilibrium]", "B_"}], "enzyme_"], ",", " ", 
      "k1___"}], "}"}], "]"}], ":=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<Error: XLR8RtoSSA: unable to parse rate constants; there must be \
precisely six rates for the reaction \>\"", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          OverscriptBox[
           RowBox[{"A", "\[Equilibrium]", "B"}], "enzyme"], ")"}], ",", " ", 
         "k1"}], "}"}]}], "]"}], " ", ";", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"Indeterminate", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           OverscriptBox[
            RowBox[{"A", "\[Equilibrium]", "B"}], "enzyme"], ")"}], "  ", ",",
           " ", "k1"}], "}"}], "]"}], "}"}], "}"}]}], " ", ")"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.456098258794072*^9, 3.4560984767503767`*^9}, {
  3.45609851369617*^9, 3.456098541180669*^9}, {3.456098644126341*^9, 
  3.456098650976962*^9}, {3.508592274365394*^9, 3.508592274568768*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["XLR8RtoSSA catchall", "Subsubsection",
 CellChangeTimes->{{3.445700848826077*^9, 3.44570086139159*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"XLR8RtoSSA", "[", 
    RowBox[{"{", "reaction___List", "}"}], "]"}], ":=", 
   RowBox[{"Join", "@@", 
    RowBox[{"(", 
     RowBox[{"XLR8RtoSSA", "/@", 
      RowBox[{"{", "reaction", "}"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XLR8RtoSSA", "[", "unknownReaction_", "]"}], ":=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<Error: XLR8RtoSSA: unable to convert the reaction: \>\"", ",", " ",
        "unknownReaction"}], " ", "\[IndentingNewLine]", "]"}], ";", " ", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"Indeterminate", "[", "unknownReaction", "]"}], "}"}], "}"}]}],
     ")"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.44570087489169*^9, 3.445700928524707*^9}, {
  3.445700998207547*^9, 3.445701066738079*^9}, {3.445705980699796*^9, 
  3.445705981447056*^9}, {3.445706205496975*^9, 3.445706222246119*^9}, {
  3.456094788762124*^9, 3.456094824211804*^9}, {3.456095014870113*^9, 
  3.4560950195924387`*^9}, {3.456095079319126*^9, 3.456095080336591*^9}, {
  3.456095542743148*^9, 3.4560955558847313`*^9}, {3.456098718250599*^9, 
  3.4560987186892977`*^9}}]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["SSAtoXLR8R", "Subsection",
 CellChangeTimes->{{3.444144784142506*^9, 3.444144792093709*^9}}],

Cell[CellGroupData[{

Cell["mass-action", "Subsubsection",
 CellChangeTimes->{{3.444145803069725*^9, 3.444145804716862*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SSAtoXLR8R", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"A_", "\[Rule]", " ", "B_"}], ",", " ", "k___"}], "}"}], "]"}], 
   ":=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"A", "\[Rule]", " ", "B"}], ",", " ", "k"}], "}"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.444144641952131*^9, 3.444144672692719*^9}, {
   3.444144881701764*^9, 3.44414488269196*^9}, 3.444154267163528*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["SSAtoXLR8R catchall", "Subsubsection",
 CellChangeTimes->{{3.445700848826077*^9, 3.44570086139159*^9}, 
   3.445705964160054*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SSAtoXLR8R", "[", 
    RowBox[{"{", "reaction___List", "}"}], "]"}], ":=", 
   RowBox[{"SSAtoXLR8R", "/@", 
    RowBox[{"ExpandReactions", "[", 
     RowBox[{"{", "reaction", "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SSAtoXLR8R", "[", "unknownReaction_", "]"}], ":=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<Error: SSAtoXLR8R: unknown reaction: \>\"", ",", " ", 
       "unknownReaction"}], "]"}], ";", " ", 
     RowBox[{"Indeterminate", "[", "unknownReaction", "]"}]}], ")"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.44570087489169*^9, 3.445700928524707*^9}, {
  3.445700998207547*^9, 3.445701066738079*^9}, {3.445705966358473*^9, 
  3.445705972190342*^9}, {3.508591975986536*^9, 3.5085919820571833`*^9}}]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Plotting", "Section"],

Cell[CellGroupData[{

Cell["SSAPlot", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SSAPlot", "[", 
    RowBox[{"solution_", ",", " ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "variables", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"variables", "=", 
       RowBox[{"First", "/@", "solution"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"SSAPlot", "[", 
        RowBox[{"solution", ",", "variables", ",", "opt"}], "]"}], "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SSAPlot", "[", 
    RowBox[{"solution_", ",", " ", "variables_", ",", " ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "type", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"type", "=", 
       RowBox[{
        RowBox[{"SSAPlotType", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"Options", "[", "SSAPlot", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Switch", "[", 
       RowBox[{
       "type", ",", "\[IndentingNewLine]", "\"\<Line\>\"", ",", 
        "\[IndentingNewLine]", " ", 
        RowBox[{"Return", "[", 
         RowBox[{"SSALinePlot", "[", 
          RowBox[{"solution", ",", "variables", ",", "opt"}], "]"}], "]"}], 
        ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "\"\<Dot\>\"", ",",
         " ", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"SSADotPlot", "[", 
          RowBox[{"solution", ",", "variables", ",", "opt"}], "]"}], "]"}], 
        ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "_", ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Error: SSAPlot: Unknown format: \>\"", ",", "type", ",", " ", 
           "\"\<\\nvalid formats are \\\"Line\\\", \\\"Dot\\\"\>\""}], "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["SSADotPlot", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SSADotPlot", "[", 
    RowBox[{"solution_", ",", 
     RowBox[{"variables_", "?", "ListQ"}], ",", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"styles", ",", "plots", ",", " ", "plt", ",", "nvars"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nvars", "=", 
       RowBox[{"Length", "[", "variables", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"styles", "=", 
       RowBox[{
        RowBox[{"SSAPlotStyles", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"Options", "[", "SSAPlot", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"styles", "\[Equal]", "Automatic"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"styles", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Hue", "[", 
             RowBox[{"RandomReal", "[", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}], "]"}], "]"}], ",", " ", 
            RowBox[{"{", "nvars", "}"}]}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ListQ", "[", "styles", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"styles", "=", 
          RowBox[{"PadRight", "[", 
           RowBox[{"styles", ",", "nvars", ",", "Automatic"}], "]"}]}], ";"}],
         ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"styles", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"styles", ",", 
            RowBox[{"{", "nvars", "}"}]}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", " ", "=", " ", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"SSADotPlot", "[", 
           RowBox[{"solution", ",", " ", "#1", ",", " ", 
            RowBox[{"DisplayFunction", "\[Rule]", " ", "Identity"}], ",", " ", 
            RowBox[{"PlotStyle", "\[Rule]", " ", "#2"}], ",", " ", "opt"}], 
           "]"}], "&"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"variables", ",", " ", "styles"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"plt", "=", 
       RowBox[{"Show", "[", 
        RowBox[{"plots", ",", " ", 
         RowBox[{"DisplayFunction", "\[Rule]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"DisplayFunction", "/.", 
             RowBox[{"{", "opt", "}"}]}], "/.", 
            RowBox[{"{", 
             RowBox[{"DisplayFunction", "\[Rule]", " ", "$DisplayFunction"}], 
             "}"}]}], ")"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "plt", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.427493969288251*^9, 3.427493973087786*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SSADotPlot", "[", 
    RowBox[{"solution_", ",", "variable_", ",", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"plt", ",", "popt"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"popt", "=", 
          RowBox[{"MyFilterOptions", "[", 
           RowBox[{"ListPlot", ",", "opt"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"pplt", "=", 
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"variable", "/.", "solution"}], ",", " ", "popt"}], 
           "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "pplt", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.427493984480442*^9, 3.42749398493098*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["SSALinePlot", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SSALinePlot", "[", 
    RowBox[{"solution_", ",", 
     RowBox[{"variables_", "?", "ListQ"}], ",", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"styles", ",", "plots", ",", " ", "plt", ",", "nvars"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nvars", "=", 
       RowBox[{"Length", "[", "variables", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"styles", "=", 
       RowBox[{
        RowBox[{"SSAPlotStyles", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"Options", "[", "SSAPlot", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"styles", "\[Equal]", "Automatic"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"styles", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Hue", "[", 
             RowBox[{"RandomReal", "[", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}], "]"}], "]"}], ",", " ", 
            RowBox[{"{", "nvars", "}"}]}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ListQ", "[", "styles", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"styles", "=", 
          RowBox[{"PadRight", "[", 
           RowBox[{"styles", ",", "nvars", ",", "Automatic"}], "]"}]}], ";"}],
         ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"styles", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"styles", ",", 
            RowBox[{"{", "nvars", "}"}]}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", " ", "=", " ", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"SSALinePlot", "[", 
           RowBox[{"solution", ",", " ", "#1", ",", " ", 
            RowBox[{"DisplayFunction", "\[Rule]", " ", "Identity"}], ",", " ", 
            RowBox[{"PlotStyle", "\[Rule]", " ", "#2"}], ",", " ", "opt"}], 
           "]"}], "&"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"variables", ",", " ", "styles"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"plt", "=", 
       RowBox[{"Show", "[", 
        RowBox[{"plots", ",", " ", 
         RowBox[{"DisplayFunction", "\[Rule]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"DisplayFunction", "/.", 
             RowBox[{"{", "opt", "}"}]}], "/.", 
            RowBox[{"{", 
             RowBox[{"DisplayFunction", "\[Rule]", " ", "$DisplayFunction"}], 
             "}"}]}], ")"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "plt", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.427493994719758*^9, 3.427493997167255*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SSALinePlot", "[", 
    RowBox[{"solution_", ",", "variable_", ",", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "plt", ",", "popt", ",", " ", "data", ",", " ", "xvals", ",", " ", 
       "yvals", ",", "moredata", ",", " ", "dbg", ",", " ", "dPrint", ",", 
       " ", "variables"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dbg", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<Debug\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Debug\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dPrint", "[", "x___", "]"}], ":=", " ", 
       RowBox[{"If", "[", 
        RowBox[{"dbg", ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<SSALinePlot: \>\"", ",", " ", "x"}], "]"}]}], "]"}]}], 
      ";", " ", "\[IndentingNewLine]", 
      RowBox[{"variables", " ", "=", " ", 
       RowBox[{"First", "/@", "solution"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<variables: \>\"", ",", " ", "variables"}], "]"}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"First", "/@", "solution"}], ",", "variable"}], "]"}]}], 
        ",", " ", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Error:SSALinePlot:variable not found: \>\"", ",", "variable"}],
           "]"}], ";", 
         RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"data", " ", "=", 
       RowBox[{"variable", "/.", "solution"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"xvals", ",", "yvals"}], "}"}], "=", 
       RowBox[{"Transpose", "[", "data", "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"xvals", "=", 
       RowBox[{"Rest", "[", "xvals", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"yvals", "=", 
       RowBox[{"Most", "[", "yvals", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"moredata", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"xvals", ",", "yvals"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"data", "=", 
       RowBox[{"Append", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Most", "[", "data", "]"}], ",", " ", "moredata"}], "}"}],
           "]"}], ",", " ", 
         RowBox[{"Last", "[", "data", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"data", "=", 
       RowBox[{"Partition", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", "data", "]"}], ",", "2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"popt", "=", 
          RowBox[{"MyFilterOptions", "[", 
           RowBox[{"ListPlot", ",", "opt"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"pplt", "=", 
          RowBox[{"ListPlot", "[", 
           RowBox[{"data", ",", 
            RowBox[{"PlotJoined", "\[Rule]", " ", "True"}], ",", " ", 
            "popt"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "pplt", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.427494006156127*^9, 3.427494006678432*^9}, {
  3.46240686351546*^9, 3.4624069538219337`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["SSAPhasePlot", "Subsection",
 CellChangeTimes->{{3.444747130405062*^9, 3.444747157126326*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SSAPhasePlot", "[", 
    RowBox[{"solution_", ",", " ", 
     RowBox[{"{", 
      RowBox[{"X_", ",", " ", "Y_"}], "}"}], ",", " ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "vars", ",", "x", ",", " ", "y", ",", " ", "xy", ",", " ", "g", ",", 
       " ", "directives"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"x", "=", 
       RowBox[{
        RowBox[{"X", "/.", "solution"}], "/.", 
        RowBox[{"{", 
         RowBox[{"X", "\[Rule]", " ", "$Failed"}], "}"}]}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"y", "=", 
       RowBox[{
        RowBox[{"Y", "/.", "solution"}], "/.", 
        RowBox[{"{", 
         RowBox[{"Y", "\[Rule]", " ", "$Failed"}], "}"}]}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"vars", "=", 
       RowBox[{"First", "/@", "solution"}]}], ";", " ", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"#", ",", " ", "$Failed"}], "]"}], ",", " ", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Error: SSAPhasePlot: Variable \>\"", ",", " ", "X", ",", " ", 
            "\"\< not Found. Variables are: \>\"", ",", " ", "vars"}], 
           "]"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{"x", ",", " ", "y"}], "}"}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"x", "=", 
       RowBox[{"Last", "/@", "x"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"y", "=", 
       RowBox[{"Last", "/@", "y"}]}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"xy", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"gopt", "=", 
          RowBox[{"MyFilterOptions", "[", 
           RowBox[{"Graphics", ",", " ", "opt"}], "]"}]}], "}"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"directives", "=", 
          RowBox[{
           RowBox[{"\"\<Directives\>\"", "/.", 
            RowBox[{"{", "opt", "}"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{"\"\<Directives\>\"", "\[Rule]", " ", 
             RowBox[{"{", "}"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"directives", "=", 
          RowBox[{"Directive", "@@", "directives"}]}], ";", "   ", 
         "\[IndentingNewLine]", 
         RowBox[{"g", "=", 
          RowBox[{"Graphics", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"directives", ",", 
              RowBox[{"Line", "[", "xy", "]"}]}], "}"}], ",", " ", "gopt", 
            ",", " ", 
            RowBox[{"Axes", "\[Rule]", " ", "True"}], ",", " ", 
            RowBox[{"AxesLabel", "\[Rule]", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ToString", "[", "X", "]"}], ",", " ", 
               RowBox[{"ToString", "[", "Y", "]"}]}], "}"}]}]}], "]"}]}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "g", "]"}], ";"}]}], " ", "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SSAPhasePlot", "[", 
     RowBox[{"s_", ",", " ", 
      RowBox[{"{", 
       RowBox[{"X_", ",", " ", "Y_"}], "}"}], ",", " ", "directives_"}], 
     "]"}], ":=", " ", 
    RowBox[{"SSAPhasePlot", "[", 
     RowBox[{"s", ",", " ", 
      RowBox[{"{", 
       RowBox[{"X", ",", "Y"}], "}"}], ",", " ", 
      RowBox[{"\"\<Directives\>\"", "\[Rule]", " ", 
       RowBox[{"{", "directives", "}"}]}]}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SSAPhasePlot", "[", "x___", "]"}], ":=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
     "Print", "[", 
      "\"\<Error: expecting SSAPhasePlot[solution, {X, Y}, \
GraphicsDirectives] or SSAPhasePlot[solution, {X,Y}, Options]\>\"", "]"}], 
     ";", " ", "$Failed"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SSAPhaseCurve", "[", 
     RowBox[{"solution_", ",", " ", 
      RowBox[{"{", 
       RowBox[{"X_", ",", " ", "Y_"}], "}"}], ",", " ", "directives___"}], 
     "]"}], ":=", " ", 
    RowBox[{"SSAPhasePlot", "[", 
     RowBox[{"solution", ",", " ", 
      RowBox[{"{", 
       RowBox[{"X", ",", "Y"}], "}"}], ",", " ", 
      RowBox[{"\"\<Directives\>\"", "\[Rule]", " ", 
       RowBox[{"{", "directives", "}"}]}], ",", " ", 
      RowBox[{"Axes", "\[Rule]", " ", "False"}]}], "]"}]}], ";"}], 
  " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.444747133771341*^9, 3.444747338097888*^9}, {
  3.444747381880018*^9, 3.444747483372384*^9}, {3.444747524582514*^9, 
  3.444747591643519*^9}, {3.444747680419122*^9, 3.444747721480346*^9}, {
  3.444747783836566*^9, 3.44474779580796*^9}, {3.444747987348266*^9, 
  3.444748013186531*^9}, {3.444748158422618*^9, 3.4447481960771*^9}, {
  3.444748278243332*^9, 3.444748284581731*^9}, {3.444748322907753*^9, 
  3.444748326422906*^9}, {3.444748376864601*^9, 3.44474843546941*^9}, {
  3.444748475751922*^9, 3.444748671481969*^9}, {3.444748954862922*^9, 
  3.444748958123542*^9}, {3.444749004356734*^9, 3.444749069789867*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["SSAPhaseCurveData", "Subsection",
 CellChangeTimes->{{3.444781554976336*^9, 3.44478155774771*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SSAPhaseCurveData", "[", 
     RowBox[{"solution_", ",", " ", 
      RowBox[{"{", 
       RowBox[{"X_", ",", " ", "Y_"}], "}"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", " ", "y", ",", " ", "vars", ",", " ", "xy"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"x", "=", 
        RowBox[{
         RowBox[{"X", "/.", "solution"}], "/.", 
         RowBox[{"{", 
          RowBox[{"X", "\[Rule]", " ", "$Failed"}], "}"}]}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"y", "=", 
        RowBox[{
         RowBox[{"Y", "/.", "solution"}], "/.", 
         RowBox[{"{", 
          RowBox[{"Y", "\[Rule]", " ", "$Failed"}], "}"}]}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"vars", "=", 
        RowBox[{"First", "/@", "solution"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"SameQ", "[", 
            RowBox[{"#", ",", " ", "$Failed"}], "]"}], ",", " ", 
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Error: SSAPhasePlot: Variable \>\"", ",", " ", "X", ",", 
             " ", "\"\< not Found. Variables are: \>\"", ",", " ", "vars"}], 
            "]"}]}], "]"}], "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{"x", ",", " ", "y"}], "}"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"x", "=", 
        RowBox[{"Last", "/@", "x"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"y", "=", 
        RowBox[{"Last", "/@", "y"}]}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"xy", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", "xy"}]}], "\[IndentingNewLine]", "]"}]}], ";"}],
   " "}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.444781559731085*^9, 3.444781573610169*^9}, {
  3.44478163746467*^9, 3.444781684569575*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SSAPhaseArrayPlot", "[", 
   RowBox[{"solutions_", ",", " ", 
    RowBox[{"{", 
     RowBox[{"X_", ",", " ", "Y_"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"xmin_", ",", " ", "xmax_"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"ymin_", " ", ",", " ", "ymax_"}], "}"}]}], "}"}]}], "]"}], ":=",
   " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "pcdata", ",", " ", "ixmax", ",", " ", "iymax", ",", " ", "i", ",", " ", 
      "x", ",", " ", "y", ",", " ", "map"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ixmax", " ", "=", " ", 
      RowBox[{"xmax", "-", "xmin", " ", "+", " ", "1"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"iymax", " ", "=", " ", 
      RowBox[{"ymax", " ", "-", " ", "ymin", " ", "+", " ", "1"}]}], ";", " ",
      "\[IndentingNewLine]", 
     RowBox[{"map", " ", "=", " ", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", " ", 
        RowBox[{"{", 
         RowBox[{"ixmax", ",", " ", "iymax"}], "}"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"pcdata", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"SSAPhaseCurveData", "[", 
         RowBox[{"#", ",", " ", 
          RowBox[{"{", 
           RowBox[{"X", ",", "Y"}], "}"}]}], "]"}], "&"}], "/@", 
       "solutions"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pcdata", " ", "=", " ", 
      RowBox[{"Join", "@@", "pcdata"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", " ", 
       RowBox[{"i", "\[LessEqual]", " ", 
        RowBox[{"Length", "[", "pcdata", "]"}]}], ",", " ", 
       RowBox[{"i", "++"}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", " ", "y"}], "}"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"pcdata", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "+", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "-", "xmin"}], ",", " ", 
            RowBox[{"1", "-", "ymin"}]}], "}"}]}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"map", "[", 
          RowBox[{"[", 
           RowBox[{"x", ",", " ", "y"}], "]"}], "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"map", "[", 
           RowBox[{"[", 
            RowBox[{"x", ",", " ", "y"}], "]"}], "]"}], " ", "+", " ", 
          "1"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "map", "]"}], ";"}]}], " ", "\[IndentingNewLine]",
    " ", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.444781860914884*^9, 3.444781913727237*^9}, {
  3.444781948342289*^9, 3.444781976925903*^9}, {3.444782072875487*^9, 
  3.444782126750575*^9}, {3.444782180130052*^9, 3.444782184689542*^9}, {
  3.444782241648762*^9, 3.444782427209241*^9}, {3.444782493017159*^9, 
  3.444782496029856*^9}, {3.4447825527349*^9, 3.444782578550705*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Statistics", "Section",
 CellChangeTimes->{{3.444756620377148*^9, 3.444756621687339*^9}}],

Cell[CellGroupData[{

Cell["SSAFit", "Subsection",
 CellChangeTimes->{{3.444756624933325*^9, 3.444756627550696*^9}}],

Cell["creates a continuous interpolation of a SSA simulation set", "Text",
 CellChangeTimes->{{3.444760851306251*^9, 3.444760866273916*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SSAFit", "[", "sim_", "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"vars", ",", " ", "funcs", ",", " ", "fit"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"vars", " ", "=", " ", 
      RowBox[{"First", "/@", "sim"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"funcs", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Interpolation", "[", 
         RowBox[{
          RowBox[{"#", "/.", "sim"}], ",", " ", 
          RowBox[{"InterpolationOrder", "\[Rule]", " ", "1"}]}], "]"}], "&"}],
        "/@", "vars"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"fit", " ", "=", " ", 
      RowBox[{"MapThread", "[", 
       RowBox[{"Rule", ",", " ", 
        RowBox[{"{", 
         RowBox[{"vars", ",", " ", "funcs"}], "}"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.444756644153602*^9, 3.444756645133172*^9}, {
  3.444756695958498*^9, 3.444756721942943*^9}, {3.444756823182954*^9, 
  3.444756905464116*^9}, {3.508523871231241*^9, 3.508523901156967*^9}}],

Cell["\<\
Revised 5 Jan 2016 from P Schuster
\
\>", "Text",
 CellChangeTimes->{{3.661002332210965*^9, 3.6610023727346277`*^9}},
 FormatType->"TextForm"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SSAFit", "[", 
   RowBox[{"sim_", ",", "tmax_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "vars", ",", "nvars", ",", "ndata", ",", "tfin", ",", "vfin", ",", 
      "extract", ",", "data", ",", "ldata", ",", "newdata", ",", "funcs", ",",
       "fit"}], "}"}], ",", "\n", 
    RowBox[{
     RowBox[{"vars", "=", 
      RowBox[{"First", "/@", "sim"}]}], ";", "\n", 
     RowBox[{"nvars", "=", 
      RowBox[{"Length", "[", "vars", "]"}]}], ";", "\n", 
     RowBox[{"data", "=", 
      RowBox[{"sim", "/.", 
       RowBox[{"Rule", "->", "List"}]}]}], ";", "\n", 
     RowBox[{"ldata", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Rest", "/@", "data"}], ",", "1"}], "]"}]}], ";", "\n", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", "1"}], ",", 
       RowBox[{"j", "<=", "nvars"}], ",", 
       RowBox[{"j", "++"}], ",", 
       RowBox[{
        RowBox[{"extract", "=", 
         RowBox[{"ldata", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], ";", 
        RowBox[{"ndata", "=", 
         RowBox[{"Length", "[", "extract", "]"}]}], ";", 
        RowBox[{"tfin", "=", 
         RowBox[{"extract", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}], ";", 
        RowBox[{"vfin", "=", 
         RowBox[{"extract", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}]}], ";", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "<=", 
           RowBox[{"ndata", "-", "1"}]}], ",", 
          RowBox[{"i", "++"}], ",", 
          RowBox[{
           RowBox[{"extract", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"-", "i"}], ",", "2"}], "]"}], "]"}], "=", 
           RowBox[{"extract", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{"i", "+", "1"}], ")"}]}], ",", "2"}], "]"}], 
            "]"}]}]}], "]"}], ";", "\n", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"tfin", "<", "tmax"}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"extract", ",", 
            RowBox[{"{", 
             RowBox[{"tmax", ",", "vfin"}], "}"}]}], "]"}], ",", "Null"}], 
         "]"}], ";", "\n", 
        RowBox[{
         RowBox[{"ldata", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "=", "extract"}]}]}], "]"}], ";", 
     "\n", 
     RowBox[{"newdata", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{"Rule", ",", 
        RowBox[{"{", 
         RowBox[{"vars", ",", "ldata"}], "}"}]}], "]"}]}], ";", "\n", 
     RowBox[{"funcs", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Interpolation", "[", 
         RowBox[{
          RowBox[{"#", "/.", "newdata"}], ",", 
          RowBox[{"InterpolationOrder", "->", "0"}]}], "]"}], "&"}], "/@", 
       "vars"}]}], ";", "\n", 
     RowBox[{"fit", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{"Rule", ",", 
        RowBox[{"{", 
         RowBox[{"vars", ",", "funcs"}], "}"}]}], "]"}]}]}]}], "]"}], 
  "     "}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6610018000314293`*^9, 3.661001809855143*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["SSAMean", "Subsection",
 CellChangeTimes->{{3.529776432321526*^9, 3.529776437112939*^9}}],

Cell["revised 5 Jan 2016 from P. Schuster", "Text",
 CellChangeTimes->{{3.529776494457451*^9, 3.529776505529026*^9}, {
  3.5297765374092903`*^9, 3.5297765391614323`*^9}, {3.661002242857288*^9, 
  3.661002253662513*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SSAMean", "[", 
   RowBox[{"sims_", ",", "tmax_", ",", 
    RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "vars", ",", "fits", ",", "domains", ",", "tstart", ",", "tend", ",", 
      "dt", ",", "tvals", ",", "i", ",", "timespan", ",", "npoints", ",", 
      "values", ",", "sums", ",", "t", ",", "vals", ",", "functionate", ",", 
      "ffits", ",", "nvars", ",", "valsums", ",", "valsumsq", ",", "\[Mu]", 
      ",", "means", ",", "\[Sigma]", ",", "sigmas", ",", "nsims", ",", 
      "isims", ",", "times", ",", "plus1sigma", ",", "plus2sigma", ",", 
      "plus3sigma", ",", "minus1sigma", ",", "minus2sigma", ",", 
      "minus3sigma", ",", "\[Sigma]p1", ",", "\[Sigma]p2", ",", "\[Sigma]p3", 
      ",", "\[Sigma]m1", ",", "\[Sigma]m2", ",", "\[Sigma]m3", ",", "Interp", 
      ",", "dPrint", ",", "dbg", ",", "Rates", ",", "rates", ",", "results"}],
      "}"}], ",", 
    RowBox[{
     RowBox[{"dbg", "=", 
      RowBox[{
       RowBox[{"\"\<Debug\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<Debug\>\"", "->", "False"}], "}"}]}]}], ";", "\n", 
     RowBox[{"Rates", "=", 
      RowBox[{
       RowBox[{"\"\<Rates\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<Rates\>\"", "->", "False"}], "}"}]}]}], ";", "\n", 
     RowBox[{
      RowBox[{"dPrint", "[", "x___", "]"}], ":=", 
      RowBox[{"If", "[", 
       RowBox[{"dbg", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<SSAMean: \>\"", ",", "x"}], "]"}]}], "]"}]}], ";", "\n", 
     RowBox[{
      RowBox[{"functionate", "[", 
       RowBox[{"f_", ",", "val_"}], "]"}], ":=", 
      RowBox[{"f", "[", "val", "]"}]}], ";", "\n", 
     RowBox[{"npoints", "=", 
      RowBox[{
       RowBox[{"\"\<Points\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<Points\>\"", "->", "100"}], "}"}]}]}], ";", "\n", 
     RowBox[{"(*", " ", "*)"}], "\n", 
     RowBox[{"dPrint", "[", 
      RowBox[{"npoints", ",", "\"\<  Points\>\""}], "]"}], ";", "\n", 
     RowBox[{"(*", " ", "*)"}], "\n", 
     RowBox[{"timespan", "=", 
      RowBox[{
       RowBox[{"\"\<TimeSpan\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<TimeSpan\>\"", "->", "Automatic"}], "}"}]}]}], ";", "\n", 
     RowBox[{"nsims", "=", 
      RowBox[{"Length", "[", "sims", "]"}]}], ";", "\n", 
     RowBox[{"(*", " ", "*)"}], "\n", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<Simulation End  =  \>\"", ",", "tmax"}], "]"}], ";", "\n", 
     
     RowBox[{"Print", "[", 
      RowBox[{
      "npoints", ",", "\"\<  Points,  \>\"", ",", "nsims", ",", 
       "\"\<  Trajectories\>\"", ",", "\"\<,  Simulation End  =  \>\"", ",", 
       "tmax"}], "]"}], ";", "\n", 
     RowBox[{"(*", " ", "*)"}], "\n", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"npoints", "<", "2"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<Error: SSAMean requires n of at least 2\>\"", 
         "]"}], ";", "\n", 
        RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", "\n", 
     RowBox[{"vars", "=", 
      RowBox[{"Union", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{"First", ",", "#"}], "]"}], "&"}], "/@", "sims"}], "]"}], 
       "]"}]}], ";", "\n", 
     RowBox[{"(*", " ", "d", " ", "*)"}], "\n", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<vars: \>\"", ",", "vars"}], "]"}], ";", "\n", 
     RowBox[{"nvars", "=", 
      RowBox[{"Length", "[", "vars", "]"}]}], ";", "\n", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<nvars: \>\"", ",", "nvars"}], "]"}], ";", "\n", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<sims : \>\"", ",", "sims"}], "]"}], ";", "\n", 
     RowBox[{"(*", " ", "*)"}], "\n", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"Cases", "[", 
           RowBox[{"sims", ",", 
            RowBox[{"InterpolatingFunction", "[", "___", "]"}], ",", "3"}], 
           "]"}], "]"}], ">", "0"}], ")"}], ",", 
       RowBox[{
        RowBox[{
        "dPrint", "[", "\"\<Mode is Interpolation, no fitting done.\>\"", 
         "]"}], ";", "\n", 
        RowBox[{"fits", "=", "sims"}], ";"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<Fitting data. Interpolation Level = 0.\>\"", "]"}],
         ";", "\n", 
        RowBox[{"fits", "=", "sims"}], ";", "\n", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"isims", "=", "1"}], ",", 
          RowBox[{"isims", "<=", "nsims"}], ",", 
          RowBox[{"isims", "++"}], ",", 
          RowBox[{
           RowBox[{"fits", "[", 
            RowBox[{"[", "isims", "]"}], "]"}], "=", 
           RowBox[{"SSAFitCor", "[", 
            RowBox[{
             RowBox[{"sims", "[", 
              RowBox[{"[", "isims", "]"}], "]"}], ",", "tmax"}], "]"}]}]}], 
         "]"}]}]}], "]"}], ";", "\n", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"fits", "=", 
         RowBox[{"SSAFitCor", "/@", "sims"}]}], "]"}], ";"}], "*)"}], "\n", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<fits: \>\"", ",", "fits"}], "]"}], ";", "\n", 
     RowBox[{"fits", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"vars", "/.", "#"}], ")"}], "&"}], "/@", "fits"}]}], ";", 
     "\n", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<fits: \>\"", ",", "fits"}], "]"}], ";"}], "*)"}], "\n", 
     RowBox[{"ffits", "=", 
      RowBox[{"Flatten", "[", "fits", "]"}]}], ";", "\n", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<ffits: \>\"", ",", "ffits"}], "]"}], ";", "\n", 
     RowBox[{"(*", " ", "*)"}], "\n", 
     RowBox[{"domains", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{"InterpolatingFunctionDomain", ",", "#"}], "]"}], "&"}], "/@",
        "fits"}]}], ";", "\n", 
     RowBox[{"domains", "=", 
      RowBox[{
       RowBox[{"Partition", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", "domains", "]"}], ",", "2"}], "]"}], "//", 
       "Transpose"}]}], ";", "\n", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tstart", ",", "tend"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{"domains", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{"domains", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], ";", "\n", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Not", "[", 
        RowBox[{"SameQ", "[", 
         RowBox[{"timespan", ",", "Automatic"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"timespan", "=", 
         RowBox[{"PadRight", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"{", "timespan", "}"}], "]"}], ",", "2", ",", "tend"}], 
          "]"}]}], ";", "\n", 
        RowBox[{"tstart", "=", 
         RowBox[{"Max", "[", 
          RowBox[{"tstart", ",", 
           RowBox[{"timespan", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", "\n", 
        RowBox[{"tend", "=", 
         RowBox[{"Min", "[", 
          RowBox[{"tend", ",", 
           RowBox[{"timespan", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";", "\n", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"tend", "<", "tstart"}], ",", 
          RowBox[{
           RowBox[{
           "Print", "[", "\"\<Error: SSAMean tend < tstart.\>\"", "]"}], ";", 
           "\n", 
           RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";"}]}], "]"}],
      ";", "\n", 
     RowBox[{"dt", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"tend", "-", "tstart"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"npoints", "-", "1."}], ")"}]}]}], ";", "\n", 
     RowBox[{"(*", " ", "*)"}], "\n", 
     RowBox[{"dPrint", "[", 
      RowBox[{
      "\"\<tstart = \>\"", ",", "tstart", ",", "\"\<, tend = \>\"", ",", 
       "tend", ",", "\"\<, dt = \>\"", ",", "dt"}], "]"}], ";", "\n", 
     RowBox[{"(*", " ", "*)"}], "\n", 
     RowBox[{"tvals", "=", 
      RowBox[{"times", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"tstart", "+", 
          RowBox[{"i", "*", "dt"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{"npoints", "-", "1"}]}], "}"}]}], "]"}]}]}], ";", "\n", 
     RowBox[{"(*", " ", "*)"}], "\n", 
     RowBox[{"dPrint", "[", "tvals", "]"}], ";", "\n", 
     RowBox[{"(*", " ", "*)"}], "\n", 
     RowBox[{"means", "=", 
      RowBox[{"sigmas", "=", 
       RowBox[{"plus1sigma", "=", 
        RowBox[{"plus2sigma", "=", 
         RowBox[{"plus3sigma", "=", 
          RowBox[{"minus1sigma", "=", 
           RowBox[{"minus2sigma", "=", 
            RowBox[{"minus3sigma", "=", 
             RowBox[{"{", "}"}]}]}]}]}]}]}]}]}], ";", "\n", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "tvals", "]"}], ">", "0"}], ",", 
       RowBox[{
        RowBox[{"t", "=", 
         RowBox[{"First", "[", "tvals", "]"}]}], ";", "\n", 
        RowBox[{"tvals", "=", 
         RowBox[{"Rest", "[", "tvals", "]"}]}], ";", "\n", 
        RowBox[{"vals", "=", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"functionate", "[", 
              RowBox[{"#", ",", "t"}], "]"}], "&"}], "/@", "ffits"}], ",", 
           "nvars"}], "]"}]}], ";", "\n", 
        RowBox[{"(*", " ", "*)"}], "\n", 
        RowBox[{"dPrint", "[", 
         RowBox[{
         "\"\<time t = \>\"", ",", "t", ",", "\"\<:  \>\"", ",", "vals"}], 
         "]"}], ";", "\n", 
        RowBox[{"(*", " ", "*)"}], "\n", 
        RowBox[{"valsums", "=", 
         RowBox[{"Plus", "@@", "vals"}]}], ";", "\n", 
        RowBox[{"\[Mu]", "=", 
         RowBox[{"valsums", "/", "nsims"}]}], ";", "\n", 
        RowBox[{"valsumsq", "=", 
         RowBox[{"Plus", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "*", "#"}], "&"}], "/@", "vals"}], ")"}]}]}], ";", 
        "\n", 
        RowBox[{"\[Sigma]", "=", 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"valsumsq", "/", "nsims"}], "-", 
           RowBox[{"\[Mu]", "^", "2"}]}], "]"}]}], ";", "\n", 
        RowBox[{"(*", " ", "*)"}], "\n", 
        RowBox[{"dPrint", "[", 
         RowBox[{
         "\"\<time t = \>\"", ",", "t", ",", "\"\<:   \>\"", ",", "valsums", 
          ",", "\"\<   \>\"", ",", "valsumsq", ",", "\"\<   \>\"", ",", 
          "\[Mu]", ",", "\"\<   \>\"", ",", "\[Sigma]"}], "]"}], ";", "\n", 
        RowBox[{"(*", " ", "*)"}], "\n", 
        RowBox[{"\[Sigma]p1", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "#"}], "}"}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{"\[Mu]", "+", "\[Sigma]"}], ")"}]}]}], ";", "\n", 
        RowBox[{"\[Sigma]p2", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "#"}], "}"}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{"\[Mu]", "+", 
            RowBox[{"2", " ", "\[Sigma]"}]}], ")"}]}]}], ";", "\n", 
        RowBox[{"\[Sigma]p3", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "#"}], "}"}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{"\[Mu]", "+", 
            RowBox[{"3", " ", "\[Sigma]"}]}], ")"}]}]}], ";", "\n", 
        RowBox[{"\[Sigma]m1", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "#"}], "}"}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{"0", ",", "#"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{"\[Mu]", "-", "\[Sigma]"}], ")"}]}], ")"}]}]}], ";", 
        "\n", 
        RowBox[{"\[Sigma]m2", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "#"}], "}"}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{"0", ",", "#"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{"\[Mu]", "-", 
              RowBox[{"2", " ", "\[Sigma]"}]}], ")"}]}], ")"}]}]}], ";", "\n", 
        RowBox[{"\[Sigma]m3", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "#"}], "}"}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{"0", ",", "#"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{"\[Mu]", "-", 
              RowBox[{"3", " ", "\[Sigma]"}]}], ")"}]}], ")"}]}]}], ";", "\n", 
        RowBox[{"\[Mu]", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "#"}], "}"}], "&"}], "/@", "\[Mu]"}]}], ";", 
        RowBox[{"\[Sigma]", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "#"}], "}"}], "&"}], "/@", "\[Sigma]"}]}], ";", 
        "\n", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"means", ",", "\[Mu]"}], "]"}], ";", "\n", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"sigmas", ",", "\[Sigma]"}], "]"}], ";", "\n", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"plus1sigma", ",", "\[Sigma]p1"}], "]"}], ";", "\n", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"plus2sigma", ",", "\[Sigma]p2"}], "]"}], ";", "\n", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"plus3sigma", ",", "\[Sigma]p3"}], "]"}], ";", "\n", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"minus1sigma", ",", "\[Sigma]m1"}], "]"}], ";", "\n", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"minus2sigma", ",", "\[Sigma]m2"}], "]"}], ";", "\n", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"minus3sigma", ",", "\[Sigma]m3"}], "]"}], ";"}]}], "]"}], 
     ";", "\n", 
     RowBox[{
      RowBox[{"Interp", "[", "list_", "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", "ilist", "}"}], ",", 
        RowBox[{
         RowBox[{"ilist", "=", 
          RowBox[{"Transpose", "[", "list", "]"}]}], ";", "\n", 
         RowBox[{"ilist", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Interpolation", "[", 
             RowBox[{"#", ",", 
              RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "&"}], "/@",
            "ilist"}]}], ";", "\n", 
         RowBox[{"ilist", "=", 
          RowBox[{"MapThread", "[", 
           RowBox[{"Rule", ",", 
            RowBox[{"{", 
             RowBox[{"vars", ",", "ilist"}], "}"}]}], "]"}]}], ";", "\n", 
         RowBox[{"Return", "[", "ilist", "]"}], ";"}]}], "]"}]}], ";", "\n", 
     RowBox[{"means", "=", 
      RowBox[{"Interp", "[", "means", "]"}]}], ";", "\n", 
     RowBox[{"sigmas", "=", 
      RowBox[{"Interp", "[", "sigmas", "]"}]}], ";", "\n", 
     RowBox[{"plus1sigma", "=", 
      RowBox[{"Interp", "[", "plus1sigma", "]"}]}], ";", "\n", 
     RowBox[{"plus2sigma", "=", 
      RowBox[{"Interp", "[", "plus2sigma", "]"}]}], ";", "\n", 
     RowBox[{"plus3sigma", "=", 
      RowBox[{"Interp", "[", "plus3sigma", "]"}]}], ";", "\n", 
     RowBox[{"minus1sigma", "=", 
      RowBox[{"Interp", "[", "minus1sigma", "]"}]}], ";", "\n", 
     RowBox[{"minus2sigma", "=", 
      RowBox[{"Interp", "[", "minus2sigma", "]"}]}], ";", "\n", 
     RowBox[{"minus3sigma", "=", 
      RowBox[{"Interp", "[", "minus3sigma", "]"}]}], ";", "\n", 
     RowBox[{"results", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<Means\>\"", "->", "means"}], ",", 
        RowBox[{"\"\<StandardDeviations\>\"", "->", "sigmas"}], ",", 
        RowBox[{"\"\<MeanPlusSigma\>\"", "->", "plus1sigma"}], ",", 
        RowBox[{"\"\<MeanPlus2Sigma\>\"", "->", "plus2sigma"}], ",", 
        RowBox[{"\"\<MeanPlus3Sigma\>\"", "->", "plus3sigma"}], ",", 
        RowBox[{"\"\<MeanMinusSigma\>\"", "->", "minus1sigma"}], ",", 
        RowBox[{"\"\<MeanMinus2Sigma\>\"", "->", "minus2sigma"}], ",", 
        RowBox[{"\"\<MeanMinus3Sigma\>\"", "->", "minus3sigma"}]}], "}"}]}], 
     ";", "\n", 
     RowBox[{"tvals", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"tstart", "+", 
         RowBox[{"i", "*", "dt"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", 
          RowBox[{"npoints", "-", "1"}]}], "}"}]}], "]"}]}], ";", "\n", 
     RowBox[{"If", "[", 
      RowBox[{"Rates", ",", 
       RowBox[{"(*", 
        RowBox[{
        "MMA", " ", "will", " ", "convert", " ", "linear", " ", "to", " ", 
         "step", " ", "function", " ", "interpolation"}], "*)"}], 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "meanrates", ",", "ifs", ",", "n", ",", "if", ",", "variable", ",", 
           "name", ",", "data", ",", "fit"}], "}"}], ",", 
         RowBox[{
          RowBox[{"meanrates", "=", 
           RowBox[{"{", "}"}]}], ";", "\n", 
          RowBox[{"vars", "=", 
           RowBox[{"First", "/@", "means"}]}], ";", "\n", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<mean rates to be computed: \>\"", ",", "vars"}], 
           "]"}], ";", "\n", 
          RowBox[{"ifs", "=", 
           RowBox[{"(", 
            RowBox[{"Last", "/@", "means"}], ")"}]}], ";", "\n", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<ifs: \>\"", ",", "ifs"}], "]"}], ";", "\n", 
          RowBox[{"n", "=", 
           RowBox[{"Length", "[", "vars", "]"}]}], ";", "\n", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"i", "=", "1"}], ",", 
            RowBox[{"i", "<=", "n"}], ",", 
            RowBox[{"i", "++"}], ",", 
            RowBox[{
             RowBox[{"if", "=", 
              RowBox[{"ifs", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ";", "\n", 
             RowBox[{"variable", "=", 
              RowBox[{"vars", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ";", "\n", 
             RowBox[{"name", "=", 
              RowBox[{"Symbol", "[", 
               RowBox[{"\"\<\[Delta]\>\"", "<>", 
                RowBox[{"ToString", "[", "variable", "]"}], "<>", 
                "\"\<\[Delta]t\>\""}], "]"}]}], ";", "\n", 
             RowBox[{"dPrint", "[", 
              RowBox[{"\"\<name: \>\"", ",", "name"}], "]"}], ";", "\n", 
             RowBox[{"data", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"#", ",", 
                  RowBox[{
                   RowBox[{"if", "'"}], "[", "#", "]"}]}], "}"}], "&"}], "/@",
                "tvals"}]}], ";", "\n", 
             RowBox[{"fit", "=", 
              RowBox[{"Interpolation", "[", 
               RowBox[{"data", ",", 
                RowBox[{"InterpolationOrder", "->", "2"}]}], "]"}]}], ";", 
             "\n", 
             RowBox[{"dPrint", "[", 
              RowBox[{"{", 
               RowBox[{"name", "->", "fit"}], "}"}], "]"}], ";", "\n", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"meanrates", ",", 
               RowBox[{"name", "->", "fit"}]}], "]"}], ";"}]}], "]"}], ";", 
          "\n", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"results", ",", 
            RowBox[{"\"\<MeanRates\>\"", "->", "meanrates"}]}], "]"}], 
          ";"}]}], "]"}]}], "]"}], ";", "\n", 
     RowBox[{"Return", "[", "results", "]"}], ";"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6610021967145987`*^9, 3.661002198790978*^9}, 
   3.661002235149887*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["PlotStats", "Subsection",
 CellChangeTimes->{{3.529776462113439*^9, 3.5297764635291243`*^9}}],

Cell["rev 1.2.02 copied from xSSA no changes", "Text",
 CellChangeTimes->{{3.5297765189129353`*^9, 3.529776528921636*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PlotStats", "[", 
   RowBox[{"var_", ",", "stats_", ",", 
    RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "start", ",", "stop", ",", "top", ",", "bot", ",", "mean", ",", "t"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{"top", "=", 
      RowBox[{"var", "/.", 
       RowBox[{"(", 
        RowBox[{"\"\<MeanPlusSigma\>\"", "/.", "stats"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"bot", "=", 
      RowBox[{"var", "/.", 
       RowBox[{"(", 
        RowBox[{"\"\<MeanMinusSigma\>\"", "/.", "stats"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mean", "=", 
      RowBox[{"var", "/.", 
       RowBox[{"(", 
        RowBox[{"\"\<Means\>\"", "/.", "stats"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"start", ",", "stop"}], "}"}], "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"InterpolatingFunctionDomain", "[", 
        RowBox[{"var", "/.", 
         RowBox[{"(", 
          RowBox[{"\"\<Means\>\"", "/.", "stats"}], ")"}]}], "]"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"top", "[", "t", "]"}], ",", 
         RowBox[{"bot", "[", "t", "]"}], ",", 
         RowBox[{"mean", "[", "t", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "start", ",", "stop"}], "}"}], ",", 
       RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
       RowBox[{"Filling", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"1", "\[Rule]", 
          RowBox[{"{", "2", "}"}]}], "}"}]}], ",", "opt"}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.529776469949876*^9, 3.5297764699510508`*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["XML input/out with CelleratorML", "Section",
 CellChangeTimes->{{3.446167207256802*^9, 3.446167212163393*^9}}],

Cell[CellGroupData[{

Cell["SSASave, SSASaveXML", "Subsection",
 CellChangeTimes->{{3.446167215160434*^9, 3.446167215296614*^9}, {
  3.446167262645022*^9, 3.446167264162776*^9}, {3.446299318110008*^9, 
  3.446299323361872*^9}, {3.446302717080847*^9, 3.446302721083785*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CelleratorMLLoaded", "=", "False"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SSASave", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"SSASaveXML", "[", "x", "]"}]}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SSASaveXML", "[", 
     RowBox[{
      RowBox[{"file_", "?", "StringQ"}], ",", " ", "model_", ",", " ", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
    RowBox[{"SSASaveXML", "[", 
     RowBox[{"model", ",", " ", 
      RowBox[{"\"\<File\>\"", "\[Rule]", " ", "file"}], ",", " ", "opt"}], 
     "]"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SSASaveXML", "[", 
    RowBox[{"model_", ",", " ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "x", ",", " ", "p", ",", " ", "ic", ",", "saved", ",", " ", "name", ",",
        " ", "opts", ",", " ", "filename", ",", " ", "descr", ",", " ", 
       "save"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", "CelleratorMLLoaded"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"save", "=", "FLAGS`ECHOLOAD"}], ";", "\[IndentingNewLine]", 
         
         RowBox[{"FLAGS`ECHOLOAD", "=", "False"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"load", " ", "=", " ", 
          RowBox[{"Get", "[", "\"\<CelleratorML.m\>\"", "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"FLAGS`ECHOLOAD", "=", "save"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"SameQ", "[", 
            RowBox[{"load", ",", " ", "$Failed"}], "]"}], ",", " ", 
           RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"CelleratorMLLoaded", "=", "True"}], ";"}]}], " ", 
       "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"p", "=", 
       RowBox[{
        RowBox[{"\"\<Parameters\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Parameters\>\"", "\[Rule]", " ", 
          RowBox[{"{", "}"}]}], "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"ic", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<InitialConditions\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<InitialConditions\>\"", "\[Rule]", " ", 
          RowBox[{"{", "}"}]}], "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"name", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<Name\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Name\>\"", "\[Rule]", " ", "\"\<SSA-Model\>\""}], 
         "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"descr", "=", 
       RowBox[{
        RowBox[{"\"\<Description\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Description\>\"", "\[Rule]", " ", 
          "\"\<Model converted from SSA\>\""}], "}"}]}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"filename", "=", 
       RowBox[{
        RowBox[{"\"\<File\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<File\>\"", "\[Rule]", " ", "Automatic"}], "}"}]}]}], 
      ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"filename", ",", " ", "Automatic"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"filename", "=", 
          RowBox[{"SystemDialogInput", "[", 
           RowBox[{"\"\<FileSave\>\"", ",", " ", "\"\<SSA-Model.xml\>\""}], 
           "]"}]}], ";", " ", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"SameQ", "[", 
            RowBox[{"filename", ",", " ", "$Canceled"}], "]"}], ",", " ", 
           RowBox[{"Return", "[", "$Canceled", "]"}]}], "]"}], ";"}]}], " ", 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"x", "=", 
       RowBox[{"SSAtoXLR8R", "[", "model", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"opts", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<Parameters\>\"", "\[Rule]", " ", "p"}], ",", " ", 
         RowBox[{"\"\<InitialConditions\>\"", "\[Rule]", " ", "ic"}], ",", 
         " ", 
         RowBox[{"\"\<SoftwareTool\>\"", "\[Rule]", " ", "\"\<SSA\>\""}], ",",
          " ", 
         RowBox[{"\"\<Name\>\"", "\[Rule]", " ", "name"}], " ", ",", " ", 
         RowBox[{"\"\<Description\>\"", "\[Rule]", " ", "descr"}]}], "}"}]}], 
      ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"filename", ",", "\"\<\>\""}], "]"}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"saved", "=", 
           RowBox[{"CelleratorML`SaveModel", "[", 
            RowBox[{"x", ",", " ", 
             RowBox[{"Sequence", "@@", "opts"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"SameQ", "[", 
              RowBox[{"filename", ",", " ", "Automatic"}], "]"}], ",", " ", 
             RowBox[{"filename", "=", "\"\<SSA-Model.xml\>\""}]}], "]"}], ";",
            " ", "\[IndentingNewLine]", 
           RowBox[{"saved", "=", 
            RowBox[{"CelleratorML`SaveModel", "[", 
             RowBox[{"filename", ",", " ", "x", ",", " ", 
              RowBox[{"Sequence", "@@", "opts"}]}], "]"}]}]}]}], 
         "\[IndentingNewLine]", "]"}], ";"}], " ", "\[IndentingNewLine]", 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"saved", "=", 
       RowBox[{"CelleratorML`SaveModel", "[", 
        RowBox[{"filename", ",", " ", "x", ",", " ", 
         RowBox[{"Sequence", "@@", "opts"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "saved", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SSASaveXML", "[", "x___", "]"}], ":=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Print", "[", "\"\<Expecting SSASave[model]\>\"", "]"}], ";", 
     " ", "$Failed"}], ")"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.446167279092782*^9, 3.44616733939414*^9}, {
   3.446167376537988*^9, 3.446167415552627*^9}, {3.44616749867022*^9, 
   3.446167656507318*^9}, {3.446167714176879*^9, 3.446167714446468*^9}, {
   3.446167833633366*^9, 3.446168021657184*^9}, {3.446168092455041*^9, 
   3.446168137681684*^9}, {3.446168683240836*^9, 3.446168887575816*^9}, {
   3.446168940483705*^9, 3.446168951122634*^9}, {3.446169040279084*^9, 
   3.446169072275356*^9}, {3.446169125408861*^9, 3.446169164974566*^9}, {
   3.446169367682118*^9, 3.446169396443569*^9}, {3.446169503656008*^9, 
   3.446169507102572*^9}, {3.446300369220536*^9, 3.446300446116331*^9}, {
   3.446300479737073*^9, 3.446300480536182*^9}, {3.446300601761127*^9, 
   3.446300627369704*^9}, 3.446300948257701*^9, {3.446300978469131*^9, 
   3.446300979910459*^9}, {3.446301013630654*^9, 3.446301014534544*^9}, {
   3.446301643626184*^9, 3.446301645480159*^9}, {3.446301711738614*^9, 
   3.446301723263789*^9}, {3.44630220011826*^9, 3.446302218257194*^9}, {
   3.446302324012753*^9, 3.446302419265743*^9}, {3.446302629761608*^9, 
   3.446302665583011*^9}, {3.446309072304277*^9, 3.446309103611912*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["SSAGet, SSAReadXML", "Subsection",
 CellChangeTimes->{{3.446299302212688*^9, 3.44629930506222*^9}, {
  3.446302776580749*^9, 3.446302793970693*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SSAGet", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"SSAReadXML", "[", "x", "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SSAReadXML", "[", 
    RowBox[{
     RowBox[{"file_", "?", "StringQ"}], ",", " ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "load", ",", " ", "m", ",", " ", "r", ",", " ", "ic", ",", " ", "opts", 
       ",", " ", "name", ",", " ", "save"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{
          RowBox[{"\"\<Quiet\>\"", "/.", 
           RowBox[{"{", "opt", "}"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{"\"\<Quiet\>\"", "\[Rule]", " ", "False"}], "}"}]}], "]"}],
         ",", " ", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Reading: \>\"", "<>", "file", "<>", "\"\< ...\>\""}], 
         "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", "CelleratorMLLoaded"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"save", "=", "FLAGS`ECHOLOAD"}], ";", "\[IndentingNewLine]", 
         
         RowBox[{"FLAGS`ECHOLOAD", "=", "False"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"load", " ", "=", " ", 
          RowBox[{"Get", "[", "\"\<CelleratorML.m\>\"", "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"FLAGS`ECHOLOAD", "=", "save"}], ";", "\[IndentingNewLine]", 
         
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"SameQ", "[", 
            RowBox[{"load", ",", " ", "$Failed"}], "]"}], ",", " ", 
           RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"CelleratorMLLoaded", "=", "True"}], ";"}]}], " ", 
       "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"m", "=", 
       RowBox[{"CelleratorML`GetModel", "[", 
        RowBox[{"file", ",", " ", "opt"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"m", ",", " ", "$Failed"}], "]"}], ",", " ", 
        RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m", ",", " ", "r", ",", " ", "ic", ",", " ", "opts"}], "}"}],
        "=", "m"}], ";", "\[IndentingNewLine]", 
      RowBox[{"m", "=", 
       RowBox[{"XLR8RtoSSA", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"name", "=", 
       RowBox[{
        RowBox[{"\"\<Name\>\"", "/.", "opts"}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Name\>\"", "\[Rule]", " ", 
          RowBox[{"ToString", "[", 
           RowBox[{"Unique", "[", "\"\<Model\>\"", "]"}], "]"}]}], "}"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<Name\>\"", "\[Rule]", " ", "name"}], ",", " ", 
         RowBox[{"\"\<Model\>\"", "\[Rule]", " ", "m"}], ",", " ", 
         RowBox[{"\"\<Parameters\>\"", "\[Rule]", " ", "r"}], ",", 
         RowBox[{"\"\<InitialConditions\>\"", "\[Rule]", " ", "ic"}]}], "}"}],
        "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SSAReadXML", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "f", "}"}], ",", " ", 
     RowBox[{
      RowBox[{"f", "=", 
       RowBox[{"SystemDialogInput", "[", 
        RowBox[{"\"\<FileOpen\>\"", ",", " ", "\"\<*.xml\>\""}], "]"}]}], ";",
       " ", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"SSAReadXML", "[", "f", "]"}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SSAReadXML", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Error: SSAReadXML: Expecting SSAReadXML[filename]\>\"", "]"}], 
      ";", " ", "$Failed"}], ")"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.446299326439905*^9, 3.446299457224293*^9}, {
  3.446300220132738*^9, 3.446300288045071*^9}, {3.446301069039894*^9, 
  3.446301127467174*^9}, {3.446301206198159*^9, 3.446301358325524*^9}, {
  3.446301416069727*^9, 3.446301456741555*^9}, {3.446301813976826*^9, 
  3.446301821997717*^9}, {3.446301900893696*^9, 3.446301931264631*^9}, {
  3.446302048200087*^9, 3.446302070153719*^9}, {3.446302124242947*^9, 
  3.446302159147123*^9}, {3.446302741075798*^9, 3.446302753061331*^9}, {
  3.446303127754164*^9, 3.44630313326984*^9}, {3.446303431605507*^9, 
  3.446303522541368*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Exit", "Section",
 CellChangeTimes->{3.427494070422385*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vrel", "=", 
   RowBox[{
    RowBox[{"StringTake", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ToString", "[", "$VersionNumber", "]"}], "<>", "\"\<00\>\""}],
       ",", "3"}], "]"}], "<>", "\"\<.\>\"", "<>", 
    RowBox[{"ToString", "[", "$ReleaseNumber", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{"xSSA`Private`msgflag", ",", " ", 
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<xSSAlite \>\"", "<>", "$xSSA$Version", "<>", "\"\< loaded \>\"", "<>", 
      RowBox[{"now", "[", "]"}], "<>", "\"\< using Mathematica \>\"", "<>", 
      "$Version", "<>", "\"\<(\>\"", "<>", "vrel", "<>", "\"\<)\>\""}], 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EndPackage", "[", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.445700582876452*^9, 3.445700612273833*^9}, {
  3.455473367140773*^9, 3.455473369495517*^9}, {3.457441129987191*^9, 
  3.457441144426078*^9}, {3.508523164126075*^9, 3.508523164581019*^9}}]
}, Closed]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{966, 956},
WindowMargins->{{30, Automatic}, {Automatic, 33}},
Magnification:>FEPrivate`If[
  FEPrivate`Equal[FEPrivate`$VersionNumber, 6.], 1.25, 1.25 Inherited],
FrontEndVersion->"10.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (October 9, \
2015)",
StyleDefinitions->FrontEnd`FileName[{"Creative"}, "PastelColor.nb", 
  CharacterEncoding -> "UTF-8"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 180, 3, 54, "Subtitle"],
Cell[750, 27, 2934, 55, 730, "Text"],
Cell[CellGroupData[{
Cell[3709, 86, 97, 1, 71, "Section"],
Cell[3809, 89, 262, 5, 49, "Input",
 InitializationCell->True],
Cell[4074, 96, 928, 18, 48, "Input",
 InitializationCell->True],
Cell[5005, 116, 215, 5, 49, "Input",
 InitializationCell->True],
Cell[5223, 123, 947, 25, 154, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[6207, 153, 159, 2, 53, "Section"],
Cell[6369, 157, 3601, 55, 309, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[10007, 217, 31, 0, 53, "Section"],
Cell[10041, 219, 10769, 202, 2044, "Input",
 InitializationCell->True],
Cell[20813, 423, 1063, 22, 259, "Input",
 InitializationCell->True],
Cell[21879, 447, 4180, 85, 931, "Input",
 InitializationCell->True],
Cell[26062, 534, 119, 3, 49, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[26218, 542, 28, 0, 53, "Section"],
Cell[CellGroupData[{
Cell[26271, 546, 105, 1, 808, "Subsection"],
Cell[26379, 549, 123, 1, 1010, "Text"],
Cell[26505, 552, 2714, 48, 5453, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[29256, 605, 91, 1, 597, "Subsection"],
Cell[29350, 608, 501, 14, 3032, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[29888, 627, 154, 2, 597, "Subsection"],
Cell[30045, 631, 2167, 57, 10093, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[32249, 693, 148, 2, 597, "Subsection"],
Cell[32400, 697, 3295, 84, 13196, "Input",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[35744, 787, 108, 1, 53, "Section"],
Cell[CellGroupData[{
Cell[35877, 792, 115, 1, 647, "Subsection"],
Cell[35995, 795, 567, 16, 1043, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[36599, 816, 99, 1, 647, "Subsection"],
Cell[36701, 819, 2078, 66, 4057, "Input",
 InitializationCell->True]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[38828, 891, 101, 1, 53, "Section"],
Cell[CellGroupData[{
Cell[38954, 896, 100, 1, 31, "Subsubsection"],
Cell[39057, 899, 791, 24, 802200, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[39885, 928, 85, 1, 22, "Subsubsection"],
Cell[39973, 931, 650, 22, 4441, "Input",
 InitializationCell->True],
Cell[40626, 955, 519, 18, 3553, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[41182, 978, 43, 0, 22, "Subsubsection"],
Cell[41228, 980, 71, 0, 46, "Text"],
Cell[41302, 982, 14444, 361, 2190, "Input",
 InitializationCell->True],
Cell[55749, 1345, 456, 10, 195, "Text"],
Cell[56208, 1357, 2122, 49, 378, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[58367, 1411, 125, 1, 33, "Subsection"],
Cell[58495, 1414, 647, 17, 91, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[59167, 1435, 105, 1, 31, "Subsubsection"],
Cell[59275, 1438, 873, 21, 154, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[60185, 1464, 178, 2, 31, "Subsubsection"],
Cell[60366, 1468, 840, 27, 70, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[61243, 1500, 135, 1, 31, "Subsubsection"],
Cell[61381, 1503, 2891, 76, 14210, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[64309, 1584, 294, 10, 42, "Subsubsection"],
Cell[64606, 1596, 3170, 81, 884338, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[67813, 1682, 298, 10, 42, "Subsubsection"],
Cell[68114, 1694, 5522, 132, 4120, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[73673, 1831, 362, 11, 49, "Subsubsection"],
Cell[74038, 1844, 5859, 137, 1144445, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[79934, 1986, 339, 11, 42, "Subsubsection"],
Cell[80276, 1999, 5658, 137, 3907, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[85971, 2141, 116, 1, 22, "Subsubsection"],
Cell[86090, 2144, 436, 12, 70, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[86587, 2163, 88, 1, 53, "Section"],
Cell[86678, 2166, 111, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[86814, 2171, 26, 0, 33, "Subsection"],
Cell[86843, 2173, 80580, 1692, 9772, "Input",
 InitializationCell->True],
Cell[167426, 3867, 659, 14, 196, "Text"],
Cell[168088, 3883, 2635, 62, 563, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[170748, 3949, 113, 1, 31, "Subsubsection"],
Cell[170864, 3952, 5502, 133, 12757, "Input",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[176415, 4091, 110, 4, 54, "Subsection"],
Cell[176528, 4097, 2272, 48, 343781, "Input",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[178849, 4151, 199, 3, 53, "Section"],
Cell[CellGroupData[{
Cell[179073, 4158, 98, 1, 72, "Subsection"],
Cell[CellGroupData[{
Cell[179196, 4163, 159, 2, 53, "Subsubsection"],
Cell[179358, 4167, 1999, 61, 5362, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[181394, 4233, 234, 7, 58, "Subsubsection"],
Cell[181631, 4242, 615, 19, 2978, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[182283, 4266, 238, 7, 58, "Subsubsection"],
Cell[182524, 4275, 5171, 150, 791, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[187732, 4430, 248, 7, 78, "Subsubsection"],
Cell[187983, 4439, 4515, 107, 36546, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[192535, 4551, 330, 9, 58, "Subsubsection"],
Cell[192868, 4562, 2965, 84, 546, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[195870, 4651, 109, 1, 40, "Subsubsection"],
Cell[195982, 4654, 1237, 30, 2562, "Input",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[197268, 4690, 98, 1, 72, "Subsection"],
Cell[CellGroupData[{
Cell[197391, 4695, 102, 1, 53, "Subsubsection"],
Cell[197496, 4698, 472, 14, 76, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[198005, 4717, 135, 2, 40, "Subsubsection"],
Cell[198143, 4721, 880, 23, 185, "Input",
 InitializationCell->True]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[199084, 4751, 27, 0, 53, "Section"],
Cell[CellGroupData[{
Cell[199136, 4755, 29, 0, 226, "Subsection"],
Cell[199168, 4757, 2198, 53, 1540471, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[201403, 4815, 32, 0, 171, "Subsection"],
Cell[201438, 4817, 3093, 77, 5917202, "Input",
 InitializationCell->True],
Cell[204534, 4896, 1101, 29, 2547977, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[205672, 4930, 33, 0, 171, "Subsection"],
Cell[205708, 4932, 3095, 77, 15550, "Input",
 InitializationCell->True],
Cell[208806, 5011, 3797, 95, 17885, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[212640, 5111, 100, 1, 171, "Subsection"],
Cell[212743, 5114, 5515, 138, 248440, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[218295, 5257, 104, 1, 171, "Subsection"],
Cell[218402, 5260, 2163, 56, 99321, "Input",
 InitializationCell->True],
Cell[220568, 5318, 3111, 78, 99321, "Input",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[223728, 5402, 95, 1, 53, "Section"],
Cell[CellGroupData[{
Cell[223848, 5407, 94, 1, 44, "Subsection"],
Cell[223945, 5410, 140, 1, 36, "Text"],
Cell[224088, 5413, 1135, 28, 133, "Input",
 InitializationCell->True],
Cell[225226, 5443, 152, 5, 59, "Text"],
Cell[225381, 5450, 3328, 94, 385, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[228746, 5549, 95, 1, 44, "Subsection"],
Cell[228844, 5552, 219, 3, 36, "Text"],
Cell[229066, 5557, 19931, 504, 2674, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[249034, 6066, 99, 1, 44, "Subsection"],
Cell[249136, 6069, 122, 1, 168, "Text"],
Cell[249261, 6072, 1845, 52, 891, "Input",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[251155, 6130, 116, 1, 53, "Section"],
Cell[CellGroupData[{
Cell[251296, 6135, 251, 3, 647, "Subsection"],
Cell[251550, 6140, 7983, 180, 162696, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[259570, 6325, 154, 2, 478, "Subsection"],
Cell[259727, 6329, 4949, 121, 20218, "Input",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[264725, 6456, 65, 1, 53, "Section"],
Cell[264793, 6459, 1118, 27, 457, "Input",
 InitializationCell->True]
}, Closed]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
