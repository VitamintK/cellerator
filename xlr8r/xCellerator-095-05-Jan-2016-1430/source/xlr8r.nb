(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    863683,      22244]
NotebookOptionsPosition[    835556,      21357]
NotebookOutlinePosition[    836120,      21377]
CellTagsIndexPosition[    836077,      21374]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[" xlr8r.nb", "Title",
 CellChangeTimes->{{3.401656087076253*^9, 3.40165608743357*^9}, {
  3.5513175349340973`*^9, 3.551317539965324*^9}}],

Cell[TextData[{
 "\n",
 StyleBox["xCellerator",
  FontColor->RGBColor[0, 0, 1]],
 " is a system of ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " packages designed to aide biological modeling  via the automated \
conversion of chemical reactions into ODEs. xCellerator is backwards \
compatible with the reaction syntax defined in ",
 StyleBox["Cellerator.",
  FontColor->RGBColor[0, 0, 1]],
 "\n\nThe packages in the xCellerator System include:\n\n\tThe minimal \
required packages:\n\t\n\t\txlr8r - this package, see http://xlr8r.info \n\t\t\
mathsbml - see ",
 ButtonBox["http://mathsbml.com/mathsbml",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://sbml.org/software/mathsbml/"], None}],
 "\n\t\n\tOptional plugins:\n\t\t\n\t\tSSA - Gillespie style stochastic \
simulator (at ",
 ButtonBox["http://xlr8r.info",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://xlr8r.info"], None}],
 ")\n\t\tkmech - Enzyme mechanism language (at ",
 ButtonBox["http://www.igb.uci.edu/servers/coli/kmech.html",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://www.igb.uci.edu/servers/coli/kmech.html"], None}],
 " )\n\t\tmPower.m - Voronoi, Delaunay, power diagram interface (at ",
 ButtonBox["http://xlr8r.info",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://xlr8r.info"], None}],
 ")\n\t\tSBML2xlr8r/xlr8r2SBML - model format conversion  (from ",
 ButtonBox["http://sf.net/projects/xlr8r/",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://sf.net/projects/xlr8r/"], None}],
 " )\n\t\tcellzilla/cellzilla2D - multicellular modeling interface (from ",
 ButtonBox["http://sf.net/projects/xlr8r/",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://sf.net/projects/xlr8r/"], None}],
 " )\n\t\tmathmsbml plugins - included in the mathsbml full download (from ",
 ButtonBox["http://sf.net/projects/xlr8r/",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://sf.net/projects/xlr8r/"], None}],
 " )\n\t\t\n\tThere may be additional plugins available from the various \
download sites\n\t\nA collection of clickable palettes for xCellerator \
reactions should have been included in the distribution that came with this \
file. \n\nxCellerator software may be downloaded from the Sourceforge site  \
",
 ButtonBox["http://sf.net/projects/xlr8r/",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://sf.net/projects/xlr8r/"], None}],
 " \n\nInstallation instructions are given at ",
 ButtonBox["http://xlr8r.info/usersguide/install.html",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://xlr8r.info/usersguide/install.html"], None}],
 "\n\nFor additional information see ",
 ButtonBox["http://xlr8r.info",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://xlr8r.info"], None}]
}], "Text",
 CellChangeTimes->{{3.401655996388671*^9, 3.401656038331726*^9}, {
   3.4016561084608994`*^9, 3.401656409498229*^9}, {3.401656445911436*^9, 
   3.401656450020359*^9}, {3.401656492408359*^9, 3.401656914936244*^9}, 
   3.423323413345724*^9, 3.425410021337989*^9, 3.494007460381061*^9, {
   3.494007564411415*^9, 3.4940075655231857`*^9}, {3.5075753718562717`*^9, 
   3.5075753822629223`*^9}, {3.537291270442329*^9, 3.537291337467023*^9}}],

Cell[CellGroupData[{

Cell["GPL License", "Section",
 CellChangeTimes->{3.551317552453266*^9}],

Cell["\<\
\[Copyright]2012 Bruce E Shapiro, California State University Northridge

   This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see <http://www.gnu.org/licenses/>.
\
\>", "Text",
 CellChangeTimes->{{3.537291055754575*^9, 3.537291074060676*^9}, {
  3.537291111827317*^9, 3.537291129047864*^9}, {3.551317600399375*^9, 
  3.551317660013895*^9}},
 FontSize->16]
}, Closed]],

Cell[CellGroupData[{

Cell["Begin Package, Needs, Version", "Section",
 CellChangeTimes->{{3.401035158751175*^9, 3.401035162033031*^9}, {
  3.425406136329562*^9, 3.425406137835948*^9}, {3.427488460656315*^9, 
  3.427488461448149*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"BeginPackage", "[", "\"\<xlr8r`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 Background->RGBColor[0.840558, 0.58323, 0.941176]],

Cell["", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"Names", "[", "\"\<FLAGS`ECHOLOAD\>\"", "]"}], "]"}], ">", 
     "0"}], ",", "\[IndentingNewLine]", 
    RowBox[{"xlr8r`Private`msgflag", "=", 
     RowBox[{"ToExpression", "[", "\"\<FLAGS`ECHOLOAD\>\"", "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"xlr8r`Private`msgflag", "=", "True"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FLAGS`ECHOLOAD", "=", "False"}], ";"}], " ", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Needs", "[", "\"\<MathSBML`\>\"", "]"}], ";"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Needs", "[", "\"\<XML`\>\"", "]"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FLAGS`ECHOLOAD", "=", "xlr8r`Private`msgflag"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"$VersionNumber", "<", "6"}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Needs", "[", "\"\<Utilities`FilterOptions`\>\"", "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "Needs", "[", 
    "\"\<DifferentialEquations`InterpolatingFunctionAnatomy`\>\"", "]"}], 
   ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Quiet", "[", 
     RowBox[{
      RowBox[{"Needs", "[", "\"\<PlotLegends`\>\"", "]"}], ";"}], " ", "]"}], 
    ";"}], " ", "*)"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.40103405695366*^9, 3.401034079368375*^9}, {
  3.424643904411904*^9, 3.424643909822953*^9}, {3.424645735863965*^9, 
  3.424645785226579*^9}, {3.425406015102043*^9, 3.4254060455325537`*^9}, {
  3.425407811505252*^9, 3.425407821969384*^9}, {3.425409963055305*^9, 
  3.425409967214657*^9}, {3.425411346899872*^9, 3.425411363629347*^9}, {
  3.425411548817882*^9, 3.425411575805541*^9}, {3.425427376760929*^9, 
  3.425427377751502*^9}, {3.434463649885296*^9, 3.434463655965191*^9}, {
  3.587725020699853*^9, 3.587725024289959*^9}, {3.5883488026282053`*^9, 
  3.58834883381949*^9}, {3.588348885387599*^9, 3.588348892786337*^9}, {
  3.5887206217890663`*^9, 3.5887206282093563`*^9}, {3.5887208814267187`*^9, 
  3.58872088609934*^9}, {3.5887217974907627`*^9, 3.588721801231949*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$xlr8r$Version", " ", "=", " ", "\"\<0.95\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$xverdate$", " ", "=", " ", "\"\<28-Feb-2014\>\""}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.401033600964053*^9, 3.401033618852119*^9}, 
   3.401035309725204*^9, {3.40146807047388*^9, 3.401468070628552*^9}, {
   3.401651406554747*^9, 3.401651414698489*^9}, {3.401651452328505*^9, 
   3.401651453315857*^9}, {3.4016559032850122`*^9, 3.40165590354986*^9}, {
   3.405095720941028*^9, 3.4050957276545067`*^9}, {3.411730441368025*^9, 
   3.411730460255584*^9}, {3.416435086297676*^9, 3.416435092449101*^9}, {
   3.423318737309147*^9, 3.423318744605812*^9}, {3.42461475874982*^9, 
   3.424614774424434*^9}, {3.4254002339635153`*^9, 3.425400238615974*^9}, {
   3.426881281648463*^9, 3.426881284375103*^9}, {3.426985397673547*^9, 
   3.426985399394043*^9}, {3.427488465447735*^9, 3.427488469708447*^9}, {
   3.434463182675654*^9, 3.434463191593213*^9}, {3.442611649877479*^9, 
   3.442611655553955*^9}, {3.449244395545023*^9, 3.449244403179044*^9}, {
   3.450712781792179*^9, 3.450712788438037*^9}, {3.451249941680657*^9, 
   3.451249944541741*^9}, {3.466260946020146*^9, 3.466260951839179*^9}, {
   3.4669812849918823`*^9, 3.466981287057962*^9}, {3.472353226791088*^9, 
   3.4723532562538*^9}, {3.4940068998898697`*^9, 3.4940069060470753`*^9}, {
   3.5073946204653893`*^9, 3.507394627528709*^9}, {3.511650605999132*^9, 
   3.5116506142621202`*^9}, {3.511802902133505*^9, 3.511802904842917*^9}, {
   3.5236310488185472`*^9, 3.52363105999262*^9}, {3.5372911782408867`*^9, 
   3.537291195232211*^9}, {3.542294101031198*^9, 3.542294102686534*^9}, {
   3.546040306706101*^9, 3.546040316713421*^9}, {3.547936954479062*^9, 
   3.547936971650674*^9}, {3.551308672031967*^9, 3.551308678542266*^9}, {
   3.551627453395686*^9, 3.551627465670055*^9}, {3.551913655155651*^9, 
   3.5519136553688803`*^9}, {3.555497635919983*^9, 3.555497643233778*^9}, {
   3.560287503033265*^9, 3.560287512094005*^9}, {3.560879993211779*^9, 
   3.560879995163795*^9}, {3.5608821637394047`*^9, 3.5608821639069033`*^9}, {
   3.561654177708664*^9, 3.561654177935811*^9}, {3.561662680836566*^9, 
   3.5616626811962233`*^9}, 3.5775720491348963`*^9, {3.577572105063177*^9, 
   3.577572109879404*^9}, {3.5875048393593683`*^9, 3.587504850951964*^9}, {
   3.587687489628784*^9, 3.587687513760805*^9}, {3.5887169185226927`*^9, 
   3.588716919465571*^9}, {3.590334025912972*^9, 3.590334026464284*^9}, {
   3.602622623750909*^9, 3.602622632243965*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Revision Log", "Section"],

Cell[TextData[{
 "0.95 Update TextArrow to allow for pyxlr8r-style indices in the exported \
python (i) instead of [i]\n0.94 Remove all references to MathSBML except for \
SBML (in process)\n0.93 TextArrow function (pyxlr8r Arrow conversion)\n0.92a \
write (possible) partial solution to $$$SOLUTION in the event of NDSolve \
crash\n0.92 add inhibitory rate as 6th paramter to hill function\n0.91 make \
consistent use of quoted parameters for \[OpenCurlyDoubleQuote]Frozen\
\[CloseCurlyDoubleQuote], \[OpenCurlyDoubleQuote]TimeSpan\
\[CloseCurlyDoubleQuote],\[CloseCurlyDoubleQuote]IC\[CloseCurlyDoubleQuote], \
\[OpenCurlyDoubleQuote]Parameters\[CloseCurlyDoubleQuote] in run, interpret \
and make some documenation fixes\n0.90 Fix gridPlot Options \
\[OpenCurlyDoubleQuote]styles\[CloseCurlyDoubleQuote];  new gridPlot Options: \
\[OpenCurlyDoubleQuote]Options\[CloseCurlyDoubleQuote], \
\[OpenCurlyDoubleQuote]Columns\[CloseCurlyDoubleQuote], \
\[OpenCurlyDoubleQuote]Aspect\[CloseCurlyDoubleQuote], \
\[OpenCurlyDoubleQuote]Width\[CloseCurlyDoubleQuote]; \n0.89 9/1/12 Allow ODE \
to locate reactions with non-atomic variables such as Bind[A,B]; fix some \
bugs in Cascade expansion\n0.88 June/July 2012 Flux Reactions, Stoichiometry \
Matrix, OptimizeFluxModel\nFix Error 3514765 (some GRN-like reactions do not \
return ODE for some variables for which X\[CloseCurlyQuote][t]=0 is \
expected).\nFix missing MM[k1,k2,k3] reactions\nChange LGPL to GPL\n0.87 New \
options for compatibiliy with Cellzilla\n12.5.86 5/14/12 New options \
\[OpenCurlyDoubleQuote]Equations\[CloseCurlyDoubleQuote] in run allows \
systems of algebraic equations as well as reactions.\n12.4.85 Allow \
\[EmptySet] to be Catalyst of Hill (this is treated as the number 1); Remove \
error message when loading MathSBML.\n12.2.84 reversioning; license update \
(LGPL 2.1->3.0); Palette rebuilding \n0.83 add rational arrow { {A1,A2,...}, \
{I1, I2,....} \[DoubleLongRightArrow] P, rational [ {a0, a1, a2, ...}, {i0, \
i1,...}, {n1, n2, ..}, {m1, m2, ...}] with rate law \n\n",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"P", "'"}], "=", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"a0", " ", "+", " ", 
          RowBox[{"a1", " ", 
           SuperscriptBox["A1", "n1"]}], " ", "+", " ", 
          RowBox[{"a2", " ", 
           SuperscriptBox["A2", "n2"]}], "+"}], " ", "..."}], 
        RowBox[{
         RowBox[{
          RowBox[{"i0", " ", "+", " ", 
           RowBox[{"i1", " ", 
            SuperscriptBox["I1", "m1"]}], "+", " ", 
           RowBox[{"i2", " ", 
            SuperscriptBox["I2", "m2"]}], " ", "+"}], " ", "..."}], " "}]], 
       " ", "=", " ", 
       FractionBox[
        RowBox[{
         SubscriptBox["a", "0"], "+", 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"i", "=", "1"}], "n"], 
          SuperscriptBox[
           RowBox[{
            SubscriptBox["a", "i"], "[", 
            SubscriptBox["A", "i"], "}"}], 
           SubscriptBox["n", "i"]]}]}], 
        RowBox[{
         SubscriptBox["i", "0"], "+", 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"k", "=", "1"}], "n"], 
          SuperscriptBox[
           RowBox[{
            SubscriptBox["d", "k"], "[", 
            SubscriptBox["I", "k"], "}"}], 
           SubscriptBox["m", "k"]]}]}]]}]}], ";"}], " "}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{"products", " ", "are", " ", "also", " ", "allowed"}], ",", " ", 
    RowBox[{"so", " ", "that", " "}]}], TraditionalForm]}]],
 " \n\t\t{{X, Y*Z}, {X, Y, Y*Z, X*Y*Z}}\[DoubleLongRightArrow]P, \
rational[{a0,   a1, a2}, {1, i0, i1, i2, i3}]\nproduces \n\t\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"\t", 
    RowBox[{
     RowBox[{
      RowBox[{"P", "'"}], "[", "t", "]"}], " ", "=", " ", 
     FractionBox[
      RowBox[{"a0", "+", 
       RowBox[{"a1", " ", 
        RowBox[{"X", "[", "t", "]"}]}], "+", 
       RowBox[{"a2", " ", 
        RowBox[{"Y", "[", "t", "]"}], " ", 
        RowBox[{"Z", "[", "t", "]"}]}]}], 
      RowBox[{"1", "+", 
       RowBox[{"i0", " ", 
        RowBox[{"X", "[", "t", "]"}]}], "+", 
       RowBox[{"i1", " ", 
        RowBox[{"Y", "[", "t", "]"}]}], "+", 
       RowBox[{"i2", " ", 
        RowBox[{"Y", "[", "t", "]"}], " ", 
        RowBox[{"Z", "[", "t", "]"}]}], "+", 
       RowBox[{"i3", " ", 
        RowBox[{"X", "[", "t", "]"}], 
        RowBox[{"Y", "[", "t", "]"}], 
        RowBox[{"Z", "[", "t", "]"}]}]}]]}]}], TraditionalForm]]],
 "\n\t\t\t\n\t\t\t\n\n0.82 fix consolidation of hill reactions to comply with \
fix 0.81 (4.14.11)\n0.81 fix inconsistencies in argument sequence for \
different hill functions reactions. Fix some errors in palettes. (4.12.11)\n\
0.80 Version 8 compatibility. Workaround for GraphicsArray error message. \
(replace GraphicsArray with MyGraphicsArray); Option \
\[OpenCurlyDoubleQuote]styles\[CloseCurlyDoubleQuote] for GridPlot allows \
adding a global style to all plots in a grid plot such as Thick or Dotted\n\
0.79 paletted update and installer \n0.78 (20 Sep 10) Add BifurcationPlot\n\
0.77 (12 Jan 10) Debug and Quite options for run\n0.76 (11 Nov 09) Fix bad \
build on versoin 0.75 (entry points section accidentally deleted)\n0.75 (3 \
Nov 09) Fix bug in which repeated identical mass-action reactions were \
dropped. interpret[{{A \[Rule] B, k}, {A \[Rule] B, k}}] should return \
{A'[t]==-2 k A[t], B'[t]==2 k A[t]},{A,B}\n0.74 (13 May 09) Fix bug in \
expandArrows ",
 Cell[BoxData[
  FormBox[
   UnderoverscriptBox[
    RowBox[{
    "a", "\[RightArrowLeftArrow]", "b", "\[RightArrowLeftArrow]", "c"}], "p", 
    "q"], TraditionalForm]]],
 " when p, q are indexed variables: p[1] was becoming 1, q[3] becoming 3, \
etc. \n0.73 (7 May 09) Fix bug in PredictTransferFunction - local variable r \
was not declard and was conflicting with another variable r in \
expandArrow[rule] which was added in version 0.69 and inadvertently left \
global. Both variables are now local only.\n0.72 (20 April 09) For cellerator \
backward compatibily, when the option-based version of hill, GMWC, NHCA, GRN \
are used, checks for valid  options and prints an error message if an \
incorrecttly spelled options is used.\n0.71(2 Feb 09) Fix plotting of \
variables like Diamond[A,B], i.e., A\[Diamond]B -- plot as \
(A\[Diamond]B)[t]=Diamond[A,B][t], and not as A\[Diamond]B[t]=Diamond[A,B[t]]\
\n0.70 (31 Oct 08) Make XML usage V7 compatible\n0.69 (11 August 2008) - \
allow A->B+C+... to be written as A->{B, C, ..} for cellerator backwards \
compatibility (allow for both \\[ShortRIghtArrow] and Rule arrow forms). \
Similar for {A, B, ..} - > {P, Q, ...} \n0.68 (5 August 2008) - new function \
PredictTransferFunction, PhasePlot (based on Cellerator version, but more \
efficiently coded)\n0.67 (18 July 2008) - improve stability of negative \
exponent hill functions. A hill function with ",
 Cell[BoxData[
  FormBox[
   FractionBox[
    SuperscriptBox["x", "n"], 
    RowBox[{"1", "+", 
     SuperscriptBox["X", "n"]}]], TraditionalForm]]],
 "becomes ",
 Cell[BoxData[
  FormBox[
   FractionBox["1", 
    RowBox[{
     SuperscriptBox["x", "m"], "(", 
     RowBox[{"1", "+", 
      SuperscriptBox["x", 
       RowBox[{"-", "m"}]]}], ")"}]], TraditionalForm]]],
 " when n=-m.  Since this form is unbounded near x \[Rule] 0, force the \
denominator to be multiplied out to ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["x", "m"], "+", "1", " "}], TraditionalForm]]],
 "which is perfectly fine.\nCorrect usage of msgflag & FLAGS`ECHOLOAD`. \n\
include xlr8rhelp to plug into mathsbml help[] function which looks for \
context`Private`contexthelp[]\n0.66 (9 July 2008) - Fix version 6.0.2/6.0.3 \
change in XML`MathML`ExpressionToSymbolicXML calling sequence\n0.65 (24 June \
2008) - \"BoundaryConditions\" in run allows for explict time-dependent \
stimulations\n0.64 (5 Apr 2008) - Fix GMWC to include odes for all variables, \
not just substrate/profit (in parseArrowForm for GMWC)\n0.63 (Feb 2008) - \
Make menus work in V6. Include install scripts for Linux & Mac OSX. \n0.62 \
(11/26/07) - force all frozen variables to be in system, even if they do not \
otherwise exist. Thus if a species is specified as a frozen variable, even if \
there is no reaction for it, it is added to the output of interpret as a \
species.\n0.61  (10/17/07) - Add message if wrong verison of MathSBML is \
loaded in Version M6\n0.60 (10/10/07) - Add Version 6 Compatibility \n(a) \
Move ShortRightArrow (\[ShortRightArrow]), RightArrowLeftArrow (\
\[RightArrowLeftArrow]), Equilibrium (\[Equilibrium]), DoubleLongRightArrow(\
\[DoubleLongRightArrow]), \
DoubleLongLeftRightArrow(\[DoubleLongLeftRightArrow]) from Global` to System`\
\n(b) Copy Version 6 Utilities from MathSBML\n(c) FilterOptions becomes \
MyFilterOptions\n(d) Date becomes MyDate\n\n0.28 (12/21) - \"simulate\" - \
alternate version of run that formulates an SBMLNDSolve model and returns and \
SBMLNDSolve-formatted output. Output is directly compatible with SBMLPlot. \n\
0.27 (10/1) - Bug fixes & bundling with palette fixes and additonal plugins\n\
0.26 (8/17) - fixed bug in runPlot that will not plot variables in a system \
that has them in a context, as in NT`x or foo`foobar`y.\n0.24 (7/06) - \
additional arrayGridPlot; fix bugd in indexed enyzmatic reactions & indexed \
enzymatic cascades\n0.22 (9/10/05) GMA - fix bug in SSystem (had Summations \
that should have been Products. Introduce Generalized Mass Action Reactions\n\
0.21 (8/11/05) GMWC\n0.20 (8/11/05) NHCA; include \"interpret\" in run if \
sent a list of reactions; allow {A\[RightTeeArrow]\[EmptySet], hill[]} to \
indicate degradation\n0.19 (8/8/05) User-defined stoichiometric reactions \
with \[Implies] arrow (escape - equal - gt - escape) `\[AliasDelimiter]\n0.18 \
(8/1/05) Allow \"Rule\" Arrow to be used in place of \"ShortRightArrow\" for  \
A\[Rule]B, A\[Rule]B\[Rule]\[CenterEllipsis],  ",
 Cell[BoxData[
  FormBox[
   OverscriptBox[
    RowBox[{"A", "\[Rule]", "B"}], "C"], TraditionalForm]]],
 ". Generalize gridPlot calls in the same way as runPlot. Add \
lowLevelReactions function.\n0.17 (07/29/05) restore MM accidently deleted in \
0.16; addSSystem; palette changes for SSystem, GRN; new user palette; add \
user button on xcellerator palette.\n0.16 (07/22/05) GRN, user_ defined \
functions\n0.15 sigmoid, grnsigmoid, sigma functions\n0.14 improve check for \
undefined variables in run to also included indexed variables\n0.13 run, \
runPlot, gridPlot; steadyState and jacobianMatrix to work correctly for \
corrected interpret format\n0.12 bug fixes from test suite: make output of \
interpret compatible with Cellerator interpret output (don't put t's after \
variable names).\n0.11 bug fixes from test suite: default rate constants for \
cascades of enzymatic reactions\n0.10 (6/21) Combine regulatory hill \
functions; Cellerator options for hill; Hill for hill\n0.9 (6/13) initial \
form for hill function; rateLaw; kineticLaw\n0.8 (6/8/05) expandArrows. \
Palette updates (not in this file). Add empty set processing to mass action & \
MM reactions.\n0.7 (5/7/05 on AA Flight 169 LAX \[ShortRightArrow]NRT) \
Cascades: A\[ShortRightArrow]B\[ShortRightArrow]C\[ShortRightArrow]..., A\
\[RightArrowLeftArrow]B\[RightArrowLeftArrow]C\[RightArrowLeftArrow]...,  ",
 Cell[BoxData[
  FormBox[
   OverscriptBox[
    RowBox[{
     RowBox[{
     "A", "\[ShortRightArrow]", "B", "\[ShortRightArrow]", "C", 
      "\[ShortRightArrow]"}], "..."}], "M"], TraditionalForm]]],
 ", ",
 Cell[BoxData[
  FormBox[
   OverscriptBox[
    RowBox[{
     RowBox[{
     "A", "\[RightArrowLeftArrow]", "B", "\[RightArrowLeftArrow]", "C", " ", 
      "\[RightArrowLeftArrow]"}], "..."}], "M"], TraditionalForm]]],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    UnderoverscriptBox[
     RowBox[{
     "A", "\[RightArrowLeftArrow]", "B", "\[RightArrowLeftArrow]", "C"}], 
     "ER", "EF"], "..."}], TraditionalForm]]],
 ", ",
 Cell[BoxData[
  FormBox[
   OverscriptBox[
    RowBox[{
     RowBox[{
     "A", "\[Equilibrium]", "B", "\[Equilibrium]", "C", "\[Equilibrium]"}], 
     "..."}], "M"], TraditionalForm]]]
}], "Text",
 CellChangeTimes->CompressedData["
1:eJwd0H1MzHEcB/Cch1o4wjoaqwyJRavYqS73UecpTYtOi6gk5hrh8pCS3OTO
RKTMmVRWjXmazgmFsPLQYp66Du1C6vclCenBFd/3/fHe65/3P++3e/zWiA0i
Ozu7QB647ntG+2+lQIvr9nTAbQ1zhndxxfeHOcOVcz/4wsK+s3NhWtMnAxwI
Ft2EE8Sq8U9WcTMbbXr0bs6bHCXQkfg9euhn310IH6hHFdnUK/IMawWKPTar
AEadMDuuUQmUHewqhpda2r2VaoEe/z3gB709hw5JzRSozvOqPfxyJ8urXyOQ
a5WTLzxd62jZclCgaQHqTpgW2XJiG9cyNCcPOnX8uLWDq6iNqoISxZtbaq1A
hovhd6Ep59HUJJ1AZ8TdXtDFoWBeRb5Az9799Ict2w09C0oFMgfkioK51maL
N7sukKaESaF50aQa4w2BemclPYGVz3Vf4U3Lkh8wJzQsusoo0IjI9wkwte/p
+bWvBLq2+FQ5jKl+3lH1mu8vG+iEEeVDnJY6MHL4ZbWplouc4a7cdAn8llIc
CbUyFyVMfJfQ/NKdUdIrTSs0rQihmZMZjQkdrICPx/f4//JktCnlsBz6jR3Y
GTiDUdvGur3wi6bS8YWcUcXGwc5QpJG5QKnk4zT4+VJDEAyar5BDbUV4CHTT
iSPgnTS9Evos1K+CuiY3FfxY32jTklmyFcqkBRmwP9q/1xTNyKCqt0L7tJbO
9QmMAvpjuuDysNl/tSpGNfUyK4zJT5+n475QNgVCbVF36ekURhOny65AbeWx
P9AcdNHm0gve0Q+5iVRs0yOvcbV0J6Nka30cvC/RP63kbqo+UAdDr5yMM+9l
JMkeFw/3RRZJc9P5j4bkQOjTLPc5xb0+SeoL1R3FBTeyGGUd9SqEPvE7Oo3c
RNd7f2BUsKnt7SFGr/tM7dAYavjXwB0d4zHIxPVvcygL1/GeqfoCbE1OX325
jNHulQtiYf7x8jXnbjOaYh8UC5dls/093HxjaxacIu4dmdLAqLqmdAz8DxE2
/aU=
  "]],

Cell[TextData[{
 "0.5:  (5/105) ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    OverscriptBox[
     RowBox[{"A", "\[Equilibrium]", "B"}], "C"], " "}], TraditionalForm]]],
 ", Michaelis-Menten Reactions interpret"
}], "Text"],

Cell[TextData[{
 "0.4: (4/28/05-4/30/05) ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    OverscriptBox[
     RowBox[{"A", "\[ShortRightArrow]", "B"}], "C"], ",", " ", 
    RowBox[{"A", "\[RightArrowLeftArrow]", "B"}]}], TraditionalForm]]],
 " , ",
 Cell[BoxData[
  FormBox[
   OverscriptBox[
    RowBox[{"A", "\[RightArrowLeftArrow]", "B"}], "C"], TraditionalForm]]],
 ",  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    UnderoverscriptBox[
     RowBox[{"A", "\[RightArrowLeftArrow]", "B"}], "R", "F"], "  "}], 
   TraditionalForm]]],
 "interpret"
}], "Text"],

Cell["0.3: (4/26/05) jacobian, findSteadyState", "Text"],

Cell["0.1: (4/22/05) A\[ShortRightArrow]B interpret", "Text"]
}, Closed]],

Cell[CellGroupData[{

Cell["Entry Points", "Section"],

Cell["\<\
This section only has the usage strings and Option lists that define the \
global entry points. The actual values of these functions is defined in a \
later part of the code\
\>", "Text"],

Cell[CellGroupData[{

Cell["TextArrow", "Subsubsection",
 CellChangeTimes->{{3.5875052224328136`*^9, 3.587505223769537*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TextArrow", "::", "usage"}], "=", 
  "\"\<TextArrow[reaction] returns a pyxlr8r compatible reaction.\>\""}]], \
"Input",
 InitializationCell->True,
 CellChangeTimes->{{3.587505235867687*^9, 3.587505304636057*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Flux usage", "Subsubsection",
 CellChangeTimes->{{3.551313156356428*^9, 3.5513131583800373`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Flux", "::", "usage"}], "=", 
   "\"\<Flux[lower-bound, fluxvar, upperbound, fluxval:0, objcoef:0]\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StoichiometryMatrix", "::", "usage"}], "=", 
   "\"\<StoichometryMatrix[Model] returns the Stoichiometry Matrix of a Flux \
Model. If any kinetic reactions are included an error is returned.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OptimizeFluxModel", "::", "usage"}], "=", 
   "\"\<OptimizeFluxModel[model] returns a list {maximum of objective \
function, {v1->val, v2->val, v3->val,...}} where val's give a maximum, found \
using a Nelder Mead Simplex Algorithm.  All of the reactions in the Flux \
Model must be Cellerator Flux reactions (not kinetic reactions).\>\""}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.55130969155828*^9, 3.551309699255609*^9}, {
  3.5513131626562643`*^9, 3.5513132113223753`*^9}, {3.551314664489246*^9, 
  3.551314689977564*^9}, {3.551317203489184*^9, 3.551317239138805*^9}, {
  3.551402284259637*^9, 3.551402306427671*^9}, {3.55140250957553*^9, 
  3.551402552002201*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["bind usage", "Subsubsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Bind", "::", "usage"}], "=", 
   "\"\<Bind is an uninstantiated function that is used to indicate \
intermediate complexes formed during a reaction, e.g., A+E\
\[RightArrowLeftArrow]Bind[A,E]\[RightArrowLeftArrow]B+E, for an enzymatic \
reaction. When Bind[A,B] is gnerated by interpret, the arguments will be \
alphabetized, i.e., Bind[B,A] will be converted to Bind[A,B]. If Bind[B,A] is \
sent to interpret, the order of the arguments will not be changed. The user \
should ensure that Bind[A,B] and Bind[B,A] are treated equivalently.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dbgArrows", "=", "False"}], ";"}]}], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["interpret usage, ODE", "Subsubsection",
 CellChangeTimes->{{3.55162718174857*^9, 3.551627182315866*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"interpret", "::", "usage"}], "=", 
   "\"\<interpret[] converts a list of reactions into differential equations \
of the form {{ode for variable 1, ode for variable 2, ...}, {variable 1, \
variable 2, ...}}.\\nThe variable Global`t is used for the time argument.\\nA \
reaction has the format {arrow-form, \
rateConstants}.\\n\\nOptions:\\n\\\"Frozen\\\"->List of variables whose \
values are to be held constant.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"debugflag", "::", "usage"}], "=", 
   "\"\<debug is a flag used for debugging\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"frozen", "::", "usage"}], "=", 
   "\"\<frozen is a deprecated option for interpret and run that gives a list \
of variables to hold constant, default is frozen->{}. The preferred option is \
\\\"Frozen\\\"\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"rates", "::", "usage"}], "=", 
    "\"\<rates is an option for interpret that gives a list of rate constant \
replacement rules. Default is rates-> {}\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "interpret", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"frozen", "\[Rule]", " ", 
      RowBox[{"{", "}"}]}], ",", " ", 
     RowBox[{"\"\<frozen\>\"", "\[Rule]", " ", 
      RowBox[{"{", "}"}]}], ",", "  ", 
     RowBox[{"rates", "\[Rule]", " ", 
      RowBox[{"{", "}"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ODE", "::", "usage"}], "=", 
    "\"\<ODE[reaction] returns the first ODE found by \
interpret\\nODE[{reactions}] returns the first ODE\\nODE[{reactions}, n] \
returns the nth ODE\\nODE[{reactions},X] returns the ODE for \
X\\nODE[{reactions},{X,Y,...}] returns the ODEs for X, Y, ...\>\""}], ";"}], 
  " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4010342144595833`*^9, 3.40103423794483*^9}, {
  3.551625614501336*^9, 3.551625619213229*^9}, {3.551627186650648*^9, 
  3.551627353012267*^9}, {3.560879471169463*^9, 3.560879475582646*^9}, {
  3.560879624204852*^9, 3.560879644954914*^9}, {3.5608796883789673`*^9, 
  3.560879720945795*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Comp usage", "Subsubsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Comp", "::", "usage"}], "=", 
   "\"\<Comp[] is an uninstantiated function to indicate the Complement of a \
variable with respect to 1, Comp[x][t]=1-x[t]\>\""}], ";"}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["lowLevelReactions", "Subsubsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"lowLevelReactions", "::", "usage"}], "=", 
   "\"\<lowLevelReactions[reactions, options] returns a list of basic \
reactions in a reaction list, by breaking down complex mass-action reations \
into their simplest forms.\\nThe format for reactions is the same as the \
input to interpret.\\n\\nOptions:\\nrates->False - If True, return rate \
constants.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "lowLevelReactions", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"rates", "\[Rule]", " ", "False"}], "}"}]}], ";"}]}], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["steadyState, jacobianMatrix usage", "Subsubsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"jacobianMatrix", "::", "usage"}], "=", 
   "\"\<jacobianMatrix will calculate the jacobian of either the input to or \
the output from interpret\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "jacobianMatrix", "]"}], "=", 
   RowBox[{"{", "}"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"steadyState", "::", "usage"}], "=", 
   "\"\<steadyState[r, t] returns a list of rule lists giving the steady \
state of the system, if possible.\\nr may be either a list of reactions, or \
have the same format as the output of interpret, {{eq1,eq2,...}, {var1, \
var2,...}}.Each eqi is an expression involving vari'[t]. \\nEach rule list \
returned represents a different steady \
state.\\nExample:\\nsteadyState[{{x'[t]\[Equal]x[t]^2-y[t], \
y'[t]\[Equal]y[t]+3x[t]}, {x[t],y[t]}},t]\\nreturns:\\n{{y[t]\[Rule]0,x[t]\
\[Rule]0},{y[t]\[Rule]9,x[t]\[Rule]-3}}\>\""}], ";"}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["hill usage", "Subsubsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"eq1", "=", "\"\<  \!\(\*SuperscriptBox[\"B\", \"\[Prime]\",
MultilineFunction->None]\)[t]\[Equal]\!\(\*FractionBox[\(v \((b + T\\\ \
\*SuperscriptBox[\(A[t]\), \(n\)]\\\ \[ScriptCapitalE][t])\)\), \
\(\*SuperscriptBox[\(K\), \(n\)] + \*SuperscriptBox[\(A[t]\), \
\(n\)]\)]\)==-A'[t]\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eq2", "=", "\"\< \!\(\*SuperscriptBox[\"B\", \"\[Prime]\",
MultilineFunction->None]\)[t]\[Equal]\!\(\*FractionBox[\(v \((b + T \
\*SuperscriptBox[\((\*UnderscriptBox[\(\[Sum]\), \(i\)]A[t])\), \(n\)]\\\ \
\[ScriptCapitalE][t])\)\), \(\*SuperscriptBox[\(K\), \(n\)] + \
\*SuperscriptBox[\((\*UnderscriptBox[\(\[Sum]\), \(i\)]A[t])\), \
\(n\)]\)]\)==-\!\(\*SubscriptBox[\(A\), \(i\)]\)'[t] \>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eq3", "=", "\"\<  \!\(\*SuperscriptBox[\"B\", \"\[Prime]\",
MultilineFunction->None]\)[t]\[Equal]\!\(\*FractionBox[\(v \((b + T \
\(\*UnderscriptBox[\(\[Product]\), \(i\)]\*SuperscriptBox[\(\(\*SubscriptBox[\
\(A\), \(i\)]\)[t]\), \(n\)]\\\ \[ScriptCapitalE][t]\))\)\), \
\(\*SuperscriptBox[\(K\), \(n\)] + \*UnderscriptBox[\(\[Product]\), \
\(i\)]\*SuperscriptBox[\(\(\*SubscriptBox[\(A\), \(i\)]\)[t]\), \
\(n\)]\)]\)==-\!\(\*SubscriptBox[\(A\), \(i\)]\)'[t]\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eq4", "=", "\"\< \!\(\*SuperscriptBox[\"X\", \"\[Prime]\",
MultilineFunction->None]\)[t]\[Equal]\!\(\*FractionBox[\(v \
\*SuperscriptBox[\((b + TA[t])\), \(n\)]\), \(\*SuperscriptBox[\(K\), \(n\)] \
+ \*SuperscriptBox[\((b + T\\\ A[t])\), \(n\)]\)]\)\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eq5", "=", "\"\< \!\(\*SuperscriptBox[\"X\", \"\[Prime]\",
MultilineFunction->None]\)[t]\[Equal]\!\(\*FractionBox[\(v \
\*SuperscriptBox[\((b + T1\\\ A[t] + T2\\\ B[t] + \[CenterEllipsis])\), \
\(n\)]\), \(\*SuperscriptBox[\(K\), \(n\)] + \*SuperscriptBox[\((b + T1\\\ \
A[t] + T2\\\ B[t] + \[CenterEllipsis])\), \(n\)]\)]\)\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hill", "::", "usage"}], "=", 
   RowBox[{
   "\"\<hill is an uninstantiated function used to indicate parameter values \
for a hill-function based reaction.\\n\\nThe typical format for a Catalytic \
Hill Function is:\>\"", "<>", 
    "\"\<\\n{\!\(\*OverscriptBox[\(A \[RightTeeArrow] B\), \
\(\[ScriptCapitalE]\)]\), hill[T,K,n,b,v]} gives\>\"", "<>", "eq1", "<>", 
    "\"\<\\n{\!\(\*OverscriptBox[\({\*SubscriptBox[\(A\), \(1\)], \
\*SubscriptBox[\(A\), \(2\)], \[Ellipsis]} \[RightTeeArrow] B\), \(\
\[ScriptCapitalE]\)]\), hill[\[Ellipsis]]} and \
{\!\(\*OverscriptBox[\(\*SubscriptBox[\(A\), \(1\)] + \*SubscriptBox[\(A\), \
\(2\)] + \[CenterEllipsis] \[RightTeeArrow] B\), \(\[ScriptCapitalE]\)]\), \
hill[\[Ellipsis]]} give \>\"", "<>", "eq2", "<>", 
    "\"\<\\n{\!\(\*OverscriptBox[\({SubscriptBox[A, 1] SubscriptBox[A, 2] \
SubscriptBox[A, 3] \[CenterEllipsis]} \[RightTeeArrow] B\), \(\
\[ScriptCapitalE]\)]\), hill[\[Ellipsis]]} gives\>\"", "<>", "eq3", "<>", 
    "\"\<\\n\\nIn regulatory hill reactions, the concentrations of the \
reactants do not change. Typical Formats for Regulatory Hill Functions \
are:\\n\>\"", "<>", "\"\<\\n{A\[RightTeeArrow]X,hill[T,K,n,b,v]} gives \>\"", 
    "<>", "eq4", "<>", 
    "\"\<\\n{{A,B,\[Ellipsis]}\[RightTeeArrow]X,hill[{T1,T2}, K,n,b,v]} or {A\
\[RightTeeArrow]X,hill[T1,K,n,b,b]},{B\[RightTeeArrow]X,hill[T2,\[Ellipsis]]},\
\[Ellipsis]} give \>\"", "<>", "eq5", "<>", 
    "\"\<\\nNotes:\\nDefault values are T:1, K:1, n:1, b:0 (basal \
production), v:1 (rate)\\nIf multiple regulatory hill reactions have the same \
product, the values of K, n, b, and v are ignored after the first \
reaction.\\nDifferent types of regulatory reactions (e.g., hill, GRN, \
S-System,\[Ellipsis]) with the same product cannot not be combined.\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Hill", "::", "usage"}], "=", 
    "\"\<Hill[] is an alternative form for hill[].\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Remove", "[", 
   RowBox[{"eq1", ",", "eq2", ",", "eq3", ",", "eq4"}], "]"}], 
  ";"}]}], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 FormBox[
  RowBox[{"GRN", " ", "usage"}], TraditionalForm]], "Subsubsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "eq1", "=", 
   "\"\<\!\(\*FractionBox[\(1\), \(2\)]\) (1+\!\(\*FractionBox[\(x\), \
SqrtBox[\(1 + \*SuperscriptBox[\(x\), \(2\)]\)]]\))\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sigma", "::", "usage"}], "=", 
   RowBox[{"\"\<sigma[x] returns the value\>\"", "<>", "eq1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "eq2", "=", 
   "\"\<\!\(\*FractionBox[\(1\), \(1 + \*SuperscriptBox[\(\[ExponentialE]\), \
\(-x\)]\)]\)\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sigmoid", "::", "usage"}], "=", 
   RowBox[{"\"\<sigmoid [x] returns the value \>\"", "<>", "eq2"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "eq3", "=", 
   "\"\<\!\(\*FractionBox[\(r\), \(1 + \*SuperscriptBox[\(\[ExponentialE]\), \
\(\(-h\) - T\\\ \*SuperscriptBox[\(x\), \(n\)]\)]\)]\)\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"grnsigmoid", "::", "usage"}], "=", 
   RowBox[{
   "\"\<grnsigmoid[x, r:1, T:1, n:1, h:0] returns the value \>\"", "<>", 
    "eq3"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "eq4", "=", 
   "\"\<\!\(\*FractionBox[\(r\), \(1 + \*SuperscriptBox[\(\[ExponentialE]\), \
\(\(-h\) - T\\\ \*SuperscriptBox[\(A[t]\), \(n\)]\)]\)]\)\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "eq5", "=", 
   "\"\<\!\(\*FractionBox[\(r\), \(1 + \*SuperscriptBox[\(\[ExponentialE]\), \
\(\(-h\) - T1\\\ \*SuperscriptBox[\(A1[t]\), \(n1\)] - T2\\\ \
\*SuperscriptBox[\(A2[t]\), \(n2\)] - \[CenterEllipsis]\)]\)]\)\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GRN", "::", "usage"}], "=", 
   RowBox[{
   "\"\<GRN[r, T, n, h] is an uninstantiated function used to represent \
neural network based Genetic Regulatory Networks. The canonical forms \
are\\n\>\"", "<>", "\"\<{A\[RightTeeArrow]B, GRN[r, T, n, h]} \>\"", "<>", 
    "\"\< which means B'[t]==\>\"", "<>", "eq4", "<>", 
    "\"\<\\n{{A1,A2,...}\[RightTeeArrow]B, GRN[r, {T1,T2,...}, {n1,n2,...}, \
h]} which means B'[t]=\>\"", "<>", "eq5", "<>", 
    "\"\<= r * sigma[h*T.(x^n)], where T={T1,T2,...}, x={A1,A2,...}, \
n={n1,n2,...}\>\"", "<>", 
    "\"\<\\nGRN[r,T,n,h,f] is a user-defined GRN reaction, with \>\"", "<>", 
    "\"\<canonical form  {A\[RightTeeArrow]B, mygrn[r, T, n, h, f]}, where \
mygrn is any uninstantiated function that the user chooses, and f is any \
function of a single argument\>\"", "<>", 
    "\"\<\\nGRN[r,T,n,h], GRN[r,T,n,h,sigma], and mygrn[r,T,n,h,sigma] will \
produce the same results. However, GRN and mygrn reactions can not be \
combined with the same product, even if the same function is used.\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Remove", "[", 
   RowBox[{"eq1", ",", "eq2", ",", "eq3", ",", "eq4", ",", "eq5"}], "]"}], 
  ";"}]}], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["rational", "Subsubsection",
 CellChangeTimes->{{3.523632112327499*^9, 3.523632112878063*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rational", "::", "usage"}], "=", "\"\<\>\""}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.52363212372856*^9, 3.52363212749653*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["MM", "Subsubsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"eq1", "=", "\"\<\!\(\*SuperscriptBox[\"B\", \"\[Prime]\",
MultilineFunction->None]\)[t]\[Equal]\!\(\*FractionBox[\(v\\\ A[t]\), \(A[t] \
+ \*SubscriptBox[\(K\), \(M\)]\)]\)==-\!\(\*SuperscriptBox[\"A\", \"\[Prime]\",
MultilineFunction->None]\)[t]\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eq2", "=", "\"\<\!\(\*SuperscriptBox[\"B\", \"\[Prime]\",
MultilineFunction->None]\)[t]\[Equal]\!\(\*FractionBox[\(A[t]\\\ \
\*SubscriptBox[\(v\), \(1\)]\), \(A[t] + \*SubscriptBox[\(K\), \(M, \
1\)]\)]\)-\!\(\*FractionBox[\(B[t]\\\ \*SubscriptBox[\(v\), \(2\)]\), \(B[t] \
+ \*SubscriptBox[\(K\), \(M, 2\)]\)]\)==-\!\(\*SuperscriptBox[\"A\", \"\
\[Prime]\",
MultilineFunction->None]\)[t]\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eq3", "=", "\"\<\!\(\*SuperscriptBox[\"B\", \"\[Prime]\",
MultilineFunction->None]\)[t]\[Equal]\!\(\*FractionBox[\(v\\\ A[t]\\\ \
En[t]\), \(A[t] + \*SubscriptBox[\(K\), \
\(M\)]\)]\)==-\!\(\*SuperscriptBox[\"A\", \"\[Prime]\",
MultilineFunction->None]\)[t]\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eq4", "=", "\"\<\!\(\*SuperscriptBox[\"B\", \"\[Prime]\",
MultilineFunction->None]\)[t]\[Equal]\!\(\*FractionBox[\(A[t]\\\ En[t]\\\ \
\*SubscriptBox[\(k\), \(3\)]\), \(A[t] + \
\*FractionBox[\(\*SubscriptBox[\(k\), \(2\)] + \*SubscriptBox[\(k\), \
\(3\)]\), SubscriptBox[\(k\), \(1\)]]\)]\)==-\!\(\*SuperscriptBox[\"A\", \"\
\[Prime]\",
MultilineFunction->None]\)[t]\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eq5", "=", "\"\<\!\(\*SuperscriptBox[\"B\", \"\[Prime]\",
MultilineFunction->None]\)[t]\[Equal]\!\(\*FractionBox[\(A[t]\\\ EF[t]\\\ \
\*SubscriptBox[\(v\), \(F\)]\), \(A[t] + \*SubscriptBox[\(K\), \(D, \
F\)]\)]\)-\!\(\*FractionBox[\(B[t]\\\ ER[t]\\\ \*SubscriptBox[\(v\), \
\(R\)]\), \(B[t] + \*SubscriptBox[\(K\), \(D, R\)]\)]\)==-A'[t]\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eq6", "=", "\"\<\!\(\*SuperscriptBox[\"B\", \"\[Prime]\",
MultilineFunction->None]\)[t]\[Equal]\!\(\*FractionBox[\(A[t]\\\ EF[t]\\\ \
\*SubscriptBox[\(k\), \(3, f\)]\), \(A[t] + \
\*FractionBox[\(\*SubscriptBox[\(k\), \(2, f\)] + \*SubscriptBox[\(k\), \(3, \
f\)]\), SubscriptBox[\(k\), \(1, f\)]]\)]\)-\!\(\*FractionBox[\(B[t]\\\ ER[t]\
\\\ \*SubscriptBox[\(k\), \(6, f\)]\), \(B[t] + \
\*FractionBox[\(\*SubscriptBox[\(k\), \(5, f\)] + \*SubscriptBox[\(k\), \(6, \
f\)]\), SubscriptBox[\(k\), \(4, 5\)]]\)]\)==-A'[t]\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MM", "::", "usage"}], "=", 
   RowBox[{
   "\"\<MM is an uninstantiated function used to define parameters for a \
Michaelis-Menten type of reaction.\>\"", "<>", 
    "\"\<\\n{A\[DoubleLongRightArrow]B,MM[\!\(\*SubscriptBox[\(K\), \
\(M\)]\),v]} means\>\"", " ", "<>", "eq1", "<>", 
    "\"\<\\n{A\[DoubleLongLeftRightArrow]B,MM[\!\(\*SubscriptBox[\(K\), \(M, \
1\)]\),\!\(\*SubscriptBox[\(v\), \(1\)]\), \!\(\*SubscriptBox[\(K\), \(M, \
2\)]\),\!\(\*SubscriptBox[\(v\), \(2\)]\)]} means \>\"", "<>", "eq2", "<>", 
    "\"\<\\n{\!\(\*OverscriptBox[\(A\[DoubleLongRightArrow]B\), \(En\)]\),MM[\
\!\(\*SubscriptBox[\(K\), \(M\)]\),v]} means \>\"", "<>", "eq3", "<>", 
    "\"\<\\n{\!\(\*OverscriptBox[\(A\[DoubleLongRightArrow]B\), \(En\)]\),MM[\
\!\(\*SubscriptBox[\(k\), \(1\)]\),\!\(\*SubscriptBox[\(k\), \
\(2\)]\),\!\(\*SubscriptBox[\(k\), \(3\)]\)]} means \>\"", "<>", "eq4", "<>", 
    "\"\<\\n{\!\(\*UnderoverscriptBox[\(A\[DoubleLongLeftRightArrow]B\), \(ER\
\), \(EF\)]\),MM[\!\(\*SubscriptBox[\(K\), \(D, F\)]\),\!\(\*SubscriptBox[\(v\
\), \(F\)]\),\!\(\*SubscriptBox[\(K\), \(D, R\)]\),\!\(\*SubscriptBox[\(v\), \
\(R\)]\)]} means \>\"", "<>", "eq5", "<>", 
    "\"\<\\n{\!\(\*UnderoverscriptBox[\(A\[DoubleLongLeftRightArrow]B\), \(ER\
\), \(EF\)]\),MM[\!\(\*SubscriptBox[\(k\), \(1, f\)]\),\!\(\*SubscriptBox[\(k\
\), \(2, f\)]\),\!\(\*SubscriptBox[\(k\), \(3, \
f\)]\),\!\(\*SubscriptBox[\(k\), \(4, 5\)]\),\!\(\*SubscriptBox[\(k\), \(5, f\
\)]\),\!\(\*SubscriptBox[\(k\), \(6, f\)]\)]} means \>\"", "<>", "eq6"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Remove", "[", 
   RowBox[{"eq1", ",", " ", "eq2", ",", "eq3", ",", "eq4", ",", "eq5"}], 
   "]"}], ";"}]}], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 FormBox["SSystem", TraditionalForm]], "Subsubsection"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
    "eq1", "=", 
     "\"\<\[Tau]B'[t]=\!\(\*SuperscriptBox[\(k\), \
\(+\)]\)A[t\!\(\*SuperscriptBox[\(]\), SuperscriptBox[\(c\), \
\(+\)]]\)-\!\(\*SuperscriptBox[\(k\), \(-\)]\)A[t\!\(\*SuperscriptBox[\(]\), \
SuperscriptBox[\(c\), \(-\)]]\)\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "eq2", "=", 
     "\"\<\[Tau]B'[t]=\[Tau]B'[t]=\!\(\*SuperscriptBox[\(k\), \
\(+\)]\)\!\(\*UnderscriptBox[\(\[Product]\), \
\(i\)]\)\!\(\*SubscriptBox[\(A\), \(i\)]\)[t\!\(\*SuperscriptBox[\(]\), \
SuperscriptBox[SubscriptBox[\(c\), \(i\)], \(+\)]]\)-\!\(\*SuperscriptBox[\(k\
\), \(-\)]\)\!\(\*UnderscriptBox[\(\[Product]\), \
\(i\)]\)\!\(\*SubscriptBox[\(A\), \(i\)]\)[t\!\(\*SuperscriptBox[\(]\), \
SuperscriptBox[SubscriptBox[\(c\), \(i\)], \(-\)]]\)\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "eq3", "=", 
     "\"\<\\n{{A1,A2,\[Ellipsis]}\[RightTeeArrow]B,SSystem[\[Tau],\!\(\*\
SuperscriptBox[\(k\), \(+\)]\), \!\(\*SuperscriptBox[\(k\), \
\(-\)]\),{\!\(\*SuperscriptBox[\(c\), \
\(+\)]\),\[Ellipsis]},{\!\(\*SuperscriptBox[\(c\), \
\(-\)]\),\[Ellipsis]}]}\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "eq4", "=", 
     "\"\<SSystem[\[Tau], \!\(\*SuperscriptBox[\(k\), \(+\)]\), \
\!\(\*SuperscriptBox[\(k\), \(-\)]\), \!\(\*SuperscriptBox[\(c\), \(+\)]\),\!\
\(\*SuperscriptBox[\(c\), \(-\)]\)]\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SSystem", "::", "usage"}], "=", 
     RowBox[{
     "eq4", "<>", 
      "\"\< is an uninstantiated function used to specify parameters for \
Synergestic System (S-System) interactions. The canonical form is\>\"", "<>", 
      "\"\<\\n{A\[RightTeeArrow]B, SSystem[\[Tau], \
\!\(\*SuperscriptBox[\(k\), \(+\)]\), \!\(\*SuperscriptBox[\(k\), \(-\)]\), \
\!\(\*SuperscriptBox[\(c\), \(+\)]\),\!\(\*SuperscriptBox[\(c\), \(-\)]\)]}\>\
\"", "<>", "\[IndentingNewLine]", "\"\<\\n which means \>\"", "<>", "eq1", "<>",
       "eq3", "<>", "\[IndentingNewLine]", "\"\<\\n which means\>\"", "<>", 
      "eq2", "<>", 
      "\"\<\\n{A1,A2,\[Ellipsis]}\[RightTeeArrow]B is the same as A1+A2+\
\[Ellipsis]\[RightTeeArrow]B. S-Systems are a special case of Generalized \
Mass Action interactions.\>\""}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Remove", "[", 
    RowBox[{"eq1", ",", "eq2", ",", " ", "eq3", ",", " ", "eq4"}], 
    "]"}]}]}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 FormBox["GMA", TraditionalForm]], "Subsubsection"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
    "eq1", "=", 
     "\"\<\[Tau]B'[t]=\!\(\*SuperscriptBox[\(k\), \
\(+\)]\)A[t\!\(\*SuperscriptBox[\(]\), SuperscriptBox[\(c\), \
\(+\)]]\)-\!\(\*SuperscriptBox[\(k\), \(-\)]\)A[t\!\(\*SuperscriptBox[\(]\), \
SuperscriptBox[\(c\), \(-\)]]\)\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "eq2", "=", 
     "\"\<\[Tau]B'[t]=\!\(\*UnderscriptBox[\(\[Sum]\), \
\(j\)]\)\!\(\*SubsuperscriptBox[\(k\), \(j\), \(+\)]\)\!\(\*UnderscriptBox[\(\
\[Product]\), \(i\)]\)\!\(\*SubscriptBox[\(A\), \
\(i\)]\)[t\!\(\*SuperscriptBox[\(]\), SuperscriptBox[SubscriptBox[\(c\), \(ij\
\)], \(+\)]]\)-\!\(\*UnderscriptBox[\(\[Sum]\), \(j\)]\)\!\(\*SuperscriptBox[\
\(k\), \(-\)]\)\!\(\*UnderscriptBox[\(\[Product]\), \
\(i\)]\)\!\(\*SubscriptBox[\(A\), \(i\)]\)[t\!\(\*SuperscriptBox[\(]\), \
SuperscriptBox[SubscriptBox[\(c\), \(ij\)], \(-\)]]\)\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "eq3", "=", 
     "\"\<\\n{{A1,A2,\[Ellipsis]}\[RightTeeArrow]B,GMA[\[Tau],(\!\(\*\
SuperscriptBox[\(k\), \(+\)]\),\[Ellipsis]}, {\!\(\*SuperscriptBox[\(k\), \(-\
\)]\),\[Ellipsis]},{\!\(\*SuperscriptBox[\(c\), \
\(+\)]\),\[Ellipsis]},{\!\(\*SuperscriptBox[\(c\), \
\(-\)]\),\[Ellipsis]}]}\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "eq4", "=", 
     "\"\<GMA[\[Tau], \!\(\*SuperscriptBox[\(k\), \(+\)]\), \
\!\(\*SuperscriptBox[\(k\), \(-\)]\), \!\(\*SuperscriptBox[\(c\), \(+\)]\),\!\
\(\*SuperscriptBox[\(c\), \(-\)]\)]\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"GMA", "::", "usage"}], "=", 
     RowBox[{
     "eq4", "<>", 
      "\"\< is an uninstantiated function used to specify parameters for \
Generalized Mass Action (GMA) interactions. The canonical form is\>\"", "<>", 
      "\"\<\\n{A\[RightTeeArrow]B, GMA[\[Tau], \!\(\*SuperscriptBox[\(k\), \
\(+\)]\), \!\(\*SuperscriptBox[\(k\), \(-\)]\), \!\(\*SuperscriptBox[\(c\), \
\(+\)]\),\!\(\*SuperscriptBox[\(c\), \(-\)]\)]}\>\"", "<>", 
      "\[IndentingNewLine]", "\"\<\\n which means \>\"", "<>", "eq1", "<>", 
      "eq3", "<>", "\[IndentingNewLine]", "\"\<\\n which means\>\"", "<>", 
      "eq2", "<>", 
      "\"\<\\n{A1,A2,\[Ellipsis]}\[RightTeeArrow]B is the same as A1+A2+\
\[Ellipsis]\[RightTeeArrow]B. When the k's are scalars then GMA interactions \
reduce to Synergistic System (S-System) interactions.\>\""}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Remove", "[", 
    RowBox[{"eq1", ",", "eq2", ",", " ", "eq3", ",", " ", "eq4"}], 
    "]"}]}]}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 FormBox["GMWC", TraditionalForm]], "Subsubsection"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"GMWC", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MWC", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 FormBox["NHCA", TraditionalForm]], "Subsubsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"eq1", "=", "\"\<\!\(\*SuperscriptBox[\"B\", \"\[Prime]\",
MultilineFunction->None]\)[t]\[Equal]\!\(\*FractionBox[\(v\\\ \
\*SuperscriptBox[\((1 + T\\\ \*SuperscriptBox[\(A[t]\), \(n\)]\\\ \
\[CapitalTheta][T])\), \(m\)]\), \(k\\\ \*SuperscriptBox[\((1 + T\\\ \
\*SuperscriptBox[\(A[t]\), \(n\)]\\\ \[CapitalTheta][\(-T\)])\), \(m\)] + \
\*SuperscriptBox[\((1 + T\\\ \*SuperscriptBox[\(A[t]\), \(n\)]\\\ \
\[CapitalTheta][T])\), \(m\)]\)]\)\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eq2", "=", "\"\<\!\(\*SuperscriptBox[\"B\", \"\[Prime]\",
MultilineFunction->None]\)[t]\[Equal]\!\(\*FractionBox[\(v\\\ \
\*SuperscriptBox[\((1 + TP\\\ \*SuperscriptBox[\(A[t]\), \(n\)])\), \(m\)]\), \
\(k\\\ \*SuperscriptBox[\((1 + TM\\\ \*SuperscriptBox[\(A[t]\), \(n\)])\), \
\(m\)] + \*SuperscriptBox[\((1 + TP\\\ \*SuperscriptBox[\(A[t]\), \(n\)])\), \
\(m\)]\)]\)\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eq3", "=", "\"\<\!\(\*SuperscriptBox[\"B\", \"\[Prime]\",
MultilineFunction->None]\)[t]\[Equal]\!\(\*FractionBox[\(v \
\(\*UnderscriptBox[\(\[Product]\), \(i\)]\*SuperscriptBox[\((1 + \
SubscriptBox[TP, i] \*SuperscriptBox[\(\(\*SubscriptBox[\(A\), \(i\)]\)[t]\), \
SubscriptBox[\(n\), \(i\)]])\), \(m\)]\)\), \(k\\\ \(\*UnderscriptBox[\(\
\[Product]\), \(i\)]\*SuperscriptBox[\((1 + SubscriptBox[TM, i] \
\*SuperscriptBox[\(\(\*SubscriptBox[\(A\), \(i\)]\)[t]\), SubscriptBox[\(n\), \
\(i\)]])\), \(m\)]\) + \*UnderscriptBox[\(\[Product]\), \
\(i\)]\*SuperscriptBox[\((1 + SubscriptBox[TP, i] \
\*SuperscriptBox[\(\(\*SubscriptBox[\(A\), \(i\)]\)[t]\), SubscriptBox[\(n\), \
\(i\)]])\), \(m\)]\)]\)\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eq4", "=", "\"\<\!\(\*SuperscriptBox[\"B\", \"\[Prime]\",
MultilineFunction->None]\)[t]\[Equal]\!\(\((v \(\*UnderscriptBox[\(\[Product]\
\), \(i\)]\*SuperscriptBox[\((1 + SubscriptBox[T, i] \
\[CapitalTheta][\*SubscriptBox[\(T\), \(i\)]] \
\*SuperscriptBox[\(\(\*SubscriptBox[\(A\), \(i\)]\)[t]\), SubscriptBox[\(n\), \
\(i\)]])\), \(m\)]\))\)/\((k\\\ \(\*UnderscriptBox[\(\[Product]\), \
\(i\)]\*SuperscriptBox[\((1 + SubscriptBox[T, i] \
\[CapitalTheta][\(-\*SubscriptBox[\(T\), \(i\)]\)] \
\*SuperscriptBox[\(\(\*SubscriptBox[\(A\), \(i\)]\)[t]\), SubscriptBox[\(n\), \
\(i\)]])\), \(m\)]\) + \*UnderscriptBox[\(\[Product]\), \
\(i\)]\*SuperscriptBox[\((1 + SubscriptBox[T, i] \
\[CapitalTheta][\*SubscriptBox[\(T\), \(i\)]] \
\*SuperscriptBox[\(\(\*SubscriptBox[\(A\), \(i\)]\)[t]\), SubscriptBox[\(n\), \
\(i\)]])\), \(m\)])\)\)\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NHCA", "::", "usage"}], "=", 
   RowBox[{
   "\"\<NHCA is an uninstantiated function used to specify parameters for \
SSystem reactions. The canonical forms \
are\\n{A\[RightTeeArrow]B,NHCA[v,T,n,m,k] which means \>\"", "<>", "eq1", 
    "<>", "\"\< where \[CapitalTheta][u] is UnitStep[u]\>\"", "<>", 
    "\"\<\\n{A\[RightTeeArrow]B, NHCA[v,{TP,TM},n,m,k] which means \>\"", "<>",
     "eq2", "<>", 
    "\"\<\\nMultiple Reactions with the same product combine vectorally and \
are equivalent to \>\"", "<>", 
    "\"\<{A1,A2,\[Ellipsis]}\[RightTeeArrow]B and A1+A2+\[Ellipsis]\
\[RightTeeArrow]B, as \>\"", "<>", "eq3", "<>", "\"\< or \>\"", "<>", 
    "eq4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Remove", "[", 
   RowBox[{"eq1", ",", "eq2", ",", "eq3", ",", "eq4"}], "]"}], 
  ";"}], "\[IndentingNewLine]", "Null"}], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["run, runPlot, gridPlot usage", "Subsubsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"run", "::", "usage"}], "=", 
    RowBox[{
    "\"\<run[sys, {t, tstart, tend}, options]\>\"", "<>", 
     "\"\<\\nrun[sys, {tstart, tend}, options]: gets t from timeVariable\>\"",
      "<>", "\"\<\\nrun[sys,options]: gest times from timeSpan\>\"", "<>", 
     "\"\<\\n\\nOptions:\n\\\"IC\\\"->{}, initial conditions, Missing initial \
conditions are set to zero. \ninitialConditions->{}.  (deprecated version of \
\\\"IC\\\")\n\\\"plot\\\"->False -   To plot (gridplot) automatically, the \
option \\\"plot\\\"->True is required, and either  \\\"plotVariables\\\" or \
\\\"gridPlotVariables\\\" must be set to a list of variables (or All). More \
precise control of the format of the plots is available by using runPlot or \
gridPlot as a separate step.\n\\\"gridPlotVariables\\\"-> {}\n\
\\\"plotVariables\\\"->{}\n\\\"Parameters\\\"->{}, values of all constants in \
model as a rule list. Unassigned rate constants are set to 1. \nrates-> {} \
(deprecated version of \\\"Parameters\\\")\n\\\"Frozen\\\"->{}, list of \
variables whose values are held fixed\n\\\"TimeSpan\\\"->100 (run \
duration)\\ntimeVariable->Global`t\\n\\\"BoundaryConditions\\\"\[Rule]{\!\(\*\
SubscriptBox[\(X\), \(1\)]\)[t]\[Rule]\!\(\*SubscriptBox[\(f\), \
\(1\)]\)[t],\!\(\*SubscriptBox[\(X\), \
\(2\)]\)[t]\[Rule]\!\(\*SubscriptBox[\(f\), \(2\)]\)[t], \[Ellipsis]}] - \
replace each of the variables \!\(\*SubscriptBox[\(X\), \(i\)]\) with the \
explicity function \!\(\*SubscriptBox[\(f\), \
\(i\)]\)\\n\\\"Quiet\\\"\[Rule]True\>\""}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"simulate", "::", "usage"}], "=", 
   "\"\<same as run but used SBMLNDSolve and returns result in SBMLNDSolve \
format.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rates", "::", "usage"}], "=", 
   RowBox[{
   "\"\<rates->{} is a deprecated option for run. A list of replacement \
rules, typically giving the values used for parameters such as rate \
constants. The prefered option is \\\"Parameters\\\"\\n\\n\>\"", "<>", 
    "\"\<rates->False is an option for lowLevelReactions. If True, the rates \
will also be returend.\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"initialConditions", "::", "usage"}], "=", 
   "\"\<initialConditions->{} is a deprecated option for run. It gives the \
initial conditions used in the integration. \\nFormat 1: {a[0]==a0, \
...}\\nFormat 2: {a->a0, ...}. The prefered option is \\\"IC\\\"\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plot", "::", "usage"}], "=", 
   "\"\<A deprecated option for run. The preferred option is \
\\\"plot\\\"->True or False.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plotVariables", "::", "usage"}], "=", 
   "\"\<A deprecated option for run. The preferred option is \
\\\"plotVariables\\\".\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"timeSpan", "::", "usage"}], "=", 
    RowBox[{
    "\"\<timeSpan->{0,100} is an option for run.\\nIt is ignored unless run \
is invoked by run[sys, options]. \\ntimeSpan->{} or not specified means \
{timeVariable, tstart, tend} = {Global`t, 0, 100}\\ntimeSpan->x or {x} means \
{timeVariable, tstart, tend}={Global`t, 0, x}\>\"", "<>", 
     "\"\<\\ntimeSpan->{x,y} means {timeVariable, tstart, tend}={Global`t, x, \
y}\>\"", "<>", 
     "\"\<\\ntimeSpan->{z, x, y} means {timeVariable, tstart, tend} = {z, x, \
y}\>\""}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"timeVariable", "::", "usage"}], "=", 
   "\"\<timeVariable->Global`t is an option for run. It is the name of the \
time variable in the equations solved by run. \>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gridPlotVariables", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "run", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"rates", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"\"\<Parameters\>\"", "\[Rule]", " ", 
       RowBox[{"{", "}"}]}], ",", "  ", "\[IndentingNewLine]", 
      RowBox[{"\"\<IC\>\"", "\[Rule]", " ", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"initialConditions", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{"plot", "\[Rule]", " ", "False"}], ",", " ", 
      RowBox[{"\"\<plot\>\"", "\[Rule]", " ", "False"}], ",", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"plotVariables", "\[Rule]", " ", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<plotVariables\>\"", "\[Rule]", " ", "False"}], ",", "  ", 
      "\[IndentingNewLine]", 
      RowBox[{"timeSpan", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "100"}], "}"}]}], ",", " ", 
      RowBox[{"timeVariable", "\[Rule]", " ", "Global`t"}], ",", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"gridPlotVariables", "\[Rule]", " ", "None"}], ",", " ", 
      RowBox[{"\"\<gridPlotVariables\>\"", "\[Rule]", " ", "None"}], ",", " ", 
      RowBox[{"\"\<Quiet\>\"", "\[Rule]", " ", "True"}], ",", " ", 
      RowBox[{"\"\<Debug\>\"", "\[Rule]", " ", "False"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"runPlot", "::", "usage"}], "=", 
   "\"\<runPlot[sys,options] plots all variables in sys (output of interpret) \
for the entire solution time span.\n\\nrunPlot[sys,{var1,var2,...},options] \
plots the requested variables for the entire solution time \
span\\nrunPlot[sys, {var1,var2,...}, {tstart, tend},options] plots the \
requested variables for the specified time span\\n\\nOptions:\\nAny option \
for Plot or Graphics may be used.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gridPlot", "::", "usage"}], "=", 
   "\"\<gridPlot[sys, vars,{tstart, tend}, options]\\nvars is either a list \
of variables or the symbol All.\\nsys is the output of \
run.\\n\\nOptions:\\n\\\"Columns\\\"->3\\n\\\"styles\\\"->{},list of styles \
to add to each plot (same style for each plot, such as Thick or \
Dotted)\\n\\\"Options\\\"->{PlotRange-> All}, applied to each \
plot\\n\\\"Width\\\"-> 300 (default plot width, \
pixels)\\n\\\"Aspect\\\"->1.0/GoldenRatio, default plot aspect ratio\\nAny \
additional Plot options will be passed to the overall grid. \>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plotColumns", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "gridPlot", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"plotColumns", "\[Rule]", " ", "3"}], ",", " ", 
      RowBox[{"\"\<styles\>\"", "\[Rule]", " ", 
       RowBox[{"{", "}"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"arrayGridPlot", "::", "usage"}], "=", 
    "\"\<arrayGridPlot[system,n, tmax, {\!\(\*SubscriptBox[\(var\), \(1\)]\),\
\!\(\*SubscriptBox[\(var\), \(2\)]\),...}, options]\\ngenerates a grid of \
plots of each array on a separate plot. Then \!\(\*SubscriptBox[\(var\), \
\(1\)]\)[1],...,\!\(\*SubscriptBox[\(var\), \(1\)]\)[n] are plotted on the \
first plot, \!\(\*SubscriptBox[\(var\), \
\(2\)]\)[1],..,\!\(\*SubscriptBox[\(var\), \(2\)]\)[n] are plotted on the \
second plot, and so forth. \\n\\nOptions:\\nplotColumns\[Rule]3.\>\""}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PhasePlot", "::", "usage"}], "=", 
    "\"\<PhasePlot[solution, {v1, v2}, {tbegin, tend}, options] is a wrapper \
for ParametricPlot. Here solution is the output of run.\>\""}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PredictTransferFunction", "::", "usage"}], "=", 
    "\"\<PredictTransferFunction[system, {time, tbegin, tend}, {input, min, \
max, delta}, output, options]\\nrepeatedly executes run, varying the value of \
input=min, min+delta, min+2delta, ..., max. \\nThe symbol input may refer to \
either a chemical species in a reaction or a rate constant. \\nThe symbol \
output is either the name of a single variable, or a list of variables. \
Returns a table in the form of a list of values of all the variables in \
output for each value of \
input.\\n\\nOptions:\\n\\\"Integrate\\\"\[Rule]False, if True, integrates the \
output variables from tbegin to tend; otherwise, just returns the value of \
the variable.\\n\\\"Function\\\"\[Rule]optional function to be applied to \
either the values of variable (if \\\"Integrate\\\"\[Rule]False) or the \
variable before integration (if \
\\\"Integrate\\\"\[Rule]True).\\n\\nPredictionTransferFunction[net, \
{t,0,100}, {A, 1,10, .5}, {P, Q, \
R}]\\nreturns\\n{{list-of-column-headers}\\n{1, P[100], Q[100], R[100]}, \
\\n{1.5, P[100], Q[100], R[100]},\\n ...\\n{10, P[100], Q[100], R[100]} \
\>\""}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ParametricVariation", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
  " ", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"snapshot", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "BifurcationPlot", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"PlotPoints", "\[Rule]", "2000"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Black", ",", 
        RowBox[{"PointSize", "[", "0.001", "]"}]}], "}"}]}]}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BifurcationPlot", "::", "usage"}], "=", 
    "\"\<BifurcationPlot[f, {r, rmin, rmax}, {x, x0}, {i, ishow}, options], \
where f[x,r] is a function of x that depends on a parameter r, which \
undergoes a period doubling bifurcation between rmin and rmax; i is the total \
number of iterations; ishow is the number to actually show. \>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InterpolationSet", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.401034273387456*^9, {3.42332295056095*^9, 3.423323044257742*^9}, {
   3.426973920908079*^9, 3.426973968982435*^9}, {3.426974570554311*^9, 
   3.42697458683055*^9}, {3.426974694897353*^9, 3.426974781835384*^9}, {
   3.426975580574716*^9, 3.426975583965287*^9}, {3.426980233775496*^9, 
   3.426980600264317*^9}, {3.426982636839408*^9, 3.426982815811791*^9}, {
   3.426984929790343*^9, 3.426985061055006*^9}, {3.47241527008328*^9, 
   3.472415405499241*^9}, {3.494007002462524*^9, 3.494007034607723*^9}, {
   3.4940070652809563`*^9, 3.4940071595427103`*^9}, {3.4940081025304127`*^9, 
   3.494008113544497*^9}, {3.507574870585659*^9, 3.507574931313435*^9}, {
   3.507575183827485*^9, 3.5075752002026577`*^9}, {3.5602902634805326`*^9, 
   3.560290389730796*^9}, {3.560872977109332*^9, 3.560873020030911*^9}, {
   3.560873179870179*^9, 3.5608733302503*^9}, {3.560873440464229*^9, 
   3.560873644815318*^9}, {3.560873746389984*^9, 3.560873794702758*^9}, {
   3.560873825359336*^9, 3.560873990352881*^9}, {3.560874030428772*^9, 
   3.560874033753047*^9}, {3.5608740903842487`*^9, 3.560874090810637*^9}, {
   3.560879757142696*^9, 3.5608797795551558`*^9}, {3.560879831515111*^9, 
   3.5608798491348667`*^9}, {3.588353362345006*^9, 3.5883533673261013`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["usage and Options for Cellerator Backwards Compatibility", \
"Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"vmax", "::", "usage"}], "=", 
   "\"\<vmax is a Cellerator option for hill[] or NHCA[]. Cellerator options \
may not be combined with positional parameters and are discouraged becuase \
they can significantly degrade performance.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nhill", "::", "usage"}], "=", 
   "\"\<nhill is a Cellerator option for hill[]. Cellerator options may not \
be combined with positional parameters and are discouraged becuase they can \
significantly degrade performance.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"khalf", "::", "usage"}], "=", 
   "\"\<khalf is a Cellerator option for hill[]. Cellerator options may not \
be combined with positional parameters and are discouraged becuase they can \
significantly degrade performance.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"basalRate", "::", "usage"}], "=", 
   "\"\<basalRate is a Cellerator option for hill[]. Cellerator options may \
not be combined with positional parameters and are discouraged becuase they \
can significantly degrade performance.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Thill", "::", "usage"}], "=", 
   "\"\<Thill is a Cellerator option for hill[].Cellerator options may not be \
combined with positional parameters and are discouraged becuase they can \
significantly degrade performance.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "hill", "]"}], "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vmax", "\[Rule]", " ", "1"}], ",", " ", 
     RowBox[{"nhill", "\[Rule]", " ", "1"}], ",", " ", 
     RowBox[{"khalf", "\[Rule]", " ", "1"}], ",", " ", 
     RowBox[{"basalRate", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{"Thill", "\[Rule]", " ", "1"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RGRN", "::", "usage"}], "=", 
   "\"\<RGRN is a Cellerator option for GRN[]. It corresponds to the GRN \
positional parameter r (see GRN). Cellerator options may not be combined with \
positional parameters and are discouraged becuase they can significantly \
degrade performance.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TGRN", "::", "usage"}], "=", 
   "\"\<TGRN is a Cellerator option for GRN[]. It corresponds to the GRN \
positional parameter T (see GRN). Cellerator options may not be combined with \
positional parameters and are discouraged becuase they can significantly \
degrade performance.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nGRN", "::", "usage"}], "=", 
   "\"\<nGRN is a Cellerator option for GRN[]. It corresponds to the GRN \
positional parameter n (see GRN). Cellerator options may not be combined with \
positional parameters and are discouraged becuase they can significantly \
degrade performance.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hGRN", "::", "usage"}], "=", 
   "\"\<hGRN is a Cellerator option for GRN[]. It corresponds to the GRN \
positional parameter h (see GRN). Cellerator options may not be combined with \
positional parameters and are discouraged becuase they can significantly \
degrade performance.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Sigmoid", "::", "usage"}], "=", 
   "\"\<Sigmoid is a Cellerator option for GRN[]. It represents a \
user-defined function, corresponding to the optional positional parameter f \
in GRN (see GRN). Cellerator options may not be combined with positional \
parameters and are discouraged becuase they can significantly degrade \
performance. In particular, user-defined sigmoids should be defined with \
user-defined arrows rather than the Sigmoid option. Not to be confused with \
the functions sigmoid, grnsigmoid, and sigma. \>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "GRN", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"TGRN", "\[Rule]", " ", "1"}], ",", " ", 
     RowBox[{"RGRN", "\[Rule]", " ", "1"}], ",", " ", 
     RowBox[{"nGRN", "\[Rule]", " ", "1"}], ",", " ", 
     RowBox[{"hGRN", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{"Sigmoid", "\[Rule]", " ", "sigmoid"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"grn", "::", "usage"}], "=", 
  "\"\<grn is an alternate spelling for GRN[].\>\""}], "\[IndentingNewLine]", \

 RowBox[{
  RowBox[{
   RowBox[{"TNHCA", "::", "usage"}], "=", 
   "\"\<TNHCA is a Cellerator option for NHCA. Cellerator options may not be \
combined with positional parameters and are discouraged becuase they can \
significantly degrade performance. \>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TPLUS", "::", "usage"}], "=", 
   "\"\<TPLUS  is a Cellerator option for NHCA. Cellerator options may not be \
combined with positional parameters and are discouraged becuase they can \
significantly degrade performance. \>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TMINUS", "::", "usage"}], "=", 
   "\"\<TMINUS  is a Cellerator option for NHCA. Cellerator options may not \
be combined with positional parameters and are discouraged becuase they can \
significantly degrade performance. \>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nNHCA", "::", "usage"}], "=", 
   "\"\<nNHCA  is a Cellerator option for NHCA. Cellerator options may not be \
combined with positional parameters and are discouraged becuase they can \
significantly degrade performance. \>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kNHCA", "::", "usage"}], "=", 
   "\"\<kNHCA is a Cellerator option for NHCA. Cellerator options may not be \
combined with positional parameters and are discouraged becuase they can \
significantly degrade performance. \>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mNHCA", "::", "usage"}], "=", 
   "\"\<mNHCA is a Cellerator option for  NHCA. Cellerator options may not be \
combined with positional parameters and are discouraged becuase they can \
significantly degrade performance. \>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "NHCA", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"TNHCA", "\[Rule]", " ", "1"}], ",", " ", 
     RowBox[{"TPLUS", "\[Rule]", " ", 
      RowBox[{"{", "}"}]}], ",", " ", 
     RowBox[{"TMINUS", "\[Rule]", " ", 
      RowBox[{"{", "}"}]}], ",", " ", 
     RowBox[{"nNHCA", "\[Rule]", " ", "1"}], ",", " ", 
     RowBox[{"kNHCA", "\[Rule]", " ", "1"}], ",", " ", 
     RowBox[{"mNHCA", "\[Rule]", " ", "1"}], ",", " ", 
     RowBox[{"vmax", "\[Rule]", " ", "1"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KGMWC", "::", "usage"}], "=", 
   "\"\<KGMWC is a Cellerator option for GMWC. Cellerator options may not be \
combined with positional parameters and are discouraged becuase they can \
significantly degrade performance. \>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cGMWC", "::", "usage"}], "=", 
   "\"\<cGMWC is a Cellerator option for GMWC. Cellerator options may not be \
combined with positional parameters and are discouraged becuase they can \
significantly degrade performance. \>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LGMWC", "::", "usage"}], "=", 
   "\"\<LGMWC is a Cellerator option for GMWC. Cellerator options may not be \
combined with positional parameters and are discouraged becuase they can \
significantly degrade performance. \>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kcatGMWC", "::", "usage"}], "=", 
   "\"\<kcatGMWC is a Cellerator option for GMWC. \>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "GMWC", "]"}], ":=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"KGMWC", "\[Rule]", " ", "1"}], ",", " ", 
     RowBox[{"cGMWC", "\[Rule]", " ", "1"}], ",", " ", 
     RowBox[{"LGMWC", "\[Rule]", " ", "1"}], ",", " ", 
     RowBox[{"nGMWC", "\[Rule]", " ", "1"}], ",", " ", 
     RowBox[{"kcatGMWC", "\[Rule]", " ", "1"}]}], "}"}]}], ";"}]}], "Input",
 InitializationCell->True],

Cell[BoxData["\<\"grn is an alternate spelling for GRN[].\"\>"], "Output",
 CellChangeTimes->{3.426977305183849*^9}]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell["Private Section", "Subtitle"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell["Determine if proper version of MathSBML is loaded", "Section",
 CellChangeTimes->{{3.401649768378057*^9, 3.4016497807886257`*^9}, {
  3.401651495259954*^9, 3.401651497515973*^9}}],

Cell["\<\
************ START of MathSBML Commented OUT Section ******************\
\>", "Text",
 CellChangeTimes->{{3.587660905723068*^9, 3.587660913707423*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tovernum", "[", 
      RowBox[{"u_", "?", "StringQ"}], "]"}], ":=", "  ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"vs", ",", " ", "num"}], "}"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"vs", "=", "u"}], ";", "\[IndentingNewLine]", 
        RowBox[{"vs", " ", "=", " ", 
         RowBox[{"StringReplace", "[", 
          RowBox[{"vs", ",", 
           RowBox[{"\"\<-\>\"", "\[Rule]", " ", "\"\<.\>\""}]}], "]"}]}], ";",
         " ", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"StringLength", "[", "vs", "]"}], ">", "0"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"num", "=", 
            RowBox[{"StringMatchQ", "[", 
             RowBox[{"vs", ",", " ", 
              RowBox[{
              "RegularExpression", "[", "\"\<\\\\d+\\\\.?\\\\d*\>\"", "]"}]}],
              "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"num", ",", " ", 
             RowBox[{"Return", "[", 
              RowBox[{"ToExpression", "[", "vs", "]"}], "]"}]}], "]"}], ";", 
           " ", "\[IndentingNewLine]", 
           RowBox[{"vs", "=", 
            RowBox[{"StringDrop", "[", 
             RowBox[{"vs", ",", " ", 
              RowBox[{"-", "1"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "0", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"tovernum", "[", "x___", "]"}], ":=", " ", 
     RowBox[{"Return", "[", "0", "]"}]}], ";", " ", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mver", "[", "]"}], ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "vs", "}"}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"vs", "=", 
         RowBox[{"tovernum", "[", "MathSBML`$MathSBML$Version", "]"}]}], ";", 
        " ", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "vs", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"$VersionNumber", ">", 
       RowBox[{"5.999", " ", "and", " ", "$VersionNumber"}], " ", "<", " ", 
       "8"}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"tovernum", "[", "$xlr8r$Version", "]"}], ">", "0.59"}], 
         ",", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"tovernum", "[", "MathSBML`$MathSBML$Version", "]"}], 
             "<", "2.8"}], ",", " ", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<Warning: this version of xlr8r requies MathSBML version \
2.8 or higher. Version loaded: \>\"", ",", " ", 
               "MathSBML`$MathSBML$Version"}], "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";"}]}], " ", "\[IndentingNewLine]", "]"}], ";", " ", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"$VersionNumber", " ", "\[GreaterEqual]", " ", "8.0"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringTake", "[", 
            RowBox[{"MathSBML`$MathSBML$Version", ",", "4"}], "]"}], "]"}], 
          "<", " ", "2.1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Warning: For this version of Mathematica, at least version \
2.10 of MathSBML is required. Version found: \>\"", ",", " ", 
           "MathSBML`$MathSBML$Version"}], "]"}]}], "\[IndentingNewLine]", 
        "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4016497960983133`*^9, 3.401649916893283*^9}, {
   3.401650608592143*^9, 3.4016507140499563`*^9}, {3.401650751136195*^9, 
   3.4016507536030903`*^9}, {3.401650797665874*^9, 3.401650802677474*^9}, {
   3.401650842017714*^9, 3.401650850658524*^9}, {3.401650915774515*^9, 
   3.4016509227236137`*^9}, {3.401650959343788*^9, 3.401650982515749*^9}, {
   3.4016510358010693`*^9, 3.401651272255389*^9}, {3.424643827089776*^9, 
   3.424643831468737*^9}, {3.507393920173778*^9, 3.5073939371228456`*^9}, {
   3.507394085433704*^9, 3.507394201695264*^9}, {3.5073945767620993`*^9, 
   3.507394593449915*^9}, {3.507394642219927*^9, 3.507394650282197*^9}, 
   3.507394803165517*^9, {3.5422942879732018`*^9, 3.542294307671158*^9}, {
   3.542294358771542*^9, 3.5422943869034348`*^9}, {3.5422947808773813`*^9, 
   3.542294788732687*^9}, {3.542294952545665*^9, 3.542295000346038*^9}, {
   3.587660729279261*^9, 3.587660741935162*^9}, {3.587660803633092*^9, 
   3.587660834509432*^9}, 3.587660879353203*^9, 3.587660911767836*^9}],

Cell["\<\
*************** END OF MathSBML COMMENTED OUT Section ****************\
\>", "Text",
 CellChangeTimes->{{3.587660926762916*^9, 3.587660961946003*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Utilities", "Section"],

Cell[CellGroupData[{

Cell["version 6 stuff", "Subsection",
 CellChangeTimes->{{3.3882539890884542`*^9, 3.388253996291641*^9}}],

Cell["This is a version 6 compatibility thing", "Text",
 CellChangeTimes->{{3.3882505605676813`*^9, 3.388250566204318*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MyTextStyle", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"$VersionNumber", "<", "6"}], ",", " ", 
      RowBox[{"TextStyle", "[", "x", "]"}], ",", " ", 
      RowBox[{"Style", "[", "x", "]"}]}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MyStyle", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"$VersionNumber", "<", "6"}], ",", " ", 
      RowBox[{"StyleForm", "[", "x", "]"}], ",", " ", 
      RowBox[{"Style", "[", "x", "]"}]}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MyDate", "[", "x___", "]"}], ":=", " ", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"$VersionNumber", "<", "6"}], ",", " ", 
     RowBox[{"Date", "[", "]"}], ",", " ", 
     RowBox[{"DateList", "[", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MyStylePrint", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"$VersionNumber", "<", "6"}], ",", " ", 
      RowBox[{"StylePrint", "[", "x", "]"}], ",", " ", 
      RowBox[{"Print", "[", 
       RowBox[{"Style", "[", "x", "]"}], "]"}]}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MyStyleForm", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"$VersionNumber", "<", "6"}], ",", " ", 
      RowBox[{"StyleForm", "[", "x", "]"}], ",", " ", 
      RowBox[{"Style", "[", "x", "]"}]}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MyGraphicsArray", "[", "x___", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"$VersionNumber", "<", "6"}], ",", " ", 
      RowBox[{"GraphicsArray", "[", "x", "]"}], ",", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"GraphicsGrid", "[", "x", "]"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MyFilterOptions", "[", 
    RowBox[{"f_", ",", " ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"$VersionNumber", "<", "6"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Utilities`FilterOptions`FilterOptions", "[", 
      RowBox[{"f", ",", " ", "opt"}], "]"}], "\[IndentingNewLine]", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Sequence", "@@", 
      RowBox[{"FilterRules", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"{", "opt", "}"}], "]"}], ",", 
        RowBox[{"Options", "[", "f", "]"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True],

Cell["\<\
(* 
The following nonsense is required to suppress printing of a \
Global`AngleBracket::shdw error message, because Off[..] does not work \
propertly in version 6
*)\
\>", "Text",
 CellChangeTimes->{3.588719290185062*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"$VersionNumber", "<", "6"}], ",", "\[IndentingNewLine]", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"MyAngleBracket", "[", "x___", "]"}], ":=", 
       RowBox[{
        RowBox[{"ToExpression", "[", "\"\<Global`AngleBracket\>\"", "]"}], "@@", 
        RowBox[{"{", "x", "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"MyRightArrowLeftArrow", "[", "x___", "]"}], ":=", 
       RowBox[{
        RowBox[{
        "ToExpression", "[", "\"\<Global`RightArrowLeftArrow\>\"", "]"}], "@@", 
        RowBox[{"{", "x", "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ExportXMLString", "[", "x_", "]"}], ":=", " ", 
       RowBox[{"ExportString", "[", 
        RowBox[{"x", ",", " ", "\"\<XML\>\"", ",", " ", 
         RowBox[{"ConversionOptions", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{
           "\"\<AttributeQuoting\>\"", "\[Rule]", " ", "\"\<\\\"\>\""}], 
           "}"}]}]}], "]"}]}]}], "\[IndentingNewLine]", ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"MyAngleBracket", "[", "x___", "]"}], ":=", 
       RowBox[{
        RowBox[{"ToExpression", "[", "\"\<System`AngleBracket\>\"", "]"}], "@@", 
        RowBox[{"{", "x", "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"MyRightArrowLeftArrow", "[", "x___", "]"}], ":=", 
       RowBox[{
        RowBox[{
        "ToExpression", "[", "\"\<System`RightArrowLeftArrow\>\"", "]"}], "@@", 
        RowBox[{"{", "x", "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ExportXMLString", "[", "x_", "]"}], ":=", " ", 
       RowBox[{"ExportString", "[", 
        RowBox[{"x", ",", "\"\<XML\>\"", ",", " ", 
         RowBox[{
         "\"\<AttributeQuoting\>\"", "\[Rule]", " ", "\"\<\\\"\>\""}]}], 
        "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";"}], " ", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Which", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$VersionNumber", "<", "6"}], ",", " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Xpression2SymbolicMathML", "[", "x_", "]"}], ":=", " ", 
     RowBox[{"XML`MathML`ExpressionToSymbolicMathML", "[", 
      RowBox[{"x", ",", 
       RowBox[{"\"\<Formats\>\"", "\[Rule]", " ", 
        RowBox[{"{", "\"\<ContentMathML\>\"", "}"}]}]}], "]"}]}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"$VersionNumber", " ", "\[Equal]", "6"}], " ", "\[And]", " ", 
     RowBox[{"$ReleaseNumber", "<", "2"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Xpression2SymbolicMathML", "[", "x_", "]"}], ":=", " ", 
     RowBox[{"XML`MathML`ExpressionToSymbolicMathML", "[", 
      RowBox[{"x", ",", " ", 
       RowBox[{"\"\<Semantics\>\"", "\[Rule]", " ", "True"}], ",", " ", 
       RowBox[{"\"\<Presentation\>\"", "\[Rule]", " ", "False"}]}], "]"}]}], 
    ",", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"$VersionNumber", " ", "\[Equal]", "6"}], " ", "\[And]", " ", 
     RowBox[{"$ReleaseNumber", ">", "1"}]}], ",", " ", "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"Xpression2SymbolicMathML", "[", "x_", "]"}], ":=", " ", 
     RowBox[{"XML`MathML`ExpressionToSymbolicMathML", "[", 
      RowBox[{"x", ",", 
       RowBox[{"\"\<Formats\>\"", "\[Rule]", " ", 
        RowBox[{"{", "\"\<ContentMathML\>\"", "}"}]}]}], "]"}]}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"$VersionNumber", "\[Equal]", "7"}], ",", " ", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Xpression2SymbolicMathML", "[", "x_", "]"}], ":=", " ", 
     RowBox[{"XML`MathML`ExpressionToSymbolicMathML", "[", 
      RowBox[{"x", ",", 
       RowBox[{"\"\<Formats\>\"", "\[Rule]", " ", 
        RowBox[{"{", "\"\<ContentMathML\>\"", "}"}]}]}], "]"}]}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"$VersionNumber", ">", "7"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Xpression2SymbolicMathML", "[", "x_", "]"}], ":=", " ", 
     RowBox[{"XML`MathML`ExpressionToSymbolicMathML", "[", 
      RowBox[{"x", ",", 
       RowBox[{"\"\<Formats\>\"", "\[Rule]", " ", 
        RowBox[{"{", "\"\<ContentMathML\>\"", "}"}]}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}],
   ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.3882504595856752`*^9, 3.3882504978792353`*^9}, {
   3.3882540222844973`*^9, 3.388254031666307*^9}, {3.3882542187827377`*^9, 
   3.388254332839521*^9}, 3.388254374222191*^9, {3.3882614191671343`*^9, 
   3.388261441730834*^9}, {3.388261631791882*^9, 3.388261656988212*^9}, {
   3.388318829904943*^9, 3.3883189461200333`*^9}, {3.388319240852165*^9, 
   3.388319292009931*^9}, {3.388319359026918*^9, 3.388319360077533*^9}, {
   3.3883194175486097`*^9, 3.3883194508735437`*^9}, {3.3883194854584837`*^9, 
   3.388319527917027*^9}, {3.3883196296372004`*^9, 3.388319639414143*^9}, {
   3.388319717672534*^9, 3.388319769681662*^9}, {3.388320078377129*^9, 
   3.3883200826608877`*^9}, {3.388320139413718*^9, 3.388320176703384*^9}, {
   3.388320251968589*^9, 3.38832025776324*^9}, {3.388320458987941*^9, 
   3.38832050141164*^9}, {3.388320679379107*^9, 3.388320717242478*^9}, {
   3.388320819519843*^9, 3.388320843174108*^9}, 3.3883209250219107`*^9, {
   3.3883209646283216`*^9, 3.388320997026855*^9}, {3.388321180719509*^9, 
   3.388321219770446*^9}, 3.388321280011972*^9, {3.388321334353608*^9, 
   3.388321450465458*^9}, {3.388321533908236*^9, 3.388321544300967*^9}, {
   3.388321617667096*^9, 3.388321691949287*^9}, {3.388321771119731*^9, 
   3.388321859598996*^9}, {3.388341249728394*^9, 3.388341298728224*^9}, {
   3.388341368222883*^9, 3.388341432374724*^9}, {3.388341641800812*^9, 
   3.388341645612159*^9}, {3.388343439894812*^9, 3.388343440007737*^9}, 
   3.3883434965742893`*^9, {3.3883435350151043`*^9, 3.388343535538432*^9}, {
   3.389720714628471*^9, 3.389720718662982*^9}, {3.389720767182125*^9, 
   3.389720786677952*^9}, {3.3897217372062483`*^9, 3.389721804977943*^9}, {
   3.389722343812415*^9, 3.389722404203517*^9}, {3.389722552946127*^9, 
   3.3897225561074963`*^9}, {3.424614812681766*^9, 3.424614892750532*^9}, {
   3.434463330508541*^9, 3.434463466722258*^9}, {3.434463588429246*^9, 
   3.434463619485801*^9}, {3.5073942383360167`*^9, 3.5073942680316668`*^9}, {
   3.560288101383709*^9, 3.560288124007056*^9}, {3.587658859626553*^9, 
   3.587658917864315*^9}, {3.587659023376903*^9, 3.5876590432559443`*^9}, {
   3.58765908110331*^9, 3.587659123439829*^9}, 3.587659259739561*^9, {
   3.587660035894558*^9, 3.587660039142077*^9}, {3.5876601077348137`*^9, 
   3.5876601085110807`*^9}, {3.588719263364079*^9, 3.588719295374508*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Colors and Styles", "Subsection",
 CellChangeTimes->{{3.587659254117639*^9, 3.587659255980773*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"boldRed", "[", "x_", "]"}], ":=", 
   RowBox[{"MyStyleForm", "[", 
    RowBox[{"x", ",", 
     RowBox[{"FontColor", "\[Rule]", 
      RowBox[{"RGBColor", "[", 
       RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", 
     RowBox[{"FontWeight", "\[Rule]", "Bold"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"boldBlack", "[", "x_", "]"}], ":=", 
   RowBox[{"MyStyleForm", "[", 
    RowBox[{"x", ",", 
     RowBox[{"FontColor", "\[Rule]", 
      RowBox[{"GrayLevel", "[", "0", "]"}]}], ",", 
     RowBox[{"FontWeight", "\[Rule]", "Bold"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"boldBlue", "[", "x_", "]"}], ":=", 
   RowBox[{"MyStyleForm", "[", 
    RowBox[{"x", ",", 
     RowBox[{"FontColor", "\[Rule]", 
      RowBox[{"RGBColor", "[", 
       RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
     RowBox[{"FontWeight", "\[Rule]", "Bold"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"boldGreen", "[", "x_", "]"}], ":=", 
   RowBox[{"MyStyleForm", "[", 
    RowBox[{"x", ",", 
     RowBox[{"FontColor", "\[Rule]", 
      RowBox[{"RGBColor", "[", 
       RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
     RowBox[{"FontWeight", "\[Rule]", "Bold"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"boldOrange", "[", "x_", "]"}], ":=", 
   RowBox[{"MyStyleForm", "[", 
    RowBox[{"x", ",", 
     RowBox[{"FontColor", "\[Rule]", 
      RowBox[{"RGBColor", "[", 
       RowBox[{"1", ",", ".5", ",", "0"}], "]"}]}], ",", 
     RowBox[{"FontWeight", "\[Rule]", "Bold"}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.588349612467518*^9, 3.5883496397828693`*^9}, {
  3.588349673483659*^9, 3.588349688443536*^9}, {3.588719771507496*^9, 
  3.588719776098091*^9}, {3.588719871749222*^9, 3.588719876657794*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["now",
 FontColor->RGBColor[0.700008, 0, 0.700008]]], "Subsection",
 CellFrame->{{0, 0}, {0, 0.5}},
 Background->RGBColor[0.749996, 1, 0.749996]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"now", "::", "usage"}], "=", 
    "\"\<now[] returns the date and time as a string\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"now", "[", "]"}], ":=", 
   RowBox[{"DateString", "[", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Day\>\"", ",", "\"\<-\>\"", ",", "\"\<MonthName\>\"", ",", " ", 
      "\"\<-\>\"", ",", " ", "\"\<Year\>\"", ",", " ", "\"\< \>\"", ",", " ", 
      "\"\<Hour24\>\"", ",", "\"\<:\>\"", ",", " ", "\"\<Minute\>\"", ",", 
      " ", "\"\<:\>\"", ",", "\"\<Second\>\"", ",", " ", "\"\<.\>\"", ",", 
      " ", "\"\<Millisecond\>\""}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nower", "[", "]"}], ":=", 
   RowBox[{"DateString", "[", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Day\>\"", ",", "\"\< \>\"", ",", "\"\<MonthName\>\"", ",", " ", 
      "\"\< \>\"", ",", " ", "\"\<Year\>\"", ",", " ", "\"\< at \>\"", ",", 
      " ", "\"\<Hour24\>\"", ",", "\"\<:\>\"", ",", " ", "\"\<Minute\>\"", 
      ",", " ", "\"\< \>\"", ",", " ", "\"\<TimeZone\>\""}], "}"}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.4010344824943438`*^9, {3.424644964047212*^9, 3.424644967195427*^9}, {
   3.424645178780828*^9, 3.4246452074349*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["symbolQ, NonItegerQ, NonListQ", "Subsection",
 CellChangeTimes->{{3.555497926918207*^9, 3.5554979307973747`*^9}, {
  3.555498110172886*^9, 3.555498111892008*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"symbolQ", "[", "x_", "]"}], ":=", 
   RowBox[{"SameQ", "[", 
    RowBox[{
     RowBox[{"Head", "[", "x", "]"}], ",", "Symbol"}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"NonIntegerQ", "[", "x_", "]"}], ":=", " ", 
  RowBox[{"Not", "[", 
   RowBox[{"IntegerQ", "[", "x", "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5554978752315187`*^9, 3.5554979200478086`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NonListQ", "[", "x_", "]"}], ":=", " ", 
  RowBox[{"Not", "[", 
   RowBox[{"ListQ", "[", "x", "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.555498113755118*^9, 3.555498121598254*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["getSingleValue,getnValues", "Subsection"],

Cell["\<\
checks a parameter to see if it is a list, and if so, returns only a single \
value\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"getSingleValue", "[", 
    RowBox[{"k_", ",", "kdefault_", ",", "  ", "message_", ",", "reaction_"}],
     "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "K", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"K", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", "k", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Switch", "[", 
       RowBox[{
        RowBox[{"Length", "[", "K", "]"}], ",", "\[IndentingNewLine]", "0", 
        ",", " ", 
        RowBox[{
         RowBox[{"K", "=", "kdefault"}], ";"}], ",", " ", 
        "\[IndentingNewLine]", "1", ",", " ", 
        RowBox[{
         RowBox[{"K", "=", 
          RowBox[{"First", "[", "K", "]"}]}], ";"}], ",", 
        "\[IndentingNewLine]", "_", ",", "  ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Error: extra \>\"", ",", "message", ",", "\"\< \>\"", ",", 
           RowBox[{"Drop", "[", 
            RowBox[{"K", ",", "1"}], "]"}], ",", " ", "\"\< in \>\"", ",", 
           " ", "reaction", ",", "\"\< ignored.\>\""}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"K", "=", 
          RowBox[{"First", "[", "K", "]"}]}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "K", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getnValues", "[", 
    RowBox[{"n_", ",", "v_", ",", "message_", ",", "reaction_"}], "]"}], ":=",
    " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"V", ",", "lastv"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"V", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", "v", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"lastv", "=", 
       RowBox[{"Last", "[", "V", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "V", "]"}], "<", "n"}], ",", " ", 
        RowBox[{"V", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"V", ",", "lastv"}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "V", "]"}], ">", "n"}], ",", " ", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Error: extra \>\"", ",", "message", ",", "\"\< \>\"", ",", 
           RowBox[{"Drop", "[", 
            RowBox[{"V", ",", "n"}], "]"}], ",", "\"\< in reaction \>\"", ",",
            "reaction", ",", "\"\< ignored.\>\""}], "]"}], ";"}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"V", "=", 
       RowBox[{"Take", "[", 
        RowBox[{"V", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "V", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getnListValues", "[", 
    RowBox[{"n_", ",", "v_", ",", "message_", ",", "reaction_"}], "]"}], ":=",
    " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"V", ",", "lastv"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ListQ", "[", "v", "]"}], ",", " ", 
        RowBox[{"V", "=", "v"}], ",", " ", 
        RowBox[{"V", "=", 
         RowBox[{"{", "v", "}"}]}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
      
      RowBox[{"V", "=", 
       RowBox[{"Flatten", "/@", 
        RowBox[{"List", "/@", "V"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"lastv", "=", 
       RowBox[{"Last", "[", "V", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "V", "]"}], "<", "n"}], ",", " ", 
        RowBox[{"V", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"V", ",", "lastv"}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "V", "]"}], ">", "n"}], ",", " ", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Error: extra \>\"", ",", "message", ",", "\"\< \>\"", ",", 
           RowBox[{"Drop", "[", 
            RowBox[{"V", ",", "n"}], "]"}], ",", "\"\< in reaction \>\"", ",",
            "reaction", ",", "\"\< ignored.\>\""}], "]"}], ";"}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"V", "=", 
       RowBox[{"Take", "[", 
        RowBox[{"V", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "V", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["functionArguments", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"functionArguments", "[", 
    RowBox[{"f_", "[", "x___", "]"}], "]"}], ":=", " ", 
   RowBox[{"{", "x", "}"}]}], ";"}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["sigmoid, sigma, grnsigmoid, hillFunction", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sigma", "[", "x_", "]"}], ":=", " ", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      FractionBox["x", 
       SqrtBox[
        RowBox[{"1", "+", 
         SuperscriptBox["x", "2"]}]]]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sigmoid", "[", "x_", "]"}], ":=", " ", 
   FractionBox["1", 
    RowBox[{"1", "+", 
     RowBox[{"Exp", "[", 
      RowBox[{"-", "x"}], "]"}]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"grnsigmoid", "[", 
     RowBox[{"x_", ",", 
      RowBox[{"r_:", "1"}], ",", 
      RowBox[{"T_:", "1"}], ",", " ", 
      RowBox[{"n_:", "1"}], ",", 
      RowBox[{"h_:", "0"}]}], "]"}], ":=", " ", 
    RowBox[{"r", "*", 
     RowBox[{"sigmoid", "[", 
      RowBox[{"h", "+", 
       RowBox[{"T", "*", 
        RowBox[{"x", "^", "n"}]}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "The", " ", "following", " ", "expansion", " ", "is", " ", "done", " ", 
      "to", " ", "handle", " ", "negative", " ", "exponents", " ", "on", " ", 
      "hill", " ", "functions", " ", "near", " ", "x"}], "=", 
     RowBox[{"0.", " ", "This", " ", "is", " ", "because", 
      FractionBox[
       SuperscriptBox["x", 
        RowBox[{"-", "n"}]], 
       RowBox[{"1", "+", 
        SuperscriptBox["x", 
         RowBox[{"-", "n"}]]}]], " ", "has", " ", "a", " ", 
      RowBox[{"1", "/", "0"}], " ", "form", " ", "in", " ", "both", " ", 
      "the", " ", "numerator", " ", "and", " ", "denominator"}]}], ",", " ", 
    RowBox[{
    "whereas", " ", "the", " ", "mathematically", " ", "equivalent", " ", 
     "form", "  ", 
     FractionBox["1", 
      RowBox[{"1", "+", 
       SuperscriptBox["x", "n"]}]], " ", "has", " ", 
     RowBox[{"neither", ".", " ", "The"}], " ", 
     SuperscriptBox["x", 
      RowBox[{"-", "n"}]], " ", "is", " ", "actually", " ", "part", " ", "of",
      " ", "the", " ", "denominator"}], ",", " ", 
    RowBox[{"i", ".", "e", "."}], ",", " ", 
    RowBox[{"Matheamtica", " ", "treats", " ", "it", " ", "as", "  ", 
     FractionBox["1", 
      RowBox[{
       SuperscriptBox["x", "n"], 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SuperscriptBox["x", 
          RowBox[{"-", "n"}]]}], ")"}]}]]}], ",", " ", 
    RowBox[{"which", " ", "is", " ", "why", " ", "this", " ", "should", " ", 
     RowBox[{"work", "."}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"hillFunction", "[", 
     RowBox[{"x_", ",", "K_", ",", "n_", ",", "v_", ",", " ", "r_"}], "]"}], ":=",
     " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"num", ",", "den", ",", "quotient"}], "}"}], ",", " ", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"quotient", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"r", "+", 
           RowBox[{"v", "*", 
            RowBox[{"x", "^", "n"}]}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"K", "^", "n"}], "+", 
           RowBox[{"x", "^", "n"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"num", "=", 
        RowBox[{"Expand", "[", 
         RowBox[{"Numerator", "[", "quotient", "]"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"den", " ", "=", " ", 
        RowBox[{"Expand", "[", 
         RowBox[{"Denominator", "[", "quotient", "]"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"quotient", "=", 
        RowBox[{"num", "/", "den"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "quotient", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.425400337964292*^9, 3.425400558423218*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["bifurcationPlot", "Subsection",
 CellChangeTimes->{{3.494007173865322*^9, 3.494007175864646*^9}}],

Cell[TextData[{
 "Based on Wagon, ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " in Action"
}], "Text",
 CellChangeTimes->{{3.494007230339511*^9, 3.494007239162512*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"BifurcationPlot", "[", 
   RowBox[{"f_", ",", 
    RowBox[{"{", 
     RowBox[{"r_", ",", "a_", ",", "b_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "x0_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"iter0_", ",", "iterShow_"}], "}"}], ",", "opts___"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "sty", ",", "n", ",", "makePts", ",", "cf", ",", "rVals", ",", "data"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"sty", ",", "n"}], "}"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"PlotStyle", ",", "PlotPoints"}], "}"}], "/.", 
        RowBox[{"{", "opts", "}"}]}], "/.", 
       RowBox[{"Options", "[", "BifurcationPlot", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"makePts", "[", 
       RowBox[{"{", 
        RowBox[{"s_", ",", "v_"}], "}"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"s", ",", "#"}], "}"}], "&"}], ")"}], "/@", "v"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"cf", "=", 
      RowBox[{"Compile", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"r", ",", "_Real", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",", 
        RowBox[{"Evaluate", "[", "f", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rVals", "=", 
      RowBox[{"Range", "[", 
       RowBox[{
        RowBox[{"N", "[", "a", "]"}], ",", "b", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"b", "-", "a"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"n", "-", "1"}], ")"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"rVals", ",", 
         RowBox[{"Transpose", "[", 
          RowBox[{"NestList", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"cf", "[", 
              RowBox[{"rVals", ",", "#"}], "]"}], "&"}], ",", 
            RowBox[{"Nest", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"cf", "[", 
                RowBox[{"rVals", ",", "#1"}], "]"}], "&"}], ",", 
              RowBox[{"Array", "[", 
               RowBox[{
                RowBox[{"x0", "&"}], ",", "n"}], "]"}], ",", "iter0"}], "]"}],
             ",", "iterShow"}], "]"}], "]"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Graphics", "[", 
      RowBox[{
       RowBox[{"Append", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"{", "sty", "}"}], "]"}], ",", 
         RowBox[{"Point", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"makePts", "/@", "data"}], ",", "1"}], "]"}], "]"}]}], 
        "]"}], ",", 
       RowBox[{"Sequence", "@@", 
        RowBox[{"FilterRules", "[", 
         RowBox[{
          RowBox[{"{", "opts", "}"}], ",", 
          RowBox[{"Options", "[", "Graphics", "]"}]}], "]"}]}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", 
        RowBox[{"1", "/", "3"}]}], ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"FrameTicks", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Automatic", ",", 
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", "1", ",", ".5"}], "]"}], ",", "None", ",", 
          "None"}], "}"}]}], ",", 
       RowBox[{"Axes", "\[Rule]", "None"}]}], "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["functionate, defunctionate", "Subsection",
 CellChangeTimes->{{3.587659282533107*^9, 3.587659283998431*^9}, {
  3.587930539880702*^9, 3.5879305464143467`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"functionate", "[", 
     RowBox[{
      RowBox[{"f_", "?", "StringQ"}], ",", 
      RowBox[{"arg_:", "Global`t"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tvariable", ",", " ", "result"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tvariable", "=", 
        RowBox[{"ToString", "[", "arg", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"result", "=", 
        RowBox[{
        "f", "<>", "\"\<[\>\"", "<>", "tvariable", "<>", "\"\<]\>\""}]}], ";",
        " ", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "result", "]"}], ";"}]}], "\[IndentingNewLine]",
      "]"}]}], ";"}], " ", "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"functionate", "[", 
     RowBox[{
      RowBox[{"f_", "?", "ListQ"}], ",", 
      RowBox[{"arg_:", "Global`t"}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"functionate", "[", 
        RowBox[{"#1", ",", "arg"}], "]"}], "&"}], ")"}], "/@", "f"}]}], ";"}],
   " ", "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"functionate", "[", 
     RowBox[{"f_", ",", 
      RowBox[{"arg_:", "Global`t"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "g", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"g", "=", 
        RowBox[{"functionate", "[", 
         RowBox[{
          RowBox[{"ToString", "[", "f", "]"}], ",", 
          RowBox[{"ToString", "[", "arg", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"ToExpression", "[", "g", "]"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"defunctionate", "[", 
    RowBox[{"f_", "[", "t_", "]"}], "]"}], ":=", "f"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"defunctionate", "[", 
    RowBox[{"f_", "?", "StringQ"}], "]"}], ":=", 
   RowBox[{"StringReplace", "[", 
    RowBox[{"f", ",", 
     RowBox[{
      RowBox[{"\"\<[\>\"", "~~", "___", "~~", "\"\<]\>\""}], "\[Rule]", 
      "\"\<\>\""}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"defunctionate", "[", "f_", "]"}], ":=", "f"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5876592969476*^9, 3.5876594957639637`*^9}, {
  3.587930526986861*^9, 3.587930537307665*^9}, {3.587932427947205*^9, 
  3.587932445998415*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["getSymbols", "Subsection",
 CellChangeTimes->{{3.587659570524261*^9, 3.587659573651828*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"getSymbols", "[", "exp_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v", ",", "expr", ",", "myxml", ",", 
       RowBox[{"dbg", "=", "False"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"expr", "=", "exp"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"StringQ", "[", "expr", "]"}], ",", 
        RowBox[{"expr", "=", 
         RowBox[{"ToExpression", "[", "expr", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"myxml", "[", 
        RowBox[{"\"\<ci\>\"", ",", 
         RowBox[{"{", "___", "}"}], ",", 
         RowBox[{"{", "x_", "}"}]}], "]"}], ":=", "x"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"myxml", "[", 
        RowBox[{"\"\<csymbol\>\"", ",", "___"}], "]"}], ":=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"myxml", "[", 
        RowBox[{"_", ",", 
         RowBox[{"{", "___", "}"}], ",", 
         RowBox[{"{", "z___", "}"}]}], "]"}], ":=", 
       RowBox[{"{", "z", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{"Xpression2SymbolicMathML", "[", "expr", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"dbg", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<getSymbols: v(1):\>\"", ",", "v"}], "]"}]}], "]"}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{"ToExpression", "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"v", "/.", 
             RowBox[{"{", 
              RowBox[{"XMLElement", "\[Rule]", "myxml"}], "}"}]}], ")"}], "//",
            "Flatten"}], "//", "Union"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"dbg", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<getSymbols: v(2):\>\"", ",", "v"}], "]"}]}], "]"}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"v", ",", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"(", 
            RowBox[{"NumberQ", "[", "#", "]"}], ")"}]}], "&"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{"Complement", "[", 
        RowBox[{"v", ",", 
         RowBox[{"{", "If", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"dbg", ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<getSymbols: exp: \>\"", ",", "exp", ",", "\"\< v: \>\"", ",", 
           "v"}], "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "v", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5876595830783978`*^9, 3.5876596797610893`*^9}, {
   3.587659737873084*^9, 3.587659745375404*^9}, 3.587659840299054*^9, {
   3.587659955277356*^9, 3.587660021534595*^9}, {3.5876601198684883`*^9, 
   3.587660125878738*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["decontextify", "Subsection",
 CellChangeTimes->{{3.587660592461286*^9, 3.587660594243311*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"decontextify", "[", 
    RowBox[{"x_", "?", "StringQ"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p", ",", "q"}], "}"}], ",", 
     RowBox[{
      RowBox[{"p", "=", 
       RowBox[{"StringPosition", "[", 
        RowBox[{"x", ",", "\"\<`\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "p", "]"}], "<", "1"}], ",", 
        RowBox[{"Return", "[", "x", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"p", "=", 
       RowBox[{"Map", "[", 
        RowBox[{"First", ",", "p"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"p", "=", 
       RowBox[{"Last", "[", "p", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"q", "=", 
       RowBox[{"StringDrop", "[", 
        RowBox[{"x", ",", "p"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "q", "]"}], ";"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"decontextify", "[", 
    RowBox[{"x_", "?", "ListQ"}], "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{"decontextify", ",", "x"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"decontextify", "[", "x_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "s", "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"decontextify", "[", 
          RowBox[{"ToString", "[", 
           RowBox[{"InputForm", "[", "x", "]"}], "]"}], "]"}], "//", 
         "ToExpression"}], "//", "Return"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"decontextify", "[", 
    RowBox[{
     RowBox[{"x_", "?", "StringQ"}], ",", 
     RowBox[{"context_", "?", "StringQ"}]}], "]"}], ":=", 
   RowBox[{"StringReplace", "[", 
    RowBox[{"x", ",", 
     RowBox[{"{", 
      RowBox[{"context", "\[Rule]", "\"\<\>\""}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"decontextify", "[", 
    RowBox[{
     RowBox[{"x_", "?", "ListQ"}], ",", 
     RowBox[{"context_", "?", "StringQ"}]}], "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"decontextify", "[", 
       RowBox[{"#", ",", "context"}], "]"}], "&"}], ",", "x"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"decontextify", "[", 
     RowBox[{"x_", ",", 
      RowBox[{"context_", "?", "StringQ"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"decontextify", "[", 
          RowBox[{
           RowBox[{"ToString", "[", 
            RowBox[{"InputForm", "[", "x", "]"}], "]"}], ",", "context"}], 
          "]"}], "//", "ToExpression"}], "//", "Return"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5876606034326687`*^9, 3.587660629199058*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["contextify", "Subsection",
 CellChangeTimes->{{3.588352969912706*^9, 3.588352970910838*^9}}],

Cell["093a fork from MathSBML", "Text",
 CellChangeTimes->{{3.58835299339284*^9, 3.588352998374812*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"contextify", "[", 
    RowBox[{
     RowBox[{"x_", "?", "StringQ"}], ",", 
     RowBox[{"context_:", " ", "\"\<\>\""}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s", ",", "c"}], "}"}], ",", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"x", "\[Equal]", "\"\<\>\""}], "\[Or]", 
         RowBox[{"x", "\[Equal]", "\"\<Indeterminate\>\""}]}], ",", 
        RowBox[{"Return", "[", "x", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", "context"}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"ToString", "[", "c", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"c", "\[Equal]", "\"\<None\>\""}], "\[Or]", 
         RowBox[{"c", "\[Equal]", "\"\<None`\>\""}], " ", "\[Or]", 
         RowBox[{"c", "\[Equal]", "\"\<\>\""}]}], ",", 
        RowBox[{"Return", "[", "x", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"StringTake", "[", 
          RowBox[{"c", ",", 
           RowBox[{"-", "1"}]}], "]"}], "\[NotEqual]", "\"\<`\>\""}], ",", 
        RowBox[{"s", "=", 
         RowBox[{"c", "<>", "\"\<`\>\"", "<>", "x"}]}], ",", 
        RowBox[{
         RowBox[{"s", "=", 
          RowBox[{"c", "<>", "x"}]}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "s", "]"}], ";"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"contextify", "[", 
     RowBox[{
      RowBox[{"x_", "\[Rule]", "y_"}], ",", 
      RowBox[{"context_:", " ", "\"\<\>\""}]}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"contextify", "[", 
       RowBox[{"x", ",", "context"}], "]"}], "\[Rule]", 
      RowBox[{"contextify", "[", 
       RowBox[{"y", ",", "context"}], "]"}]}], ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"contextify", "[", 
    RowBox[{
     RowBox[{"x_", "?", "ListQ"}], ",", 
     RowBox[{"context_:", " ", "\"\<\>\""}]}], "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"contextify", "[", 
       RowBox[{"#", ",", "context"}], "]"}], "&"}], ",", "x"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"contextify", "[", 
    RowBox[{
     RowBox[{"x_", "[", "y___", "]"}], ",", 
     RowBox[{"context_:", " ", "\"\<\>\""}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"contextify", "[", 
     RowBox[{"x", ",", "context"}], "]"}], "[", "y", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"contextify", "[", 
    RowBox[{"x_", ",", 
     RowBox[{"context_:", " ", "\"\<\>\""}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{"Head", "[", "x", "]"}], "]"}], "\[Equal]", 
         "\"\<Symbol\>\""}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"contextify", "[", 
            RowBox[{
             RowBox[{"ToString", "[", "x", "]"}], ",", "context"}], "]"}], "//",
            "ToExpression"}], "//", "Return"}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
        RowBox[{"\"\<Error: \>\"", "//", "boldRed"}], ",", 
        RowBox[{"\"\<contextify: \>\"", "//", "boldBlue"}], ",", 
        RowBox[{
        "\"\<The argument to contextify must be a string or a symbol; \
argument used: \>\"", "//", "boldBlack"}], ",", 
        RowBox[{"x", "//", "boldRed"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "x", "]"}], ";"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.588352942274168*^9, 3.588352988572474*^9}, {
  3.5883530411988573`*^9, 3.5883530799983053`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["nonOptionQ", "Subsection",
 CellChangeTimes->{{3.588349916289966*^9, 3.588349919120162*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"nonOptionQ", "[", "x_", "]"}], ":=", 
   RowBox[{"Not", "[", 
    RowBox[{"OptionQ", "[", "x", "]"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.588349920861538*^9, 3.588349920862446*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["string functions", "Subsection",
 CellChangeTimes->{{3.587729284822475*^9, 3.587729286956484*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"stringer", "[", "x_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"StringQ", "[", "x", "]"}], ",", "x", ",", 
     RowBox[{"ToString", "[", 
      RowBox[{"InputForm", "[", "x", "]"}], "]"}]}], "]"}]}], ";"}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.5877292892931147`*^9, 3.5877292892935057`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["argument", "Subsection",
 CellChangeTimes->{{3.588354281896761*^9, 3.588354282720055*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"argument", "[", 
     RowBox[{"f_", "[", "x_", "]"}], "]"}], ":=", "x"}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Arrow recognition", "Section"],

Cell["\<\
expandArrows[arrowForm] returns a list of arrows in minimal form, e.g., with \
the correct set of rate constants and cascades reduced to individual \
reactions, .e.g., \
expandArrows[{A\[ShortRightArrow]B\[ShortRightArrow]C,k1,k2,k3}] returns {{A\
\[ShortRightArrow]B,k1},{B\[ShortRightArrow]C,k2}}.

parseArrowForm[rarrowform] returns a list {{variable, odeterm}, {variable, \
odeterm},...}\
\>", "Text"],

Cell[CellGroupData[{

Cell["reaction_Stoichometry", "Subsection",
 CellChangeTimes->{{3.551313378634964*^9, 3.55131338225042*^9}, {
  3.551313462410358*^9, 3.5513134708979*^9}}],

Cell["used by flux and mass action arrows", "Text",
 CellChangeTimes->{{3.551313408010438*^9, 3.551313419961999*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"reactionStoich", "[", 
    RowBox[{"LHS_", ",", " ", "RHS_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "input", ",", " ", "output", ",", " ", "netStoichiometry", ",", " ", 
       "species", ",", " ", "stoics"}], "}"}], ",", " ", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"input", "=", 
       RowBox[{
        StyleBox["parseReactants",
         FontColor->RGBColor[0, 0, 1]], "[", 
        RowBox[{"True", ",", "LHS"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"output", "=", 
       RowBox[{
        StyleBox["parseReactants",
         FontColor->RGBColor[0, 0, 1]], "[", 
        RowBox[{"True", ",", " ", "RHS"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"species", "=", 
       RowBox[{"Union", "[", 
        RowBox[{
         RowBox[{"First", "/@", "input"}], ",", " ", 
         RowBox[{"First", "/@", "output"}]}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"netStoichiometry", "[", "x_", "]"}], ":=", " ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"in", ",", "out"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"in", " ", "=", " ", 
           RowBox[{"Cases", "[", 
            RowBox[{"input", ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", "_"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "in", "]"}], "<", "1"}], ",", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"in", " ", "=", " ", "0"}], ",", " ", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"in", " ", "=", " ", 
              RowBox[{"Transpose", "[", "in", "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"in", "=", 
              RowBox[{"Plus", "@@", 
               RowBox[{"in", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"out", "=", 
           RowBox[{"Cases", "[", 
            RowBox[{"output", ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", "_"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "out", "]"}], "<", "1"}], ",", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"out", " ", "=", " ", "0"}], ",", " ", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"out", " ", "=", " ", 
              RowBox[{"Transpose", "[", "out", "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"out", "=", 
              RowBox[{"Plus", "@@", 
               RowBox[{"out", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"(", 
           RowBox[{"out", "-", "in"}], ")"}]}]}], "\[IndentingNewLine]", 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"stoics", " ", "=", " ", 
       RowBox[{"netStoichiometry", "/@", "species"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"species", ",", " ", "stoics"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"reactionStoich", "[", "other___", "]"}], ":=", 
  RowBox[{"(", " ", 
   RowBox[{
    RowBox[{"Print", "[", "\"\<Error:ReactionStoich.\>\"", "]"}], ";", " ", 
    RowBox[{"Abort", "[", "]"}], ";"}], ")"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.551313769956439*^9, 3.5513138658591013`*^9}, {
  3.551313913890231*^9, 3.551313917047378*^9}, {3.551314217240049*^9, 
  3.5513142369638643`*^9}, {3.551314327586689*^9, 3.5513143690079393`*^9}, {
  3.551314513519356*^9, 3.551314517004928*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Flux Arrows", "Subsection",
 CellDingbat->None,
 CellChangeTimes->{{3.551309427837545*^9, 3.551309429548994*^9}},
 Background->RGBColor[1, 0.983139, 0.832074]],

Cell[CellGroupData[{

Cell["\<\
parseArrowForm: [A\[ShortRightArrow]B, Flux[...]]  \
\>", "Subsection",
 CellChangeTimes->{{3.551309530965551*^9, 3.551309549644999*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"parseArrowForm", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ShortRightArrow", "[", 
      RowBox[{"substrateExpression_", ",", "productExpression_"}], " ", "]"}],
      ",", 
     RowBox[{"Flux", "[", "stuff__", "]"}]}], "}"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "parseExpression", ",", " ", "reaction", ",", " ", "input", ",", " ", 
      "output", ",", " ", "klaw", ",", "stoics", ",", " ", "species", ",", 
      " ", "nspecies", ",", " ", 
      RowBox[{"dbg", "=", "False"}], ",", " ", "netStoichiometry", ",", " ", 
      "rates", ",", "odes", ",", " ", "k"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"reaction", " ", "=", " ", 
      RowBox[{"ShortRightArrow", "[", 
       RowBox[{"substrateExpression", ",", "productExpression"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"dbgArrows", ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<parseArrowForm:\>\"", ",", " ", "reaction"}], "]"}]}], 
      "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"reaction", ",", "k"}], "}"}], "=", 
      RowBox[{
       RowBox[{"expandArrows", "[", 
        RowBox[{"{", 
         RowBox[{"reaction", ",", 
          RowBox[{"Flux", "[", "stuff", "]"}]}], "}"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"species", ",", " ", "stoics"}], "}"}], " ", "=", " ", 
      RowBox[{"reactionStoich", "[", 
       RowBox[{"substrateExpression", ",", " ", "productExpression"}], 
       "]"}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"rates", " ", "=", " ", 
      RowBox[{"k", "*", "stoics"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"dbg", ",", "\[IndentingNewLine]", " ", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<input stoichiometry:\>\"", ",", "input"}], "]"}], ";", 
        " ", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<klaw=\>\"", ",", "klaw"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<output stoichiometry:\>\"", ",", "output"}], "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<species:\>\"", ",", " ", "species"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<rates:\>\"", ",", "rates"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"odes", " ", "=", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"species", ",", "rates"}], "}"}], "//", "Transpose"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"dbg", ",", " ", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<------------------------------------------>Flux Model: \>\"", 
         ",", " ", "odes"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "odes", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4010336747911167`*^9, 3.401033674857809*^9}, {
   3.427488832485235*^9, 3.427488833129921*^9}, {3.427489181433503*^9, 
   3.42748922143582*^9}, {3.427489316339744*^9, 3.427489342955276*^9}, {
   3.427490761682662*^9, 3.427490762419267*^9}, {3.551309447688415*^9, 
   3.551309469352765*^9}, {3.551309627250102*^9, 3.551309634884037*^9}, {
   3.551309841701913*^9, 3.551309842431753*^9}, {3.5513099140518503`*^9, 
   3.551309916194441*^9}, {3.551309995455606*^9, 3.551310037804578*^9}, {
   3.5513100885067577`*^9, 3.551310092288735*^9}, {3.5513108048189507`*^9, 
   3.551310850342663*^9}, {3.551311142872119*^9, 3.55131115415668*^9}, {
   3.551311205518621*^9, 3.551311214755035*^9}, {3.551311298056821*^9, 
   3.551311312103631*^9}, {3.551311429121825*^9, 3.551311432863689*^9}, {
   3.551311695865733*^9, 3.551311721293994*^9}, 3.551311753190361*^9, {
   3.551311842883128*^9, 3.551311867130569*^9}, {3.551311920876317*^9, 
   3.551311971306938*^9}, {3.551312001584203*^9, 3.551312011435831*^9}, {
   3.551312079578375*^9, 3.5513121210675783`*^9}, 3.55131252968891*^9, {
   3.5513136508898773`*^9, 3.551313651578855*^9}, {3.551313878420308*^9, 
   3.5513138869392776`*^9}, {3.55131392585041*^9, 3.551314080734921*^9}, {
   3.551314127078917*^9, 3.5513141333891582`*^9}, {3.551314194911067*^9, 
   3.551314210553052*^9}, {3.551314495426133*^9, 3.5513145052617903`*^9}, {
   3.55131461441234*^9, 3.55131461778509*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
expandArrows: [A\[ShortRightArrow]B, Flux[...]]  \
\>", "Subsection",
 CellChangeTimes->{{3.551309530965551*^9, 3.551309549644999*^9}, {
  3.551310182705715*^9, 3.5513101881358843`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"expandArrows", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ShortRightArrow", "[", 
      RowBox[{"substrateExpression_", ",", "productExpression_"}], " ", "]"}],
      ",", 
     RowBox[{"Flux", "[", "stuff__", "]"}]}], "}"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "reaction", ",", " ", "k", ",", " ", "lhs", ",", " ", "rhs", ",", " ", 
      "input", ",", "denominator", ",", " ", 
      RowBox[{"dbg", "=", "False"}]}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"lhs", " ", "=", " ", 
      RowBox[{"ListToSum", "[", "substrateExpression", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"rhs", "=", 
      RowBox[{"ListToSum", "[", "productExpression", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"reaction", " ", "=", " ", 
      RowBox[{"ShortRightArrow", "[", 
       RowBox[{"lhs", ",", "rhs"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"input", "=", 
      RowBox[{
       StyleBox["parseReactants",
        FontColor->RGBColor[0, 0, 1]], "[", 
       RowBox[{"True", ",", "substrateExpression"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"denominator", " ", "=", " ", 
      RowBox[{"Times", "@@", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Power", "@@", "#"}], "&"}], ",", "input"}], "]"}]}]}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"k", "=", 
      RowBox[{
       RowBox[{"{", "stuff", "}"}], "//", "Flatten"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"dbg", ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<expandArrows:\>\"", ",", " ", "reaction", ",", " ", 
         "\"\< k=\>\"", ",", " ", "k"}], "]"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "k", "]"}], "<", "2"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"iFluxArrows", " ", "=", " ", 
          RowBox[{"iFluxArrows", "+", "1"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"k", " ", "=", " ", 
          RowBox[{"Unique", "[", 
           RowBox[{"\"\<v\>\"", "<>", 
            RowBox[{"ToString", "[", "iFluxArrows", "]"}]}], "]"}]}], ";", 
         " ", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Error: no flux variable given for Flux Reaction \>\"", ",", 
           " ", "reaction", ",", " ", "\"\< using \>\"", ",", " ", "k"}], 
          "]"}], ";"}], " ", "\[IndentingNewLine]", ")"}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{"k", " ", "=", " ", 
        RowBox[{"k", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], 
     ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"reaction", ",", 
         RowBox[{"k", "/", "denominator"}]}], "}"}], "}"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.401033674621236*^9, 3.401033674687853*^9}, {
  3.427491894208405*^9, 3.427491924825873*^9}, {3.551310166325431*^9, 
  3.551310169970727*^9}, {3.551310225388907*^9, 3.551310226160822*^9}, {
  3.551310259667191*^9, 3.551310404818306*^9}, {3.5513106237640057`*^9, 
  3.551310796358878*^9}, {3.5513125650769253`*^9, 3.551312610350954*^9}, {
  3.551312644373908*^9, 3.551312647678279*^9}, {3.551312681069376*^9, 
  3.551312692111655*^9}, {3.551313033787016*^9, 3.551313035212907*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["mass action reactions & cascades", "Subsection",
 CellDingbat->None,
 Background->RGBColor[1, 0.983139, 0.832074]],

Cell[CellGroupData[{

Cell["ListToSum", "Subsubsection",
 CellChangeTimes->{{3.427491842956947*^9, 3.427491844505204*^9}}],

Cell["\<\
added 0.69 - sometimes want to specify a sum of reactants as a list i.e., A-> \
{B, C} instead of A->B+C\
\>", "Text",
 CellChangeTimes->{{3.427491847067647*^9, 3.427491873815051*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ListToSum", "[", "x_", "]"}], ":=", " ", 
   RowBox[{"Plus", "@@", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{"x", "/.", 
       RowBox[{"{", 
        RowBox[{"Plus", "\[Rule]", "List"}], "}"}]}], "}"}], "]"}]}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.427490540182323*^9, 3.427490562131124*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["setBinding", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"setBinding", "[", 
     RowBox[{"A_", ",", " ", "B_"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"r1", ",", "r2"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"r1", ",", "r2"}], "}"}], "=", 
        RowBox[{"Sort", "[", 
         RowBox[{"{", 
          RowBox[{"A", ",", "B"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"Bind", "[", 
         RowBox[{"r1", ",", "r2"}], "]"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], " "}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["parseReactants", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     StyleBox["parseReactants",
      FontColor->RGBColor[0, 0, 1]], "[", 
     RowBox[{"functionForm_", ",", 
      RowBox[{"Plus", "[", "x___", "]"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"r", ",", " ", "parseStoichiometry"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{"functionForm", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            StyleBox["parseStoichiometry",
             FontColor->RGBColor[0, 0, 1]], "[", 
            RowBox[{"Times", "[", 
             RowBox[{
              RowBox[{"n", "?", "NumberQ"}], ",", "var_"}], "]"}], "]"}], ":=",
            " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"var", "[", "Global`t", "]"}], ",", "n"}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            StyleBox["parseStoichiometry",
             FontColor->RGBColor[0, 0, 1]], "[", 
            RowBox[{"Times", "[", 
             RowBox[{"var_", ",", 
              RowBox[{"n_", "?", "NumberQ"}]}], "]"}], "]"}], ":=", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"var", "[", "Global`t", "]"}], ",", "n"}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            StyleBox["parseStoichiometry",
             FontColor->RGBColor[0, 0, 1]], "[", "var_", "]"}], ":=", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"var", "[", "Global`t", "]"}], ",", "1"}], "}"}]}], 
          ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            StyleBox["parseStoichiometry",
             FontColor->RGBColor[0, 0, 1]], "[", 
            RowBox[{"Times", "[", 
             RowBox[{
              RowBox[{"n", "?", "NumberQ"}], ",", "var_"}], "]"}], "]"}], ":=",
            " ", 
           RowBox[{"{", 
            RowBox[{"var", ",", "n"}], "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            StyleBox["parseStoichiometry",
             FontColor->RGBColor[0, 0, 1]], "[", 
            RowBox[{"Times", "[", 
             RowBox[{"var_", ",", 
              RowBox[{"n_", "?", "NumberQ"}]}], "]"}], "]"}], ":=", " ", 
           RowBox[{"{", 
            RowBox[{"var", ",", "n"}], "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            StyleBox["parseStoichiometry",
             FontColor->RGBColor[0, 0, 1]], "[", "var_", "]"}], ":=", " ", 
           RowBox[{"{", 
            RowBox[{"var", ",", "1"}], "}"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"r", "=", 
        RowBox[{
         RowBox[{"Plus", "[", "x", "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{"Plus", "\[Rule]", " ", "List"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"ListQ", "[", "r", "]"}]}], ",", " ", 
         RowBox[{"r", "=", 
          RowBox[{"{", "r", "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"r", " ", "=", " ", 
        RowBox[{"parseStoichiometry", "/@", "r"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"functionForm", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"r", "=", 
           RowBox[{"Complement", "[", 
            RowBox[{"r", ",", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Global`\[EmptySet]", "[", "Global`t", "]"}], ",", 
                "1"}], "}"}], "}"}]}], "]"}]}], ";"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"r", "=", 
           RowBox[{"Complement", "[", 
            RowBox[{"r", ",", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{"Global`\[EmptySet]", ",", "1"}], "}"}], "}"}]}], 
            "]"}]}], ";"}]}], " ", "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "r", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], " ", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     StyleBox["parseReactants",
      FontColor->RGBColor[0, 0, 1]], "[", "x__", "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<Unable to parse the expression:\>\"", ",", " ", "x", ",", " ", 
         "\"\< in the reaction \>\"", ",", " ", "reaction"}], "]"}], ";", " ",
        "\[IndentingNewLine]", 
       RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], " "}]}], "Input",
 InitializationCell->True],

Cell["\<\
expandArrows: A\[ShortRightArrow]B  (mass action)\
\>", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"expandArrows", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ShortRightArrow", "[", 
      RowBox[{"substrateExpression_", ",", "productExpression_"}], "]"}], " ",
      ",", 
     RowBox[{"rate___", ":", "1"}]}], "}"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"reaction", ",", " ", "k"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"reaction", " ", "=", " ", 
      RowBox[{
      "substrateExpression", "\[ShortRightArrow]", "productExpression"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"dbgArrows", ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<expandArrows:\>\"", ",", " ", "reaction"}], "]"}]}], 
      "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"k", "=", 
      RowBox[{
       RowBox[{"{", "rate", "}"}], "//", "Flatten"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "k", "]"}], "<", "1"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"k", "=", "1"}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "k", "]"}], ">", "1"}], ",", " ", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<Warning: Extra rate constants \>\"", ",", " ", 
            RowBox[{"Drop", "[", 
             RowBox[{"k", ",", "1"}], "]"}], ",", "\"\< in the reaction \>\"",
             ",", " ", "reaction", ",", " ", "\"\< will be ignored.\>\""}], 
           "]"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"First", "[", "k", "]"}]}]}]}], "\[IndentingNewLine]", "]"}],
      ";", " ", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"reaction", ",", "k"}], "}"}], "}"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.401033674504552*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
expandArrows: A\[ShortRightArrow]B  (mass action)\
\>", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"expandArrows", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ShortRightArrow", "[", 
      RowBox[{"substrateExpression_", ",", "productExpression_"}], " ", "]"}],
      ",", 
     RowBox[{"rate___", ":", "1"}]}], "}"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"reaction", ",", " ", "k", ",", " ", "lhs", ",", " ", "rhs"}], 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"lhs", " ", "=", " ", 
      RowBox[{"ListToSum", "[", "substrateExpression", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"rhs", "=", 
      RowBox[{"ListToSum", "[", "productExpression", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"reaction", " ", "=", " ", 
      RowBox[{"ShortRightArrow", "[", 
       RowBox[{"lhs", ",", "rhs"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"dbgArrows", ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<expandArrows:\>\"", ",", " ", "reaction"}], "]"}]}], 
      "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"k", "=", 
      RowBox[{
       RowBox[{"{", "rate", "}"}], "//", "Flatten"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "k", "]"}], "<", "1"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"k", "=", "1"}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "k", "]"}], ">", "1"}], ",", " ", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<Warning: Extra rate constants \>\"", ",", " ", 
            RowBox[{"Drop", "[", 
             RowBox[{"k", ",", "1"}], "]"}], ",", "\"\< in the reaction \>\"",
             ",", " ", "reaction", ",", " ", "\"\< will be ignored.\>\""}], 
           "]"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"First", "[", "k", "]"}]}]}]}], "\[IndentingNewLine]", "]"}],
      ";", " ", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"reaction", ",", "k"}], "}"}], "}"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.401033674621236*^9, 3.401033674687853*^9}, {
  3.427491894208405*^9, 3.427491924825873*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
parseArrowForm: A\[ShortRightArrow]B  (mass action)\
\>", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"parseArrowForm", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ShortRightArrow", "[", 
      RowBox[{"substrateExpression_", ",", "productExpression_"}], " ", "]"}],
      ",", 
     RowBox[{"rate___", ":", "1"}]}], "}"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "parseExpression", ",", " ", "reaction", ",", " ", "input", ",", " ", 
      "output", ",", " ", "klaw", ",", "species", ",", " ", "nspecies", ",", 
      " ", 
      RowBox[{"dbg", "=", "False"}], ",", " ", "netStoichiometry", ",", " ", 
      "rates", ",", "odes", ",", " ", "k"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"reaction", " ", "=", " ", 
      RowBox[{"ShortRightArrow", "[", 
       RowBox[{"substrateExpression", ",", "productExpression"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"dbgArrows", ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<parseArrowForm:\>\"", ",", " ", "reaction"}], "]"}]}], 
      "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"reaction", ",", "k"}], "}"}], "=", 
      RowBox[{
       RowBox[{"expandArrows", "[", 
        RowBox[{"{", 
         RowBox[{"reaction", ",", "rate"}], "}"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"dbg", ",", " ", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<reaction: \>\"", " ", ",", "reaction", ",", " ", 
         "\"\<\\nsubstrateExpression: \>\"", ",", " ", "substrateExpression", 
         ",", " ", "\"\<\\nproductExpression: \>\"", ",", " ", 
         "productExpression"}], "]"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"input", "=", 
      RowBox[{
       StyleBox["parseReactants",
        FontColor->RGBColor[0, 0, 1]], "[", 
       RowBox[{"True", ",", "substrateExpression"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{
       StyleBox["parseReactants",
        FontColor->RGBColor[0, 0, 1]], "[", 
       RowBox[{"True", ",", " ", "productExpression"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"klaw", "=", 
      RowBox[{"k", "*", 
       RowBox[{"Times", "@@", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Power", "@@", "#"}], "&"}], ",", "input"}], "]"}]}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"klaw", " ", "=", " ", 
      RowBox[{"klaw", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Global`\[EmptySet]", "[", "Global`t", "]"}], "\[Rule]", " ",
          "1"}], "}"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"dbg", ",", " ", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<input: \>\"", ",", " ", "input", ",", "\"\<\\noutput:\>\"", ",", 
         " ", "output", ",", " ", "\"\<\\nklaw: \>\"", ",", " ", "klaw"}], 
        "]"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       StyleBox["netStoichiometry",
        FontColor->RGBColor[0, 0, 1]], "[", "x_", "]"}], ":=", " ", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"in", ",", "out"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"in", " ", "=", " ", 
          RowBox[{"Cases", "[", 
           RowBox[{"input", ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "_"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "in", "]"}], "<", "1"}], ",", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"in", " ", "=", " ", "0"}], ",", " ", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"in", " ", "=", " ", 
             RowBox[{"Transpose", "[", "in", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"in", "=", 
             RowBox[{"Plus", "@@", 
              RowBox[{"in", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"out", "=", 
          RowBox[{"Cases", "[", 
           RowBox[{"output", ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "_"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "out", "]"}], "<", "1"}], ",", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"out", " ", "=", " ", "0"}], ",", " ", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"out", " ", "=", " ", 
             RowBox[{"Transpose", "[", "out", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"out", "=", 
             RowBox[{"Plus", "@@", 
              RowBox[{"out", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"out", "-", "in"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "]"}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"end", " ", 
       StyleBox["netStoichiometry",
        FontColor->RGBColor[0, 0, 1]]}], 
      StyleBox[" ",
       FontColor->RGBColor[0, 0, 1]], "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"species", "=", 
      RowBox[{"Union", "[", 
       RowBox[{
        RowBox[{"First", "/@", "input"}], ",", " ", 
        RowBox[{"First", "/@", "output"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"rates", "=", 
      RowBox[{"klaw", "*", 
       RowBox[{"netStoichiometry", "/@", "species"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"dbg", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<input stoichiometry:\>\"", ",", "input"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<klaw=\>\"", ",", "klaw"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<output stoichiometry:\>\"", ",", "output"}], "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<species:\>\"", ",", " ", "species"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<rates:\>\"", ",", "rates"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"odes", " ", "=", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"species", ",", "rates"}], "}"}], "//", "Transpose"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "odes", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4010336747911167`*^9, 3.401033674857809*^9}, {
  3.427488832485235*^9, 3.427488833129921*^9}, {3.427489181433503*^9, 
  3.42748922143582*^9}, {3.427489316339744*^9, 3.427489342955276*^9}, {
  3.427490761682662*^9, 3.427490762419267*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
expandArrows: A\[RightArrowLeftArrow]B  (mass action)\
\>", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"expandArrows", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"RightArrowLeftArrow", "[", 
      RowBox[{"X_", ",", "Y_"}], " ", "]"}], ",", "k___"}], "}"}], "]"}], ":=",
   " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "forward", ",", " ", "reverse", ",", "kf", ",", "kr", ",", "rates", ",", 
      "reaction"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"reaction", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"RightArrowLeftArrow", "[", 
         RowBox[{"X", ",", "Y"}], "]"}], ",", "k"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"dbgArrows", ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<expandArrows:\>\"", ",", " ", "reaction"}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"rates", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"{", "k", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "rates", "]"}], "<", "2"}], ",", " ", 
       RowBox[{"rates", "=", 
        RowBox[{"Append", "[", 
         RowBox[{"rates", ",", "1"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "rates", "]"}], ">", "2"}], ",", " ", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Warning: extra rate constants \>\"", ",", " ", 
         RowBox[{"Drop", "[", 
          RowBox[{"rates", ",", "2"}], "]"}], ",", 
         "\"\< in the reaction \>\"", ",", " ", "reaction", ",", " ", 
         "\"\< will be ignored.\>\""}], "]"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"rates", "=", 
      RowBox[{"Take", "[", 
       RowBox[{"rates", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"kf", ",", "kr"}], "}"}], "=", "rates"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"forward", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ShortRightArrow", "[", 
         RowBox[{"X", ",", " ", "Y"}], "]"}], ",", "kf"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"reverse", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ShortRightArrow", "[", 
         RowBox[{"Y", ",", "X"}], "]"}], ",", "kr"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"dbgArrows", ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<expandArrows:\>\"", ",", " ", 
         RowBox[{"{", 
          RowBox[{"forward", ",", " ", "reverse"}], "}"}]}], "]"}]}], "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{"forward", ",", " ", "reverse"}], "}"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.401033675139592*^9, 3.401033703444055*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
parseArrowForm: A\[RightArrowLeftArrow]B  (mass action)\
\>", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"parseArrowForm", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"RightArrowLeftArrow", "[", 
      RowBox[{"X_", ",", "Y_"}], " ", "]"}], ",", "k___"}], "}"}], "]"}], ":=",
   " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "forward", ",", " ", "reverse", ",", " ", "odes", ",", "reaction"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"reaction", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"RightArrowLeftArrow", "[", 
         RowBox[{"X", ",", "Y"}], "]"}], ",", "k"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"forward", ",", " ", "reverse"}], "}"}], "=", 
      RowBox[{"parseArrowForm", "/@", 
       RowBox[{"expandArrows", "[", "reaction", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"odes", " ", "=", " ", 
      RowBox[{"Join", "[", 
       RowBox[{"forward", ",", " ", "reverse"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "odes", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.401033703811804*^9, 3.401033703911376*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
expandArrows: Cascade A\[ShortRightArrow]B\[ShortRightArrow]C\
\[ShortRightArrow]...\
\>", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"expandArrows", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ShortRightArrow", "[", 
      RowBox[{"X_", ",", "Y_", " ", ",", " ", "Z__"}], "]"}], ",", 
     "rates___"}], "}"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", " ", 
     RowBox[{
     "reaction", ",", "reactants", ",", " ", "k", ",", " ", "nreactions", ",",
       "reactions", ",", " ", "nrates"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"reactants", "=", 
      RowBox[{"{", 
       RowBox[{"X", ",", "Y", ",", "Z"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"reaction", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ShortRightArrow", "@@", "reactants"}], ",", "rates"}], 
       "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"dbgArrows", ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<parseArrowForm:\>\"", ",", " ", "reaction"}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"reactions", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{"reactants", ",", "2", ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nreactions", "=", 
      RowBox[{"Length", "[", "reactions", "]"}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"k", "=", 
      RowBox[{"{", "rates", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "k", "]"}], ">", "nreactions"}], ",", 
       "\[IndentingNewLine]", " ", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Warning: Extra rate constants \>\"", ",", " ", 
          RowBox[{"Drop", "[", 
           RowBox[{"k", ",", "nreactions"}], "]"}], ",", 
          "\"\< in the reaction \>\"", ",", " ", "reaction", ",", " ", 
          "\"\< will be ignored.\>\""}], "]"}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Take", "[", 
          RowBox[{"k", ",", "nreactions"}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"k", "=", 
      RowBox[{"PadRight", "[", 
       RowBox[{"k", ",", "nreactions", ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"reactions", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ShortRightArrow", "@@", "#1"}], ",", "#2"}], "}"}], "&"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"reactions", ",", "k"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "reactions", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.401033675307131*^9, 3.40103367544069*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
parseArrowForm: Cascade A\[ShortRightArrow]B\[ShortRightArrow]C\
\[ShortRightArrow]...\
\>", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"parseArrowForm", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ShortRightArrow", "[", 
      RowBox[{"X_", ",", "Y_", " ", ",", " ", "Z__"}], "]"}], ",", 
     "rates___"}], "}"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", " ", 
     RowBox[{"odes", ",", "reactions"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"reactions", "=", 
      RowBox[{"expandArrows", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ShortRightArrow", "[", 
          RowBox[{"X", ",", "Y", ",", " ", "Z"}], "]"}], ",", "rates"}], 
        "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"odes", "=", 
      RowBox[{"Join", "@@", 
       RowBox[{"(", 
        RowBox[{"parseArrowForm", "/@", "reactions"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "odes", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.401033675557715*^9, 3.4010336756270523`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
expandArrows: Cascade A\[RightArrowLeftArrow]B\[RightArrowLeftArrow]C\
\[RightArrowLeftArrow]...\
\>", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"expandArrows", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"RightArrowLeftArrow", "[", 
      RowBox[{"X_", ",", "Y_", " ", ",", " ", "Z__"}], "]"}], ",", 
     "rates___"}], "}"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", " ", 
     RowBox[{
     "odes", ",", "reaction", ",", "reactants", ",", " ", "k", ",", " ", 
      "nreactions", ",", "reactions", ",", " ", "nrates"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"reactants", "=", 
      RowBox[{"{", 
       RowBox[{"X", ",", "Y", ",", "Z"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"reaction", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"RightArrowLeftArrow", "@@", "reactants"}], ",", "rates"}], 
       "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"dbgArrows", ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<expandArrows:\>\"", ",", " ", "reaction"}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"reactions", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{"reactants", ",", "2", ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nreactions", "=", 
      RowBox[{"Length", "[", "reactions", "]"}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"k", "=", 
      RowBox[{"{", "rates", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "k", "]"}], ">", 
        RowBox[{"2", "*", "nreactions"}]}], ",", "\[IndentingNewLine]", " ", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Warning: Extra rate constants \>\"", ",", " ", 
          RowBox[{"Drop", "[", 
           RowBox[{"k", ",", 
            RowBox[{"2", "*", "nreactions"}]}], "]"}], ",", 
          "\"\< in the reaction \>\"", ",", " ", "reaction", ",", " ", 
          "\"\< will be ignored.\>\""}], "]"}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Take", "[", 
          RowBox[{"k", ",", 
           RowBox[{"2", "*", "nreactions"}]}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"k", "=", 
      RowBox[{"PadRight", "[", 
       RowBox[{"k", ",", 
        RowBox[{"2", "*", "nreactions"}], ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"k", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{"k", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"reactions", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"RightArrowLeftArrow", "@@", "#1"}], ",", 
           RowBox[{"Sequence", "@@", "#2"}]}], "}"}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{"reactions", ",", "k"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "reactions", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.401033704062364*^9, 3.4010337042633533`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
parseArrowForm: Cascade A\[RightArrowLeftArrow]B\[RightArrowLeftArrow]C\
\[RightArrowLeftArrow]...\
\>", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"parseArrowForm", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"RightArrowLeftArrow", "[", 
      RowBox[{"X_", ",", "Y_", " ", ",", " ", "Z__"}], "]"}], ",", 
     "rates___"}], "}"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", " ", 
     RowBox[{
     "odes", ",", "reaction", ",", "reactants", ",", " ", "k", ",", " ", 
      "nreactions", ",", "reactions", ",", " ", "nrates"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"reactions", "=", 
      RowBox[{"expandArrows", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"RightArrowLeftArrow", "[", 
          RowBox[{"X", ",", "Y", " ", ",", " ", "Z"}], "]"}], ",", "rates"}], 
        "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"odes", "=", 
      RowBox[{"Join", "@@", 
       RowBox[{"(", 
        RowBox[{"parseArrowForm", "/@", "reactions"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "odes", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.401033704414057*^9, 3.401033704530951*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "expandArrows",
 ": ",
 Cell[BoxData[
  FormBox[
   OverscriptBox[
    RowBox[{"A", "\[ShortRightArrow]", "B"}], "C"], TraditionalForm]]],
 "  (mass action for A+C\[ShortRightArrow]B+C)"
}], "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"expandArrows", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Overscript", "[", 
      RowBox[{
       RowBox[{"ShortRightArrow", "[", 
        RowBox[{"X_", ",", "Y_"}], " ", "]"}], ",", "Z_"}], "]"}], ",", 
     "rates___"}], "}"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"reaction", ",", "k"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"reaction", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Overscript", "[", 
         RowBox[{
          RowBox[{"ShortRightArrow", "[", 
           RowBox[{"X", ",", "Y"}], "]"}], ",", "Z"}], "]"}], ",", "rates"}], 
       "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"dbgArrows", ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<expandArrows:\>\"", ",", " ", "reaction"}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"k", "=", 
      RowBox[{
       RowBox[{"{", "rates", "}"}], "//", "Flatten"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "k", "]"}], "<", "1"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"k", "=", "1"}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "k", "]"}], ">", "1"}], ",", " ", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<Warning: Extra rate constants \>\"", ",", " ", 
            RowBox[{"Drop", "[", 
             RowBox[{"k", ",", "1"}], "]"}], ",", "\"\< in the reaction \>\"",
             ",", " ", "reaction", ",", " ", "\"\< will be ignored.\>\""}], 
           "]"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"First", "[", "k", "]"}]}]}]}], "\[IndentingNewLine]", "]"}],
      ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"reaction", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ShortRightArrow", "[", 
         RowBox[{
          RowBox[{"X", "+", "Z"}], ",", " ", 
          RowBox[{"Y", "+", "Z"}]}], "]"}], ",", "k"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", "reaction", "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.401033675727049*^9, 3.401033675858974*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "parseArrowForm: ",
 Cell[BoxData[
  FormBox[
   OverscriptBox[
    RowBox[{"A", "\[ShortRightArrow]", "B"}], "C"], TraditionalForm]]],
 "  (mass action for A+C\[ShortRightArrow]B+C)"
}], "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"parseArrowForm", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Overscript", "[", 
      RowBox[{
       RowBox[{"ShortRightArrow", "[", 
        RowBox[{"X_", ",", "Y_"}], " ", "]"}], ",", "Z_"}], "]"}], ",", 
     "rates___"}], "}"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", " ", 
     RowBox[{"odes", ",", "reaction"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"reaction", "=", 
      RowBox[{"expandArrows", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Overscript", "[", 
          RowBox[{
           RowBox[{"ShortRightArrow", "[", 
            RowBox[{"X", ",", "Y"}], "]"}], ",", "Z"}], "]"}], ",", "rates"}],
         "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"odes", "=", 
      RowBox[{"parseArrowForm", "[", "reaction", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "odes", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4010336759781847`*^9, 3.4010336760449467`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "expandArrows",
 ": Cascade ",
 Cell[BoxData[
  FormBox[
   OverscriptBox[
    RowBox[{
     RowBox[{
     "A", "\[ShortRightArrow]", "B", "\[ShortRightArrow]", "C", 
      "\[ShortRightArrow]"}], "..."}], "M"], TraditionalForm]]],
 " or ",
 Cell[BoxData[
  FormBox[
   OverscriptBox[
    RowBox[{
     RowBox[{
     "A", "\[ShortRightArrow]", "B", "\[ShortRightArrow]", "C", 
      "\[ShortRightArrow]"}], "..."}], 
    RowBox[{"{", 
     RowBox[{"M1", ",", "M2", ",", "..."}], "}"}]], TraditionalForm]]],
 " "
}], "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"expandArrows", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Overscript", "[", 
      RowBox[{
       RowBox[{"ShortRightArrow", "[", 
        RowBox[{"X_", ",", "Y_", " ", ",", " ", "Z__"}], "]"}], ",", 
       "modifiers_"}], "]"}], ",", "rates___"}], "}"}], "]"}], ":=", " ", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", " ", 
     RowBox[{
     "reaction", ",", "reactants", ",", " ", "k", ",", " ", "nreactions", ",",
       "reactions", ",", " ", "nrates", ",", "modifierList", ",", "nmods", 
      ",", "m1"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"reactants", "=", 
      RowBox[{"{", 
       RowBox[{"X", ",", "Y", ",", "Z"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"reaction", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Overscript", "[", 
         RowBox[{
          RowBox[{"ShortRightArrow", "@@", "reactants"}], ",", "modifiers"}], 
         "]"}], ",", "rates"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"dbgArrows", ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<expandArrows:\>\"", ",", " ", "reaction"}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"modifierList", "=", 
      RowBox[{
       RowBox[{"{", "modifiers", "}"}], "//", "Flatten"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "modifierList", "]"}], "<", "1"}], ",", " ", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Error: At least one modifier must be specified for:\>\"", ",", 
          "reaction"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"{", "}"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"reactions", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{"reactants", ",", "2", ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nreactions", "=", 
      RowBox[{"Length", "[", "reactions", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nmod", "=", 
      RowBox[{"Length", "[", "modifierList", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"nmod", ">", "nreactions"}], ",", " ", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Warning: Extra modifiers \>\"", ",", " ", 
          RowBox[{"Drop", "[", 
           RowBox[{"modifierList", ",", "nreactions"}], "]"}], ",", 
          "\"\< in the reation \>\"", ",", " ", "reaction", ",", 
          "\"\< will be ignored.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"modifierList", "=", 
         RowBox[{"Take", "[", 
          RowBox[{"modifierList", ",", "nreactions"}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"m1", "=", 
      RowBox[{"First", "[", "modifierList", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"modifierList", "=", 
        RowBox[{"PadRight", "[", 
         RowBox[{"modifierList", ",", "nreactions", ",", " ", "m1"}], "]"}]}],
        ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "modifierList", "]"}], "<", "nreactions"}], 
       ",", " ", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"modifierList", ",", " ", "m1"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"k", "=", 
      RowBox[{"{", "rates", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "k", "]"}], ">", "nreactions"}], ",", 
       "\[IndentingNewLine]", " ", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Warning: Extra rate constants \>\"", ",", " ", 
          RowBox[{"Drop", "[", 
           RowBox[{"k", ",", "nreactions"}], "]"}], ",", 
          "\"\< in the reaction \>\"", ",", " ", "reaction", ",", " ", 
          "\"\< will be ignored.\>\""}], "]"}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Take", "[", 
          RowBox[{"k", ",", "nreactions"}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"k", "=", 
      RowBox[{"PadRight", "[", 
       RowBox[{"k", ",", "nreactions", ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"reactions", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Overscript", "[", 
            RowBox[{
             RowBox[{"ShortRightArrow", "@@", "#1"}], ",", "#2"}], "]"}], ",",
            "#3"}], "}"}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{"reactions", ",", "modifierList", ",", "k"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"reactions", "=", 
      RowBox[{"Join", "@@", 
       RowBox[{"(", 
        RowBox[{"expandArrows", "/@", "reactions"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "reactions", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4010336761454763`*^9, 3.401033676296117*^9}, {
  3.555506416645832*^9, 3.555506425464477*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "parseArrowForm: Cascade ",
 Cell[BoxData[
  FormBox[
   OverscriptBox[
    RowBox[{
     RowBox[{
     "A", "\[ShortRightArrow]", "B", "\[ShortRightArrow]", "C", 
      "\[ShortRightArrow]"}], "..."}], "M"], TraditionalForm]]],
 " or ",
 Cell[BoxData[
  FormBox[
   OverscriptBox[
    RowBox[{
     RowBox[{
     "A", "\[ShortRightArrow]", "B", "\[ShortRightArrow]", "C", 
      "\[ShortRightArrow]"}], "..."}], 
    RowBox[{"{", 
     RowBox[{"M1", ",", "M2", ",", "..."}], "}"}]], TraditionalForm]]],
 " "
}], "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"parseArrowForm", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Overscript", "[", 
      RowBox[{
       RowBox[{"ShortRightArrow", "[", 
        RowBox[{"X_", ",", "Y_", " ", ",", " ", "Z__"}], "]"}], ",", 
       "modifiers_"}], "]"}], ",", "rates___"}], "}"}], "]"}], ":=", " ", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", " ", 
     RowBox[{"odes", ",", "reactions"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"reactions", "=", 
      RowBox[{"expandArrows", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Overscript", "[", 
          RowBox[{
           RowBox[{"ShortRightArrow", "[", 
            RowBox[{"X", ",", "Y", ",", " ", "Z"}], "]"}], ",", "modifiers"}],
           "]"}], ",", "rates"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"odes", "=", 
      RowBox[{"Join", "@@", 
       RowBox[{"(", 
        RowBox[{"parseArrowForm", "/@", "reactions"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "odes", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.401033676396615*^9, 3.40103367647966*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "expandArrows",
 ": ",
 Cell[BoxData[
  FormBox[
   OverscriptBox[
    RowBox[{"A", "\[RightArrowLeftArrow]", "B"}], "C"], TraditionalForm]]],
 "  (mass action for A+E\[RightArrowLeftArrow]AE\[RightArrowLeftArrow]B+E or \
A+E\[RightArrowLeftArrow]AE\[ShortRightArrow]B+E)"
}], "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"expandArrows", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Overscript", "[", 
       RowBox[{
        RowBox[{"RightArrowLeftArrow", "[", 
         RowBox[{"X_", ",", "Y_"}], " ", "]"}], ",", "En_"}], "]"}], ",", 
      "k___"}], "}"}], "]"}], ":=", " ", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "a", ",", "d", ",", "kf", ",", "kr", ",", "r1", ",", "r2", ",", "r3", 
       ",", "r4", ",", " ", "reactions", ",", " ", "rates"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"reaction", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Overscript", "[", 
          RowBox[{
           RowBox[{"RightArrowLeftArrow", "[", 
            RowBox[{"X", ",", "Y"}], "]"}], ",", "En"}], "]"}], ",", "k"}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"dbgArrows", ",", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<expandArrows (single input):\>\"", ",", " ", "reaction"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"rates", "=", 
       RowBox[{
        RowBox[{"{", "k", "}"}], "//", "Flatten"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "rates", "]"}], "<", "3"}], ",", " ", 
        RowBox[{"rates", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"rates", ",", "1"}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "rates", "]"}], "<", "4"}], ",", " ", 
        RowBox[{"rates", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"rates", ",", "0"}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "rates", "]"}], ">", "4"}], ",", " ", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Warning: the extra rate constants \>\"", ",", 
           RowBox[{"Drop", "[", 
            RowBox[{"rates", ",", "4"}], "]"}], ",", 
           "\"\< will be ignored in the reaction \>\"", ",", "reaction"}], 
          "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"rates", "=", 
       RowBox[{"Take", "[", 
        RowBox[{"rates", ",", "4"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "d", ",", "kf", ",", "kr"}], "}"}], "=", "rates"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"dbgArrows", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<expandArrows (single rates):\>\"", ",", " ", "rates"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"dbgArrows", ",", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<expandArrows single (X, Length[X], Y, Length[Y]):\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"X", ",", " ", 
            RowBox[{"Length", "[", "X", "]"}], ",", " ", "Y", ",", " ", 
            RowBox[{"Length", "[", "Y", "]"}]}], "}"}]}], "]"}]}], "]"}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"dbgArrows", ",", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<expandArrows single (X, Length[X/.{Plus\[Rule] List}], Y, \
Length[Y/.{Plus\[Rule] List}]):\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"X", ",", " ", 
            RowBox[{"Length", "[", 
             RowBox[{"X", "/.", 
              RowBox[{"{", 
               RowBox[{"Plus", "\[Rule]", " ", "List"}], "}"}]}], "]"}], ",", 
            " ", "Y", ",", " ", 
            RowBox[{"Length", "[", 
             RowBox[{"Y", "/.", 
              RowBox[{"{", 
               RowBox[{"Plus", "\[Rule]", " ", "List"}], "}"}]}], "]"}]}], 
           "}"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", "X", "}"}], "//", "Flatten"}], ")"}], "/.", 
            RowBox[{"{", 
             RowBox[{"Plus", "\[Rule]", " ", "List"}], "}"}]}], "]"}], ">", 
          "1"}], " ", "\[Or]", " ", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", "Y", "}"}], "//", "Flatten"}], ")"}], "/.", 
            RowBox[{"{", 
             RowBox[{"Plus", "\[Rule]", " ", "List"}], "}"}]}], "]"}], ">", 
          "1"}]}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<The reaction \>\"", ",", 
           RowBox[{"Overscript", "[", 
            RowBox[{
             RowBox[{"RightArrowLeftArrow", "[", 
              RowBox[{"X", ",", "Y"}], "]"}], ",", "En"}], "]"}], ",", 
           "\"\< is not correctly formatted: too many reactants or \
products.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"{", "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"r1", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ShortRightArrow", "[", 
          RowBox[{
           RowBox[{"X", "+", "En"}], ",", 
           RowBox[{"setBinding", "[", 
            RowBox[{"X", ",", "En"}], "]"}]}], "]"}], ",", "a"}], "}"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"r2", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ShortRightArrow", "[", 
          RowBox[{
           RowBox[{"setBinding", "[", 
            RowBox[{"X", ",", "En"}], "]"}], ",", " ", 
           RowBox[{"X", "+", "En"}]}], "]"}], ",", "d"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"r3", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ShortRightArrow", "[", 
          RowBox[{
           RowBox[{"setBinding", "[", 
            RowBox[{"X", ",", "En"}], "]"}], ",", " ", 
           RowBox[{"Y", "+", "En"}]}], "]"}], ",", "kf"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"reactions", "=", 
       RowBox[{"{", 
        RowBox[{"r1", ",", "r2", ",", "r3"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"\[Not]", 
         RowBox[{"(", 
          RowBox[{"kr", "===", "0"}], ")"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"r4", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ShortRightArrow", "[", 
             RowBox[{
              RowBox[{"Y", "+", "En"}], ",", 
              RowBox[{"setBinding", "[", 
               RowBox[{"X", ",", "En"}], "]"}]}], "]"}], ",", "kr"}], "}"}]}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"reactions", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"reactions", ",", "r4"}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"dbgArrows", ",", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<expandArrows (single: return reactions):\>\"", ",", " ", 
          "reactions"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "reactions", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4010336765973473`*^9, 3.40103370488183*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "parseArrowForm: ",
 Cell[BoxData[
  FormBox[
   OverscriptBox[
    RowBox[{"A", "\[RightArrowLeftArrow]", "B"}], "C"], TraditionalForm]]],
 "  (mass action for A+E\[RightArrowLeftArrow]AE\[RightArrowLeftArrow]B+E or \
A+E\[RightArrowLeftArrow]AE\[ShortRightArrow]B+E)"
}], "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"parseArrowForm", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Overscript", "[", 
       RowBox[{
        RowBox[{"RightArrowLeftArrow", "[", 
         RowBox[{"X_", ",", "Y_"}], " ", "]"}], ",", "En_"}], "]"}], ",", 
      "k___"}], "}"}], "]"}], ":=", " ", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"reaction", ",", "reactions", ",", "odes"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"reaction", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Overscript", "[", 
          RowBox[{
           RowBox[{"RightArrowLeftArrow", "[", 
            RowBox[{"X", ",", "Y"}], "]"}], ",", "En"}], "]"}], ",", "k"}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"reactions", " ", "=", " ", 
       RowBox[{"expandArrows", "[", "reaction", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"odes", " ", "=", 
       RowBox[{"Join", "@@", 
        RowBox[{"(", " ", 
         RowBox[{"parseArrowForm", "/@", "reactions"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "odes", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.401033705049602*^9, 3.401033705149337*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "expandArrows",
 ": Cascade ",
 Cell[BoxData[
  FormBox[
   OverscriptBox[
    RowBox[{
     RowBox[{
     "A", "\[RightArrowLeftArrow]", "B", "\[RightArrowLeftArrow]", "C", 
      "\[RightArrowLeftArrow]"}], "..."}], "M"], TraditionalForm]]],
 " or ",
 Cell[BoxData[
  FormBox[
   OverscriptBox[
    RowBox[{
     RowBox[{
     "A", "\[RightArrowLeftArrow]", "B", "\[RightArrowLeftArrow]", "C", 
      "\[RightArrowLeftArrow]"}], "..."}], 
    RowBox[{"{", 
     RowBox[{"M1", ",", "M2", ",", "..."}], "}"}]], TraditionalForm]]],
 " "
}], "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"expandArrows", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Overscript", "[", 
      RowBox[{
       RowBox[{"RightArrowLeftArrow", "[", 
        RowBox[{"X_", ",", "Y_", " ", ",", " ", "Z__"}], "]"}], ",", 
       "modifiers_"}], "]"}], ",", "rates___"}], "}"}], "]"}], ":=", " ", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", " ", 
     RowBox[{
     "odes", ",", "reaction", ",", "reactants", ",", " ", "k", ",", " ", 
      "nreactions", ",", "reactions", ",", " ", "nrates", ",", "modifierList",
       ",", "nmods", ",", "m1", ",", "lastset"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"reactants", "=", 
      RowBox[{"{", 
       RowBox[{"X", ",", "Y", ",", "Z"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"reaction", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Overscript", "[", 
         RowBox[{
          RowBox[{"RightArrowLeftArrow", "@@", "reactants"}], ",", 
          "modifiers"}], "]"}], ",", "rates"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"dbgArrows", ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<expandArrows (cascade):\>\"", ",", " ", "reaction"}], 
        "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"modifierList", "=", 
      RowBox[{
       RowBox[{"{", "modifiers", "}"}], "//", "Flatten"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"dbgArrows", ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<expandArrows (cascade: modifierList):\>\"", ",", " ", 
         "modifierList"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "modifierList", "]"}], "<", "1"}], ",", " ", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Error: At least one modifier must be specified for:\>\"", ",", 
          "reaction"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"{", "}"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"reactions", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{"reactants", ",", "2", ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nreactions", "=", 
      RowBox[{"Length", "[", "reactions", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nmod", "=", 
      RowBox[{"Length", "[", "modifierList", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"nmod", ">", "nreactions"}], ",", " ", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Warning: Extra modifiers \>\"", ",", " ", 
          RowBox[{"Drop", "[", 
           RowBox[{"modifierList", ",", "nreactions"}], "]"}], ",", 
          "\"\< in the reation \>\"", ",", " ", "reaction", ",", 
          "\"\< will be ignored.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"modifierList", "=", 
         RowBox[{"Take", "[", 
          RowBox[{"modifierList", ",", "nreactions"}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"m1", "=", 
      RowBox[{"Last", "[", "modifierList", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"modifierList", "=", 
        RowBox[{"PadRight", "[", 
         RowBox[{"modifierList", ",", "nreactions", ",", " ", "m1"}], "]"}]}],
        ";"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "modifierList", "]"}], "<", "nreactions"}], 
       ",", " ", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"modifierList", ",", " ", "m1"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"dbgArrows", ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<expandArrows (cascade: modifierList):\>\"", ",", " ", 
         "modifierList"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"k", "=", 
      RowBox[{
       RowBox[{"{", "rates", "}"}], "//", "Flatten"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "k", "]"}], "\[Equal]", "0"}], ",", " ", 
       RowBox[{"k", "=", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "}"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "k", "]"}], "<", "3"}], ",", " ", 
       RowBox[{"k", "=", 
        RowBox[{"PadRight", "[", 
         RowBox[{"k", ",", "3", ",", "1"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "k", "]"}], "<", "4"}], ",", " ", 
       RowBox[{"k", "=", 
        RowBox[{"PadRight", "[", 
         RowBox[{"k", ",", "4", ",", "0"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "k", "]"}], ">", 
        RowBox[{"4", "*", "nreactions"}]}], ",", " ", 
       RowBox[{"k", "=", 
        RowBox[{"Take", "[", 
         RowBox[{"k", ",", 
          RowBox[{"4", "*", "nreactions"}]}], "]"}]}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{"Length", "[", "k", "]"}], ",", "4"}], "]"}], "\[NotEqual]",
         " ", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "k", "]"}], "+", "1"}], ",", "4"}], 
            "]"}], "\[NotEqual]", " ", "0"}], ",", " ", 
          RowBox[{"k", "=", 
           RowBox[{"Append", "[", 
            RowBox[{"k", ",", "1"}], "]"}]}]}], "]"}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"k", ",", "0"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"lastset", "=", 
      RowBox[{"Take", "[", 
       RowBox[{"k", ",", 
        RowBox[{"-", "4"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "k", "]"}], "<", 
        RowBox[{"4", "*", "nreactions"}]}], ",", 
       RowBox[{"k", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"k", ",", "lastset"}], "]"}]}]}], "]"}], ";", "  ", 
     "\[IndentingNewLine]", 
     RowBox[{"k", "=", 
      RowBox[{"Flatten", "[", "k", "]"}]}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"k", " ", "=", " ", 
      RowBox[{"Partition", "[", 
       RowBox[{"k", ",", "4"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"reactions", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Overscript", "[", 
            RowBox[{
             RowBox[{"RightArrowLeftArrow", "@@", "#1"}], ",", "#2"}], "]"}], 
           ",", 
           RowBox[{"Sequence", "@@", "#3"}]}], "}"}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{"reactions", ",", "modifierList", ",", "k"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"reactions", "=", 
      RowBox[{"Join", "@@", 
       RowBox[{"(", 
        RowBox[{"expandArrows", "/@", "reactions"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "reactions", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4010337053004503`*^9, 3.401033705518117*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "parseArrowForm: Cascade ",
 Cell[BoxData[
  FormBox[
   OverscriptBox[
    RowBox[{
     RowBox[{
     "A", "\[RightArrowLeftArrow]", "B", "\[RightArrowLeftArrow]", "C", 
      "\[RightArrowLeftArrow]"}], "..."}], "M"], TraditionalForm]]],
 " or ",
 Cell[BoxData[
  FormBox[
   OverscriptBox[
    RowBox[{
     RowBox[{
     "A", "\[RightArrowLeftArrow]", "B", "\[RightArrowLeftArrow]", "C", 
      "\[RightArrowLeftArrow]"}], "..."}], 
    RowBox[{"{", 
     RowBox[{"M1", ",", "M2", ",", "..."}], "}"}]], TraditionalForm]]],
 " "
}], "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"parseArrowForm", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Overscript", "[", 
      RowBox[{
       RowBox[{"RightArrowLeftArrow", "[", 
        RowBox[{"X_", ",", "Y_", " ", ",", " ", "Z__"}], "]"}], ",", 
       "modifiers_"}], "]"}], ",", "rates___"}], "}"}], "]"}], ":=", " ", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", " ", 
     RowBox[{"odes", ",", "reaction", ",", "reactions"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"reactants", "=", 
      RowBox[{"{", 
       RowBox[{"X", ",", "Y", ",", "Z"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"dbgArrows", ",", " ", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<*** parseArrowForm (cascade): {reactants}:\>\"", ",", " ", 
         RowBox[{"{", "reactants", "}"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"reaction", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Overscript", "[", 
         RowBox[{
          RowBox[{"RightArrowLeftArrow", "@@", "reactants"}], ",", 
          "modifiers"}], "]"}], ",", "rates"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"dbgArrows", ",", " ", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<*** parseArrowForm (cascade): {reaction}:\>\"", ",", " ", 
         RowBox[{"{", "reaction", "}"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"reactions", "=", 
      RowBox[{"expandArrows", "[", "reaction", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"dbgArrows", ",", " ", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<*** parseArrowForm (cascade): {reactions}:\>\"", ",", " ", 
         RowBox[{"{", "reactions", "}"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"odes", "=", 
      RowBox[{"Join", "@@", 
       RowBox[{"(", 
        RowBox[{"parseArrowForm", "/@", "reactions"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "odes", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.401033705685178*^9, 3.401033705785138*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "expandArrows",
 ": ",
 Cell[BoxData[
  FormBox[
   UnderoverscriptBox[
    RowBox[{"A", "\[RightArrowLeftArrow]", "B"}], "R", "F"], 
   TraditionalForm]]],
 "  (mass action)"
}], "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"expandArrows", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Underoverscript", "[", 
       RowBox[{
        RowBox[{"RightArrowLeftArrow", "[", 
         RowBox[{"X_", ",", "Y_"}], " ", "]"}], ",", "Rev_", ",", "Fwd_"}], 
       "]"}], ",", "k___"}], "}"}], "]"}], ":=", " ", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "nk", ",", "nrk", ",", "k1", ",", "k2", ",", "r1", ",", "r2", ",", " ", 
       "reactions", ",", "rates", ",", "reaction", ",", "nrates", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"defrates", "=", 
        RowBox[{"{", 
         RowBox[{
         "1", ",", "1", ",", "1", ",", "0", ",", "1", ",", "1", ",", "1", ",",
           "0"}], "}"}]}]}], "}"}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"reaction", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Underoverscript", "[", 
          RowBox[{
           RowBox[{"RightArrowLeftArrow", "[", 
            RowBox[{"X", ",", "Y"}], "]"}], ",", "Rev", ",", "Fwd"}], "]"}], 
         ",", "k"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"dbgArrows", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<expandArrows:\>\"", ",", " ", "reaction"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"rates", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", "k", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nk", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"Flatten", "[", "rates", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"nk", "\[Equal]", "6"}], " ", "\[Or]", 
           RowBox[{"nk", "\[Equal]", "8"}]}], ")"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"nrates", "=", 
          RowBox[{"Take", "[", 
           RowBox[{"rates", ",", 
            RowBox[{"Min", "[", 
             RowBox[{"8", ",", "nk"}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"nrk", "=", 
          RowBox[{"Length", "[", "nrates", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"nrk", "<", "8"}], ",", " ", 
           RowBox[{"nrates", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"nrates", ",", 
              RowBox[{"Drop", "[", 
               RowBox[{"defrates", ",", "nrk"}], "]"}]}], "]"}]}]}], "]"}], 
         ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Unable to unambiguously parse the rate constants in the \
reaction :\>\"", ",", 
           RowBox[{"{", " ", 
            RowBox[{
             RowBox[{"Underoverscript", "[", 
              RowBox[{
               RowBox[{"RightArrowLeftArrow", "[", 
                RowBox[{"X", ",", "Y"}], "]"}], ",", "Rev", ",", "Fwd"}], 
              "]"}], ",", 
             RowBox[{"Sequence", "@@", "rates"}]}], "}"}], ",", "\"\< \>\"", 
           ",", " ", "nk", ",", " ", 
           "\"\< rates were found; the number of rates should be either 6 or \
8; the following values were used instead: \>\"", ",", 
           RowBox[{"{", " ", 
            RowBox[{
             RowBox[{"Underoverscript", "[", 
              RowBox[{
               RowBox[{"RightArrowLeftArrow", "[", 
                RowBox[{"X", ",", "Y"}], "]"}], ",", "Rev", ",", "Fwd"}], 
              "]"}], ",", 
             RowBox[{"Sequence", "@@", "nrates"}]}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"rates", "=", "nrates"}], ";", "\[IndentingNewLine]", 
         RowBox[{"nk", "=", 
          RowBox[{"Length", "[", "rates", "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"k1", "=", 
       RowBox[{"Take", "[", 
        RowBox[{"rates", ",", " ", 
         RowBox[{"nk", "/", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"k2", "=", 
       RowBox[{"Drop", "[", 
        RowBox[{"rates", ",", 
         RowBox[{"nk", "/", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"r1", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Overscript", "[", 
          RowBox[{
           RowBox[{"RightArrowLeftArrow", "[", 
            RowBox[{"X", ",", "Y"}], "]"}], ",", "Fwd"}], "]"}], ",", 
         RowBox[{"Sequence", "@@", "k1"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"r2", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Overscript", "[", 
          RowBox[{
           RowBox[{"RightArrowLeftArrow", "[", 
            RowBox[{"Y", ",", "X"}], "]"}], ",", "Rev"}], "]"}], ",", 
         RowBox[{"Sequence", "@@", "k2"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"reactions", "=", 
       RowBox[{"Join", "@@", 
        RowBox[{"expandArrows", "/@", 
         RowBox[{"{", 
          RowBox[{"r1", ",", "r2"}], "}"}]}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "reactions", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.40103370593573*^9, 3.401033706437964*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "parseArrowForm: ",
 Cell[BoxData[
  FormBox[
   UnderoverscriptBox[
    RowBox[{"A", "\[RightArrowLeftArrow]", "B"}], "R", "F"], 
   TraditionalForm]]],
 "  (mass action)"
}], "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"parseArrowForm", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Underoverscript", "[", 
       RowBox[{
        RowBox[{"RightArrowLeftArrow", "[", 
         RowBox[{"X_", ",", "Y_"}], " ", "]"}], ",", "Rev_", ",", "Fwd_"}], 
       "]"}], ",", "k___"}], "}"}], "]"}], ":=", " ", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "nk", ",", "nrk", ",", "k1", ",", "k2", ",", "r1", ",", "r2", ",", " ", 
       "odes", ",", "rates", ",", "reaction", ",", "nrates", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"defrates", "=", 
        RowBox[{"{", 
         RowBox[{
         "1", ",", "1", ",", "1", ",", "0", ",", "1", ",", "1", ",", "1", ",",
           "0"}], "}"}]}]}], "}"}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"reaction", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Underoverscript", "[", 
          RowBox[{
           RowBox[{"RightArrowLeftArrow", "[", 
            RowBox[{"X", ",", "Y"}], "]"}], ",", "Rev", ",", "Fwd"}], "]"}], 
         ",", "k"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"reactions", "=", 
       RowBox[{"expandArrows", "[", "reaction", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"odes", " ", "=", " ", 
       RowBox[{"Join", "@@", 
        RowBox[{"parseArrowForm", "/@", "reactions"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "odes", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.401033706605094*^9, 3.401033706704795*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "expandArrows",
 ": Cascade  ",
 Cell[BoxData[
  FormBox[
   UnderoverscriptBox[
    RowBox[{
     RowBox[{
     "A", "\[RightArrowLeftArrow]", "B", "\[RightArrowLeftArrow]", "C"}], 
     ".."}], "R", "F"], TraditionalForm]]],
 " and ",
 Cell[BoxData[
  FormBox[
   UnderoverscriptBox[
    RowBox[{
     RowBox[{
     "A", "\[RightArrowLeftArrow]", "B", "\[RightArrowLeftArrow]", "C"}], 
     ".."}], 
    RowBox[{"{", 
     RowBox[{"R1", ",", "R2", ",", "..."}], "}"}], 
    RowBox[{"{", 
     RowBox[{"F1", ",", "F2", ",", "..."}], "}"}]], TraditionalForm]]]
}], "Subsection"],

Cell["\<\
revised 0.74 to fix bug which was stripping indexed modifiers of their names \
and just using the indices. In the MapThread at the very end instead of #2 \
and #3, Sequence@@#2 and Sequence@@#3 were used for reasons that were unclear.\
\>", "Text",
 CellChangeTimes->{{3.451251262229807*^9, 3.451251333447613*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"expandArrows", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Underoverscript", "[", 
      RowBox[{
       RowBox[{"RightArrowLeftArrow", "[", 
        RowBox[{"X_", ",", "Y_", " ", ",", " ", "Z__"}], "]"}], ",", 
       "bottomModifiers_", ",", "topModifiers_"}], "]"}], ",", "rates___"}], 
    "}"}], "]"}], ":=", " ", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", " ", 
     RowBox[{
     "reaction", ",", "reactants", ",", " ", "k", ",", " ", "nreactions", ",",
       "reactions", ",", " ", "nrates", ",", "bottommodifierList", ",", 
      "topmodifierList", ",", "nmod", ",", "lastset", ",", "m1", ",", " ", 
      RowBox[{"dbg", "=", "False"}], ",", " ", "dPrint"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"dPrint", "[", "x___", "]"}], ":=", " ", 
      RowBox[{"If", "[", 
       RowBox[{"dbg", ",", " ", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<expandArrows: \>\"", ",", " ", "x"}], "]"}]}], "]"}]}], 
     ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"reactants", "=", 
      RowBox[{"{", 
       RowBox[{"X", ",", "Y", ",", "Z"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"reaction", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Underoverscript", "[", 
         RowBox[{
          RowBox[{"RightArrowLeftArrow", "@@", "reactants"}], ",", 
          "bottomModifiers", ",", "topModifiers"}], "]"}], ",", "rates"}], 
       "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"dbgArrows", ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<expandArrows (cascade):\>\"", ",", " ", "reaction"}], 
        "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"topmodifierList", "=", 
      RowBox[{
       RowBox[{"{", "topModifiers", "}"}], "//", "Flatten"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"bottommodifierList", "=", 
      RowBox[{
       RowBox[{"{", "bottomModifiers", "}"}], "//", "Flatten"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<top:\>\"", ",", " ", "topmodifierList"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<bottom:\>\"", ",", " ", "bottommodifierList"}], "]"}], ";",
      " ", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "topmodifierList", "]"}], "<", "1"}], ",", " ", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Error: At least one forward modifier must be specified \
for:\>\"", ",", "reaction"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"{", "}"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "bottommodifierList", "]"}], "<", "1"}], ",", 
       " ", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Error: At least one reverse modifier must be specified \
for:\>\"", ",", "reaction"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"{", "}"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"reactions", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{"reactants", ",", "2", ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nreactions", "=", 
      RowBox[{"Length", "[", "reactions", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nmod", "=", 
      RowBox[{"Length", "[", "topmodifierList", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"nmod", ">", "nreactions"}], ",", " ", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Warning: Extra modifiers \>\"", ",", " ", 
          RowBox[{"Drop", "[", 
           RowBox[{"topmodifierList", ",", "nreactions"}], "]"}], ",", 
          "\"\< in the reation \>\"", ",", " ", "reaction", ",", 
          "\"\< will be ignored.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"topmodifierList", "=", 
         RowBox[{"Take", "[", 
          RowBox[{"topmodifierList", ",", "nreactions"}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"nmod", "=", 
      RowBox[{"Length", "[", "bottommodifierList", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"nmod", ">", "nreactions"}], ",", " ", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Warning: Extra modifiers \>\"", ",", " ", 
          RowBox[{"Drop", "[", 
           RowBox[{"bottommodifierList", ",", "nreactions"}], "]"}], ",", 
          "\"\< in the reation \>\"", ",", " ", "reaction", ",", 
          "\"\< will be ignored.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"bottommodifierList", "=", 
         RowBox[{"Take", "[", 
          RowBox[{"bottommodifierList", ",", "nreactions"}], "]"}]}], ";"}]}],
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<nmod: \>\"", ",", " ", "nmod"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"m1", "=", 
      RowBox[{"Last", "[", "bottommodifierList", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<m1 (bottom):\>\"", ",", " ", "m1"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"bottommodifierList", "=", 
        RowBox[{"PadRight", "[", 
         RowBox[{"bottommodifierList", ",", "nreactions", ",", " ", "m1"}], 
         "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "bottommodifierList", "]"}], "<", 
        "nreactions"}], ",", " ", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"bottommodifierList", ",", " ", "m1"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<bottom: \>\"", ",", " ", "bottommodifierList"}], "]"}], 
     ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"m1", "=", 
      RowBox[{"Last", "[", "topmodifierList", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<m1 (top):\>\"", ",", " ", "m1"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"topmodifierList", "=", 
        RowBox[{"PadRight", "[", 
         RowBox[{"topmodifierList", ",", "nreactions", ",", " ", "m1"}], 
         "]"}]}], ";"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "topmodifierList", "]"}], "<", "nreactions"}], 
       ",", " ", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"topmodifierList", ",", " ", "m1"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<top: \>\"", ",", " ", "topmodifierList"}], "]"}], ";", " ",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"k", "=", 
      RowBox[{"{", "rates", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "k", "]"}], "\[Equal]", "0"}], ",", " ", 
       RowBox[{"k", "=", 
        RowBox[{"{", 
         RowBox[{
         "1", ",", "1", ",", "1", ",", "0", ",", "1", ",", "1", ",", "1", ",",
           "0"}], "}"}]}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "k", "]"}], "\[Equal]", "6"}], ",", " ", 
       RowBox[{"k", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Take", "[", 
           RowBox[{"k", ",", "3"}], "]"}], ",", 
          RowBox[{"{", "0", "}"}], ",", " ", 
          RowBox[{"Take", "[", 
           RowBox[{"k", ",", 
            RowBox[{"-", "3"}]}], "]"}], ",", 
          RowBox[{"{", "0", "}"}]}], "]"}]}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "k", "]"}], "<", "3"}], ",", " ", 
       RowBox[{"k", "=", 
        RowBox[{"PadRight", "[", 
         RowBox[{"k", ",", "3", ",", "1"}], "]"}]}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "k", "]"}], "<", "4"}], ",", " ", 
       RowBox[{"k", "=", 
        RowBox[{"PadRight", "[", 
         RowBox[{"k", ",", "4", ",", "0"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "k", "]"}], "<", "7"}], ",", " ", 
       RowBox[{"k", "=", 
        RowBox[{"PadRight", "[", 
         RowBox[{"k", ",", "7", ",", "1"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "k", "]"}], "<", "8"}], ",", " ", 
       RowBox[{"k", "=", 
        RowBox[{"PadRight", "[", 
         RowBox[{"k", ",", "8", ",", "0"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Mod", "[", 
          RowBox[{
           RowBox[{"Length", "[", "k", "]"}], ",", "6"}], "]"}], "\[Equal]", 
         "0"}], " ", "\[And]", " ", 
        RowBox[{
         RowBox[{"Length", "[", "k", "]"}], "\[NotEqual]", " ", 
         RowBox[{"8", "*", "nreactions"}]}]}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{"Length", "[", "k", "]"}], ",", "8"}], "]"}], "\[Equal]",
            "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Warning: unable to unambiguously parse the rates constants \
for \>\"", ",", " ", "reaction"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "k", "]"}], ">", 
           RowBox[{"6", "*", "nreactions"}]}], ",", " ", 
          RowBox[{"k", "=", 
           RowBox[{"Take", "[", 
            RowBox[{"k", ",", " ", 
             RowBox[{"6", "*", "nreactions"}]}], "]"}]}]}], "]"}], ";", " ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"lastset", "=", 
         RowBox[{"Take", "[", 
          RowBox[{"k", ",", 
           RowBox[{"-", "6"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "k", "]"}], "<", 
           RowBox[{"6", "*", "nreactions"}]}], ",", " ", 
          RowBox[{"k", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"k", ",", "lastset"}], "]"}]}]}], "]"}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Flatten", "[", "k", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Partition", "[", 
          RowBox[{"k", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Append", "[", 
              RowBox[{"#", ",", "0"}], "]"}], "&"}], ",", "k"}], "]"}], "//", 
          "Flatten"}]}], ";"}], "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{"Length", "[", "k", "]"}], ",", "8"}], "]"}], "\[Equal]",
            "0"}], ",", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "k", "]"}], ">", 
              RowBox[{"8", "*", "nreactions"}]}], ",", " ", 
             RowBox[{"k", "=", 
              RowBox[{"Take", "[", 
               RowBox[{"k", ",", 
                RowBox[{"8", "*", "nreactions"}]}], "]"}]}]}], "]"}], ";", 
           " ", "\[IndentingNewLine]", 
           RowBox[{"lastset", "=", 
            RowBox[{"Take", "[", 
             RowBox[{"k", ",", 
              RowBox[{"-", "8"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "k", "]"}], "<", 
              RowBox[{"8", "*", "nreactions"}]}], ",", 
             RowBox[{"k", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"k", ",", "lastset"}], "]"}]}]}], "]"}], ";", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"k", "=", 
            RowBox[{"Flatten", "[", "k", "]"}]}], ";"}], 
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Warning: unable to unambiguously parse the rate constsnt for \
\>\"", ",", " ", "reaction"}], "]"}], ";", " ", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "k", "]"}], ">", 
              RowBox[{"8", "*", "nreactions"}]}], ",", 
             RowBox[{"k", "=", 
              RowBox[{"Take", "[", 
               RowBox[{"k", ",", 
                RowBox[{"8", "*", "nreactions"}]}], "]"}]}]}], "]"}], ";", 
           " ", "\[IndentingNewLine]", 
           RowBox[{"k", "=", 
            RowBox[{"PadRight", "[", 
             RowBox[{"k", ",", 
              RowBox[{"8", "*", "nreactions"}]}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"k", " ", "=", " ", 
      RowBox[{"Partition", "[", 
       RowBox[{"k", ",", "8"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<k=\>\"", ",", "k"}], " ", "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "the", " ", "following", " ", "line", " ", "revised", " ", "0.74", " ", 
       "to", " ", "remove", " ", "application", " ", "of", " ", 
       RowBox[{"Sequence", "@@", " ", "to"}], " ", "#2", " ", "and", " ", 
       "#3", " ", "which", " ", "was", " ", "a", " ", "bug"}], "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"reactions", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Underoverscript", "[", 
            RowBox[{
             RowBox[{"RightArrowLeftArrow", "@@", "#1"}], ",", "#2", ",", " ",
              "#3"}], "]"}], ",", " ", 
           RowBox[{"Sequence", "@@", "#4"}]}], "}"}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "reactions", ",", "bottommodifierList", ",", "topmodifierList", ",", 
          "k"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<reactions: \>\"", ",", " ", "reactions"}], "]"}], ";", " ",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"reactions", "=", 
      RowBox[{"Join", "@@", 
       RowBox[{"expandArrows", "/@", "reactions"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "reactions", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.401033706872397*^9, 3.401033707090102*^9}, {
  3.451250401330434*^9, 3.4512504037021914`*^9}, {3.451250445814831*^9, 
  3.451250595231949*^9}, {3.451250664094681*^9, 3.4512506873273697`*^9}, {
  3.4512507467552013`*^9, 3.4512508390473757`*^9}, {3.4512508763013687`*^9, 
  3.451250898803215*^9}, {3.451251029173526*^9, 3.451251037575416*^9}, {
  3.4512512097178307`*^9, 3.4512512400547123`*^9}, {3.451252559263281*^9, 
  3.4512525603102217`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "parseArrowForm: Cascade  ",
 Cell[BoxData[
  FormBox[
   UnderoverscriptBox[
    RowBox[{
     RowBox[{
     "A", "\[RightArrowLeftArrow]", "B", "\[RightArrowLeftArrow]", "C"}], 
     ".."}], "R", "F"], TraditionalForm]]],
 " and ",
 Cell[BoxData[
  FormBox[
   UnderoverscriptBox[
    RowBox[{
     RowBox[{
     "A", "\[RightArrowLeftArrow]", "B", "\[RightArrowLeftArrow]", "C"}], 
     ".."}], 
    RowBox[{"{", 
     RowBox[{"R1", ",", "R2", ",", "..."}], "}"}], 
    RowBox[{"{", 
     RowBox[{"F1", ",", "F2", ",", "..."}], "}"}]], TraditionalForm]]]
}], "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"parseArrowForm", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Underoverscript", "[", 
      RowBox[{
       RowBox[{"RightArrowLeftArrow", "[", 
        RowBox[{"X_", ",", "Y_", " ", ",", " ", "Z__"}], "]"}], ",", 
       "bottomModifiers_", ",", "topModifiers_"}], "]"}], ",", "rates___"}], 
    "}"}], "]"}], ":=", " ", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", " ", 
     RowBox[{
     "odes", ",", "reaction", ",", "reactants", ",", " ", "reactions"}], 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"reactants", "=", 
      RowBox[{"{", 
       RowBox[{"X", ",", "Y", ",", "Z"}], "}"}]}], ";", 
     RowBox[{"reaction", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Underoverscript", "[", 
         RowBox[{
          RowBox[{"RightArrowLeftArrow", "@@", "reactants"}], ",", 
          "bottomModifiers", ",", "topModifiers"}], "]"}], ",", "rates"}], 
       "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"reactions", " ", "=", " ", 
      RowBox[{"expandArrows", "[", "reaction", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"odes", "=", 
      RowBox[{"Join", "@@", 
       RowBox[{"(", 
        RowBox[{"parseArrowForm", "/@", "reactions"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "odes", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.40103370725751*^9, 3.4010337073572483`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "expandArrows: ",
 Cell[BoxData[
  FormBox[
   OverscriptBox[
    RowBox[{"A", "\[Equilibrium]", "B"}], "C"], TraditionalForm]]],
 "  (mass action for A+E\[RightArrowLeftArrow]AE\[RightArrowLeftArrow]BE\
\[RightArrowLeftArrow]B+E )"
}], "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"expandArrows", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Overscript", "[", 
       RowBox[{
        RowBox[{"Equilibrium", "[", 
         RowBox[{"X_", ",", "Y_"}], " ", "]"}], ",", "En_"}], "]"}], ",", 
      "k___"}], "}"}], "]"}], ":=", " ", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "a", ",", "d", ",", "kf", ",", "kr", ",", "r1", ",", "r2", ",", "r3", 
       ",", " ", "reactions", ",", " ", "rates", ",", "nrates", ",", " ", 
       "XEN", ",", " ", "YEN"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"reaction", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Overscript", "[", 
          RowBox[{
           RowBox[{"Equilibrium", "[", 
            RowBox[{"X", ",", "Y"}], "]"}], ",", "En"}], "]"}], ",", "k"}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"dbgArrows", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<expandArrows:\>\"", ",", " ", "reaction"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"rates", "=", 
       RowBox[{
        RowBox[{"{", "k", "}"}], "//", "Flatten"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nrates", "=", 
       RowBox[{"Length", "[", "rates", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"nrates", "<", "6"}], ",", " ", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Missing rate constants in the reaction \>\"", ",", " ", 
          "reaction", ",", "\"\< set to a value of 1\>\""}], "]"}]}], "]"}], 
      ";", " ", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "rates", "]"}], ">", "6"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<The extra rate constants \>\"", ",", 
           RowBox[{"Drop", "[", 
            RowBox[{"rates", ",", "6"}], "]"}], ",", 
           "\"\< in the reaction \>\"", ",", " ", "reaction", ",", " ", 
           "\"\< will be ignored.\>\""}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"rates", "=", 
       RowBox[{"PadRight", "[", 
        RowBox[{"rates", ",", "6", ",", "1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"rates", "=", 
       RowBox[{"Take", "[", 
        RowBox[{"rates", ",", "6"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "a", ",", "d", ",", "k1", ",", "k2", ",", " ", "kf", ",", "kr"}], 
        "}"}], "=", "rates"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"X", "/.", 
            RowBox[{"{", 
             RowBox[{"Plus", "\[Rule]", " ", "List"}], "}"}]}], "]"}], ">", 
          "1"}], " ", "\[Or]", " ", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"Y", "/.", 
            RowBox[{"{", 
             RowBox[{"Plus", "\[Rule]", " ", "List"}], "}"}]}], "]"}], ">", 
          "1"}]}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<The reaction \>\"", ",", 
           RowBox[{"Overscript", "[", 
            RowBox[{
             RowBox[{"Equilibrium", "[", 
              RowBox[{"X", ",", "Y"}], "]"}], ",", "En"}], "]"}], ",", 
           "\"\< is not correctly formatted: too many reactants or \
products.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"{", "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"XEN", "=", 
       RowBox[{"setBinding", "[", 
        RowBox[{"X", ",", " ", "En"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"YEN", "=", 
       RowBox[{"setBinding", "[", 
        RowBox[{"Y", ",", "En"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"r1", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"RightArrowLeftArrow", "[", 
          RowBox[{
           RowBox[{"X", "+", "En"}], ",", "XEN"}], "]"}], ",", "a", ",", 
         "d"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"r2", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"RightArrowLeftArrow", "[", 
          RowBox[{"XEN", ",", " ", "YEN"}], "]"}], ",", "k1", ",", "k2"}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"r3", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"RightArrowLeftArrow", "[", 
          RowBox[{"YEN", ",", " ", 
           RowBox[{"Y", "+", "En"}]}], "]"}], ",", "kf", ",", "kr"}], "}"}]}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"reactions", "=", 
       RowBox[{"Join", "@@", 
        RowBox[{"(", 
         RowBox[{"expandArrows", "/@", 
          RowBox[{"{", 
           RowBox[{"r1", ",", "r2", ",", "r3"}], "}"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "reactions", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4010337075077753`*^9, 3.401033730587451*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "parseArrowForm: ",
 Cell[BoxData[
  FormBox[
   OverscriptBox[
    RowBox[{"A", "\[Equilibrium]", "B"}], "C"], TraditionalForm]]],
 "  (mass action for A+E\[RightArrowLeftArrow]AE\[RightArrowLeftArrow]BE\
\[RightArrowLeftArrow]B+E )"
}], "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"parseArrowForm", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Overscript", "[", 
       RowBox[{
        RowBox[{"Equilibrium", "[", 
         RowBox[{"X_", ",", "Y_"}], " ", "]"}], ",", "En_"}], "]"}], ",", 
      "k___"}], "}"}], "]"}], ":=", " ", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"reaction", ",", " ", "odes"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"reaction", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Overscript", "[", 
          RowBox[{
           RowBox[{"Equilibrium", "[", 
            RowBox[{"X", ",", "Y"}], "]"}], ",", "En"}], "]"}], ",", "k"}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"odes", " ", "=", " ", 
       RowBox[{"Join", "@@", 
        RowBox[{"(", 
         RowBox[{"parseArrowForm", "/@", 
          RowBox[{"expandArrows", "[", "reaction", "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "odes", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4010337295179863`*^9, 3.4010337296177673`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "expandArrows: Cascade ",
 Cell[BoxData[
  FormBox[
   OverscriptBox[
    RowBox[{
     RowBox[{
     "A", "\[Equilibrium]", "B", "\[Equilibrium]", "C", "\[Equilibrium]"}], 
     "..."}], "M"], TraditionalForm]]],
 " or ",
 Cell[BoxData[
  FormBox[
   OverscriptBox[
    RowBox[{
     RowBox[{
     "A", "\[Equilibrium]", "B", "\[Equilibrium]", "C", "\[Equilibrium]"}], 
     "..."}], 
    RowBox[{"{", 
     RowBox[{"M1", ",", "M2", ",", "..."}], "}"}]], TraditionalForm]]],
 " "
}], "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"expandArrows", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Overscript", "[", 
      RowBox[{
       RowBox[{"Equilibrium", "[", 
        RowBox[{"X_", ",", "Y_", " ", ",", " ", "Z__"}], "]"}], ",", 
       "modifiers_"}], "]"}], ",", "rates___"}], "}"}], "]"}], ":=", " ", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", " ", 
     RowBox[{
     "odes", ",", "reaction", ",", "reactants", ",", " ", "k", ",", " ", 
      "nreactions", ",", "reactions", ",", " ", "nrates", ",", "modifierList",
       ",", "nmods", ",", "m1"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"reactants", "=", 
      RowBox[{"{", 
       RowBox[{"X", ",", "Y", ",", "Z"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"reaction", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Overscript", "[", 
         RowBox[{
          RowBox[{"Equilibrium", "@@", "reactants"}], ",", "modifiers"}], 
         "]"}], ",", "rates"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"dbgArrows", ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<expandArrows:\>\"", ",", " ", "reaction"}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"modifierList", "=", 
      RowBox[{
       RowBox[{"{", "modifiers", "}"}], "//", "Flatten"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "modifierList", "]"}], "<", "1"}], ",", " ", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Error: At least one modifier must be specified for:\>\"", ",", 
          "reaction"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"{", "}"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"reactions", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{"reactants", ",", "2", ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nreactions", "=", 
      RowBox[{"Length", "[", "reactions", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nmod", "=", 
      RowBox[{"Length", "[", "modifierList", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"nmod", ">", "nreactions"}], ",", " ", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Warning: Extra modifiers \>\"", ",", " ", 
          RowBox[{"Drop", "[", 
           RowBox[{"modifierList", ",", "nreactions"}], "]"}], ",", 
          "\"\< in the reation \>\"", ",", " ", "reaction", ",", 
          "\"\< will be ignored.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"modifierList", "=", 
         RowBox[{"Take", "[", 
          RowBox[{"modifierList", ",", "nreactions"}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"m1", "=", 
      RowBox[{"Last", "[", "modifierList", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"modifierList", "=", 
        RowBox[{"PadRight", "[", 
         RowBox[{"modifierList", ",", "nreactions", ",", " ", "m1"}], "]"}]}],
        ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "modifierList", "]"}], "<", "nreactions"}], 
       ",", " ", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"modifierList", ",", " ", "m1"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"k", "=", 
      RowBox[{"{", "rates", "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"k", "=", 
      RowBox[{
       RowBox[{"{", "rates", "}"}], "//", "Flatten"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "k", "]"}], "\[Equal]", "0"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Warning: missing rate constants in the reaction \>\"", ",", 
          "reaction", ",", " ", "\"\< set to default values.\>\""}], "]"}], 
        ";", " ", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
          "}"}]}]}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "k", "]"}], ">", 
        RowBox[{"6", "*", "nreactions"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Warning: the extra rate constants \>\"", ",", 
          RowBox[{"Drop", "[", 
           RowBox[{"k", ",", 
            RowBox[{"6", "*", "nreactions"}]}], "]"}], ",", 
          "\"\< in the reaction \>\"", ",", "reaction", ",", 
          "\"\< will be ignored.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Take", "[", 
          RowBox[{"k", ",", 
           RowBox[{"6", "*", "nreactions"}]}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{"Length", "[", "k", "]"}], ",", "6"}], "]"}], "\[NotEqual]",
         " ", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Warning: Only \>\"", ",", 
          RowBox[{"Length", "[", "k", "]"}], ",", "\"\< or the required \>\"",
           ",", 
          RowBox[{"6", "*", "nreactions"}], ",", 
          "\"\< rate constants found for the reaction \>\"", ",", " ", 
          "reaction", ",", " ", 
          
          "\"\< Default assumptions will be applied to determine the missing \
rates.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{"Length", "[", "k", "]"}], ",", "6"}], "]"}], 
           "\[NotEqual]", " ", "0"}], ",", " ", 
          RowBox[{"k", "=", 
           RowBox[{"Append", "[", 
            RowBox[{"k", ",", "1"}], "]"}]}]}], "]"}], ";"}]}], " ", 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "k", "]"}], "<", 
        RowBox[{"6", "*", "nreactions"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"last6", "=", 
         RowBox[{"Take", "[", 
          RowBox[{"k", ",", 
           RowBox[{"-", "6"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "k", "]"}], "<", 
           RowBox[{"6", "*", "nreactions"}]}], ",", " ", 
          RowBox[{"k", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"k", ",", "last6"}], "]"}]}]}], "]"}], ";"}]}], " ", 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"k", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", "k", "]"}], ",", "6"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"reactions", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Overscript", "[", 
            RowBox[{
             RowBox[{"Equilibrium", "@@", "#1"}], ",", "#2"}], "]"}], ",", 
           RowBox[{"Sequence", "@@", "#3"}]}], "}"}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{"reactions", ",", "modifierList", ",", "k"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"reactions", "=", 
      RowBox[{"Join", "@@", 
       RowBox[{"(", 
        RowBox[{"expandArrows", "/@", "reactions"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "reactions", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4010337297677794`*^9, 3.40103372996859*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "parseArrowForm: Cascade ",
 Cell[BoxData[
  FormBox[
   OverscriptBox[
    RowBox[{
     RowBox[{
     "A", "\[Equilibrium]", "B", "\[Equilibrium]", "C", "\[Equilibrium]"}], 
     "..."}], "M"], TraditionalForm]]],
 " or ",
 Cell[BoxData[
  FormBox[
   OverscriptBox[
    RowBox[{
     RowBox[{
     "A", "\[Equilibrium]", "B", "\[Equilibrium]", "C", "\[Equilibrium]"}], 
     "..."}], 
    RowBox[{"{", 
     RowBox[{"M1", ",", "M2", ",", "..."}], "}"}]], TraditionalForm]]],
 " "
}], "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"parseArrowForm", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Overscript", "[", 
      RowBox[{
       RowBox[{"Equilibrium", "[", 
        RowBox[{"X_", ",", "Y_", " ", ",", " ", "Z__"}], "]"}], ",", 
       "modifiers_"}], "]"}], ",", "rates___"}], "}"}], "]"}], ":=", " ", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", " ", 
     RowBox[{"odes", ",", "reaction", ",", "reactions"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"reactants", "=", 
      RowBox[{"{", 
       RowBox[{"X", ",", "Y", ",", "Z"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"reaction", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Overscript", "[", 
         RowBox[{
          RowBox[{"Equilibrium", "@@", "reactants"}], ",", "modifiers"}], 
         "]"}], ",", "rates"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"reactions", " ", "=", " ", 
      RowBox[{"expandArrows", "[", "reaction", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"odes", "=", 
      RowBox[{"Join", "@@", 
       RowBox[{"(", 
        RowBox[{"parseArrowForm", "/@", "reactions"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "odes", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.401033730136139*^9, 3.401033730236742*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["expandArrows: Rule[...]", "Subsection"],

Cell["\<\
revised 0.69 - to allow reactants or products of the form {A,B,C, ..} instead \
of {A+B+C,..}
revised 0.73 - make r local variabale to avoid conflict\
\>", "Text",
 CellChangeTimes->{{3.427490393547925*^9, 3.42749042183391*^9}, {
  3.450713924476049*^9, 3.450713936983593*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"expandArrows", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Rule", "[", 
      RowBox[{"x_", ",", "y_"}], "]"}], ",", " ", "rates___"}], "}"}], "]"}], 
  ":=", " ", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"r", ",", " ", "reactants", ",", " ", "products"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"reactants", "  ", "=", " ", 
      RowBox[{"ListToSum", "[", "x", "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"products", "  ", "=", " ", 
      RowBox[{"ListToSum", "[", "y", "]"}]}], ";", " ", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"r", "=", 
      RowBox[{"Rule", "[", 
       RowBox[{"reactants", ",", "products"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"r", "=", 
      RowBox[{"ShortRightArrow", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"r", "/.", 
           RowBox[{"{", 
            RowBox[{"Rule", "\[Rule]", " ", "List"}], "}"}]}], ")"}], "//", 
         "Flatten"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"r", "=", 
      RowBox[{"expandArrows", "[", 
       RowBox[{"{", 
        RowBox[{"r", ",", "rates"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "r", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.401033676948382*^9, {3.427490228617791*^9, 3.4274902385535*^9}, {
   3.427490336627824*^9, 3.427490386632664*^9}, {3.427490426095465*^9, 
   3.427490447399975*^9}, {3.427490657466103*^9, 3.427490671707131*^9}, {
   3.427491658536514*^9, 3.427491662480906*^9}, {3.450713921913422*^9, 
   3.4507139223234797`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["parseArrowForm:Rule[...] ", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"parseArrowForm", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Rule", "[", 
      RowBox[{"x_", ",", "y_"}], "]"}], ",", "rates___"}], "}"}], "]"}], ":=",
   " ", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"r", ",", " ", "reactants", ",", " ", "products"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"reactants", "  ", "=", " ", 
      RowBox[{"ListToSum", "[", "x", "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"products", "  ", "=", " ", 
      RowBox[{"ListToSum", "[", "y", "]"}]}], ";", " ", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"r", "=", 
      RowBox[{"Rule", "[", 
       RowBox[{"reactants", ",", "products"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"r", "=", 
      RowBox[{"ShortRightArrow", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"r", "/.", 
           RowBox[{"{", 
            RowBox[{"Rule", "\[Rule]", " ", "List"}], "}"}]}], ")"}], "//", 
         "Flatten"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"r", "=", 
      RowBox[{"parseArrowForm", "[", 
       RowBox[{"{", 
        RowBox[{"r", ",", "rates"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "r", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.401033677065384*^9, {3.427490684622495*^9, 3.427490710903607*^9}, 
   3.427491674363666*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "expandArrows: ",
 Cell[BoxData[
  FormBox[
   OverscriptBox[
    RowBox[{"Rule", "[", "...", "]"}], "A"], TraditionalForm]]]
}], "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"expandArrows", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Overscript", "[", 
      RowBox[{
       RowBox[{"Rule", "[", 
        RowBox[{"x_", ",", "y_"}], "]"}], ",", " ", "z_"}], "]"}], ",", " ", 
     "rates___"}], "}"}], "]"}], ":=", " ", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"r", ",", " ", "reactants", ",", " ", "products"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"reactants", "  ", "=", " ", 
      RowBox[{"ListToSum", "[", "x", "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"products", "  ", "=", " ", 
      RowBox[{"ListToSum", "[", "y", "]"}]}], ";", " ", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"r", "=", 
      RowBox[{"Rule", "[", 
       RowBox[{"reactants", ",", "products"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"r", "=", 
      RowBox[{"ShortRightArrow", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"r", "/.", 
           RowBox[{"{", 
            RowBox[{"Rule", "\[Rule]", " ", "List"}], "}"}]}], ")"}], "//", 
         "Flatten"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"r", "=", 
      RowBox[{"expandArrows", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Overscript", "[", 
          RowBox[{"r", ",", "z"}], "]"}], ",", "rates"}], "}"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "r", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.401033677182775*^9, {3.427490724879153*^9, 3.427490732182473*^9}, 
   3.42749167746614*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{"parseArrowForm", ":", 
   OverscriptBox[
    RowBox[{"Rule", "[", "...", "]"}], "A"]}], 
  TraditionalForm]]]], "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"parseArrowForm", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Overscript", "[", 
      RowBox[{
       RowBox[{"Rule", "[", 
        RowBox[{"x_", ",", "y_"}], "]"}], ",", "z_"}], "]"}], ",", 
     "rates___"}], "}"}], "]"}], ":=", " ", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"r", ",", " ", "reactants", ",", " ", "products"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"reactants", "  ", "=", " ", 
      RowBox[{"ListToSum", "[", "x", "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"products", "  ", "=", " ", 
      RowBox[{"ListToSum", "[", "y", "]"}]}], ";", " ", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"r", "=", 
      RowBox[{"Rule", "[", 
       RowBox[{"reactants", ",", "products"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"r", "=", 
      RowBox[{"ShortRightArrow", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"r", "/.", 
           RowBox[{"{", 
            RowBox[{"Rule", "\[Rule]", " ", "List"}], "}"}]}], ")"}], "//", 
         "Flatten"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"r", "=", 
      RowBox[{"parseArrowForm", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Overscript", "[", 
          RowBox[{"r", ",", "z"}], "]"}], ",", "rates"}], "}"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "r", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.401033677299637*^9, {3.427490741362402*^9, 3.427490749690765*^9}, 
   3.427491681674728*^9}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Michaelis Menten reactions and cascades", "Subsection",
 CellDingbat->None,
 Background->RGBColor[1, 0.983139, 0.832074]],

Cell[CellGroupData[{

Cell[TextData[{
 "parseArrowForm & expandArrows: A\[DoubleLongRightArrow]B, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    OverscriptBox[
     RowBox[{"A", "\[DoubleLongRightArrow]", "B"}], "C"], ",", " ", 
    RowBox[{"A", "\[DoubleLongLeftRightArrow]", "B"}], ",", 
    UnderoverscriptBox[
     RowBox[{"A", "\[DoubleLongLeftRightArrow]", "B"}], "REn", "FEn"], ",", 
    " ", 
    RowBox[{
     RowBox[{"MM", "[", "..", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{"Michaelis", "-", "Menten"}], ")"}]}]}], TraditionalForm]]]
}], "Subsection"],

Cell[CellGroupData[{

Cell["A\[DoubleLongRightArrow]B", "Subsubsection"],

Cell["add missing MM[k1,k2,k3]  v.088", "Text",
 CellChangeTimes->{{3.551913504471733*^9, 3.5519135201835327`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"expandArrows", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DoubleLongRightArrow", "[", 
       RowBox[{"X_", ",", "Y_"}], " ", "]"}], ",", 
      RowBox[{"MM", "[", "rates__", "]"}]}], "}"}], "]"}], ":=", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"odes", ",", "rateLaw", ",", " ", "r"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"r", "=", 
       RowBox[{"{", "rates", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "r", "]"}], "<", "2"}], ",", " ", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"r", ",", "1"}], "]"}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "r", "]"}], ">", "3"}], ",", " ", 
        RowBox[{"r", "=", 
         RowBox[{"Take", "[", 
          RowBox[{"r", ",", "3"}], "]"}]}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"reaction", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"DoubleLongRightArrow", "[", 
          RowBox[{"X", ",", "Y"}], "]"}], ",", 
         RowBox[{"MM", "[", 
          RowBox[{"Sequence", "@@", "r"}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"dbgArrows", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<expandArrows:\>\"", ",", " ", "reaction"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", "reaction", "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.401033754236158*^9, 3.40103375455446*^9}, 
   3.5519130782275267`*^9, {3.5519131351268387`*^9, 3.551913342685318*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"parseArrowForm", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DoubleLongRightArrow", "[", 
       RowBox[{"X_", ",", "Y_"}], " ", "]"}], ",", 
      RowBox[{"MM", "[", "rates__", "]"}]}], "}"}], "]"}], ":=", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "odes", ",", "rateLaw", ",", " ", "r", ",", " ", "KD", ",", " ", "v", 
       ",", " ", "k1", ",", "k2", ",", "k3"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"reaction", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Overscript", "[", 
          RowBox[{
           RowBox[{"DoubleLongRightArrow", "[", 
            RowBox[{"X", ",", "Y"}], "]"}], ",", "En"}], "]"}], ",", 
         RowBox[{"MM", "[", "rates", "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"dbgArrows", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<parseArrowForm:\>\"", ",", " ", "reaction"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"r", "=", 
       RowBox[{"{", "rates", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "r", "]"}], "\[Equal]", "2"}], ",", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"KD", ",", "v"}], "}"}], "=", "r"}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "r", "]"}], "\[Equal]", "3"}], ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"k1", ",", "k2", ",", "k3"}], "}"}], "=", "r"}], ";", " ", 
         
         RowBox[{"KD", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"k2", "+", "k3"}], ")"}], "/", "k1"}]}], ";", " ", 
         RowBox[{"v", "=", "k1"}]}]}], "]"}], ";", " ", "\[IndentingNewLine]",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"rateLaw", "=", 
       RowBox[{"v", "*", 
        RowBox[{
         RowBox[{"X", "[", "Global`t", "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"KD", "+", 
           RowBox[{"X", "[", "Global`t", "]"}]}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"rateLaw", "=", 
       RowBox[{"rateLaw", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Global`\[EmptySet]", "[", "Global`t", "]"}], "\[Rule]", 
          " ", "0"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"odes", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"X", "[", "Global`t", "]"}], ",", 
           RowBox[{"-", "rateLaw"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Y", "[", "Global`t", "]"}], ",", " ", "rateLaw"}], 
          "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "odes", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4010337549054213`*^9, 3.401033755223115*^9}, {
  3.551913365996502*^9, 3.551913455387454*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   OverscriptBox[
    RowBox[{"A", "\[DoubleLongRightArrow]", "B"}], "C"], TraditionalForm]]],
 ", MM[K,v]"
}], "Subsubsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"expandArrows", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Overscript", "[", 
       RowBox[{
        RowBox[{"DoubleLongRightArrow", "[", 
         RowBox[{"X_", ",", "Y_"}], " ", "]"}], ",", "En_"}], "]"}], ",", 
      RowBox[{"MM", "[", 
       RowBox[{
        RowBox[{"KD_:", "1"}], ",", 
        RowBox[{"v_:", "1"}]}], "]"}]}], "}"}], "]"}], ":=", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "reaction", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"reaction", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Overscript", "[", 
          RowBox[{
           RowBox[{"DoubleLongRightArrow", "[", 
            RowBox[{"X", ",", "Y"}], "]"}], ",", "En"}], "]"}], ",", 
         RowBox[{"MM", "[", 
          RowBox[{"KD", ",", "v"}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"dbgArrows", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<expandArrows:\>\"", ",", " ", "reaction"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", "reaction", "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.401033755540967*^9, 3.401033755640752*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"parseArrowForm", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Overscript", "[", 
       RowBox[{
        RowBox[{"DoubleLongRightArrow", "[", 
         RowBox[{"X_", ",", "Y_"}], " ", "]"}], ",", "En_"}], "]"}], ",", 
      RowBox[{"MM", "[", 
       RowBox[{
        RowBox[{"KD_:", "1"}], ",", 
        RowBox[{"v_:", "1"}]}], "]"}]}], "}"}], "]"}], ":=", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"odes", ",", "rateLaw"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"reaction", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Overscript", "[", 
          RowBox[{
           RowBox[{"DoubleLongRightArrow", "[", 
            RowBox[{"X", ",", "Y"}], "]"}], ",", "En"}], "]"}], ",", 
         RowBox[{"MM", "[", 
          RowBox[{"KD", ",", "v"}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"dbgArrows", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<parseArrowForm:\>\"", ",", " ", "reaction"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"rateLaw", "=", 
       RowBox[{"v", "*", 
        RowBox[{"X", "[", "Global`t", "]"}], 
        RowBox[{
         RowBox[{"En", "[", "Global`t", "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"KD", "+", 
           RowBox[{"X", "[", "Global`t", "]"}]}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"rateLaw", "=", 
       RowBox[{"rateLaw", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Global`\[EmptySet]", "[", "Global`t", "]"}], "\[Rule]", 
          " ", "0"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"odes", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"X", "[", "Global`t", "]"}], ",", 
           RowBox[{"-", "rateLaw"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Y", "[", "Global`t", "]"}], ",", " ", "rateLaw"}], "}"}], 
         ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"En", "[", "Global`t", "]"}], ",", "0"}], "}"}]}], "}"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "odes", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.401033755808469*^9, 3.401033755908596*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   OverscriptBox[
    RowBox[{"A", "\[DoubleLongRightArrow]", "B"}], "C"], TraditionalForm]]],
 ", MM[k1,k2,k3]"
}], "Subsubsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"expandArrows", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Overscript", "[", 
       RowBox[{
        RowBox[{"DoubleLongRightArrow", "[", 
         RowBox[{"X_", ",", "Y_"}], " ", "]"}], ",", "En_"}], "]"}], ",", 
      RowBox[{"MM", "[", 
       RowBox[{"k1_", ",", "k2_", ",", " ", "k3_"}], "]"}]}], "}"}], "]"}], ":=",
    " ", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "reaction", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"reaction", "=", 
       RowBox[{"expandArrows", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Overscript", "[", 
           RowBox[{
            RowBox[{"DoubleLongRightArrow", "[", 
             RowBox[{"X", ",", "Y"}], "]"}], ",", "En"}], "]"}], ",", 
          RowBox[{"MM", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"k2", "+", "k3"}], ")"}], "/", "k1"}], ",", " ", "k3"}],
            "]"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "reaction", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.401033756059374*^9, 3.40103375617577*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"parseArrowForm", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Overscript", "[", 
       RowBox[{
        RowBox[{"DoubleLongRightArrow", "[", 
         RowBox[{"X_", ",", "Y_"}], " ", "]"}], ",", "En_"}], "]"}], ",", 
      RowBox[{"MM", "[", 
       RowBox[{"k1_", ",", "k2_", ",", " ", "k3_"}], "]"}]}], "}"}], "]"}], ":=",
    " ", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "odes", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"odes", "=", 
       RowBox[{"parseArrowForm", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Overscript", "[", 
           RowBox[{
            RowBox[{"DoubleLongRightArrow", "[", 
             RowBox[{"X", ",", "Y"}], "]"}], ",", "En"}], "]"}], ",", 
          RowBox[{"MM", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"k2", "+", "k3"}], ")"}], "/", "k1"}], ",", " ", "k3"}],
            "]"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "odes", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.401033756327283*^9, 3.401033756444085*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{"A", "\[DoubleLongLeftRightArrow]", "B"}], 
  TraditionalForm]]]], "Subsubsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"expandArrows", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DoubleLongLeftRightArrow", "[", 
       RowBox[{"X_", ",", "Y_"}], " ", "]"}], ",", 
      RowBox[{"MM", "[", "k___", "]"}]}], "}"}], "]"}], ":=", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "reactions", " ", ",", "r1", ",", "r2", ",", " ", "rates", ",", " ", 
       "reaction", ",", "K1", ",", "K2", ",", "v1", ",", "v2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rates", "=", 
       RowBox[{
        RowBox[{"{", "k", "}"}], "//", "Flatten"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"reaction", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"DoubleLongLeftRightArrow", "[", 
          RowBox[{"X", ",", "Y"}], "]"}], ",", 
         RowBox[{"MM", "[", 
          RowBox[{"Sequence", "@@", "rates"}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "rates", "]"}], ">", "4"}], ",", " ", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<The extra rates \>\"", ",", 
          RowBox[{"Drop", "[", 
           RowBox[{"rates", ",", "4"}], "]"}], ",", 
          "\"\< in the reaction \>\"", ",", " ", "reaction", ",", " ", 
          "\"\< will be ignored.\>\""}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "rates", "]"}], "<", "4"}], ",", " ", 
        RowBox[{"rates", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"rates", ",", "1"}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"rates", "=", 
       RowBox[{"Take", "[", 
        RowBox[{"rates", ",", "4"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"K1", ",", "v1", ",", "K2", ",", "v2"}], "}"}], "=", 
       "rates"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"r1", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"DoubleLongRightArrow", "[", 
          RowBox[{"X", ",", "Y"}], "]"}], ",", 
         RowBox[{"MM", "[", 
          RowBox[{"K1", ",", "v1"}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"r2", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"DoubleLongRightArrow", "[", 
          RowBox[{"Y", ",", "X"}], "]"}], ",", 
         RowBox[{"MM", "[", 
          RowBox[{"K2", ",", "v2"}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"reactions", "=", 
       RowBox[{"{", 
        RowBox[{"r1", ",", "r2"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "reactions", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.401033756594143*^9, 3.4010337763297167`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"parseArrowForm", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DoubleLongLeftRightArrow", "[", 
       RowBox[{"X_", ",", "Y_"}], " ", "]"}], ",", 
      RowBox[{"MM", "[", "k___", "]"}]}], "}"}], "]"}], ":=", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "odes", " ", ",", "rates", ",", " ", "reaction", ",", "reactions"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rates", "=", 
       RowBox[{
        RowBox[{"{", "k", "}"}], "//", "Flatten"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"reaction", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"DoubleLongLeftRightArrow", "[", 
          RowBox[{"X", ",", "Y"}], "]"}], ",", 
         RowBox[{"MM", "[", 
          RowBox[{"Sequence", "@@", "rates"}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"reactions", "=", 
       RowBox[{"expandArrows", "[", "reaction", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"odes", "=", 
       RowBox[{"Join", "@@", 
        RowBox[{"(", 
         RowBox[{"parseArrowForm", "/@", "reactions"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "odes", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.401033776680455*^9, 3.401033776980752*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  UnderoverscriptBox[
   RowBox[{"A", "\[DoubleLongLeftRightArrow]", "B"}], "REn", "FEn"], 
  TraditionalForm]]]], "Subsubsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"expandArrows", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Underoverscript", "[", 
       RowBox[{
        RowBox[{"DoubleLongLeftRightArrow", "[", 
         RowBox[{"X_", ",", "Y_"}], " ", "]"}], ",", "REn_", ",", "FEn_"}], 
       "]"}], ",", 
      RowBox[{"MM", "[", "k___", "]"}]}], "}"}], "]"}], ":=", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{
      "r1", ",", "r2", ",", "rates", ",", " ", "reaction", ",", " ", "kf", 
       ",", " ", "kr", ",", "n", ",", " ", "reactions"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rates", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", "k", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"reaction", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Underoverscript", "[", 
          RowBox[{
           RowBox[{"DoubleLongLeftRightArrow", "[", 
            RowBox[{"X", ",", "Y"}], "]"}], ",", "REn", ",", "FEn"}], "]"}], 
         ",", " ", 
         RowBox[{"MM", "@@", "rates"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "rates", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Switch", "[", 
       RowBox[{
       "n", ",", "\[IndentingNewLine]", "4", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"kf", "=", 
          RowBox[{"Take", "[", 
           RowBox[{"rates", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"kr", "=", 
          RowBox[{"Drop", "[", 
           RowBox[{"rates", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]",
         ",", "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"kf", "=", 
          RowBox[{"Take", "[", 
           RowBox[{"rates", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"kr", "=", 
          RowBox[{"Drop", "[", 
           RowBox[{"rates", ",", "3"}], "]"}]}], ";"}], "\[IndentingNewLine]",
         ",", "\[IndentingNewLine]", "_", "\[IndentingNewLine]", ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<The reaction \>\"", ",", "reaction", ",", 
           "\"\< should have precisely 4 or 6 rate constants.\>\""}], "]"}], 
         ";", " ", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"{", "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"r1", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Overscript", "[", 
          RowBox[{
           RowBox[{"DoubleLongRightArrow", "[", 
            RowBox[{"X", ",", "Y"}], "]"}], ",", "FEn"}], "]"}], ",", " ", 
         RowBox[{"MM", "@@", "kf"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"r2", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Overscript", "[", 
          RowBox[{
           RowBox[{"DoubleLongRightArrow", "[", 
            RowBox[{"Y", ",", "X"}], "]"}], ",", "REn"}], "]"}], ",", 
         RowBox[{"MM", "@@", "kr"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"reactions", "=", 
       RowBox[{"{", 
        RowBox[{"r1", ",", "r2"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "reactions", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.401033756845313*^9, 3.401033777433145*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"parseArrowForm", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Underoverscript", "[", 
       RowBox[{
        RowBox[{"DoubleLongLeftRightArrow", "[", 
         RowBox[{"X_", ",", "Y_"}], " ", "]"}], ",", "REn_", ",", "FEn_"}], 
       "]"}], ",", 
      RowBox[{"MM", "[", "k___", "]"}]}], "}"}], "]"}], ":=", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "odes", " ", ",", "rates", ",", " ", "reaction", ",", "reactions"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rates", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", "k", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"reaction", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Underoverscript", "[", 
          RowBox[{
           RowBox[{"DoubleLongLeftRightArrow", "[", 
            RowBox[{"X", ",", "Y"}], "]"}], ",", "REn", ",", "FEn"}], "]"}], 
         ",", " ", 
         RowBox[{"MM", "@@", "rates"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"reactions", " ", "=", " ", 
       RowBox[{"expandArrows", "[", "reaction", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"odes", "=", 
       RowBox[{"Join", "@@", 
        RowBox[{"(", 
         RowBox[{"parseArrowForm", "/@", "reactions"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "odes", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4010337775835123`*^9, 3.40103377766761*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
expandArrows: Cascade A\[DoubleLongRightArrow]B\[DoubleLongRightArrow]C\
\[DoubleLongRightArrow]... (MM)\
\>", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"expandArrows", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"DoubleLongRightArrow", "[", 
      RowBox[{"X_", ",", "Y_", " ", ",", "Z__"}], "]"}], ",", 
     RowBox[{"MM", "[", "rates___", "]"}]}], "}"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "reactants", ",", " ", "reactions", ",", "nreactions", ",", "k", ",", 
      "reaction", ",", "default"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"reaction", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DoubleLongRightArrow", "[", 
         RowBox[{"X", ",", "Y", ",", "Z"}], "]"}], ",", 
        RowBox[{"MM", "[", "rates", "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"reactants", "=", 
      RowBox[{"{", 
       RowBox[{"X", ",", "Y", ",", "Z"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"reactions", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{"reactants", ",", "2", ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nreactions", "=", 
      RowBox[{"Length", "[", "reactions", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nreactants", "=", 
      RowBox[{"Length", "[", "reactants", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"reactions", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"DoubleLongRightArrow", "@@", "#"}], "&"}], "/@", 
       "reactions"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"k", "=", 
      RowBox[{
       RowBox[{"{", "rates", "}"}], "//", "Flatten"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{
       RowBox[{"Length", "[", "k", "]"}], ",", "\[IndentingNewLine]", "0", 
       ",", "\[IndentingNewLine]", 
       RowBox[{"k", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", "nreactions", "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"default", "=", "k"}], ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "k", "]"}], "<", 
           RowBox[{"2", "*", "nreactions"}]}], ",", 
          RowBox[{"k", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"k", ",", "default"}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Partition", "[", 
          RowBox[{"k", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", ",",
        "\[IndentingNewLine]", 
       RowBox[{"2", "*", "nreactions"}], ",", 
       RowBox[{"k", "=", 
        RowBox[{"Partition", "[", 
         RowBox[{"k", ",", "2"}], "]"}]}], ",", "\[IndentingNewLine]", "_", 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "k", "]"}], "<", 
           RowBox[{"2", "*", "nreactions"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Error: Some (possibly incorrect) assumptions were made to \
determine the missing rate constants in the reaction \>\"", ",", " ", 
             "reaction"}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"OddQ", "[", 
              RowBox[{"Length", "[", "k", "]"}], "]"}], ",", 
             RowBox[{"k", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"k", ",", "1"}], "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"default", "=", 
            RowBox[{"Take", "[", 
             RowBox[{"k", ",", 
              RowBox[{"-", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "k", "]"}], "<", 
              RowBox[{"2", "*", "nreactions"}]}], ",", 
             RowBox[{"k", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"k", ",", "default"}], "]"}]}]}], "]"}], ";"}], 
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Error: extra rate constants \>\"", ",", 
             RowBox[{"Drop", "[", 
              RowBox[{"k", ",", 
               RowBox[{"2", "*", "nreactions"}]}], "]"}], ",", 
             "\"\< ignored in the reaction \>\"", ",", "reaction"}], "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"k", "=", 
            RowBox[{"Take", "[", 
             RowBox[{"k", ",", 
              RowBox[{"2", "*", "nreactions"}]}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Partition", "[", 
          RowBox[{"k", ",", "2"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"reactions", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"#1", ",", 
           RowBox[{"MM", "@@", "#2"}]}], "}"}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{"reactions", ",", "k"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "reactions", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4010337570959044`*^9, 3.401033757296939*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
parseArrowForm: Cascade A\[DoubleLongRightArrow]B\[DoubleLongRightArrow]C\
\[DoubleLongRightArrow]... (MM)\
\>", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"parseArrowForm", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DoubleLongRightArrow", "[", 
       RowBox[{"X_", ",", "Y_", " ", ",", "Z__"}], "]"}], ",", 
      RowBox[{"MM", "[", "rates___", "]"}]}], "}"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{"reactions", ",", "reaction", ",", "odes"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"reaction", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"DoubleLongRightArrow", "[", 
          RowBox[{"X", ",", "Y", ",", "Z"}], "]"}], ",", 
         RowBox[{"MM", "[", "rates", "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"reactions", "=", 
       RowBox[{"expandArrows", "[", "reaction", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"odes", "=", 
       RowBox[{"Join", "@@", 
        RowBox[{"(", 
         RowBox[{"parseArrowForm", "/@", "reactions"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "odes", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4010337574645767`*^9, 3.4010337575645037`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "expandArrows: Cascade ",
 Cell[BoxData[
  FormBox[
   OverscriptBox[
    RowBox[{
     RowBox[{
     "A", "\[DoubleLongRightArrow]", "B", "\[DoubleLongRightArrow]", "C", 
      "\[DoubleLongRightArrow]"}], "..."}], 
    RowBox[{"{", 
     RowBox[{"E1", ",", "E2", ",", "..."}], "}"}]], TraditionalForm]]],
 " (MM)"
}], "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"expandArrows", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Overscript", "[", 
      RowBox[{
       RowBox[{"DoubleLongRightArrow", "[", 
        RowBox[{"X_", ",", "Y_", " ", ",", "Z__"}], "]"}], ",", 
       "\[ScriptCapitalE]_"}], "]"}], ",", " ", 
     RowBox[{"MM", "[", "rates___", "]"}]}], "}"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "reactants", ",", " ", "reactions", ",", "nreactions", ",", "k", ",", 
      "reaction", ",", "default", ",", "modifiers"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"reaction", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Overscript", "[", 
         RowBox[{
          RowBox[{"DoubleLongRightArrow", "[", 
           RowBox[{"X", ",", "Y", ",", "Z"}], "]"}], ",", 
          "\[ScriptCapitalE]"}], "]"}], ",", 
        RowBox[{"MM", "[", "rates", "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"reactants", "=", 
      RowBox[{"{", 
       RowBox[{"X", ",", "Y", ",", "Z"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"reactions", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{"reactants", ",", "2", ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nreactions", "=", 
      RowBox[{"Length", "[", "reactions", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nreactants", "=", 
      RowBox[{"Length", "[", "reactants", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"reactions", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"DoubleLongRightArrow", "@@", "#"}], "&"}], "/@", 
       "reactions"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"modifiers", "=", 
      RowBox[{
       RowBox[{"{", "\[ScriptCapitalE]", "}"}], "//", "Flatten"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"default", "=", 
      RowBox[{"Last", "[", "modifiers", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "modifiers", "]"}], ">", "nreactions"}], ",", 
       " ", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Warning: excess modifiers \>\"", ",", 
         RowBox[{"Drop", "[", 
          RowBox[{"modifiers", ",", "nreactions"}], "]"}], ",", 
         "\"\< ignored in the reaction \>\"", ",", "reaction"}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"modifiers", "=", 
      RowBox[{"PadRight", "[", 
       RowBox[{"modifiers", ",", "nreactions", ",", "default"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"modifiers", "=", 
      RowBox[{"Take", "[", 
       RowBox[{"modifiers", ",", "nreactions"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"reactions", " ", "=", " ", 
      RowBox[{"MapThread", "[", 
       RowBox[{"Overscript", ",", 
        RowBox[{"{", 
         RowBox[{"reactions", ",", "modifiers"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"k", "=", 
      RowBox[{
       RowBox[{"{", "rates", "}"}], "//", "Flatten"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{
       RowBox[{"Length", "[", "k", "]"}], ",", "\[IndentingNewLine]", "0", 
       ",", 
       RowBox[{"k", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", "nreactions", "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "2", ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"default", "=", "k"}], ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "k", "]"}], "<", 
           RowBox[{"2", "*", "nreactions"}]}], ",", 
          RowBox[{"k", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"k", ",", "default"}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Partition", "[", 
          RowBox[{"k", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", ",",
        "\[IndentingNewLine]", "\[IndentingNewLine]", "3", ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"default", "=", "k"}], ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "k", "]"}], "<", 
           RowBox[{"3", "*", "nreactions"}]}], ",", 
          RowBox[{"k", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"k", ",", "default"}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Partition", "[", 
          RowBox[{"k", ",", "3"}], "]"}]}], ";"}], "\[IndentingNewLine]", ",",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"2", "*", "nreactions"}], ",", 
       RowBox[{"k", "=", 
        RowBox[{"Partition", "[", 
         RowBox[{"k", ",", "2"}], "]"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"3", "*", "nreactions"}], ",", 
       RowBox[{"k", "=", 
        RowBox[{"Partition", "[", 
         RowBox[{"k", ",", "3"}], "]"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "_", ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Warning: Unable to unambiguously parse the rate constants in \
the reaction \>\"", ",", " ", "reaction"}], "]"}], ";", "\[IndentingNewLine]",
         "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "k", "]"}], "<", 
           RowBox[{"2", "*", "nreactions"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"OddQ", "[", 
              RowBox[{"Length", "[", "k", "]"}], "]"}], ",", 
             RowBox[{"k", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"k", ",", "1"}], "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"default", "=", 
            RowBox[{"Take", "[", 
             RowBox[{"k", ",", 
              RowBox[{"-", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "k", "]"}], "<", 
              RowBox[{"2", "*", "nreactions"}]}], ",", 
             RowBox[{"k", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"k", ",", "default"}], "]"}]}]}], "]"}], ";"}], 
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"k", "=", 
            RowBox[{"Take", "[", 
             RowBox[{"k", ",", 
              RowBox[{"2", "*", "nreactions"}]}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Partition", "[", 
          RowBox[{"k", ",", "2"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"reactions", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"#1", ",", 
           RowBox[{"MM", "@@", "#2"}]}], "}"}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{"reactions", ",", "k"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "reactions", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.401033757714532*^9, 3.4010337579155684`*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 "parseArrowForm: Cascade ",
 Cell[BoxData[
  FormBox[
   OverscriptBox[
    RowBox[{
     RowBox[{
     "A", "\[DoubleLongRightArrow]", "B", "\[DoubleLongRightArrow]", "C", 
      "\[DoubleLongRightArrow]"}], "..."}], 
    RowBox[{"{", 
     RowBox[{"E1", ",", "E2", ",", "..."}], "}"}]], TraditionalForm]]],
 " (MM)"
}], "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"parseArrowForm", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Overscript", "[", 
        RowBox[{
         RowBox[{"DoubleLongRightArrow", "[", 
          RowBox[{"X_", ",", "Y_", " ", ",", "Z__"}], "]"}], ",", 
         "\[ScriptCapitalE]_"}], "]"}], ",", " ", 
       RowBox[{"MM", "[", "rates___", "]"}]}], "}"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{"reactions", ",", "reaction", ",", "odes"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"reaction", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Overscript", "[", 
           RowBox[{
            RowBox[{"DoubleLongRightArrow", "[", 
             RowBox[{"X", ",", "Y", ",", "Z"}], "]"}], ",", 
            "\[ScriptCapitalE]"}], "]"}], ",", 
          RowBox[{"MM", "[", "rates", "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"reactions", " ", "=", " ", 
        RowBox[{"expandArrows", "[", "reaction", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"odes", "=", 
        RowBox[{"Join", "@@", 
         RowBox[{"(", " ", 
          RowBox[{"parseArrowForm", "/@", "reactions"}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "odes", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.401033758082321*^9, 3.40103375818298*^9}}]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Rational Functions", "Subsection",
 CellDingbat->None,
 CellChangeTimes->{{3.523631504478467*^9, 3.523631506149652*^9}},
 Background->RGBColor[1, 0.983139, 0.832074]],

Cell["\<\
{{act, inh}\[DoubleLongRightArrow] prod, rational[ {ai,..}, {di,..}, {ni,..}, \
{mi..}]}\
\>", "Subsubsection",
 CellChangeTimes->{{3.523631524146043*^9, 3.523631583925948*^9}, {
  3.523631645422634*^9, 3.523631652888277*^9}, {3.523640549097804*^9, 
  3.523640563562139*^9}, {3.5236411592018223`*^9, 3.5236411673219*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"expandArrows", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"DoubleLongRightArrow", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "Activator__", "}"}], ",", " ", 
           RowBox[{"{", "Inhibitor__", "}"}]}], "}"}], ",", " ", "product_"}],
         "]"}], ",", " ", 
       RowBox[{"rational", "[", 
        RowBox[{
         RowBox[{"{", "act__", "}"}], ",", " ", 
         RowBox[{"{", "inh__", "}"}]}], "]"}]}], "}"}], "]"}], ":=", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"expandArrows", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"DoubleLongRightArrow", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "Activator", "}"}], ",", " ", 
           RowBox[{"{", "Inhibitor", "}"}]}], "}"}], ",", " ", "product"}], 
        "]"}], ",", " ", 
       RowBox[{"rational", "[", 
        RowBox[{
         RowBox[{"{", "act", "}"}], ",", " ", 
         RowBox[{"{", "inh", "}"}], ",", " ", 
         RowBox[{"Table", "[", 
          RowBox[{"1", ",", " ", 
           RowBox[{"{", 
            RowBox[{"Length", "[", 
             RowBox[{"{", "Activator", "}"}], "]"}], "}"}]}], "]"}], ",", " ", 
         RowBox[{"Table", "[", 
          RowBox[{"1", ",", " ", 
           RowBox[{"{", 
            RowBox[{"Length", "[", 
             RowBox[{"{", "Inhibitor", "}"}], "]"}], "}"}]}], "]"}]}], 
        "]"}]}], "}"}], "]"}]}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"expandArrows", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"DoubleLongRightArrow", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "Activator__", "}"}], ",", " ", 
           RowBox[{"{", "Inhibitor__", "}"}]}], "}"}], ",", " ", "product_"}],
         "]"}], ",", " ", 
       RowBox[{"rational", "[", 
        RowBox[{
         RowBox[{"{", "act__", "}"}], ",", " ", 
         RowBox[{"{", "inh__", "}"}], ",", " ", 
         RowBox[{"{", "n__", "}"}]}], "]"}]}], "}"}], "]"}], ":=", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"expandArrows", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"DoubleLongRightArrow", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "Activator", "}"}], ",", " ", 
           RowBox[{"{", "Inhibitor", "}"}]}], "}"}], ",", " ", "product"}], 
        "]"}], ",", " ", 
       RowBox[{"rational", "[", 
        RowBox[{
         RowBox[{"{", "act", "}"}], ",", " ", 
         RowBox[{"{", "inh", "}"}], ",", " ", 
         RowBox[{"{", "n", "}"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{"1", ",", " ", 
           RowBox[{"{", 
            RowBox[{"Length", "[", 
             RowBox[{"{", "Inhibitor", "}"}], "]"}], "}"}]}], "]"}]}], 
        "]"}]}], "}"}], "]"}]}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expandArrows", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DoubleLongRightArrow", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "Activator__", "}"}], ",", " ", 
          RowBox[{"{", "Inhibitor__", "}"}]}], "}"}], ",", " ", "product_"}], 
       "]"}], ",", " ", 
      RowBox[{"rational", "[", 
       RowBox[{
        RowBox[{"{", "act__", "}"}], ",", " ", 
        RowBox[{"{", "inh__", "}"}], ",", " ", 
        RowBox[{"{", "n__", "}"}], ",", 
        RowBox[{"{", "m__", "}"}]}], "]"}]}], "}"}], "]"}], ":=", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "reaction", ",", " ", "acts", ",", " ", "NA", ",", " ", "NI", ",", " ", 
       "inhs", ",", " ", "nvals", ",", " ", "mvals"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"NA", " ", "=", " ", 
       RowBox[{"Length", "[", 
        RowBox[{"{", "Activator", "}"}], "]"}]}], ";", " ", 
      RowBox[{"NI", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"{", "Inhibitor", "}"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"acts", " ", "=", " ", 
       RowBox[{"{", "act", "}"}]}], ";", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "acts", "]"}], "\[LessEqual]", " ", "NA"}], 
        ",", " ", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"acts", ",", "1"}], "]"}]}], "]"}], ";", "  ", 
      RowBox[{"acts", "=", 
       RowBox[{"Take", "[", 
        RowBox[{"acts", ",", 
         RowBox[{"NA", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"inhs", "=", 
       RowBox[{"{", "inh", "}"}]}], ";", " ", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "inhs", "]"}], "\[LessEqual]", " ", "NI"}], 
        ",", " ", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"inhs", ",", " ", "1"}], "]"}]}], "]"}], ";", " ", 
      RowBox[{"inhs", "=", 
       RowBox[{"Take", "[", 
        RowBox[{"inhs", ",", " ", 
         RowBox[{"NI", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nvals", "=", 
       RowBox[{"{", "n", "}"}]}], ";", " ", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "nvals", "]"}], "<", "NA"}], ",", " ", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"nvals", ",", " ", "1"}], "]"}]}], "]"}], ";", "  ", 
      RowBox[{"nvals", "=", 
       RowBox[{"Take", "[", 
        RowBox[{"nvals", ",", "NA"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"mvals", "=", 
       RowBox[{"{", "m", "}"}]}], ";", " ", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "mvals", "]"}], "<", "NI"}], ",", " ", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"mvals", ",", " ", "1"}], "]"}]}], "]"}], ";", " ", 
      RowBox[{"mvals", "=", 
       RowBox[{"Take", "[", 
        RowBox[{"mvals", ",", " ", "NI"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"reaction", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"DoubleLongRightArrow", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "Activator", "}"}], ",", " ", 
             RowBox[{"{", "Inhibitor", "}"}]}], "}"}], ",", " ", "product"}], 
          "]"}], ",", " ", 
         RowBox[{"rational", "[", 
          RowBox[{
          "acts", ",", " ", "inhs", ",", " ", "nvals", ",", " ", "mvals"}], 
          "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"dbgArrows", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<expandArrows:\>\"", ",", " ", "reaction"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", "reaction", "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"expandArrows", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"DoubleLongRightArrow", "[", "x___", "]"}], ",", 
       RowBox[{"rational", "[", "y___", "]"}]}], "}"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "Print", "[", 
        "\"\<Error: invalid format for rational function activation.\>\"", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", "}"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4010338005468082`*^9, 3.40103380062965*^9}, {
  3.511652196151671*^9, 3.511652204299816*^9}, {3.511653054182652*^9, 
  3.511653062143474*^9}, {3.5236316004115467`*^9, 3.523631626690311*^9}, {
  3.523631662946793*^9, 3.523631663675744*^9}, {3.523631699199706*^9, 
  3.523631862347766*^9}, {3.523631936975313*^9, 3.523631937126296*^9}, {
  3.5236320030381317`*^9, 3.523632003243328*^9}, {3.523632438931499*^9, 
  3.523632519092688*^9}, {3.523632563943519*^9, 3.523632565478306*^9}, {
  3.523633062193199*^9, 3.523633090329686*^9}, {3.5236376504181967`*^9, 
  3.523637861740511*^9}, {3.52363790124715*^9, 3.5236379218199587`*^9}, {
  3.523638508286558*^9, 3.523638706270071*^9}, {3.523638745359886*^9, 
  3.523638829268702*^9}, {3.523640566748543*^9, 3.523640580426198*^9}, {
  3.52364112506199*^9, 3.523641136048661*^9}, {3.523642144556735*^9, 
  3.5236421589939623`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"parseArrowForm", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"DoubleLongRightArrow", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "Activator__", "}"}], ",", " ", 
           RowBox[{"{", "Inhibitor__", "}"}]}], "}"}], ",", " ", "product_"}],
         "]"}], ",", " ", 
       RowBox[{"rational", "[", 
        RowBox[{
         RowBox[{"{", "act__", "}"}], ",", " ", 
         RowBox[{"{", "inh__", "}"}]}], "]"}]}], "}"}], "]"}], ":=", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"parseArrowForm", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"DoubleLongRightArrow", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "Activator", "}"}], ",", " ", 
           RowBox[{"{", "Inhibitor", "}"}]}], "}"}], ",", " ", "product"}], 
        "]"}], ",", " ", 
       RowBox[{"rational", "[", 
        RowBox[{
         RowBox[{"{", "act", "}"}], ",", " ", 
         RowBox[{"{", "inh", "}"}], ",", " ", 
         RowBox[{"{", "1", "}"}], ",", 
         RowBox[{"{", "1", "}"}]}], "]"}]}], "}"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"parseArrowForm", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"DoubleLongRightArrow", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "Activator__", "}"}], ",", " ", 
           RowBox[{"{", "Inhibitor__", "}"}]}], "}"}], ",", " ", "product_"}],
         "]"}], ",", " ", 
       RowBox[{"rational", "[", 
        RowBox[{
         RowBox[{"{", "act__", "}"}], ",", " ", 
         RowBox[{"{", "inh__", "}"}], ",", " ", 
         RowBox[{"{", "n__", "}"}]}], "]"}]}], "}"}], "]"}], ":=", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"parseArrowForm", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"DoubleLongRightArrow", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "Activator", "}"}], ",", " ", 
           RowBox[{"{", "Inhibitor", "}"}]}], "}"}], ",", " ", "product"}], 
        "]"}], ",", " ", 
       RowBox[{"rational", "[", 
        RowBox[{
         RowBox[{"{", "act", "}"}], ",", " ", 
         RowBox[{"{", "inh", "}"}], ",", " ", 
         RowBox[{"{", "n", "}"}], ",", 
         RowBox[{"{", "1", "}"}]}], "]"}]}], "}"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"parseArrowForm", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DoubleLongRightArrow", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "Activator__", "}"}], ",", " ", 
          RowBox[{"{", "Inhibitor__", "}"}]}], "}"}], ",", " ", "product_"}], 
       "]"}], ",", " ", 
      RowBox[{"rational", "[", 
       RowBox[{
        RowBox[{"{", "act__", "}"}], ",", " ", 
        RowBox[{"{", "inh__", "}"}], ",", " ", 
        RowBox[{"{", "n__", "}"}], ",", " ", 
        RowBox[{"{", "m__", "}"}]}], "]"}]}], "}"}], "]"}], ":=", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "avars", ",", " ", "ivars", ",", " ", "navars", ",", " ", "nivars", ",",
        " ", "nvals", ",", " ", "mvals", ",", " ", "arates", ",", " ", 
       "irates", ",", " ", "myTimes", ",", "\[IndentingNewLine]", "dummy", 
       ",", "\[IndentingNewLine]", "odes", ",", "rateLaw", ",", " ", 
       "functionize"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"reaction", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"DoubleLongRightArrow", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "Activator", "}"}], ",", " ", 
             RowBox[{"{", "Inhibitor", "}"}]}], "}"}], ",", " ", "product"}], 
          "]"}], ",", " ", 
         RowBox[{"rational", "[", 
          RowBox[{
           RowBox[{"{", "act", "}"}], ",", " ", 
           RowBox[{"{", "inh", "}"}], ",", " ", 
           RowBox[{"{", "n", "}"}], ",", " ", 
           RowBox[{"{", "m", "}"}]}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"dbgArrows", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<parseArrowForm:\>\"", ",", " ", "reaction"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"functionize", "[", 
        RowBox[{"myTimes", "[", "x__", "]"}], "]"}], ":=", " ", 
       RowBox[{"Apply", "[", 
        RowBox[{"myTimes", ",", 
         RowBox[{"functionize", "/@", 
          RowBox[{"List", "[", "x", "]"}]}]}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"functionize", "[", "x_", "]"}], ":=", " ", 
       RowBox[{"x", "[", "Global`t", "]"}]}], ";", " ", "\[IndentingNewLine]",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"avars", " ", "=", " ", 
       RowBox[{
        RowBox[{"{", "Activator", "}"}], "//", "Flatten"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ivars", " ", "=", " ", 
       RowBox[{
        RowBox[{"{", "Inhibitor", "}"}], "//", "Flatten"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dummy", " ", "=", 
       RowBox[{"Union", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"avars", ",", "ivars"}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{"Times", "\[Rule]", " ", "List"}], "}"}]}], "]"}], "]"}]}],
       ";", " ", "\[IndentingNewLine]", 
      RowBox[{"dummy", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Rule", "[", 
            RowBox[{"#", ",", "#"}], "]"}], ",", "1"}], "}"}], "&"}], "/@", 
        "dummy"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dummy", "  ", "=", " ", 
       RowBox[{"Join", "@@", 
        RowBox[{"(", 
         RowBox[{"parseArrowForm", "/@", "dummy"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"avars", " ", "=", 
       RowBox[{
        RowBox[{"(", " ", 
         RowBox[{"functionize", "/@", 
          RowBox[{"(", 
           RowBox[{"avars", "/.", 
            RowBox[{"{", 
             RowBox[{"Times", "\[Rule]", "myTimes"}], "}"}]}], ")"}]}], ")"}],
         "/.", 
        RowBox[{"{", 
         RowBox[{"myTimes", "\[Rule]", " ", "Times"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ivars", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"functionize", "/@", 
          RowBox[{"(", 
           RowBox[{"ivars", "/.", 
            RowBox[{"{", 
             RowBox[{"Times", "\[Rule]", "myTimes"}], "}"}]}], ")"}]}], ")"}],
         "/.", 
        RowBox[{"{", 
         RowBox[{"myTimes", "\[Rule]", " ", "Times"}], "}"}]}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"navars", "=", 
       RowBox[{"Length", "[", "avars", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"nivars", "=", " ", 
       RowBox[{"Length", "[", "ivars", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"nvals", " ", "=", " ", 
       RowBox[{"{", "n", "}"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "nvals", "]"}], "<", "navars"}], ",", " ", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"nvals", ",", "1"}], "]"}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"nvals", "=", 
       RowBox[{"Take", "[", 
        RowBox[{"nvals", ",", "navars"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"avars", " ", "=", " ", 
       RowBox[{"avars", "^", "nvals"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"PrependTo", "[", 
       RowBox[{"avars", ",", " ", "1"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"mvals", "=", 
       RowBox[{"{", "m", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "mvals", "]"}], "<", "nivars"}], ",", " ", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"mvals", ",", " ", "1"}], "]"}]}], "]"}], " ", ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"mvals", "=", 
       RowBox[{"Take", "[", 
        RowBox[{"mvals", ",", " ", "nivars"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"ivars", " ", "=", " ", 
       RowBox[{"ivars", "^", "mvals"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"PrependTo", "[", 
       RowBox[{"ivars", ",", " ", "1"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"for", " ", "rates"}], ",", " ", 
        RowBox[{"include", " ", "leading", " ", "constant"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"arates", "=", 
       RowBox[{"{", "act", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "arates", "]"}], "\[LessEqual]", " ", 
         "navars"}], ",", " ", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"arates", ",", "1"}], "]"}]}], "]"}], ";", "  ", 
      "\[IndentingNewLine]", 
      RowBox[{"arates", " ", "=", " ", 
       RowBox[{"Take", "[", 
        RowBox[{"arates", ",", " ", 
         RowBox[{"navars", "+", "1"}]}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"irates", "=", 
       RowBox[{"{", "inh", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "irates", "]"}], "\[LessEqual]", " ", 
         "nivars"}], ",", " ", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"irates", ",", "1"}], "]"}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"irates", " ", "=", " ", 
       RowBox[{"Take", "[", 
        RowBox[{"irates", ",", " ", 
         RowBox[{"nivars", "+", "1"}]}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"rateLaw", " ", "=", " ", 
       FractionBox[
        RowBox[{"avars", ".", "arates"}], 
        RowBox[{"ivars", ".", "irates"}]]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"rateLaw", "=", 
       RowBox[{"rateLaw", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Global`\[EmptySet]", "[", "Global`t", "]"}], "\[Rule]", 
          " ", "0"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"product", ",", "Global`\[EmptySet]"}], "]"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"odes", "=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"#", ",", 
               RowBox[{"-", "rateLaw"}]}], "}"}], "&"}], ",", "vars"}], 
           "]"}]}], ";"}], " ", "\[IndentingNewLine]", ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"odes", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"product", "[", "Global`t", "]"}], ",", " ", "rateLaw"}],
             "}"}], "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"odes", " ", "=", " ", 
       RowBox[{"Join", "@@", 
        RowBox[{"{", 
         RowBox[{"odes", ",", "dummy"}], "}"}]}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "odes", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQB2IQ/TSfn+WMwyvHR9rlnCD6zoMIPhD9RlBTDESLnV8g
DaItKtNtQfQeEz4XEO11dWs2iGbTr6gC0Q3OF+pA9IxTq3tB9NO657NAdMeP
WUtBdOrM0GUguutD+UYQXeTHsQlEz6mvOgiiw/7uPQGi532IuAiib967fAtE
m/YERJwD0tsE9iSAaJeu5iwwf93NHBA9yfhjKYh+o2RbBqLvnFhQA6IjWpJr
QfS8496tIPrAYu8eEJ3f7z8BRN89dHEiiLawnToNRN+o3gSme9wYPoHorbVP
P4Pt0X+w4DyQ/ir/aiGI/tXu/QxEi5h6PgfRW+OnaViUAe2dM0MbRBc2hBmA
6KpudlsQ/WmHriOItmGa6A+iAaKJxNk=
  "]]
}, Closed]],

Cell[CellGroupData[{

Cell["Hill Functions ", "Subsection",
 CellDingbat->None,
 Background->RGBColor[1, 0.983139, 0.832074]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   OverscriptBox[
    RowBox[{"A", "\[RightTeeArrow]", "B"}], "C"], TraditionalForm]]],
 ", hill[v, K, n, r] (catalytic hill functions)"
}], "Subsubsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"expandArrows", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Overscript", "[", 
       RowBox[{
        RowBox[{"RightTeeArrow", "[", 
         RowBox[{"X_", ",", "Y_"}], " ", "]"}], ",", "En_"}], "]"}], ",", 
      RowBox[{"hill", "[", 
       RowBox[{
        RowBox[{"v_:", "1"}], ",", 
        RowBox[{"n_:", "1"}], ",", 
        RowBox[{"K_:", "1"}], ",", 
        RowBox[{"a_:", "0"}], ",", 
        RowBox[{"T_:", "1"}], ",", " ", 
        RowBox[{"v1_:", "0"}]}], "]"}]}], "}"}], "]"}], ":=", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "reaction", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"reaction", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Overscript", "[", 
          RowBox[{
           RowBox[{"RightTeeArrow", "[", 
            RowBox[{"X", ",", "Y"}], "]"}], ",", "En"}], "]"}], ",", 
         RowBox[{"hill", "[", 
          RowBox[{
          "v", ",", "n", ",", "K", ",", "a", ",", "T", ",", " ", "v1"}], 
          "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"dbgArrows", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<expandArrows:\>\"", ",", " ", "reaction"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", "reaction", "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4010338005468082`*^9, 3.40103380062965*^9}, {
  3.511652196151671*^9, 3.511652204299816*^9}, {3.511653054182652*^9, 
  3.511653062143474*^9}, {3.561662337570916*^9, 3.561662348460672*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"parseArrowForm", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Overscript", "[", 
        RowBox[{
         RowBox[{"RightTeeArrow", "[", 
          RowBox[{
           RowBox[{"Plus", "[", 
            RowBox[{"X_", ",", "X1__"}], "]"}], ",", "Y_"}], " ", "]"}], ",", 
         "En_"}], "]"}], ",", 
       RowBox[{"hill", "[", 
        RowBox[{
         RowBox[{"v_:", "1"}], ",", 
         RowBox[{"n_:", "1"}], ",", 
         RowBox[{"K_:", "1"}], ",", 
         RowBox[{"r_:", "0"}], ",", 
         RowBox[{"m_:", "1"}], ",", " ", 
         RowBox[{"v1_:", "0"}]}], "]"}]}], "}"}], "]"}], ":=", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"odes", ",", "rateLaw", ",", " ", "vars", ",", "x"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"reaction", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Overscript", "[", 
           RowBox[{
            RowBox[{"RightTeeArrow", "[", 
             RowBox[{
              RowBox[{"Plus", "[", "X", "]"}], ",", "Y"}], "]"}], ",", "En"}],
            "]"}], ",", 
          RowBox[{"hill", "[", 
           RowBox[{"v", ",", "n", ",", "K", ",", "r", ",", "m", ",", "v1"}], 
           "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"dbgArrows", ",", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<parseArrowForm:\>\"", ",", " ", "reaction"}], "]"}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"vars", "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"X", ",", "X1"}], "}"}], "//", "Flatten"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"odes", " ", "=", " ", 
        RowBox[{"parseArrowForm", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Overscript", "[", 
            RowBox[{
             RowBox[{"RightTeeArrow", "[", 
              RowBox[{"vars", ",", "Y"}], "]"}], ",", "En"}], "]"}], ",", 
           RowBox[{"hill", "[", 
            RowBox[{"v", ",", "n", ",", "K", ",", "r", ",", "m", ",", "v1"}], 
            "]"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "odes", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"this", " ", "module", " ", 
    RowBox[{"sig", ".", " ", "revised"}], " ", "v", ".0", ".81"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"parseArrowForm", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Overscript", "[", 
       RowBox[{
        RowBox[{"RightTeeArrow", "[", 
         RowBox[{"X_", ",", "Y_"}], " ", "]"}], ",", "En_"}], "]"}], ",", 
      RowBox[{"hill", "[", 
       RowBox[{
        RowBox[{"v_:", "1"}], ",", 
        RowBox[{"n_:", "1"}], ",", 
        RowBox[{"k_:", "1"}], ",", 
        RowBox[{"r_:", "0"}], ",", 
        RowBox[{"m_:", "1"}], ",", " ", 
        RowBox[{"v1_:", "0"}]}], "]"}]}], "}"}], "]"}], ":=", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "odes", ",", "rateLaw", ",", " ", "vars", ",", "x", ",", " ", "nvars", 
       ",", " ", "V", ",", " ", "K", ",", " ", "nn", ",", " ", "rr", ",", " ",
        "multiplier", ",", " ", "enzyme", ",", "inhrate"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"reaction", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Overscript", "[", 
          RowBox[{
           RowBox[{"RightTeeArrow", "[", 
            RowBox[{"X", ",", "Y"}], "]"}], ",", "En"}], "]"}], ",", 
         RowBox[{"hill", "[", 
          RowBox[{"v", ",", "n", ",", "k", ",", "r", ",", "m", ",", "v1"}], 
          "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"dbgArrows", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<parseArrowForm:\>\"", ",", " ", "reaction"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"vars", "=", 
       RowBox[{
        RowBox[{"{", "X", "}"}], "//", "Flatten"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vars", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"#", "[", "Global`t", "]"}], "&"}], ")"}], "/@", "vars"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"nvars", " ", "=", " ", 
       RowBox[{"Length", "[", "vars", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"V", "=", 
       RowBox[{"getnValues", "[", 
        RowBox[{
        "nvars", ",", "m", ",", "\"\<Hill rates\>\"", ",", "reaction"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"K", "=", 
       RowBox[{"getSingleValue", "[", 
        RowBox[{
        "k", ",", "1", ",", "\"\<Hill constants\>\"", ",", " ", "reaction"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nn", "=", 
       RowBox[{"getSingleValue", "[", 
        RowBox[{
        "n", ",", "1", ",", "\"\<Hill exponents\>\"", ",", "reaction"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rr", "=", 
       RowBox[{"getSingleValue", "[", 
        RowBox[{
        "r", ",", "0", ",", "\"\<Basal rate\>\"", ",", " ", "reaction"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"multiplier", "=", 
       RowBox[{"getSingleValue", "[", 
        RowBox[{"v", ",", "1", ",", "\"\<multiplier\>\"", ",", "reaction"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"inhrate", "=", 
       RowBox[{"getSingleValue", "[", 
        RowBox[{
        "v1", ",", " ", "0", ",", " ", "\"\<Inhibition Rate\>\"", ",", " ", 
         "reaction"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"x", "=", 
         RowBox[{"rr", "+", 
          RowBox[{"Plus", "@@", 
           RowBox[{"(", 
            RowBox[{"V", "*", "vars"}], ")"}]}]}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"x", "=", 
       RowBox[{"rr", " ", "+", " ", 
        RowBox[{"V", ".", "vars"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "let", " ", "\[EmptySet]", " ", "act", " ", "as", " ", "a", " ", 
        "Unit", " ", "Catalyst", " ", "rather", " ", "than", " ", "Zero", " ",
         "Catalyst"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"enzyme", " ", "=", " ", 
       RowBox[{
        RowBox[{"En", "[", "Global`t", "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Global`\[EmptySet]", "[", "Global`t", "]"}], "\[Rule]", 
          " ", "1"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"rateLaw", "=", 
       RowBox[{
        RowBox[{"enzyme", "*", "multiplier", "*", 
         RowBox[{"hillFunction", "[", 
          RowBox[{"x", ",", "K", ",", " ", "nn", ",", "1", ",", "0"}], 
          "]"}]}], "+", 
        RowBox[{"enzyme", "*", 
         RowBox[{"hillFunction", "[", 
          RowBox[{"x", ",", "K", ",", "nn", ",", "0", ",", "v1"}], 
          "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rateLaw", "=", 
       RowBox[{"rateLaw", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Global`\[EmptySet]", "[", "Global`t", "]"}], "\[Rule]", 
          " ", "0"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"rateLaw", "=", 
         RowBox[{"m", "*", 
          RowBox[{"hillFunction", "[", 
           RowBox[{"x", ",", "k", ",", " ", "n", ",", 
            RowBox[{"v", "*", 
             RowBox[{"En", "[", "Global`t", "]"}]}], ",", "r"}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"rateLaw", "=", 
         RowBox[{"rateLaw", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Global`\[EmptySet]", "[", "Global`t", "]"}], "\[Rule]", 
            " ", "0"}], "}"}]}]}], ";"}], "\[IndentingNewLine]", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"odes", " ", "=", " ", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"#", ",", 
             RowBox[{"-", "rateLaw"}]}], "}"}], "&"}], "/@", "vars"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Y", "[", "Global`t", "]"}], ",", " ", "rateLaw"}], 
            "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"En", "[", "Global`t", "]"}], ",", "0"}], "}"}]}], 
          "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "odes", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4010338007638893`*^9, 3.4010338013156557`*^9}, {
  3.511652209715049*^9, 3.511652229144446*^9}, {3.5116524079292183`*^9, 
  3.511652486395681*^9}, {3.511652526955443*^9, 3.511652567804803*^9}, {
  3.5116526978392477`*^9, 3.511652776003211*^9}, {3.5116530656461563`*^9, 
  3.511653095545794*^9}, {3.511653151148931*^9, 3.511653198423263*^9}, {
  3.542294122095068*^9, 3.542294217203143*^9}, {3.561662355760433*^9, 
  3.56166246474177*^9}, {3.5616625105931253`*^9, 3.5616625179232388`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
{ A\[RightTeeArrow]B, hill[v, K, n, r] }  (regulatory  hill functions)\
\>", "Subsubsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"expandArrows", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RightTeeArrow", "[", 
       RowBox[{"X_", ",", "Y_"}], " ", "]"}], ",", 
      RowBox[{"hill", "[", 
       RowBox[{
        RowBox[{"v_:", "1"}], ",", 
        RowBox[{"n_:", "1"}], ",", 
        RowBox[{"K_:", "1"}], ",", 
        RowBox[{"r_:", "0"}], ",", 
        RowBox[{"m_:", "1"}], ",", " ", 
        RowBox[{"\[Beta]_:", "0"}]}], "]"}]}], "}"}], "]"}], ":=", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "reaction", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"reaction", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"RightTeeArrow", "[", 
          RowBox[{"X", ",", "Y"}], "]"}], ",", 
         RowBox[{"hill", "[", 
          RowBox[{
          "v", ",", "n", ",", "K", ",", "r", ",", "m", ",", " ", "\[Beta]"}], 
          "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"dbgArrows", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<expandArrows:\>\"", ",", " ", "reaction"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", "reaction", "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expandArrows", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RightTeeArrow", "[", 
       RowBox[{
        RowBox[{"Plus", "[", 
         RowBox[{"X_", ",", "X1__"}], "]"}], ",", "Y_"}], " ", "]"}], ",", 
      RowBox[{"hill", "[", 
       RowBox[{
        RowBox[{"v_:", "1"}], ",", 
        RowBox[{"n_:", "1"}], ",", 
        RowBox[{"K_:", "1"}], ",", 
        RowBox[{"r_:", "0"}], ",", 
        RowBox[{"m_:", "1"}], ",", " ", 
        RowBox[{"\[Beta]_:", "0"}]}], "]"}]}], "}"}], "]"}], ":=", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"reaction", ",", "vars"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"vars", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", ",", "X1"}], "}"}], "//", "Flatten"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"reaction", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"RightTeeArrow", "[", 
          RowBox[{"vars", ",", "Y"}], "]"}], ",", 
         RowBox[{"hill", "[", 
          RowBox[{
          "v", ",", "n", ",", "K", ",", "r", ",", "m", ",", " ", "\[Beta]"}], 
          "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"dbgArrows", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<expandArrows:\>\"", ",", " ", "reaction"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", "reaction", "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4010338014489193`*^9, 3.4010338017165728`*^9}, {
  3.5116510989088497`*^9, 3.5116511387967157`*^9}, {3.561652773554154*^9, 
  3.5616528199255867`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"parseArrowForm", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"RightTeeArrow", "[", 
        RowBox[{
         RowBox[{"Plus", "[", 
          RowBox[{"X_", ",", "X1__"}], "]"}], ",", "Y_"}], " ", "]"}], ",", 
       RowBox[{"hill", "[", 
        RowBox[{
         RowBox[{"v_:", "1"}], ",", 
         RowBox[{"n_:", "1"}], ",", 
         RowBox[{"K_:", "1"}], ",", 
         RowBox[{"r_:", "0"}], ",", 
         RowBox[{"m_:", "1"}], ",", " ", 
         RowBox[{"\[Beta]_:", "0"}]}], "]"}]}], "}"}], "]"}], ":=", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "odes", ",", "rateLaw", ",", " ", "vars", ",", "x", ",", " ", 
        "reaction"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vars", "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"X", ",", "X1"}], "}"}], "//", "Flatten"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"odes", " ", "=", " ", 
        RowBox[{"parseArrowForm", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"RightTeeArrow", "[", 
            RowBox[{"vars", ",", "Y"}], "]"}], ",", 
           RowBox[{"hill", "[", 
            RowBox[{
            "v", ",", "n", ",", "K", ",", "r", ",", "m", ",", "\[Beta]"}], 
            "]"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "odes", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"parseArrowForm", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RightTeeArrow", "[", 
       RowBox[{"X_", ",", "Y_"}], " ", "]"}], ",", 
      RowBox[{"hill", "[", 
       RowBox[{
        RowBox[{"v_:", "1"}], ",", 
        RowBox[{"n_:", "1"}], ",", 
        RowBox[{"k_:", "1"}], ",", 
        RowBox[{"r_:", "0"}], ",", 
        RowBox[{"mult_:", "1"}], ",", " ", 
        RowBox[{"\[Beta]_:", "0"}]}], "]"}]}], "}"}], "]"}], ":=", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "odes", ",", "rateLaw", ",", " ", "vars", ",", "x", ",", "nvars", ",", 
       "V", ",", " ", "K", ",", "nn", ",", "rr", ",", "multiplier", ",", " ", 
       "reaction", ",", " ", "dummy", ",", " ", "basalinh"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"reaction", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"RightTeeArrow", "[", 
          RowBox[{"X", ",", "Y"}], "]"}], ",", 
         RowBox[{"hill", "[", 
          RowBox[{
          "v", ",", "n", ",", "k", ",", "r", ",", "mult", ",", "\[Beta]"}], 
          "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"dbgArrows", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<parseArrowForm:\>\"", ",", " ", "reaction"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"vars", "=", 
       RowBox[{
        RowBox[{"{", "X", "}"}], "//", "Flatten"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dummy", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Rule", "[", 
            RowBox[{"#", ",", "#"}], "]"}], ",", "1"}], "}"}], "&"}], "/@", 
        "vars"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"vars", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"#", "[", "Global`t", "]"}], "&"}], ")"}], "/@", "vars"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"nvars", "=", 
       RowBox[{"Length", "[", "vars", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"V", "=", 
       RowBox[{"getnValues", "[", 
        RowBox[{
        "nvars", ",", "mult", ",", "\"\<Hill rates\>\"", ",", "reaction"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"K", "=", 
       RowBox[{"getSingleValue", "[", 
        RowBox[{
        "k", ",", "1", ",", "\"\<Hill constants\>\"", ",", " ", "reaction"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nn", "=", 
       RowBox[{"getSingleValue", "[", 
        RowBox[{
        "n", ",", "1", ",", "\"\<Hill exponents\>\"", ",", "reaction"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rr", "=", 
       RowBox[{"getSingleValue", "[", 
        RowBox[{
        "r", ",", "0", ",", "\"\<Basal rate\>\"", ",", " ", "reaction"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"multiplier", "=", 
       RowBox[{"getSingleValue", "[", 
        RowBox[{"v", ",", "1", ",", "\"\<multiplier\>\"", ",", "reaction"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"basalinh", "=", 
       RowBox[{"getSingleValue", "[", 
        RowBox[{
        "\[Beta]", ",", " ", "0", ",", " ", "\"\<Basal Inhibition Rate\>\"", 
         ",", " ", "reaction"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"x", "=", 
         RowBox[{"rr", "+", 
          RowBox[{"Plus", "@@", 
           RowBox[{"(", 
            RowBox[{"V", "*", "vars"}], ")"}]}]}]}], ";"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"x", "=", 
       RowBox[{"rr", "+", 
        RowBox[{"(", 
         RowBox[{"V", ".", "vars"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"rateLaw", "=", 
       RowBox[{
        RowBox[{"multiplier", "*", 
         RowBox[{"hillFunction", "[", 
          RowBox[{"x", ",", "K", ",", " ", "nn", ",", "1", ",", "0"}], 
          "]"}]}], " ", "+", " ", 
        RowBox[{"hillFunction", "[", 
         RowBox[{
         "x", ",", " ", "K", ",", " ", "n", ",", " ", "0", ",", " ", 
          "basalinh"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rateLaw", "=", 
       RowBox[{"rateLaw", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Global`\[EmptySet]", "[", "Global`t", "]"}], "\[Rule]", 
          " ", "0"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"Y", ",", "Global`\[EmptySet]"}], "]"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"odes", "=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"#", ",", 
               RowBox[{"-", "rateLaw"}]}], "}"}], "&"}], ",", "vars"}], 
           "]"}]}], ";"}], " ", "\[IndentingNewLine]", ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"odes", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Y", "[", "Global`t", "]"}], ",", " ", "rateLaw"}], 
            "}"}], "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dummy", " ", "=", 
       RowBox[{"Join", "@@", 
        RowBox[{"(", " ", 
         RowBox[{"parseArrowForm", "/@", "dummy"}], ")"}]}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"Join", "[", 
        RowBox[{"odes", ",", "dummy"}], "]"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"parseArrowForm", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RightTeeArrow", "[", 
       RowBox[{"X_", ",", "Y_"}], " ", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"hill", "[", "z___", "]"}], "}"}]}], "}"}], "]"}], ":=", " ", 
   RowBox[{"parseArrowForm", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RightTeeArrow", "[", 
       RowBox[{"X", ",", "Y"}], "]"}], ",", 
      RowBox[{"hill", "[", "z", "]"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.40103380185041*^9, 3.401033802419438*^9}, {
  3.511651150682397*^9, 3.5116512089525013`*^9}, {3.511651291003909*^9, 
  3.5116512992609587`*^9}, {3.511652748000422*^9, 3.511652763275215*^9}, {
  3.551634138558625*^9, 3.551634142635832*^9}, {3.551634270071086*^9, 
  3.551634392121531*^9}, {3.551634489472251*^9, 3.551634497370409*^9}, {
  3.551634538979557*^9, 3.551634563597612*^9}, {3.5516346694652853`*^9, 
  3.5516346789316053`*^9}, {3.551634754879354*^9, 3.551634757625889*^9}, {
  3.551637129838409*^9, 3.5516371309741488`*^9}, {3.561652826318906*^9, 
  3.561652923225481*^9}, {3.561653073241873*^9, 3.561653093490049*^9}, {
  3.561653368983201*^9, 3.561653371937101*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Cellerator hill Options", "Subsubsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"hill", "[", 
    RowBox[{"opt___", "?", "OptionQ"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "v", ",", "K", ",", "n", ",", "r", ",", "m", ",", "ret", ",", " ", 
       "\[IndentingNewLine]", "incorrect", ",", " ", "allow"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"v", "=", 
       RowBox[{
        RowBox[{"vmax", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"Options", "[", "hill", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"K", "=", 
       RowBox[{
        RowBox[{"khalf", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"Options", "[", "hill", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{
        RowBox[{"nhill", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"Options", "[", "hill", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"r", "=", 
       RowBox[{
        RowBox[{"basalRate", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"Options", "[", "hill", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"m", "=", 
       RowBox[{
        RowBox[{"Thill", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"Options", "[", "hill", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ret", "=", 
       RowBox[{"hill", "[", 
        RowBox[{"v", ",", "K", ",", "n", ",", "r", ",", "m"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"incorrect", "=", " ", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"First", "/@", 
          RowBox[{"{", "opt", "}"}]}], ",", 
         RowBox[{"First", "/@", " ", 
          RowBox[{"Options", "[", "hill", "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Warning: hill[...] unknown option \>\"", ",", " ", 
          RowBox[{"#", " ", "\[Rule]", " ", 
           RowBox[{"(", 
            RowBox[{"#", "/.", 
             RowBox[{"{", "opt", "}"}]}], ")"}]}], ",", " ", 
          "\"\< ignored.\>\""}], "]"}], "&"}], "/@", "incorrect"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "ret", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.449245185883472*^9, 3.449245334210264*^9}, {
  3.449245385396965*^9, 3.449245417132526*^9}, {3.449245460138544*^9, 
  3.449245501948542*^9}, {3.449245541701586*^9, 3.449245566856492*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Alternate capitializtion of hill as Hill", "Subsubsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Hill", "[", "x___", "]"}], ":=", 
   RowBox[{"hill", "[", "x", "]"}]}], ";"}]], "Input",
 InitializationCell->True]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["combineRegulatoryReactions", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"hillListQ", "[", 
    RowBox[{"{", "h__", "}"}], "]"}], ":=", 
   RowBox[{"SameQ", "[", 
    RowBox[{
     RowBox[{"Union", "[", 
      RowBox[{"Head", "/@", 
       RowBox[{"{", "h", "}"}]}], "]"}], ",", 
     RowBox[{"{", "hill", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"hillListQ", "[", "x___", "]"}], ":=", " ", "False"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GRNListQ", "[", 
    RowBox[{"{", "h__", "}"}], "]"}], ":=", 
   RowBox[{"SameQ", "[", 
    RowBox[{
     RowBox[{"Union", "[", 
      RowBox[{"Head", "/@", 
       RowBox[{"{", "h", "}"}]}], "]"}], ",", 
     RowBox[{"{", "GRN", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GRNListQ", "[", "x___", "]"}], ":=", " ", "False"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NHCAListQ", "[", 
    RowBox[{"{", "h__", "}"}], "]"}], ":=", 
   RowBox[{"SameQ", "[", 
    RowBox[{
     RowBox[{"Union", "[", 
      RowBox[{"Head", "/@", 
       RowBox[{"{", "h", "}"}]}], "]"}], ",", 
     RowBox[{"{", "NHCA", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NHCAListQ", "[", "x___", "]"}], ":=", " ", "False"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SSystemListQ", "[", 
    RowBox[{"{", "h__", "}"}], "]"}], ":=", 
   RowBox[{"SameQ", "[", 
    RowBox[{
     RowBox[{"Union", "[", 
      RowBox[{"Head", "/@", 
       RowBox[{"{", "h", "}"}]}], "]"}], ",", 
     RowBox[{"{", "SSystem", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SSystemListQ", "[", "x___", "]"}], ":=", " ", "False"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"listTypes", "[", 
     RowBox[{"{", "h__", "}"}], "]"}], ":=", " ", 
    RowBox[{"Union", "[", 
     RowBox[{"Head", "/@", "h"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"regulatoryQ", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RightTeeArrow", "[", 
       RowBox[{"A_", ",", "B_"}], "]"}], ",", "r___"}], "}"}], "]"}], ":=", 
   " ", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"regulatoryQ", "[", "x___", "]"}], ":=", " ", "False"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"massActionQ", "[", 
    RowBox[{
     RowBox[{"ShortRightArrow", "[", 
      RowBox[{"A_", ",", "B_"}], "]"}], ",", " ", "r___"}], "]"}], ":=", " ", 
   "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"massActionQ", "[", "x___", "]"}], ":=", " ", "False"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"regulatoryProduct", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RightTeeArrow", "[", 
       RowBox[{"A_", ",", "B_"}], "]"}], ",", "r___"}], "}"}], "]"}], ":=", 
   " ", "B"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"regulatoryProduct", "[", "x___", "]"}], ":=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"regulatorOf", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RightTeeArrow", "[", 
       RowBox[{"A_", ",", "B_"}], "]"}], ",", "r___"}], "}"}], "]"}], ":=", 
   " ", "A"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"regulatorOf", "[", "x___", "]"}], ":=", " ", 
   RowBox[{"{", "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.40103367439434*^9, {3.401033802553007*^9, 3.4010338027543983`*^9}}],

Cell["\<\
r must be an interpretable list that has already been broken down into \
fundamental reactions.
revised v.075 to allow repeated identical mass action reactions (previously \
duplicates were removed by Complement)
revise v.082 to allow for correct combination of hill functions (changed \
input order of parameters in v.081)\
\>", "Text",
 CellChangeTimes->{{3.466261615189192*^9, 3.466261650972823*^9}, {
  3.5118046598480186`*^9, 3.511804699726103*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"combineRegulatoryReactions", "[", "r_", "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "reg", ",", "deg", ",", "nonreg", ",", "prods", ",", "products", ",", 
       RowBox[{"dbg", "=", "False"}], ",", " ", "reacts", ",", "meths", ",", 
       " ", "consolidate", ",", " ", "dPrint"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"dPrint", "[", "x___", "]"}], ":=", " ", 
       RowBox[{"If", "[", 
        RowBox[{"dbg", ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<combineRegulatoryReactions: \>\"", ",", " ", "x"}], 
          "]"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        StyleBox["consolidate",
         FontColor->RGBColor[1, 0, 0]], "[", 
        RowBox[{"{", 
         RowBox[{"reaction_", ",", " ", "controls___"}], "}"}], "]"}], ":=", 
       " ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"dbg", "=", "False"}], ",", "n", ",", "heads", ",", 
           "firsthead", ",", "unheads", ",", "nheads", ",", "ok", ",", 
           "consolidated", ",", "dPrint", ",", "\[IndentingNewLine]", 
           StyleBox["consolidateHill",
            FontColor->RGBColor[0, 0, 1]], 
           StyleBox[",",
            FontColor->RGBColor[0, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[0, 0, 1]], 
           StyleBox["consolidateUser",
            FontColor->RGBColor[0, 0, 1]], 
           StyleBox[",",
            FontColor->RGBColor[0, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[0, 0, 1]], 
           StyleBox["consolidateSSystem",
            FontColor->RGBColor[0, 0, 1]], 
           StyleBox[",",
            FontColor->RGBColor[0, 0, 1]], 
           StyleBox["consolidateNHCA",
            FontColor->RGBColor[0, 0, 1]]}], "}"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"dPrint", "[", "x___", "]"}], ":=", " ", 
           RowBox[{"If", "[", 
            RowBox[{"dbg", ",", " ", 
             RowBox[{"Print", "[", 
              RowBox[{"\"\<consolidate: \>\"", ",", " ", "x"}], "]"}]}], 
            "]"}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            StyleBox["consolidateNHCA",
             FontColor->RGBColor[0, 0, 1]], "[", "pars_", "]"}], ":=", " ", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "args", ",", "v", ",", "T", ",", "n", ",", "m", ",", "k"}], 
              "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{
               "NHCA", " ", "will", " ", "always", " ", "have", " ", "5", " ",
                 "arguments", " ", 
                RowBox[{"SSystem", "[", 
                 RowBox[{"v", ",", "T", ",", "n", ",", "m", ",", "k"}], 
                 "]"}]}], ","}], " ", "*)"}], "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{"as", " ", "a", " ", "result", " ", "of", " ", 
               RowBox[{"preprocessing", "."}]}], " ", "*)"}], 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"args", " ", "=", " ", 
               RowBox[{"functionArguments", "/@", "pars"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"args", " ", "=", " ", 
               RowBox[{"Transpose", "[", "args", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"v", ",", "T", ",", "n", ",", "m", ",", "k"}], "}"}], 
               "=", "args"}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{"Union", "[", "v", "]"}], "]"}], ">", "1"}], ",", 
                " ", "\[IndentingNewLine]", 
                RowBox[{"Print", "[", 
                 RowBox[{
                 "\"\<Warning: NHCA reactions with different v: reaction: \
\>\"", ",", "reaction", ",", "\"\< v:\>\"", ",", "v"}], "]"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{"Union", "[", "m", "]"}], "]"}], ">", "1"}], ",", 
                " ", "\[IndentingNewLine]", 
                RowBox[{"Print", "[", 
                 RowBox[{
                 "\"\<Warning: NHCA reactions with different m: reaction: \
\>\"", ",", " ", "reaction", ",", "\"\< m:\>\"", ",", "m"}], "]"}]}], "]"}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{"Union", "[", "k", "]"}], "]"}], ">", "1"}], ",", 
                " ", "\[IndentingNewLine]", 
                RowBox[{"Print", "[", 
                 RowBox[{
                 "\"\<Warning: NHCA reactions with different k: reaction: \
\>\"", ",", "reaction", ",", "\"\< k:\>\"", ",", "k"}], "]"}]}], "]"}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"v", "=", 
               RowBox[{"First", "[", "v", "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"m", "=", 
               RowBox[{"First", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"k", "=", 
               RowBox[{"First", "[", "k", "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"args", " ", "=", " ", 
               RowBox[{"{", 
                RowBox[{"v", ",", "T", ",", "n", ",", "m", ",", "k"}], 
                "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"Return", "[", 
               RowBox[{"NHCA", "@@", "args"}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}]}], ";", 
          RowBox[{"(*", " ", 
           RowBox[{"end", " ", 
            StyleBox["consolidateNHCA",
             FontColor->RGBColor[0, 0, 1]]}], 
           StyleBox[" ",
            FontColor->RGBColor[0, 0, 1]], 
           StyleBox["*)",
            FontColor->RGBColor[0, 0, 1]]}], 
          StyleBox[" ",
           FontColor->RGBColor[0, 0, 1]], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            StyleBox["consolidateSSystem",
             FontColor->RGBColor[0, 0, 1]], "[", "pars_", "]"}], ":=", " ", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "args", ",", "theTau", ",", " ", "theKp", ",", "theKm", ",", 
               "theCp", ",", "theCm"}], "}"}], ",", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{
               "SSystem", " ", "will", " ", "always", " ", "have", " ", 
                "four", " ", "arguments", " ", 
                RowBox[{"SSystem", "[", 
                 RowBox[{
                 "tau", ",", "kplus", ",", "kminus", ",", "cplus", ",", 
                  "cminus"}], "]"}]}], ","}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{"as", " ", "a", " ", "result", " ", "of", " ", 
               RowBox[{"preprocessing", "."}]}], " ", "*)"}], 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"args", " ", "=", " ", 
               RowBox[{"functionArguments", "/@", "pars"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"args", " ", "=", " ", 
               RowBox[{"Transpose", "[", "args", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "theTau", ",", "theKp", ",", "theKm", ",", " ", "theCp", ",", 
                 " ", "theCm"}], "}"}], "=", "args"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"theTau", "=", 
               RowBox[{"First", "[", "theTau", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"theKm", "=", 
               RowBox[{"First", "[", "theKm", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"theKp", "=", 
               RowBox[{"First", "[", "theKp", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"args", " ", "=", " ", 
               RowBox[{"{", 
                RowBox[{
                "theTau", ",", "theKp", ",", "theKm", ",", " ", "theCp", ",", 
                 " ", "theCm"}], "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"Return", "[", 
               RowBox[{"SSystem", "@@", "args"}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}]}], ";", 
          RowBox[{"(*", " ", 
           RowBox[{"end", " ", 
            StyleBox["consolidateSSystem",
             FontColor->RGBColor[0, 0, 1]]}], 
           StyleBox[" ",
            FontColor->RGBColor[0, 0, 1]], 
           StyleBox["*)",
            FontColor->RGBColor[0, 0, 1]]}], 
          StyleBox[" ",
           FontColor->RGBColor[0, 0, 1]], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            StyleBox["consolidateHill",
             FontColor->RGBColor[0, 0, 1]], "[", "pars_", "]"}], ":=", " ", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "args", ",", " ", "T", ",", " ", "most", ",", " ", "fixargs", 
               ",", "result"}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"fixargs", "[", 
                RowBox[{"{", "vh_", "}"}], "]"}], ":=", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{
                  "\"\<Warning: Incomplete parameter set in reaction \>\"", 
                   ",", " ", "pars"}], "]"}], ";", " ", 
                 RowBox[{"{", 
                  RowBox[{"vh", ",", "1", ",", "1", ",", "0", ",", "1"}], 
                  "}"}]}], ")"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"fixargs", "[", 
                RowBox[{"{", 
                 RowBox[{"vh_", ",", "nh_"}], "}"}], "]"}], ":=", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{
                  "\"\<Warning: Incomplete parameter set in reaction \>\"", 
                   ",", " ", "pars"}], "]"}], ";", 
                 RowBox[{"{", 
                  RowBox[{"vh", ",", "nh", ",", "1", ",", "0", ",", "1"}], 
                  "}"}]}], ")"}]}], ";", " ", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"fixargs", "[", 
                RowBox[{"{", 
                 RowBox[{"vh_", ",", "nh_", ",", "Kh_"}], "}"}], "]"}], ":=", 
               " ", 
               RowBox[{"{", 
                RowBox[{"vh", ",", "nh", ",", "Kh", ",", "0", ",", "1"}], 
                "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"fixargs", "[", 
                RowBox[{"{", 
                 RowBox[{
                 "vh_", ",", " ", "nh_", ",", " ", "Kh_", ",", " ", "Offh_"}],
                  "}"}], "]"}], ":=", " ", 
               RowBox[{"{", 
                RowBox[{
                "vh", ",", " ", "nh", ",", " ", "Kh", ",", " ", "Offh", ",", 
                 " ", "1"}], "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"fixargs", "[", 
                RowBox[{"{", 
                 RowBox[{
                 "vh_", ",", " ", "nh_", ",", " ", "Kh_", ",", " ", "Offh_", 
                  ",", " ", "Th_"}], "}"}], "]"}], ":=", " ", 
               RowBox[{"{", 
                RowBox[{
                "vh", ",", " ", "nh", ",", " ", "Kh", ",", " ", "Offh", ",", 
                 " ", "Th"}], "}"}]}], ";", " ", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"fixargs", "[", 
                RowBox[{"l_", "?", "ListQ"}], "]"}], ":=", " ", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", "l", "]"}], ">", "5"}], ",", " ", 
                 RowBox[{"l", "=", 
                  RowBox[{"Take", "[", 
                   RowBox[{"l", ",", " ", "5"}], "]"}]}], ",", " ", "l"}], 
                "]"}]}], ";", " ", "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{
                "hill", " ", "will", " ", "always", " ", "have", " ", "four", 
                 " ", "arguments", " ", 
                 RowBox[{"hill", "[", 
                  RowBox[{"v", ",", "K", ",", "n", ",", "r"}], "]"}]}], ","}],
                " ", "*)"}], "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{"as", " ", "a", " ", "result", " ", "of", " ", 
                RowBox[{"preprocessing", "."}]}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{"except", " ", "for", " ", "v"}], ",", " ", 
                RowBox[{
                "only", " ", "the", " ", "first", " ", "is", " ", "used"}]}], 
               " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"args", " ", "=", " ", 
               RowBox[{"functionArguments", "/@", "pars"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"args", " ", "=", " ", 
               RowBox[{"fixargs", "/@", "args"}]}], ";", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"dPrint", "[", 
               RowBox[{"\"\<consolidateHill: args: \>\"", ",", " ", "args"}], 
               "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              
              RowBox[{"T", "=", 
               RowBox[{"Last", "/@", "args"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"dPrint", "[", 
               RowBox[{"\"\<consolidateHill: T: \>\"", ",", " ", "T"}], "]"}],
               ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"most", " ", "=", " ", 
               RowBox[{"Most", "[", 
                RowBox[{"First", "[", "args", "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"result", " ", "=", " ", 
               RowBox[{"hill", "@@", 
                RowBox[{"Append", "[", 
                 RowBox[{"most", ",", "T"}], "]"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"dPrint", "[", 
               RowBox[{
               "\"\<consolidateHill: result: \>\"", ",", " ", "result"}], 
               "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              
              RowBox[{"Return", "[", "result", "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}]}], ";", 
          RowBox[{"(*", " ", 
           RowBox[{"end", " ", 
            StyleBox["consolidateHill",
             FontColor->RGBColor[0, 0, 1]]}], 
           StyleBox[" ",
            FontColor->RGBColor[0, 0, 1]], 
           StyleBox["*)",
            FontColor->RGBColor[0, 0, 1]]}], 
          StyleBox[" ",
           FontColor->RGBColor[0, 0, 1]], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            StyleBox["consolidateUser",
             FontColor->RGBColor[0, 0, 1]], "[", "pars_", "]"}], ":=", " ", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "args", ",", "\[IndentingNewLine]", "nargs", ",", "v", ",", " ",
                "T", ",", " ", "n", ",", "h", ",", " ", "f", ",", "name", ",",
                "rval", ",", " ", 
               RowBox[{"dbg", "=", "False"}]}], "}"}], ",", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{
               "user", " ", "should", "  ", "always", " ", "have", " ", 
                "five", " ", "arguments", " ", 
                RowBox[{"user", "[", 
                 RowBox[{"r", ",", "T", ",", "n", ",", "h", ",", "f"}], 
                 "]"}]}], ","}], " ", "*)"}], "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
              "This", " ", "should", " ", "be", " ", "handled", " ", "in", 
               " ", "the", " ", "preprocessing"}], " ", "*)"}], " ", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{"r", ",", " ", "T", ",", " ", 
               RowBox[{
               "n", " ", "can", " ", "vary", " ", "from", " ", "one", " ", 
                "to", " ", "another"}]}], " ", "*)"}], "\[IndentingNewLine]", 
             
             RowBox[{"(*", " ", 
              RowBox[{
              "h", " ", "and", " ", "f", " ", "must", " ", "be", " ", "the", 
               " ", "same"}], " ", "*)"}], "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{"dbg", ",", " ", 
                RowBox[{"Print", "[", 
                 RowBox[{"\"\<consolidateUser: pars=\>\"", ",", "pars"}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"name", "=", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"Head", "/@", "pars"}], ")"}], "//", "Union"}], 
                 " ", ")"}], "//", "First"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"args", " ", "=", " ", 
               RowBox[{"functionArguments", "/@", "pars"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"nargs", "=", 
               RowBox[{"Union", "[", 
                RowBox[{"Length", "/@", "args"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", "nargs", "]"}], ">", "1"}], " ", 
                 "\[Or]", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", "nargs", "]"}], "\[Equal]", "1"}], 
                   " ", "\[And]", " ", 
                   RowBox[{
                    RowBox[{"nargs", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[NotEqual]", " ", 
                    "5"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{
                  "\"\<Error: all user defined regulator rates should have \
five arguments: user[r,T,n,h,f], not \>\"", ",", " ", 
                   RowBox[{"Union", "[", "pars", "]"}]}], "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{"dbg", ",", 
                RowBox[{"Print", "[", 
                 RowBox[{"\"\<consolidateUser: args=\>\"", ",", "args"}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"v", ",", "T", ",", "n", ",", "h", ",", "f"}], "}"}], 
               "=", 
               RowBox[{"Transpose", "[", "args", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{"dbg", ",", " ", 
                RowBox[{"Print", "[", 
                 RowBox[{
                 "\"\<v=\>\"", ",", "v", ",", "\"\<\\nT=\>\"", ",", "T", ",", 
                  "\"\<\\nn=\>\"", ",", "n", ",", "\"\<\\nh=\>\"", ",", "h", 
                  ",", "\"\<\\nf=\>\"", ",", "f"}], "]"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"h", "=", 
               RowBox[{"Union", "[", "h", "]"}]}], ";", "\[IndentingNewLine]",
               "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "h", "]"}], ">", "1"}], ",", " ", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{
                  "\"\<Error: can not combine user reactions \>\"", ",", 
                   "name", ",", "\"\<  with different thresholds: \>\"", ",", 
                   " ", "h", ",", " ", 
                   "\"\< unable to unambiguaously determine which threshold \
to use. The value \>\"", ",", " ", 
                   RowBox[{"First", "[", "h", "]"}], ",", " ", 
                   "\"\< was assumed.\>\""}], " ", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"h", "=", 
               RowBox[{"First", "[", "h", "]"}]}], ";", "\[IndentingNewLine]",
               "\[IndentingNewLine]", 
              RowBox[{"f", "=", 
               RowBox[{"Union", "[", "f", "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "f", "]"}], ">", "1"}], ",", " ", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{
                  "\"\<Error: can not combine user reactions \>\"", ",", 
                   "name", ",", "\"\<  with different rate functions: \>\"", 
                   ",", " ", "f", ",", " ", 
                   "\"\< unable to unambiguaously determine which function to \
use. The function \>\"", ",", 
                   RowBox[{"First", "[", "f", "]"}], ",", " ", 
                   "\"\< was assumed.\>\""}], " ", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"f", "=", 
               RowBox[{"First", "[", "f", "]"}]}], ";", "\[IndentingNewLine]",
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"rval", "  ", "=", 
               RowBox[{"name", "[", 
                RowBox[{
                "v", ",", " ", "T", ",", " ", "n", ",", " ", "h", ",", " ", 
                 "f"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{"dbg", ",", " ", 
                RowBox[{"Print", "[", 
                 RowBox[{"\"\<consolidateUser: rval=\>\"", ",", "rval"}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"Return", "[", "rval", "]"}], ";"}]}], 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", "]"}]}], ";", 
          RowBox[{"(*", " ", 
           RowBox[{"end", " ", 
            StyleBox["consolidateUser",
             FontColor->RGBColor[0, 0, 1]]}], 
           StyleBox[" ",
            FontColor->RGBColor[0, 0, 1]], 
           StyleBox["*)",
            FontColor->RGBColor[0, 0, 1]]}], 
          StyleBox[" ",
           FontColor->RGBColor[0, 0, 1]], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           StyleBox[
            RowBox[{
            "begin", " ", "main", " ", "code", " ", "for", " ", 
             "consolidate"}],
            FontColor->RGBColor[1, 0, 0]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 0]], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"n", "=", 
           RowBox[{"Length", "[", "controls", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{
           "reaction", ",", "\"\< : \>\"", ",", "controls", ",", 
            "\"\< n=\>\"", ",", "n"}], "]"}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"n", "\[LessEqual]", " ", "1"}], ",", " ", 
            RowBox[{"Return", "[", 
             RowBox[{"{", 
              RowBox[{"reaction", ",", "controls"}], "}"}], "]"}]}], "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"heads", "=", 
           RowBox[{"Head", "/@", "controls"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"firsthead", "=", 
           RowBox[{"First", "[", "heads", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"unheads", "=", 
           RowBox[{"Union", "[", "heads", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"nheads", "=", 
           RowBox[{"Length", "[", "unheads", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"nheads", ">", "1"}], ",", " ", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<Error: different regulatory methods cannot be mixed for a \
single product: Reaction: \>\"", ",", "reaction", ",", 
               "\"\< Regulatory controls: \>\"", ",", "controls", ",", 
               "\"\< assumed: \>\"", ",", "firsthead"}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"ok", " ", "=", " ", 
              RowBox[{"Select", "[", 
               RowBox[{"controls", ",", 
                RowBox[{
                 RowBox[{"SameQ", "[", 
                  RowBox[{"firsthead", ",", 
                   RowBox[{"Head", "[", "#", "]"}]}], "]"}], "&"}]}], "]"}]}],
              ";"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ok", "=", "controls"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<ok: \>\"", ",", " ", "ok"}], "]"}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"Switch", "[", 
           RowBox[{
           "firsthead", ",", "\[IndentingNewLine]", "hill", ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"consolidated", "=", 
              RowBox[{"{", 
               RowBox[{"reaction", ",", 
                RowBox[{"consolidateHill", "[", "ok", "]"}]}], "}"}]}], ";"}],
             "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "SSystem", 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"consolidated", "=", " ", 
              RowBox[{"{", 
               RowBox[{"reaction", ",", " ", 
                RowBox[{"consolidateSSystem", "[", "ok", "]"}]}], "}"}]}], 
             ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "NHCA",
             ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"consolidated", "=", " ", 
              RowBox[{"{", 
               RowBox[{"reaction", ",", " ", 
                RowBox[{"consolidateNHCA", "[", "ok", "]"}]}], "}"}]}], ";"}],
             "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "_", ",", " ",
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"consolidated", "=", 
              RowBox[{"{", 
               RowBox[{"reaction", ",", 
                RowBox[{"consolidateUser", "[", "ok", "]"}]}], "}"}]}], 
             ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], 
          ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"dbg", ",", " ", 
            RowBox[{"Print", "[", 
             RowBox[{"\"\<consolidated---->\>\"", ",", "consolidated"}], 
             "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "consolidated", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"end", " ", 
        StyleBox["consolidate",
         FontColor->RGBColor[1, 0, 0]]}], 
       StyleBox[" ",
        FontColor->RGBColor[1, 0, 0]], 
       StyleBox["*)",
        FontColor->RGBColor[1, 0, 0]]}], 
      StyleBox[" ",
       FontColor->RGBColor[1, 0, 0]], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        StyleBox["consolidate",
         FontColor->RGBColor[1, 0, 0]], "[", "errorInput_", "]"}], ":=", " ", 
       
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<Error: combineRegulators: \>\"", ",", "errorInput"}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "errorInput", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"end", " ", "errorInput", " ", 
        StyleBox["consolidate",
         FontColor->RGBColor[1, 0, 0]]}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"main", " ", "code", " ", "combineRegulatorityReactions"}], 
       " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<r: \>\"", ",", " ", "r"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"reg", "=", 
       RowBox[{"Cases", "[", 
        RowBox[{"r", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"RightTeeArrow", "[", 
            RowBox[{"_", ",", "_"}], "]"}], ",", "_"}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "allow", " ", "degradation", " ", "to", " ", "be", " ", "treated", " ",
         "separately"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
      RowBox[{"deg", " ", "=", " ", 
       RowBox[{"Cases", "[", 
        RowBox[{"r", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"RightTeeArrow", "[", 
            RowBox[{"_", ",", "Global`\[EmptySet]"}], "]"}], ",", "_"}], 
          "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"reg", "=", 
       RowBox[{"Complement", "[", 
        RowBox[{"reg", ",", "deg"}], "]"}]}], ";", " ", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<reg reactions:\>\"", ",", "reg"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<deg reactions:\>\"", ",", "deg"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Can", "'"}], "t", " ", "use", " ", "Complement", " ", 
         "becasue", " ", "that", " ", "removes", " ", "duplicates"}], ",", 
        " ", 
        RowBox[{"which", " ", "we", " ", "want", " ", "to", " ", 
         RowBox[{"keep", "!"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"nonreg", "=", 
         RowBox[{"Complement", "[", 
          RowBox[{"r", ",", "reg"}], "]"}]}], ";"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"revised", " ", "v0", ".75"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"nonreg", " ", "=", " ", 
       RowBox[{"Select", "[", 
        RowBox[{"r", ",", " ", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"MemberQ", "[", 
            RowBox[{"reg", ",", " ", "#"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<nonreg: \>\"", ",", " ", "nonreg"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"prods", " ", "=", " ", 
       RowBox[{"regulatoryProduct", "/@", "reg"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<prods:\>\"", ",", "prods"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"products", "=", 
       RowBox[{"Union", "[", "prods", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<products:\>\"", ",", "products"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"reacts", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"reg", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"RightTeeArrow", "[", 
               RowBox[{"_", ",", "#"}], "]"}], ",", "_"}], "}"}]}], "]"}], 
          "&"}], ",", "products"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<reactions:\\n\>\"", ",", "reacts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"meths", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{"Last", ",", "#"}], "]"}], "&"}], "/@", "reacts"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<meths:\>\"", ",", "meths"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"reacts", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{"regulatorOf", ",", "#"}], "]"}], "&"}], "/@", "reacts"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<regulators:\>\"", ",", "reacts"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"reacts", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"RightTeeArrow", "[", 
             RowBox[{"#1", ",", "#2"}], "]"}], ",", "#3"}], "}"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"reacts", ",", "products", ",", "meths"}], "}"}]}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<reactions: \>\"", ",", "reacts"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"reacts", "=", 
       RowBox[{"consolidate", "/@", "reacts"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"reacts", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"nonreg", ",", "reacts"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", " ", 
      RowBox[{"Return", "[", "reacts", "]"}], ";"}]}], " ", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.40103380288765*^9, 3.4010338031556*^9}, {
   3.466261171716949*^9, 3.466261172395224*^9}, {3.466261234149726*^9, 
   3.466261418879684*^9}, {3.466261521902569*^9, 3.4662616052253857`*^9}, {
   3.466261660527403*^9, 3.466261662203579*^9}, {3.511803098569027*^9, 
   3.511803099248027*^9}, {3.511803338777546*^9, 3.511803341470208*^9}, 
   3.5118034426948347`*^9, {3.51180348597174*^9, 3.511803486828948*^9}, {
   3.5118035507007093`*^9, 3.511803581198069*^9}, {3.5118036307703257`*^9, 
   3.511803733711172*^9}, {3.5118037721707163`*^9, 3.511803817339859*^9}, {
   3.511803907016613*^9, 3.511804020603427*^9}, {3.511804055260606*^9, 
   3.511804552664353*^9}, {3.511804585476516*^9, 3.511804614507135*^9}, {
   3.511804651311*^9, 3.5118046580257263`*^9}, {3.523639641371407*^9, 
   3.523639641867079*^9}, {3.52364070544912*^9, 3.523640706284384*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["GRN", "Subsection",
 CellDingbat->None,
 Background->RGBColor[1, 0.983139, 0.832074]],

Cell[CellGroupData[{

Cell["\<\
A\[RightTeeArrow]B, GRN[r, T, n, h] - expandArrows\
\>", "Subsubsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"expandArrows", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RightTeeArrow", "[", 
       RowBox[{"X_", ",", "Y_"}], " ", "]"}], ",", 
      RowBox[{"GRN", "[", 
       RowBox[{
        RowBox[{"r_:", "1"}], ",", " ", 
        RowBox[{"T_:", "1"}], ",", " ", 
        RowBox[{"n_:", "1"}], ",", " ", 
        RowBox[{"h_:", "0"}]}], "]"}]}], "}"}], "]"}], ":=", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "reaction", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"reaction", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"RightTeeArrow", "[", 
          RowBox[{"X", ",", "Y"}], "]"}], ",", 
         RowBox[{"GRN", "[", 
          RowBox[{
          "r", ",", " ", "T", ",", " ", "n", ",", " ", "h", ",", "sigmoid"}], 
          "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"dbgArrows", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<expandArrows:\>\"", ",", " ", "reaction"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", "reaction", "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expandArrows", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RightTeeArrow", "[", 
       RowBox[{
        RowBox[{"Plus", "[", 
         RowBox[{"X_", ",", "X1__"}], "]"}], ",", "Y_"}], " ", "]"}], ",", 
      RowBox[{"GRN", "[", 
       RowBox[{
        RowBox[{"r_:", "1"}], ",", " ", 
        RowBox[{"T_:", "1"}], ",", 
        RowBox[{"n_:", "1"}], ",", " ", 
        RowBox[{"h_:", "0"}]}], "]"}]}], "}"}], "]"}], ":=", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"reaction", ",", "vars"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"vars", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", ",", "X1"}], "}"}], "//", "Flatten"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"reaction", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"RightTeeArrow", "[", 
          RowBox[{"vars", ",", "Y"}], "]"}], ",", 
         RowBox[{"GRN", "[", 
          RowBox[{"r", ",", "T", ",", "n", ",", "h"}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"dbgArrows", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<expandArrows:\>\"", ",", " ", "reaction"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", "reaction", "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.401033803272101*^9, 3.401033803540492*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
A\[RightTeeArrow]B, GRN[r, T, n, h] - parseArrowForm\
\>", "Subsubsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"parseArrowForm", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"RightTeeArrow", "[", 
        RowBox[{
         RowBox[{"Plus", "[", 
          RowBox[{"X_", ",", "X1__"}], "]"}], ",", "Y_"}], " ", "]"}], ",", 
       RowBox[{"GRN", "[", 
        RowBox[{
         RowBox[{"r_:", "1"}], ",", " ", 
         RowBox[{"T_:", "1"}], ",", " ", 
         RowBox[{"n_:", "1"}], ",", " ", 
         RowBox[{"h_:", "0"}]}], "]"}]}], "}"}], "]"}], ":=", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"odes", ",", " ", "vars", ",", " ", "reaction"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"reaction", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"RightTeeArrow", "[", 
           RowBox[{
            RowBox[{"Plus", "[", "X", "]"}], ",", "Y"}], "]"}], ",", 
          RowBox[{"GRN", "[", 
           RowBox[{"r", ",", "T", ",", "n", ",", "h"}], "]"}]}], "}"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"dbgArrows", ",", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<parseArrowForm:\>\"", ",", " ", "reaction"}], "]"}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"vars", "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"X", ",", "X1"}], "}"}], "//", "Flatten"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"odes", " ", "=", " ", 
        RowBox[{"parseArrowForm", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"RightTeeArrow", "[", 
            RowBox[{"vars", ",", "Y"}], "]"}], ",", 
           RowBox[{"GRN", "[", 
            RowBox[{"r", ",", "T", ",", "n", ",", "h"}], "]"}]}], "}"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "odes", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"parseArrowForm", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RightTeeArrow", "[", 
       RowBox[{"X_", ",", "Y_"}], " ", "]"}], ",", 
      RowBox[{"GRN", "[", 
       RowBox[{
        RowBox[{"r_:", "1"}], ",", " ", 
        RowBox[{"T_:", "1"}], ",", " ", 
        RowBox[{"n_:", "1"}], ",", " ", 
        RowBox[{"h_:", "0"}]}], "]"}]}], "}"}], "]"}], ":=", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "reaction", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"reaction", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"RightTeeArrow", "[", 
          RowBox[{"X", ",", "Y"}], "]"}], ",", 
         RowBox[{"GRN", "[", 
          RowBox[{
          "r", ",", " ", "T", ",", " ", "n", ",", " ", "h", ",", " ", 
           "sigmoid"}], "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"parseArrowForm", "[", "reaction", "]"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"parseArrowForm", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RightTeeArrow", "[", 
       RowBox[{"X_", ",", "Y_"}], " ", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"GRN", "[", "z___", "]"}], "}"}]}], "}"}], "]"}], ":=", " ", 
   RowBox[{"parseArrowForm", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RightTeeArrow", "[", 
       RowBox[{"X", ",", "Y"}], "]"}], ",", 
      RowBox[{"GRN", "[", "z", "]"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.40103380367413*^9, 3.401033804225978*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Cellerator Options for GRN - backward compatibility, discouraged\
\>", "Subsubsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GRN", "[", 
    RowBox[{"opt___", "?", "OptionQ"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "r", ",", " ", "T", ",", " ", "n", ",", " ", "h", ",", "ret", ",", " ", 
       "f", ",", " ", "incorrect"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"r", "=", 
       RowBox[{
        RowBox[{"RGRN", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"Options", "[", "GRN", "]"}]}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"T", "=", 
       RowBox[{
        RowBox[{"TGRN", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"Options", "[", "GRN", "]"}]}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"n", "=", 
       RowBox[{
        RowBox[{"nGRN", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"Options", "[", "GRN", "]"}]}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"h", "=", 
       RowBox[{
        RowBox[{"hGRN", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"Options", "[", "GRN", "]"}]}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"f", "=", 
       RowBox[{
        RowBox[{"Sigmoid", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"Options", "[", "GRN", "]"}]}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"f", ",", "sigmoid"}], "]"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"ret", "=", 
         RowBox[{"GRN", "[", 
          RowBox[{"r", ",", " ", "T", ",", " ", "n", ",", " ", "h"}], "]"}]}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"ret", "=", 
         RowBox[{"GRN", "[", 
          RowBox[{
          "r", ",", " ", "T", ",", " ", "n", ",", " ", "h", ",", " ", "f"}], 
          "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"incorrect", "=", " ", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"First", "/@", 
          RowBox[{"{", "opt", "}"}]}], ",", 
         RowBox[{"First", "/@", " ", 
          RowBox[{"Options", "[", "GRN", "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Warning: GRN[...] unknown option \>\"", ",", " ", 
          RowBox[{"#", " ", "\[Rule]", " ", 
           RowBox[{"(", 
            RowBox[{"#", "/.", 
             RowBox[{"{", "opt", "}"}]}], ")"}]}], ",", " ", 
          "\"\< ignored.\>\""}], "]"}], "&"}], "/@", "incorrect"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "ret", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.449245799079457*^9, 3.449245812100176*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Alternate capitializtion of GRN as grn", "Subsubsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"grn", "[", "x___", "]"}], ":=", 
   RowBox[{"GRN", "[", "x", "]"}]}], ";"}]], "Input",
 InitializationCell->True]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["S-Systems", "Subsection",
 CellDingbat->None,
 Background->RGBColor[1, 0.983139, 0.832074]],

Cell[CellGroupData[{

Cell["\<\
A\[RightTeeArrow]B, SSystem[r, T, n, h] - expandArrows\
\>", "Subsubsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"expandArrows", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RightTeeArrow", "[", 
       RowBox[{"X_", ",", "Y_"}], " ", "]"}], ",", 
      RowBox[{"SSystem", "[", 
       RowBox[{
       "tau_", ",", " ", "kplus_", ",", " ", "kminus_", ",", " ", "cplus_", 
        ",", " ", "cminus_"}], "]"}]}], "}"}], "]"}], ":=", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "reaction", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"reaction", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"RightTeeArrow", "[", 
          RowBox[{"X", ",", "Y"}], "]"}], ",", 
         RowBox[{"SSystem", "[", 
          RowBox[{
          "tau", ",", " ", "kplus", ",", " ", "kminus", ",", " ", "cplus", 
           ",", " ", "cminus"}], "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"dbgArrows", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<expandArrows:\>\"", ",", " ", "reaction"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", "reaction", "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expandArrows", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RightTeeArrow", "[", 
       RowBox[{
        RowBox[{"Plus", "[", 
         RowBox[{"X_", ",", "X1__"}], "]"}], ",", "Y_"}], " ", "]"}], ",", 
      RowBox[{"SSystem", "[", 
       RowBox[{
       "tau_", ",", " ", "kplus_", ",", " ", "kminus_", ",", " ", "cplus_", 
        ",", " ", "cminus_"}], "]"}]}], "}"}], "]"}], ":=", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"reaction", ",", "vars"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"vars", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", ",", "X1"}], "}"}], "//", "Flatten"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"reaction", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"RightTeeArrow", "[", 
          RowBox[{"vars", ",", "Y"}], "]"}], ",", 
         RowBox[{"SSystem", "[", 
          RowBox[{
          "tau", ",", " ", "kplus", ",", " ", "kminus", ",", " ", "cplus", 
           ",", " ", "cminus"}], "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"dbgArrows", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<expandArrows:\>\"", ",", " ", "reaction"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", "reaction", "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expandArrows", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RightTeeArrow", "[", 
       RowBox[{"X_", ",", "Y_"}], " ", "]"}], ",", 
      RowBox[{"SSystem", "[", "x___", "]"}]}], "}"}], "]"}], ":=", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "reaction", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"reaction", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"RightTeeArrow", "[", 
          RowBox[{"X", ",", "Y"}], "]"}], ",", 
         RowBox[{"SSystem", "[", "x", "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Error: expandArrows: incorrect arrow format in \>\"", ",", 
        "reaction", ",", 
        "\"\< correct format is SSystem[tau,kplus,kminus,cplus,cminus]\>\""}],
        "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", "reaction", "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.401033804359655*^9, 3.401033804810719*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
A\[RightTeeArrow]B, SSystem[r, T, n, h] - parseArrowForm\
\>", "Subsubsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"parseArrowForm", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"RightTeeArrow", "[", 
        RowBox[{
         RowBox[{"Plus", "[", 
          RowBox[{"X_", ",", "X1__"}], "]"}], ",", "Y_"}], " ", "]"}], ",", 
       RowBox[{"SSystem", "[", 
        RowBox[{
        "tau_", ",", " ", "kplus_", ",", " ", "kminus_", ",", " ", "cplus_", 
         ",", " ", "cminus_"}], "]"}]}], "}"}], "]"}], ":=", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{"vars", ",", " ", "reaction", ",", " ", "rateLaw"}], "}"}], 
      ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"reaction", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"RightTeeArrow", "[", 
           RowBox[{
            RowBox[{"Plus", "[", 
             RowBox[{"X", ",", "X1"}], "]"}], ",", "Y"}], "]"}], ",", 
          RowBox[{"SSystem", "[", 
           RowBox[{
           "tau", ",", " ", "kplus", ",", " ", "kminus", ",", " ", "cplus", 
            ",", " ", "cminus"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"dbgArrows", ",", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<parseArrowForm:\>\"", ",", " ", "reaction"}], "]"}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"vars", "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"X", ",", "X1"}], "}"}], "//", "Flatten"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"reaction", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"RightTeeArrow", "[", 
           RowBox[{"vars", ",", "Y"}], "]"}], ",", 
          RowBox[{"SSystem", "[", 
           RowBox[{
           "tau", ",", " ", "kplus", ",", " ", "kminus", ",", " ", "cplus", 
            ",", " ", "cminus"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"parseArrowForm", "[", "reaction", "]"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"parseArrowForm", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RightTeeArrow", "[", 
       RowBox[{"X_", ",", "Y_"}], " ", "]"}], ",", 
      RowBox[{"SSystem", "[", 
       RowBox[{
       "tau_", ",", " ", "kplus_", ",", " ", "kminus_", ",", " ", "cplus_", 
        ",", " ", "cminus_"}], "]"}]}], "}"}], "]"}], ":=", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "reaction", ",", "rateLaw", ",", " ", "vars", ",", " ", "nvars", ",", 
       " ", "odes", ",", "k\[UnderBracket]p", ",", "k\[UnderBracket]m", ",", 
       "cplusses", ",", "cminuses", ",", "\[Tau]", ",", " ", "dummy"}], "}"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"reaction", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"RightTeeArrow", "[", 
          RowBox[{"X", ",", "Y"}], "]"}], ",", 
         RowBox[{"SSystem", "[", 
          RowBox[{
          "tau", ",", " ", "kplus", ",", " ", "kminus", ",", " ", "cplus", 
           ",", " ", "cminus"}], "]"}]}], "}"}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"vars", "=", 
       RowBox[{
        RowBox[{"{", "X", "}"}], "//", "Flatten"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dummy", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Rule", "[", 
            RowBox[{"#", ",", "#"}], "]"}], ",", "1"}], "}"}], "&"}], "/@", 
        "vars"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"vars", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"#", "[", "Global`t", "]"}], "&"}], ")"}], "/@", "vars"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"nvars", "=", 
       RowBox[{"Length", "[", "vars", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Tau]", "=", 
       RowBox[{"getSingleValue", "[", 
        RowBox[{
        "tau", ",", " ", "1", ",", " ", "\"\<SSystem Time Constant\>\"", ",", 
         " ", "reaction"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"k\[UnderBracket]p", "=", 
       RowBox[{"getSingleValue", "[", 
        RowBox[{
        "kplus", ",", " ", "1", ",", " ", "\"\<SSystem kplus\>\"", ",", " ", 
         "reaction"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"k\[UnderBracket]m", "=", 
       RowBox[{"getSingleValue", "[", 
        RowBox[{
        "kminus", ",", " ", "1", ",", " ", "\"\<SSystem kminus\>\"", ",", " ",
          "reaction"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cplusses", "=", 
       RowBox[{"getnValues", "[", 
        RowBox[{
        "nvars", ",", "cplus", ",", "\"\<SSystem cplus's\>\"", ",", 
         "reaction"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cminuses", "=", 
       RowBox[{"getnValues", "[", 
        RowBox[{
        "nvars", ",", "cminus", ",", "\"\<SSystem cminus's\>\"", ",", 
         "reaction"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rateLaw", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "\[Tau]"}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"k\[UnderBracket]p", "*", 
           RowBox[{"Times", "@@", 
            RowBox[{"(", 
             RowBox[{"vars", "^", "cplusses"}], ")"}]}]}], " ", "-", " ", 
          RowBox[{"k\[UnderBracket]m", "*", 
           RowBox[{"Times", "@@", 
            RowBox[{"(", 
             RowBox[{"vars", "^", "cminuses"}], ")"}]}]}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"rateLaw", "=", 
       RowBox[{"rateLaw", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Global`\[EmptySet]", "[", "Global`t", "]"}], "\[Rule]", 
          " ", "0"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"odes", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Y", "[", "Global`t", "]"}], ",", " ", "rateLaw"}], "}"}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dummy", " ", "=", " ", 
       RowBox[{"Join", "@@", 
        RowBox[{"(", 
         RowBox[{"parseArrowForm", "/@", "dummy"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"odes", " ", "=", " ", 
       RowBox[{"Join", "@@", 
        RowBox[{"{", 
         RowBox[{"odes", ",", "dummy"}], "}"}]}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "odes", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"parseArrowForm", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RightTeeArrow", "[", 
       RowBox[{"X_", ",", "Y_"}], " ", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"SSystem", "[", "z___", "]"}], "}"}]}], "}"}], "]"}], ":=", 
   " ", 
   RowBox[{"parseArrowForm", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RightTeeArrow", "[", 
       RowBox[{"X", ",", "Y"}], "]"}], ",", 
      RowBox[{"SSystem", "[", "z", "]"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.401033804944859*^9, 3.401033805496684*^9}, {
  3.55164020405612*^9, 3.551640251706582*^9}, {3.551640565545697*^9, 
  3.55164056865252*^9}, {3.551640602314062*^9, 3.551640708306038*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["NHCA ", "Subsection",
 CellDingbat->None,
 Background->RGBColor[1, 0.983139, 0.832074]],

Cell[CellGroupData[{

Cell["NHCA expandArrows", "Subsubsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"expandArrows", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RightTeeArrow", "[", 
       RowBox[{"X_", ",", "Y_"}], " ", "]"}], ",", 
      RowBox[{"NHCA", "[", 
       RowBox[{
        RowBox[{"v_:", "1"}], ",", 
        RowBox[{"T_:", "1"}], ",", 
        RowBox[{"n_:", "1"}], ",", 
        RowBox[{"m_:", "1"}], ",", 
        RowBox[{"k_:", "1"}]}], "]"}]}], "}"}], "]"}], ":=", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "reaction", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"reaction", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"RightTeeArrow", "[", 
          RowBox[{"X", ",", "Y"}], "]"}], ",", 
         RowBox[{"NHCA", "[", 
          RowBox[{"v", ",", "T", ",", "n", ",", "m", ",", "k"}], "]"}]}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"dbgArrows", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<expandArrows:\>\"", ",", " ", "reaction"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", "reaction", "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expandArrows", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RightTeeArrow", "[", 
       RowBox[{
        RowBox[{"Plus", "[", 
         RowBox[{"X_", ",", "X1__"}], "]"}], ",", "Y_"}], " ", "]"}], ",", 
      RowBox[{"NHCA", "[", 
       RowBox[{
        RowBox[{"v_:", "1"}], ",", 
        RowBox[{"T_:", "1"}], ",", 
        RowBox[{"n_:", "1"}], ",", 
        RowBox[{"m_:", "1"}], ",", 
        RowBox[{"k_:", "1"}]}], "]"}]}], "}"}], "]"}], ":=", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"reaction", ",", " ", "vars"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"vars", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", ",", "X1"}], "}"}], "//", "Flatten"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"reaction", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"RightTeeArrow", "[", 
          RowBox[{"vars", ",", "Y"}], "]"}], ",", 
         RowBox[{"NHCA", "[", 
          RowBox[{"v", ",", "T", ",", "n", ",", "m", ",", "k"}], "]"}]}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"dbgArrows", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<expandArrows:\>\"", ",", " ", "reaction"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", "reaction", "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expandArrows", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RightTeeArrow", "[", 
       RowBox[{"X_", ",", "Y_"}], " ", "]"}], ",", 
      RowBox[{"NHCA", "[", "x___", "]"}]}], "}"}], "]"}], ":=", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "reaction", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"reaction", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"RightTeeArrow", "[", 
          RowBox[{"X", ",", "Y"}], "]"}], ",", 
         RowBox[{"NHCA", "[", "x", "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Error: expandArrows: incorrect arrow format in \>\"", ",", 
        "reaction", ",", 
        "\"\< correct format is NHCA[v,T,n,m,k] or \
NHCA[v,{TP,TM},n,m,k]\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", "reaction", "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4010338056142683`*^9, 3.401033806065529*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["NHCA parseArrowForm", "Subsubsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"parseArrowForm", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RightTeeArrow", "[", 
       RowBox[{"X_", ",", "Y_"}], " ", "]"}], ",", 
      RowBox[{"NHCA", "[", 
       RowBox[{"v_", ",", " ", "T_", ",", "n_", ",", "m_", ",", "k_"}], 
       "]"}]}], "}"}], "]"}], ":=", " ", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "reaction", ",", "rateLaw", ",", " ", "vars", ",", " ", "nvars", ",", 
       " ", "odes", ",", "\[IndentingNewLine]", "vvalue", ",", "Tvalues", ",",
        "nvalues", ",", "mvalue", ",", "nT", ",", " ", "QP", ",", " ", "QM", 
       ",", "dummy"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"reaction", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"RightTeeArrow", "[", 
          RowBox[{"X", ",", "Y"}], "]"}], ",", 
         RowBox[{"NHCA", "[", 
          RowBox[{"v", ",", "T", ",", "n", ",", "m", ",", "k"}], "]"}]}], 
        "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"vars", "=", 
       RowBox[{
        RowBox[{"{", "X", "}"}], "//", "Flatten"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dummy", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Rule", "[", 
            RowBox[{"#", ",", "#"}], "]"}], ",", "1"}], "}"}], "&"}], "/@", 
        "vars"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vars", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"#", "[", "Global`t", "]"}], "&"}], ")"}], "/@", "vars"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"nvars", "=", 
       RowBox[{"Length", "[", "vars", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"vvalue", " ", "=", " ", 
       RowBox[{"getSingleValue", "[", 
        RowBox[{
        "v", ",", " ", "1", ",", " ", "\"\<NHCA v\>\"", ",", " ", 
         "reaction"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Tvalues", "=", "T"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "vars", "]"}], "\[Equal]", "1"}], ",", " ", 
        RowBox[{"Tvalues", "=", 
         RowBox[{"List", "[", "Tvalues", "]"}]}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"Tvalues", "=", 
       RowBox[{"getnListValues", "[", 
        RowBox[{
        "nvars", ",", "Tvalues", ",", "\"\<NHCA {TP,TM}\>\"", ",", 
         "reaction"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"nT", "=", 
       RowBox[{"Union", "[", 
        RowBox[{"Length", "/@", "Tvalues"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "nT", "]"}], ">", "1"}], ",", " ", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Error: invalid NHCA T values can not be combined: \>\"", ",", 
           " ", "reaction"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"{", "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"nT", "=", 
       RowBox[{"First", "[", "nT", "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"nvalues", "=", 
       RowBox[{"getnValues", "[", 
        RowBox[{"nvars", ",", "n", ",", "\"\<NHCA n\>\"", ",", "reaction"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"mvalue", "=", 
       RowBox[{"getSingleValue", "[", 
        RowBox[{"m", ",", "1", ",", "\"\<NHCA m\>\"", ",", " ", "reaction"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"kvalue", "=", 
       RowBox[{"getSingleValue", "[", 
        RowBox[{"k", ",", "1", ",", "\"\<NHCA k\>\"", ",", " ", "reaction"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Switch", "[", 
       RowBox[{
       "nT", ",", "\[IndentingNewLine]", "1", ",", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Tvalues", " ", "=", " ", 
          RowBox[{"First", "/@", "Tvalues"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"QP", "=", 
          RowBox[{"Tvalues", "*", 
           RowBox[{"UnitStep", "[", "Tvalues", "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"QM", "=", 
          RowBox[{"Tvalues", "*", 
           RowBox[{"UnitStep", "[", 
            RowBox[{"-", "Tvalues"}], "]"}]}]}], ";"}], "\[IndentingNewLine]",
         ",", "\[IndentingNewLine]", "2", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"QP", ",", " ", "QM"}], "}"}], "=", 
          RowBox[{"Transpose", "[", "Tvalues", "]"}]}], ";"}], 
        "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "_", ",", " ", 
        RowBox[{
         RowBox[{
         "Print", "[", "\"\<Error: invalid format for NHCA T\>\"", "]"}], 
         ";"}]}], " ", "\[IndentingNewLine]", "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"QP", "=", 
       RowBox[{"Times", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "#"}], ")"}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{"QP", "*", 
            RowBox[{"(", 
             RowBox[{"vars", "^", "nvalues"}], ")"}]}], ")"}]}], ")"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"QM", "=", 
       RowBox[{"Times", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "#"}], ")"}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{"QM", "*", 
            RowBox[{"(", 
             RowBox[{"vars", "^", "nvalues"}], ")"}]}], ")"}]}], ")"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"rateLaw", "=", 
       RowBox[{"vvalue", "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"QP", "^", "mvalue"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"kvalue", "*", 
            RowBox[{"QM", "^", "mvalue"}]}], "+", 
           RowBox[{"QP", "^", "mvalue"}]}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"rateLaw", "=", 
       RowBox[{"rateLaw", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Global`\[EmptySet]", "[", "Global`t", "]"}], "\[Rule]", 
          " ", "0"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"odes", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Y", "[", "Global`t", "]"}], ",", " ", "rateLaw"}], "}"}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dummy", "=", 
       RowBox[{"Join", "@@", 
        RowBox[{"(", 
         RowBox[{"parseArrowForm", "/@", "dummy"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"odes", " ", "=", " ", 
       RowBox[{"Join", "@@", 
        RowBox[{"{", 
         RowBox[{"odes", ",", " ", "dummy"}], "}"}]}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "odes", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"parseArrowForm", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RightTeeArrow", "[", 
       RowBox[{"X_", ",", "Y_"}], " ", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"NHCA", "[", "z___", "]"}], "}"}]}], "}"}], "]"}], ":=", " ", 
   RowBox[{"parseArrowForm", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RightTeeArrow", "[", 
       RowBox[{"X", ",", "Y"}], "]"}], ",", 
      RowBox[{"NHCA", "[", "z", "]"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4010338061819363`*^9, 3.401033806483761*^9}, {
  3.55164086053934*^9, 3.5516408626391163`*^9}, {3.551641594909822*^9, 
  3.551641641785434*^9}, {3.551901129887784*^9, 3.551901223597212*^9}, {
  3.5519013972014713`*^9, 3.551901415759156*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Cellerator Options for NHCA - backward compatibility, discouraged\
\>", "Subsubsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"NHCA", "[", 
    RowBox[{"opt___", "?", "OptionQ"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "v", ",", "T", ",", "TP", ",", "TM", ",", "n", ",", "m", ",", "k", ",", 
       " ", "incorrect"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"v", "=", 
       RowBox[{
        RowBox[{"vmax", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"Options", "[", "NHCA", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T", "=", 
       RowBox[{
        RowBox[{"TNHCA", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"Options", "[", "NHCA", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"TM", "=", 
       RowBox[{
        RowBox[{"TMINUS", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"Options", "[", "NHCA", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"TP", "=", 
       RowBox[{
        RowBox[{"TPLUS", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"Options", "[", "NHCA", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{
        RowBox[{"nNHCA", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"Options", "[", "NHCA", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"m", "=", 
       RowBox[{
        RowBox[{"mNHCA", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"Options", "[", "NHCA", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"k", "=", 
       RowBox[{
        RowBox[{"kNHCA", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"Options", "[", "NHCA", "]"}]}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"!", 
            RowBox[{"SameQ", "[", 
             RowBox[{"TP", ",", 
              RowBox[{"{", "}"}]}], "]"}]}], ")"}], " ", "\[And]", "  ", 
          RowBox[{"(", 
           RowBox[{"!", 
            RowBox[{"SameQ", "[", 
             RowBox[{"TM", ",", 
              RowBox[{"{", "}"}]}], "]"}]}], ")"}]}], ")"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ret", "=", 
          RowBox[{"NHCA", "[", 
           RowBox[{"v", ",", " ", 
            RowBox[{"{", 
             RowBox[{"TP", ",", "TM"}], "}"}], ",", "n", ",", "m", ",", "k"}],
            "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ret", "=", 
          RowBox[{"NHCA", "[", 
           RowBox[{"v", ",", "T", ",", "n", ",", "m", ",", "k"}], "]"}]}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"incorrect", "=", " ", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"First", "/@", 
          RowBox[{"{", "opt", "}"}]}], ",", 
         RowBox[{"First", "/@", " ", 
          RowBox[{"Options", "[", "NHCA", "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Warning: NHCA[...] unknown option \>\"", ",", " ", 
          RowBox[{"#", " ", "\[Rule]", " ", 
           RowBox[{"(", 
            RowBox[{"#", "/.", 
             RowBox[{"{", "opt", "}"}]}], ")"}]}], ",", " ", 
          "\"\< ignored.\>\""}], "]"}], "&"}], "/@", "incorrect"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "ret", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.449245599473797*^9, 3.449245630344923*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["GMWC/MWC", "Subsection",
 CellDingbat->None,
 Background->RGBColor[1, 0.983139, 0.832074]],

Cell[CellGroupData[{

Cell["GMWC expandArrows", "Subsubsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"expandArrows", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Underoverscript", "[", 
        RowBox[{
         RowBox[{"DoubleLongRightArrow", "[", 
          RowBox[{"S_", ",", " ", "P_"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "activators_", ",", " ", "inhibitors_", ",", " ", 
           "comptetitiveInhibitors_"}], "}"}], ",", " ", "enzyme_"}], "]"}], 
       ",", 
       RowBox[{"GMWC", "[", 
        RowBox[{
         RowBox[{"kcat_:", "1"}], ",", " ", 
         RowBox[{"n_:", "1"}], ",", 
         RowBox[{"c_:", "1"}], ",", " ", 
         RowBox[{"L_:", "1"}], ",", " ", 
         RowBox[{"K_:", "1"}]}], "]"}]}], "}"}], "]"}], ":=", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "reaction", ",", "Slist", ",", "Alist", ",", " ", "Ilist", ",", " ", 
        "Plist", ",", "CIlist", ",", " ", "Klist", ",", " ", "nA", ",", " ", 
        "nI", ",", " ", "nS", ",", "nKneeded", ",", "nil"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
      RowBox[{
       RowBox[{"reaction", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Underoverscript", "[", 
           RowBox[{
            RowBox[{"DoubleLongRightArrow", "[", 
             RowBox[{"S", ",", " ", "P"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "activators", ",", " ", "inhibitors", ",", " ", 
              "comptetitiveInhibitors"}], "}"}], ",", " ", "enzyme"}], "]"}], 
          ",", 
          RowBox[{"GMWC", "[", 
           RowBox[{
           "kcat", ",", " ", "n", ",", "c", ",", " ", "L", ",", " ", "K"}], 
           "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"dbgArrows", ",", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<expandArrows:\>\"", ",", " ", "reaction"}], "]"}]}], 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Alist", "=", 
        RowBox[{
         RowBox[{"{", "activators", "}"}], "//", "Flatten"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Ilist", "=", 
        RowBox[{
         RowBox[{"{", "inhibitors", "}"}], "//", "Flatten"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Slist", " ", "=", " ", 
        RowBox[{
         RowBox[{"{", "S", "}"}], "//", "Flatten"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Klist", "=", 
        RowBox[{
         RowBox[{"{", "K", "}"}], "//", "Flatten"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Plist", "=", 
        RowBox[{
         RowBox[{"{", "P", "}"}], "//", "Flatten"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"CIlist", "=", "comptetitiveInhibitors"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"ListQ", "[", "CIlist", "]"}]}], ",", " ", 
         RowBox[{"CIlist", "=", 
          RowBox[{"{", "CIlist", "}"}]}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"nS", "=", 
        RowBox[{"Length", "[", "Slist", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"nI", "=", 
        RowBox[{"Length", "[", "Ilist", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"nA", "=", 
        RowBox[{"Length", "[", "Alist", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"nCI", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"CIlist", "//", "Flatten"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nKneeded", "=", 
        RowBox[{"nS", "+", "nI", "+", "nA", "+", "nCI"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "Klist", "]"}], ">", "nKneeded"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Warning: expandArrows: expecting \>\"", ",", "nKneeded", ",", 
            "\"\< K values; found \>\"", ",", " ", 
            RowBox[{"Length", "[", "Klist", "]"}], ",", " ", 
            "\"\< K values. Extra values ignored. Reaction: \>\"", ",", 
            "reaction"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Klist", "=", 
           RowBox[{"Take", "[", 
            RowBox[{"Klist", ",", "nKneeded"}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Klist", "=", 
        RowBox[{"PadRight", "[", 
         RowBox[{"Klist", ",", " ", "nKneeded", ",", "1"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"(", 
           RowBox[{"And", "@@", 
            RowBox[{"(", 
             RowBox[{"ListQ", "/@", "CIlist"}], ")"}]}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Error: expandArrows: Competitive Inhibitors must be expressed \
as a list of lists. Up to \>\"", ",", 
            RowBox[{"nS", "+", "nA"}], ",", 
            "\"\< sublists may be specified in the reaction \>\"", ",", 
            "reaction"}], " ", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"CIlist", "=", 
        RowBox[{
         RowBox[{"PadRight", "[", 
          RowBox[{"CIlist", ",", 
           RowBox[{"nS", "+", "nA"}], ",", "nil"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{"nil", "\[Rule]", " ", 
           RowBox[{"{", "}"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"reaction", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Underoverscript", "[", 
           RowBox[{
            RowBox[{"DoubleLongRightArrow", "[", 
             RowBox[{"Slist", ",", " ", "Plist"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"Alist", ",", " ", "Ilist", ",", " ", "CIlist"}], "}"}], 
            ",", " ", "enzyme"}], "]"}], ",", 
          RowBox[{"GMWC", "[", 
           RowBox[{
           "kcat", ",", " ", "n", ",", "c", ",", " ", "L", ",", " ", 
            "Klist"}], "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", "reaction", "}"}], "]"}], ";"}]}], "\[IndentingNewLine]",
      "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expandArrows", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Underoverscript", "[", 
       RowBox[{
        RowBox[{"DoubleLongRightArrow", "[", 
         RowBox[{"S_", ",", " ", "P_"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"activators_", ",", " ", "inhibitors_"}], "}"}], ",", " ", 
        "enzyme_"}], "]"}], ",", 
      RowBox[{"GMWC", "[", 
       RowBox[{
        RowBox[{"kcat_:", "1"}], ",", " ", 
        RowBox[{"n_:", "1"}], ",", 
        RowBox[{"c_:", "1"}], ",", " ", 
        RowBox[{"L_:", "1"}], ",", " ", 
        RowBox[{"K_:", "1"}]}], "]"}]}], "}"}], "]"}], ":=", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "reaction", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"reaction", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Underoverscript", "[", 
          RowBox[{
           RowBox[{"DoubleLongRightArrow", "[", 
            RowBox[{"S", ",", " ", "P"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"activators", ",", " ", "inhibitors", ",", " ", 
             RowBox[{"{", "}"}]}], "}"}], ",", " ", "enzyme"}], "]"}], ",", 
         RowBox[{"GMWC", "[", 
          RowBox[{
          "kcat", ",", " ", "n", ",", "c", ",", " ", "L", ",", " ", "K"}], 
          "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"dbgArrows", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<expandArrows:\>\"", ",", " ", "reaction"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"reaction", "=", 
       RowBox[{"expandArrows", "[", "reaction", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "reaction", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"expandArrows", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Underoverscript", "[", 
        RowBox[{
         RowBox[{"DoubleLongRightArrow", "[", 
          RowBox[{"S_", ",", " ", "P_"}], "]"}], ",", "\[Alpha]_", ",", " ", 
         "enzyme_"}], "]"}], ",", 
       RowBox[{"GMWC", "[", 
        RowBox[{
         RowBox[{"kcat_:", "1"}], ",", " ", 
         RowBox[{"n_:", "1"}], ",", 
         RowBox[{"c_:", "1"}], ",", " ", 
         RowBox[{"L_:", "1"}], ",", " ", 
         RowBox[{"K_:", "1"}]}], "]"}]}], "}"}], "]"}], ":=", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "reaction", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"reaction", "=", 
        RowBox[{"expandArrows", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Underoverscript", "[", 
            RowBox[{
             RowBox[{"DoubleLongRightArrow", "[", 
              RowBox[{"S", ",", " ", "P"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Alpha]", ",", 
               RowBox[{"{", "}"}]}], "}"}], ",", " ", "enzyme"}], "]"}], ",", 
           
           RowBox[{"GMWC", "[", 
            RowBox[{
            "kcat", ",", " ", "n", ",", "c", ",", " ", "L", ",", " ", "K"}], 
            "]"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "reaction", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"expandArrows", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Overscript", "[", 
        RowBox[{
         RowBox[{"DoubleLongRightArrow", "[", 
          RowBox[{"S_", ",", " ", "P_"}], "]"}], ",", " ", "enzyme_"}], "]"}],
        ",", 
       RowBox[{"GMWC", "[", 
        RowBox[{
         RowBox[{"kcat_:", "1"}], ",", " ", 
         RowBox[{"n_:", "1"}], ",", 
         RowBox[{"c_:", "1"}], ",", " ", 
         RowBox[{"L_:", "1"}], ",", " ", 
         RowBox[{"K_:", "1"}]}], "]"}]}], "}"}], "]"}], ":=", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "reaction", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"reaction", "=", 
        RowBox[{"expandArrows", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Underoverscript", "[", 
            RowBox[{
             RowBox[{"DoubleLongRightArrow", "[", 
              RowBox[{"S", ",", " ", "P"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "}"}], ",", 
               RowBox[{"{", "}"}]}], "}"}], ",", " ", "enzyme"}], "]"}], ",", 
           
           RowBox[{"GMWC", "[", 
            RowBox[{
            "kcat", ",", " ", "n", ",", "c", ",", " ", "L", ",", " ", "K"}], 
            "]"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"dbgArrows", ",", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<expandArrows:\>\"", ",", " ", "reaction"}], "]"}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "reaction", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"expandArrows", "[", 
     RowBox[{"{", 
      RowBox[{"X___", ",", 
       RowBox[{"GMWC", "[", "Y___", "]"}]}], "}"}], "]"}], ":=", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "reaction", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"reaction", "=", 
        RowBox[{"{", 
         RowBox[{"X", ",", 
          RowBox[{"GMWC", "[", "Y", "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"dbgArrows", ",", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<expandArrows:\>\"", ",", " ", "reaction"}], "]"}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<Error: expandArrows: incorrect arrow format in \>\"", ",", 
         "reaction", ",", "\"\< correct format for GMWC reaction is \>\"", 
         ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Underoverscript", "[", 
            RowBox[{
             RowBox[{"DoubleLongRightArrow", "[", 
              RowBox[{
              "\"\<{S1,S2,\[Ellipsis]}\>\"", ",", " ", 
               "\"\<{P1,P2,\[Ellipsis]}\>\""}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
              "\"\<{A1,A2,\[Ellipsis]}\>\"", ",", " ", 
               "\"\<{I1,I2,\[Ellipsis]}\>\"", ",", " ", 
               "\"\<{CI1,CI2,...}\>\""}], "}"}], ",", " ", "\"\<enzyme\>\""}],
             "]"}], ",", 
           "\"\<GMWC[\!\(\*SubscriptBox[\(k\), \(cat\)]\),n,c,L,K]\>\""}], 
          "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", "reaction", "}"}], "]"}], ";"}]}], "\[IndentingNewLine]",
      "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expandArrows", "[", 
    RowBox[{"{", 
     RowBox[{"X___", ",", 
      RowBox[{"MWC", "[", "Y___", "]"}]}], "}"}], "]"}], ":=", " ", 
   RowBox[{"expandArrows", "[", 
    RowBox[{"{", 
     RowBox[{"X", ",", 
      RowBox[{"GMWC", "[", "Y", "]"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4010337583500023`*^9, 3.401033759303425*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["GMWC parseArrowForm", "Subsubsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Fixed", " ", "5", " ", "April", " ", "8", " ", 
   RowBox[{"v", ".", " ", "0.64"}]}], " ", "-", " ", 
  RowBox[{
  "to", " ", "include", " ", "all", " ", "modifiers", " ", "in", " ", "ODES", 
   " ", "as", " ", "well", " ", "as", " ", "the", " ", "substrate", " ", 
   "and", " ", "product"}]}]], "Text",
 CellChangeTimes->{{3.4164369512295227`*^9, 3.416436987639646*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"parseArrowForm", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Underoverscript", "[", 
         RowBox[{
          RowBox[{"DoubleLongRightArrow", "[", 
           RowBox[{"S_", ",", " ", "P_"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"A_", ",", " ", "In_", ",", " ", "CI_"}], "}"}], ",", " ", 
          "En_"}], "]"}], ",", 
        RowBox[{"GMWC", "[", 
         RowBox[{
         "kcat_", ",", " ", "n_", ",", "c_", ",", " ", "L_", ",", " ", "K_"}],
          "]"}]}], "}"}], "]"}], ":=", " ", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "reaction", ",", "rateLaw", ",", " ", "svars", ",", " ", "pvars", ",",
          "vars", ",", " ", "odes", ",", " ", "dvdt", ",", 
         "\[IndentingNewLine]", "As", ",", "Is", ",", "CIs", ",", "Ss", ",", 
         "Ps", ",", " ", "Ks", ",", " ", "normalize", ",", " ", "nCIs", ",", 
         " ", "CIss", ",", "m", ",", "nS", ",", "nA", ",", " ", 
         RowBox[{"dbg", "=", "False"}], ",", "OnePlusS", ",", "OnePluscS", 
         ",", "OnePlusA", ",", " ", "OnePlusI", ",", "Prod1PlusX", ",", " ", 
         "modifierVariables", ",", " ", "nmodifiers", ",", " ", 
         "modifierODES"}], "}"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"normalize", "[", 
          RowBox[{"X_", ",", " ", "Klist_"}], "]"}], ":=", " ", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"XX", ",", "KX", ",", "KNew", ",", "nn"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nn", "=", 
             RowBox[{"Length", "[", "X", "]"}]}], ";", "\[IndentingNewLine]", 
            
            RowBox[{"KX", "=", 
             RowBox[{"Take", "[", 
              RowBox[{"Klist", ",", " ", "nn"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"XX", "=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"#", "[", "Global`t", "]"}], "&"}], ")"}], "/@", 
              "X"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"XX", "=", 
             RowBox[{"XX", "/", "KX"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"Knew", "=", 
             RowBox[{"Drop", "[", 
              RowBox[{"Klist", ",", "nn"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Return", "[", 
             RowBox[{"{", 
              RowBox[{"XX", ",", "Knew"}], "}"}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Prod1PlusX", "[", "X_", "]"}], ":=", 
         RowBox[{"Times", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"Plus", "@@", "#"}]}], ")"}], "&"}], "/@", "X"}], 
           ")"}]}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        
        RowBox[{"reaction", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Underoverscript", "[", 
            RowBox[{
             RowBox[{"DoubleLongRightArrow", "[", 
              RowBox[{"S", ",", " ", "P"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"A", ",", " ", "In", ",", " ", "CI"}], "}"}], ",", " ", 
             "En"}], "]"}], ",", 
           RowBox[{"GMWC", "[", 
            RowBox[{
            "kcat", ",", " ", "n", ",", "c", ",", " ", "L", ",", " ", "K"}], 
            "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"dbgArrows", ",", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<parseArrowForm:\>\"", ",", " ", "reaction"}], "]"}]}],
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"dbg", ",", " ", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<A=\>\"", ",", " ", "A", ",", " ", "\"\< In=\>\"", ",", " ", 
            "In", ",", " ", "\"\< CI=\>\"", ",", " ", "CI", ",", " ", 
            "\"\< En=\>\"", ",", " ", "En"}], "]"}]}], "]"}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"modifierVariables", "=", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", "A", "}"}], ",", " ", 
            RowBox[{"{", "In", "}"}], ",", " ", 
            RowBox[{"{", "CI", "}"}], ",", " ", 
            RowBox[{"{", "En", "}"}]}], "]"}], "//", "Flatten"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"modifierVariables", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", "[", "Global`t", "]"}], "&"}], ")"}], "/@", 
          "modifierVariables"}]}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"nmodifiers", " ", "=", " ", 
         RowBox[{"Length", "[", "modifierVariables", "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"modifierODES", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", " ", 
           RowBox[{"{", "nmodifiers", "}"}]}], "]"}]}], ";", " ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"dbg", ",", " ", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<modifierVariables: \>\"", ",", " ", "modifierVariables"}], 
           "]"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"svars", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", "[", "Global`t", "]"}], "&"}], ")"}], "/@", "S"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"pvars", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", "[", "Global`t", "]"}], "&"}], ")"}], "/@", "P"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Ks", "=", "K"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Ss", ",", " ", "Ks"}], "}"}], "=", 
         RowBox[{"normalize", "[", 
          RowBox[{"S", ",", "Ks"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"As", ",", " ", "Ks"}], "}"}], "=", 
         RowBox[{"normalize", "[", 
          RowBox[{"A", ",", "Ks"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Is", ",", " ", "Ks"}], "}"}], "=", 
         RowBox[{"normalize", "[", 
          RowBox[{"In", ",", " ", "Ks"}], "]"}]}], ";", "\[IndentingNewLine]",
         "\[IndentingNewLine]", 
        RowBox[{"If", " ", "[", 
         RowBox[{"dbg", ",", "  ", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<S=\>\"", ",", "Ss", ",", "\"\<\\nA=\>\"", ",", "As", ",", 
             "\"\<\\nI=\>\"", ",", "Is", ",", "\"\<\\nK's left:\>\"", ",", 
             "Ks"}], "]"}], ";"}]}], " ", "]"}], ";", " ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"nCIs", "=", 
         RowBox[{"Length", "/@", "CI"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"CIs", ",", " ", "Ks"}], "}"}], "=", 
         RowBox[{"normalize", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", "CI", "]"}], ",", "Ks"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"CIss", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "nCIs", "]"}], ">", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"m", "=", 
            RowBox[{"First", "[", "nCIs", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"nCIs", "=", 
            RowBox[{"Rest", "[", "nCIs", "]"}]}], ";", "\[IndentingNewLine]", 
           
           RowBox[{"CIss", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"CIss", ",", 
              RowBox[{"Take", "[", 
               RowBox[{"CIs", ",", "m"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"CIs", "=", 
            RowBox[{"Drop", "[", 
             RowBox[{"CIs", ",", "m"}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"dvdt", "=", 
         RowBox[{
          RowBox[{"En", "[", "Global`t", "]"}], "*", "kcat"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", " ", 
         RowBox[{"dbg", ",", " ", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<CI=\>\"", ",", "CIss", ",", " ", "\"\<\\nK's left:\>\"", ",",
              "Ks", ",", " ", "\"\<\\nnCI:\>\"", ",", "nCIs"}], "]"}], 
           ";"}]}], " ", "]"}], " ", ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"nS", "=", 
         RowBox[{"Length", "[", "Ss", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"nA", "=", 
         RowBox[{"Length", "[", "As", "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"CIs", "=", 
         RowBox[{"Take", "[", 
          RowBox[{"CIss", ",", "nS"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"CIss", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"CIss", ",", "nS"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"OnePlusS", "=", 
         RowBox[{
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"List", "/@", "Ss"}], ",", "CIs"}], "}"}]}], "]"}], "//",
           "Prod1PlusX"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"OnePluscS", "=", 
         RowBox[{
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"c", "*", 
               RowBox[{"List", "/@", "Ss"}]}], ",", "CIs"}], "}"}]}], "]"}], "//",
           "Prod1PlusX"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"CIs", "=", 
         RowBox[{"Take", "[", 
          RowBox[{"CIss", ",", "nA"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"OnePlusA", "=", 
         RowBox[{
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"List", "/@", "As"}], ",", "CIs"}], "}"}]}], "]"}], "//",
           "Prod1PlusX"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"OnePlusI", "=", 
         RowBox[{"Times", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "+", "#"}], ")"}], "&"}], "/@", "Is"}], ")"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"CIs", "=", 
         RowBox[{"Times", "@@", 
          RowBox[{"(", 
           RowBox[{"c", "*", "Ss"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Ss", "=", 
         RowBox[{"Times", "@@", "Ss"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"dbg", ",", " ", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<1+S+Sbar:\>\"", ",", "OnePlusS", ",", 
            "\"\<\\n1+cS+cSbar:\>\"", ",", "OnePluscS", ",", 
            "\"\<\\n1+A+Abar:\>\"", ",", "OnePlusA", ",", "\"\<\\n1+I:\>\"", 
            ",", "OnePlusI", ",", "\"\<\\ncS:\>\"", ",", "CIs"}], "]"}]}], 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"dvdt", "=", 
         RowBox[{"dvdt", "*", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["OnePlusA", "n"], "*", "Ss", "*", 
              SuperscriptBox["OnePlusS", 
               RowBox[{"n", "-", "1"}]]}], "+", 
             RowBox[{"L", "*", "CIs", "*", 
              SuperscriptBox["OnePluscS", 
               RowBox[{"n", "-", "1"}]], "*", 
              SuperscriptBox["OnePlusI", "n"]}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["OnePlusA", "n"], 
              SuperscriptBox["OnePlusS", "n"]}], "+", 
             RowBox[{"L", "*", 
              SuperscriptBox["OnePluscS", "n"], "*", 
              SuperscriptBox["OnePlusI", "n"]}]}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"dbg", ",", " ", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<dvdt=\>\"", ",", "dvdt"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"odes", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"#", ",", 
               RowBox[{"-", "dvdt"}]}], "}"}], "&"}], "/@", "svars"}], ",", 
           " ", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"#", ",", "dvdt"}], "}"}], "&"}], "/@", "pvars"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"dbg", ",", " ", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<odes: \>\"", ",", " ", "odes"}], "]"}]}], "]"}], ";", 
        " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"modifierODES", "=", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"modifierVariables", ",", " ", "modifierODES"}], "}"}], 
          "]"}]}], ";", " ", "\[IndentingNewLine]", " ", 
        RowBox[{"If", "[", 
         RowBox[{"dbg", ",", " ", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<modifierODES: \>\"", ",", " ", "modifierODES"}], 
           "]"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"odes", " ", "=", " ", 
         RowBox[{"Join", "[", 
          RowBox[{"odes", ",", " ", "modifierODES"}], "]"}]}], ";", " ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "odes", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.401033759471231*^9, 3.401033759571362*^9}, {
  3.416435988892524*^9, 3.416435989322242*^9}, {3.4164360972231083`*^9, 
  3.4164361209400454`*^9}, {3.416436385229043*^9, 3.416436393451275*^9}, {
  3.416436454756744*^9, 3.416436514186523*^9}, {3.416436555734466*^9, 
  3.416436566731059*^9}, {3.4164366329350853`*^9, 3.416436755394334*^9}, {
  3.4164367903092117`*^9, 3.416436854192321*^9}, {3.416436886406479*^9, 
  3.41643689684132*^9}, {3.416436944982705*^9, 3.416436945597975*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Cellerator Options for GRN - backward compatibility, discouraged\
\>", "Subsubsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GMWC", "[", 
    RowBox[{"opt___", "?", "OptionQ"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "r", ",", " ", "T", ",", " ", "n", ",", " ", "h", ",", "ret", ",", " ", 
       "f", ",", " ", "incorrect"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ret", "=", 
       RowBox[{"GMWC", "[", "\[IndentingNewLine]", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"kcatGMWC", "/.", 
           RowBox[{"{", "opt", "}"}]}], "/.", 
          RowBox[{"Options", "[", "GMWC", "]"}]}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"nGMWC", "/.", 
           RowBox[{"{", "opt", "}"}]}], "/.", 
          RowBox[{"Options", "[", "GMWC", "]"}]}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"cGMWC", "/.", 
           RowBox[{"{", "opt", "}"}]}], "/.", 
          RowBox[{"Options", "[", "GMWC", "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LGMWC", "/.", 
           RowBox[{"{", "opt", "}"}]}], "/.", 
          RowBox[{"Options", "[", "GMWC", "]"}]}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"KGMWC", "/.", 
             RowBox[{"{", "opt", "}"}]}], "/.", 
            RowBox[{"Options", "[", "GMWC", "]"}]}], "}"}], "//", 
          "Flatten"}]}], "\[IndentingNewLine]", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"incorrect", "=", " ", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"First", "/@", 
          RowBox[{"{", "opt", "}"}]}], ",", 
         RowBox[{"First", "/@", " ", 
          RowBox[{"Options", "[", "GMWC", "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Warning: GMWC[...] unknown option \>\"", ",", " ", 
          RowBox[{"#", " ", "\[Rule]", " ", 
           RowBox[{"(", 
            RowBox[{"#", "/.", 
             RowBox[{"{", "opt", "}"}]}], ")"}]}], ",", " ", 
          "\"\< ignored.\>\""}], "]"}], "&"}], "/@", "incorrect"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "ret", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.449245932650259*^9, 3.449245944686213*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
{ A \[RightTeeArrow]B user_ [r, T, n, h, f]}  : User defined regulatory \
functions \
\>", "Subsection",
 CellDingbat->None,
 Background->RGBColor[1, 0.983139, 0.832074]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"expandArrows", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RightTeeArrow", "[", 
       RowBox[{"X_", ",", "Y_"}], " ", "]"}], ",", 
      RowBox[{"user_", "[", 
       RowBox[{"r_", ",", " ", "T_", ",", "n_", ",", "h_", ",", "f_"}], 
       "]"}]}], "}"}], "]"}], ":=", " ", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "reaction", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"reaction", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"RightTeeArrow", "[", 
          RowBox[{"X", ",", "Y"}], "]"}], ",", 
         RowBox[{"user", "[", 
          RowBox[{"r", ",", "T", ",", "n", ",", "h", ",", "f"}], "]"}]}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"dbgArrows", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<expandArrows:\>\"", ",", " ", "reaction"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", "reaction", "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expandArrows", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RightTeeArrow", "[", 
       RowBox[{
        RowBox[{"Plus", "[", 
         RowBox[{"X_", ",", "X1__"}], "]"}], ",", "Y_"}], " ", "]"}], ",", 
      RowBox[{"user_", "[", 
       RowBox[{"r_", ",", "T_", ",", "n_", ",", "h_", ",", "f_"}], "]"}]}], 
     "}"}], "]"}], ":=", " ", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"reaction", ",", "vars"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"vars", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", ",", "X1"}], "}"}], "//", "Flatten"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"reaction", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"RightTeeArrow", "[", 
          RowBox[{"vars", ",", "Y"}], "]"}], ",", 
         RowBox[{"user", "[", 
          RowBox[{"r", ",", "T", ",", "n", ",", "h", ",", "f"}], "]"}]}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"dbgArrows", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<expandArrows:\>\"", ",", " ", "reaction"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", "reaction", "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expandArrows", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RightTeeArrow", "[", 
       RowBox[{"X_", ",", "Y_"}], " ", "]"}], ",", 
      RowBox[{"user_", "[", "x___", "]"}]}], "}"}], "]"}], ":=", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"reaction", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"RightTeeArrow", "[", 
          RowBox[{"X", ",", "Y"}], "]"}], ",", 
         RowBox[{"user", "[", "x", "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"user", ",", "Times"}], "]"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Error: invalid user function name: \>\"", "<>", "\"\<\\\"\>\"", 
          "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", "x", "}"}], "//", "Flatten"}], ")"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", 
          "\"\<\\\". Check for embedded blanks in function name, that are \
interpreted as \\\"Times\\\", \>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"FullForm", "[", 
            RowBox[{"user", "[", "x", "]"}], "]"}], "]"}]}], 
         "\[IndentingNewLine]", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Error: invalid user defined reaction format: \>\"", ",", 
        "reaction", ",", 
        RowBox[{"\"\< Correct format is {\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"X", "//", "InputForm"}], "]"}], "<>", 
         "\"\<\[RightTeeArrow]\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"Y", "//", "InputForm"}], "]"}], "<>", "\"\<,\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"user", "//", "InputForm"}], "]"}], "<>", 
         "\"\<[r,T,n,h,f]}\>\""}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.401033806617529*^9, 3.40103380706876*^9}}],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"parseArrowForm", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"RightTeeArrow", "[", 
         RowBox[{
          RowBox[{"Plus", "[", 
           RowBox[{"X_", ",", "X1__"}], "]"}], ",", "Y_"}], " ", "]"}], ",", 
        RowBox[{"user_", "[", 
         RowBox[{"r_", ",", "T_", ",", "n_", ",", "h_", ",", "f_"}], "]"}]}], 
       "}"}], "]"}], ":=", " ", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "odes", ",", "rateLaw", ",", " ", "vars", ",", "x", ",", " ", 
         "reaction"}], "}"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"reaction", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"RightTeeArrow", "[", 
            RowBox[{
             RowBox[{"Plus", "[", "X", "]"}], ",", "Y"}], "]"}], ",", 
           RowBox[{"user", "[", 
            RowBox[{"r", ",", "T", ",", "n", ",", "h", ",", "f"}], "]"}]}], 
          "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"dbgArrows", ",", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<parseArrowForm:\>\"", ",", " ", "reaction"}], "]"}]}],
          "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"vars", "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"X", ",", "X1"}], "}"}], "//", "Flatten"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"odes", " ", "=", " ", 
         RowBox[{"parseArrowForm", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"RightTeeArrow", "[", 
             RowBox[{"vars", ",", "Y"}], "]"}], ",", 
            RowBox[{"user", "[", 
             RowBox[{"r", ",", "T", ",", "n", ",", "h", ",", "f"}], "]"}]}], 
           "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "odes", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"parseArrowForm", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"RightTeeArrow", "[", 
         RowBox[{"X_", ",", "Y_"}], " ", "]"}], ",", 
        RowBox[{"user_", "[", 
         RowBox[{"r_", ",", "T_", ",", "n_", ",", "h_", ",", "f_"}], "]"}]}], 
       "}"}], "]"}], ":=", " ", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "reaction", ",", "vars", ",", "nvars", ",", "Tall", ",", "nall", ",", 
         "x", ",", "Tlast", ",", "nLast", ",", "hused", ",", "rused", ",", 
         "\[IndentingNewLine]", "dummy", ",", "\[IndentingNewLine]", "odes", 
         ",", "rateLaw", ",", " ", "V", ",", " ", "K", ",", "nn", ",", "rr", 
         ",", "multiplier"}], "}"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"reaction", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"RightTeeArrow", "[", 
            RowBox[{"X", ",", "Y"}], "]"}], ",", 
           RowBox[{"user", "[", 
            RowBox[{
            "r", ",", " ", "T", ",", " ", "n", ",", " ", "h", ",", "f"}], 
            "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"dbgArrows", ",", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<parseArrowForm:\>\"", ",", " ", "reaction"}], "]"}]}],
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"vars", "=", 
         RowBox[{
          RowBox[{"{", "X", "}"}], "//", "Flatten"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dummy", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Rule", "[", 
              RowBox[{"#", ",", "#"}], "]"}], ",", "1"}], "}"}], "&"}], "/@", 
          "vars"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vars", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", "[", "Global`t", "]"}], "&"}], ")"}], "/@", 
          "vars"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"dbgArrows", ",", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<parseArrowForm: vars: \>\"", ",", " ", "vars"}], 
           "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        
        RowBox[{"nvars", "=", 
         RowBox[{"Length", "[", "vars", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"dbgArrows", ",", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<parseArrowForm: nvars: \>\"", ",", " ", "nvars"}], 
           "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        
        RowBox[{"Tall", "=", 
         RowBox[{
          RowBox[{"{", "T", "}"}], "//", "Flatten"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Tlast", "=", 
         RowBox[{"Last", "[", "Tall", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "Tall", "]"}], "<", "nvars"}], ",", " ", 
          RowBox[{"Tall", "=", 
           RowBox[{"PadRight", "[", 
            RowBox[{"Tall", ",", "nvars", ",", "Tlast"}], "]"}]}]}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "Tall", "]"}], ">", "nvars"}], ",", " ", 
          RowBox[{"Tall", "=", 
           RowBox[{"Take", "[", 
            RowBox[{"Tall", ",", "nvars"}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"dbgArrows", ",", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<parseArrowForm: Tall=\>\"", ",", "Tall"}], "]"}]}], 
         "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"nall", "=", 
         RowBox[{
          RowBox[{"{", "n", "}"}], "//", "Flatten"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nLast", "=", 
         RowBox[{"Last", "[", "nall", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "nall", "]"}], "<", "nvars"}], ",", " ", 
          RowBox[{"nall", "=", 
           RowBox[{"PadRight", "[", 
            RowBox[{"nall", ",", "nvars", ",", "nLast"}], "]"}]}]}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "nall", "]"}], ">", "nvars"}], ",", " ", 
          RowBox[{"nall", "=", 
           RowBox[{"Take", "[", 
            RowBox[{"nall", ",", "nvars"}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"dbgArrows", ",", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<parseArrowForm: nall=\>\"", ",", "nall"}], "]"}]}], 
         "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"hused", "=", 
         RowBox[{
          RowBox[{"{", "h", "}"}], "//", "Flatten"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "hused", "]"}], ">", "0"}], ",", " ", 
          RowBox[{"hused", "=", 
           RowBox[{"First", "[", "hused", "]"}]}], ",", " ", 
          RowBox[{"hused", "=", "0"}]}], "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"rused", "=", 
         RowBox[{
          RowBox[{"{", "r", "}"}], "//", "Flatten"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "rused", "]"}], ">", "0"}], ",", " ", 
          RowBox[{"rused", "=", 
           RowBox[{"First", "[", "rused", "]"}]}], ",", 
          RowBox[{"rused", "=", "1"}]}], "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"x", " ", "=", " ", 
         RowBox[{"hused", "+", 
          RowBox[{"Tall", ".", 
           RowBox[{"(", 
            RowBox[{"vars", "^", "nall"}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"rateLaw", "=", 
         RowBox[{"rused", "*", 
          RowBox[{"f", "[", "x", "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"rateLaw", "=", 
         RowBox[{"rateLaw", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Global`\[EmptySet]", "[", "Global`t", "]"}], "\[Rule]", 
            " ", "0"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"dummy", "=", 
         RowBox[{"Join", "@@", 
          RowBox[{"(", 
           RowBox[{"parseArrowForm", "/@", "dummy"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"odes", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Y", "[", "Global`t", "]"}], ",", " ", "rateLaw"}], "}"}],
           "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"odes", " ", "=", " ", 
         RowBox[{"Join", "@@", 
          RowBox[{"{", 
           RowBox[{"odes", ",", "dummy"}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "odes", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"parseArrowForm", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"RightTeeArrow", "[", 
         RowBox[{"X_", ",", "Y_"}], " ", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"user_", "[", "z___", "]"}], "}"}]}], "}"}], "]"}], ":=", 
     " ", 
     RowBox[{"parseArrowForm", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"RightTeeArrow", "[", 
         RowBox[{"X", ",", "Y"}], "]"}], ",", 
        RowBox[{"user", "[", "z", "]"}]}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.401033807185656*^9, 3.401033807738694*^9}, {
  3.551639662897888*^9, 3.551639664065188*^9}, {3.551639781156342*^9, 
  3.551639859576932*^9}, {3.551639893593918*^9, 3.5516399133432083`*^9}, {
  3.551639961054167*^9, 3.5516399629799213`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
A \[Implies]B : User defined stoichiometric reactions \
\>", "Subsection",
 CellDingbat->None,
 Background->RGBColor[1, 0.983139, 0.832074]],

Cell[CellGroupData[{

Cell["\<\
expandArrows: A\[Implies]B  (\\[ DoubleRightArrow ], user defined)\
\>", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"expandArrows", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"substrateExpression_", "\[Implies]", "productExpression_"}], 
     " ", ",", 
     RowBox[{"rate___", ":", "1"}]}], "}"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"reaction", ",", " ", "k"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"reaction", " ", "=", 
      RowBox[{"substrateExpression", "\[Implies]", "productExpression"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"dbgArrows", ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<expandArrows:\>\"", ",", " ", "reaction"}], "]"}]}], 
      "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"k", "=", 
      RowBox[{
       RowBox[{"{", "rate", "}"}], "//", "Flatten"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "k", "]"}], "<", "1"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"k", "=", "1"}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "k", "]"}], ">", "1"}], ",", " ", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<Warning: Extra rate constants \>\"", ",", " ", 
            RowBox[{"Drop", "[", 
             RowBox[{"k", ",", "1"}], "]"}], ",", "\"\< in the reaction \>\"",
             ",", " ", "reaction", ",", " ", "\"\< will be ignored.\>\""}], 
           "]"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"First", "[", "k", "]"}]}]}]}], "\[IndentingNewLine]", "]"}],
      ";", " ", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"reaction", ",", "k"}], "}"}], "}"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["parseArrowForm: A\[Implies]B  ", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"parseArrowForm", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"substrateExpression_", "\[Implies]", "productExpression_"}], 
     " ", ",", 
     RowBox[{"rate___", ":", "1"}]}], "}"}], "]"}], ":=", " ", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "parseExpression", ",", " ", "reaction", ",", " ", "input", ",", " ", 
      "output", ",", " ", "klaw", ",", "species", ",", " ", "nspecies", ",", 
      " ", 
      RowBox[{"dbg", "=", "False"}], ",", " ", "netStoichiometry", ",", " ", 
      "rates", ",", "odes", ",", " ", "k"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"reaction", " ", "=", " ", 
      RowBox[{"substrateExpression", "\[Implies]", "productExpression"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"dbgArrows", ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<parseArrowForm:\>\"", ",", " ", "reaction"}], "]"}]}], 
      "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"reaction", ",", "k"}], "}"}], "=", 
      RowBox[{
       RowBox[{"expandArrows", "[", 
        RowBox[{"{", 
         RowBox[{"reaction", ",", "rate"}], "}"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"input", "=", 
      RowBox[{
       StyleBox["parseReactants",
        FontColor->RGBColor[0, 0, 1]], "[", 
       RowBox[{"True", ",", "substrateExpression"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{
       StyleBox["parseReactants",
        FontColor->RGBColor[0, 0, 1]], "[", 
       RowBox[{"True", ",", " ", "productExpression"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"klaw", "=", "k"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       StyleBox["netStoichiometry",
        FontColor->RGBColor[0, 0, 1]], "[", "x_", "]"}], ":=", " ", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"in", ",", "out"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"in", " ", "=", " ", 
          RowBox[{"Cases", "[", 
           RowBox[{"input", ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "_"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "in", "]"}], "<", "1"}], ",", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"in", " ", "=", " ", "0"}], ",", " ", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"in", " ", "=", " ", 
             RowBox[{"Transpose", "[", "in", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"in", "=", 
             RowBox[{"Plus", "@@", 
              RowBox[{"in", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"out", "=", 
          RowBox[{"Cases", "[", 
           RowBox[{"output", ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "_"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "out", "]"}], "<", "1"}], ",", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"out", " ", "=", " ", "0"}], ",", " ", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"out", " ", "=", " ", 
             RowBox[{"Transpose", "[", "out", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"out", "=", 
             RowBox[{"Plus", "@@", 
              RowBox[{"out", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"out", "-", "in"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "]"}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"end", " ", 
       StyleBox["netStoichiometry",
        FontColor->RGBColor[0, 0, 1]]}], 
      StyleBox[" ",
       FontColor->RGBColor[0, 0, 1]], "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"species", "=", 
      RowBox[{"Union", "[", 
       RowBox[{
        RowBox[{"First", "/@", "input"}], ",", " ", 
        RowBox[{"First", "/@", "output"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"rates", "=", 
      RowBox[{"klaw", "*", 
       RowBox[{"netStoichiometry", "/@", "species"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"dbg", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<input stoichiometry:\>\"", ",", "input"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<klaw=\>\"", ",", "klaw"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<output stoichiometry:\>\"", ",", "output"}], "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<species:\>\"", ",", " ", "species"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<rates:\>\"", ",", "rates"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"odes", " ", "=", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"species", ",", "rates"}], "}"}], "//", "Transpose"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "odes", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Unknown forms", "Subsection",
 CellDingbat->None,
 Background->RGBColor[1, 0.983139, 0.832074]],

Cell[CellGroupData[{

Cell["expandArrows: unknown form", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"expandArrows", "[", "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<expandArrows: A reaction must be given as an argument. \>\"", 
       "]"}], ";", 
      RowBox[{"Return", "[", 
       RowBox[{"{", "}"}], "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expandArrows", "[", "x___", "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<expandArrows: Unable to identify the reactions: \>\"", ",", "x"}],
        "]"}], ";", 
      RowBox[{"Return", "[", "x", "]"}]}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["parseArrowForm: unknown form", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"parseArrowForm", "[", "x___", "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<parseArrowForm: Unable to identify the reactions: \>\"", ",", 
        "x"}], "]"}], ";", 
      RowBox[{"Return", "[", 
       RowBox[{"{", "}"}], "]"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["rateLaw [reaction, variable]", "Subsection"],

Cell["\<\
ratelaw[{arrow expression, rate constants}, variable] returns the formula for \
the given variable due to the specified rate arrow expression.
Must be a low level reaction: only should be applied to a reaction from a \
system that has been pre-processed by expandArrows.\
\>", "Text"],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{"rateLaw", "[", 
    RowBox[{"reaction_", ",", " ", "variable_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"odeterms", ",", "term"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"odeterms", "=", 
       RowBox[{"parseArrowForm", "[", "reaction", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"term", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"odeterms", ",", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{
            RowBox[{"First", "[", "#", "]"}], ",", 
            RowBox[{"variable", "[", "Global`t", "]"}]}], "]"}], "&"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "term", "]"}], "<", "1"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Error: rateLaw: unknown reaction or variable not present in \
reaction: \>\"", ",", "reaction", ",", "\"\< variable: \>\"", ",", 
           "variable"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "0", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "term", "]"}], ">", "1"}], ",", " ", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Possible program error: multiple rate laws for same \
variable.\>\"", ",", " ", "\"\<reaction=\>\"", ",", "reaction", ",", 
           "\"\< variable=\>\"", ",", "variable", ",", "\"\< odeterms=\>\"", 
           ",", "odeterms", ",", "\"\< term=\>\"", ",", "term"}], "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"term", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}], " "}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"rateLaw", "[", "x___", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", 
    RowBox[{
     RowBox[{
     "Print", "[", 
      "\"\<rateLaw: invalid arguments: should be rateLaw[reaction,variable]\>\
\"", "]"}], ";", 
     RowBox[{"Return", "[", "0", "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["TextArrow", "Section",
 CellChangeTimes->{{3.587505349336526*^9, 3.587505353014201*^9}}],

Cell["\<\
TextArrow converts a Cellerator Arrow to a pyxlr8r arrow in text form.
Normal use: TextArrow[arrow] or TextArrow/@model, where model={arrow, arrow, \
arrow,...}\
\>", "Text",
 CellChangeTimes->{{3.58759406189874*^9, 3.5875941034424334`*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 "Mass Action Arrow (3.5.1, 3.5.2)  ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        TagBox[
         RowBox[{"e1", " ", "X1"}],
         DisplayForm], "+", 
        RowBox[{"e2", " ", "X2"}], " ", "+"}], "  ", "..."}], " ", 
      "\[ShortRightArrow]", 
      TagBox[
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"f1", "*", "Y1"}], " ", "+", " ", 
          RowBox[{"f2", "*", "Y2"}], " ", "+"}], " ", "..."}], " "}],
       DisplayForm]}], ",", 
     TagBox["k",
      DisplayForm]}], "}"}], TraditionalForm]],
  FormatType->"TraditionalForm"]
}], "Subsubsection",
 CellChangeTimes->{{3.5875075252085247`*^9, 3.58750754007198*^9}, {
  3.587509645513989*^9, 3.587509681354682*^9}, {3.587509718684082*^9, 
  3.587509734019621*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Headerize", "[", 
     RowBox[{"header_", ",", " ", "X__"}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"ToString", "[", "header", "]"}], "<>", "\"\<[\>\"", "<>", 
     RowBox[{"StringReplace", "[", 
      RowBox[{
       RowBox[{"ToString", "[", 
        RowBox[{"{", "X", "}"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<{\>\"", "\[Rule]", " ", "\"\<\>\""}], ",", " ", 
         RowBox[{"\"\<}\>\"", "\[Rule]", " ", "\"\<\>\""}]}], "}"}]}], "]"}], 
     "<>", "\"\<]\>\""}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"B2P", "[", 
     RowBox[{"X_", "?", "StringQ"}], "]"}], ":=", " ", 
    RowBox[{"StringReplace", "[", 
     RowBox[{"X", ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<]\>\"", "\[Rule]", " ", "\"\<)\>\""}], ",", " ", 
        RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<(\>\""}]}], "}"}]}], "]"}]}], 
   ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"B2P", "[", "X_", "]"}], ":=", " ", 
    RowBox[{"B2P", "[", 
     RowBox[{"ToString", "[", "X", "]"}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"L2B", "[", 
    RowBox[{"X_", "?", "StringQ"}], "]"}], ":=", " ", 
   RowBox[{"StringReplace", "[", 
    RowBox[{"X", ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<}\>\"", "\[Rule]", " ", "\"\<]\>\""}], ",", " ", 
       RowBox[{"\"\<{\>\"", "\[Rule]", "\"\<[\>\""}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"L2B", "[", "X_", "]"}], ":=", " ", 
    RowBox[{"L2B", "[", 
     RowBox[{"ToString", "[", "X", "]"}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IndexTypeQ", "[", "u_Integer", "]"}], ":=", " ", "True"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IndexTypeQ", "[", "u_Symbol", "]"}], ":=", " ", "True"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IndexTypeQ", "[", "u_", "]"}], ":=", " ", "False"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StoicTerm", "[", "X_Symbol", "]"}], ":=", " ", "True"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StoicTerm", "[", 
    RowBox[{"X_Symbol", "[", 
     RowBox[{"index__", "?", "IndexTypeQ"}], "]"}], "]"}], ":=", " ", 
   "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StoicTerm", "[", 
    RowBox[{"Times", "[", 
     RowBox[{
      RowBox[{"m_", "?", "NumericQ"}], ",", " ", "X_Symbol"}], "]"}], "]"}], ":=",
    "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"StoicTerm", "[", "XYZ___", "]"}], ":=", " ", "False"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"StoicExpression", "[", 
     RowBox[{"U_", "?", "StoicTerm"}], "]"}], ":=", " ", "True"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StoicExpression", "[", 
    RowBox[{
     RowBox[{"X_", "?", "StoicTerm"}], " ", "+", " ", 
     RowBox[{"Y_", "?", "StoicExpression"}]}], "]"}], ":=", " ", "True"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"StoicExpression", "[", "XYZ___", "]"}], ":=", " ", "False"}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TextArrow", "[", 
     RowBox[{"{", 
      RowBox[{"ShortRightArrow", "[", 
       RowBox[{
        RowBox[{"X_", "?", "StoicExpression"}], ",", 
        RowBox[{"Y_", "?", "StoicExpression"}]}], " ", "]"}], "}"}], "]"}], ":=",
     " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "rules", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rules", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<(\>\""}], ",", 
          RowBox[{"\"\<]\>\"", "\[Rule]", "\"\<)\>\""}], ",", " ", 
          RowBox[{"\"\<{\>\"", "\[Rule]", " ", "\"\<[\>\""}], ",", " ", 
          RowBox[{"\"\<}\>\"", "\[Rule]", " ", "\"\<]\>\""}], ",", " ", 
          RowBox[{
          "\"\<\[ShortRightArrow]\>\"", "\[Rule]", " ", "\"\<->\>\""}], ",", 
          " ", 
          RowBox[{"\"\< \>\"", "\[Rule]", " ", "\"\<\>\""}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"StringReplace", "[", 
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{"{", 
           RowBox[{
            TagBox["X",
             DisplayForm], "\[ShortRightArrow]", 
            TagBox["Y",
             DisplayForm]}], "}"}], "]"}], ",", "rules"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TextArrow", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ShortRightArrow", "[", 
       RowBox[{
        RowBox[{"X_", "?", "StoicExpression"}], ",", 
        RowBox[{"Y_", "?", "StoicExpression"}]}], " ", "]"}], ",", " ", 
      "k_"}], "}"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "rules", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rules", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<(\>\""}], ",", 
         RowBox[{"\"\<]\>\"", "\[Rule]", "\"\<)\>\""}], ",", 
         RowBox[{"\"\<{\>\"", "\[Rule]", " ", "\"\<[\>\""}], ",", " ", 
         RowBox[{"\"\<}\>\"", "\[Rule]", " ", "\"\<]\>\""}], ",", " ", 
         RowBox[{"\"\<\[ShortRightArrow]\>\"", "\[Rule]", " ", "\"\<->\>\""}],
          ",", " ", 
         RowBox[{"\"\< \>\"", "\[Rule]", " ", "\"\<\>\""}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            TagBox["X",
             DisplayForm], "\[ShortRightArrow]", 
            TagBox["Y",
             DisplayForm]}], ",", "k"}], "}"}], "]"}], ",", "rules"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TextArrow", "[", 
     RowBox[{"{", 
      RowBox[{"Rule", "[", 
       RowBox[{
        RowBox[{"X_", "?", "StoicExpression"}], ",", 
        RowBox[{"Y_", "?", "StoicExpression"}]}], " ", "]"}], "}"}], "]"}], ":=",
     " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "rules", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rules", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<(\>\""}], ",", 
          RowBox[{"\"\<]\>\"", "\[Rule]", "\"\<)\>\""}], ",", 
          RowBox[{"\"\<{\>\"", "\[Rule]", " ", "\"\<[\>\""}], ",", " ", 
          RowBox[{"\"\<}\>\"", "\[Rule]", " ", "\"\<]\>\""}], ",", " ", 
          RowBox[{"\"\<\[Rule]\>\"", "\[Rule]", " ", "\"\<->\>\""}], ",", " ", 
          RowBox[{"\"\< \>\"", "\[Rule]", " ", "\"\<\>\""}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"StringReplace", "[", 
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{"{", 
           RowBox[{
            TagBox["X",
             DisplayForm], "\[Rule]", 
            TagBox["Y",
             DisplayForm]}], "}"}], "]"}], ",", "rules"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TextArrow", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Rule", "[", 
       RowBox[{
        RowBox[{"X_", "?", "StoicExpression"}], ",", 
        RowBox[{"Y_", "?", "StoicExpression"}]}], " ", "]"}], ",", " ", 
      "k_"}], "}"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "rules", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rules", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<(\>\""}], ",", 
         RowBox[{"\"\<]\>\"", "\[Rule]", "\"\<)\>\""}], ",", 
         RowBox[{"\"\<{\>\"", "\[Rule]", " ", "\"\<[\>\""}], ",", " ", 
         RowBox[{"\"\<}\>\"", "\[Rule]", " ", "\"\<]\>\""}], ",", " ", 
         RowBox[{"\"\<\[Rule]\>\"", "\[Rule]", " ", "\"\<->\>\""}], ",", " ", 
         
         RowBox[{"\"\< \>\"", "\[Rule]", " ", "\"\<\>\""}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            TagBox["X",
             DisplayForm], "\[Rule]", 
            TagBox["Y",
             DisplayForm]}], ",", "k"}], "}"}], "]"}], ",", "rules"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.587505417309799*^9, 3.5875055868167343`*^9}, {
   3.5875057055283813`*^9, 3.587505761554891*^9}, {3.587505806411099*^9, 
   3.587505817837113*^9}, {3.5875059652203817`*^9, 3.587506003244109*^9}, {
   3.587506035588526*^9, 3.58750607924413*^9}, {3.587506115988551*^9, 
   3.587506159200684*^9}, {3.587506191307398*^9, 3.587506283943343*^9}, {
   3.587506354197289*^9, 3.587506406194132*^9}, {3.5875064929561167`*^9, 
   3.587506515240959*^9}, {3.5875066137643013`*^9, 3.5875066286782007`*^9}, {
   3.587506893377728*^9, 3.587506908115327*^9}, {3.587506956281166*^9, 
   3.587506978205936*^9}, {3.587507025757042*^9, 3.587507127138254*^9}, {
   3.587507293658959*^9, 3.587507297313209*^9}, {3.5875074165564747`*^9, 
   3.5875074215438843`*^9}, {3.5875074849210873`*^9, 
   3.5875074851601686`*^9}, {3.587507515512506*^9, 3.5875075166078367`*^9}, {
   3.587507627083153*^9, 3.587507683392733*^9}, {3.587508774438678*^9, 
   3.5875088568887997`*^9}, 3.58750899540091*^9, {3.587510075551819*^9, 
   3.587510125901848*^9}, {3.587510222974041*^9, 3.587510303105981*^9}, {
   3.5875474475375443`*^9, 3.5875475608996983`*^9}, {3.587548840343486*^9, 
   3.587548975985909*^9}, {3.587586314039239*^9, 3.587586409120062*^9}, {
   3.6026221628157578`*^9, 3.6026222785620537`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Catalyzed Mass Action (3.5.3) ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     OverscriptBox[
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"n1", " ", "*", " ", "S1"}], "+", 
         RowBox[{"n2", "*", "S2"}], "+"}], "..."}], "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"m1", "*", "P1"}], "+", 
         RowBox[{"m2", " ", "P2"}], "+"}], "..."}]}], "Z"], ",", 
     TagBox["k",
      DisplayForm]}], "}"}], TraditionalForm]],
  FormatType->"TraditionalForm"]
}], "Subsubsection",
 CellChangeTimes->{{3.5875075746322317`*^9, 3.5875075779124613`*^9}, {
  3.5875077090159616`*^9, 3.58750771055914*^9}, {3.587509656664502*^9, 
  3.587509714830043*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TextArrow", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Overscript", "[", 
        RowBox[{
         RowBox[{"ShortRightArrow", "[", 
          RowBox[{
           RowBox[{"X_", "?", "StoicExpression"}], ",", 
           RowBox[{"Y_", "?", "StoicExpression"}]}], " ", "]"}], ",", "Z_"}], 
        "]"}], ",", " ", "k_"}], "}"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "rules", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rules", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<(\>\""}], ",", 
          RowBox[{"\"\<]\>\"", "\[Rule]", "\"\<)\>\""}], ",", 
          RowBox[{"\"\<{\>\"", "\[Rule]", " ", "\"\<[\>\""}], ",", " ", 
          RowBox[{"\"\<}\>\"", "\[Rule]", " ", "\"\<]\>\""}], ",", " ", 
          RowBox[{"\"\<\[Rule]\>\"", "\[Rule]", " ", "\"\<-->\>\""}], ",", 
          " ", 
          RowBox[{"\"\<->\>\"", "\[Rule]", " ", "\"\<-->\>\""}], ",", 
          RowBox[{"\"\< \>\"", "\[Rule]", " ", "\"\<\>\""}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"StringReplace", "[", 
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"B2P", "[", 
             RowBox[{
              TagBox["X",
               DisplayForm], "\[Rule]", 
              TagBox["Y",
               DisplayForm]}], "]"}], ",", 
            RowBox[{"Headerize", "[", 
             RowBox[{"\"\<mod\>\"", ",", 
              RowBox[{"B2P", "[", "Z", "]"}]}], "]"}], ",", " ", "k"}], "}"}],
           "]"}], ",", "rules"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TextArrow", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Overscript", "[", 
       RowBox[{
        RowBox[{"Rule", "[", 
         RowBox[{
          RowBox[{"X_", "?", "StoicExpression"}], ",", 
          RowBox[{"Y_", "?", "StoicExpression"}]}], " ", "]"}], ",", "Z_"}], 
       "]"}], ",", " ", "k_"}], "}"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "rules", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", "\"\<bleh\>\"", "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"rules", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<(\>\""}], ",", 
         RowBox[{"\"\<]\>\"", "\[Rule]", "\"\<)\>\""}], ",", 
         RowBox[{"\"\<{\>\"", "\[Rule]", " ", "\"\<[\>\""}], ",", " ", 
         RowBox[{"\"\<}\>\"", "\[Rule]", " ", "\"\<]\>\""}], ",", " ", 
         RowBox[{"\"\<\[Rule]\>\"", "\[Rule]", " ", "\"\<-->\>\""}], ",", " ", 
         RowBox[{"\"\<->\>\"", "\[Rule]", " ", "\"\<-->\>\""}], ",", "  ", 
         RowBox[{"\"\< \>\"", "\[Rule]", " ", "\"\<\>\""}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"B2P", "[", 
            RowBox[{
             TagBox["X",
              DisplayForm], "\[Rule]", 
             TagBox["Y",
              DisplayForm]}], "]"}], ",", 
           RowBox[{"Headerize", "[", 
            RowBox[{"\"\<mod\>\"", ",", 
             RowBox[{"B2P", "[", "Z", "]"}]}], "]"}], ",", " ", "k"}], "}"}], 
         "]"}], ",", "rules"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TextArrow", "[", 
     RowBox[{"{", 
      RowBox[{"Overscript", "[", 
       RowBox[{
        RowBox[{"ShortRightArrow", "[", 
         RowBox[{
          RowBox[{"X_", "?", "StoicExpression"}], ",", 
          RowBox[{"Y_", "?", "StoicExpression"}]}], " ", "]"}], ",", "Z_"}], 
       "]"}], "}"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "rules", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rules", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<(\>\""}], ",", 
          RowBox[{"\"\<]\>\"", "\[Rule]", "\"\<)\>\""}], ",", 
          RowBox[{"\"\<{\>\"", "\[Rule]", " ", "\"\<[\>\""}], ",", " ", 
          RowBox[{"\"\<}\>\"", "\[Rule]", " ", "\"\<]\>\""}], ",", " ", 
          RowBox[{"\"\<\[Rule]\>\"", "\[Rule]", " ", "\"\<-->\>\""}], ",", 
          RowBox[{"\"\<->\>\"", "\[Rule]", " ", "\"\<-->\>\""}], ",", " ", 
          RowBox[{"\"\< \>\"", "\[Rule]", " ", "\"\<\>\""}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"StringReplace", "[", 
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             TagBox["X",
              DisplayForm], "\[Rule]", " ", 
             TagBox["Y",
              DisplayForm]}], ",", 
            RowBox[{"Headerize", "[", 
             RowBox[{"\"\<mod\>\"", ",", 
              RowBox[{"B2P", "[", "Z", "]"}]}], "]"}]}], "}"}], "]"}], ",", 
         "rules"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TextArrow", "[", 
    RowBox[{"{", 
     RowBox[{"Overscript", "[", 
      RowBox[{
       RowBox[{"Rule", "[", 
        RowBox[{
         RowBox[{"X_", "?", "StoicExpression"}], ",", 
         RowBox[{"Y_", "?", "StoicExpression"}]}], " ", "]"}], ",", "Z_"}], 
      "]"}], "}"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "rules", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rules", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<(\>\""}], ",", 
         RowBox[{"\"\<]\>\"", "\[Rule]", "\"\<)\>\""}], ",", 
         RowBox[{"\"\<{\>\"", "\[Rule]", " ", "\"\<[\>\""}], ",", " ", 
         RowBox[{"\"\<}\>\"", "\[Rule]", " ", "\"\<]\>\""}], ",", " ", 
         RowBox[{"\"\<\[Rule]\>\"", "\[Rule]", " ", "\"\<-->\>\""}], ",", 
         RowBox[{"\"\<->\>\"", "\[Rule]", " ", "\"\<-->\>\""}], ",", " ", 
         RowBox[{"\"\< \>\"", "\[Rule]", " ", "\"\<\>\""}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            TagBox["X",
             DisplayForm], "\[Rule]", 
            TagBox["Y",
             DisplayForm]}], ",", 
           RowBox[{"Headerize", "[", 
            RowBox[{"\"\<mod\>\"", ",", 
             RowBox[{"B2P", "[", "Z", "]"}]}], "]"}]}], "}"}], "]"}], ",", 
        "rules"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.587507714226523*^9, 3.5875077226020317`*^9}, {
  3.587507784586721*^9, 3.5875078043202744`*^9}, {3.5875078846895733`*^9, 
  3.587507888743061*^9}, {3.587508399183476*^9, 3.58750841560165*^9}, {
  3.587508455608554*^9, 3.5875084568478117`*^9}, {3.587508491616335*^9, 
  3.587508589184176*^9}, {3.58750867130416*^9, 3.5875087059110203`*^9}, {
  3.587508747640214*^9, 3.5875087602553988`*^9}, {3.587508867579138*^9, 
  3.587508874374941*^9}, {3.5875090327445307`*^9, 3.587509185491514*^9}, {
  3.587509312149832*^9, 3.587509352907336*^9}, {3.587509508206745*^9, 
  3.5875095120390368`*^9}, {3.587509555364333*^9, 3.587509597507422*^9}, {
  3.587549198002507*^9, 3.587549209266114*^9}, {3.587549242418528*^9, 
  3.587549275008647*^9}, {3.6026223867331142`*^9, 3.6026223959644833`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Reversible Mass Action (3.5.4) ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"e1", " ", "X1"}], " ", "+", " ", 
        RowBox[{"e2", " ", "X2"}], " ", "+"}], " ", "..."}], " ", 
      "\[RightArrowLeftArrow]", 
      TagBox[
       RowBox[{
        RowBox[{
         RowBox[{"f1", " ", "X1"}], " ", "+", " ", 
         RowBox[{"f2", " ", "X2"}], " ", "+"}], " ", "..."}],
       DisplayForm]}], ",", "kf", " ", ",", 
     TagBox["kr",
      DisplayForm]}], "}"}], TraditionalForm]],
  FormatType->"TraditionalForm"]
}], "Subsubsection",
 CellChangeTimes->{{3.5875097485456877`*^9, 3.587509801600341*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TextArrow", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RightArrowLeftArrow", "[", 
       RowBox[{
        RowBox[{"X_", "?", "StoicExpression"}], ",", " ", 
        RowBox[{"Y_", "?", "StoicExpression"}]}], "]"}], ",", "k__"}], "}"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "rules", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rules", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<(\>\""}], ",", 
         RowBox[{"\"\<]\>\"", "\[Rule]", "\"\<)\>\""}], ",", 
         RowBox[{"\"\<{\>\"", "\[Rule]", " ", "\"\<[\>\""}], ",", " ", 
         RowBox[{"\"\<}\>\"", "\[Rule]", " ", "\"\<]\>\""}], ",", " ", 
         RowBox[{"\"\<\[Rule]\>\"", "\[Rule]", " ", "\"\<<->\>\""}], ",", 
         RowBox[{"\"\<->\>\"", "\[Rule]", " ", "\"\<<->\>\""}], ",", " ", 
         RowBox[{"\"\< \>\"", "\[Rule]", " ", "\"\<\>\""}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"B2P", "[", 
            RowBox[{
             TagBox["X",
              DisplayForm], "\[Rule]", 
             TagBox["Y",
              DisplayForm]}], "]"}], ",", 
           RowBox[{"Headerize", "[", 
            RowBox[{"\"\<rates\>\"", ",", "k"}], "]"}]}], "}"}], "]"}], ",", 
        "rules"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TextArrow", "[", 
     RowBox[{"{", 
      RowBox[{"RightArrowLeftArrow", "[", 
       RowBox[{
        RowBox[{"X_", "?", "StoicExpression"}], ",", " ", 
        RowBox[{"Y_", "?", "StoicExpression"}]}], "]"}], "}"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "rules", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rules", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<(\>\""}], ",", 
          RowBox[{"\"\<]\>\"", "\[Rule]", "\"\<)\>\""}], ",", 
          RowBox[{"\"\<{\>\"", "\[Rule]", " ", "\"\<[\>\""}], ",", " ", 
          RowBox[{"\"\<}\>\"", "\[Rule]", " ", "\"\<]\>\""}], ",", " ", 
          RowBox[{"\"\<\[Rule]\>\"", "\[Rule]", " ", "\"\<<->\>\""}], ",", 
          RowBox[{"\"\<->\>\"", "\[Rule]", " ", "\"\<<->\>\""}], ",", " ", 
          RowBox[{"\"\< \>\"", "\[Rule]", " ", "\"\<\>\""}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"StringReplace", "[", 
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{"{", 
           RowBox[{"B2P", "[", 
            RowBox[{
             TagBox["X",
              DisplayForm], "\[Rule]", 
             TagBox["Y",
              DisplayForm]}], "]"}], "}"}], "]"}], ",", "rules"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], " ", " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.587509805646847*^9, 3.5875098073149443`*^9}, {
   3.587509856401267*^9, 3.587509985319394*^9}, 3.587510029238574*^9, {
   3.587510358500568*^9, 3.587510377430928*^9}, {3.587549178850535*^9, 
   3.587549191960903*^9}, {3.60262240121423*^9, 3.6026224042050753`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Catalyzed Mass Action, Intermediate Substrate/Catalyst Complex (3.5.5)\
\>", "Subsubsection",
 CellChangeTimes->{{3.587547265788661*^9, 3.587547283460442*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TextArrow", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Overscript", "[", 
       RowBox[{
        RowBox[{"RightArrowLeftArrow", "[", 
         RowBox[{"X_", ",", " ", "Y_"}], "]"}], ",", "Z_"}], "]"}], ",", 
      "k__"}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "rules", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rules", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<(\>\""}], ",", 
         RowBox[{"\"\<]\>\"", "\[Rule]", "\"\<)\>\""}], ",", 
         RowBox[{"\"\<{\>\"", "\[Rule]", " ", "\"\<[\>\""}], ",", " ", 
         RowBox[{"\"\<}\>\"", "\[Rule]", " ", "\"\<]\>\""}], ",", " ", 
         RowBox[{"\"\<\[Rule]\>\"", "\[Rule]", " ", "\"\<=>\>\""}], ",", 
         RowBox[{"\"\<->\>\"", "\[Rule]", " ", "\"\<=>\>\""}], ",", " ", 
         RowBox[{"\"\< \>\"", "\[Rule]", " ", "\"\<\>\""}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"B2P", "[", 
            RowBox[{
             TagBox["X",
              DisplayForm], "\[Rule]", 
             TagBox["Y",
              DisplayForm]}], "]"}], ",", " ", 
           RowBox[{"Headerize", "[", 
            RowBox[{"\"\<mod\>\"", ",", 
             RowBox[{"B2P", "[", "Z", "]"}]}], "]"}], ",", " ", 
           RowBox[{"Headerize", "[", 
            RowBox[{"\"\<rates\>\"", ",", "k"}], "]"}]}], "}"}], "]"}], ",", 
        "rules"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TextArrow", "[", 
    RowBox[{"{", 
     RowBox[{"Overscript", "[", 
      RowBox[{
       RowBox[{"RightArrowLeftArrow", "[", 
        RowBox[{"X_", ",", " ", "Y_"}], "]"}], ",", "Z_"}], "]"}], "}"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "rules", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rules", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<(\>\""}], ",", 
         RowBox[{"\"\<]\>\"", "\[Rule]", "\"\<)\>\""}], ",", 
         RowBox[{"\"\<{\>\"", "\[Rule]", " ", "\"\<[\>\""}], ",", " ", 
         RowBox[{"\"\<}\>\"", "\[Rule]", " ", "\"\<]\>\""}], ",", " ", 
         RowBox[{"\"\<\[Rule]\>\"", "\[Rule]", " ", "\"\<=>\>\""}], ",", 
         RowBox[{"\"\<->\>\"", "\[Rule]", " ", "\"\<=>\>\""}], ",", " ", 
         RowBox[{"\"\< \>\"", "\[Rule]", " ", "\"\<\>\""}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"B2P", "[", 
            RowBox[{
             TagBox["X",
              DisplayForm], "\[Rule]", 
             TagBox["Y",
              DisplayForm]}], "]"}], ",", " ", 
           RowBox[{"Headerize", "[", 
            RowBox[{"\"\<mod\>\"", ",", 
             RowBox[{"B2P", "[", "Z", "]"}]}], "]"}]}], "}"}], "]"}], ",", 
        "rules"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.587547312418995*^9, 3.587547335263193*^9}, {
  3.587547372538969*^9, 3.5875473912960243`*^9}, {3.587547633194059*^9, 
  3.587547689955179*^9}, {3.587547731501433*^9, 3.587547752916799*^9}, {
  3.5875491576287193`*^9, 3.587549173844573*^9}, {3.5875492881468697`*^9, 
  3.587549300563053*^9}, {3.602622411470901*^9, 3.602622414919838*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Catalyzed Mass Action, Int. Subs./Cat. Compl, Reversible (3.5.6)\
\>", "Subsubsection",
 CellChangeTimes->{{3.587547783361771*^9, 3.5875478016411037`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TextArrow", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Underoverscript", "[", 
       RowBox[{
        RowBox[{"RightArrowLeftArrow", "[", 
         RowBox[{"X_", ",", " ", "Y_"}], "]"}], ",", "Under_", ",", " ", 
        "Over_"}], "]"}], ",", "k__"}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "rules", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rules", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<(\>\""}], ",", 
         RowBox[{"\"\<]\>\"", "\[Rule]", "\"\<)\>\""}], ",", 
         RowBox[{"\"\<{\>\"", "\[Rule]", " ", "\"\<[\>\""}], ",", " ", 
         RowBox[{"\"\<}\>\"", "\[Rule]", " ", "\"\<]\>\""}], ",", " ", 
         RowBox[{"\"\<\[Rule]\>\"", "\[Rule]", " ", "\"\<<=>\>\""}], ",", 
         RowBox[{"\"\<->\>\"", "\[Rule]", " ", "\"\<<=>\>\""}], ",", " ", 
         RowBox[{"\"\< \>\"", "\[Rule]", " ", "\"\<\>\""}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"B2P", "[", 
            RowBox[{
             TagBox["X",
              DisplayForm], "\[Rule]", 
             TagBox["Y",
              DisplayForm]}], "]"}], ",", " ", 
           RowBox[{"Headerize", "[", 
            RowBox[{"\"\<mod\>\"", ",", 
             RowBox[{"B2P", "[", "Over", "]"}], ",", " ", 
             RowBox[{"B2P", "[", "Under", "]"}]}], "]"}], ",", " ", 
           RowBox[{"Headerize", "[", 
            RowBox[{"\"\<rates\>\"", ",", "k"}], "]"}]}], "}"}], "]"}], ",", 
        "rules"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TextArrow", "[", 
    RowBox[{"{", 
     RowBox[{"Underoverscript", "[", 
      RowBox[{
       RowBox[{"RightArrowLeftArrow", "[", 
        RowBox[{"X_", ",", " ", "Y_"}], "]"}], ",", "Under_", ",", "Over_"}], 
      "]"}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "rules", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rules", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<(\>\""}], ",", 
         RowBox[{"\"\<]\>\"", "\[Rule]", "\"\<)\>\""}], ",", 
         RowBox[{"\"\<{\>\"", "\[Rule]", " ", "\"\<[\>\""}], ",", " ", 
         RowBox[{"\"\<}\>\"", "\[Rule]", " ", "\"\<]\>\""}], ",", " ", 
         RowBox[{"\"\<\[Rule]\>\"", "\[Rule]", " ", "\"\<<=>\>\""}], ",", 
         RowBox[{"\"\<->\>\"", "\[Rule]", " ", "\"\<<=>\>\""}], ",", " ", 
         RowBox[{"\"\< \>\"", "\[Rule]", " ", "\"\<\>\""}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"B2P", "[", 
            RowBox[{
             TagBox["X",
              DisplayForm], "\[Rule]", 
             TagBox["Y",
              DisplayForm]}], "]"}], ",", " ", 
           RowBox[{"Headerize", "[", 
            RowBox[{"\"\<mod\>\"", ",", 
             RowBox[{"B2P", "[", "Over", "]"}], ",", " ", 
             RowBox[{"B2P", "[", "Under", "]"}]}], "]"}]}], "}"}], "]"}], ",",
         "rules"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.587547312418995*^9, 3.587547335263193*^9}, {
  3.587547372538969*^9, 3.5875473912960243`*^9}, {3.587547633194059*^9, 
  3.587547689955179*^9}, {3.587547731501433*^9, 3.587547752916799*^9}, {
  3.5875479204117117`*^9, 3.5875479869391403`*^9}, {3.58754803568108*^9, 
  3.587548045608302*^9}, {3.587549136643309*^9, 3.587549149948316*^9}, {
  3.58754930875593*^9, 3.5875493330613956`*^9}, {3.60262242184198*^9, 
  3.602622424953046*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Catalytic Mass Action, Int Subs/Cat & Int. Product./Catalyst Formatoin (3.5.7)\
\>", "Subsubsection",
 CellChangeTimes->{{3.587548113615348*^9, 3.5875481509899473`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TextArrow", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Overscript", "[", 
       RowBox[{
        RowBox[{"Equilibrium", "[", 
         RowBox[{"X_", ",", " ", "Y_"}], "]"}], ",", "Cat_"}], "]"}], ",", 
      "k__"}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "rules", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rules", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<(\>\""}], ",", 
         RowBox[{"\"\<]\>\"", "\[Rule]", "\"\<)\>\""}], ",", 
         RowBox[{"\"\<{\>\"", "\[Rule]", " ", "\"\<[\>\""}], ",", " ", 
         RowBox[{"\"\<}\>\"", "\[Rule]", " ", "\"\<]\>\""}], ",", " ", 
         RowBox[{"\"\<\[Rule]\>\"", "\[Rule]", " ", "\"\<:=>\>\""}], ",", 
         RowBox[{"\"\<->\>\"", "\[Rule]", " ", "\"\<:=>\>\""}], ",", " ", 
         RowBox[{"\"\< \>\"", "\[Rule]", " ", "\"\<\>\""}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"B2P", "[", 
            RowBox[{
             TagBox["X",
              DisplayForm], "\[Rule]", 
             TagBox["Y",
              DisplayForm]}], "]"}], ",", " ", 
           RowBox[{"Headerize", "[", 
            RowBox[{"\"\<mod\>\"", ",", 
             RowBox[{"B2P", "[", "Cat", "]"}]}], "]"}], ",", " ", 
           RowBox[{"Headerize", "[", 
            RowBox[{"\"\<rates\>\"", ",", "k"}], "]"}]}], "}"}], "]"}], ",", 
        "rules"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TextArrow", "[", 
    RowBox[{"{", 
     RowBox[{"Overscript", "[", 
      RowBox[{
       RowBox[{"Equilibrium", "[", 
        RowBox[{"X_", ",", " ", "Y_"}], "]"}], ",", "Cat_"}], "]"}], "}"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "rules", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rules", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<(\>\""}], ",", 
         RowBox[{"\"\<]\>\"", "\[Rule]", "\"\<)\>\""}], ",", 
         RowBox[{"\"\<{\>\"", "\[Rule]", " ", "\"\<[\>\""}], ",", " ", 
         RowBox[{"\"\<}\>\"", "\[Rule]", " ", "\"\<]\>\""}], ",", " ", 
         RowBox[{"\"\<\[Rule]\>\"", "\[Rule]", " ", "\"\<:=>\>\""}], ",", 
         RowBox[{"\"\<->\>\"", "\[Rule]", " ", "\"\<:=>\>\""}], ",", " ", 
         RowBox[{"\"\< \>\"", "\[Rule]", " ", "\"\<\>\""}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"B2P", "[", 
            RowBox[{
             TagBox["X",
              DisplayForm], "\[Rule]", 
             TagBox["Y",
              DisplayForm]}], "]"}], ",", " ", 
           RowBox[{"Headerize", "[", 
            RowBox[{"\"\<mod\>\"", ",", 
             RowBox[{"B2P", "[", "Cat", "]"}]}], "]"}]}], "}"}], "]"}], ",", 
        "rules"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.587547312418995*^9, 3.587547335263193*^9}, {
  3.587547372538969*^9, 3.5875473912960243`*^9}, {3.587547633194059*^9, 
  3.587547689955179*^9}, {3.587547731501433*^9, 3.587547752916799*^9}, {
  3.5875479204117117`*^9, 3.5875479869391403`*^9}, {3.58754803568108*^9, 
  3.587548045608302*^9}, {3.587548246436646*^9, 3.587548311488677*^9}, {
  3.5875491122643147`*^9, 3.587549126420423*^9}, {3.587549339858094*^9, 
  3.587549349552084*^9}, {3.602622432203162*^9, 3.602622438122758*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Michaelis-Menten-Henri Reactions (3.6.1)\
\>", "Subsubsection",
 CellChangeTimes->{{3.587548348893696*^9, 3.587548359557283*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TextArrow", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DoubleLongRightArrow", "[", 
       RowBox[{"X_", ",", " ", "Y_"}], "]"}], ",", 
      RowBox[{"MM", "[", "k__", "]"}]}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "rules", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rules", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<(\>\""}], ",", 
         RowBox[{"\"\<]\>\"", "\[Rule]", "\"\<)\>\""}], ",", 
         RowBox[{"\"\<{\>\"", "\[Rule]", " ", "\"\<[\>\""}], ",", " ", 
         RowBox[{"\"\<}\>\"", "\[Rule]", " ", "\"\<]\>\""}], ",", " ", 
         RowBox[{"\"\<\[Rule]\>\"", "\[Rule]", " ", "\"\<:->\>\""}], ",", 
         RowBox[{"\"\<->\>\"", "\[Rule]", " ", "\"\<:->\>\""}], ",", " ", 
         RowBox[{"\"\< \>\"", "\[Rule]", " ", "\"\<\>\""}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"B2P", "[", 
            RowBox[{
             TagBox["X",
              DisplayForm], "\[Rule]", 
             TagBox["Y",
              DisplayForm]}], "]"}], ",", "  ", 
           RowBox[{"Headerize", "[", 
            RowBox[{"\"\<MMH\>\"", ",", "k"}], "]"}]}], "}"}], "]"}], ",", 
        "rules"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TextArrow", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Overscript", "[", 
       RowBox[{
        RowBox[{"DoubleLongRightArrow", "[", 
         RowBox[{"X_", ",", " ", "Y_"}], "]"}], ",", "Cat_"}], "]"}], ",", 
      " ", 
      RowBox[{"MM", "[", "k__", "]"}]}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "rules", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rules", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<(\>\""}], ",", 
         RowBox[{"\"\<]\>\"", "\[Rule]", "\"\<)\>\""}], ",", 
         RowBox[{"\"\<{\>\"", "\[Rule]", " ", "\"\<[\>\""}], ",", " ", 
         RowBox[{"\"\<}\>\"", "\[Rule]", " ", "\"\<]\>\""}], ",", " ", 
         RowBox[{"\"\<\[Rule]\>\"", "\[Rule]", " ", "\"\<:->\>\""}], ",", 
         RowBox[{"\"\<->\>\"", "\[Rule]", " ", "\"\<:->\>\""}], ",", " ", 
         RowBox[{"\"\< \>\"", "\[Rule]", " ", "\"\<\>\""}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"B2P", "[", 
            RowBox[{
             TagBox["X",
              DisplayForm], "\[Rule]", 
             TagBox["Y",
              DisplayForm]}], "]"}], ",", "  ", 
           RowBox[{"Headerize", "[", 
            RowBox[{"\"\<mod\>\"", ",", " ", 
             RowBox[{"B2P", "[", "Cat", "]"}]}], "]"}], ",", " ", 
           RowBox[{"Headerize", "[", 
            RowBox[{"\"\<MMH\>\"", ",", "k"}], "]"}]}], "}"}], "]"}], ",", 
        "rules"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.587548455550111*^9, 3.587548569318074*^9}, {
  3.587548730945698*^9, 3.587548765581106*^9}, {3.5875489902300653`*^9, 
  3.587549093219445*^9}, {3.587549357424836*^9, 3.587549360331056*^9}, {
  3.602622447524356*^9, 3.602622450932867*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["MWC Arrows (3.6.2)", "Subsubsection",
 CellChangeTimes->{{3.587586423887822*^9, 3.587586426359748*^9}, {
  3.5875920265606537`*^9, 3.587592027464329*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TextArrow", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Overscript", "[", 
       RowBox[{
        RowBox[{"DoubleLongRightArrow", "[", 
         RowBox[{"X_", ",", " ", "Y_"}], "]"}], ",", "Cat_"}], "]"}], ",", 
      " ", 
      RowBox[{"MWC", "[", "k__", "]"}]}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "rules", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rules", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<(\>\""}], ",", 
         RowBox[{"\"\<]\>\"", "\[Rule]", "\"\<)\>\""}], ",", 
         RowBox[{"\"\<{\>\"", "\[Rule]", " ", "\"\<[\>\""}], ",", " ", 
         RowBox[{"\"\<}\>\"", "\[Rule]", " ", "\"\<]\>\""}], ",", " ", 
         RowBox[{"\"\<\[Rule]\>\"", "\[Rule]", " ", "\"\<==>\>\""}], ",", 
         RowBox[{"\"\<->\>\"", "\[Rule]", " ", "\"\<==>\>\""}], ",", " ", 
         RowBox[{"\"\< \>\"", "\[Rule]", " ", "\"\<\>\""}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"B2P", "[", 
            RowBox[{
             TagBox["X",
              DisplayForm], "\[Rule]", 
             TagBox["Y",
              DisplayForm]}], "]"}], ",", "  ", 
           RowBox[{"Headerize", "[", 
            RowBox[{"\"\<mod\>\"", ",", " ", 
             RowBox[{"B2P", "[", "Cat", "]"}]}], "]"}], ",", " ", 
           RowBox[{"Headerize", "[", 
            RowBox[{"\"\<MWC\>\"", ",", "k"}], "]"}]}], "}"}], "]"}], ",", 
        "rules"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TextArrow", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Underoverscript", "[", 
       RowBox[{
        RowBox[{"DoubleLongRightArrow", "[", 
         RowBox[{"X_", ",", " ", "Y_"}], "]"}], ",", "UnderCat_", ",", 
        "OverCat_"}], "]"}], ",", " ", 
      RowBox[{"MWC", "[", "k__", "]"}]}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "rules", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rules", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<(\>\""}], ",", 
         RowBox[{"\"\<]\>\"", "\[Rule]", "\"\<)\>\""}], ",", 
         RowBox[{"\"\<{\>\"", "\[Rule]", " ", "\"\<[\>\""}], ",", " ", 
         RowBox[{"\"\<}\>\"", "\[Rule]", " ", "\"\<]\>\""}], ",", " ", 
         RowBox[{"\"\<\[Rule]\>\"", "\[Rule]", " ", "\"\<==>\>\""}], ",", 
         RowBox[{"\"\<->\>\"", "\[Rule]", " ", "\"\<==>\>\""}], ",", " ", 
         RowBox[{"\"\< \>\"", "\[Rule]", " ", "\"\<\>\""}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"ToString", "[", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"B2P", "[", 
            RowBox[{
             TagBox["X",
              DisplayForm], "\[Rule]", 
             TagBox["Y",
              DisplayForm]}], "]"}], ",", "  ", "\[IndentingNewLine]", 
           RowBox[{"Headerize", "[", 
            RowBox[{"\"\<mod\>\"", ",", " ", 
             RowBox[{"B2P", "[", "OverCat", "]"}], ",", " ", 
             RowBox[{"L2B", "/@", 
              RowBox[{"{", 
               RowBox[{"B2P", "[", "UnderCat", "]"}], "}"}]}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Headerize", "[", 
            RowBox[{"\"\<MWC\>\"", ",", "k"}], "]"}]}], "\[IndentingNewLine]",
           "}"}], "]"}], ",", "\[IndentingNewLine]", "rules"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.587590498680674*^9, 3.5875905288595333`*^9}, {
  3.587590592354191*^9, 3.587590593647916*^9}, {3.587590654247642*^9, 
  3.587590673066777*^9}, {3.587590725107272*^9, 3.587590769610991*^9}, {
  3.587590869974537*^9, 3.58759087856063*^9}, {3.6026224566777563`*^9, 
  3.602622459968261*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Hill Arrow Functions (3.7.1)", "Subsubsection",
 CellChangeTimes->{{3.587590959647798*^9, 3.5875909640231256`*^9}, {
  3.587592022944333*^9, 3.587592034368534*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TextArrow", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RightTeeArrow", "[", 
       RowBox[{"X_", ",", " ", "Y_"}], "]"}], ",", " ", 
      RowBox[{"hill", "[", "k__", "]"}]}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "rules", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rules", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<(\>\""}], ",", 
         RowBox[{"\"\<]\>\"", "\[Rule]", "\"\<)\>\""}], ",", 
         RowBox[{"\"\<{\>\"", "\[Rule]", " ", "\"\<[\>\""}], ",", " ", 
         RowBox[{"\"\<}\>\"", "\[Rule]", " ", "\"\<]\>\""}], ",", " ", 
         RowBox[{"\"\<\[Rule]\>\"", "\[Rule]", " ", "\"\<|->\>\""}], ",", 
         RowBox[{"\"\<->\>\"", "\[Rule]", " ", "\"\<|->\>\""}], ",", " ", 
         RowBox[{"\"\< \>\"", "\[Rule]", " ", "\"\<\>\""}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"B2P", "[", 
            RowBox[{
             TagBox["X",
              DisplayForm], "\[Rule]", 
             TagBox["Y",
              DisplayForm]}], "]"}], ",", " ", 
           RowBox[{"Headerize", "[", 
            RowBox[{"\"\<Hill\>\"", ",", 
             RowBox[{"L2B", "/@", 
              RowBox[{"{", "k", "}"}]}]}], "]"}]}], "}"}], "]"}], ",", 
        "rules"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TextArrow", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Overscript", "[", 
       RowBox[{
        RowBox[{"RightTeeArrow", "[", 
         RowBox[{"X_", ",", " ", "Y_"}], "]"}], ",", "Cat_"}], "]"}], ",", 
      "  ", 
      RowBox[{"hill", "[", "k__", "]"}]}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "rules", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rules", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<{\>\"", "\[Rule]", " ", "\"\<[\>\""}], ",", " ", 
         RowBox[{"\"\<}\>\"", "\[Rule]", " ", "\"\<]\>\""}], ",", " ", 
         RowBox[{"\"\<\[Rule]\>\"", "\[Rule]", " ", "\"\<|-->\>\""}], ",", 
         RowBox[{"\"\<->\>\"", "\[Rule]", " ", "\"\<|-->\>\""}], ",", " ", 
         RowBox[{"\"\< \>\"", "\[Rule]", " ", "\"\<\>\""}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"ToString", "[", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"B2P", "[", 
            RowBox[{
             TagBox["X",
              DisplayForm], "\[Rule]", 
             TagBox["Y",
              DisplayForm]}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Headerize", "[", 
            RowBox[{"\"\<mod\>\"", ",", 
             RowBox[{"B2P", "[", "Cat", "]"}]}], "]"}], ",", "  ", 
           "\[IndentingNewLine]", 
           RowBox[{"Headerize", "[", 
            RowBox[{"\"\<Hill\>\"", ",", 
             RowBox[{"L2B", "/@", 
              RowBox[{"{", "k", "}"}]}]}], "]"}]}], "\[IndentingNewLine]", 
          "}"}], "]"}], ",", "rules"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.587591597281247*^9, 3.587591645736043*^9}, {
   3.587591715991324*^9, 3.587591727943376*^9}, {3.587591763455785*^9, 
   3.587591836698411*^9}, {3.5875919680260477`*^9, 3.587591971547289*^9}, 
   3.602622468175831*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["GRN Arrows (3.7.2)", "Subsubsection",
 CellChangeTimes->{{3.5875920190567007`*^9, 3.587592038096196*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TextArrow", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RightTeeArrow", "[", 
       RowBox[{"X_", ",", " ", "Y_"}], "]"}], ",", " ", 
      RowBox[{"GRN", "[", "k__", "]"}]}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "rules", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rules", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<(\>\""}], ",", 
         RowBox[{"\"\<]\>\"", "\[Rule]", "\"\<)\>\""}], ",", 
         RowBox[{"\"\<{\>\"", "\[Rule]", " ", "\"\<[\>\""}], ",", " ", 
         RowBox[{"\"\<}\>\"", "\[Rule]", " ", "\"\<]\>\""}], ",", " ", 
         RowBox[{"\"\<\[Rule]\>\"", "\[Rule]", " ", "\"\<|->\>\""}], ",", 
         RowBox[{"\"\<->\>\"", "\[Rule]", " ", "\"\<|->\>\""}], ",", " ", 
         RowBox[{"\"\< \>\"", "\[Rule]", " ", "\"\<\>\""}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"B2P", "[", 
            RowBox[{
             TagBox["X",
              DisplayForm], "\[Rule]", 
             TagBox["Y",
              DisplayForm]}], "]"}], ",", " ", 
           RowBox[{"Headerize", "[", 
            RowBox[{"\"\<NHCA\>\"", ",", 
             RowBox[{"L2B", "/@", 
              RowBox[{"{", "k", "}"}]}]}], "]"}]}], "}"}], "]"}], ",", 
        "rules"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TextArrow", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Overscript", "[", 
       RowBox[{
        RowBox[{"RightTeeArrow", "[", 
         RowBox[{"X_", ",", " ", "Y_"}], "]"}], ",", "Cat_"}], "]"}], ",", 
      "  ", 
      RowBox[{"GRN", "[", "k__", "]"}]}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "rules", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rules", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<(\>\""}], ",", 
         RowBox[{"\"\<]\>\"", "\[Rule]", "\"\<)\>\""}], ",", 
         RowBox[{"\"\<{\>\"", "\[Rule]", " ", "\"\<[\>\""}], ",", " ", 
         RowBox[{"\"\<}\>\"", "\[Rule]", " ", "\"\<]\>\""}], ",", " ", 
         RowBox[{"\"\<\[Rule]\>\"", "\[Rule]", " ", "\"\<|-->\>\""}], ",", 
         RowBox[{"\"\<->\>\"", "\[Rule]", " ", "\"\<|-->\>\""}], ",", " ", 
         RowBox[{"\"\< \>\"", "\[Rule]", " ", "\"\<\>\""}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"ToString", "[", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"B2P", "[", 
            RowBox[{
             TagBox["X",
              DisplayForm], "\[Rule]", 
             TagBox["Y",
              DisplayForm]}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Headerize", "[", 
            RowBox[{"\"\<mod\>\"", ",", 
             RowBox[{"B2P", "[", "Cat", "]"}]}], "]"}], ",", "  ", 
           "\[IndentingNewLine]", 
           RowBox[{"Headerize", "[", 
            RowBox[{"\"\<GRN\>\"", ",", 
             RowBox[{"L2B", "/@", 
              RowBox[{"{", "k", "}"}]}]}], "]"}]}], "\[IndentingNewLine]", 
          "}"}], "]"}], ",", "rules"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.587591597281247*^9, 3.587591645736043*^9}, {
  3.587591715991324*^9, 3.587591727943376*^9}, {3.587591763455785*^9, 
  3.587591836698411*^9}, {3.5875919680260477`*^9, 3.587591971547289*^9}, {
  3.5875925197737226`*^9, 3.587592545383319*^9}, {3.587592611322934*^9, 
  3.587592612407387*^9}, {3.6026224751046963`*^9, 3.602622478353854*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["S-System Arrows (3.7.3)", "Subsubsection",
 CellChangeTimes->{{3.5875935576143513`*^9, 3.5875935619819727`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TextArrow", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RightTeeArrow", "[", 
       RowBox[{"X_", ",", " ", "Y_"}], "]"}], ",", " ", 
      RowBox[{"SSystem", "[", "k__", "]"}]}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "rules", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rules", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<(\>\""}], ",", 
         RowBox[{"\"\<]\>\"", "\[Rule]", "\"\<)\>\""}], ",", 
         RowBox[{"\"\<{\>\"", "\[Rule]", " ", "\"\<[\>\""}], ",", " ", 
         RowBox[{"\"\<}\>\"", "\[Rule]", " ", "\"\<]\>\""}], ",", " ", 
         RowBox[{"\"\<\[Rule]\>\"", "\[Rule]", " ", "\"\<|->\>\""}], ",", 
         RowBox[{"\"\<->\>\"", "\[Rule]", " ", "\"\<|->\>\""}], ",", " ", 
         RowBox[{"\"\< \>\"", "\[Rule]", " ", "\"\<\>\""}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"B2P", "[", 
            RowBox[{
             TagBox["X",
              DisplayForm], "\[Rule]", 
             TagBox["Y",
              DisplayForm]}], "]"}], ",", " ", 
           RowBox[{"Headerize", "[", 
            RowBox[{"\"\<SSystem\>\"", ",", 
             RowBox[{"L2B", "/@", 
              RowBox[{"{", "k", "}"}]}]}], "]"}]}], "}"}], "]"}], ",", 
        "rules"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.587593709322527*^9, 3.587593719697707*^9}, 
   3.6026224838061867`*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["NHCA Arrows (3.7.4)", "Subsubsection",
 CellChangeTimes->{{3.5875920190567007`*^9, 3.587592038096196*^9}, {
  3.587592588957123*^9, 3.587592602205309*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TextArrow", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RightTeeArrow", "[", 
       RowBox[{"X_", ",", " ", "Y_"}], "]"}], ",", " ", 
      RowBox[{"NHCA", "[", "k__", "]"}]}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "rules", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rules", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<(\>\""}], ",", 
         RowBox[{"\"\<]\>\"", "\[Rule]", "\"\<)\>\""}], ",", 
         RowBox[{"\"\<{\>\"", "\[Rule]", " ", "\"\<[\>\""}], ",", " ", 
         RowBox[{"\"\<}\>\"", "\[Rule]", " ", "\"\<]\>\""}], ",", " ", 
         RowBox[{"\"\<\[Rule]\>\"", "\[Rule]", " ", "\"\<|->\>\""}], ",", 
         RowBox[{"\"\<->\>\"", "\[Rule]", " ", "\"\<|->\>\""}], ",", " ", 
         RowBox[{"\"\< \>\"", "\[Rule]", " ", "\"\<\>\""}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"StringReplace", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"StringReplace", "[", 
         RowBox[{
          RowBox[{"ToString", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"B2P", "[", 
              RowBox[{
               TagBox["X",
                DisplayForm], "\[Rule]", 
               TagBox["Y",
                DisplayForm]}], "]"}], ",", " ", 
             RowBox[{"Headerize", "[", 
              RowBox[{"\"\<NHCA\>\"", ",", 
               RowBox[{"L2B", "/@", 
                RowBox[{"{", "k", "}"}]}]}], "]"}]}], "}"}], "]"}], ",", 
          "rules"}], "]"}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<[[\>\"", "\[Rule]", " ", "\"\<[\>\""}], ",", " ", 
          RowBox[{"\"\<]]\>\"", "\[Rule]", " ", "\"\<]\>\""}]}], "}"}]}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TextArrow", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Overscript", "[", 
       RowBox[{
        RowBox[{"RightTeeArrow", "[", 
         RowBox[{"X_", ",", " ", "Y_"}], "]"}], ",", "Cat_"}], "]"}], ",", 
      "  ", 
      RowBox[{"NHCA", "[", "k__", "]"}]}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "rules", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rules", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<(\>\""}], ",", 
         RowBox[{"\"\<]\>\"", "\[Rule]", "\"\<)\>\""}], ",", 
         RowBox[{"\"\<{\>\"", "\[Rule]", " ", "\"\<[\>\""}], ",", " ", 
         RowBox[{"\"\<}\>\"", "\[Rule]", " ", "\"\<]\>\""}], ",", " ", 
         RowBox[{"\"\<\[Rule]\>\"", "\[Rule]", " ", "\"\<|-->\>\""}], ",", 
         RowBox[{"\"\<->\>\"", "\[Rule]", " ", "\"\<|-->\>\""}], ",", " ", 
         RowBox[{"\"\< \>\"", "\[Rule]", " ", "\"\<\>\""}]}], " ", "}"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"StringReplace", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"StringReplace", "[", 
         RowBox[{
          RowBox[{"ToString", "[", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"B2P", "[", 
              RowBox[{
               TagBox["X",
                DisplayForm], "\[Rule]", 
               TagBox["Y",
                DisplayForm]}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Headerize", "[", 
              RowBox[{"\"\<mod\>\"", ",", 
               RowBox[{"B2P", "[", "Cat", "]"}]}], "]"}], ",", "  ", 
             "\[IndentingNewLine]", 
             RowBox[{"Headerize", "[", 
              RowBox[{"\"\<NHCA\>\"", ",", 
               RowBox[{"L2B", "/@", 
                RowBox[{"{", "k", "}"}]}]}], "]"}]}], "\[IndentingNewLine]", 
            "}"}], "]"}], ",", "rules"}], "]"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<[[\>\"", "\[Rule]", " ", "\"\<[\>\""}], ",", " ", 
          RowBox[{"\"\<]]\>\"", "\[Rule]", " ", "\"\<]\>\""}]}], "}"}]}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.587591597281247*^9, 3.587591645736043*^9}, {
  3.587591715991324*^9, 3.587591727943376*^9}, {3.587591763455785*^9, 
  3.587591836698411*^9}, {3.5875919680260477`*^9, 3.587591971547289*^9}, {
  3.5875925197737226`*^9, 3.587592545383319*^9}, {3.5875926055962048`*^9, 
  3.587592606340282*^9}, {3.587592763075379*^9, 3.587592770907598*^9}, {
  3.587593280261629*^9, 3.587593354422237*^9}, {3.5875934219094687`*^9, 
  3.587593435145956*^9}, {3.6026224966806993`*^9, 3.602622507296257*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Rational Function Arrow (3.7.5)\
\>", "Subsubsection",
 CellChangeTimes->{{3.5875937535495987`*^9, 3.587593763109062*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TextArrow", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DoubleLongRightArrow", "[", 
       RowBox[{"X_", ",", " ", "Y_"}], "]"}], ",", " ", 
      RowBox[{"rational", "[", "k__", "]"}]}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "rules", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rules", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<(\>\""}], ",", 
         RowBox[{"\"\<]\>\"", "\[Rule]", "\"\<)\>\""}], ",", 
         RowBox[{"\"\<{\>\"", "\[Rule]", " ", "\"\<[\>\""}], ",", " ", 
         RowBox[{"\"\<}\>\"", "\[Rule]", " ", "\"\<]\>\""}], ",", " ", 
         RowBox[{"\"\<\[Rule]\>\"", "\[Rule]", " ", "\"\<==>\>\""}], ",", 
         RowBox[{"\"\<->\>\"", "\[Rule]", " ", "\"\<==>\>\""}], ",", " ", 
         RowBox[{"\"\< \>\"", "\[Rule]", " ", "\"\<\>\""}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"B2P", "[", 
            RowBox[{
             TagBox["X",
              DisplayForm], "\[Rule]", 
             TagBox["Y",
              DisplayForm]}], "]"}], ",", " ", 
           RowBox[{"Headerize", "[", 
            RowBox[{"\"\<rational\>\"", ",", 
             RowBox[{"L2B", "/@", 
              RowBox[{"{", "k", "}"}]}]}], "]"}]}], "}"}], "]"}], ",", 
        "rules"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.5875939319480467`*^9, 3.587593939739028*^9}, {
   3.587593970325458*^9, 3.587594009774168*^9}, 3.6026225234849033`*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["User Arrow (3.7.6)", "Subsubsection",
 CellChangeTimes->{{3.587594357058042*^9, 3.587594361264964*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MakeLambda", "[", "fun_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "n", ",", "slots", ",", "expr", ",", "f1", ",", "X", ",", "slotvars", 
      ",", "slot", ",", "fred", ",", "Temp", ",", "argument", ",", "decl"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"argument", "[", 
       RowBox[{"f_", "[", "x_", "]"}], "]"}], ":=", "x"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"slots", "[", "f_", "]"}], ":=", 
      RowBox[{"Length", "[", 
       RowBox[{"Union", "[", 
        RowBox[{"Cases", "[", 
         RowBox[{"f", ",", 
          RowBox[{"Slot", "[", "_", "]"}], ",", "Infinity"}], "]"}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"n", "=", 
      RowBox[{"slots", "[", "fun", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"slotvars", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"\"\<X\>\"", "<>", 
         RowBox[{"ToString", "[", "j", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"slot", "[", "j_", "]"}], ":=", 
      RowBox[{"slotvars", "[", 
       RowBox[{"[", "j", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"expr", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"InputForm", "[", 
          RowBox[{"argument", "[", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"fun", "/.", 
              RowBox[{"{", 
               RowBox[{"Function", "\[Rule]", "Temp"}], "}"}]}], "/.", 
             RowBox[{"{", 
              RowBox[{"Slot", "\[Rule]", "slot"}], "}"}]}], ")"}], "]"}], 
          "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<\\\"\>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"decl", "=", "\"\<lambda \>\""}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "slotvars", "]"}], ">", "0"}], ",", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "slotvars", "]"}], "\[Equal]", "n"}], ",", 
          RowBox[{"decl", "=", 
           RowBox[{"decl", "<>", "\"\< \>\"", "<>", 
            RowBox[{"First", "[", "slotvars", "]"}]}]}], ",", 
          RowBox[{"decl", "=", 
           RowBox[{"decl", "<>", "\"\<, \>\"", "<>", 
            RowBox[{"First", "[", "slotvars", "]"}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"slotvars", "=", 
         RowBox[{"Rest", "[", "slotvars", "]"}]}], ";"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"expr", "=", 
      RowBox[{
      "\"\<\\\"\>\"", "<>", "decl", "<>", "\"\<: \>\"", "<>", "expr", "<>", 
       "\"\<\\\"\>\""}]}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TextArrow", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RightTeeArrow", "[", 
       RowBox[{"X_", ",", " ", "Y_"}], "]"}], ",", " ", 
      RowBox[{"unknown_", "[", 
       RowBox[{"v_", ",", "T_", ",", "n_", ",", "h_", ",", "f_Function"}], 
       "]"}]}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"rules", ",", "fun"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rules", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<(\>\""}], ",", 
         RowBox[{"\"\<]\>\"", "\[Rule]", "\"\<)\>\""}], ",", 
         RowBox[{"\"\<{\>\"", "\[Rule]", " ", "\"\<[\>\""}], ",", " ", 
         RowBox[{"\"\<}\>\"", "\[Rule]", " ", "\"\<]\>\""}], ",", " ", 
         RowBox[{"\"\<\[Rule]\>\"", "\[Rule]", " ", "\"\<|->\>\""}], ",", 
         RowBox[{"\"\<->\>\"", "\[Rule]", " ", "\"\<|->\>\""}]}], "}"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"fun", "=", 
       RowBox[{"MakeLambda", "[", "f", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"B2P", "[", 
            RowBox[{
             TagBox["X",
              DisplayForm], "\[Rule]", 
             TagBox["Y",
              DisplayForm]}], "]"}], ",", " ", 
           RowBox[{"Headerize", "[", 
            RowBox[{"\"\<USER\>\"", ",", 
             RowBox[{"L2B", "/@", 
              RowBox[{"{", 
               RowBox[{"v", ",", "T", ",", "n", ",", "h", ",", "fun"}], 
               "}"}]}]}], "]"}]}], "}"}], "]"}], ",", "rules"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5875943626453943`*^9, 3.587594422262993*^9}, {
   3.5875944663362837`*^9, 3.5875945260769587`*^9}, {3.587594599760066*^9, 
   3.587594630078635*^9}, {3.5875946683141327`*^9, 3.58759467643989*^9}, {
   3.587594711181452*^9, 3.587594727091941*^9}, {3.5875951323021097`*^9, 
   3.587595135965517*^9}, {3.587596846628592*^9, 3.587596866620387*^9}, {
   3.5875969472087317`*^9, 3.587596949019394*^9}, 3.602622534272888*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Error Arrow", "Subsubsection",
 CellChangeTimes->{{3.587507564880158*^9, 3.5875075667667933`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TextArrow", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<A TextArrow translation has not been implemented for the \
following arrow: \>\"", ",", " ", "x"}], "]"}], ";", " ", 
      RowBox[{"Return", "[", "\"\<\>\"", "]"}]}], ")"}]}], ";"}], 
  " "}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.587505357100073*^9, 3.587505398916069*^9}, {
  3.587549503922845*^9, 3.587549529665839*^9}}]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["FBA", "Section",
 CellChangeTimes->{{3.5513147821208353`*^9, 3.551314782576705*^9}}],

Cell[CellGroupData[{

Cell["FluxReactionStoichiometry", "Subsubsection",
 CellChangeTimes->{{3.551317392334709*^9, 3.5513173975509863`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FluxReactionStoichiometry", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ShortRightArrow", "[", 
       RowBox[{"LHS_", ",", "RHS_"}], " ", "]"}], ",", 
      RowBox[{"Flux", "[", "stuff__", "]"}]}], "}"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"species", ",", " ", "stoics", ",", "defunctionate"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"defunctionate", "[", 
        RowBox[{"p_", "[", "q_", "]"}], "]"}], ":=", " ", "p"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"defunctionate", "[", "p_", "]"}], ":=", " ", "p"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"species", ",", " ", "stoics"}], "}"}], " ", "=", " ", 
       RowBox[{"reactionStoich", "[", 
        RowBox[{"LHS", ",", " ", "RHS"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"species", " ", "=", " ", 
       RowBox[{"defunctionate", "/@", "species"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"species", ",", " ", "stoics"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FluxReactionStoichiometry", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Rule", "[", 
        RowBox[{"A_", ",", "B_"}], "]"}], ",", " ", 
       RowBox[{"Flux", "[", "stuff__", "]"}]}], "}"}], "]"}], ":=", " ", 
    RowBox[{"FluxReactionStoichiometry", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ShortRightArrow", "[", 
        RowBox[{"A", ",", "B"}], "]"}], ",", 
       RowBox[{"Flux", "[", "stuff", "]"}]}], "}"}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FluxReactionStoichiometry", "[", "other___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Not a Flux model: \>\"", ",", " ", "other"}], "]"}], ";", 
      " ", 
      RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.551314785622629*^9, 3.55131479988811*^9}, {
  3.5513148536052017`*^9, 3.551314880230554*^9}, {3.5513149191264563`*^9, 
  3.551314986650511*^9}, {3.551315442679344*^9, 3.551315450912266*^9}, {
  3.5513154828340054`*^9, 3.551315499138508*^9}, {3.55131555854469*^9, 
  3.551315571663121*^9}, {3.551315736185864*^9, 3.551315760275085*^9}, {
  3.5513158801151257`*^9, 3.55131593645426*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["StoichiometryMatrix", "Subsubsection",
 CellChangeTimes->{{3.551317384527225*^9, 3.5513173885908003`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"StoichiometryMatrix", "[", "model_", "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "stuffs", ",", " ", "allSpecies", ",", " ", "NS", ",", " ", "NR", ",", 
      "N", ",", "S", ",", "R", ",", "missing", ",", "species", ",", "stoichs",
       ",", "RR"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"stuffs", " ", "=", " ", 
      RowBox[{"FluxReactionStoichiometry", "/@", "model"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"allSpecies", " ", "=", " ", 
      RowBox[{"Union", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"First", "/@", "stuffs"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"NS", " ", "=", " ", 
      RowBox[{"Length", "[", "allSpecies", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"NR", " ", "=", " ", 
      RowBox[{"Length", "[", "stuffs", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"N", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "stuffs", "]"}], ">", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"R", "=", 
         RowBox[{"First", "[", "stuffs", "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"stuffs", "=", 
         RowBox[{"Rest", "[", "stuffs", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"species", ",", " ", "stoichs"}], "}"}], "=", "R"}], ";", 
        " ", "\[IndentingNewLine]", 
        RowBox[{"missing", "=", 
         RowBox[{"Complement", "[", 
          RowBox[{"allSpecies", ",", "species"}], "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"species", " ", "=", " ", 
         RowBox[{"Join", "[", 
          RowBox[{"species", ",", "missing"}], "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"stoichs", " ", "=", " ", 
         RowBox[{"PadRight", "[", 
          RowBox[{"stoichs", ",", "NS"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"RR", "=", 
         RowBox[{
          RowBox[{"Sort", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"species", ",", "stoichs"}], "}"}], "//", "Transpose"}], 
           "]"}], "//", "Transpose"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"stoichs", "=", 
         RowBox[{"RR", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"N", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"N", ",", " ", "stoichs"}], "]"}]}], ";"}]}], " ", 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Transpose", "[", "N", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.551315713101492*^9, 3.551315728590555*^9}, {
   3.5513157631674137`*^9, 3.551315804898473*^9}, {3.551315940041594*^9, 
   3.551316084220666*^9}, {3.5513161402714233`*^9, 3.551316208465035*^9}, {
   3.551316241490019*^9, 3.551316259361929*^9}, {3.551316324331699*^9, 
   3.551316455899719*^9}, {3.551316494468636*^9, 3.551316584666381*^9}, {
   3.551316615657958*^9, 3.551316648172591*^9}, {3.551316702399989*^9, 
   3.551316775836906*^9}, {3.551316861221055*^9, 3.551316874020577*^9}, 
   3.5513169955757113`*^9, {3.551317049261554*^9, 3.551317092477407*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["ParseFluxReaction", "Subsubsection",
 CellChangeTimes->{{3.551378261460834*^9, 3.5513782679964542`*^9}, {
  3.551402209067891*^9, 3.551402215818383*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ParseFluxReaction", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ShortRightArrow", "[", 
        RowBox[{"lhs_", ",", "rhs_"}], "]"}], ",", " ", 
       RowBox[{"Flux", "[", "args___", "]"}]}], "}"}], "]"}], ":=", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "input", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"input", "=", 
        RowBox[{"{", "args", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"increment", " ", "Global", " ", 
         RowBox[{"(", 
          RowBox[{"xlr8r`Private", " ", "context"}], ")"}], " ", "variable"}],
         " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"iFluxArrows", " ", "=", " ", 
        RowBox[{"iFluxArrows", "+", "1"}]}], ";", " ", "\[IndentingNewLine]", 
       
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "input", "]"}], "<", "1"}], ",", " ", 
         RowBox[{"input", "=", 
          RowBox[{"{", 
           RowBox[{"-", "Infinity"}], "}"}]}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "input", "]"}], "<", "2"}], ",", " ", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"input", ",", "  ", 
           RowBox[{"Unique", "[", 
            RowBox[{"\"\<v\>\"", "<>", 
             RowBox[{"ToString", "[", "iFluxArrows", "]"}]}], "]"}]}], 
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "input", "]"}], "<", "3"}], ",", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"input", ",", " ", "Infinity"}], "]"}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "input", "]"}], "<", "4"}], ",", " ", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"input", ",", "0"}], "]"}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "input", "]"}], "<", "5"}], ",", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"input", ",", "0"}], "]"}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "input", "]"}], ">", "5"}], ",", " ", 
         RowBox[{"input", " ", "=", " ", 
          RowBox[{"Take", "[", 
           RowBox[{"input", ",", " ", "5"}], "]"}]}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "input"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ParseFluxReaction", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Rule", "[", 
       RowBox[{"lhs_", ",", "rhs_"}], "]"}], ",", 
      RowBox[{"Flux", "[", "args___", "]"}]}], "}"}], "]"}], ":=", " ", 
   RowBox[{"ParseFluxReaction", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ShortRightArrow", "[", 
       RowBox[{"lhs", ",", "rhs"}], "]"}], ",", 
      RowBox[{"Flux", "[", "args", "]"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ParseFluxReaction", "[", "other___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Not a flux reaction: \>\"", ",", " ", "other"}], "]"}], 
      ";", " ", 
      RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.551378270721939*^9, 3.551378392712854*^9}, {
  3.55137845378659*^9, 3.5513784864189167`*^9}, {3.551378731467074*^9, 
  3.5513787893884583`*^9}, {3.5513788712895927`*^9, 3.5513791434000397`*^9}, {
  3.5513792209906473`*^9, 3.551379222185944*^9}, {3.551379388000002*^9, 
  3.5513794207074213`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["OptimizeFluxModel", "Subsubsection",
 CellChangeTimes->{{3.551402224250938*^9, 3.5514022348675213`*^9}}],

Cell["\<\
input: a flux model
output: {maximum of objective function, {v1->val, v2->val, v3->val,...}} \
where val\[CloseCurlyQuote]s give a maximum, found using a Nelder Mead \
Simplex Algorithm. \
\>", "Text",
 CellChangeTimes->{{3.551402406945506*^9, 3.551402476802557*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"OptimizeFluxModel", "[", 
   RowBox[{"model_", ",", " ", 
    RowBox[{"debug_:", "False"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "inputs", ",", " ", "lower", ",", " ", "v", ",", " ", "upper", ",", " ", 
      "fluxvals", ",", " ", "f", ",", "M", ",", " ", "lu", ",", " ", 
      "constraints"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"iFluxArrows", "=", "0"}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"initialize", " ", "Global", " ", "iFluxArrows"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"inputs", " ", "=", " ", 
      RowBox[{"ParseFluxReaction", "/@", "model"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"Length", "[", "inputs", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"inputs", "  ", "=", " ", 
      RowBox[{"Transpose", "[", "inputs", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "lower", ",", " ", "v", ",", " ", "upper", ",", " ", "fluxvals", ",", 
        " ", "f"}], "}"}], " ", "=", " ", "inputs"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"lu", " ", "=", " ", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "<", "#2", "<", "#3"}], "&"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"lower", ",", " ", "v", ",", " ", "upper"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"M", "=", 
      RowBox[{"StoichiometryMatrix", "[", "model", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"constraints", " ", "=", " ", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Equal", "[", 
           RowBox[{"#", ",", "0"}], "]"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{"M", ".", "v"}], ")"}]}], ",", " ", "lu"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"debug", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Constraints: \>\"", ",", " ", "constraints"}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Objective Function: \>\"", ",", " ", 
          RowBox[{"f", ".", "v"}]}], "]"}], ";"}]}], " ", 
      "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"NMaximize", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"f", ".", "v"}], ",", " ", "constraints"}], "}"}], ",", " ", 
       "v", ",", " ", 
       RowBox[{"Method", "\[Rule]", " ", "\"\<NelderMead\>\""}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5513786659570417`*^9, 3.551378714221324*^9}, {
   3.551378995525999*^9, 3.551379000047044*^9}, 3.5513791607576513`*^9, {
   3.5513792762285433`*^9, 3.551379303241765*^9}, {3.551379333373622*^9, 
   3.551379384827944*^9}, {3.551379456386944*^9, 3.551379487726475*^9}, {
   3.551380352318467*^9, 3.5513803846373653`*^9}, {3.5513804165047503`*^9, 
   3.551380562184732*^9}, {3.551380653738257*^9, 3.5513806815172586`*^9}, {
   3.551383496875763*^9, 3.5513837914696093`*^9}, {3.5514019025888453`*^9, 
   3.5514019120489264`*^9}, {3.551402140581943*^9, 3.55140217595231*^9}, {
   3.551402237843032*^9, 3.551402240629739*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["interpret, ODE", "Section",
 CellChangeTimes->{{3.551627161484438*^9, 3.551627162155751*^9}}],

Cell[CellGroupData[{

Cell["interpret", "Subsubsection",
 CellChangeTimes->{{3.551627140252569*^9, 3.551627141531938*^9}}],

Cell["\<\
This is not very elegant but it scales much better than using lots of Maps\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"iFluxArrows", "=", "0"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"make", " ", "global"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"interpret", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"reactions__", "?", "ListQ"}], "}"}], ",", " ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "dbg", ",", "r", ",", "odes", ",", " ", "species", ",", "terms", ",", 
       "odeterms", ",", "cpu", ",", "nextvar", ",", "nextterm", ",", "var", 
       ",", "vardot", ",", "vardotarray", ",", "term", ",", "termarray", ",", 
       "timer", ",", " ", "n", ",", "i", ",", "vars", ",", " ", "j", ",", 
       "varnames", ",", "varnamearray", ",", "vararray", ",", "eqn", ",", " ",
        "frozenvariables", ",", "somefrozen", ",", "\[EmptySet]s", ",", " ", 
       "defunctionate", ",", " ", "raterules", ",", " ", "complement", ",", 
       " ", "liquidvariables", ",", " ", "f", ",", " ", "v"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"iFluxArrows", "=", "0"}], ";", " ", 
      RowBox[{"(*", " ", "reset", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"complement", "[", "p_", "]"}], "[", "Global`t", "]"}], ":=", 
       " ", 
       RowBox[{"1", "-", 
        RowBox[{"p", "[", "Global`t", "]"}]}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"defunctionate", "[", 
        RowBox[{"p_", "[", "Global`t", "]"}], "]"}], ":=", " ", "p"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"defunctionate", "[", "p_", "]"}], ":=", " ", "p"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dbg", " ", "=", " ", 
       RowBox[{"debugflag", "/.", 
        RowBox[{"{", "opt", "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"timer", " ", "=", " ", 
       RowBox[{
        RowBox[{"Global`CPU", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"Global`CPU", "\[Rule]", " ", "False"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"raterules", "=", 
       RowBox[{
        RowBox[{"rates", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"Options", "[", "interpret", "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"dbg", ",", " ", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<interpret: raterules=\>\"", ",", "raterules"}], "]"}]}],
        "]"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"r", "=", 
       RowBox[{
        RowBox[{"{", "reactions", "}"}], "/.", "raterules"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"dbg", ",", " ", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<interpret:input:\>\"", ",", "r"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"frozenvariables", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<Frozen\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"Options", "[", "interpret", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "check", " ", "for", " ", "deprecated", " ", "version", " ", "if", " ",
         "new", " ", "version", " ", "is", " ", "not", " ", "used"}], " ", 
       "*)"}], " ", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "frozenvariables", "]"}], "<", "1"}], ",", 
        " ", "\[IndentingNewLine]", 
        RowBox[{"frozenvariables", " ", "=", " ", 
         RowBox[{
          RowBox[{"frozen", "/.", 
           RowBox[{"{", "opt", "}"}]}], "/.", 
          RowBox[{"Options", "[", "interpret", "]"}]}]}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "add", " ", "dummy", " ", "reaction", " ", "for", " ", "all", " ", 
        "frozen", " ", "variables", " ", "to", " ", "force", " ", "them", " ",
         "to", " ", "be", " ", "species", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"11.26", ".07"}], ",", " ", 
          RowBox[{"v0", ".62"}]}], ")"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"f", "=", "frozenvariables"}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "f", "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"v", "=", 
          RowBox[{"First", "[", "f", "]"}]}], ";", " ", 
         RowBox[{"f", "=", " ", 
          RowBox[{"Rest", "[", "f", "]"}]}], ";", " ", "\[IndentingNewLine]", 
         
         RowBox[{"AppendTo", "[", 
          RowBox[{"r", ",", " ", 
           RowBox[{"{", 
            RowBox[{"v", "\[Rule]", " ", "v"}], "}"}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"dbg", ",", " ", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<interpret:revised input: \>\"", ",", " ", "r"}], 
         "]"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"frozenvariables", " ", "=", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"frozenvariables", ",", "Global`\[EmptySet]"}], "}"}], "//", 
        "Flatten"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"dbg", ",", " ", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<interpret:frozen:\>\"", ",", " ", "frozenvariables"}], 
         "]"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"somefrozen", "=", 
       RowBox[{
        RowBox[{"Length", "[", "frozenvariables", "]"}], ">", "0"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"somefrozen", ",", " ", 
        RowBox[{"frozenvariables", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", "Global`t", "]"}], "&"}], "/@", 
          "frozenvariables"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       StyleBox[
        RowBox[{
         RowBox[{"add", " ", "in", " ", "pre"}], "-", 
         RowBox[{"processing", " ", "here"}]}],
        FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"timer", ",", 
        RowBox[{
         RowBox[{"cpu", "=", 
          RowBox[{"TimeUsed", "[", "]"}]}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"r", "=", 
       RowBox[{"Join", "@@", 
        RowBox[{"expandArrows", "/@", "r"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"dbg", ",", " ", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<interpret:after expandArrows: \>\"", ",", " ", "r"}], 
         "]"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"r", "=", 
       RowBox[{"combineRegulatoryReactions", "[", "r", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"dbg", ",", " ", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<interpret: after combineRegulatory: \>\"", ",", " ", "r"}], 
         "]"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"odes", "=", 
       RowBox[{"parseArrowForm", "/@", "r"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"dbg", ",", " ", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<interpret: odes after parseArrowForm: \>\"", ",", " ", "odes"}],
          "]"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"odes", " ", "=", " ", 
       RowBox[{"Join", "@@", "odes"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"dbg", ",", " ", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<interpret: odes after parseArrowForm (2): \>\"", ",", " ", 
          "odes"}], "]"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"odes", "===", 
         RowBox[{"{", "}"}]}], ",", " ", 
        RowBox[{"Return", "[", 
         RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"species", " ", "=", 
       RowBox[{"Union", "[", 
        RowBox[{"First", "/@", "odes"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"timer", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"cpu", "=", 
          RowBox[{
           RowBox[{"TimeUsed", "[", "]"}], "-", "cpu"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<1:\>\"", ",", "cpu"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"cpu", "=", 
          RowBox[{"TimeUsed", "[", "]"}]}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"odes", "=", 
       RowBox[{"Sort", "[", "odes", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"timer", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"cpu", "=", 
          RowBox[{
           RowBox[{"TimeUsed", "[", "]"}], "-", "cpu"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<2:\>\"", ",", "cpu"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"cpu", "=", 
          RowBox[{"TimeUsed", "[", "]"}]}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"vars", ",", "odes"}], "}"}], "=", 
       RowBox[{"Transpose", "[", "odes", "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "odes", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"termarray", "=", 
       RowBox[{"Array", "[", 
        RowBox[{"terms", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"varnamearray", "=", 
       RowBox[{"Array", "[", 
        RowBox[{"varnames", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", " ", "n"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"terms", "[", "i", "]"}], "=", 
          RowBox[{"odes", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"varnames", "[", "i", "]"}], "=", 
          RowBox[{"vars", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"vararray", "=", 
       RowBox[{"Array", "[", 
        RowBox[{"var", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vardotarray", "=", 
       RowBox[{"Array", "[", 
        RowBox[{"vardot", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"i", "=", "1"}], ";", 
      RowBox[{"j", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"var", "[", "j", "]"}], "=", 
       RowBox[{"varnames", "[", "i", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"frozenvariables", ",", 
          RowBox[{"var", "[", "j", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"vardot", "[", "j", "]"}], "=", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"vardot", "[", "j", "]"}], "=", 
         RowBox[{"terms", "[", "i", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"i", "<", "n"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"i", "++"}], ";", "\[IndentingNewLine]", 
         RowBox[{"nextvar", "=", 
          RowBox[{"varnames", "[", "i", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"nextterm", "=", 
          RowBox[{"terms", "[", "i", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"nextvar", "===", 
            RowBox[{"var", "[", "j", "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{"frozenvariables", ",", 
                RowBox[{"var", "[", "j", "]"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"vardot", "[", "j", "]"}], "=", "0"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"vardot", "[", "j", "]"}], "+=", " ", "nextterm"}]}], 
             "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"j", "++"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"var", "[", "j", "]"}], "=", "nextvar"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{"frozenvariables", ",", 
                RowBox[{"var", "[", "j", "]"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"vardot", "[", "j", "]"}], "=", "0"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"vardot", "[", "j", "]"}], "=", "nextterm"}]}], 
             "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           StyleBox[
            RowBox[{
             RowBox[{
             "if", " ", "the", " ", "current", " ", "variable", " ", "is", 
              " ", "frozen"}], ",", " ", 
             RowBox[{"\"\<unsave\>\"", " ", "it"}]}],
            FontColor->RGBColor[0, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[0, 0, 1]], "*)"}], "\[IndentingNewLine]", 
          "]"}], ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"species", "=", 
       RowBox[{"Take", "[", 
        RowBox[{"vararray", ",", "j"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"odeterms", "=", 
       RowBox[{"Take", "[", 
        RowBox[{"vardotarray", ",", "j"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"timer", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"cpu", "=", 
          RowBox[{
           RowBox[{"TimeUsed", "[", "]"}], "-", "cpu"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<3:\>\"", ",", "cpu"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"cpu", "=", 
          RowBox[{"TimeUsed", "[", "]"}]}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"dbg", ",", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<interpret:odes:\>\"", ",", "odes"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<interpret:species:\>\"", ",", "species"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<interpret:odeterms:\>\"", ",", "odeterms"}], "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"\[EmptySet]s", "=", 
       RowBox[{"Position", "[", 
        RowBox[{"species", ",", 
         RowBox[{"Global`\[EmptySet]", "[", "Global`t", "]"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "\[EmptySet]s", "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "\[EmptySet]s", "]"}], ">", "1"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{
             "\"\<Error: Empty Set occurs at positions \>\"", ",", 
              "\[EmptySet]s"}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"\[EmptySet]s", "=", 
             RowBox[{"\[EmptySet]s", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"species", "=", 
             RowBox[{"Drop", "[", 
              RowBox[{"species", ",", "\[EmptySet]s"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"odeterms", "=", 
             RowBox[{"Drop", "[", 
              RowBox[{"odeterms", ",", "\[EmptySet]s"}], "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"odes", " ", "=", " ", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Equal", "[", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{"#1", ",", "Global`t"}], "]"}], ",", " ", "#2"}], "]"}], 
          "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"species", ",", "odeterms"}], "}"}]}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"odes", " ", "=", " ", 
       RowBox[{"odes", "/.", 
        RowBox[{"{", 
         RowBox[{"Comp", "\[Rule]", " ", "complement"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "remove", " ", "the", " ", "odes", " ", "for", " ", "the", " ", 
        "frozen", " ", "variables"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", "  ", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Length", "[", "odes", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"liquidvariables", "=", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{"frozenvariables", ",", 
                RowBox[{"var", "[", "#", "]"}]}], "]"}], "&"}], "/@", 
             RowBox[{"Range", "[", "n", "]"}]}], " ", ",", " ", "False"}], 
           "]"}], "//", "Flatten"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"odes", " ", "=", " ", 
         RowBox[{"odes", "[", 
          RowBox[{"[", "liquidvariables", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"species", "=", 
         RowBox[{"species", "[", 
          RowBox[{"[", "liquidvariables", "]"}], "]"}]}], ";"}], 
       "\[IndentingNewLine]", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"timer", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"cpu", "=", 
          RowBox[{
           RowBox[{"TimeUsed", "[", "]"}], "-", "cpu"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<4:\>\"", ",", "cpu"}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"species", "=", 
       RowBox[{"defunctionate", "/@", "species"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"odes", ",", "species"}], "}"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4050957734767036`*^9, 3.4050957756118927`*^9}, {
  3.405095849523144*^9, 3.405095849862878*^9}, {3.405095880892523*^9, 
  3.4050959696379347`*^9}, {3.405096004137417*^9, 3.405096051569764*^9}, {
  3.427490955970268*^9, 3.427491032845585*^9}, {3.427491086335598*^9, 
  3.427491086549312*^9}, {3.5513105644920588`*^9, 3.551310585772161*^9}, {
  3.5513122624742527`*^9, 3.551312262981016*^9}, {3.5513123496248093`*^9, 
  3.551312375092553*^9}, {3.551312452142906*^9, 3.551312454925475*^9}, {
  3.560879487226119*^9, 3.560879524956965*^9}, {3.5608795755498953`*^9, 
  3.5608795763820133`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"interpret", "[", "x___", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", " ", 
    RowBox[{
     RowBox[{"Print", "[", "\"\<Not a list of lists.\>\"", "]"}], ";", 
     RowBox[{"Return", "[", 
      RowBox[{"{", "}"}], "]"}], ";"}]}], "]"}]}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["ODE", "Subsubsection",
 CellChangeTimes->{{3.551627123500512*^9, 3.55162712383575*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NonListAndNonInteger", "[", "x_", "]"}], ":=", " ", 
   RowBox[{"And", "[", 
    RowBox[{
     RowBox[{"NonListQ", "[", "x", "]"}], ",", 
     RowBox[{"NonIntegerQ", "[", "x", "]"}]}], "]"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ODE", "[", 
     RowBox[{"{", 
      RowBox[{"reaction__", "?", "ListQ"}], "}"}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"interpret", "[", 
      RowBox[{"{", "reaction", "}"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ODE", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"reaction__", "?", "ListQ"}], "}"}], ",", "n_Integer"}], "]"}], 
   ":=", " ", 
   RowBox[{
    RowBox[{"interpret", "[", 
     RowBox[{"{", "reaction", "}"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "n"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ODE", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"reaction__", "?", "ListQ"}], "}"}], ",", " ", 
      RowBox[{"X_", "?", "NonListAndNonInteger"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"odes", ",", " ", "positions"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"odes", " ", "=", " ", 
        RowBox[{"ODE", "[", 
         RowBox[{"{", "reaction", "}"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"positions", " ", "=", " ", 
        RowBox[{"Position", "[", 
         RowBox[{"odes", ",", "X"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "positions", "]"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"positions", " ", "=", " ", 
           RowBox[{"Select", "[", 
            RowBox[{"positions", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "1"}], "&"}]}], 
            "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "positions", "]"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"positions", " ", "=", " ", 
           RowBox[{"positions", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Return", "[", 
           RowBox[{"odes", "[", 
            RowBox[{"[", "positions", "]"}], "]"}], "]"}], ";"}]}], " ", 
        "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", "}"}], "]"}], ";"}]}], " ", "\[IndentingNewLine]", 
     "]"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ODE", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"reaction__", "?", "ListQ"}], "}"}], ",", " ", 
      RowBox[{"{", "X__Symbol", "}"}]}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"ODE", "[", 
       RowBox[{
        RowBox[{"{", "reaction", "}"}], ",", "#"}], "]"}], "&"}], "/@", 
     RowBox[{"{", "X", "}"}]}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ODE", "[", "reaction_", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"interpret", "[", 
    RowBox[{"{", "reaction", "}"}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.551625656744907*^9, 3.551625784097083*^9}, {
   3.551625847038715*^9, 3.551625847720834*^9}, {3.5516264358901863`*^9, 
   3.551626516084025*^9}, {3.551626554896246*^9, 3.551626605869027*^9}, {
   3.551626673035226*^9, 3.551626676165062*^9}, 3.551626731439136*^9, {
   3.551626767918702*^9, 3.5516270063679*^9}, {3.551627045362142*^9, 
   3.551627084196308*^9}, {3.5554977794873533`*^9, 3.555497815734872*^9}, {
   3.555497948254888*^9, 3.5554979501434393`*^9}, 3.5554979953307457`*^9, {
   3.5554980322683983`*^9, 3.555498046560196*^9}, {3.555498081962515*^9, 
   3.555498102154443*^9}, {3.555498143879736*^9, 3.555498161742057*^9}, {
   3.555498223014284*^9, 3.555498309877*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["lowLevelReactions", "Section"],

Cell[BoxData[
 RowBox[{
  RowBox[{"lowLevelReactions", "[", 
   RowBox[{"reactions_", ",", " ", 
    RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"RATES", ",", " ", "r"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RATES", " ", "=", " ", 
      RowBox[{
       RowBox[{"rates", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"Options", "[", "rates", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"r", "=", 
      RowBox[{"xlr8r`Private`expandArrows", "/@", 
       RowBox[{"(", "reactions", ")"}]}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"r", "=", 
      RowBox[{"Join", "@@", "r"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", " ", "[", 
      RowBox[{
       RowBox[{"!", "RATES"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"r", "=", 
         RowBox[{"First", "/@", "r"}]}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "r", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["interpreted", "Section"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"interpreted", "[", 
    RowBox[{"list_", "?", "ListQ"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "h", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "list", "]"}], "\[NotEqual]", " ", "2"}], ",",
         " ", 
        RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"list", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[NotEqual]", " ", 
         RowBox[{"Lenth", "[", 
          RowBox[{"list", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", " ", 
        RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"h", "=", 
       RowBox[{"Union", "[", 
        RowBox[{"Head", "/@", 
         RowBox[{"First", "[", "list", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "h", "]"}], "\[NotEqual]", " ", "1"}], ",", 
        " ", 
        RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"h", "=", 
       RowBox[{"First", "[", "h", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"SameQ", "[", 
          RowBox[{"h", ",", "Equal"}], "]"}]}], ",", " ", 
        RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "True", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"interpreted", "[", "x_", "]"}], ":=", " ", "False"}], 
  ";"}]}], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["jacobianMatrix", "Section"],

Cell[BoxData[
 RowBox[{
  RowBox[{"jacobianMatrix", "[", 
   RowBox[{"r_", ",", 
    RowBox[{"t_:", "Global`t"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"eqs", ",", "vars", ",", " ", "dRow"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"interpreted", "[", "r", "]"}], ",", "\[IndentingNewLine]", 
       " ", 
       RowBox[{"eqs", "=", "r"}], ",", "\[IndentingNewLine]", 
       RowBox[{"eqs", "=", 
        RowBox[{"interpret", "[", "r", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"eqs", ",", "vars"}], "}"}], "=", "eqs"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"vars", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", "t", "]"}], "&"}], "/@", "vars"}]}], ";", 
     "\[IndentingNewLine]", 
     StyleBox[
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"in", " ", 
         RowBox[{"5.0", "++"}]}], ",", " ", 
        RowBox[{
         RowBox[{
         "equation", " ", "will", " ", "not", " ", "necessarily", " ", "be", 
          " ", "of", " ", "the", " ", "form", " ", 
          RowBox[{"x", "'"}]}], "=", 
         RowBox[{
          RowBox[{
          "stuff", " ", "but", " ", "may", " ", "be", " ", "an", " ", 
           "equation", " ", "will", " ", "be", " ", "an", " ", "expression", 
           " ", "involving", " ", 
           RowBox[{"x", "'"}]}], ":", " ", 
          RowBox[{"need", " ", "to", " ", "solve", " ", "for", " ", 
           RowBox[{
            RowBox[{"x", "'"}], "[", "t", "]"}]}]}]}]}], " ", "*)"}],
      FontColor->RGBColor[0, 0, 1]], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"eqs", "=", 
      RowBox[{"Last", "/@", 
       RowBox[{"Flatten", "[", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Solve", "[", 
            RowBox[{"#1", ",", 
             RowBox[{"D", "[", 
              RowBox[{"#2", ",", 
               RowBox[{"{", 
                RowBox[{"t", ",", "1"}], "}"}]}], "]"}]}], "]"}], "&"}], ",", 
          " ", 
          RowBox[{"{", 
           RowBox[{"eqs", ",", "vars"}], "}"}]}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dRow", "[", "equation_", "]"}], ":=", " ", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"equation", ",", 
           RowBox[{"{", 
            RowBox[{"#", ",", "1"}], "}"}]}], "]"}], "&"}], ",", " ", 
        "vars"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dRow", "/@", "eqs"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["simulation and plotting", "Section"],

Cell[CellGroupData[{

Cell["run", "Subsection"],

Cell["\<\
revised 5/14/08 v 0.86 to include options \[OpenCurlyDoubleQuote]Equations\
\[CloseCurlyDoubleQuote] to include DAE systems as well as reactions
revised 6/24/08 v0.65
(1) when checking for undefined variables, don't include system variables as \
a variables.
(2) new option \"BoundaryConditions\"-> {Z[t]->f[t]} means
- Z is to be held frozen during the interpret 
- Z[t] is to be replaced by the explicit expression f[t] in the solution
- note that it may be necessary to change the value of MaxStepFraction to a \
smaller value than 1/10 (the NDSolve default) if there are small pulses in \
the function of f[t]
\
\>", "Text",
 CellChangeTimes->{{3.42332272205638*^9, 3.423322909690707*^9}, {
  3.5460407324741983`*^9, 3.5460407641480722`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"debugRun", "=", "False"}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"run", "[", 
    RowBox[{"system_", ",", " ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"span", ",", "runspan", ",", "n", ",", " ", "sym"}], "}"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"span", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"List", "[", 
         RowBox[{
          RowBox[{"\"\<TimeSpan\>\"", "/.", 
           RowBox[{"{", "opt", "}"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{"\"\<TimeSpan\>\"", "\[Rule]", " ", 
            RowBox[{"{", "}"}]}], "}"}]}], "]"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"span", "\[Equal]", 
         RowBox[{"{", "}"}]}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{"span", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"List", "[", 
           RowBox[{
            RowBox[{"timeSpan", "/.", 
             RowBox[{"{", "opt", "}"}]}], "/.", 
            RowBox[{"Options", "[", "run", "]"}]}], "]"}], "]"}]}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Switch", "[", 
       RowBox[{
        RowBox[{"Length", "[", "span", "]"}], ",", "\[IndentingNewLine]", "0",
         ",", 
        RowBox[{
         RowBox[{"runspan", "=", 
          RowBox[{"{", 
           RowBox[{"0", ",", "100"}], "}"}]}], ";"}], " ", ",", 
        "\[IndentingNewLine]", "1", ",", " ", 
        RowBox[{
         RowBox[{"runspan", "=", 
          RowBox[{"Prepend", "[", 
           RowBox[{"span", ",", "0"}], "]"}]}], ";"}], ",", 
        "\[IndentingNewLine]", "2", ",", 
        RowBox[{
         RowBox[{"runspan", "=", "span"}], ";"}], ",", "\[IndentingNewLine]", 
        "3", ",", " ", 
        RowBox[{
         RowBox[{"runspan", "=", "span"}], ";"}], ",", "\[IndentingNewLine]", 
        "_", ",", " ", 
        RowBox[{
         RowBox[{"runspan", "=", " ", 
          RowBox[{"Take", "[", 
           RowBox[{"span", ",", "3"}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"debugRun", ",", " ", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<run:system:\>\"", ",", "system", ",", "\"\< runspan:\>\"", ",", 
          " ", "runspan", ",", "\"\< opt:\>\"", ",", 
          RowBox[{"{", "opt", "}"}]}], "]"}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"n", " ", "=", " ", 
       RowBox[{"run", "[", 
        RowBox[{"system", ",", "runspan", ",", " ", "opt"}], "]"}]}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "n", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"run", "[", 
     RowBox[{"system_", ",", " ", 
      RowBox[{"{", 
       RowBox[{"t_", ",", " ", "tstart_", ",", " ", "tend_"}], "}"}], ",", 
      " ", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
    RowBox[{"run", "[", 
     RowBox[{"system", ",", " ", 
      RowBox[{"{", 
       RowBox[{"tstart", ",", " ", "tend"}], "}"}], ",", " ", 
      RowBox[{"timeVariable", "\[Rule]", " ", "t"}], ",", " ", "opt"}], 
     "]"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"run", "[", 
    RowBox[{"sys_", ",", 
     RowBox[{"{", 
      RowBox[{"tstart_", ",", " ", "tend_"}], "}"}], ",", " ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ic", ",", " ", "r", ",", " ", "n", ",", " ", "eqs", ",", " ", "vars", 
       ",", " ", "nopt", ",", " ", "pvar", ",", " ", "time", ",", " ", 
       "icsGiven", ",", " ", "icsMissing", ",", "ruleToICequation", ",", " ", 
       "gpvar", ",", " ", "deindex", ",", " ", "deindexedvars", ",", " ", 
       "plt", ",", " ", "bc", ",", " ", "bcflag", ",", "bcvar", ",", " ", 
       "dbcvars", ",", " ", "fv", ",", " ", "dpr", ",", " ", "quiet", ",", 
       " ", "equations", ",", "xtraSpecies", ",", "system", ",", "sym", ",", 
       "initialRates", ",", " ", "trace", ",", " ", "tPrint"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"quiet", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<Quiet\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"Options", "[", "run", "]"}]}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<Debug\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"Options", "[", "run", "]"}]}], ",", " ", 
        RowBox[{"debugRun", "=", "True"}], ",", " ", 
        RowBox[{"debugRun", "=", "False"}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"trace", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<GoDebug\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<GoDebug\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";",
       " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tPrint", "[", "u___", "]"}], ":=", " ", 
       RowBox[{"If", "[", 
        RowBox[{"trace", ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<run: \>\"", ",", " ", "u"}], "]"}]}], "]"}]}], ";", 
      " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "check", " ", "to", " ", "see", " ", "if", " ", "there", " ", "are", 
        " ", "algebraic", " ", "equations", " ", "as", " ", "well", " ", "as",
         " ", "ODEs"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
      "tPrint", "[", "\"\<Collecting Species from \\\"Equations\\\".\>\"", 
       "]"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"equations", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<Equations\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Equations\>\"", "\[Rule]", " ", 
          RowBox[{"{", "}"}]}], "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"initialRates", "=", 
       RowBox[{
        RowBox[{"\"\<InitialRates\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<InitialRates\>\"", "\[Rule]", " ", 
          RowBox[{"{", "}"}]}], "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"xtraSpecies", "=", 
       RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "equations", "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"xtraSpecies", "=", 
          RowBox[{"Head", "/@", 
           RowBox[{"First", "/@", "equations"}]}]}], ";"}]}], " ", 
       "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dpr", "[", "x___", "]"}], ":=", " ", 
       RowBox[{"If", "[", 
        RowBox[{"debugRun", ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<run: \>\"", ",", " ", "x"}], "]"}]}], "]"}]}], ";", 
      " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"deindex", "[", 
        RowBox[{"a_", "[", "b___", "]"}], "]"}], ":=", " ", 
       RowBox[{"deindex", "[", "a", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"deindex", "[", "a_", "]"}], ":=", " ", "a"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"time", " ", "=", " ", 
       RowBox[{
        RowBox[{"timeVariable", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"Options", "[", "run", "]"}]}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"bc", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<BoundaryConditions\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<BoundaryConditions\>\"", "\[Rule]", " ", 
          RowBox[{"{", "}"}]}], "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"bcflag", " ", "=", " ", 
       RowBox[{
        RowBox[{"Length", "[", "bc", "]"}], ">", "0"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "make", " ", "sure", " ", "boundary", " ", "conditions", " ", "are", 
        " ", "included", " ", "in", " ", "frozen", " ", "variables"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "xlr8r`frozen", " ", "is", " ", "for", " ", "backward", " ", 
        "compatibility"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"tPrint", "[", "\"\<Checking for Frozen variables\>\"", "]"}], 
      ";", " ", "\[IndentingNewLine]", 
      RowBox[{"fv", "=", 
       RowBox[{
        RowBox[{"\"\<Frozen\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Frozen\>\"", "\[Rule]", " ", 
          RowBox[{"{", "}"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"fv", "\[Equal]", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"fv", "=", 
         RowBox[{
          RowBox[{"frozen", "/.", 
           RowBox[{"{", "opt", "}"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{"frozen", "\[Rule]", " ", 
            RowBox[{"{", "}"}]}], "}"}]}]}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"bcflag", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"bcvar", " ", "=", " ", 
          RowBox[{"First", "/@", "bc"}]}], ";", " ", "\[IndentingNewLine]", 
         RowBox[{"bcvar", " ", "=", " ", 
          RowBox[{"deindex", "/@", "bcvar"}]}], ";", " ", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"dpr", "[", 
          RowBox[{"\"\<bc: \>\"", ",", " ", "bcvar"}], "]"}], ";", " ", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"fv", " ", "=", " ", 
          RowBox[{"Union", "[", 
           RowBox[{"Join", "[", 
            RowBox[{"fv", ",", " ", "bcvar"}], "]"}], "]"}]}], ";", "  ", 
         "\[IndentingNewLine]", 
         RowBox[{"dpr", "[", 
          RowBox[{"\"\<fv: \>\"", ",", " ", "fv"}], "]"}], ";"}]}], " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"if", " ", "necessary"}], ",", " ", 
        RowBox[{
        "convert", " ", "the", " ", "reactions", " ", "to", " ", "ODES"}]}], 
       " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
      "tPrint", "[", 
       "\"\<Checking to see if system is already interpreted.\>\"", "]"}], 
      ";", " ", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"interpreted", "[", "sys", "]"}], ",", " ", 
        RowBox[{"system", "=", "sys"}], ",", " ", 
        RowBox[{"system", "=", 
         RowBox[{"interpret", "[", 
          RowBox[{"sys", ",", " ", 
           RowBox[{"\"\<Frozen\>\"", "\[Rule]", " ", "fv"}]}], "]"}]}]}], 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dpr", "[", 
       RowBox[{"\"\<interpretd system: \>\"", ",", " ", "system"}], "]"}], 
      ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "make", " ", "sure", " ", "to", " ", "remove", " ", "any", " ", 
         "boundary", " ", "conditions", " ", "from", " ", "the", " ", 
         "solve"}], "-", 
        RowBox[{"for", " ", "variables"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
      "tPrint", "[", "\"\<Removing xlr8r boundary conditions\>\"", "]"}], ";",
       " ", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"bcflag", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"eqs", ",", " ", "vars"}], "}"}], " ", "=", " ", 
          "system"}], ";", "\[IndentingNewLine]", 
         RowBox[{"vars", " ", "=", " ", 
          RowBox[{"Complement", "[", 
           RowBox[{"vars", ",", " ", "bcvar"}], "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"dbcvars", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"#", "[", "time", "]"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"time", ",", " ", "1"}], "}"}]}], "]"}], "&"}], "/@", 
           "bcvar"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"eqs", " ", "=", " ", 
          RowBox[{"Select", "[", 
           RowBox[{"eqs", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"MemberQ", "[", 
               RowBox[{"dbcvars", ",", 
                RowBox[{"First", "[", "#", "]"}]}], "]"}]}], "&"}]}], 
           "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"eqs", " ", "=", " ", 
          RowBox[{"eqs", "/.", "bc"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"system", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{"eqs", ",", " ", "vars"}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"dpr", "[", 
          RowBox[{"\"\<revised system: \>\"", ",", " ", "system"}], "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"tPrint", "[", "\"\<Collecting IC, Parameters\>\"", "]"}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{"ic", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<IC\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<IC\>\"", "\[Rule]", 
          RowBox[{"{", "}"}]}], "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ic", "\[Equal]", 
         RowBox[{"{", "}"}]}], ",", " ", 
        RowBox[{"ic", "=", 
         RowBox[{
          RowBox[{"initialConditions", "/.", 
           RowBox[{"{", "opt", "}"}]}], "/.", 
          RowBox[{"Options", "[", "run", "]"}]}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"r", "=", " ", 
       RowBox[{
        RowBox[{"\"\<Parameters\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Parameters\>\"", "\[Rule]", " ", 
          RowBox[{"{", "}"}]}], "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"r", "\[Equal]", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"r", "=", 
         RowBox[{
          RowBox[{"rates", "/.", 
           RowBox[{"{", "opt", "}"}]}], "/.", 
          RowBox[{"Options", "[", "run", "]"}]}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"vars", " ", "=", " ", 
       RowBox[{"system", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"vars", " ", "=", " ", 
       RowBox[{"Union", "[", 
        RowBox[{"Join", "[", 
         RowBox[{"vars", ",", " ", "xtraSpecies"}], "]"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      StyleBox[
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "convert", " ", "any", " ", "ics", " ", "that", " ", "are", " ", 
          "given", " ", "as", " ", "rules", " ", "into", " ", "NDSolve"}], 
         "-", 
         RowBox[{"compatible", " ", "form"}]}], " ", "*)"}],
       FontWeight->"Plain"], "\[IndentingNewLine]", 
      StyleBox["\[IndentingNewLine]",
       FontWeight->"Plain"], 
      StyleBox[
       RowBox[{
        RowBox[{"ruleToICequation", "[", 
         RowBox[{"Rule", "[", 
          RowBox[{"a_", ",", "b_"}], "]"}], "]"}], ":=", " ", 
        RowBox[{"Equal", "[", 
         RowBox[{
          RowBox[{"a", "[", "tstart", "]"}], ",", " ", "b"}], "]"}]}],
       FontWeight->"Bold"], 
      StyleBox[";",
       FontWeight->"Bold"], 
      StyleBox["\[IndentingNewLine]",
       FontWeight->"Bold"], 
      StyleBox[
       RowBox[{
        RowBox[{"ruleToICequation", "[", "a_", "]"}], ":=", " ", "a"}],
       FontWeight->"Bold"], 
      StyleBox[";",
       FontWeight->"Bold"], 
      StyleBox["\[IndentingNewLine]",
       FontWeight->"Bold"], 
      StyleBox[
       RowBox[{"ic", " ", "=", " ", 
        RowBox[{"ruleToICequation", "/@", "ic"}]}],
       FontWeight->"Bold"], 
      StyleBox[";",
       FontWeight->"Bold"], 
      StyleBox["\[IndentingNewLine]",
       FontWeight->"Bold"], 
      StyleBox["\[IndentingNewLine]",
       FontWeight->"Bold"], 
      RowBox[{
       StyleBox["dpr",
        FontWeight->"Bold"], "[", 
       RowBox[{
       "\"\<:ic:\>\"", ",", "ic", ",", "\"\<\\nr:\>\"", ",", " ", "r", ",", 
        "\"\<\\nvars:\>\"", ",", "vars"}], "]"}], ";", 
      StyleBox["\[IndentingNewLine]",
       FontWeight->"Bold"], "\[IndentingNewLine]", 
      StyleBox[
       RowBox[{"(*", " ", 
        RowBox[{
        "determine", " ", "missing", " ", "initial", " ", "conditions", " ", 
         "and", " ", "set", " ", "them", " ", "to", " ", "zero"}], " ", "*)"}],
       FontWeight->"Plain"], 
      StyleBox["\[IndentingNewLine]",
       FontWeight->"Bold"], 
      StyleBox["\[IndentingNewLine]",
       FontWeight->"Bold"], 
      RowBox[{"icsGiven", "=", 
       RowBox[{"Head", "/@", 
        RowBox[{"First", "/@", "ic"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dpr", "[", 
       RowBox[{"\"\<icsGiven: \>\"", ",", " ", "icsGiven"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"tPrint", "[", "\"\<Checking for missing IC\>\"", "]"}], ";", 
      " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"icsMissing", "=", 
       RowBox[{"Complement", "[", 
        RowBox[{"vars", ",", " ", "icsGiven"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dpr", "[", 
       RowBox[{"\"\<icsMissing: \>\"", ",", " ", "icsMissing"}], "]"}], ";", 
      " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "icsMissing", "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", "quiet"}], ",", " ", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{
             RowBox[{"\"\<Warning: \>\"", "//", "boldRed"}], ",", 
             RowBox[{
             "\"\<Initial conditions are missing (and assumed to be zero) for \
the following variables: \>\"", "//", "boldBlack"}], ",", " ", 
             RowBox[{"icsMissing", "//", "boldBlue"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"icsMissing", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Equal", "[", 
             RowBox[{
              RowBox[{"#", "[", "tstart", "]"}], ",", " ", "0"}], "]"}], 
            "&"}], "/@", "icsMissing"}]}], ";", " ", "\[IndentingNewLine]", 
         RowBox[{"ic", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"ic", ",", " ", "icsMissing"}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      StyleBox[
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"create", " ", "the", " ", "NDSolve"}], "-", 
         RowBox[{"compatible", " ", "system"}]}], " ", "*)"}],
       FontWeight->"Plain"], 
      StyleBox[" ",
       FontWeight->"Plain"], "\[IndentingNewLine]", 
      RowBox[{"tPrint", "[", "\"\<Building system.\>\"", "]"}], ";", " ", 
      StyleBox["\[IndentingNewLine]",
       FontWeight->"Plain"], 
      RowBox[{"eqs", " ", "=", " ", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"system", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", " ", "equations", ",", " ", 
          "ic", ",", "initialRates"}], "]"}], "/.", "r"}]}], ";", 
      StyleBox["\[IndentingNewLine]",
       FontWeight->"Plain"], 
      StyleBox[
       RowBox[{"dpr", "[", 
        RowBox[{"\"\<eqs: \>\"", ",", " ", "eqs"}], "]"}],
       FontWeight->"Plain"], 
      StyleBox[";",
       FontWeight->"Plain"], 
      StyleBox[" ",
       FontWeight->"Plain"], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      StyleBox[
       RowBox[{"(*", " ", 
        RowBox[{"check", " ", "for", " ", "undefined", " ", 
         RowBox[{
          RowBox[{"variables", "/", "parameters"}], "/", "constants"}]}], " ",
         "*)"}],
       FontWeight->"Plain"], 
      StyleBox[" ",
       FontWeight->"Plain"], "\[IndentingNewLine]", 
      StyleBox["\[IndentingNewLine]",
       FontWeight->"Plain"], 
      RowBox[{"sym", " ", "=", 
       RowBox[{"getSymbols", "[", "eqs", "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"dpr", "[", 
       RowBox[{"\"\<sym(1):\>\"", ",", " ", "sym"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"deindexedvars", "=", 
       RowBox[{"Union", "[", 
        RowBox[{"deindex", "/@", "vars"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"sym", " ", "=", " ", 
       RowBox[{"Complement", "[", 
        RowBox[{"sym", ",", " ", "vars", ",", " ", "deindexedvars", ",", 
         RowBox[{"{", "time", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dpr", "[", 
       RowBox[{"\"\<sym(2):\>\"", ",", " ", "sym"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"6.24", "/", "08"}], " ", "remove", " ", "system", " ", 
        "context", " ", "variables", " ", "like", " ", "If", " ", "and", " ", 
        "Which"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      
      RowBox[{"sym", " ", "=", " ", 
       RowBox[{"Select", "[", 
        RowBox[{"sym", ",", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Context", "[", "#", "]"}], "\[NotEqual]", " ", 
            "\"\<System`\>\""}], ")"}], "&"}]}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", " ", 
      RowBox[{"dpr", "[", 
       RowBox[{"\"\<sym(3): \>\"", ",", " ", "sym"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "sym", "]"}], ">", "0"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", "quiet"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{
             RowBox[{"\"\<Warning: \>\"", "//", "boldRed"}], ",", 
             RowBox[{
             "\"\< The following symbols are undefined (and assumed to be \
equal to one (1)): \>\"", "//", "boldBlack"}], ",", " ", 
             RowBox[{"sym", "//", "boldBlue"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
         RowBox[{"sym", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Rule", "[", 
             RowBox[{"#", ",", "1"}], "]"}], "&"}], "/@", "sym"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"eqs", " ", "=", " ", 
          RowBox[{"eqs", "/.", "sym"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         StyleBox[
          RowBox[{"dpr", "[", 
           RowBox[{"\"\<sym(4):\>\"", ",", " ", "sym"}], "]"}],
          FontWeight->"Plain"], 
         StyleBox[";",
          FontWeight->"Plain"], 
         StyleBox[" ",
          FontWeight->"Plain"], 
         StyleBox["\[IndentingNewLine]",
          FontWeight->"Plain"], 
         StyleBox[
          RowBox[{"dpr", "[", 
           RowBox[{"\"\<eqs(2): \>\"", ",", " ", "eqs"}], "]"}],
          FontWeight->"Plain"], 
         StyleBox[";",
          FontWeight->"Plain"]}]}], 
       StyleBox[" ",
        FontWeight->"Plain"], "\[IndentingNewLine]", "]"}], ";", 
      StyleBox["\[IndentingNewLine]",
       FontWeight->"Plain"], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      StyleBox[
       RowBox[{"(*", " ", 
        RowBox[{
        "filter", " ", "NDSolve", " ", "options", " ", "and", " ", "solve", 
         " ", "the", " ", "system"}], " ", "*)"}],
       FontWeight->"Plain"], 
      StyleBox[" ",
       FontWeight->"Plain"], 
      StyleBox["\[IndentingNewLine]",
       FontWeight->"Plain"], 
      RowBox[{"Clear", "[", "system", "]"}], ";", " ", "\[IndentingNewLine]", 
      
      RowBox[{"dpr", "[", "\"\<NDSolve.\>\"", "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"nopt", "=", 
          RowBox[{"MyFilterOptions", "[", 
           RowBox[{"NDSolve", ",", "opt"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"n", "=", 
          RowBox[{"Check", "[", 
           RowBox[{
            RowBox[{"Global`$$$SOLUTION", "=", 
             RowBox[{"NDSolve", "[", 
              RowBox[{"eqs", ",", " ", "vars", ",", " ", 
               RowBox[{"{", 
                RowBox[{"time", ",", " ", "tstart", ",", " ", "tend"}], "}"}],
                ",", " ", "nopt"}], "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "Print", "[", 
               "\"\<Unable to continue full simulation. A partial solutian \
**MAY** have been saved to the variable $$$SOLUTION. \>\"", "]"}], ";", 
              RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}]}], ";"}]}], " ", 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"tPrint", "[", "\"\<Checking for Plotting.\>\"", "]"}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", "plotflag", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"plotflag", " ", "=", " ", 
          RowBox[{
           RowBox[{"\"\<plot\>\"", "/.", 
            RowBox[{"{", "opt", "}"}]}], "/.", 
           RowBox[{"Options", "[", "run", "]"}]}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", "plotflag"}], ",", " ", 
           RowBox[{"plotflag", " ", "=", 
            RowBox[{
             RowBox[{"plot", "/.", 
              RowBox[{"{", "opt", "}"}]}], "/.", 
             RowBox[{"Options", "[", "run", "]"}]}]}]}], "]"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"plotflag", ",", "\[IndentingNewLine]", 
           StyleBox[
            RowBox[{"(*", " ", 
             RowBox[{
             "if", " ", "a", " ", "plot", " ", "is", " ", "requested"}], " ", 
             "*)"}],
            FontWeight->"Plain"], 
           StyleBox[" ",
            FontWeight->"Plain"], 
           StyleBox["\[IndentingNewLine]",
            FontWeight->"Plain"], "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"pvar", " ", "=", " ", 
             RowBox[{
              RowBox[{"\"\<plotVariables\>\"", "/.", 
               RowBox[{"{", "opt", "}"}]}], "/.", 
              RowBox[{"Options", "[", "run", "]"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "pvar", "]"}], "<", "1"}], ",", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"pvar", " ", "=", " ", 
               RowBox[{
                RowBox[{"plotVariables", "/.", 
                 RowBox[{"{", "opt", "}"}]}], "/.", 
                RowBox[{"Options", "[", "run", "]"}]}]}]}], "]"}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"SameQ", "[", 
                RowBox[{"pvar", ",", "None"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", "pvar", "]"}], ">", "0"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"plt", "=", " ", 
                  RowBox[{"runPlot", "[", 
                   RowBox[{"n", ",", " ", "pvar", ",", "opt"}], "]"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"plt", "=", 
                  RowBox[{"runPlot", "[", "n", "]"}]}]}], " ", 
                "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"$VersionNumber", ">", "5.5"}], ",", " ", 
                 RowBox[{"Print", "[", "plt", "]"}]}], "]"}], ";"}]}], " ", 
             "\[IndentingNewLine]", " ", "]"}], ";", " ", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            StyleBox[
             RowBox[{"(*", " ", 
              RowBox[{
              "if", " ", "a", " ", "gridPlot", " ", "is", " ", "requested"}], 
              " ", "*)"}],
             FontWeight->"Plain"], "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"gpvar", " ", "=", " ", 
             RowBox[{
              RowBox[{"\"\<gridPlotVariables\>\"", "/.", 
               RowBox[{"{", "opt", "}"}]}], "/.", 
              RowBox[{"Options", "[", "run", "]"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "gpvar", "]"}], "<", "1"}], ",", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"gpvar", " ", "=", " ", 
               RowBox[{
                RowBox[{"gridPlotVariables", "/.", 
                 RowBox[{"{", "opt", "}"}]}], "/.", 
                RowBox[{"Options", "[", "run", "]"}]}]}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"SameQ", "[", 
                RowBox[{"gpvar", ",", "None"}], "]"}]}], ",", " ", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"SameQ", "[", 
                  RowBox[{"gpvar", ",", "All"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"plt", "=", 
                   RowBox[{"gridPlot", "[", 
                    RowBox[{"n", ",", "All", ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"tstart", ",", " ", "tend"}], "}"}], ",", "opt"}],
                     "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"plt", "=", 
                   RowBox[{"gridPlot", "[", 
                    RowBox[{"n", ",", 
                    RowBox[{"Flatten", "[", "gpvar", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"tstart", ",", " ", "tend"}], "}"}], ",", "opt"}],
                     "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"$VersionNumber", ">", "5.5"}], ",", " ", 
                 RowBox[{"Print", "[", "plt", "]"}]}], "]"}], ";"}]}], " ", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}]}], 
          " ", "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      StyleBox[
       RowBox[{"(*", " ", 
        RowBox[{
        "return", " ", "a", " ", "list", " ", "of", " ", "interpolating", " ",
          "functions"}], " ", "*)"}],
       FontWeight->"Plain"], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "n", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.401034378244686*^9, 3.401034379898695*^9}, {
   3.4014672936652813`*^9, 3.401467321875742*^9}, {3.401467426998128*^9, 
   3.401467444919738*^9}, {3.401467655024768*^9, 3.401467741185384*^9}, {
   3.401467797078967*^9, 3.401467824790299*^9}, {3.4014678967088833`*^9, 
   3.401467962426544*^9}, {3.423319104479542*^9, 3.423319104896079*^9}, {
   3.423319209246215*^9, 3.423319226021582*^9}, {3.423319347914136*^9, 
   3.42331935299017*^9}, {3.423319425824779*^9, 3.42331945960708*^9}, {
   3.423319576943146*^9, 3.423319580896735*^9}, {3.423320068753934*^9, 
   3.423320177430798*^9}, {3.423320209641571*^9, 3.423320426394809*^9}, {
   3.423320485194029*^9, 3.423320495200913*^9}, {3.423320541388717*^9, 
   3.423320545553439*^9}, {3.423320585939894*^9, 3.423320589920229*^9}, {
   3.423320624550108*^9, 3.423320668352863*^9}, {3.423320702508777*^9, 
   3.423320783232951*^9}, {3.423320858558548*^9, 3.4233210420340242`*^9}, {
   3.423321789894212*^9, 3.42332185162388*^9}, {3.423321892091204*^9, 
   3.423322089501207*^9}, {3.423322148451458*^9, 3.42332215567969*^9}, {
   3.423322598198266*^9, 3.423322599337743*^9}, {3.423322707084212*^9, 
   3.42332270813855*^9}, {3.426881313508946*^9, 3.426881414764921*^9}, {
   3.426881486091803*^9, 3.426881591513854*^9}, {3.4723535788994503`*^9, 
   3.472353581042157*^9}, {3.4724154202729483`*^9, 3.472415476454674*^9}, {
   3.472415525777479*^9, 3.472415542742894*^9}, {3.472415591068687*^9, 
   3.472415592603279*^9}, {3.472415890651127*^9, 3.472415902344767*^9}, {
   3.546040394681448*^9, 3.546040433189562*^9}, {3.546040468236051*^9, 
   3.546040512190065*^9}, {3.54604057833153*^9, 3.546040623532583*^9}, {
   3.547936726045227*^9, 3.547936726809943*^9}, {3.547936761885322*^9, 
   3.547936762440548*^9}, {3.547936798561211*^9, 3.547936800796698*^9}, {
   3.5479433224149017`*^9, 3.547943363456644*^9}, {3.5479434791057796`*^9, 
   3.547943482802661*^9}, {3.5479449219499903`*^9, 3.5479449527359962`*^9}, 
   3.547945020809217*^9, {3.54794524243257*^9, 3.547945333670393*^9}, {
   3.547945379885001*^9, 3.5479455900651712`*^9}, {3.547946064139381*^9, 
   3.547946107536707*^9}, {3.548022805660247*^9, 3.5480230925166893`*^9}, {
   3.560873371903351*^9, 3.5608733926010637`*^9}, {3.560873674483481*^9, 
   3.560873728324396*^9}, {3.56087426959109*^9, 3.560874272550848*^9}, {
   3.5608743042348833`*^9, 3.560874381250719*^9}, {3.56087449176291*^9, 
   3.5608744987112837`*^9}, {3.560874545481998*^9, 3.560874559379395*^9}, {
   3.5608796071874533`*^9, 3.5608796083961353`*^9}, {3.5775716326368647`*^9, 
   3.577571642020344*^9}, {3.577571712077942*^9, 3.577571719093094*^9}, {
   3.5775718226713676`*^9, 3.577571842814509*^9}, {3.577572008716178*^9, 
   3.5775720295617113`*^9}, 3.587658928417164*^9, 3.58765896146766*^9, {
   3.587659136015254*^9, 3.5876591551337337`*^9}, 3.5876602090273867`*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["runPlot", "Subsection"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"debugRunPlot", "=", "False"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"runPlot", "[", 
      RowBox[{"sys_", ",", " ", 
       RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "vars", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"vars", "=", 
         RowBox[{"First", "/@", 
          RowBox[{"Flatten", "[", "sys", "]"}]}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"debugRunPlot", ",", " ", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<runPlot(1): vars: \>\"", ",", " ", "vars", ",", " ", 
            "\"\< {opt}:\>\"", ",", " ", 
            RowBox[{"{", "opt", "}"}]}], "]"}]}], "]"}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"runPlot", "[", 
          RowBox[{"sys", ",", "vars", ",", "opt"}], "]"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"runPlot", "[", 
      RowBox[{"sys_", ",", " ", 
       RowBox[{"{", "vars___", "}"}], ",", " ", 
       RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "n", ",", "arg", ",", " ", "tstart", ",", " ", "tend", ",", "p"}], 
        "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       StyleBox[
        RowBox[{"(*", " ", 
         RowBox[{"determine", " ", "time", " ", 
          RowBox[{"span", ":", " ", 
           RowBox[{"plot", " ", "everything"}]}]}], " ", "*)"}],
        FontWeight->"Plain"], 
       StyleBox[" ",
        FontWeight->"Plain"], 
       StyleBox["\[IndentingNewLine]",
        FontWeight->"Plain"], 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{"debugRunPlot", ",", " ", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<runPlot(2): {vars}: \>\"", ",", " ", 
            RowBox[{"{", "vars", "}"}], ",", " ", "\"\< {opt}: \>\"", ",", 
            " ", 
            RowBox[{"{", "opt", "}"}]}], "]"}]}], "]"}], ";", " ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"args", "[", 
          RowBox[{"a_", "[", "b___", "]"}], "]"}], ":=", " ", 
         RowBox[{
          RowBox[{"{", "b", "}"}], "//", "Flatten"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"args", "[", "a___", "]"}], ":=", " ", 
         RowBox[{
          RowBox[{"{", "a", "}"}], "//", "Flatten"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"n", "=", 
         RowBox[{"Last", "/@", 
          RowBox[{"Flatten", "[", "sys", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"n", "=", 
         RowBox[{"args", "/@", "n"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"n", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Take", "[", 
              RowBox[{"#", ",", "2"}], "]"}], "&"}], "/@", "n"}], ")"}], "//",
           "Union"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tstart", "=", 
         RowBox[{"Max", "[", 
          RowBox[{"First", "/@", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tend", "=", 
         RowBox[{"Min", "[", 
          RowBox[{"Last", "/@", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"tstart", "\[GreaterEqual]", " ", "tend"}], ",", " ", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<Warning: runPlot: unable to plot results. Incompatible time \
domains.\>\"", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"p", "=", 
         RowBox[{"runPlot", "[", 
          RowBox[{"sys", ",", " ", 
           RowBox[{"{", "vars", "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"tstart", ",", "tend"}], "}"}], ",", "opt"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "p", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"runPlot", "[", 
      RowBox[{"sys_", ",", " ", "var_", ",", 
       RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{"debugRunPlot", ",", " ", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<runPlot(3): {vars}: \>\"", ",", " ", 
            RowBox[{"{", "vars", "}"}], ",", " ", "\"\< {opt}: \>\"", ",", 
            " ", 
            RowBox[{"{", "opt", "}"}]}], "]"}]}], "]"}], ";", " ", 
        "\[IndentingNewLine]", " ", 
        RowBox[{"runPlot", "[", 
         RowBox[{"sys", ",", 
          RowBox[{"{", "var", "}"}], ",", "opt"}], "]"}]}]}], "]"}]}], ";"}], 
   " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"runPlot", "[", 
      RowBox[{"sys_", ",", " ", 
       RowBox[{"{", "varseq___", "}"}], ",", " ", 
       RowBox[{"{", " ", 
        RowBox[{"tstart_", ",", " ", "tend_"}], "}"}], ",", " ", 
       RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "plot", ",", " ", "varsRequested", ",", " ", "saveContext", ",", " ", 
         "n", ",", "nd", ",", " ", "varsAvailable", ",", " ", "missingVars", 
         ",", " ", "g", ",", " ", "v"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{"debugRunPlot", ",", " ", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<runPlot(4): {varseq}: \>\"", ",", " ", 
            RowBox[{"{", "varseq", "}"}], ",", " ", 
            "\"\< {tstart, tend}=\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"tstart", ",", " ", "tend"}], "}"}], ",", " ", 
            "\"\< {opt}: \>\"", ",", " ", 
            RowBox[{"{", "opt", "}"}]}], "]"}]}], "]"}], ";", " ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"plot", "[", "x___", "]"}], ":=", " ", "XPlot"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"check", " ", "for", " ", "missing", " ", "variables"}], " ",
          "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"varsRequested", " ", "=", " ", 
         RowBox[{"{", "varseq", "}"}]}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"n", "=", 
         RowBox[{"Flatten", "[", "sys", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"varsAvailable", " ", "=", " ", 
         RowBox[{"First", "/@", "n"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"missingVars", " ", "=", " ", 
         RowBox[{"Complement", "[", 
          RowBox[{"varsRequested", ",", " ", "varsAvailable"}], "]"}]}], ";", 
        " ", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "missingVars", "]"}], ">", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
             RowBox[{"\"\<Warning: \>\"", "//", "boldRed"}], ",", " ", 
             RowBox[{
             "\"\<The requested plot variables: \>\"", "//", "boldBlack"}], 
             ",", " ", 
             RowBox[{"missingVars", "//", "boldBlue"}], ",", 
             RowBox[{
             "\"\< can not be found to be plotted.\>\"", "//", 
              "boldBlack"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
           RowBox[{"varsRequested", "=", 
            RowBox[{"Complement", "[", 
             RowBox[{"varsRequested", ",", " ", "missingVars"}], "]"}]}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", " ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "varsRequested", "]"}], ">", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"saveContext", "=", "MathSBML`Private`$SBML$Context"}], 
            ";", " ", "\[IndentingNewLine]", 
            RowBox[{"MathSBML`Private`$SBML$Context", "=", "\"\<None`\>\""}], 
            ";"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"nd", " ", "=", " ", 
            RowBox[{"Flatten", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
           
           RowBox[{
            RowBox[{"{", 
             RowBox[{"v", ",", "nd"}], "}"}], "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"nd", "/.", 
               RowBox[{"{", 
                RowBox[{"Rule", "\[Rule]", " ", "List"}], "}"}]}], ")"}], "//",
              "Transpose"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "The", " ", "\"\<Hold\>\"", " ", "is", " ", "so", " ", "that", 
             " ", "things", " ", "like", " ", 
             RowBox[{"A", "\[Diamond]", "B"}], " ", "become", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"A", "\[Diamond]", "B"}], ")"}], "[", "t", "]"}], " ", 
             "instead", " ", "of", " ", 
             RowBox[{"A", "\[Diamond]", 
              RowBox[{"(", 
               RowBox[{"B", "[", "t", "]"}], ")"}]}]}], "*)"}], 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"v", "=", 
            RowBox[{
             RowBox[{"functionate", "[", 
              RowBox[{"Hold", "/@", "v"}], "]"}], "/.", 
             RowBox[{"{", 
              RowBox[{"Hold", "\[Rule]", " ", "Identity"}], "}"}]}]}], ";", 
           " ", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"debugRunPlot", ",", " ", 
             RowBox[{"Print", "[", 
              RowBox[{"\"\<runPlot: v: \>\"", ",", " ", "v"}], "]"}]}], "]"}],
            ";", " ", "\[IndentingNewLine]", 
           RowBox[{"nd", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"Rule", "@@", "#"}], "&"}], "/@", 
             RowBox[{"Transpose", "[", 
              RowBox[{"{", 
               RowBox[{"v", ",", " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "[", "Global`t", "]"}], "&"}], "/@", "nd"}]}], 
               "}"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"debugRunPlot", ",", " ", 
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<runPlot: calling XPlot: varsRequested: \>\"", ",", " ", 
               "varsRequested", ",", " ", "\"\< nd=\>\"", ",", " ", "nd"}], 
              "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"g", "=", 
            RowBox[{"XPlot", "[", 
             RowBox[{
              RowBox[{"InterpolationSet", "[", "nd", "]"}], ",", " ", 
              "varsRequested", ",", " ", 
              RowBox[{"{", 
               RowBox[{"tstart", ",", " ", "tend"}], "}"}], ",", " ", "opt"}],
              "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"MathSBML`Private`$SBML$Context", "=", "saveContext"}], 
            ";"}], " ", "*)"}], "\[IndentingNewLine]", ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
             RowBox[{"\"\<Error: runPlot: \>\"", "//", "boldRed"}], ",", 
             RowBox[{
             "\"\< at least one valid variable must be specified to generate \
a plot.\>\"", "//", "boldBlack"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
           RowBox[{"g", "=", 
            RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        " ", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "g", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"runPlot", "[", 
      RowBox[{"sys_", ",", "var_", ",", 
       RowBox[{"{", 
        RowBox[{"tstart_", ",", " ", "tend_"}], "}"}], ",", " ", 
       RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
     RowBox[{"runPlot", "[", 
      RowBox[{"sys", ",", " ", 
       RowBox[{"{", "var", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"tstart", ",", " ", "tend"}], "}"}], ",", " ", "opt"}], 
      "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.401036386318227*^9, 3.401036422951722*^9}, {
   3.4010364652582893`*^9, 3.401036505783559*^9}, {3.401036553063322*^9, 
   3.4010365738771963`*^9}, {3.40103661756152*^9, 3.4010366514242983`*^9}, {
   3.4010366877263002`*^9, 3.401036729125085*^9}, {3.401036766189177*^9, 
   3.401036769317238*^9}, {3.401037841679563*^9, 3.401038036970039*^9}, {
   3.401038115173394*^9, 3.401038158650941*^9}, {3.401038205119738*^9, 
   3.4010382796331863`*^9}, {3.401038324325431*^9, 3.401038356811582*^9}, {
   3.4010404095791893`*^9, 3.401040413079453*^9}, {3.401040513859469*^9, 
   3.401040516250766*^9}, {3.4014674601013737`*^9, 3.4014674613885117`*^9}, {
   3.4014679938953543`*^9, 3.401467994825211*^9}, {3.442611678800123*^9, 
   3.442611681091867*^9}, {3.442611779017083*^9, 3.442611805088204*^9}, {
   3.442612004105628*^9, 3.442612056225772*^9}, {3.442612091807433*^9, 
   3.442612128297386*^9}, {3.587658963266745*^9, 3.587658964195615*^9}, {
   3.5876591399786263`*^9, 3.587659158701193*^9}, 3.5876595156528187`*^9, {
   3.587687314126683*^9, 3.587687314837489*^9}, {3.5877288970891247`*^9, 
   3.587728920442672*^9}, {3.587934327629478*^9, 3.5879343413733387`*^9}, {
   3.5879344113583603`*^9, 3.5879344178721037`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["gridPlot", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"gridPlot", "[", 
    RowBox[{"sys_", ",", " ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "vars", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"vars", "=", 
       RowBox[{"First", "/@", 
        RowBox[{"Flatten", "[", "sys", "]"}]}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"gridPlot", "[", 
        RowBox[{"sys", ",", "vars", ",", "opt"}], "]"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"gridPlot", "[", 
     RowBox[{"sys_", ",", " ", 
      RowBox[{"{", "vars___", "}"}], ",", " ", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "n", ",", "arg", ",", " ", "tstart", ",", " ", "tend", ",", "p"}], 
       "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      StyleBox[
       RowBox[{"(*", " ", 
        RowBox[{"determine", " ", "time", " ", 
         RowBox[{"span", ":", " ", 
          RowBox[{"plot", " ", "everything"}]}]}], " ", "*)"}],
       FontWeight->"Plain"], 
      StyleBox[" ",
       FontWeight->"Plain"], 
      StyleBox["\[IndentingNewLine]",
       FontWeight->"Plain"], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"args", "[", 
         RowBox[{"a_", "[", "b___", "]"}], "]"}], ":=", " ", 
        RowBox[{
         RowBox[{"{", "b", "}"}], "//", "Flatten"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"args", "[", "a___", "]"}], ":=", " ", 
        RowBox[{
         RowBox[{"{", "a", "}"}], "//", "Flatten"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"n", "=", 
        RowBox[{"Last", "/@", 
         RowBox[{"Flatten", "[", "sys", "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"n", "=", 
        RowBox[{"args", "/@", "n"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"n", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Take", "[", 
             RowBox[{"#", ",", "2"}], "]"}], "&"}], "/@", "n"}], ")"}], "//", 
         "Union"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"tstart", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"First", "/@", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"tend", "=", 
        RowBox[{"Min", "[", 
         RowBox[{"Last", "/@", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"tstart", "\[GreaterEqual]", " ", "tend"}], ",", " ", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<Warning: gridPlot: unable to plot results. Incompatible time \
domains.\>\"", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
        ";", " ", "\[IndentingNewLine]", 
       RowBox[{"p", "=", 
        RowBox[{"gridPlot", "[", 
         RowBox[{"sys", ",", " ", 
          RowBox[{"{", "vars", "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"tstart", ",", "tend"}], "}"}], ",", "opt"}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "p", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"gridPlot", "[", 
     RowBox[{"sys_", ",", " ", "var_", ",", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
    RowBox[{"gridPlot", "[", 
     RowBox[{"sys", ",", 
      RowBox[{"{", "var", "}"}], ",", "opt"}], "]"}]}], ";"}], " ", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gridPlot", "[", 
    RowBox[{"sys_", ",", " ", "vars_", ",", 
     RowBox[{"{", 
      RowBox[{"tstart_", ",", " ", "tend_"}], "}"}], ",", " ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "p", ",", "v", ",", " ", "colors", ",", " ", "nv", ",", "ga", ",", "nc",
        ",", " ", "rem", ",", " ", "styles", ",", " ", "plotoptions", ",", 
       "h", ",", "w", ",", "a"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"w", "=", 
       RowBox[{
        RowBox[{"\"\<Width\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Width\>\"", "\[Rule]", " ", "300"}], "}"}]}]}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{"a", "=", 
       RowBox[{
        RowBox[{"\"\<Aspect\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Aspect\>\"", "\[Rule]", " ", 
          RowBox[{"(", 
           RowBox[{"1.0", "/", "GoldenRatio"}], ")"}]}], "}"}]}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"h", "=", 
       RowBox[{"a", "*", "w"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"vars", "===", "All"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"v", "=", 
          RowBox[{"First", "/@", 
           RowBox[{"Flatten", "[", "sys", "]"}]}]}], ";"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"v", "=", "vars"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";", " ", "\[IndentingNewLine]", 
      RowBox[{"nv", "=", 
       RowBox[{"Length", "[", "v", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"colors", " ", "=", 
       RowBox[{"Hue", "/@", 
        RowBox[{"(", " ", 
         RowBox[{
          RowBox[{"Range", "[", "nv", "]"}], "/", "nv"}], ")"}]}]}], ";", " ",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"styles", " ", "=", 
       RowBox[{
        RowBox[{"\"\<styles\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"Options", "[", "gridPlot", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"plotoptions", "=", 
       RowBox[{
        RowBox[{"\"\<Options\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Options\>\"", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{"PlotRange", "\[Rule]", " ", "All"}], "}"}]}], "}"}]}]}], 
      ";", " ", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "styles", "]"}], "<", "nv"}], ",", " ", 
        RowBox[{"styles", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"styles", ",", 
           RowBox[{"{", "}"}]}], "]"}]}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "styles", "]"}], ">", "nv"}], ",", " ", 
        RowBox[{"styles", "=", 
         RowBox[{"Take", "[", 
          RowBox[{"styles", ",", "nv"}], "]"}]}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"colors", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Directive", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"#1", ",", "#2"}], "}"}], "]"}], "]"}], "&"}], ",", " ", 
         
         RowBox[{"{", 
          RowBox[{"colors", ",", " ", "styles"}], "}"}]}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"colors", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Prepend", "[", 
            RowBox[{"styles", ",", "#"}], "]"}], "&"}], "/@", "colors"}]}], 
        ";"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"p", " ", "=", " ", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"runPlot", "[", 
           RowBox[{"sys", ",", " ", "#1", ",", 
            RowBox[{"{", 
             RowBox[{"tstart", ",", " ", "tend"}], "}"}], ",", 
            RowBox[{"PlotLabel", "\[Rule]", " ", "#1"}], ",", 
            RowBox[{"\"\<holdLegend\>\"", "\[Rule]", " ", "True"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", " ", "#2"}], ",", " ", 
            RowBox[{"Sequence", "@@", "plotoptions"}]}], "]"}], "&"}], ",", 
         "  ", 
         RowBox[{"{", 
          RowBox[{"v", ",", " ", "colors"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"popt", "=", 
          RowBox[{"MyFilterOptions", "[", 
           RowBox[{"Plot", ",", "plotoptions"}], "]"}]}], "}"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"p", " ", "=", " ", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Plot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#1", "[", "Global`t", "]"}], "/.", 
               RowBox[{"Flatten", "[", "sys", "]"}]}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"Global`t", ",", " ", "tstart", ",", " ", "tend"}], 
               "}"}], ",", 
              RowBox[{"PlotLabel", "\[Rule]", " ", "#1"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", " ", "#2"}], ",", " ", 
              RowBox[{"AspectRatio", "\[Rule]", " ", "Full"}], ",", 
              RowBox[{"ImageSize", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{"w", ",", "h"}], "}"}]}], ",", " ", "popt"}], "]"}], 
            "&"}], ",", "  ", 
           RowBox[{"{", 
            RowBox[{"v", ",", " ", "colors"}], "}"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"nc", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\"\<Columns\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], ")"}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Columns\>\"", "\[Rule]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"plotColumns", "/.", 
             RowBox[{"{", "opt", "}"}]}], "/.", 
            RowBox[{"Options", "[", "gridPlot", "]"}]}], ")"}]}], "}"}]}]}], 
      ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"nc", ">", "1"}], ",", " ", 
        RowBox[{
         RowBox[{"ga", "=", 
          RowBox[{"Partition", "[", 
           RowBox[{"p", ",", "nc"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"rem", " ", "=", " ", 
          RowBox[{"Mod", "[", 
           RowBox[{"nv", ",", " ", "nc"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"rem", ">", "0"}], ",", " ", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ga", " ", "=", " ", 
             RowBox[{"Append", "[", 
              RowBox[{"ga", ",", " ", 
               RowBox[{"Take", "[", 
                RowBox[{"p", ",", 
                 RowBox[{"-", "rem"}]}], "]"}]}], "]"}]}], ";"}]}], " ", 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", " ", "\[IndentingNewLine]", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"optsShow", "=", 
          RowBox[{"MyFilterOptions", "[", 
           RowBox[{"Plot", ",", "opt"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nc", ">", "1"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", 
           RowBox[{"Show", "[", 
            RowBox[{
             RowBox[{"GraphicsGrid", "[", "ga", "]"}], ",", "  ", 
             "optsShow"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", 
           RowBox[{"Show", "[", 
            RowBox[{
             RowBox[{"GraphicsColumn", "[", "p", "]"}], ",", " ", 
             "optsShow"}], "]"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.401034392766981*^9, 3.401034393120583*^9}, 
   3.507394287998946*^9, {3.507574949278*^9, 3.50757497389478*^9}, {
   3.507575004980505*^9, 3.5075750568697166`*^9}, {3.560287543152376*^9, 
   3.560287544408945*^9}, {3.560287635816847*^9, 3.560287679011248*^9}, {
   3.560287721976533*^9, 3.560287722176708*^9}, {3.560287775113243*^9, 
   3.560287878078966*^9}, {3.560287918493348*^9, 3.560287923133297*^9}, 
   3.5602879662392197`*^9, {3.560288164740635*^9, 3.560288271314931*^9}, {
   3.5602883166511717`*^9, 3.560288422564848*^9}, {3.560288465705069*^9, 
   3.5602885240859833`*^9}, {3.5602894031216507`*^9, 3.560289510122945*^9}, {
   3.560289564928898*^9, 3.560289891378748*^9}, {3.560289942415049*^9, 
   3.5602899650002327`*^9}, {3.560290006724327*^9, 3.5602901460178337`*^9}, {
   3.5877527405740747`*^9, 3.587752746907332*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["arrayGridPlot", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"arrayGridPlot", "[", 
    RowBox[{"n_", ",", " ", "ncells_", ",", "tmax_", ",", " ", 
     RowBox[{"{", "vars__", "}"}], ",", " ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "singlePlot", ",", " ", "plots", ",", " ", "columns", ",", "df"}], 
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"df", " ", "=", " ", 
       RowBox[{
        RowBox[{"DisplayFunction", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"DisplayFunction", "\[Rule]", " ", "$DisplayFunction"}], 
         "}"}]}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"singlePlot", "[", "variableName_", "]"}], ":=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"runPlot", "[", 
          RowBox[{"n", ",", " ", 
           RowBox[{"#", "/@", 
            RowBox[{"(", 
             RowBox[{"Range", "[", "ncells", "]"}], ")"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "tmax"}], "}"}], ",", "opt", ",", " ", 
           RowBox[{"PlotRange", "\[Rule]", " ", "All"}], ",", "  ", 
           RowBox[{"\"\<holdLegend\>\"", "\[Rule]", " ", "True"}], ",", " ", 
           RowBox[{"PlotLabel", "\[Rule]", " ", "#"}], ",", " ", 
           RowBox[{"DisplayFunction", "\[Rule]", " ", "Identity"}]}], "]"}], 
         "&"}], "/@", 
        RowBox[{"{", "variableName", "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", " ", "=", " ", 
       RowBox[{"singlePlot", "/@", 
        RowBox[{"{", "vars", "}"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"columns", " ", "=", " ", 
       RowBox[{
        RowBox[{"plotColumns", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"plotColumns", "\[Rule]", " ", "3"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"plots", " ", "=", " ", 
       RowBox[{"Flatten", "[", "plots", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"Partition", "[", 
        RowBox[{"plots", ",", " ", "columns", ",", " ", "columns", ",", " ", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], ",", " ", 
         RowBox[{"{", "}"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"MyGraphicsArray", "[", "plots", "]"}], ",", " ", 
         RowBox[{"DisplayFunction", "\[Rule]", " ", "df"}], ",", "opt"}], 
        "]"}], "]"}], ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.507394294915413*^9, {3.587752757128668*^9, 3.587752763966312*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["simulate", "Subsection"],

Cell["\<\
(******** THE SIMULATE SECTION IS COMMENTED OUT TO AVOID USE OF MathSBML \
**********)
requires MathSBML\
\>", "Text",
 CellChangeTimes->{{3.587687829543045*^9, 3.587687832037072*^9}, {
  3.587688063356833*^9, 3.5876880856049767`*^9}, {3.5876881564917107`*^9, 
  3.587688160899332*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"debugRun", "=", "False"}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"simulate", "[", 
     RowBox[{"system_", ",", "tend_", ",", "  ", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"simulate", "[", 
       RowBox[{"system", ",", " ", 
        RowBox[{"timeSpan", "\[Rule]", " ", "tend"}], ",", " ", "opt"}], 
       "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", "  ", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"simulate", "[", 
     RowBox[{"sys_", ",", " ", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "ic", ",", " ", "r", ",", " ", "n", ",", " ", "eqs", ",", " ", "odes", 
        ",", " ", "vars", ",", " ", "nopt", ",", " ", "pvar", ",", " ", 
        RowBox[{"time", "=", "Global`t"}], ",", " ", "icsGiven", ",", " ", 
        "icsMissing", ",", "ruleToICequation", ",", " ", "gpvar", ",", " ", 
        "deindex", ",", " ", "deindexedvars"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"interpreted", "[", "sys", "]"}], ",", " ", 
         RowBox[{"system", "=", "sys"}], ",", " ", 
         RowBox[{"system", "=", 
          RowBox[{"interpret", "[", "sys", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"deindex", "[", 
         RowBox[{"a_", "[", "b___", "]"}], "]"}], ":=", " ", 
        RowBox[{"deindex", "[", "a", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"deindex", "[", "a_", "]"}], ":=", " ", "a"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"ic", " ", "=", " ", 
        RowBox[{
         RowBox[{"initialConditions", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"Options", "[", "run", "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"r", "=", " ", 
        RowBox[{
         RowBox[{"rates", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"Options", "[", "run", "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"vars", " ", "=", " ", 
        RowBox[{"system", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"tend", " ", "=", " ", 
        RowBox[{
         RowBox[{"timeSpan", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"timeSpan", "\[Rule]", " ", "100"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       StyleBox[
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "convert", " ", "any", " ", "ics", " ", "that", " ", "are", " ", 
           "given", " ", "as", " ", "rules", " ", "into", " ", "NDSolve"}], 
          "-", 
          RowBox[{"compatible", " ", "form"}]}], " ", "*)"}],
        FontWeight->"Plain"], "\[IndentingNewLine]", 
       StyleBox["\[IndentingNewLine]",
        FontWeight->"Plain"], 
       StyleBox[
        RowBox[{
         RowBox[{"ruleToICequation", "[", 
          RowBox[{"Rule", "[", 
           RowBox[{"a_", ",", "b_"}], "]"}], "]"}], ":=", " ", 
         RowBox[{"Equal", "[", 
          RowBox[{
           RowBox[{"a", "[", "0", "]"}], ",", " ", "b"}], "]"}]}],
        FontWeight->"Bold"], 
       StyleBox[";",
        FontWeight->"Bold"], 
       StyleBox["\[IndentingNewLine]",
        FontWeight->"Bold"], 
       StyleBox[
        RowBox[{
         RowBox[{"ruleToICequation", "[", "a_", "]"}], ":=", " ", "a"}],
        FontWeight->"Bold"], 
       StyleBox[";",
        FontWeight->"Bold"], 
       StyleBox["\[IndentingNewLine]",
        FontWeight->"Bold"], 
       StyleBox[
        RowBox[{"ic", " ", "=", " ", 
         RowBox[{"ruleToICequation", "/@", "ic"}]}],
        FontWeight->"Bold"], 
       StyleBox[";",
        FontWeight->"Bold"], 
       StyleBox["\[IndentingNewLine]",
        FontWeight->"Bold"], 
       StyleBox["\[IndentingNewLine]",
        FontWeight->"Bold"], 
       RowBox[{"If", "[", 
        RowBox[{"debugRun", ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<simulate:ic:\>\"", ",", "ic", ",", "\"\<\\nr:\>\"", ",", " ", 
           "r", ",", "\"\<\\nvars:\>\"", ",", "vars", ",", "\"\<\\ntend:\>\"",
            ",", "tend"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       StyleBox["\[IndentingNewLine]",
        FontWeight->"Bold"], 
       StyleBox[
        RowBox[{"(*", " ", 
         RowBox[{
         "determine", " ", "missing", " ", "initial", " ", "conditions", " ", 
          "and", " ", "set", " ", "them", " ", "to", " ", "zero"}], " ", 
         "*)"}],
        FontWeight->"Plain"], 
       StyleBox["\[IndentingNewLine]",
        FontWeight->"Bold"], 
       StyleBox["\[IndentingNewLine]",
        FontWeight->"Bold"], 
       RowBox[{"icsGiven", "=", 
        RowBox[{"Head", "/@", 
         RowBox[{"First", "/@", "ic"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"icsMissing", "=", 
        RowBox[{"Complement", "[", 
         RowBox[{"vars", ",", " ", "icsGiven"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "icsMissing", "]"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
            RowBox[{"\"\<Warning: \>\"", "//", "boldRed"}], ",", 
            RowBox[{
            "\"\<Initial conditions are missing (and assumed to be zero) for \
the following variables: \>\"", "//", "boldBlack"}], ",", " ", 
            RowBox[{"icsMissing", "//", "boldBlue"}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"icsMissing", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Equal", "[", 
              RowBox[{
               RowBox[{"#", "[", "0", "]"}], ",", " ", "0"}], "]"}], "&"}], "/@",
             "icsMissing"}]}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"ic", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"ic", ",", " ", "icsMissing"}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       StyleBox[
        RowBox[{"If", "[", 
         RowBox[{"debugRun", ",", " ", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<simulate: ic:\>\"", ",", " ", "ic"}], "]"}]}], "]"}],
        FontWeight->"Plain"], 
       StyleBox[";",
        FontWeight->"Plain"], 
       StyleBox[" ",
        FontWeight->"Plain"], 
       StyleBox["\[IndentingNewLine]",
        FontWeight->"Plain"], "\[IndentingNewLine]", 
       StyleBox[
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"create", " ", "the", " ", "NDSolve"}], "-", 
          RowBox[{"compatible", " ", "system"}]}], " ", "*)"}],
        FontWeight->"Plain"], 
       StyleBox[" ",
        FontWeight->"Plain"], 
       StyleBox["\[IndentingNewLine]",
        FontWeight->"Plain"], 
       StyleBox["\[IndentingNewLine]",
        FontWeight->"Plain"], 
       StyleBox[
        RowBox[{"odes", " ", "=", " ", 
         RowBox[{"system", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}],
        FontWeight->"Plain"], 
       StyleBox[";",
        FontWeight->"Plain"], 
       StyleBox[" ",
        FontWeight->"Plain"], 
       StyleBox["\[IndentingNewLine]",
        FontWeight->"Plain"], 
       StyleBox[
        RowBox[{"If", "[", 
         RowBox[{"debugRun", ",", " ", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<simulate: odes:\>\"", ",", " ", "odes"}], "]"}]}], 
         "]"}],
        FontWeight->"Plain"], 
       StyleBox[";",
        FontWeight->"Plain"], 
       StyleBox[" ",
        FontWeight->"Plain"], 
       StyleBox["\[IndentingNewLine]",
        FontWeight->"Plain"], "\[IndentingNewLine]", 
       RowBox[{"eqs", " ", "=", " ", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"system", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", " ", "ic"}], "]"}], "/.", 
         "r"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       StyleBox[
        RowBox[{"(*", " ", 
         RowBox[{"check", " ", "for", " ", "undefined", " ", 
          RowBox[{
           RowBox[{"variables", "/", "parameters"}], "/", "constants"}]}], 
         " ", "*)"}],
        FontWeight->"Plain"], 
       StyleBox[" ",
        FontWeight->"Plain"], 
       StyleBox["\[IndentingNewLine]",
        FontWeight->"Plain"], "\[IndentingNewLine]", 
       RowBox[{"sym", " ", "=", 
        RowBox[{"getSymbols", "[", "eqs", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"deindexedvars", "=", 
        RowBox[{"Union", "[", 
         RowBox[{"deindex", "/@", "vars"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"sym", " ", "=", " ", 
        RowBox[{"Complement", "[", 
         RowBox[{"sym", ",", " ", "vars", ",", " ", "deindexedvars", ",", 
          RowBox[{"{", "time", "}"}]}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "sym", "]"}], ">", "0"}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
            RowBox[{"\"\<Warning: \>\"", "//", "boldRed"}], ",", 
            RowBox[{
            
            "\"\< The following symbols are undefined (and assumed to be \
equal to one (1)): \>\"", "//", "boldBlack"}], ",", " ", 
            RowBox[{"sym", "//", "boldBlue"}]}], "]"}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"sym", " ", "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"Rule", "[", 
              RowBox[{"#", ",", "1"}], "]"}], "&"}], "/@", "sym"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"eqs", " ", "=", " ", 
           RowBox[{"eqs", "/.", "sym"}]}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       StyleBox[
        RowBox[{"(*", " ", 
         RowBox[{
         "filter", " ", "NDSolve", " ", "options", " ", "and", " ", "solve", 
          " ", "the", " ", "system"}], " ", "*)"}],
        FontWeight->"Plain"], 
       StyleBox[" ",
        FontWeight->"Plain"], 
       StyleBox["\[IndentingNewLine]",
        FontWeight->"Plain"], 
       RowBox[{
        StyleBox["(*",
         FontWeight->"Plain"], 
        StyleBox[" ",
         FontWeight->"Plain"], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"With", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"nopt", "=", 
             RowBox[{"MyFilterOptions", "[", 
              RowBox[{"NDSolve", ",", "opt"}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"n", "=", 
             RowBox[{"NDSolve", "[", 
              RowBox[{"eqs", ",", " ", "vars", ",", " ", 
               RowBox[{"{", 
                RowBox[{"time", ",", " ", "tstart", ",", " ", "tend"}], "}"}],
                ",", " ", "nopt"}], "]"}]}], ";"}]}], " ", 
          "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "model", ",", "constants", ",", " ", "v", ",", " ", "c", ",", 
           "crule"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"c", "=", " ", "Global`compartment$1"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"crule", " ", "=", " ", 
           RowBox[{"c", "\[Rule]", " ", "1"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"constants", " ", "=", " ", 
           RowBox[{"Append", "[", 
            RowBox[{"r", ",", " ", "crule"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"v", "=", 
           RowBox[{"functionate", "/@", "vars"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"model", "=", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"model", ",", " ", 
            RowBox[{"Global`SBMLAlgebraicRules", "\[Rule]", " ", 
             RowBox[{"{", "}"}]}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"model", ",", " ", 
            RowBox[{"Global`SBMLAssignmentRules", "\[Rule]", " ", 
             RowBox[{"{", "}"}]}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"model", ",", " ", 
            RowBox[{"Global`SBMLCompartments", "\[Rule]", " ", 
             RowBox[{"{", "c", "}"}]}]}], "]"}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"model", ",", " ", 
            RowBox[{"Global`SBMLConstants", "\[Rule]", " ", "constants"}]}], 
           "]"}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"model", ",", " ", 
            RowBox[{"Global`SBMLConstraints", "\[Rule]", 
             RowBox[{"{", "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"model", ",", " ", 
            RowBox[{"Global`SBMLContext", "\[Rule]", "\"\<None`\>\""}]}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"model", ",", " ", 
            RowBox[{"Global`SBMLEvents", "\[Rule]", 
             RowBox[{"{", "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"model", ",", 
            RowBox[{"Global`SBMLFunctions", "\[Rule]", 
             RowBox[{"{", "}"}]}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"model", ",", 
            RowBox[{"Global`SBMLIC", "\[Rule]", " ", "ic"}]}], "]"}], ";", 
          " ", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"model", ",", " ", 
            RowBox[{"Global`SBMLInitialAssignments", "\[Rule]", 
             RowBox[{"{", "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"model", ",", " ", 
            RowBox[{"Global`SBMLKineticLaws", "\[Rule]", 
             RowBox[{"{", "}"}]}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"model", ",", " ", 
            RowBox[{"Global`SBMLMetaIDAssociations", "\[Rule]", 
             RowBox[{"{", "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"model", ",", " ", 
            RowBox[{"Global`SBMLModelid", "\[Rule]", "\"\<xlr8rModel\>\""}]}],
            "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"model", ",", 
            RowBox[{
            "Global`SBMLModelName", "\[Rule]", 
             "\"\<xCellerator Model\>\""}]}], "]"}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"model", ",", " ", 
            RowBox[{"Global`SBMLModelVariables", "\[Rule]", " ", "v"}]}], 
           "]"}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"model", ",", " ", 
            RowBox[{"Global`SBMLNameIDAssociations", "\[Rule]", 
             RowBox[{"{", "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"model", ",", " ", 
            RowBox[{"Global`SBMLODES", "\[Rule]", " ", "odes"}]}], "]"}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"model", ",", " ", 
            RowBox[{"Global`SBMLParameters", "\[Rule]", " ", 
             RowBox[{"(", 
              RowBox[{"First", "/@", "r"}], ")"}]}]}], "]"}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"model", ",", " ", 
            RowBox[{"Global`SBMLSpecies", "\[Rule]", " ", "v"}]}], "]"}], ";",
           " ", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"model", ",", " ", 
            RowBox[{
            "Global`SBMLSpeciesCompartmentAssociations", "\[Rule]", " ", 
             RowBox[{"(", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"Rule", "[", 
                 RowBox[{"#", ",", " ", "c"}], "]"}], "&"}], "/@", "vars"}], 
              ")"}]}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"model", ",", " ", 
            RowBox[{"Global`SBMLSpeciesTypeAssociations", "\[Rule]", " ", 
             RowBox[{"{", "}"}]}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"model", ",", " ", 
            RowBox[{"Global`SBMLSpeciesTypes", "\[Rule]", " ", 
             RowBox[{"{", "}"}]}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"model", ",", " ", 
            RowBox[{"Global`SBMLUnitAssociations", "\[Rule]", 
             RowBox[{"{", "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"model", ",", " ", 
            RowBox[{"Global`SBMLUnitDefinitions", "\[Rule]", 
             RowBox[{"{", "}"}]}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"debugRun", ",", " ", 
            RowBox[{"Print", "[", 
             RowBox[{"\"\<simulate: model: \>\"", ",", " ", "model"}], 
             "]"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"n", "=", 
           RowBox[{"SBMLNDSolve", "[", 
            RowBox[{"model", ",", " ", "tend", ",", " ", "opt"}], "]"}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "n", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"plot", "/.", 
           RowBox[{"{", "opt", "}"}]}], "/.", 
          RowBox[{"Options", "[", "run", "]"}]}], ",", "\[IndentingNewLine]", 
         
         StyleBox[
          RowBox[{"(*", " ", 
           RowBox[{"if", " ", "a", " ", "plot", " ", "is", " ", "requested"}],
            " ", "*)"}],
          FontWeight->"Plain"], 
         StyleBox[" ",
          FontWeight->"Plain"], 
         StyleBox["\[IndentingNewLine]",
          FontWeight->"Plain"], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"pvar", " ", "=", " ", 
           RowBox[{
            RowBox[{"plotVariables", "/.", 
             RowBox[{"{", "opt", "}"}]}], "/.", 
            RowBox[{"Options", "[", "run", "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"SameQ", "[", 
              RowBox[{"pvar", ",", "None"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "pvar", "]"}], ">", "0"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"runPlot", "[", 
                 RowBox[{"n", ",", " ", "pvar", ",", "opt"}], "]"}], ";"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"runPlot", "[", "n", "]"}], ";"}]}], " ", 
              "\[IndentingNewLine]", "]"}], ";"}]}], " ", 
           "\[IndentingNewLine]", " ", "]"}], ";", " ", "\[IndentingNewLine]",
           "\[IndentingNewLine]", 
          StyleBox[
           RowBox[{"(*", " ", 
            RowBox[{
            "if", " ", "a", " ", "gridPlot", " ", "is", " ", "requested"}], 
            " ", "*)"}],
           FontWeight->"Plain"], "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"gpvar", " ", "=", " ", 
           RowBox[{
            RowBox[{"gridPlotVariables", "/.", 
             RowBox[{"{", "opt", "}"}]}], "/.", 
            RowBox[{"Options", "[", "run", "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"SameQ", "[", 
              RowBox[{"gpvar", ",", "None"}], "]"}]}], ",", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"SameQ", "[", 
               RowBox[{"gpvar", ",", "All"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"gridPlot", "[", 
                RowBox[{"n", ",", "All", ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"tstart", ",", " ", "tend"}], "}"}], ",", "opt"}], 
                "]"}], ";"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"gridPlot", "[", 
                RowBox[{"n", ",", 
                 RowBox[{"Flatten", "[", "gpvar", "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"tstart", ",", " ", "tend"}], "}"}], ",", "opt"}], 
                "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
           "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}]}], " ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       StyleBox[
        RowBox[{"(*", " ", 
         RowBox[{
         "return", " ", "a", " ", "list", " ", "of", " ", "interpolating", 
          " ", "functions"}], " ", "*)"}],
        FontWeight->"Plain"], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "n", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.401034403151185*^9, 3.401034403533452*^9}, {
   3.5876589556593246`*^9, 3.58765896561108*^9}, {3.587659140923395*^9, 
   3.587659160712626*^9}, 3.587659516954741*^9, 3.587660216659281*^9, {
   3.587688089206678*^9, 3.587688096196537*^9}}],

Cell["\<\
(******** END of MathSBML COMMENTED OUT BLOCK FOR SIMULATE ******)\
\>", "Text",
 CellChangeTimes->{{3.587688101564701*^9, 3.587688124772106*^9}, {
  3.58768820945223*^9, 3.587688210428216*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["InterpolationSetListQ ", "Subsection",
 CellChangeTimes->{{3.587725555639839*^9, 3.587725565590438*^9}}],

Cell["10-26-04 (forked from MathSBML 9-9-13)", "Text",
 CellChangeTimes->{{3.587725570062923*^9, 3.587725583926111*^9}, {
  3.587725661886454*^9, 3.587725663486895*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"InterpolationSetListQ", "[", "x_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"ListQ", "[", "x", "]"}]}], ",", 
        RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"Complement", "[", 
          RowBox[{
           RowBox[{"Head", "/@", "x"}], ",", 
           RowBox[{"{", "InterpolationSet", "}"}]}], "]"}], "]"}], "<", "1"}],
        "]"}], ";"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getInterpolatingFunction", "[", 
    RowBox[{"InterpolationSet", "[", 
     RowBox[{"t1_", ",", "t2_", ",", "if_"}], "]"}], "]"}], ":=", "if"}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.587725543441038*^9, 3.5877255434416857`*^9}, {
  3.587725588676578*^9, 3.587725611874696*^9}, {3.587934218871684*^9, 
  3.5879342198421497`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["startAndEndValues", "Subsection",
 CellChangeTimes->{{3.587725635405994*^9, 3.587725641691018*^9}}],

Cell["\<\
10-26-04 (forked from MathSBML 9-9-13)\
\>", "Text",
 CellChangeTimes->{{3.587725644862204*^9, 3.58772565823853*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"startAndEndValues", "[", 
    RowBox[{"InterpolationSet", "[", 
     RowBox[{"start_", ",", "end_", ",", "f_"}], "]"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"vars", ",", "startValues", ",", "endvalues"}], "}"}], ",", 
     RowBox[{
      RowBox[{"vars", "=", 
       RowBox[{"First", "/@", "f"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"startValues", "=", 
       RowBox[{
        RowBox[{"vars", "/.", "f"}], "/.", 
        RowBox[{"{", 
         RowBox[{"Global`t", "\[Rule]", "start"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"endValues", "=", 
       RowBox[{
        RowBox[{"vars", "/.", "f"}], "/.", 
        RowBox[{"{", 
         RowBox[{"Global`t", "\[Rule]", "end"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vars", "=", 
       RowBox[{"decontextify", "[", "vars", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"startValues", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"#1", ",", "start", ",", "#2"}], "}"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"vars", ",", "startValues"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"endValues", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"#1", ",", "end", ",", "#2"}], "}"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"vars", ",", "endValues"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"startValues", ",", "endValues"}], "}"}], "]"}]}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"startAndEndValues", "[", 
    RowBox[{"f_", "?", "InterpolationSetListQ"}], "]"}], ":=", 
   RowBox[{"Join", "@@", 
    RowBox[{"(", 
     RowBox[{"startAndEndValues", "/@", "f"}], ")"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5877256285771313`*^9, 3.58772562857793*^9}, 
   3.587725668992815*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["XPlot", "Subsection",
 CellChangeTimes->{{3.587725697941966*^9, 3.58772569925429*^9}, {
  3.5877289262718763`*^9, 3.58772892750385*^9}}],

Cell["forked from MathSBML`SBMLPlot 9-9-13", "Text",
 CellChangeTimes->{{3.587725744205709*^9, 3.587725751647641*^9}, {
  3.587728930160042*^9, 3.587728937127902*^9}}],

Cell["Plotting of Interpolation Sets", "Subsubsection",
 CellChangeTimes->{{3.5877257168542128`*^9, 3.587725720344084*^9}}],

Cell[CellGroupData[{

Cell["\<\
2 - 26 - 04. revised 8 - 10 - 04
6 - 10 - 05 make holdLegend a global option; add PlotStyles option
5 - 15 - 06 replace PlotStyle with BaseStyle\
\>", "Text",
 CellChangeTimes->{{3.587725732090262*^9, 3.587725738701549*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"X$LogPlotZero", "=", "0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"X$MultiPlot", "=", "False"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"XPlot", "[", "$Failed", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"Print", "[", 
      RowBox[{
       RowBox[{"\"\<Error: \>\"", "//", "boldRed"}], ",", 
       RowBox[{"\"\<XPlot: unable to plot: \>\"", "//", "boldBlack"}], ",", 
       RowBox[{"$Failed", "//", "boldBlue"}]}], "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"XPlot", "[", 
    RowBox[{"{", "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"Print", "[", 
      RowBox[{
       RowBox[{"\"\<Error: \>\"", "//", "boldRed"}], ",", 
       RowBox[{"\"\<XPlot: unable to plot: \>\"", "//", "boldBlack"}], ",", 
       RowBox[{
        RowBox[{"{", "}"}], "//", "boldBlue"}]}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"XPlot", "[", 
     RowBox[{
      RowBox[{"q_", "?", "InterpolationSetListQ"}], ",", 
      RowBox[{"{", "}"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{
         RowBox[{"\"\<Error: \>\"", "//", "boldRed"}], ",", 
         RowBox[{"\"\<XPlot: Invalid input.\>\"", "//", "boldBlack"}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Abort", "[", "]"}], ";"}]}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DEBUGPLOT", "=", "False"}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XPlot", "[", 
    RowBox[{
     RowBox[{"q_", "?", "InterpolationSetListQ"}], ",", 
     RowBox[{"z___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "p", ",", "s", ",", "opts", ",", "legend", ",", "savs", ",", "vars", 
       ",", "datasets", ",", "createLines", ",", "connectingLines", ",", 
       RowBox[{"debug", "=", "True"}], ",", "dbg", ",", "zbad", ",", 
       "logplot", ",", "zerovalue", ",", "hold", ",", "colors", ",", "df", 
       ",", " ", "dPrint"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"X$MultiPlot", "=", "True"}], ";", "\[IndentingNewLine]", 
      RowBox[{"dbg", "=", "DEBUGPLOT"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dPrint", "[", "u___", "]"}], ":=", " ", 
       RowBox[{"If", "[", 
        RowBox[{"dbg", ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{
           RowBox[{"\"\<XPlot: \>\"", "//", "boldRed"}], ",", " ", 
           RowBox[{"u", "//", "boldBlue"}]}], "]"}]}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{
      "dPrint", "[", 
       "\"\<InterpolationSetListQ (0): plotting interpolation set\>\"", "]"}],
       ";", " ", "\[IndentingNewLine]", 
      RowBox[{"opts", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"{", "z", "}"}], ",", "OptionQ"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"hold", "=", 
       RowBox[{
        RowBox[{"\"\<holdLegend\>\"", "/.", "opts"}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<holdLegend\>\"", "\[Rule]", "False"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"colors", "=", 
       RowBox[{
        RowBox[{"\"\<PlotColors\>\"", "/.", "opts"}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<PlotColors\>\"", "\[Rule]", 
          RowBox[{"{", "}"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{
       "\"\<InterpolationSetListQ: colors:\>\"", ",", "colors", ",", 
        "\"\< hold:\>\"", ",", "hold"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"zbad", "=", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"{", "z", "}"}], ",", 
         RowBox[{"{", "opts", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"logplot", "=", 
       RowBox[{
        RowBox[{"stringer", "[", 
         RowBox[{
          RowBox[{"\"\<type\>\"", "/.", 
           RowBox[{"{", "z", "}"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{"\"\<type\>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], "]"}], 
        "\[Equal]", "\"\<Log\>\""}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"zbad", "=", 
       RowBox[{"Complement", "[", 
        RowBox[{"zbad", ",", 
         RowBox[{"{", 
          RowBox[{"type", "\[Rule]", "\"\<Log\>\""}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"zbad", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"zbad", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"stringer", "[", 
            RowBox[{"First", "[", "#1", "]"}], "]"}], "\[NotEqual]", 
           "\"\<zero\>\""}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"zbad", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"zbad", ",", 
         RowBox[{"!", 
          RowBox[{
           RowBox[{"First", "[", "#1", "]"}], "===", 
           "\"\<holdLegend\>\""}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"zbad", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"zbad", ",", 
         RowBox[{"!", 
          RowBox[{
           RowBox[{"First", "[", "#1", "]"}], "===", 
           "\"\<PlotColors\>\""}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"zbad", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"zbad", ",", 
         RowBox[{"!", 
          RowBox[{
           RowBox[{"First", "[", "#1", "]"}], "===", 
           "\"\<PlotStyles\>\""}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<InterpolationSetListQ: q:\>\"", ",", "q"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "zbad", "]"}], ">", "0"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{
              RowBox[{"boldRed", "[", "\"\<>>Warning: \>\"", "]"}], ",", 
              RowBox[{"boldBlack", "[", "\"\< The option \>\"", "]"}], ",", 
              RowBox[{"boldRed", "[", "#1", "]"}], ",", 
              RowBox[{
              "boldBlack", "[", 
               "\"\< is not allowed (or has not yet been implemented) for \
models that contain events.\>\"", "]"}]}], "]"}], "&"}], ")"}], "/@", 
          "zbad"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"legend", "=", 
       RowBox[{"{", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Graphics", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Sequence", "@@", "#1"}], ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}]}], "}"}], "]"}]}], "}"}], 
              "]"}], ",", 
             RowBox[{"ToString", "[", "#2", "]"}]}], "}"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"MultiPlot$Styles", ",", "MultiPlot$Legends"}], "}"}]}], 
         "]"}], "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"logplot", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"dPrint", "[", 
          RowBox[{
          "\"\<InterpolationSetListQ: \>\"", ",", 
           "\"\<About to call XPlot[interpolatingFunction] - LogPlot\>\""}], 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"zerovalue", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\"\<zero\>\"", "/.", 
             RowBox[{"{", "z", "}"}]}], "/.", 
            RowBox[{"{", 
             RowBox[{"\"\<zero\>\"", "\[Rule]", "0"}], "}"}]}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"X$LogPlotZero", "=", 
          RowBox[{"Max", "[", 
           RowBox[{"zerovalue", ",", "0"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"p", "=", 
          RowBox[{"XLogPlot", "[", 
           RowBox[{"q", ",", 
            RowBox[{"Sequence", "@@", "opts"}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], ";"}], ",", 
        RowBox[{
         RowBox[{"dPrint", "[", 
          RowBox[{
          "\"\<XPlot: InterpolationSetListQ: \>\"", ",", 
           "\"\<About to call XPlot[interpolatingFunction]\>\""}], "]"}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"p", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"XPlot", "[", 
              RowBox[{"#1", ",", 
               RowBox[{"Sequence", "@@", "opts"}], ",", 
               RowBox[{"\"\<holdLegend\>\"", "\[Rule]", "hold"}], ",", 
               RowBox[{"\"\<PlotColors\>\"", "\[Rule]", "colors"}], ",", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}], ")"}],
            "/@", "q"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{
       "\"\<XPlot: InterpolationSetListQ: \>\"", ",", 
        "\"\< plotting interpolation sets: p: \>\"", ",", 
        RowBox[{"Show", "[", 
         RowBox[{"p", ",", 
          RowBox[{"DisplayFunction", "\[Rule]", "$DisplayFunction"}]}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"X$MultiPlot", "=", "False"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"legend", "=", 
         RowBox[{"{", 
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Graphics", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Sequence", "@@", "#1"}], ",", 
                  RowBox[{"Line", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}]}], "}"}], "]"}]}], "}"}], 
                "]"}], ",", 
               RowBox[{"ToString", "[", "#2", "]"}]}], "}"}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"MultiPlot$Styles", ",", "MultiPlot$Legends"}], "}"}]}], 
           "]"}], "}"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"$VersionNumber", "<", "6"}], ",", 
        RowBox[{"legend", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"legend", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"LegendSize", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"1", ",", "1"}], "}"}]}], ",", 
             RowBox[{"LegendPosition", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"-", "0.5`"}]}], "}"}]}], ",", 
             RowBox[{"TextStyle", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"FontFamily", "\[Rule]", "Times"}], "}"}]}]}], "}"}]}],
           "]"}]}], ",", 
        RowBox[{
         RowBox[{"legend", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"legend", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"LegendSize", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}]}], ",", 
              RowBox[{"LegendPosition", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"-", "0.5`"}]}], "}"}]}], ",", 
              RowBox[{"BaseStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"FontFamily", "\[Rule]", "Times"}], "}"}]}]}], 
             "}"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "p", "]"}], ">", "1"}], "&&", 
         RowBox[{"!", "logplot"}]}], ",", 
        RowBox[{
         RowBox[{"sav", "=", 
          RowBox[{"startAndEndValues", "[", "q", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"vars", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#1", "[", "Global`t", "]"}], "&"}], ")"}], "/@", 
           RowBox[{"ToExpression", "/@", "MultiPlot$Legends"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"dPrint", "[", 
          RowBox[{
          "\"\<InterpolationSetListQ: \>\"", ",", "\"\<sav: \>\"", ",", "sav",
            ",", "\"\< vars:\>\"", ",", "vars"}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"datasets", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{"sav", ",", 
               RowBox[{"{", 
                RowBox[{"#1", ",", "___"}], "}"}], ",", "\[Infinity]"}], 
              "]"}], "&"}], ")"}], "/@", "vars"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"dPrint", "[", 
          RowBox[{
          "\"\<InterpolationSetListQ: \>\"", ",", 
           "\"\< plotting interpolation set: datasets(1): \>\"", ",", 
           "datasets"}], "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"datasets", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Drop", "[", 
              RowBox[{
               RowBox[{"Drop", "[", 
                RowBox[{"#1", ",", "1"}], "]"}], ",", 
               RowBox[{"-", "1"}]}], "]"}], "&"}], ")"}], "/@", 
           "datasets"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"dPrint", "[", 
          RowBox[{
          "\"\<XPLOT: InterpolationSetListQ:  plotting interpolation set: \
datasets(2): \>\"", ",", "datasets"}], "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"datasets", "=", 
          RowBox[{"Transpose", "/@", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Drop", "[", 
               RowBox[{"#1", ",", "1"}], "]"}], "&"}], ")"}], "/@", 
            RowBox[{"Transpose", "/@", "datasets"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"datasets", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Partition", "[", 
              RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "/@", 
           "datasets"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"createLines", "[", 
           RowBox[{"dataset_", ",", "style_"}], "]"}], ":=", 
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", "}"}], ",", 
            RowBox[{
             RowBox[{"dPrint", "[", 
              RowBox[{"\"\<createLines: style:\>\"", ",", "style"}], "]"}], 
             ";", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Graphics", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Sequence", "@@", "style"}], ",", 
                   RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}]}], "}"}], 
                 "]"}], "&"}], ")"}], "/@", "dataset"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"datasets", "=", 
          RowBox[{"MapThread", "[", 
           RowBox[{"createLines", ",", 
            RowBox[{"{", 
             RowBox[{"datasets", ",", "MultiPlot$Styles"}], "}"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"dPrint", "[", 
          RowBox[{
          "\"\<InterpolationSetListQ: datasets:\>\"", ",", "datasets"}], 
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"connectingLines", "=", 
          RowBox[{"Show", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", "datasets", "]"}], ",", 
            RowBox[{"DisplayFunction", "\[Rule]", "Identity"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"p", "=", 
          RowBox[{"Show", "[", 
           RowBox[{"p", ",", "connectingLines"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"drint", "[", 
          RowBox[{
          "\"\<InterpolationSetListQ: p with connectingLines:\>\"", ",", 
           RowBox[{"Show", "[", 
            RowBox[{"p", ",", 
             RowBox[{"DisplayFunction", "\[Rule]", "$DisplayFunction"}]}], 
            "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Off", "[", 
          RowBox[{"Graphics", "::", "\"\<gptn\>\""}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"p", "=", 
          RowBox[{"Show", "[", 
           RowBox[{"p", ",", 
            RowBox[{"DisplayFunction", "\[Rule]", "Identity"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"On", "[", 
          RowBox[{"Graphics", "::", "\"\<gptn\>\""}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"AllowMultiPlot$Legends", ",", "\[IndentingNewLine]", 
        RowBox[{"s", "=", 
         RowBox[{"ShowLegend", "[", 
          RowBox[{"p", ",", "legend"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"df", "=", 
          RowBox[{
           RowBox[{"DisplayFunction", "/.", "opts"}], "/.", 
           RowBox[{"{", 
            RowBox[{"DisplayFunction", "\[Rule]", "$DisplayFunction"}], 
            "}"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"dbg", ",", 
           RowBox[{"Print", "[", 
            RowBox[{
             RowBox[{
             "\"\<XPlot: InterpolationSetListQ: \>\"", "//", "boldRed"}], 
             ",", "\"\<df:\>\"", ",", "df"}], "]"}]}], "\[IndentingNewLine]", 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"p", "=", 
          RowBox[{"Show", "[", 
           RowBox[{"p", ",", 
            RowBox[{"DisplayFunction", "\[Rule]", "df"}]}], "]"}]}], ";", " ",
          "\[IndentingNewLine]", 
         RowBox[{"dPrint", "[", "p", "]"}], ";", " ", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "p", "]"}]}]}], "\[IndentingNewLine]", 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"XPlot", "[", 
     RowBox[{
      RowBox[{"q_", "?", "InterpolationSetListQ"}], ",", 
      RowBox[{"{", "var__", "}"}], ",", 
      RowBox[{"z___", "?", "OptionQ"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tstart", ",", "tend"}], "}"}], ",", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{"DEBUGPLOT", ",", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<XPlot: InterpolationSetListQ: (1): {var}: \>\"", ",", 
           RowBox[{"{", "var", "}"}]}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tstart", "=", 
        RowBox[{"q", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"tend", "=", 
        RowBox[{"q", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"Length", "[", "q", "]"}], ",", "2"}], "]"}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"XPlot", "[", 
         RowBox[{"q", ",", 
          RowBox[{"{", "var", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"tstart", ",", "tend"}], "}"}], ",", "z"}], "]"}], "]"}], 
       ";"}]}], "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"XPlot", "[", 
     RowBox[{
      RowBox[{"q_", "?", "InterpolationSetListQ"}], ",", 
      RowBox[{"{", "var__", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"tstart_", ",", "tend_"}], "}"}], ",", 
      RowBox[{"z___", "?", "OptionQ"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "convars", ",", "devars", ",", "r", ",", "n", ",", "selvars", ",", " ",
         "dPrint"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"dPrint", "[", "u___", "]"}], ":=", " ", 
        RowBox[{"If", "[", 
         RowBox[{"DEBUGPLOT", ",", " ", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<XPLOT: \>\"", ",", " ", "u"}], "]"}]}], "]"}]}], ";", 
       " ", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<XPlot: InterpolationSetListQ: (2): {var}: \>\"", ",", 
         RowBox[{"{", "var", "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"selvars", "[", 
         RowBox[{
          RowBox[{"InterpolationSet", "[", 
           RowBox[{"t1_", ",", "t2_", ",", "set_"}], "]"}], ",", "vin_"}], 
         "]"}], ":=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "newset", ",", "v", ",", "notfound", ",", "varsInSolution"}], 
           "}"}], ",", 
          RowBox[{
           RowBox[{"v", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"StringQ", "[", "#", "]"}], ",", 
                RowBox[{"ToExpression", "[", "#", "]"}], ",", "#"}], "]"}], 
              "&"}], "/@", "vin"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"newset", "=", 
            RowBox[{"Select", "[", 
             RowBox[{"set", ",", 
              RowBox[{
               RowBox[{"MemberQ", "[", 
                RowBox[{"v", ",", 
                 RowBox[{"First", "[", "#1", "]"}]}], "]"}], "&"}]}], "]"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"varsInSolution", "=", 
            RowBox[{"First", "/@", "set"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"dPrint", "[", 
            RowBox[{
            "\"\<selvars: varsInSolution:\>\"", ",", "varsInSolution"}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"dPrint", "[", 
            RowBox[{"\"\<selvars:  v:\>\"", ",", "v"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"dPrint", "[", 
            RowBox[{"\"\<selvars:  defunctionate/@v:\>\"", ",", 
             RowBox[{"defunctionate", "/@", "v"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"notFound", "=", 
            RowBox[{"Complement", "[", 
             RowBox[{
              RowBox[{"decontextify", "/@", 
               RowBox[{"defunctionate", "/@", "v"}]}], ",", 
              RowBox[{"decontextify", "/@", 
               RowBox[{"defunctionate", "/@", "varsInSolution"}]}]}], "]"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
               RowBox[{"\"\<Warning:\>\"", "//", "boldRed"}], ",", 
               RowBox[{
               "\"\<XPlot: The requested variable \>\"", "//", "boldBlack"}], 
               ",", 
               RowBox[{
                RowBox[{"defunctionate", "[", "#", "]"}], "//", "boldBlue"}], 
               ",", 
               RowBox[{
               "\"\< was not found in the solution set for the time period \>\
\"", "//", "boldBlack"}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"t1", ",", "t2"}], "}"}], "//", "boldBlack"}]}], 
              "]"}], "&"}], "/@", "notFound"}], ";", "\[IndentingNewLine]", 
           RowBox[{"dPrint", "[", 
            RowBox[{
            "\"\<v:\>\"", ",", "v", ",", " ", "\"\< set: \>\"", ",", "set", 
             ",", "\"\< newset:\>\"", ",", "newset"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "newset", "]"}], "\[Equal]", "0"}], ",", 
             
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
                RowBox[{"\"\<Error: \>\"", "//", "boldRed"}], ",", 
                RowBox[{
                "\"\<XPlot: requested variables: \>\"", "//", "boldBlack"}], 
                ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"defunctionate", "/@", "v"}], ")"}], "//", 
                 "boldBlue"}], ",", 
                RowBox[{
                "\"\< not found in solution set. There is nothing to plot. \>\
\"", "//", "boldBlack"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"Abort", "[", "]"}], ";"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Return", "[", 
            RowBox[{"InterpolationSet", "[", 
             RowBox[{"t1", ",", "t2", ",", "newset"}], "]"}], "]"}], ";"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"devars", "=", 
        RowBox[{"decontextify", "/@", 
         RowBox[{"{", "var", "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"convars", "=", 
        RowBox[{"contextify", "/@", "devars"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"devars", "=", 
        RowBox[{"functionate", "/@", "devars"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"convars", "=", 
        RowBox[{"functionate", "/@", "convars"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"r", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#1", "\[Rule]", "#2"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"convars", ",", "devars"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"n", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"selvars", "[", 
            RowBox[{"#1", ",", "convars"}], "]"}], "&"}], ")"}], "/@", 
         "q"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<InterpolationSetListQ: (2): n: \>\"", ",", "n"}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"XPlot", "[", 
         RowBox[{"n", ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"tstart", ",", "tend"}], "}"}], ",", "All"}], "}"}]}], 
          ",", "z"}], "]"}], "]"}], ";"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"XPlot", "[", 
     RowBox[{
      RowBox[{"InterpolationSet", "[", 
       RowBox[{"t1_", ",", "t2_", ",", "sol_"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"var__", "?", "nonOptionQ"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"tbegin_", "?", "NumberQ"}], ",", 
        RowBox[{"tend_", "?", "NumberQ"}]}], "}"}], ",", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{"DEBUGPLOT", ",", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<XPlot:InterpolationSet: (1)\>\"", "//", "boldRed"}], 
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"XPlot", "[", 
        RowBox[{"sol", ",", 
         RowBox[{"{", "var", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"tbegin", ",", "t1"}], "]"}], ",", 
           RowBox[{"Min", "[", 
            RowBox[{"tend", ",", "t2"}], "]"}]}], "}"}], ",", "opt"}], 
        "]"}]}]}], "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"XPlot", "[", 
     RowBox[{
      RowBox[{"InterpolationSet", "[", 
       RowBox[{"t1_", ",", "t2_", ",", "sol_"}], "]"}], ",", 
      RowBox[{"var_", "?", "nonOptionQ"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"tbegin_", "?", "NumberQ"}], ",", 
        RowBox[{"tend_", "?", "NumberQ"}]}], "}"}], ",", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{"DEBUGPLOT", ",", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<XPlot:InterpolationSet: (2)\>\"", "//", "boldRed"}], 
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"XPlot", "[", 
        RowBox[{"sol", ",", "var", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"tbegin", ",", "t1"}], "]"}], ",", 
           RowBox[{"Min", "[", 
            RowBox[{"tend", ",", "t2"}], "]"}]}], "}"}], ",", "opt"}], 
        "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"XPlot", "[", 
     RowBox[{
      RowBox[{"InterpolationSet", "[", 
       RowBox[{"t1_", ",", "t2_", ",", "sol_"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"tbegin_", "?", "NumberQ"}], ",", 
        RowBox[{"tend_", "?", "NumberQ"}]}], "}"}], ",", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{"DEBUGPLOT", ",", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<XPlot:InterpolationSet: (3)\>\"", "//", "boldRed"}], 
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"XPlot", "[", 
        RowBox[{"sol", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"tbegin", ",", "t1"}], "]"}], ",", 
           RowBox[{"Min", "[", 
            RowBox[{"tend", ",", "t2"}], "]"}]}], "}"}], ",", "opt"}], 
        "]"}]}]}], "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"XPlot", "[", 
     RowBox[{
      RowBox[{"InterpolationSet", "[", 
       RowBox[{"t1_", ",", "t2_", ",", "sol_"}], "]"}], ",", 
      RowBox[{"var_", "?", "nonOptionQ"}], ",", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{"DEBUGPLOT", ",", 
         RowBox[{"Print", "[", 
          RowBox[{
           RowBox[{
           "\"\<XPlot:InterpolationSet: (4), var=\>\"", "//", "boldRed"}], 
           ",", 
           RowBox[{"var", "//", "boldBlue"}]}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"XPlot", "[", 
        RowBox[{"sol", ",", "var", ",", 
         RowBox[{"{", 
          RowBox[{"t1", ",", "t2"}], "}"}], ",", "opt"}], "]"}]}]}], "]"}]}], 
   ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XPlot", "[", 
    RowBox[{
     RowBox[{"InterpolationSet", "[", 
      RowBox[{"t1_", ",", "t2_", ",", "sol_"}], "]"}], ",", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{"DEBUGPLOT", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<XPlot:InterpolationSet: (5)\>\"", "//", "boldRed"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"DEBUGPLOT", ",", 
        RowBox[{"Print", "[", 
         RowBox[{
          RowBox[{
          "\"\<XPlot: InterpolationSet: (5): sol:\>\"", "//", "boldRed"}], 
          ",", 
          RowBox[{"sol", "//", "boldBlue"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"XPlot", "[", 
       RowBox[{"sol", ",", 
        RowBox[{"{", 
         RowBox[{"t1", ",", "t2"}], "}"}], ",", "opt"}], "]"}]}]}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.587725763767644*^9, 3.587725763768935*^9}, {
   3.587728944583982*^9, 3.5877290021336937`*^9}, {3.5877290660655327`*^9, 
   3.58772907519767*^9}, {3.587729114173675*^9, 3.587729134699078*^9}, 
   3.5877291782330303`*^9, {3.5877293210057163`*^9, 3.5877294552063627`*^9}, {
   3.587729704455797*^9, 3.587729798504566*^9}, {3.5877594340507193`*^9, 
   3.5877600064217463`*^9}, {3.5879299154835052`*^9, 3.587930010068514*^9}, {
   3.587930064566053*^9, 3.587930107447339*^9}, {3.587930183523961*^9, 
   3.587930306994371*^9}, {3.587930585878976*^9, 3.58793082687328*^9}, {
   3.588719636515221*^9, 3.588719644532007*^9}, {3.588720141695346*^9, 
   3.588720185291061*^9}, 3.5887211265133343`*^9, 3.588721169225491*^9, {
   3.588721247032908*^9, 3.588721293058238*^9}, {3.5887216072187977`*^9, 
   3.5887216112415752`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["ploting of interpolating functions", "Subsubsection",
 CellChangeTimes->{{3.587725780193927*^9, 3.5877257841119328`*^9}}],

Cell["\<\
forked from MathSBML sbmlplot 9/11/13
6 - 9 - 05 Add PlotStyles options (2.5 .1); make holdLegend global; fix bug \
in holdLegend that ignored holdLegend if there were no events.5 - 30 - 07 \
Updates to make plotting work in Version 6; add MyLegend
10 - 15 - 07 make sure plots have default PlotRange -> All, otherwise when \
variables are combinded there is some clipping
3 - 31 - 08 2.7 .3 - in SBMLPlot[sol, {times}, options] check for variables \
in options before assuming all (SBMLPlot debug \"3\" below)\
\>", "Text",
 CellChangeTimes->{{3.587725795170116*^9, 3.5877257983282146`*^9}, {
  3.587930840534672*^9, 3.587930851465501*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"XPlot", "[", 
     RowBox[{"sol_", ",", 
      RowBox[{"{", 
       RowBox[{"var__", "?", "nonOptionQ"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"tbegin_", "?", "NumberQ"}], ",", 
        RowBox[{"tend_", "?", "NumberQ"}]}], "}"}], ",", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "legends", ",", "variables", ",", "n", ",", "colors", ",", 
        "defaultColors", ",", "plotType", ",", "soln", ",", "p", ",", 
        "legend", ",", "allowLegend", ",", "popt", ",", "styles", ",", 
        "trace", ",", 
        RowBox[{"dbg", "=", "False"}], ",", "tt", ",", "vars", ",", "plot", 
        ",", "gopt", ",", " ", "dPrint"}], "}"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{
        RowBox[{"dPrint", "[", "u___", "]"}], ":=", " ", 
        RowBox[{"If", "[", 
         RowBox[{"dbg", ",", " ", 
          RowBox[{"Print", "[", 
           RowBox[{
            RowBox[{"\"\<XPlot (IF): \>\"", "//", "boldRed"}], ",", " ", 
            "u"}], "]"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"trace", "=", "DEBUGPLOT"}], ";", "\[IndentingNewLine]", 
       RowBox[{"dbg", "=", "DEBUGPLOT"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"dbg", "\[Or]", "trace"}], ",", 
         RowBox[{"Print", "[", 
          RowBox[{
           RowBox[{
           "\"\<==== XPlot Trace ON ====\\nXPlot: {var}=\>\"", "//", 
            "boldRed"}], ",", 
           RowBox[{
            RowBox[{"{", "var", "}"}], "//", "boldBlue"}], ",", 
           RowBox[{"\"\<\\nXPlot: {tbegin, tend}=\>\"", "//", "boldRed"}], 
           ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"tbegin", ",", "tend"}], "}"}], "//", "boldBlue"}], ",", 
           
           RowBox[{"\"\<\\nXPlot: {opt}=\>\"", "//", "boldRed"}], ",", 
           RowBox[{
            RowBox[{"{", "opt", "}"}], "//", "boldBlue"}]}], "]"}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"soln", "=", 
        RowBox[{"selectSolution", "[", "sol", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<decontextify/@{var}: \>\"", ",", 
         RowBox[{"decontextify", "/@", 
          RowBox[{"stringer", "/@", 
           RowBox[{"{", "var", "}"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<contextify/@decontextify/@{var}: \>\"", ",", 
         RowBox[{"contextify", "/@", 
          RowBox[{"decontextify", "/@", 
           RowBox[{"stringer", "/@", 
            RowBox[{"{", "var", "}"}]}]}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"variables", "=", 
        RowBox[{"contextify", "/@", 
         RowBox[{"decontextify", "/@", 
          RowBox[{"stringer", "/@", 
           RowBox[{"{", "var", "}"}]}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"variables", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"StringQ", "[", "#", "]"}], ",", 
             RowBox[{"ToExpression", "[", "#", "]"}], ",", "#"}], "]"}], 
           "&"}], ",", "variables"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"vars", "=", "variables"}], ";", "\[IndentingNewLine]", 
       RowBox[{"variables", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", "Global`t", "]"}], "&"}], ",", "variables"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"legends", "=", 
        RowBox[{"decontextify", "[", 
         RowBox[{"Map", "[", 
          RowBox[{"ToString", ",", 
           RowBox[{"{", "var", "}"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "legends", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "get", " ", "styles", " ", "and", " ", "make", " ", "sure", " ", "it",
          " ", "is", " ", "a", " ", "list", " ", "of", " ", "lists"}], "*)"}], 
       RowBox[{"styles", "=", 
        RowBox[{
         RowBox[{"\"\<PlotStyles\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<PlotStyles\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "styles", "]"}], "<", "1"}], ",", 
         RowBox[{"styles", "=", 
          RowBox[{
           RowBox[{"\"\<PlotStyle\>\"", "/.", 
            RowBox[{"{", "opt", "}"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{"\"\<PlotStyle\>\"", "\[Rule]", 
             RowBox[{"{", "}"}]}], "}"}]}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<styles (1):\>\"", ",", "styles"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "If", " ", "there", " ", "is", " ", "just", " ", "one", " ", 
          "style"}], ",", 
         RowBox[{
         "apply", " ", "it", " ", "to", " ", "each", " ", "variable"}]}], 
        "*)"}], 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"\[Not]", 
          RowBox[{"ListQ", "[", "styles", "]"}]}], ",", 
         RowBox[{"styles", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", "styles", "}"}], ",", 
            RowBox[{"{", "n", "}"}]}], "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<styles (2):\>\"", ",", "styles"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "If", " ", "there", " ", "is", " ", "more", " ", "than", " ", "one", 
          " ", "style"}], ",", 
         RowBox[{
         "but", " ", "only", " ", "a", " ", "one", " ", "level", " ", 
          "list"}], ",", 
         RowBox[{
         "apply", " ", "them", " ", "to", " ", "all", " ", "variables"}]}], 
        "*)"}], 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "styles", "]"}], ">", "0"}], ",", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"\[Not]", 
             RowBox[{"ListQ", "[", 
              RowBox[{"First", "[", "styles", "]"}], "]"}]}], ",", 
            RowBox[{"styles", "=", 
             RowBox[{"{", "styles", "}"}]}]}], "]"}], ";"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"dbg", ",", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<styles (3):\>\"", ",", "styles"}], "]"}]}], "]"}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "styles", "]"}], "<", "n"}], ",", 
         RowBox[{"styles", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"styles", ",", 
            RowBox[{"{", "}"}]}], "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "styles", "]"}], ">", "n"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
            RowBox[{"\"\<Warning: \>\"", "//", "boldRed"}], ",", 
            RowBox[{"\"\< XPlot: \>\"", "//", "boldBlack"}], ",", 
            RowBox[{
             RowBox[{"Length", "[", "styles", "]"}], "//", "boldBlue"}], ",", 
            
            RowBox[{"\"\< PlotStyles supplied only \>\"", "//", "boldBlack"}],
             ",", 
            RowBox[{"n", "//", "boldBlue"}], ",", 
            RowBox[{
            "\"\< expected. Extra styles ignored. \>\"", "//", 
             "boldBlack"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"styles", "=", 
           RowBox[{"Take", "[", 
            RowBox[{"styles", ",", "n"}], "]"}]}], ";"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<styles (4):\>\"", ",", "styles"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "add", " ", "in", " ", "colors", " ", "if", " ", "not", " ", 
         "supplied", " ", "in", " ", "PlotStyles"}], "*)"}], 
       RowBox[{"colors", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"\"\<PlotColors\>\"", "/.", 
           RowBox[{"{", "opt", "}"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{"\"\<PlotColors\>\"", "\[Rule]", 
            RowBox[{"{", "}"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"SameQ", "[", 
            RowBox[{"colors", ",", "None"}], "]"}], ",", 
           RowBox[{"colors", "=", 
            RowBox[{"Map", "[", 
             RowBox[{"Hue", ",", 
              RowBox[{
               RowBox[{"Range", "[", "n", "]"}], "/", 
               RowBox[{"(", 
                RowBox[{"1.0", "*", "n"}], ")"}]}]}], "]"}]}]}], "]"}], ";"}],
         "*)"}], 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "colors", "]"}], ">", "0"}], ",", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "colors", "]"}], ">", "n"}], ",", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
               RowBox[{"\"\<Warning: \>\"", "//", "boldRed"}], ",", 
               RowBox[{"\"\<XPlot: \>\"", "//", "boldBlack"}], ",", 
               RowBox[{
                RowBox[{"\"\<PlotColors\[Rule]\>\"", "<>", 
                 RowBox[{"ToString", "[", "colors", "]"}]}], "//", 
                "boldBlue"}], ",", 
               RowBox[{"\"\< contains \>\"", "//", "boldBlack"}], ",", 
               RowBox[{
                RowBox[{"Length", "[", "colors", "]"}], "//", "boldBlue"}], 
               ",", 
               RowBox[{"\"\< colors; only \>\"", "//", "boldBlack"}], ",", 
               RowBox[{"n", "//", "boldBlue"}], ",", 
               RowBox[{
               "boldBlack", "[", 
                "\"\<\\nare expected. The input will be interpreted as\>\"", 
                "]"}], ",", 
               RowBox[{"boldBlue", "[", 
                RowBox[{"\"\<PlotColors\[Rule]\>\"", "<>", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"Take", "[", 
                   RowBox[{"colors", ",", "n"}], "]"}], "]"}]}], "]"}]}], 
              "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"colors", "=", 
              RowBox[{"Take", "[", 
               RowBox[{"colors", ",", "n"}], "]"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{
        "\"\<n=\>\"", ",", "n", ",", "\"\< Length[colors]:\>\"", ",", 
         RowBox[{"Length", "[", "colors", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "colors", "]"}], "<", "n"}], ",", 
         RowBox[{
          RowBox[{"defaultColors", "=", 
           RowBox[{"Map", "[", 
            RowBox[{"Hue", ",", 
             RowBox[{
              RowBox[{"Range", "[", "n", "]"}], "/", 
              RowBox[{"(", 
               RowBox[{"1.0", "*", "n"}], ")"}]}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"defaultColors", "=", 
           RowBox[{"Drop", "[", 
            RowBox[{"defaultColors", ",", 
             RowBox[{"Length", "[", "colors", "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"colors", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"colors", ",", "defaultColors"}], "]"}]}], ";"}]}], "]"}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<colors:\>\"", ",", "colors"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<original styles:\>\"", ",", "styles"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "Seems", " ", "that", " ", "Mathematica", " ", "choose", " ", "the", 
          " ", "LAST", " ", "style", " ", "to", " ", "use"}], ",", 
         RowBox[{"not", " ", "the", " ", "FIRST"}], ",", 
         RowBox[{"like", " ", "Options"}]}], "*)"}], 
       RowBox[{"styles", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Prepend", "[", 
            RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"styles", ",", "colors"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<revised styles:\>\"", ",", "styles"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"plotType", "=", 
        RowBox[{"stringer", "[", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\"\<type\>\"", "/.", 
            RowBox[{"{", "opt", "}"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{"\"\<type\>\"", "\[Rule]", " ", "\"\<\>\""}], "}"}]}], 
          ")"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"plotType", "\[Equal]", "\"\<Log\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<log plot. soln: \>\"", ",", " ", "soln"}], "]"}], ";",
           " ", "\[IndentingNewLine]", 
          RowBox[{"p", "=", 
           RowBox[{"XLogPlot", "[", 
            RowBox[{"soln", ",", 
             RowBox[{"{", "var", "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"tbegin", ",", "tend"}], "}"}], ",", "opt"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", "\"\<returned from xLotPlot.\>\"", "]"}], 
          ";", " ", "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", "p", "]"}], ";", " ", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "p", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"allowLegend", "=", 
        RowBox[{"\[Not]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\"\<holdLegend\>\"", "/.", 
            RowBox[{"{", "opt", "}"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{"\"\<holdLegend\>\"", "\[Rule]", "False"}], "}"}]}], 
          ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"AllowMultiPlot$Legends", "=", "allowLegend"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"trace", ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
            RowBox[{"\"\<XPlot: \>\"", "//", "boldRed"}], ",", 
            RowBox[{"\"\<variables: \>\"", "//", "boldRed"}], ",", 
            RowBox[{"variables", "//", "boldBlue"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{
            RowBox[{"\"\<XPlot: \>\"", "//", "boldRed"}], ",", 
            RowBox[{"\"\<styles: \>\"", "//", "boldRed"}], ",", 
            RowBox[{"styles", "//", "boldBlue"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{
            RowBox[{"\"\<XPlot: \>\"", "//", "boldRed"}], ",", 
            RowBox[{"\"\<legends: \>\"", "//", "boldRed"}], ",", 
            RowBox[{"legends", "//", "boldBlue"}]}], "]"}], ";"}]}], "]"}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"solution", ",", " ", "s"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"solution", "[", 
            RowBox[{"InterpolationSet", "[", "u_", "]"}], "]"}], ":=", " ", 
           "u"}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"solution", "[", 
            RowBox[{"u_", "?", "ListQ"}], "]"}], ":=", " ", "u"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"solution", "[", "u___", "]"}], ":=", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
               RowBox[{"\"\<Error: XPlot: \>\"", "//", "boldRed"}], ",", " ", 
               "\"\<unexpected format for solution: \>\"", ",", " ", "u"}], 
              "]"}], ";", 
             RowBox[{"Abort", "[", "]"}], ";"}], ")"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"s", "=", 
           RowBox[{"solution", "[", "soln", "]"}]}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"popt", "=", 
              RowBox[{"MyFilterOptions", "[", 
               RowBox[{"Plot", ",", "opt"}], "]"}]}], "}"}], ",", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{"trace", ",", 
               RowBox[{"Print", "[", 
                RowBox[{
                 RowBox[{"\"\<XPlot: \>\"", "//", "boldRed"}], ",", 
                 RowBox[{"\"\<{popt}:\>\"", "//", "boldRed"}], ",", 
                 RowBox[{
                  RowBox[{"{", "popt", "}"}], "//", "boldBlue"}]}], "]"}]}], 
              "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{"X$MultiPlot", ",", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{"trace", ",", 
                  RowBox[{"Print", "[", 
                   RowBox[{"\"\<XPlot: X$MultiPlot\>\"", "//", "boldRed"}], 
                   "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"$VersionNumber", "<", "6"}], ",", 
                  RowBox[{"p", "=", 
                   RowBox[{"Plot", "[", 
                    RowBox[{
                    RowBox[{"Evaluate", "[", 
                    RowBox[{"variables", "/.", "soln"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Global`t", ",", "tbegin", ",", "tend"}], "}"}], 
                    ",", 
                    RowBox[{"PlotStyle", "\[Rule]", "styles"}], ",", 
                    RowBox[{"Sequence", "[", "popt", "]"}], ",", 
                    RowBox[{"DisplayFunction", "\[Rule]", "Identity"}]}], 
                    "]"}]}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"plot", "[", 
                    RowBox[{"x_", ",", "directives_"}], "]"}], ":=", 
                    RowBox[{"Plot", "[", 
                    RowBox[{
                    RowBox[{"x", "/.", "soln"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Global`t", ",", "tbegin", ",", "tend"}], "}"}], 
                    ",", 
                    RowBox[{"PlotStyle", "\[Rule]", "directives"}], ",", 
                    "popt"}], "]"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"p", "=", 
                    RowBox[{"MapThread", "[", 
                    RowBox[{"plot", ",", 
                    RowBox[{"{", 
                    RowBox[{"variables", ",", 
                    RowBox[{"Directive", "/@", "styles"}]}], "}"}]}], 
                    "]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"MultiPlot$Colors", "=", "colors"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"MultiPlot$Legends", "=", "legends"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"MultiPlot$Styles", "=", "styles"}], ";"}], ",", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{"trace", ",", 
                  RowBox[{"Print", "[", 
                   RowBox[{
                    RowBox[{"\"\<XPlot: \>\"", "//", "boldRed"}], ",", 
                    RowBox[{
                    "\"\<It is Not X$MultiPlot: allowLegend: \>\"", "//", 
                    "boldRed"}], ",", 
                    RowBox[{"allowLegend", "//", "boldBlue"}]}], "]"}]}], 
                 "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"$VersionNumber", "<", "6"}], ",", 
                  RowBox[{"If", "[", 
                   RowBox[{"allowLegend", ",", 
                    RowBox[{"p", "=", 
                    RowBox[{"Plot", "[", 
                    RowBox[{
                    RowBox[{"Evaluate", "[", 
                    RowBox[{"variables", "/.", "soln"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Global`t", ",", "tbegin", ",", "tend"}], "}"}], 
                    ",", 
                    RowBox[{"Sequence", "[", "popt", "]"}], ",", 
                    RowBox[{
                    "Graphics`Legend`PlotLegend", "\[Rule]", "legends"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", "styles"}], ",", 
                    RowBox[{"Graphics`Legend`LegendPosition", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "0.5"}]}], "}"}]}], ",", 
                    RowBox[{"Graphics`Legend`LegendSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{".5", ",", "1"}], "}"}]}]}], "]"}]}], ",", 
                    RowBox[{"p", "=", 
                    RowBox[{"Plot", "[", 
                    RowBox[{
                    RowBox[{"Evaluate", "[", 
                    RowBox[{"variables", "/.", "s"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Global`t", ",", "tbegin", ",", "tend"}], "}"}], 
                    ",", 
                    RowBox[{"Sequence", "[", "popt", "]"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", "styles"}]}], "]"}]}]}], 
                   "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  "\[IndentingNewLine]", 
                  RowBox[{"(*", " ", 
                   RowBox[{
                    RowBox[{"version", " ", "number"}], " ", ">", " ", 
                    RowBox[{"6", " ", "starts", " ", "here"}]}], " ", "*)"}], 
                  "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{"trace", ",", "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{
                    RowBox[{
                    "\"\<XPlot (version number > 6): variables:\>\"", "//", 
                    "boldRed"}], ",", 
                    RowBox[{"variables", "//", "boldBlue"}]}], "]"}]}], "]"}],
                    ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"plot", "[", 
                    RowBox[{"x_", ",", "directives_"}], "]"}], ":=", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Plot", "[", 
                    RowBox[{
                    RowBox[{"x", "/.", "s"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Global`t", ",", "tbegin", ",", "tend"}], "}"}], 
                    ",", 
                    RowBox[{"PlotStyle", "\[Rule]", "directives"}], ",", 
                    "popt", ",", 
                    RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", "\[IndentingNewLine]", 
                   "\[IndentingNewLine]", 
                   RowBox[{"dPrint", "[", 
                    RowBox[{"\"\<s: \>\"", ",", " ", "s"}], "]"}], ";", " ", 
                   "\[IndentingNewLine]", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{"allowLegend", ",", 
                    RowBox[{
                    RowBox[{"p", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Show", "[", 
                    RowBox[{
                    RowBox[{"MyLegend", "[", 
                    RowBox[{"legends", ",", "colors"}], "]"}], ",", 
                    RowBox[{"AspectRatio", "\[Rule]", 
                    RowBox[{"1", "/", "GoldenRatio"}]}]}], "]"}], ",", 
                    RowBox[{"MapThread", "[", 
                    RowBox[{"plot", ",", 
                    RowBox[{"{", 
                    RowBox[{"variables", ",", 
                    RowBox[{"Directive", "/@", "styles"}]}], "}"}]}], "]"}]}],
                     "}"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{"trace", ",", 
                    RowBox[{"Print", "[", 
                    RowBox[{
                    RowBox[{"\"\<XPlot: p \>\"", "//", "boldRed"}], ",", 
                    RowBox[{"p", "//", "boldBlue"}]}], "]"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"gopt", "=", 
                    RowBox[{"MyFilterOptions", "[", 
                    RowBox[{"Graphics", ",", "opt"}], "]"}]}], "}"}], ",", 
                    RowBox[{"p", "=", 
                    RowBox[{"Show", "[", 
                    RowBox[{"p", ",", "gopt", ",", 
                    RowBox[{"Axes", "\[Rule]", "True"}]}], "]"}]}]}], "]"}]}],
                     ",", 
                    RowBox[{"p", "=", 
                    RowBox[{"Show", "[", 
                    RowBox[{"MapThread", "[", 
                    RowBox[{"plot", ",", 
                    RowBox[{"{", 
                    RowBox[{"variables", ",", 
                    RowBox[{"Directive", "/@", "styles"}]}], "}"}]}], "]"}], 
                    "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}]}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", 
       RowBox[{"(*", " ", 
        RowBox[{"end", " ", "of", " ", "the", " ", "BLOCK"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"trace", ",", 
         RowBox[{"Print", "[", 
          RowBox[{
           RowBox[{"\"\<XPlot: Plot: \>\"", "//", "boldRed"}], ",", "p", ",", 
           
           RowBox[{
           "\"\<\\n=== XPlot Trace: EXIT ===\>\"", "//", "boldRed"}]}], 
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", "p", "]"}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "p", "]"}]}]}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MyLegend", "[", 
     RowBox[{
      RowBox[{"names_", "?", "ListQ"}], ",", 
      RowBox[{"colors_", "?", "ListQ"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p", ",", "n", ",", "nc", ",", "x", ",", "y", ",", "xy"}], 
       "}"}], ",", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "names", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"nc", "=", 
        RowBox[{"Length", "[", "colors", "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[NotEqual]", "nc"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
            RowBox[{"\"\<Error:\>\"", "//", "boldRed"}], ",", 
            RowBox[{"\"\<MyLegend:\>\"", "//", "boldBlue"}], ",", 
            RowBox[{"\"\< number of names = \>\"", "//", "boldBlack"}], ",", 
            RowBox[{"n", "//", "boldBlack"}], ",", 
            RowBox[{
            "\"\< is different from the number of colors = \>\"", "//", 
             "boldBlack"}], ",", 
            RowBox[{"nc", "//", "boldBlack"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"x", "=", "1.1"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"xy", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Scaled", "[", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"1", "-", 
              RowBox[{"1.0", "*", 
               RowBox[{"y", "/", 
                RowBox[{"(", 
                 RowBox[{"n", "+", "1"}], ")"}]}]}]}]}], "}"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"p", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Text", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"stringer", "/@", "names"}], ",", "xy"}], "}"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"p", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{"colors", ",", "p"}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"p", "=", 
        RowBox[{"Graphics", "/@", "p"}]}]}]}], "\[IndentingNewLine]", "]"}]}],
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"XPlot", "[", 
     RowBox[{"sol_", ",", 
      RowBox[{"variable_", "?", "AtomQ"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"tbegin_", "?", "NumberQ"}], ",", 
        RowBox[{"tend_", "?", "NumberQ"}]}], "}"}], ",", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "vars", ",", "lvars", ",", "r", ",", "n", ",", "pvar", ",", "p", ",", 
        "dbg"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dbg", "=", "DEBUGPLOT"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"dbg", ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
            RowBox[{"\"\<XPlot 2: variable: \>\"", "//", "boldRed"}], ",", 
            RowBox[{"variable", "//", "boldBlue"}], ",", 
            RowBox[{"\"\< {begin, end}:\>\"", "//", "boldRed"}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"tbegin", ",", "tend"}], "}"}], "//", "boldBlue"}], ",", 
            RowBox[{"\"\< {options}:\>\"", "//", "boldRed"}], ",", 
            RowBox[{
             RowBox[{"{", "opt", "}"}], "//", "boldBlue"}]}], "]"}], ";"}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "rev", " ", "2.6", ".2", " ", "to", " ", "check", " ", "for", " ", 
         "\"\<ALL\>\"", " ", "here"}], "*)"}], 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ToUpperCase", "[", 
           RowBox[{"ToString", "[", "variable", "]"}], "]"}], "\[Equal]", 
          "\"\<ALL\>\""}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"XPlot", "[", 
           RowBox[{"sol", ",", 
            RowBox[{"{", 
             RowBox[{"tbegin", ",", "tend"}], "}"}], ",", 
            RowBox[{"\"\<variables\>\"", "\[Rule]", " ", "\"\<All\>\""}], ",",
             " ", "opt"}], "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"XPlot", "[", 
        RowBox[{"sol", ",", 
         RowBox[{"{", "variable", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"tbegin", ",", "tend"}], "}"}], ",", "opt"}], "]"}]}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\n", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"XPlot", "[", 
     RowBox[{"sol_", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"tbegin_", "?", "NumberQ"}], ",", 
        RowBox[{"tend_", "?", "NumberQ"}]}], "}"}], ",", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"soln", ",", "vars", ",", "dbg", " ", ",", "dPrint"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dbg", "=", "DEBUGPLOT"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dPrint", "[", "u___", "]"}], ":=", " ", 
        RowBox[{"If", "[", 
         RowBox[{"dbg", ",", " ", 
          RowBox[{"Print", "[", 
           RowBox[{
            RowBox[{"\"\<XPlot 3:\>\"", "//", "boldRed"}], ",", " ", "u"}], 
           "]"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<{tbegin,tend}:\>\"", ",", " ", 
         RowBox[{"{", 
          RowBox[{"tbegin", ",", " ", "tend"}], "}"}], ",", " ", 
         "\"\< {opt}: \>\"", ",", " ", 
         RowBox[{"{", "opt", "}"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"soln", "=", 
        RowBox[{"selectSolution", "[", "sol", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "added", " ", "the", " ", "following", " ", "check", " ", "2.7", ".3",
          " ", "in", " ", "responsed", " ", "to", " ", "bug", " ", 
         "1892076"}], "*)"}], 
       RowBox[{"vars", "=", 
        RowBox[{
         RowBox[{"\"\<variables\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<variables\>\"", "\[Rule]", "\"\<All\>\""}], "}"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"ToUpperCase", "[", "vars", "]"}], "\[Equal]", " ", 
          "\"\<ALL\>\""}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{"vars", "=", 
          RowBox[{"First", "/@", "soln"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<vars: \>\"", ",", " ", 
         RowBox[{"vars", "//", "boldBlue"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"XPlot", "[", 
         RowBox[{"soln", ",", "vars", ",", 
          RowBox[{"{", 
           RowBox[{"tbegin", ",", "tend"}], "}"}], ",", "opt"}], "]"}], 
        "]"}]}]}], "]"}]}], ";"}], "\n", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"XPlot", "[", 
     RowBox[{"sol_", ",", 
      RowBox[{"variable_", "?", "nonOptionQ"}], ",", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p", ",", "tbegin", ",", "tend", ",", "soln", ",", "dbg"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dbg", "=", "DEBUGPLOT"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"dbg", ",", 
         RowBox[{"Print", "[", 
          RowBox[{
           RowBox[{"\"\<XPlot 4: variable: \>\"", "//", "boldRed"}], ",", 
           RowBox[{"variable", "//", "boldBlue"}], ",", 
           RowBox[{"\"\< {options}:\>\"", "//", "boldRed"}], ",", 
           RowBox[{
            RowBox[{"{", "opt", "}"}], "//", "boldRed"}]}], "]"}]}], "]"}], 
       ";", 
       RowBox[{"(*", 
        RowBox[{
        "allow", " ", "plotting", " ", "of", " ", "either", " ", "solutions", 
         " ", "or", " ", "solutions", " ", "incorporated", " ", "within", " ",
          "a", " ", "model"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"soln", "=", 
        RowBox[{"selectSolution", "[", "sol", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"tbegin", ",", "tend"}], "}"}], "=", 
        RowBox[{"getPlotTimes", "[", "soln", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"p", "=", 
        RowBox[{"XPlot", "[", 
         RowBox[{"soln", ",", "variable", ",", 
          RowBox[{"{", 
           RowBox[{"tbegin", ",", "tend"}], "}"}], ",", "opt"}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "p", "]"}], ";"}]}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"XPlot", "[", 
     RowBox[{"sol_", ",", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "vars", ",", "svars", ",", "tbegin", ",", "tend", ",", "soln", ",", 
        "dbg", ",", " ", "dPrint"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dbg", "=", "DEBUGPLOT"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dPrint", "[", "u___", "]"}], ":=", 
        RowBox[{"If", "[", 
         RowBox[{"dbg", ",", " ", 
          RowBox[{"Print", "[", 
           RowBox[{
            RowBox[{"\"\<XPlot 5: \>\"", "//", "boldRed"}], ",", " ", "u"}], 
           "]"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<opt: \>\"", ",", " ", 
         RowBox[{"{", "opt", "}"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"soln", "=", 
        RowBox[{"selectSolution", "[", "sol", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"tbegin", ",", "tend"}], "}"}], "=", 
        RowBox[{"getPlotTimes", "[", "soln", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"vars", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<variables\>\"", "/.", 
            RowBox[{"{", "opt", "}"}]}], "/.", 
           RowBox[{"\"\<variables\>\"", "\[Rule]", 
            RowBox[{"{", "\"\<All\>\"", "}"}]}]}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<variables: \>\"", ",", " ", "vars"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"svars", "=", 
        RowBox[{"ToUpperCase", "/@", 
         RowBox[{"ToString", "/@", "vars"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<svars: \>\"", ",", " ", "svars"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"svars", ",", "\"\<ALL\>\""}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"dPrint", "[", "\"\<Option ALL\>\"", "]"}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"Return", "[", 
           RowBox[{"XPlot", "[", 
            RowBox[{"soln", ",", 
             RowBox[{"{", 
              RowBox[{"tbegin", ",", "tend"}], "}"}], ",", "opt"}], "]"}], 
           "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", "\"\<default Option\>\"", "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"XPlot", "[", 
         RowBox[{"soln", ",", "vars", ",", 
          RowBox[{"{", 
           RowBox[{"tbegin", ",", "tend"}], "}"}], ",", "opt"}], "]"}], "]"}],
        ";"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "revised", " ", "v", ".093", " ", "from", " ", "MathSBML", " ", "fork", 
    " ", "to", " ", "use", " ", "InterpolatingFunctionAnatomy", " ", 
    "instead", " ", "of", " ", "searching", " ", "for", " ", "Text", " ", 
    "String"}], "*)"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getPlotTimes", "[", "soln_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "solTimes", ",", "n1", ",", "tbegin", ",", "tend", ",", "pos", ",", 
        "part", ",", " ", 
        RowBox[{"dbg", "=", "DEBUGPLOT"}], ",", " ", "dPrint", ",", " ", 
        "domain", ",", " ", "domains"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"dPrint", "[", "u___", "]"}], ":=", " ", 
        RowBox[{"If", "[", 
         RowBox[{"dbg", ",", " ", 
          RowBox[{"Print", "[", 
           RowBox[{
            RowBox[{"\"\<getPlotTimes: \>\"", "//", "boldRed"}], ",", " ", 
            "u"}], "]"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"domain", "[", "if_", "]"}], ":=", " ", 
        RowBox[{"InterpolatingFunctionDomain", "[", "if", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"domains", " ", "=", " ", 
        RowBox[{"domain", "/@", 
         RowBox[{"(", 
          RowBox[{"Last", "/@", "soln"}], ")"}]}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"domains", " ", "=", " ", 
        RowBox[{"Union", " ", "[", 
         RowBox[{"Flatten", "/@", "domains"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<domains: \>\"", ",", " ", "domains"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"tbegin", ",", " ", "tend"}], "}"}], "=", 
        RowBox[{"Transpose", "[", "domains", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"tbegin", "=", 
        RowBox[{"Max", "[", "tbegin", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"tend", "=", 
        RowBox[{"Min", "[", "tend", "]"}]}], ";", " ", "\[IndentingNewLine]", 
       
       RowBox[{"dPrint", "[", 
        RowBox[{
        "\"\<tbegin: \>\"", ",", " ", "tbegin", ",", " ", "\"\< tend: \>\"", 
         ",", " ", "tend"}], "]"}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"tbegin", ",", "tend"}], "}"}], "]"}], ";"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "this", " ", "converts", " ", "a", " ", "mathsbml", " ", "solution", " ", 
    "into", " ", "a", " ", "mathematica", " ", "style", " ", "solution"}], 
   " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "if", " ", "the", " ", "input", " ", "is", " ", "a", " ", "solution", " ",
      "and", " ", "not", " ", "a", " ", "mathsbml", " ", "solution"}], ",", 
    " ", 
    RowBox[{
    "it", " ", "just", " ", "passes", " ", "the", " ", "input", " ", 
     "through", " ", "to", " ", "the", " ", "output"}]}], " ", "*)"}], "\n", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"selectSolution", "[", "sol_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"ToString", "/@", 
           RowBox[{"First", "/@", "sol"}]}], ",", 
          "\"\<SBMLNumericalSolution\>\""}], "]"}], ",", 
        RowBox[{
         RowBox[{"Return", "[", 
          RowBox[{"Global`SBMLNumericalSolution", "/.", "sol"}], "]"}], ";"}],
         ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Return", "[", 
          RowBox[{"sol", "//", "Flatten"}], "]"}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
        RowBox[{"boldOrange", "[", "\"\<Error:\>\"", "]"}], ",", 
        RowBox[{
         RowBox[{
         "boldRed", "[", 
          "\"\<selectSolution: law of excluded middles violation. \
Catastrophic failure of nature.\>\"", "]"}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.587725806694522*^9, 3.58772580669525*^9}, {
   3.5877527859344587`*^9, 3.587752861404764*^9}, {3.587930837537899*^9, 
   3.587931263180872*^9}, {3.587931387349703*^9, 3.587931463386874*^9}, {
   3.5879315782421007`*^9, 3.587931624572863*^9}, {3.587931668696838*^9, 
   3.587931717993524*^9}, 3.587931849651716*^9, 3.587932099573943*^9, {
   3.588348056301319*^9, 3.588348066284738*^9}, 3.588348197493095*^9, {
   3.5883482581544123`*^9, 3.588348365557369*^9}, {3.588348402959391*^9, 
   3.588348435384489*^9}, {3.588348572238991*^9, 3.588348695454987*^9}, {
   3.588348918538118*^9, 3.588349054397625*^9}, {3.5883490938102922`*^9, 
   3.588349233132744*^9}, {3.588349271186036*^9, 3.588349408745212*^9}, {
   3.5883494459315453`*^9, 3.5883495334077806`*^9}, {3.588349719924096*^9, 
   3.588349732143641*^9}, {3.588349768566889*^9, 3.588349770397334*^9}, 
   3.588350010993182*^9, {3.588350187835333*^9, 3.588350188754326*^9}, 
   3.588350232598345*^9, {3.588350394108876*^9, 3.5883504910303164`*^9}, {
   3.5883505392406607`*^9, 3.588350545369143*^9}, {3.5883526429882812`*^9, 
   3.588352644550036*^9}, 3.5883536157909193`*^9, {3.588353686509448*^9, 
   3.588353716275464*^9}, {3.5883537717236223`*^9, 3.588353827950984*^9}, {
   3.588353933665193*^9, 3.588353945849354*^9}, {3.58835407552075*^9, 
   3.588354133164813*^9}, {3.588354178423129*^9, 3.588354209382457*^9}, {
   3.5883543228838787`*^9, 3.588354470697712*^9}, {3.588354580359445*^9, 
   3.588354585980525*^9}, {3.5883546356838512`*^9, 3.5883548177558107`*^9}, {
   3.588354885050126*^9, 3.588354886780108*^9}, {3.5887183569200697`*^9, 
   3.5887183670237827`*^9}, 3.588718974811336*^9, {3.58871956879832*^9, 
   3.5887195787210417`*^9}, {3.588719657100112*^9, 3.58871967107408*^9}, {
   3.588720226855895*^9, 3.588720291837207*^9}, {3.5887203870676107`*^9, 
   3.588720389142707*^9}, {3.588722186678166*^9, 3.588722280758773*^9}, {
   3.5887223409057827`*^9, 3.588722411107128*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["XLogPlot (interplationSet)", "Subsubsection",
 CellChangeTimes->{{3.58772962232358*^9, 3.587729627787209*^9}, {
  3.588717209291757*^9, 3.5887172133235397`*^9}}],

Cell["\<\
Forked from MathSBML - SBMLLogPlot v 0.93a\
\>", "Text",
 CellChangeTimes->{{3.5887172180200768`*^9, 3.588717232940576*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"XLogPlot", "[", 
    RowBox[{
     RowBox[{"q_", "?", "InterpolationSetListQ"}], ",", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dbg", "=", "False"}], ",", "vars", ",", "data", ",", 
       "getvars", ",", "times", ",", "tbegin", ",", "tend", ",", "legends", 
       ",", "colors", ",", "n", ",", "p", ",", "selectRealPositives", ",", 
       " ", "dPrint"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"dPrint", "[", "u___", "]"}], ":=", " ", 
       RowBox[{"If", "[", 
        RowBox[{"dbg", ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{
           RowBox[{"\"\<XLogPlot:\>\"", "//", "boldRed"}], ",", " ", "u"}], 
          "]"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"getvars", "[", 
        RowBox[{"InterpolationSet", "[", 
         RowBox[{"t1_", ",", "t2_", ",", "sol_"}], "]"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "vars", "}"}], ",", 
         RowBox[{
          RowBox[{"vars", "=", 
           RowBox[{"First", "/@", "sol"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"vars", "=", 
           RowBox[{
            RowBox[{"StringReplace", "[", 
             RowBox[{
              RowBox[{"stringer", "/@", "vars"}], ",", 
              RowBox[{"\"\<[t]\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], "//", 
            "ToExpression"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{
            RowBox[{
            "\"\<Interpolation Set: getVars: \>\"", "//", "boldBlue"}], ",", 
            RowBox[{"\"\<{t1,t2}=\>\"", "//", "boldBlack"}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"t1", ",", "t2"}], "}"}], "//", "boldRed"}], ",", 
            RowBox[{"\"\<vars=\>\"", "//", "boldBlack"}], ",", 
            RowBox[{"vars", "//", "boldRed"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Return", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"t1", ",", "t2"}], "}"}], ",", "vars"}], "}"}], "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vars", "=", 
       RowBox[{"getvars", "/@", "q"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"times", "=", 
       RowBox[{"First", "/@", "vars"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vars", "=", 
       RowBox[{"Last", "/@", "vars"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tbegin", "=", 
       RowBox[{"Min", "[", "times", "]"}]}], ";", 
      RowBox[{"tend", "=", 
       RowBox[{"Max", "[", "times", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vars", "=", 
       RowBox[{
        RowBox[{"Intersection", "[", "vars", "]"}], "//", "Flatten"}]}], ";", 
      
      RowBox[{"(*", 
       RowBox[{
       "might", " ", "loose", " ", "variables", " ", "if", " ", "the", " ", 
        "sets", " ", "are", " ", "different"}], "*)"}], 
      RowBox[{"legends", "=", 
       RowBox[{"decontextify", "[", 
        RowBox[{"stringer", "/@", "vars"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "legends", "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"colors", "=", 
       RowBox[{"Map", "[", 
        RowBox[{"Hue", ",", 
         RowBox[{
          RowBox[{"Range", "[", "n", "]"}], "/", 
          RowBox[{"(", 
           RowBox[{"1.0", "*", "n"}], ")"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"MultiPlot$Colors", "=", "colors"}], ";", "\[IndentingNewLine]", 
      RowBox[{"MultiPlot$Styles", "=", "colors"}], ";", "\[IndentingNewLine]", 
      RowBox[{"MultiPlot$Legends", "=", "legends"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{
        RowBox[{"\"\<Interpolation Set:\>\"", "//", "boldBlue"}], ",", 
        RowBox[{"\"\<vars=\>\"", "//", "boldBlack"}], ",", 
        RowBox[{"vars", "//", "boldRed"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{
        RowBox[{"\"\<Interpolation Set:\>\"", "//", "boldBlue"}], ",", 
        RowBox[{"\"\<times=\>\"", "//", "boldBlack"}], ",", 
        RowBox[{"times", "//", "boldRed"}], ",", 
        RowBox[{"\"\< tbegin=\>\"", "//", "boldBlack"}], ",", 
        RowBox[{"tbegin", "//", "boldRed"}], ",", 
        RowBox[{"\"\< tend=\>\"", "//", "boldBlack"}], ",", 
        RowBox[{"tend", "//", "boldRed"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"data", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"dataTable", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{"Global`t", ",", "tbegin", ",", "tend", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"tend", "-", "tbegin"}], ")"}], "/", "50."}]}], "}"}], 
           ",", "q"}], "]"}], "&"}], "/@", "vars"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"data", "=", 
       RowBox[{"Rest", "/@", "data"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"selectRealPositives", "[", "z_", "]"}], ":=", 
       RowBox[{"Select", "[", 
        RowBox[{"z", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Im", "[", 
              RowBox[{"Last", "[", "#", "]"}], "]"}], "\[Equal]", "0"}], "&&", 
            RowBox[{
             RowBox[{"Re", "[", 
              RowBox[{"Last", "[", "#", "]"}], "]"}], ">", 
             "X$LogPlotZero"}]}], ")"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"data", "=", 
       RowBox[{"selectRealPositives", "/@", "data"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Off", "[", 
       RowBox[{"Graphics", "::", "gptn"}], "]"}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"p", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"LogListPlot", "[", 
           RowBox[{"#1", ",", "opt", ",", 
            RowBox[{"PlotJoined", "\[Rule]", "True"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", "#2"}], ",", 
            RowBox[{"DisplayFunction", "\[Rule]", "Identity"}]}], "]"}], 
          "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"data", ",", "colors"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"On", "[", 
       RowBox[{"Graphics", "::", "gptn"}], "]"}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"Return", "[", 
       RowBox[{"Show", "[", 
        RowBox[{"p", ",", "opt", ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "]"}], ";"}]}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.587729617724203*^9, 3.587729617725151*^9}, {
  3.588717011889135*^9, 3.588717013144763*^9}, {3.588717047532502*^9, 
  3.588717149059314*^9}, {3.588717201596519*^9, 3.5887172025424*^9}, {
  3.5887181170885067`*^9, 3.58871812386479*^9}, {3.588719727048175*^9, 
  3.588719730254817*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["XLogPlot (single solution)", "Subsubsection",
 CellChangeTimes->{{3.5877296490354567`*^9, 3.5877296576588173`*^9}, {
  3.588717253339177*^9, 3.588717254331046*^9}}],

Cell[CellGroupData[{

Cell["\<\
forked from MathSBMl`SBMLLogPlot v.093a\
\>", "Text",
 CellChangeTimes->{{3.588717237899187*^9, 3.588717250459103*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"XLogPlot", "[", 
     RowBox[{"sol_", ",", 
      RowBox[{"var_", "?", "ListQ"}], ",", 
      RowBox[{"{", 
       RowBox[{"tbegin_", ",", "tend_"}], "}"}], ",", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "n", ",", "p", ",", "colors", ",", "legend", ",", "autoscale", ",", 
        "man", ",", "mans", ",", "exps", ",", 
        RowBox[{"dbg", "=", "False"}], ",", " ", "soln", ",", " ", "dPrint", 
        ",", " ", "plottable"}], "}"}], ",", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"add", " ", "autoscaling", " ", "6"}], "-", "2", "-", "04"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dbg", "=", "DEBUGPLOT"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dPrint", "[", "u___", "]"}], ":=", " ", 
        RowBox[{"If", "[", 
         RowBox[{"dbg", ",", " ", 
          RowBox[{"Print", "[", 
           RowBox[{
            RowBox[{"\"\<XLogPlot: \>\"", "//", "boldRed"}], ",", " ", "u"}], 
           "]"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"figure", " ", "out", " ", "the", " ", "max"}], "&"}], " ", 
         "minimum", " ", "value", " ", "plotted"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"soln", " ", "=", " ", "sol"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ToString", "[", 
           RowBox[{"Head", "[", "sol", "]"}], "]"}], "\[Equal]", 
          "\"\<InterpolationSet\>\""}], ",", " ", 
         RowBox[{"soln", "=", 
          RowBox[{"argument", "[", "soln", "]"}]}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{
        "\"\<var: \>\"", ",", " ", "var", ",", " ", 
         "\"\< {tbegin, tend}: \>\"", ",", " ", 
         RowBox[{"{", 
          RowBox[{"tbegin", ",", " ", "tend"}], "}"}], ",", " ", 
         "\"\< opt: \>\"", ",", " ", 
         RowBox[{"{", "opt", "}"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
       
       RowBox[{"plottable", "=", "var"}], ";", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<plottable: \>\"", ",", " ", "plottable"}], "]"}], ";", 
       " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"autoscale", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"findMiniMax", "[", 
           RowBox[{"soln", ",", "#", ",", 
            RowBox[{"{", 
             RowBox[{"tbegin", ",", "tend"}], "}"}], ",", 
            RowBox[{"\"\<filterNonPositives\>\"", "\[Rule]", "True"}], ",", 
            "opt"}], "]"}], "&"}], "/@", "var"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"autoscale", "=", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", "autoscale", "]"}], ",", "Positive"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"autoscale", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Min", "[", "autoscale", "]"}], ",", 
          RowBox[{"Max", "[", "autoscale", "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<autoscale: \>\"", ",", " ", "autoscale"}], "]"}], ";", 
       " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "plottable", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"colors", "=", 
        RowBox[{"Map", "[", 
         RowBox[{"Hue", ",", 
          RowBox[{
           RowBox[{"Range", "[", "n", "]"}], "/", 
           RowBox[{"(", 
            RowBox[{"1.0", "*", "n"}], ")"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "now", " ", "round", " ", "off", " ", "the", " ", "mantissa"}], 
        "*)"}], 
       RowBox[{"man", "=", 
        RowBox[{"MantissaExponent", "/@", "autoscale"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"mans", ",", "exps"}], "}"}], "=", 
        RowBox[{"Transpose", "[", "man", "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"mans", "=", 
        RowBox[{"10", "*", "mans"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"mans", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Floor", "[", 
           RowBox[{"mans", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
          RowBox[{"Ceiling", "[", 
           RowBox[{"mans", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mans", "=", 
        RowBox[{"mans", "/", "10."}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"man", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{"mans", ",", "exps"}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"autoscale", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "*", 
           RowBox[{"(", 
            RowBox[{"10", "^", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], "&"}], "/@", 
         "man"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"autoscale", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "<", "0"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
            RowBox[{"\"\<Warning:\>\"", "//", "boldOrange"}], ",", 
            RowBox[{
            "\"\< unable to autoscale logarithmic plot due to all data values \
being negative. Range of data values is \>\"", "//", "boldBlack"}], ",", 
            RowBox[{"autoscale", "//", "boldRed"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"autoscale", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"autoscale", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "}"}]}], ";"}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"autoscale", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "<", "0"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
            RowBox[{"\"\<Warning:\>\"", "//", "boldOrange"}], ",", 
            RowBox[{
            "\"\< unable to fully autoscale logarithmic plot due to negative \
data value. Range of data values is: \>\"", "//", "boldBlack"}], ",", 
            RowBox[{"autoscale", "//", "boldRed"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"autoscale", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"autoscale", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "*", "0.1"}], ",", 
             RowBox[{"autoscale", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<autoscale = \>\"", ",", "autoscale"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<opt = \>\"", ",", 
         RowBox[{"{", "opt", "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"p", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"XLogPlot", "[", 
            RowBox[{"soln", ",", 
             RowBox[{"#1", "[", "Global`t", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"tbegin", ",", "tend"}], "}"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", "#2"}], ",", 
             RowBox[{"DisplayFunction", "\[Rule]", "Identity"}], ",", "opt", 
             ",", 
             RowBox[{"PlotRange", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"tbegin", ",", " ", 
                  RowBox[{"tend", "+", 
                   RowBox[{".2", "*", 
                    RowBox[{"(", 
                    RowBox[{"tend", "-", "tbegin"}], ")"}]}]}]}], "}"}], ",", 
                " ", "autoscale"}], "}"}]}]}], "]"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"plottable", ",", "colors"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", "\"\<p generated.\>\"", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"p", "=", 
        RowBox[{"Show", "[", "p", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"legend", "=", 
        RowBox[{"{", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Graphics", "[", 
               RowBox[{"{", 
                RowBox[{"#1", ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}]}], "}"}], "]"}]}], "}"}], 
               "]"}], ",", 
              RowBox[{"decontextify", "[", 
               RowBox[{"ToString", "[", "#2", "]"}], "]"}]}], "}"}], "&"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"colors", ",", "plottable"}], "}"}]}], "]"}], "}"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"legend", "=", 
        RowBox[{"Append", "[", 
         RowBox[{"legend", ",", 
          RowBox[{"LegendPosition", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", ".5"}]}], "}"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"p", "=", 
          RowBox[{"ShowLegend", "[", 
           RowBox[{"p", ",", "legend"}], "]"}]}], ";"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"p", "=", 
        RowBox[{"Show", "[", 
         RowBox[{"{", 
          RowBox[{"p", ",", " ", "\[IndentingNewLine]", 
           RowBox[{"LogLegend", "[", 
            RowBox[{"plottable", ",", "colors", ",", " ", 
             RowBox[{"{", 
              RowBox[{"tbegin", ",", " ", "tend"}], "}"}], ",", " ", 
             "autoscale"}], "]"}]}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "p", "]"}], ";"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"XLogPlot", "[", 
    RowBox[{"soln_", ",", "var_", ",", 
     RowBox[{"{", 
      RowBox[{"tbegin_", ",", "tend_"}], "}"}], ",", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"dbg", "=", "False"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dbg", "=", "DEBUGPLOT"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"dbg", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<xLogPLOT: (single-var): opt \>\"", ",", 
          RowBox[{"{", "opt", "}"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ops", "=", 
          RowBox[{"MyFilterOptions", "[", 
           RowBox[{"LogPlot", ",", " ", "opt"}], "]"}]}], "}"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"LogPlot", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{"var", "/.", "soln"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"Global`t", ",", "tbegin", ",", "tend"}], "}"}], ",", 
          "ops"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\n"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.587729643933085*^9, 3.587729643933632*^9}, {
   3.588717292705626*^9, 3.588717501091457*^9}, {3.588717589325337*^9, 
   3.588717673492633*^9}, {3.588717964486539*^9, 3.58871796744676*^9}, {
   3.588718509121244*^9, 3.5887185994933567`*^9}, {3.5887187180255117`*^9, 
   3.588718753105538*^9}, {3.588718991620401*^9, 3.588719013219771*^9}, {
   3.588719125357318*^9, 3.58871913031746*^9}, {3.588719936198447*^9, 
   3.588719946293838*^9}, {3.588721548977721*^9, 3.588721551380157*^9}, {
   3.588721650689229*^9, 3.58872165313944*^9}, {3.58872168576155*^9, 
   3.58872170150597*^9}, {3.5887217494996243`*^9, 3.588721770550538*^9}, {
   3.58872191250957*^9, 3.58872191534533*^9}, {3.5887219851496887`*^9, 
   3.588722027894402*^9}, {3.588722111220583*^9, 3.58872211671443*^9}, {
   3.58872230135533*^9, 3.588722301942974*^9}, {3.58872248195604*^9, 
   3.5887225493995037`*^9}, {3.5887234586463757`*^9, 3.588723484772533*^9}, 
   3.5887235375651817`*^9, {3.588723571769937*^9, 3.588723751436017*^9}}]
}, Open  ]],

Cell["\<\
can\[CloseCurlyQuote]t figure out why vertical spacing gets squished upon \
return to calling program\
\>", "Text",
 CellChangeTimes->{{3.588723807191411*^9, 3.588723829838644*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LogLegend", "[", 
    RowBox[{
     RowBox[{"names_", "?", "ListQ"}], ",", 
     RowBox[{"colors_", "?", "ListQ"}], ",", " ", "xscale_", ",", " ", 
     "yscale_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "p", ",", "n", ",", "nc", ",", "x", ",", "y", ",", "xy", ",", " ", 
       "xmax", ",", " ", "xmin", ",", "ymax", ",", "ymin"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "names", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nc", "=", 
       RowBox[{"Length", "[", "colors", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"n", "\[NotEqual]", "nc"}], ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
           RowBox[{"\"\<Error:\>\"", "//", "boldRed"}], ",", 
           RowBox[{"\"\<MyLegend:\>\"", "//", "boldBlue"}], ",", 
           RowBox[{"\"\< number of names = \>\"", "//", "boldBlack"}], ",", 
           RowBox[{"n", "//", "boldBlack"}], ",", 
           RowBox[{
           "\"\< is different from the number of colors = \>\"", "//", 
            "boldBlack"}], ",", 
           RowBox[{"nc", "//", "boldBlack"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"x", "=", "1.1"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"xmin", ",", "xmax"}], "}"}], "=", "xscale"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ymin", ",", "ymax"}], "}"}], "=", "yscale"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"x", "=", 
       RowBox[{"xmax", " ", "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"xmax", "-", "xmin"}], ")"}], "*", ".1"}]}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"xy", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Scaled", "[", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"1", "-", 
             RowBox[{"1.0", "*", 
              RowBox[{"y", "/", 
               RowBox[{"(", 
                RowBox[{"n", "+", "1"}], ")"}]}]}]}]}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"xy", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", " ", 
           RowBox[{
            RowBox[{"Log", "[", 
             RowBox[{"10", ",", "ymin"}], "]"}], "+", " ", 
            RowBox[{"y", "*", " ", 
             RowBox[{
              RowBox[{"Log", "[", 
               RowBox[{"10", ",", 
                RowBox[{"ymax", "/", "ymin"}]}], "]"}], "/", 
              RowBox[{"(", 
               RowBox[{"n", "+", "1.0"}], ")"}]}]}]}]}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"y", ",", " ", "1", ",", " ", "n"}], "}"}]}], "]"}]}], ";", 
      " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"p", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Text", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"stringer", "/@", "names"}], ",", "xy"}], "}"}]}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"p", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"colors", ",", "p"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"p", "=", 
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"Graphics", "/@", "p"}], ",", " ", 
         RowBox[{"AspectRatio", "\[Rule]", " ", 
          RowBox[{"1.0", "/", "GoldenRatio"}]}]}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.588722437802099*^9, 3.588722470599924*^9}, {
   3.588722553262622*^9, 3.588722616528723*^9}, {3.588722707633237*^9, 
   3.5887227205732737`*^9}, {3.5887229419029903`*^9, 3.588723062304817*^9}, {
   3.588723121296126*^9, 3.588723128066072*^9}, 3.588723232270697*^9, {
   3.5887233005353403`*^9, 3.588723304239132*^9}, {3.5887233369854918`*^9, 
   3.588723367926661*^9}, {3.588723501262927*^9, 3.588723524471695*^9}, {
   3.588723761573413*^9, 3.588723761843972*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["findMiniMax", "Subsubsection",
 CellChangeTimes->{{3.588717858144063*^9, 3.5887178604399*^9}}],

Cell["ported from MathSBML in v093a", "Text",
 CellChangeTimes->{{3.58871786350406*^9, 3.588717871759371*^9}, {
  3.590334158370949*^9, 3.590334168276745*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"findMiniMax", "[", 
   RowBox[{"n_", ",", "var_", ",", 
    RowBox[{"{", 
     RowBox[{"tbegin_", ",", "tend_"}], "}"}], ",", 
    RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "npts", ",", "ops", ",", "dt", ",", "max", ",", "min", ",", "i", ",", 
      "x", ",", "times", ",", "if", ",", "positiveOnly", ",", "msave", ",", 
      " ", "dbg", ",", " ", "dPrint"}], "}"}], ",", 
    RowBox[{
     RowBox[{"ops", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"{", "opt", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"positiveOnly", "=", 
      RowBox[{
       RowBox[{"\"\<filterNonPositives\>\"", "/.", "ops"}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<filterNonPositives\>\"", "\[Rule]", "False"}], "}"}]}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"dbg", "=", "DEBUGPLOT"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dPrint", "[", "u___", "]"}], ":=", " ", 
      RowBox[{"If", "[", 
       RowBox[{"dbg", ",", " ", 
        RowBox[{"Print", "[", 
         RowBox[{
          RowBox[{"\"\<findMiniMax: \>\"", "//", "boldRed"}], ",", " ", "u"}],
          "]"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<ops: \>\"", ",", " ", "ops"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"npts", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"PlotPoints", "/.", "ops"}], "/.", 
        RowBox[{"{", 
         RowBox[{"PlotPoints", "\[Rule]", "50"}], "}"}]}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dt", "=", 
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"tbegin", "-", "tend"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"1.0", "*", "npts"}], ")"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"times", "=", 
      RowBox[{"Range", "[", 
       RowBox[{
        RowBox[{"Min", "[", 
         RowBox[{"tbegin", ",", "tend"}], "]"}], ",", 
        RowBox[{"Max", "[", 
         RowBox[{"tbegin", ",", "tend"}], "]"}], ",", "dt"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"if", "=", 
      RowBox[{
       RowBox[{"var", "[", "Global`t", "]"}], "/.", "n"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<if: \>\"", ",", " ", "if"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"max", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Evaluate", "[", 
         RowBox[{"if", "/.", 
          RowBox[{"{", 
           RowBox[{"Global`t", "\[Rule]", "#"}], "}"}]}], "]"}], "&"}], "/@", 
       "times"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"max", "=", 
      RowBox[{"Flatten", "[", "max", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{
      "\"\<var: \>\"", ",", " ", "var", ",", " ", "\"\< max: \>\"", ",", " ", 
       
       RowBox[{"Short", "[", "max", "]"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"positiveOnly", ",", 
       RowBox[{
        RowBox[{"msave", "=", "max"}], ";", "\[IndentingNewLine]", 
        RowBox[{"max", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"max", ",", "Positive"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "max", "]"}], "<", "1"}], ",", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
             RowBox[{"\"\<Warning:\>\"", "//", "boldOrange"}], ",", 
             RowBox[{
             "\"\< unable to plot the variable \>\"", "//", "boldBlack"}], 
             ",", 
             RowBox[{"var", "//", "boldRed"}], ",", 
             RowBox[{
             "\"\< on a logarithmic scale because it never takes on a \
positive value.\>\"", "//", "boldBlack"}]}], "]"}], ";", 
           RowBox[{"max", "=", "msave"}], ";", "\[IndentingNewLine]", 
           RowBox[{"plottable", "=", 
            RowBox[{"Complement", "[", 
             RowBox[{"plottable", ",", 
              RowBox[{"{", "var", "}"}]}], "]"}]}], ";"}]}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "max", "]"}], "\[NotEqual]", 
           RowBox[{"Length", "[", "msave", "]"}]}], ",", 
          RowBox[{"Print", "[", 
           RowBox[{
            RowBox[{"\"\<Warning:\>\"", "//", "boldOrange"}], ",", 
            RowBox[{
            "\"\< Some values of the variable \>\"", "//", "boldBlack"}], ",", 
            RowBox[{"var", "//", "boldRed"}], ",", 
            RowBox[{
            "\"\< can not be plotted on a logarithmic scale because they do \
not evaluate to a positive number.\>\"", "//", "boldBlack"}]}], "]"}]}], 
         "]"}], ";"}], " ", "*)"}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"min", "=", 
      RowBox[{"Min", "[", "max", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"max", "=", 
      RowBox[{"Max", "[", "max", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<{min,max}: \>\"", ",", " ", 
       RowBox[{"{", 
        RowBox[{"min", ",", "max"}], "}"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{"min", ",", "max"}], "}"}], "]"}], ";"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5887178536447678`*^9, 3.588717853646344*^9}, {
  3.58871793654704*^9, 3.5887179449774218`*^9}, {3.588717982330174*^9, 
  3.5887180576387787`*^9}, {3.5887181633812513`*^9, 3.5887181760813513`*^9}, {
  3.588718657678059*^9, 3.588718685552064*^9}, {3.588720858783716*^9, 
  3.5887208678678513`*^9}}]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["steadyState", "Section"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"steadyState", "[", 
     RowBox[{"r_", ",", 
      RowBox[{"t_:", "Global`t"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"eqs", ",", "vars"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"interpreted", "[", "r", "]"}], ",", " ", 
         RowBox[{"eqs", "=", "r"}], ",", 
         RowBox[{"eqs", "=", 
          RowBox[{"interpret", "[", "r", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"eqs", ",", "vars"}], "}"}], "=", "eqs"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"vars", " ", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", "t", "]"}], "&"}], "/@", "vars"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       StyleBox[
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"in", " ", 
           RowBox[{"5.0", "++"}]}], ",", " ", 
          RowBox[{
           RowBox[{
           "equation", " ", "will", " ", "not", " ", "necessarily", " ", "be",
             " ", "of", " ", "the", " ", "form", " ", 
            RowBox[{"x", "'"}]}], "=", 
           RowBox[{
            RowBox[{
            "stuff", " ", "but", " ", "may", " ", "be", " ", "an", " ", 
             "equation", " ", "will", " ", "be", " ", "an", " ", "expression",
              " ", "involving", " ", 
             RowBox[{"x", "'"}]}], ":", " ", 
            RowBox[{"need", " ", "to", " ", "solve", " ", "for", " ", 
             RowBox[{
              RowBox[{"x", "'"}], "[", "t", "]"}]}]}]}]}], " ", "*)"}],
        FontColor->RGBColor[0, 0, 1]], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"eqs", "=", 
        RowBox[{"Last", "/@", 
         RowBox[{"Flatten", "[", 
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Solve", "[", 
              RowBox[{"#1", ",", 
               RowBox[{"D", "[", 
                RowBox[{"#2", ",", 
                 RowBox[{"{", 
                  RowBox[{"t", ",", "1"}], "}"}]}], "]"}]}], "]"}], "&"}], 
            ",", " ", 
            RowBox[{"{", 
             RowBox[{"eqs", ",", "vars"}], "}"}]}], "]"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"eqs", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Equal", "[", 
           RowBox[{"#", ",", "0"}], "]"}], "&"}], "/@", "eqs"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Solve", "[", 
        RowBox[{"eqs", ",", "vars"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"steadyState", "[", 
   RowBox[{"r_", ",", "t_", ",", " ", "varlist_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"teqs", ",", "vars", ",", "p"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"interpreted", "[", "r", "]"}], ",", " ", 
       RowBox[{"eqs", "=", "r"}], ",", 
       RowBox[{"eqs", "=", 
        RowBox[{"interpret", "[", "r", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"teqs", "=", 
      RowBox[{"Transpose", "[", "eqs", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"eqs", ",", "vars"}], "}"}], "=", "eqs"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"p", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"vars", ",", "#"}], "]"}], "&"}], "/@", "varlist"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"eqs", ",", "vars"}], "}"}], "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"teqs", "[", 
        RowBox[{"[", "p", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"eqs", "=", 
      RowBox[{"Last", "/@", 
       RowBox[{"Flatten", "[", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Solve", "[", 
            RowBox[{"#1", ",", 
             RowBox[{"D", "[", 
              RowBox[{"#2", ",", 
               RowBox[{"{", 
                RowBox[{"t", ",", "1"}], "}"}]}], "]"}]}], "]"}], "&"}], ",", 
          " ", 
          RowBox[{"{", 
           RowBox[{"eqs", ",", "vars"}], "}"}]}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"eqs", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Equal", "[", 
         RowBox[{"#", ",", "0"}], "]"}], "&"}], "/@", "eqs"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Solve", "[", 
      RowBox[{"eqs", ",", "vars"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["PhasePlot", "Section",
 CellChangeTimes->{{3.426974643615991*^9, 3.426974648679386*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PhasePlot", "[", 
     RowBox[{"sim_", ",", " ", 
      RowBox[{"{", 
       RowBox[{"x_", ",", "y_"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"tstart_", ",", " ", "tend_"}], "}"}], ",", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"r", ",", " ", "p"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"r", "=", 
        RowBox[{"Flatten", "[", "sim", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"p", " ", "=", " ", 
        RowBox[{"ParametricPlot", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x", "[", "t", "]"}], ",", 
              RowBox[{"y", "[", "t", "]"}]}], "}"}], "/.", "r"}], "]"}], ",", 
          
          RowBox[{"{", 
           RowBox[{"t", ",", "tstart", ",", "tend"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"AxesLabel", "\[Rule]", " ", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}]}], ",", "\[IndentingNewLine]", 
          "opt"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "p", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.426973455257569*^9, 3.426973505789487*^9}, {
  3.426973663262257*^9, 3.42697371953514*^9}, {3.426973791522731*^9, 
  3.426973819269009*^9}, {3.426974613825129*^9, 3.426974628880301*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["PredictTransferFunction", "Section",
 CellChangeTimes->{{3.426974659097375*^9, 3.42697466221892*^9}}],

Cell["\<\
rev. 0.73 - add local variable \"r\" declaration (was conflicting with same \
variable in expand arrows .. it should not ever have been a global)\
\>", "Text",
 CellChangeTimes->{{3.451250048801766*^9, 3.45125007789466*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PredictTransferFunction", "[", 
   RowBox[{"stn_", ",", " ", 
    RowBox[{"{", 
     RowBox[{"time_", ",", " ", "tbegin_", ",", " ", "tend_"}], "}"}], ",", 
    " ", 
    RowBox[{"{", 
     RowBox[{
     "inputVariable_", ",", " ", "inmin_", ",", " ", "inmax_", ",", " ", 
      "indelta_"}], "}"}], ",", "\[IndentingNewLine]", "outputVariable_", ",", 
    RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"getvar", ",", " ", 
      RowBox[{"dbg", "=", "False"}], ",", " ", "dpr", ",", " ", "getopt", ",",
       " ", "ic", ",", " ", "value", ",", " ", "currentICs", ",", " ", 
      "currentrates", ",", "num", ",", " ", "output", ",", " ", "nextoutput", 
      ",", " ", "outvars", ",", " ", "integrate", ",", "results", ",", " ", 
      "f", ",", " ", "ratemode", ",", " ", "ICmode", ",", " ", "col1label", 
      ",", " ", "eqs", ",", " ", "vars", ",", " ", "syms", ",", " ", "r"}], 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dbg", " ", "=", " ", 
      RowBox[{
       RowBox[{"\"\<Debug\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<Debug\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";", 
     " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dpr", "[", "x___", "]"}], ":=", " ", 
      RowBox[{"If", "[", 
       RowBox[{"dbg", ",", " ", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<PredictTransferFunction: \>\"", ",", " ", "x"}], 
         "]"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"getopt", "[", 
       RowBox[{"x_", ",", " ", "defaultvalue_"}], "]"}], ":=", " ", 
      RowBox[{
       RowBox[{"x", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"x", "\[Rule]", " ", "defaultvalue"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"outvars", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", "time", "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", "outputVariable", "}"}], "]"}], ")"}]}], ")"}]}], ";", 
     " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", "  ", 
      RowBox[{
      "do", " ", "an", " ", "interpret", " ", "to", " ", "make", " ", "sure", 
       " ", "system", " ", "is", " ", "well", " ", "formed"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"eqs", ",", " ", "vars"}], "}"}], "=", 
      RowBox[{"interpret", "[", "stn", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"syms", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"getSymbols", "[", "eqs", "]"}], ",", " ", 
          RowBox[{
           RowBox[{"Not", "[", 
            RowBox[{
             RowBox[{"Context", "[", "#", "]"}], "\[Equal]", 
             "\"\<System`\>\""}], "]"}], "&"}]}], "]"}], ",", " ", "vars"}], 
       "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"syms", " ", "=", " ", 
      RowBox[{"Complement", "[", 
       RowBox[{"syms", ",", " ", 
        RowBox[{"{", "time", "}"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "determine", " ", "if", " ", "the", " ", "requested", " ", 
       "inputVariable", " ", "is", " ", "a", " ", "variable", " ", "or", " ", 
       "a", " ", "parameter"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"syms", ",", " ", "inputVariable"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ratemode", "=", "True"}], ";", " ", 
        RowBox[{"ICmode", "=", "False"}], ";"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"vars", ",", " ", "inputVariable"}], "]"}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ratemode", "=", "False"}], ";", " ", 
           RowBox[{"ICmode", "=", "True"}], ";"}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Error: PredictTransferFunction: symbol \>\"", ",", " ", 
             "inputVariable", ",", " ", "\"\< not found!\>\""}], "]"}], ";", 
           " ", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "$Failed", "]"}], ";"}]}], " ", 
         "\[IndentingNewLine]", "]"}], ";"}]}], " ", "\[IndentingNewLine]", 
      "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"dpr", "[", 
      RowBox[{
      "\"\<ratemode=\>\"", ",", " ", "ratemode", ",", " ", "\"\< ICmode=\>\"",
        ",", " ", "ICmode"}], "]"}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"format", " ", "the", " ", "rate", " ", "constants"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "global", " ", "variable", " ", "rates", " ", "is", " ", "for", " ", 
       "backward", " ", "compatibility"}], " ", "*)"}], "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"r", "=", 
      RowBox[{"getopt", "[", 
       RowBox[{"\"\<Parameters\>\"", ",", 
        RowBox[{"{", "}"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "r", "]"}], "<", "1"}], ",", " ", 
       RowBox[{"r", " ", "=", " ", 
        RowBox[{"getopt", "[", 
         RowBox[{"rates", ",", " ", 
          RowBox[{"{", "}"}]}], "]"}]}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"ratemode", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"r", "=", 
         RowBox[{"(", 
          RowBox[{"r", "/.", 
           RowBox[{"{", 
            RowBox[{"Rule", "\[Rule]", " ", "List"}], "}"}]}], ")"}]}], ";", 
        " ", "\[IndentingNewLine]", 
        RowBox[{"r", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"r", ",", " ", 
           RowBox[{
            RowBox[{"Not", "[", 
             RowBox[{"SameQ", "[", 
              RowBox[{"inputVariable", ",", " ", 
               RowBox[{"First", "[", "#", "]"}]}], "]"}], "]"}], "&"}]}], 
          "]"}]}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"r", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "/.", 
             RowBox[{"{", 
              RowBox[{"List", "\[Rule]", " ", "Rule"}], "}"}]}], ")"}], "&"}],
           "/@", "r"}]}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"col1label", "=", "inputVariable"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dpr", "[", 
         RowBox[{"\"\<r=\>\"", ",", " ", "r"}], "]"}], ";"}]}], " ", 
      "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"format", " ", "the", " ", "initial", " ", "conditions"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "global", " ", "variable", " ", "initialConditions", " ", "is", " ", 
       "for", " ", "backwards", " ", "compatibility"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"ic", " ", "=", " ", 
      RowBox[{"getopt", "[", 
       RowBox[{"\"\<IC\>\"", ",", 
        RowBox[{"{", "}"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "ic", "]"}], "<", "1"}], ",", " ", 
       RowBox[{"ic", " ", "=", " ", 
        RowBox[{"getopt", "[", 
         RowBox[{"initialConditions", ",", 
          RowBox[{"{", "}"}]}], "]"}]}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"ICmode", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ic", " ", "=", " ", 
         RowBox[{"ic", "/.", 
          RowBox[{"{", 
           RowBox[{"Rule", "\[Rule]", " ", "List"}], "}"}]}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"ic", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"ic", ",", " ", 
           RowBox[{
            RowBox[{"Not", "[", 
             RowBox[{"SameQ", "[", 
              RowBox[{"inputVariable", ",", " ", 
               RowBox[{"First", "[", "#", "]"}]}], "]"}], "]"}], "&"}]}], 
          "]"}]}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"ic", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "/.", 
             RowBox[{"{", 
              RowBox[{"List", "\[Rule]", " ", "Rule"}], "}"}]}], ")"}], "&"}],
           "/@", "ic"}]}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"col1label", "=", 
         RowBox[{"inputVariable", "[", "tbegin", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dpr", "[", 
         RowBox[{"\"\<ic=\>\"", ",", " ", "ic"}], "]"}], ";"}]}], " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"integrate", "=", 
      RowBox[{"getopt", "[", 
       RowBox[{"\"\<Integrate\>\"", ",", " ", "False"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"f", "[", "x_", "]"}], ":=", " ", 
      RowBox[{
       RowBox[{"getopt", "[", 
        RowBox[{"\"\<Function\>\"", ",", " ", 
         RowBox[{"(", 
          RowBox[{"#", "&"}], ")"}]}], "]"}], "[", "x", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"dpr", "[", 
      RowBox[{"\"\<r: \>\"", ",", " ", "r"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"dpr", "[", 
      RowBox[{"\"\<ic: \>\"", ",", " ", "ic"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"{", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{"col1label", ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", "tend", "]"}], "&"}], "/@", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", "outputVariable", "}"}], "]"}]}]}], "}"}], "]"}], 
       "}"}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"value", " ", "=", " ", "inmin"}], ",", " ", 
       RowBox[{"value", "\[LessEqual]", " ", "inmax"}], ",", " ", 
       RowBox[{"value", "=", 
        RowBox[{"value", "+", "indelta"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dpr", "[", 
         RowBox[{"\"\<------ value: \>\"", ",", " ", "value"}], "]"}], ";", 
        " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"ICmode", ",", "\[IndentingNewLine]", 
          RowBox[{"currentICs", "=", 
           RowBox[{"Append", "[", 
            RowBox[{"ic", ",", " ", 
             RowBox[{"inputVariable", "\[Rule]", " ", "value"}]}], "]"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"currentICs", "=", "ic"}]}], "\[IndentingNewLine]", "]"}], 
        ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"ratemode", ",", "\[IndentingNewLine]", 
          RowBox[{"currentrates", "=", 
           RowBox[{"Append", "[", 
            RowBox[{"r", ",", " ", 
             RowBox[{"inputVariable", "\[Rule]", " ", "value"}]}], "]"}]}], 
          ",", " ", "\[IndentingNewLine]", 
          RowBox[{"currentrates", "=", "r"}]}], "\[IndentingNewLine]", "]"}], 
        ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"dpr", "[", 
         RowBox[{"\"\<currentICs: \>\"", ",", " ", "currentICs"}], "]"}], ";",
         " ", "\[IndentingNewLine]", 
        RowBox[{"dpr", "[", 
         RowBox[{"\"\<currentrates: \>\"", ",", " ", "currentrates"}], "]"}], 
        ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"num", "=", 
         RowBox[{"run", "[", 
          RowBox[{"stn", ",", " ", "\[IndentingNewLine]", 
           RowBox[{"timeSpan", "\[Rule]", " ", 
            RowBox[{"{", 
             RowBox[{"tbegin", ",", " ", "tend"}], "}"}]}], ",", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<Parameters\>\"", "\[Rule]", " ", "currentrates"}], 
           ",", " ", "\[IndentingNewLine]", 
           RowBox[{"\"\<IC\>\"", "\[Rule]", " ", "currentICs"}], ",", 
           "\[IndentingNewLine]", "opt"}], "\[IndentingNewLine]", "]"}]}], 
        ";", " ", "\[IndentingNewLine]", 
        RowBox[{"dpr", "[", 
         RowBox[{"\"\<num:\>\"", ",", " ", "num"}], "]"}], ";", " ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"integrate", ",", "\[IndentingNewLine]", 
          RowBox[{"results", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"NIntegrate", "[", 
               RowBox[{
                RowBox[{"f", "[", 
                 RowBox[{"#", "/.", "num"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"time", ",", "tbegin", ",", "tend"}], "}"}]}], "]"}],
               "&"}], ",", " ", "outvars"}], "]"}]}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"results", " ", "=", 
           RowBox[{"f", "/@", 
            RowBox[{"(", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"outvars", "/.", 
                RowBox[{"Flatten", "[", "num", "]"}]}], ")"}], "/.", 
              RowBox[{"{", 
               RowBox[{"time", "\[Rule]", " ", "tend"}], "}"}]}], ")"}]}]}]}],
          "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"nextoutput", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{"value", ",", " ", "results"}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"output", ",", " ", "nextoutput"}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"dpr", "[", 
         RowBox[{
         "\"\<end of step: r=\>\"", ",", " ", "r", ",", " ", 
          "\"\< currentrates=\>\"", ",", " ", "currentrates"}], "]"}], 
        ";"}]}], " ", "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "output", "]"}], ";"}]}], " ", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.426974670348757*^9, 3.426974687491539*^9}, {
   3.426974792458045*^9, 3.426974870619747*^9}, {3.426974906022158*^9, 
   3.426974910160719*^9}, {3.426974941254072*^9, 3.426975072892846*^9}, {
   3.426975104756934*^9, 3.426975462338856*^9}, {3.426975512427285*^9, 
   3.426975514766999*^9}, 3.426975636197602*^9, {3.426975689704844*^9, 
   3.426975878412231*^9}, {3.426975917116863*^9, 3.426976131656739*^9}, {
   3.426976161852991*^9, 3.426976245623584*^9}, {3.426976296101513*^9, 
   3.426976652106073*^9}, {3.426976688552337*^9, 3.426976783659939*^9}, {
   3.426976822398993*^9, 3.426976915952063*^9}, {3.426976984619285*^9, 
   3.426977114618943*^9}, {3.426977188726825*^9, 3.426977240417501*^9}, {
   3.426977294464045*^9, 3.426977323693765*^9}, {3.426977355494176*^9, 
   3.426977355636268*^9}, {3.426977412690824*^9, 3.42697743599798*^9}, {
   3.426977482122666*^9, 3.426977525195613*^9}, {3.426977564630612*^9, 
   3.42697756512662*^9}, {3.426977698579939*^9, 3.426977699889082*^9}, {
   3.426977731827754*^9, 3.426977738923595*^9}, {3.426979581349909*^9, 
   3.426979582814071*^9}, {3.42698006717576*^9, 3.426980131938803*^9}, {
   3.426980164370446*^9, 3.426980197712853*^9}, {3.4269806593312*^9, 
   3.426980748683603*^9}, {3.42698078852991*^9, 3.426980876674151*^9}, {
   3.426980916276482*^9, 3.426980927183736*^9}, {3.426980973077721*^9, 
   3.426980980681143*^9}, {3.426981055414671*^9, 3.426981090751327*^9}, {
   3.426982436294023*^9, 3.426982442092242*^9}, 3.426982572904912*^9, {
   3.42698285221242*^9, 3.426982853019749*^9}, {3.426982906330594*^9, 
   3.426982993816729*^9}, {3.426983059419626*^9, 3.426983580081776*^9}, {
   3.426983706931052*^9, 3.4269837122247*^9}, {3.426984114226652*^9, 
   3.426984282785685*^9}, {3.426984324773847*^9, 3.426984425374158*^9}, {
   3.426984471696959*^9, 3.426984577517226*^9}, {3.426984608167911*^9, 
   3.426984799648962*^9}, {3.426984829927748*^9, 3.426984900572716*^9}, {
   3.426985188032837*^9, 3.426985188595061*^9}, {3.4269853111255*^9, 
   3.426985311849987*^9}, {3.450712748764922*^9, 3.450712764261588*^9}, {
   3.450712960549775*^9, 3.450713049308413*^9}, {3.450713106420766*^9, 
   3.45071312282353*^9}, {3.450713259071035*^9, 3.4507132735688066`*^9}, {
   3.4507133489647512`*^9, 3.450713349272109*^9}, {3.560872670627063*^9, 
   3.5608727750474*^9}, {3.560872835187992*^9, 3.56087285789428*^9}, 
   3.587660219120083*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["help", "Section",
 CellChangeTimes->{{3.425337964048409*^9, 3.425337964772546*^9}}],

Cell["\<\
This plugs into the MathSBML`help standardidzed help function which looks for \
context`Private`contexthelp[]\
\>", "Text",
 CellChangeTimes->{{3.4254104604876013`*^9, 3.425410499034296*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"xlr8rhelp", "[", "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "names", ",", " ", "usagestrings", ",", " ", "print", ",", " ", "ok"}], 
      "}"}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"names", "=", 
       RowBox[{"decontextify", "/@", 
        RowBox[{"Names", "[", "\"\<xlr8r`*\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"usagestrings", " ", "=", " ", 
       RowBox[{"ToExpression", "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<::usage\>\""}], 
            ")"}], "&"}], "/@", "names"}], ")"}]}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ok", " ", "=", " ", 
       RowBox[{"StringQ", "/@", "usagestrings"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"usagestrings", " ", "=", " ", 
       RowBox[{"Pick", "[", 
        RowBox[{"usagestrings", ",", " ", "ok"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"names", " ", "=", " ", 
       RowBox[{"Pick", "[", 
        RowBox[{"names", ",", " ", "ok"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ok", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"StringLength", "[", "#", "]"}], ">", "0"}], ")"}], "&"}], 
        "/@", "usagestrings"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"usagestrings", " ", "=", " ", 
       RowBox[{"Pick", "[", 
        RowBox[{"usagestrings", ",", " ", "ok"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"names", " ", "=", " ", 
       RowBox[{"Pick", "[", 
        RowBox[{"names", ",", " ", "ok"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"print", "[", 
        RowBox[{"a_", ",", " ", "b_"}], "]"}], ":=", " ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"StylePrint", "[", 
           RowBox[{"a", ",", " ", "\"\<Subsection\>\""}], "]"}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"Print", "[", "b", "]"}], ";"}]}], " ", 
        "\[IndentingNewLine]", "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"StylePrint", "[", 
       RowBox[{"\"\<xlr8r Help\>\"", ",", " ", "\"\<Section\>\""}], "]"}], 
      ";", " ", "\[IndentingNewLine]", 
      RowBox[{
      "Print", "[", 
       "\"\<This is the xlr8r Help file. It provides some reference \
information about each of the externally visible xlr8r functions. It is not a \
users guide and does not provide any introduction to using xlr8r. It also \
does not include plugin reference information. \\nPlease note that xlr8r is \
experimental software and as such many of the functions may only contain \
partial implementations. And like a lot of software documentation in the \
cybersphere it does not always keep up with the latest implementation. Please \
check with the developer if you have any questions.\>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<This file was generated by xlr8r version \>\"", "<>", 
        "$xlr8r$Version", "<>", "\"\< on \>\"", "<>", 
        RowBox[{"DateString", "[", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Day\>\"", ",", " ", "\"\< \>\"", ",", " ", 
           "\"\<MonthNameShort\>\"", ",", " ", "\"\< \>\"", ",", " ", 
           "\"\<Year\>\"", ",", " ", "\"\< at \>\"", ",", " ", "\"\<Hour\>\"",
            ",", " ", "\"\<:\>\"", ",", " ", "\"\<Minute\>\"", ",", " ", 
           "\"\<:\>\"", ",", " ", "\"\<Second\>\"", ",", " ", "\"\< (\>\"", 
           ",", " ", "\"\<TimeZone\>\"", ",", "\"\<)\>\""}], "}"}], "]"}], 
        "<>", "\"\< using Mathematica \>\"", "<>", "$Version", "<>", 
        "\"\< (Version \>\"", "<>", 
        RowBox[{"ToString", "[", " ", "$VersionNumber", "]"}], "<>", 
        "\"\<, Release \>\"", "<>", 
        RowBox[{"ToString", "[", " ", "$ReleaseNumber", "]"}], "<>", " ", 
        "\"\<)\>\""}], "]"}], ";", "  ", "\[IndentingNewLine]", 
      RowBox[{"MapThread", "[", 
       RowBox[{"print", ",", " ", 
        RowBox[{"{", 
         RowBox[{"names", ",", " ", "usagestrings"}], "}"}]}], "]"}], ";"}]}],
     " ", "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"MathSBML`AddHelp", "[", "\"\<xlr8r`\>\"", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"xlr8rHelp", "[", "]"}], ":=", " ", 
     RowBox[{"xlr8rhelp", "[", "]"}]}], ";"}], " ", "*)"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.425337752609645*^9, 3.425337856615038*^9}, {
   3.425337900487476*^9, 3.42533795709411*^9}, {3.425338045168589*^9, 
   3.425338269030278*^9}, {3.4254008854012136`*^9, 3.425400923860173*^9}, {
   3.4254010105352592`*^9, 3.425401078414268*^9}, {3.4254101028182573`*^9, 
   3.4254101045216837`*^9}, {3.425427406809293*^9, 3.425427429465338*^9}, 
   3.425431370438501*^9, {3.466285198537404*^9, 3.466285215493907*^9}, {
   3.466285283063952*^9, 3.4662853008004208`*^9}, {3.466285341220552*^9, 
   3.466285416195119*^9}, {3.466285509363065*^9, 3.466285524206111*^9}, {
   3.58768722456472*^9, 3.587687227821933*^9}, {3.5876879050923357`*^9, 
   3.587687908371168*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["closing remarks", "Section"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"VR", "=", 
    RowBox[{"\"\< (Version \>\"", "<>", 
     RowBox[{"ToString", "[", "$VersionNumber", "]"}], "<>", 
     "\"\<, Release \>\"", "<>", 
     RowBox[{"ToString", "[", "$ReleaseNumber", "]"}], "<>", "\"\<)\>\""}]}], 
   ";", " ", 
   RowBox[{"If", "[", 
    RowBox[{"xlr8r`Private`msgflag", ",", " ", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"\"\<xCellerator \>\"", ",", " ", 
         RowBox[{"FontWeight", "\[Rule]", " ", "\"\<Bold\>\""}], ",", " ", 
         RowBox[{"FontFamily", "\[Rule]", " ", "\"\<Ubuntu,Arial\>\""}], ",", 
         " ", 
         RowBox[{"FontSize", "\[Rule]", " ", "12"}]}], "]"}], ",", " ", 
       RowBox[{"Style", "[", 
        RowBox[{
         RowBox[{
         "$xlr8r$Version", "<>", "\"\< (\>\"", "<>", "$xverdate$", "<>", 
          "\"\<) loaded \>\"", "<>", 
          RowBox[{"DateString", "[", "]"}], "<>", 
          "\"\<\\nusing Mathematica \>\"", "<>", "$Version", "<>", "VR"}], 
         ",", "   ", "\[IndentingNewLine]", 
         RowBox[{"FontFamily", "\[Rule]", " ", "\"\<Ubuntu,Arial\>\""}], ",", 
         
         RowBox[{"FontSize", "\[Rule]", " ", "12"}]}], "]"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"Style", "[", 
        RowBox[{
         RowBox[{"Hyperlink", "[", 
          RowBox[{
          "\"\<GPL License Terms Apply\>\"", ",", " ", 
           "\"\<http://www.gnu.org/licenses/gpl.html\>\""}], "]"}], ",", " ", 
         
         RowBox[{"FontWeight", "\[Rule]", " ", "Bold"}], ",", " ", 
         RowBox[{"FontFamily", "\[Rule]", " ", "\"\<Ubuntu,Arial\>\""}], ",", 
         
         RowBox[{"FontSize", "\[Rule]", " ", "12"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Remove", "[", "xlr8r`Private`msgflag", "]"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EndPackage", "[", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQA2IQbc4pEFDV+NIx+uAeMH3olv6Bv80vHT32Cx0F0dva
RE6C6BvzDU+D6Hn/Hv0C0RsE0/+C6JhTtjz/gPSbvQ5g+oHICxEQLWh5Vw5E
B2fLqYPoTVq+WiBauK+pv7D1paP+tFUTQHTmB4Y5IHrFsgNgusQifheIft8w
EUzXmDxSLQHSWpdOqoFoHaEYIcOyV44iN5jFQPSVTxYyILpV4q88iGYxM1cD
0btrVIxA9PwFN4sFGl45PgvILwPR547urwLRjJu8akG0oHnJLBA9T01xCYg+
yPByOYjWu/0NTC+ad2YziA7rO7UFRDOFye8E0dkhS4+BaJfTEw//2PXKcYsG
/zEQbeIZ/IDlwCvHlqJKMA0AC0m0DA==
  "]]
}, Closed]]
},
AutoGeneratedPackage->Automatic,
CellGrouping->Manual,
WindowSize->{1254, 970},
WindowMargins->{{2147, Automatic}, {-19, Automatic}},
Magnification:>FEPrivate`If[
  FEPrivate`Equal[FEPrivate`$VersionNumber, 6.], 1.5, 1.5 Inherited],
FrontEndVersion->"9.0 for Linux x86 (64-bit) (February 7, 2013)",
StyleDefinitions->FrontEnd`FileName[{"Creative"}, "PastelColor.nb", 
  CharacterEncoding -> "UTF-8"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 142, 2, 105, "Title"],
Cell[690, 24, 3196, 75, 1024, "Text"],
Cell[CellGroupData[{
Cell[3911, 103, 72, 1, 117, "Section"],
Cell[3986, 106, 928, 20, 846, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[4951, 131, 212, 3, 70, "Section"],
Cell[5166, 136, 175, 4, 60, "Input",
 InitializationCell->True],
Cell[5344, 142, 16, 0, 49, "Text"],
Cell[5363, 144, 2449, 62, 409, "Input",
 InitializationCell->True],
Cell[7815, 208, 2573, 39, 90, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[10425, 252, 31, 0, 70, "Section"],
Cell[10459, 254, 13321, 267, 3601, "Text"],
Cell[23783, 523, 221, 8, 63, "Text"],
Cell[24007, 533, 553, 21, 78, "Text"],
Cell[24563, 556, 56, 0, 49, "Text"],
Cell[24622, 558, 61, 0, 49, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[24720, 563, 31, 0, 70, "Section"],
Cell[24754, 565, 197, 4, 82, "Text"],
Cell[CellGroupData[{
Cell[24976, 573, 102, 1, 42, "Subsubsection"],
Cell[25081, 576, 248, 6, 60, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[25366, 587, 103, 1, 42, "Subsubsection"],
Cell[25472, 590, 1187, 25, 41734, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[26696, 620, 35, 0, 31, "Subsubsection"],
Cell[26734, 622, 722, 14, 225890248, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[27493, 641, 110, 1, 31, "Subsubsection"],
Cell[27606, 644, 2263, 53, 4861, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[29906, 702, 35, 0, 31, "Subsubsection"],
Cell[29944, 704, 253, 6, 225890248, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[30234, 715, 42, 0, 31, "Subsubsection"],
Cell[30279, 717, 640, 14, 225890248, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[30956, 736, 58, 0, 31, "Subsubsection"],
Cell[31017, 738, 380, 10, 17716551, "Input",
 InitializationCell->True],
Cell[31400, 750, 658, 12, 35087548, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[32095, 767, 35, 0, 31, "Subsubsection"],
Cell[32133, 769, 4235, 78, 134195098, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[36405, 852, 92, 2, 33, "Subsubsection"],
Cell[36500, 856, 2899, 71, 123971080, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[39436, 932, 99, 1, 31, "Subsubsection"],
Cell[39538, 935, 182, 4, 7182202, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[39757, 944, 27, 0, 31, "Subsubsection"],
Cell[39787, 946, 4261, 75, 225890248, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[44085, 1026, 69, 1, 33, "Subsubsection"],
Cell[44157, 1029, 2498, 54, 225890248, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[46692, 1088, 65, 1, 33, "Subsubsection"],
Cell[46760, 1091, 2634, 56, 225890248, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[49431, 1152, 66, 1, 33, "Subsubsection"],
Cell[49500, 1155, 330, 11, 225890248, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[49867, 1171, 66, 1, 33, "Subsubsection"],
Cell[49936, 1174, 3507, 62, 225890248, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[53480, 1241, 53, 0, 31, "Subsubsection"],
Cell[53536, 1243, 11694, 241, 27549, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[65267, 1489, 83, 1, 31, "Subsubsection"],
Cell[CellGroupData[{
Cell[65375, 1494, 8288, 181, 225890248, "Input",
 InitializationCell->True],
Cell[73666, 1677, 116, 1, 225890248, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[73821, 1683, 35, 0, 38, "Subtitle"],
Cell[73859, 1685, 119, 3, 60, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[74003, 1692, 185, 2, 117, "Section"],
Cell[74191, 1696, 161, 3, 1851, "Text"],
Cell[74355, 1701, 5411, 118, 49146, "Input",
 InitializationCell->True],
Cell[79769, 1821, 160, 3, 1851, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[79966, 1829, 28, 0, 70, "Section"],
Cell[CellGroupData[{
Cell[80019, 1833, 105, 1, 87, "Subsection"],
Cell[80127, 1836, 123, 1, 73, "Text"],
Cell[80253, 1839, 2077, 62, 396, "Input",
 InitializationCell->True],
Cell[82333, 1903, 762, 20, 309, "Input",
 InitializationCell->True],
Cell[83098, 1925, 231, 7, 220, "Text"],
Cell[83332, 1934, 6878, 130, 1744, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[90247, 2069, 105, 1, 66, "Subsection"],
Cell[90355, 2072, 1924, 52, 309, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[92316, 2129, 168, 3, 102, "Subsection"],
Cell[92487, 2134, 1339, 33, 348372496, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[93863, 2172, 168, 2, 66, "Subsection"],
Cell[94034, 2176, 231, 8, 969691, "Input",
 InitializationCell->True],
Cell[94268, 2186, 257, 6, 969691, "Input",
 InitializationCell->True],
Cell[94528, 2194, 247, 6, 969691, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[94812, 2205, 47, 0, 66, "Subsection"],
Cell[94862, 2207, 107, 3, 95688451, "Text"],
Cell[94972, 2212, 4859, 125, 2067050704, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[99868, 2342, 39, 0, 66, "Subsection"],
Cell[99910, 2344, 203, 6, 103188808, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[100150, 2355, 62, 0, 66, "Subsection"],
Cell[100215, 2357, 3924, 108, 1366733391, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[104176, 2470, 103, 1, 66, "Subsection"],
Cell[104282, 2473, 177, 6, 6246, "Text"],
Cell[104462, 2481, 3639, 104, 56754, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[108138, 2590, 165, 2, 66, "Subsection"],
Cell[108306, 2594, 2545, 74, 3766, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[110888, 2673, 98, 1, 66, "Subsection"],
Cell[110989, 2676, 3125, 82, 25224, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[114151, 2763, 100, 1, 66, "Subsection"],
Cell[114254, 2766, 3072, 93, 4423, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[117363, 2864, 98, 1, 66, "Subsection"],
Cell[117464, 2867, 104, 1, 366, "Text"],
Cell[117571, 2870, 3990, 113, 4645, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[121598, 2988, 98, 1, 66, "Subsection"],
Cell[121699, 2991, 267, 7, 90, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[122003, 3003, 104, 1, 66, "Subsection"],
Cell[122110, 3006, 384, 11, 90, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[122531, 3022, 96, 1, 66, "Subsection"],
Cell[122630, 3025, 205, 7, 135, "Input",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[122884, 3038, 36, 0, 70, "Section"],
Cell[122923, 3040, 415, 9, 8446, "Text"],
Cell[CellGroupData[{
Cell[123363, 3053, 155, 2, 3322, "Subsection"],
Cell[123521, 3057, 117, 1, 5359762, "Text"],
Cell[123641, 3060, 4112, 101, 97411005, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[127790, 3166, 165, 3, 3901, "Subsection"],
Cell[CellGroupData[{
Cell[127980, 3173, 147, 3, 5494015, "Subsection"],
Cell[128130, 3178, 4839, 100, 80563128, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[133006, 3283, 196, 4, 5494015, "Subsection"],
Cell[133205, 3289, 3805, 90, 77931861, "Input",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[137059, 3385, 120, 2, 3901, "Subsection"],
Cell[CellGroupData[{
Cell[137204, 3391, 100, 1, 3597, "Subsubsection"],
Cell[137307, 3394, 194, 4, 103188808, "Text"],
Cell[137504, 3400, 394, 12, 133835472, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[137935, 3417, 32, 0, 3786, "Subsection"],
Cell[137970, 3419, 710, 21, 252374058, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[138717, 3445, 36, 0, 3786, "Subsection"],
Cell[138756, 3447, 5058, 132, 97411005, "Input",
 InitializationCell->True],
Cell[143817, 3581, 79, 2, 6863766, "Subsection"],
Cell[143899, 3585, 2109, 54, 54987061, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[146045, 3644, 79, 2, 3786, "Subsection"],
Cell[146127, 3648, 2472, 60, 68028, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[148636, 3713, 81, 2, 3786, "Subsection"],
Cell[148720, 3717, 7520, 186, 187372939, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[156277, 3908, 83, 2, 3786, "Subsection"],
Cell[156363, 3912, 2986, 79, 1075435926, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[159386, 3996, 85, 2, 3786, "Subsection"],
Cell[159474, 4000, 1204, 34, 2473287, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[160715, 4039, 114, 3, 3786, "Subsection"],
Cell[160832, 4044, 2857, 73, 6416185, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[163726, 4122, 116, 3, 3786, "Subsection"],
Cell[163845, 4127, 1035, 28, 301100073, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[164917, 4160, 126, 3, 3786, "Subsection"],
Cell[165046, 4165, 3156, 79, 1088064760, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[168239, 4249, 128, 3, 3786, "Subsection"],
Cell[168370, 4254, 1158, 31, 351155170, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[169565, 4290, 221, 8, 4983, "Subsection"],
Cell[169789, 4300, 2468, 64, 42891, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[172294, 4369, 218, 7, 4983, "Subsection"],
Cell[172515, 4378, 1096, 30, 301100073, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[173648, 4413, 546, 21, 4983, "Subsection"],
Cell[174197, 4436, 5439, 135, 10654971, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[179673, 4576, 543, 20, 4983, "Subsection"],
Cell[180219, 4598, 1235, 34, 2173029, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[181491, 4637, 307, 9, 4983, "Subsection"],
Cell[181801, 4648, 7671, 198, 103092, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[189509, 4851, 304, 8, 4983, "Subsection"],
Cell[189816, 4861, 1336, 36, 399577200, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[191189, 4902, 570, 21, 4983, "Subsection"],
Cell[191762, 4925, 8073, 208, 2147483647, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[199872, 5138, 567, 20, 4983, "Subsection"],
Cell[200442, 5160, 2251, 59, 596571907, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[202730, 5224, 210, 9, 6246, "Subsection"],
Cell[202943, 5235, 5464, 135, 2147483647, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[208444, 5375, 207, 8, 6246, "Subsection"],
Cell[208654, 5385, 1648, 42, 642797817, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[210339, 5432, 595, 22, 6561, "Subsection"],
Cell[210937, 5456, 324, 5, 8979277, "Text"],
Cell[211264, 5463, 16433, 396, 377650890, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[227734, 5864, 592, 21, 6561, "Subsection"],
Cell[228329, 5887, 1538, 40, 498468804, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[229904, 5932, 267, 8, 4983, "Subsection"],
Cell[230174, 5942, 5406, 136, 1582603827, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[235617, 6083, 269, 8, 4983, "Subsection"],
Cell[235889, 6093, 1221, 34, 351155170, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[237147, 6132, 515, 20, 4983, "Subsection"],
Cell[237665, 6154, 8241, 206, 2147483647, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[245943, 6365, 517, 20, 4983, "Subsection"],
Cell[246463, 6387, 1438, 38, 738786582, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[247938, 6430, 45, 0, 3786, "Subsection"],
Cell[247986, 6432, 287, 6, 169220839, "Text"],
Cell[248276, 6440, 1790, 45, 860351310, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[250103, 6490, 47, 0, 3786, "Subsection"],
Cell[250153, 6492, 1546, 42, 628561527, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[251736, 6539, 160, 6, 4983, "Subsection"],
Cell[251899, 6547, 1701, 46, 786382737, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[253637, 6598, 174, 5, 4983, "Subsection"],
Cell[253814, 6605, 1696, 46, 628561527, "Input",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[255559, 6657, 127, 2, 3901, "Subsection"],
Cell[CellGroupData[{
Cell[255711, 6663, 543, 15, 2766393, "Subsection"],
Cell[CellGroupData[{
Cell[256279, 6682, 50, 0, 1317898, "Subsubsection"],
Cell[256332, 6684, 115, 1, 1418707, "Text"],
Cell[256450, 6687, 1918, 51, 10103122, "Input",
 InitializationCell->True],
Cell[258371, 6740, 3212, 87, 14652555, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[261620, 6832, 170, 6, 1454536, "Subsubsection"],
Cell[261793, 6840, 1369, 38, 6464953, "Input",
 InitializationCell->True],
Cell[263165, 6880, 2502, 69, 11912314, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[265704, 6954, 175, 6, 1454536, "Subsubsection"],
Cell[265882, 6962, 1265, 34, 7381219, "Input",
 InitializationCell->True],
Cell[267150, 6998, 1258, 34, 7381219, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[268445, 7037, 131, 3, 1005310, "Subsubsection"],
Cell[268579, 7042, 3028, 79, 943925940, "Input",
 InitializationCell->True],
Cell[271610, 7123, 1445, 40, 448502517, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[273092, 7168, 169, 4, 1956366, "Subsubsection"],
Cell[273264, 7174, 3538, 86, 1287813694, "Input",
 InitializationCell->True],
Cell[276805, 7262, 1618, 43, 448502517, "Input",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[278472, 7311, 134, 3, 1409341, "Subsection"],
Cell[278609, 7316, 5486, 135, 1779765472, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[284132, 7456, 136, 3, 1409341, "Subsection"],
Cell[284271, 7461, 1249, 33, 351155170, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[285557, 7499, 350, 12, 1927495, "Subsection"],
Cell[285910, 7513, 7683, 190, 2147483647, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[293618, 7707, 352, 12, 222977935, "Subsection"],
Cell[293973, 7721, 1590, 41, 548654919, "Input",
 InitializationCell->True]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[295624, 7769, 172, 3, 3901, "Subsection"],
Cell[295799, 7774, 331, 6, 2062657, "Subsubsection"],
Cell[296133, 7782, 8551, 223, 48122721, "Input",
 InitializationCell->True],
Cell[304687, 8007, 12374, 317, 107560732, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[317098, 8329, 103, 2, 3901, "Subsection"],
Cell[CellGroupData[{
Cell[317226, 8335, 199, 6, 3219, "Subsubsection"],
Cell[317428, 8343, 1713, 45, 64336, "Input",
 InitializationCell->True],
Cell[319144, 8390, 9443, 237, 363834, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[328624, 8632, 103, 2, 1750, "Subsubsection"],
Cell[328730, 8636, 3155, 86, 127332, "Input",
 InitializationCell->True],
Cell[331888, 8724, 8643, 221, 363834, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[340568, 8950, 48, 0, 1750, "Subsubsection"],
Cell[340619, 8952, 2668, 65, 304681, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[343324, 9022, 65, 0, 1750, "Subsubsection"],
Cell[343392, 9024, 162, 5, 3444, "Input",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[343603, 9035, 48, 0, 3322, "Subsection"],
Cell[343654, 9037, 2193, 69, 60526, "Input",
 InitializationCell->True],
Cell[345850, 9108, 1613, 50, 34236, "Input",
 InitializationCell->True],
Cell[347466, 9160, 464, 9, 19003, "Text"],
Cell[347933, 9171, 35391, 785, 813060, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[383361, 9961, 91, 2, 3901, "Subsection"],
Cell[CellGroupData[{
Cell[383477, 9967, 83, 2, 1317898, "Subsubsection"],
Cell[383563, 9971, 2856, 79, 21476160, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[386456, 10055, 85, 2, 1005310, "Subsubsection"],
Cell[386544, 10059, 3727, 102, 29959672, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[390308, 10166, 97, 2, 1005310, "Subsubsection"],
Cell[390408, 10170, 2867, 78, 1076975577, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[393312, 10253, 63, 0, 1005310, "Subsubsection"],
Cell[393378, 10255, 160, 5, 103188808, "Input",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[393587, 10266, 97, 2, 3901, "Subsection"],
Cell[CellGroupData[{
Cell[393709, 10272, 87, 2, 1317898, "Subsubsection"],
Cell[393799, 10276, 3910, 105, 34236211, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[397746, 10386, 89, 2, 1005310, "Subsubsection"],
Cell[397838, 10390, 7560, 196, 62560018, "Input",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[405447, 10592, 93, 2, 3901, "Subsection"],
Cell[CellGroupData[{
Cell[405565, 10598, 42, 0, 1317898, "Subsubsection"],
Cell[405610, 10600, 3929, 110, 20093022, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[409576, 10715, 44, 0, 1005310, "Subsubsection"],
Cell[409623, 10717, 8248, 207, 52764426, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[417908, 10929, 98, 2, 1005310, "Subsubsection"],
Cell[418009, 10933, 3751, 97, 1508158986, "Input",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[421809, 11036, 96, 2, 3901, "Subsection"],
Cell[CellGroupData[{
Cell[421930, 11042, 42, 0, 1317898, "Subsubsection"],
Cell[421975, 11044, 14105, 361, 2147483647, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[436117, 11410, 44, 0, 1005310, "Subsubsection"],
Cell[436164, 11412, 407, 8, 3543306, "Text"],
Cell[436574, 11422, 15403, 365, 135888832, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[452014, 11792, 97, 2, 1005310, "Subsubsection"],
Cell[452114, 11796, 2471, 64, 1004387364, "Input",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[454634, 11866, 180, 5, 3901, "Subsection"],
Cell[454817, 11873, 4865, 126, 26424334, "Input",
 InitializationCell->True],
Cell[459685, 12001, 10339, 255, 55456713, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[470061, 12261, 150, 4, 3901, "Subsection"],
Cell[CellGroupData[{
Cell[470236, 12269, 96, 2, 2825374, "Subsection"],
Cell[470335, 12273, 2010, 51, 745708815, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[472382, 12329, 52, 0, 2181804, "Subsection"],
Cell[472437, 12331, 6057, 152, 2147483647, "Input",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[478543, 12489, 101, 2, 3901, "Subsection"],
Cell[CellGroupData[{
Cell[478669, 12495, 48, 0, 124497802, "Subsection"],
Cell[478720, 12497, 819, 26, 254842092, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[479576, 12528, 50, 0, 124497802, "Subsection"],
Cell[479629, 12530, 449, 14, 194496018, "Input",
 InitializationCell->True]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[480127, 12550, 50, 0, 2524, "Subsection"],
Cell[480180, 12552, 294, 5, 16268608, "Text"],
Cell[480477, 12559, 2067, 52, 52384524, "Input",
 InitializationCell->True],
Cell[482547, 12613, 373, 12, 17716551, "Input",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[482969, 12631, 94, 1, 70, "Section"],
Cell[483066, 12634, 251, 5, 82, "Text"],
Cell[CellGroupData[{
Cell[483342, 12643, 834, 27, 42, "Subsubsection"],
Cell[484179, 12672, 10128, 270, 1163, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[494344, 12947, 719, 22, 56, "Subsubsection"],
Cell[495066, 12971, 7542, 185, 757, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[502645, 13161, 697, 22, 31, "Subsubsection"],
Cell[503345, 13185, 3268, 80, 380, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[506650, 13270, 169, 3, 31, "Subsubsection"],
Cell[506822, 13275, 3590, 89, 380, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[510449, 13369, 165, 3, 31, "Subsubsection"],
Cell[510617, 13374, 3873, 93, 467, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[514527, 13472, 179, 3, 31, "Subsubsection"],
Cell[514709, 13477, 3731, 91, 380, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[518477, 13573, 139, 3, 31, "Subsubsection"],
Cell[518619, 13578, 3489, 87, 409, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[522145, 13670, 160, 2, 31, "Subsubsection"],
Cell[522308, 13674, 4077, 98, 583, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[526422, 13777, 170, 2, 31, "Subsubsection"],
Cell[526595, 13781, 3586, 90, 438, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[530218, 13876, 111, 1, 31, "Subsubsection"],
Cell[530332, 13879, 3827, 93, 467, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[534196, 13977, 118, 1, 31, "Subsubsection"],
Cell[534317, 13980, 1678, 43, 177, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[536032, 14028, 161, 2, 31, "Subsubsection"],
Cell[536196, 14032, 4685, 109, 583, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[540918, 14146, 132, 3, 31, "Subsubsection"],
Cell[541053, 14151, 1758, 43, 206, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[542848, 14199, 109, 1, 31, "Subsubsection"],
Cell[542960, 14202, 5232, 130, 786, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[548229, 14337, 104, 1, 31, "Subsubsection"],
Cell[548336, 14340, 538, 15, 148, "Input",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[548923, 14361, 90, 1, 117, "Section"],
Cell[CellGroupData[{
Cell[549038, 14366, 118, 1, 2561931, "Subsubsection"],
Cell[549159, 14369, 2595, 66, 45357225, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[551791, 14440, 112, 1, 1927495, "Subsubsection"],
Cell[551906, 14443, 3404, 77, 73084348, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[555347, 14525, 159, 2, 1927495, "Subsubsection"],
Cell[555509, 14529, 4005, 104, 52929802, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[559551, 14638, 110, 1, 1927495, "Subsubsection"],
Cell[559664, 14641, 277, 6, 10103122, "Text"],
Cell[559944, 14649, 3414, 79, 47377692, "Input",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[563407, 14734, 99, 1, 70, "Section"],
Cell[CellGroupData[{
Cell[563531, 14739, 100, 1, 63, "Subsubsection"],
Cell[563634, 14742, 98, 2, 6246, "Text"],
Cell[563735, 14746, 20898, 489, 617391, "Input",
 InitializationCell->True],
Cell[584636, 15237, 348, 10, 7749, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[585021, 15252, 93, 1, 46, "Subsubsection"],
Cell[585117, 15255, 4375, 116, 8258800, "Input",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[589541, 15377, 36, 0, 70, "Section"],
Cell[589580, 15379, 1200, 31, 17210934, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[590817, 15415, 30, 0, 70, "Section"],
Cell[590850, 15417, 1921, 54, 628561527, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[592808, 15476, 33, 0, 70, "Section"],
Cell[592844, 15478, 2776, 77, 1076975577, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[595657, 15560, 42, 0, 70, "Section"],
Cell[CellGroupData[{
Cell[595724, 15564, 25, 0, 87, "Subsection"],
Cell[595752, 15566, 756, 15, 17772, "Text"],
Cell[596511, 15583, 35595, 825, 373065, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[632143, 16413, 29, 0, 66, "Subsection"],
Cell[632175, 16415, 14283, 322, 5814, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[646495, 16742, 30, 0, 66, "Subsection"],
Cell[646528, 16744, 13201, 325, 5422, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[659766, 17074, 35, 0, 66, "Subsection"],
Cell[659804, 17076, 2931, 66, 1311, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[662772, 17147, 30, 0, 66, "Subsection"],
Cell[662805, 17149, 296, 7, 3141, "Text"],
Cell[663104, 17158, 22628, 530, 161766, "Input",
 InitializationCell->True],
Cell[685735, 17690, 204, 4, 2776, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[685976, 17699, 110, 1, 66, "Subsection"],
Cell[686089, 17702, 169, 2, 109, "Text"],
Cell[686261, 17706, 1128, 31, 333, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[687426, 17742, 105, 1, 66, "Subsection"],
Cell[687534, 17745, 127, 3, 109, "Text"],
Cell[687664, 17750, 2121, 59, 658, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[689822, 17814, 142, 2, 66, "Subsection"],
Cell[689967, 17818, 167, 2, 73, "Text"],
Cell[690137, 17822, 123, 1, 63, "Subsubsection"],
Cell[CellGroupData[{
Cell[690285, 17827, 234, 5, 160, "Text"],
Cell[690522, 17834, 32974, 836, 11425, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[723533, 18675, 127, 1, 46, "Subsubsection"],
Cell[723663, 18678, 651, 11, 366, "Text"],
Cell[724317, 18691, 46083, 1075, 11532, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[770437, 19771, 167, 2, 46, "Subsubsection"],
Cell[770607, 19775, 134, 3, 109, "Text"],
Cell[770744, 19780, 7272, 175, 2877, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[778053, 19960, 170, 2, 46, "Subsubsection"],
Cell[CellGroupData[{
Cell[778248, 19966, 129, 3, 109, "Text"],
Cell[778380, 19971, 13019, 314, 4704, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[791414, 20288, 191, 4, 109, "Text"],
Cell[791608, 20294, 4455, 110, 1507, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[796100, 20409, 100, 1, 46, "Subsubsection"],
Cell[796203, 20412, 159, 2, 73, "Text"],
Cell[796365, 20416, 5972, 146, 1614, "Input",
 InitializationCell->True]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[802398, 20569, 30, 0, 70, "Section"],
Cell[802431, 20571, 4923, 135, 1521193590, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[807391, 20711, 94, 1, 70, "Section"],
Cell[807488, 20714, 1650, 42, 570206304, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[809175, 20761, 107, 1, 70, "Section"],
Cell[809285, 20764, 234, 4, 4711, "Text"],
Cell[809522, 20770, 17450, 383, 190774, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[827009, 21158, 89, 1, 70, "Section"],
Cell[827101, 21161, 201, 4, 73, "Text"],
Cell[827305, 21167, 5546, 119, 1701, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[832888, 21291, 34, 0, 70, "Section"],
Cell[832925, 21293, 2615, 61, 744, "Input",
 InitializationCell->True]
}, Closed]]
}
]
*)

(* End of internal cache information *)
