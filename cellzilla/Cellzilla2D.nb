(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[   2981814,      69729]
NotebookOptionsPosition[   2864089,      66921]
NotebookOutlinePosition[   2865064,      66954]
CellTagsIndexPosition[   2865021,      66951]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[StyleBox["Cellzilla2D", "Subtitle",
 FontSize->36]], "Title",
 CellChangeTimes->{{3.446842462337434*^9, 3.446842463683268*^9}, {
   3.450720660517161*^9, 3.450720661719412*^9}, {3.454414661207459*^9, 
   3.454414663101475*^9}, 3.4544339074877777`*^9},
 FontSize->18,ExpressionUUID->"83d06029-506d-4ca4-88e5-5e669fd158c8"],

Cell["\<\


B.E.Shapiro 
Department of Mathematics
California State University
18111 Nordhoff Street
Northridge, CA 91330-8313
\
\>", "Text",
 CellChangeTimes->{{3.446842481900983*^9, 3.446842526441889*^9}, {
   3.450720664662672*^9, 3.450720721004319*^9}, {3.4510670022314377`*^9, 
   3.451067058065537*^9}, {3.451777322979734*^9, 3.4517773573957777`*^9}, {
   3.451857585782518*^9, 3.4518576124315*^9}, {3.4523280552289667`*^9, 
   3.4523280652356157`*^9}, {3.452328095503237*^9, 3.452328112884324*^9}, {
   3.4523283757276297`*^9, 3.452328383355364*^9}, {3.4523303356413603`*^9, 
   3.4523304386038027`*^9}, {3.4523570422551928`*^9, 
   3.4523570449062443`*^9}, {3.452439557181485*^9, 3.452439582758574*^9}, {
   3.452442474186473*^9, 3.452442481277717*^9}, {3.4524447457790403`*^9, 
   3.452444746772622*^9}, {3.4524447913710957`*^9, 3.452444812455263*^9}, {
   3.454166874339547*^9, 3.454166907628244*^9}, 3.4544146734245234`*^9, {
   3.455379888374831*^9, 3.455379900554689*^9}, {3.455379938471098*^9, 
   3.4553800160343933`*^9}, {3.5491351199375143`*^9, 3.549135153360405*^9}, {
   3.556725413037958*^9, 3.556725418045892*^9}, {3.556798345772236*^9, 
   3.556798494130392*^9}, 3.561478487364105*^9, {3.561480459037592*^9, 
   3.561480485855875*^9}},ExpressionUUID->"2aabce3b-9017-4d02-a97b-\
4d0c62f1aa72"],

Cell[CellGroupData[{

Cell["Acknowledgement", "Subsubsection",
 CellChangeTimes->{{3.55679848477796*^9, 
  3.556798487178585*^9}},ExpressionUUID->"20cd7110-779d-4658-824e-\
42c695304a30"],

Cell["\<\
Prototype versions of this software were developed with partial support from \
the Arnold and Mabel Beckman Foundation at Caltech,  gifts from Peter Cross,  \
and matching funds from the Caltech Division of Biology, under the auspices \
of the Biological Network Modeling Center at Caltech, and from the National \
Science Foundation under award number 0330786. 

This is open source, free software, distributed under the terms of the GNU \
GPL license. You should not have paid any money for this software.\
\>", "Text",
 CellChangeTimes->{{3.556798495841724*^9, 3.556798589057749*^9}, {
  3.55679864151348*^9, 
  3.5567987110801563`*^9}},ExpressionUUID->"ff17a2ec-1def-405e-b876-\
ec32276c49c0"]
}, Closed]],

Cell[CellGroupData[{

Cell["LIcense (GPL)", "Subsubsection",
 CellChangeTimes->{{3.455379947133049*^9, 3.455379951489646*^9}, 
   3.55666496138719*^9},ExpressionUUID->"fb0e11bc-50c8-4f81-be46-\
613b2153433b"],

Cell["\<\
Cellzilla2D is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License (GPL) as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>..\
\>", "Text",
 CellChangeTimes->{
  3.4553799327152987`*^9, 3.5444607359348183`*^9, {3.556664969995969*^9, 
   3.556664976634553*^9}, {3.5749820096449957`*^9, 
   3.5749820114115477`*^9}},ExpressionUUID->"d4adb370-3f17-4ce0-a079-\
050eacb7d130"]
}, Closed]],

Cell[CellGroupData[{

Cell["revision summary", "Subsubsection",
 CellChangeTimes->{{3.452444800968183*^9, 3.452444805859037*^9}, 
   3.7059662587305813`*^9},ExpressionUUID->"9d463271-d454-4d51-8efb-\
921c2909e08c"],

Cell[TextData[{
 "3.0.51 Make changes for Mathematica version 11 compatibility (note: version \
10 compatibility has not been checked). \nRegularPolygon --> regularPolygon; \
Area --> areafunction; Perimeter --> \[OpenCurlyDoubleQuote]PerimeterFunction\
\[CloseCurlyDoubleQuote]\na. Change EdgeBetween to return {} for an Edge \
between a cell and itself.\nb. Fix bugs in area introduced into module \
CellAreaEquations in 3.0.51 by mixing up area and Area functions\nc. Restore \
support for {} intracellular reactions (bug in indexify[])\nd. Remove sameq \
option from ffmpeg; include additional recovery help information for \
simulation plots\ne. Remove extraneous Print statement in MergeVertices\nf. \
Additional error message in SaveFrames\n3.0.50 Add concentration value \
display option to WTAShow\n3.0.49 Change $DIRECTION\[UnderBracket]EXPONENT = \
2 for default smoother convergence (=1 in Cellzilla Paper!) (exponent of w.e \
in direction potentials)\n3.0.48 Uses Heron\[CloseCurlyQuote]s formula in \
altitude calculation for both Direction and Length Potential for consistency\n\
3.0.47 Make \[OpenCurlyDoubleQuote]SaveFrames\[CloseCurlyDoubleQuote] \
consistent with change of 3.0.45\n3.0.46 Polygonzlize\n3.0.45 Save \
simulations to sub-folder of \
\[OpenCurlyDoubleQuote][userhome]/Cellzilla/todaysfolder/... rather than \
creating a daily folder off of the home folder\n3.0.44 Recover functions of t \
in rate constant (works in Cellerator but errored off in HasSufficientInfo. \
Add new debugging flag \[OpenCurlyDoubleQuote]DebugHasSufficientInfo\
\[CloseCurlyDoubleQuote]->False. New control paramet \
\[OpenCurlyDoubleQuote]CellIndex\[CloseCurlyDoubleQuote]->i, e.g., if \
specified, used to evaluate expressions that contain indices e.g. {{A->B, \
i/(i+1)}} where i is the cell index.\n3.0.43 Allow manual disabling of \
\[OpenCurlyDoubleQuote]VolumeCorrection\[CloseCurlyDoubleQuote] (default is \
True)\n3.0.42 Add smoothing of L2/L3 in parabola tempate as well as some bug \
fixes\n3.0.41 Redefine anticlinal in L1 to be centroid to midpoint rather \
than centroid to perpendicular to edge (beause then intersection may not even \
touch outer edge).\n3.0.40 Volume correction for derivative of concentration\n\
3.0.39 Make parabolicTemplate have random-normal area distribution \
(more-or-less). Smoothe outer edge of L1 on parabola so that there is only 1 \
outer wall per cell; remove dangling edges/vertices.  Add cleaner \
implementation of sortCellEdges. \n3.0.38 Significant improvement in \
VerticesOnTop/Bottom/Left/Right CPU implementation (factor of 20). Add bottom \
corners to L1. Update parabolic template to have different aspects. Fix bug \
in sortCellEdges when non-cyclic.\n3.0.37 Dynamic PD (cell extension by PD) \
Calculation\n3.0.36 L2AnticlinalRatio value as input parameter\n3.0.35 \
L2Anticlinal Flag - make it work\n3.0.34 Make LineageAnimate compatible with \
mx Dumps. \n3.0.33 default BC to zero so not needed to be specified\n3.0.32 \
Save solutions as mx files with \[OpenCurlyDoubleQuote]Dump\
\[CloseCurlyDoubleQuote] option (set \[OpenCurlyDoubleQuote]Dump\
\[CloseCurlyDoubleQuote]->False to revert to previous .nb option) to increase \
speed. Note: Wolfram warns that mx files are system dependent but much \
(orders of magniture) faster to process; allow different diffusion through \
outer wall (such as impermeability). Also make SimShow, SimAnimate compatible \
with optional mx/nb format.\n3.0.31 Modify format of Diffusin arrow to \
DoubleLongRightArrow, Same for {cell\[LongRightArrow]cell, \
Grow[Pressure[..],GrowthRate[],Spring[..]]} arrow, cell-divsion arrow \
non-conflicting with previously existing function \
\[OpenCurlyDoubleQuote]Errera\[CloseCurlyDoubleQuote]\n3.0.30 RemoveVertices, \
RemoveEdges, NeighborQ, MergeCells\n3.0.29 Make default folder/file naming in \
SaveFrames consistent with other functions\n3.0.28 Bug in L1Cells (when \
Bottom -> -Infinity; allow turning off collection of x, y, area, etc in \
static simulation; error in calc of tip when vertices are ignored (e.g., for \
boundary cell in morphographx)\n3.0.27 SimAnimate time label in inputform \
(bug fix)\n3.0.26 In Errera, when Upwards, When checking for bottom, check \
minimum y coordinate rather than centroid \n3.0.25 bug in indexify for \
\[OpenCurlyDoubleQuote]TipFlag\[CloseCurlyDoubleQuote]\n3.0.24 \
\[OpenCurlyDoubleQuote]Cellzilla\[CloseCurlyDoubleQuote] Arrows \
{A->Diffusion[options}], {A->Transport[options]}, {A \
\[RightTeeArrow]IGRN[options]}\n3.0.23 pump reactions in unwalled networks; \
fix bugs in \[OpenCurlyDoubleQuote]specialVariables\[CloseCurlyDoubleQuote]\n\
3.0.22 New grow options \[OpenCurlyDoubleQuote]L1\[CloseCurlyDoubleQuote], \
\[OpenCurlyDoubleQuote]L2\[CloseCurlyDoubleQuote], \
\[OpenCurlyDoubleQuote]TipFlag\[CloseCurlyDoubleQuote] 0/1 indicator \
functions during simulations (treat like proteins)\n3.0.21 New Functions \
L1Cells, L2Cells, StaticSimulation; fix potential bugs in \
CellsOnTop,CellsOnBottom,etc. that would give static cell numbers rather than \
dynamic cell numbers\n3.0.20 Fix bug in HasSufficientInfo that thinks \
symbolic numbers are not numbers by changing NumberQ to NumericQ. Add \
optional manual directory specification to SimPlot ( same format as \
SimAnimate, GetSimulationPoints). Allow tip distance, etc. in static \
simulations.\n3.0.19 Fix bug when \[OpenCurlyDoubleQuote]Growing -> False, \
system is still growing!\n3.0.18 Fix bug when saving DTissues with rational \
vertex coordinates; incorporation optional manual specification of folder \
into SimAnimate\n3.0.17 LineageShow, LineageAnimate; add optional manual \
specification of folder in GetSimulationPoints\n3.0.16 Fix default label in \
SimShow when \[OpenCurlyDoubleQuote]show\[CloseCurlyDoubleQuote]->True to \
filter time through \[OpenCurlyDoubleQuote]InputForm\[CloseCurlyDoubleQuote] \
before \[OpenCurlyDoubleQuote]StringForm\[CloseCurlyDoubleQuote] (else \
exponents are off-row)\n3.0.15 BellCurve function; allow TipDistance to be \
specified in reactions as part of a rate constant.\n3.0.14, Generalized \
argument call to Centroid; input \[OpenCurlyDoubleQuote]center\
\[CloseCurlyDoubleQuote]->False,  \[OpenCurlyDoubleQuote]perimeter\
\[CloseCurlyDoubleQuote]-> False, or name of variable to include centroid, \
for variables. Make indexed pressure variable available for simplot after \
run. Make area, center, edgeVariable, x, y, tipdistance accesable to formulas \
for k, mu and pressure\n3.0.13 Indexed Pressure Variable. Fix calculation of \
\[OpenCurlyDoubleQuote]meanradius\[CloseCurlyDoubleQuote] in anticlinal \
division as ",
 Cell[BoxData[
  FormBox[
   SqrtBox[
    RowBox[{"A", "/", "\[Pi]"}]], TraditionalForm]],ExpressionUUID->
  "fd14794c-246a-4b81-a2df-5d5bef33554a"],
 " instead of A/\[Pi]. \n3.0.12 Put muOuter, muL1, muL1L2 on flags (not \
automatically set)\n3.0.11 (initial code for indexed p)\n3.0.10 smoothe L1/L2 \
interface in TemplateParabolic; may inhibit wall growth on all L1 edges\n\
3.0.9 change tipx,tipy to tip[1] and tip[2]; fix formula for tip; perps to L1 \
wall growth restricted in upwards mode. Rename TemplateMeristem to \
TemplateParabolic\n3.0.8 \
\[OpenCurlyDoubleQuote]mumin\[CloseCurlyDoubleQuote],\[CloseCurlyDoubleQuote]\
mumax\[CloseCurlyDoubleQuote],\[CloseCurlyDoubleQuote]muDegreesMax\
\[CloseCurlyDoubleQuote], \
\[OpenCurlyDoubleQuote]kmin\[CloseCurlyDoubleQuote],\[CloseCurlyDoubleQuote]\
kmax\[CloseCurlyDoubleQuote],\[CloseCurlyDoubleQuote]kDegreesMin\
\[CloseCurlyDoubleQuote] replace \[OpenCurlyDoubleQuote]mux\
\[CloseCurlyDoubleQuote],\[CloseCurlyDoubleQuote]muy\[CloseCurlyDoubleQuote],\
\[CloseCurlyDoubleQuote]kx\[CloseCurlyDoubleQuote],\[CloseCurlyDoubleQuote]ky\
\[CloseCurlyDoubleQuote] from 3.0.2; indexed mu and k values as \
\[OpenCurlyDoubleQuote]k\[CloseCurlyDoubleQuote]-> {variable, formula} and \
\[OpenCurlyDoubleQuote]mu\[CloseCurlyDoubleQuote]-> {variable, formula}; \
variables \[OpenCurlyDoubleQuote]tip\[CloseCurlyDoubleQuote] generates tix \
and tipy in simulation.\n3.0.7 TemplateMeristem (parabolic dome), \
\[OpenCurlyDoubleQuote]L1Anticlinal\[CloseCurlyDoubleQuote]->True (Default)\n\
3.0.6 indexed spring constant\n3.0.5 fix bug in time label of SimAnimate (due \
to integer conversion) when \[OpenCurlyDoubleQuote]ShowTime\
\[CloseCurlyDoubleQuote]->True\n3.0.4 \[OpenCurlyDoubleQuote]Intercellular\
\[CloseCurlyDoubleQuote] option in Grow for Unwalled systems to allow GRN \
reactions with input in cell i to directly affect output in neighbor j\n3.0.3 \
WTAShow, WTAAnimate\n3.0.2 \[OpenCurlyDoubleQuote]Upwards\
\[CloseCurlyDoubleQuote] option. \[OpenCurlyDoubleQuote]mux\
\[CloseCurlyDoubleQuote], \[OpenCurlyDoubleQuote]muy\[CloseCurlyDoubleQuote], \
\[OpenCurlyDoubleQuote]kx\[CloseCurlyDoubleQuote], \
ky\[CloseCurlyDoubleQuote], \[OpenCurlyDoubleQuote]IsotropicGrowth\
\[CloseCurlyDoubleQuote], \[OpenCurlyDoubleQuote]IsotropicSprings\
\[CloseCurlyDoubleQuote] options. (note: need to fix continuation mode in \
grow as it is broken)\n3.0.0 Fix some help strings. Rename \
VertexOutwardNormal to VertexOutwardVector; new function CellOutwardVector; \
fix bugs in {Cells, Edges, Vertices}on{Left,Right,Top,Bottom}; \
ShowOutwardNormal Tissue version; Additional form for Inside[Tissue,cell, \
point]; Validity checking on input to MergeEdges; Add IsoPerimetricRatio; \
delete ShowCell since it is not used and duplicates other functions. Fix \
SSANetwork to work with new format of CelleratorNetwork function. Make \
diffusion rates for walled network consistent with definition\nof \
permeability constants (rather than diffusion constants) as having units of \
cm/sec. Make pumping\nrates for walled network consistent with definition of \
pumping rate constant as molecules/(area - sec), Fix bug in \
ShowTissue[DTissue ..] with legend that forgot to pass number rules; new \
SimShow[] that reads from files; functions for extracting cells (and building \
new tissues) within a polygon or above/below a given line. Add CSVFile, \
CSVToTissue, also with FlatVersions and FlatTissue object, which does not \
explicitly state the edge numbers.\nNew functions TranslateTissue, \
RotateTissue, SharedWall, BoundaryCell, ReflectTissue, \
GetSimulationTissuePoints\nFix AreaPotential (errors). Modify LengthPotential \
to increase with near-miss distance from center (altitude). Add \
\[OpenCurlyDoubleQuote]DivisionModel\[CloseCurlyDoubleQuote]->\
\[CloseCurlyDoubleQuote]Errera\[CloseCurlyDoubleQuote] or \
\[OpenCurlyDoubleQuote]Potential\[CloseCurlyDoubleQuote] to grow\n2.3.5 \
Randomized Division Thresholds to Grow via  \
\[OpenCurlyDoubleQuote]DivisionSigma\[CloseCurlyDoubleQuote]->0.1 (fraction \
of Threshold) and \[OpenCurlyDoubleQuote]DivisionThresholdVariable\
\[CloseCurlyDoubleQuote]->DivisionThreshold. Uses global \
Cellzilla2D`Private`$DivisionThresholds to maintain persistence\n2.3.4 \
\[OpenCurlyDoubleQuote]xrange\[CloseCurlyDoubleQuote],\[CloseCurlyDoubleQuote]\
yrange\[CloseCurlyDoubleQuote] options on ShowTissue and corresponding \
arguments for ShowTissue3D; ShowZProjection\n2.3.3 \
\[OpenCurlyDoubleQuote]Normalize\[CloseCurlyDoubleQuote] , \
\[OpenCurlyDoubleQuote]\[CloseCurlyDoubleQuote]Rounding\
\[CloseCurlyDoubleQuote] options to histogram as well as some printing of \
statistics. Default mode in UniqueFileName(wrong number of arguments). \
Correct invocation from grow[..continue mode..]. Fix type in \
GetSavedFile[d,n,\[CloseCurlyDoubleQuote]ODE\[CloseCurlyDoubleQuote]].  \
\[OpenCurlyDoubleQuote]BoundOption\[CloseCurlyDoubleQuote] to ParaboloidPlot \
(applied when\[OpenCurlyDoubleQuote]Dome\[CloseCurlyDoubleQuote]->True in \
ShowTissue), Fix bug in ShowTissueCells that with mispelling of \
\[OpenCurlyDoubleQuote]CellStyles\[CloseCurlyDoubleQuote] option. Allow \
TissueToPLY to work with 3D vertex data. Fix SortCellEdges to work with empty \
cells. Modify intListQ to return True for an empty list.  New function \
BinData. Some 3d analysis functions.\n2.3.2 add option \
\[OpenCurlyDoubleQuote]MaxRadius\[CloseCurlyDoubleQuote] to SimBinData and \
SimBinSides; \[OpenCurlyDoubleQuote]ErrorBars\[CloseCurlyDoubleQuote] option \
for Bins2Histogram; change calculation of \
\[OpenCurlyDoubleQuote]IgnoreDivisionRadius\[CloseCurlyDoubleQuote] and \
\[OpenCurlyDoubleQuote]MaxRadius\[CloseCurlyDoubleQuote] to depend on \
Centeroid rather than Centroid.  Option \[OpenCurlyDoubleQuote]Format\
\[CloseCurlyDoubleQuote] in Bins2Histogram\n2.3.1 add option \
\[OpenCurlyDoubleQuote]IgnoreDivisionRadius\[CloseCurlyDoubleQuote] to Grow, \
ignores cell division beyond a certain radius from the origin (e.g., the edge \
of the universe) (an alternative to removing cells, leave them in the \
simulation, but don\[CloseCurlyQuote]t waste time paying attention to their \
cell division). \nAdd function Bins2Histogram\n2.3.0  (10/1/12) - migration \
to launchapad repository using Bazaar\nAdd function SimBinData\n2.2.8 - \
(2012/4-29 - 9/14) - CelleratorWalledNetwork, with new options \
\[OpenCurlyDoubleQuote]WallReactions\[CloseCurlyDoubleQuote], \
\[OpenCurlyDoubleQuote]BoundaryConditions\[CloseCurlyDoubleQuote], and new \
format for input; CellEdgePairs, \[OpenCurlyDoubleQuote]EdgeCellPairs\
\[CloseCurlyDoubleQuote], \[OpenCurlyDoubleQuote]All\[CloseCurlyDoubleQuote] \
Option on ShowTissue, and reimplimentation of ShowTissue (does not use \
ShowCell); hasSufficientInformaiton[; ShowInitialRates; mod SImShow* to not \
extrapolate beyond reqested color range. Dynamic Tissue (DTissue) and cell \
growth. \[OpenCurlyDoubleQuote]EdgesUsed\[CloseCurlyDoubleQuote],\
\[CloseCurlyDoubleQuote]VerticesUsed\[CloseCurlyDoubleQuote] functions. \
Improvements to SimAnimate. Integration of growzilla cell growth with \
simulations. Allow graylevel as well as rgb input for SimShow (hence also \
SimAnimate) color range.\n2.2.7 - (2012/3/24) - PLYToTissue\n2.2.6 - \
(2012/1/6) Add new function TemplateRing\n2.2.5 - (2011/12/31) Add new \
Paraboloid projection to ShowTissueOnDome. Modify ShowTissueOnDome to default \
to \[OpenCurlyDoubleQuote]shape\[CloseCurlyDoubleQuote]->\
\[CloseCurlyDoubleQuote]Paraboloid\[CloseCurlyDoubleQuote] rather than \
\[OpenCurlyDoubleQuote]shape\[CloseCurlyDoubleQuote]->\[CloseCurlyDoubleQuote]\
Hemisphere\[CloseCurlyDoubleQuote]\n2.2.4 - Fix error in ShowCell or \
ShowTissue when \[OpenCurlyDoubleQuote]CellStyle\[CloseCurlyDoubleQuote]->\
\[CloseCurlyDoubleQuote]None\[CloseCurlyDoubleQuote]\n2.2.3 - FlatFile, \
TissueToPLY\n2.2.2 - TemplateRandomeOvalish; \
\[OpenCurlyDoubleQuote]BoundaryStyle\[CloseCurlyDoubleQuote]->None option in \
ShowCell, Show Tisue; ShowTissueBoundary; \[OpenCurlyDoubleQuote]Outer\
\[CloseCurlyDoubleQuote] option for ShowTissue; \
\[OpenCurlyDoubleQuote]Nucleus\[CloseCurlyDoubleQuote] as possbile value for \
\[OpenCurlyDoubleQuote]CellStyle\[CloseCurlyDoubleQuote] in ShowTissue or \
ShowCell\n2.2.1 - add CellsOnLeft,Right,Top,Bottom, \
EdgesOnTop,Bottom,Right,Left (see 2.1.21 for vertices) 13 Apr 11\n2.2. - \
release of all 2.1.\[Alpha] versions 25 Feb 11\n2.1.\[Alpha].23 2.24.11 minor \
function name changes to make work in ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " Version 8. Fix bug in calling sequence for xSSANetwork\n2.1.\[Alpha].22 \
12.10 - correct centroid to work for massless (e.g., linear) objects.\n2.1.\
\[Alpha].21 9.1.10 - 10-7-10 ShowTissueOnDome experimental function added for \
Growzilla compatibility\nAdd framerate argument to SaveFrames, ToMov,ToAvi\n\
Modify PolygonIntersection to work in the case when there are more than 2 \
intersections; previously assumed vertex and rotated, but it could have been \
a non-convexity. Instead, now it figures out which sub-segment is correcct, \
even for a non-convex cell.\nChange warning on ShowTissue if #CellStyles != \
#Cells to #styles < # cells. \nAdd TissueCentroid; AdjacentVertices; \
AdjacentVerticesOnBoundary, VertexOutwardVector,\nVerticesOnLeft, ..Right, \
..Top, ..Bottom\nExternalize ColorBlendRectangle.\nModify RGBInterpolate and \
ColorBlendRectangle to work with multiple colors rather than just two.\n2.1.\
\[Alpha].20 7.22.10 Add missing UndangleVertcices to SmootheCells.\nNew \
function VertexNeighbors. \nMod DivideCell to work if new edge collides with \
an existing vertex by moving the vertex a little tiny bit. Add Option \
Changes->False; if True, returns {list of changes, Tissue} rather than just \
TIssue. Fix bug in DivideCell in which cell vertices are sometimes sorted in \
wrong direction.\nModify CelleratorNetwork to take options for edge and area \
variables\nNew function SortCellsCounterClockwise[tissue]\nNew function \
MergeVertices[]. Modify RemoveEdge to remove non-dangling edges by using \
MergeVertices.  New function CellEdgeLengths[tissue, CellNumber].\nSimPlot \
does not crash if variable not found, instead returns a blank graphics \
object. Allows multiple SimPlots to be be combined. New Function \
TemplatePolygon.\nFix bug in DivideCell that occurs when edges were not \
{smaller, larger} index\nNew Function RemoveShortEdgs. \nNew Function \
InteriorCells.\nAllow PointQ to be true on {x,y}, {x[i][t], y[i][t]} \n2.1.\
\[Alpha].19 12.22.09 CellVerticesToTissue\n2.1.\[Alpha]18 9.5.09 \
ShowTissueFunction. Externalize RGBInterpolate.  Repackage as 2.1.0 release\n\
2.1.\[Alpha].16,17 9.1, 9.5.09 additional help; SolutionVars\n2.1.\[Alpha].15 \
8.18.09 SimShow threshold version. Allow permeability as {D1, D2, ...} where \
Di = {species, \[Beta]} or {species, \[Beta], f}, where f is a function that \
takes on two arguments, i, j which are cell numbers and the effenctive \
permeability is \[Beta]*f[i,j]\n2.1.\[Alpha].14 8.17.09 Fix bug in \
connectionlist to ignored ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["n", "th"], TraditionalForm]],ExpressionUUID->
  "071186d4-81d9-44cc-9ed5-7523d2191620"],
 "cell in list; change conn. matrix to use SparseMatrix. Fix \
CellNeighbors[all for torus] to include toroidal links.\n2.1.\[Alpha].13 \
8.14.09 CellNeighbors; EdgeBetween functions; CelleratorNetwork uses above; \
TissueCells, etc. apply to Torus objects; Error message in \
TemplateRandomSemicir. when bottom<1\n2.1.\[Alpha].12 8.11.09 Fix some bugs \
in RemoveInlineVertices (multiple extras on same edge); regularizeMass (can't \
do stats on fewer than 3 items); balance out cell centers in Tmplate Random \
Square Grid;\n2.1.\[Alpha].11 7.24.09 CelleratorModel for Torus. SimRange for \
multiple frames. Include autoscale of variable range in SimAnimate. \n2.1.\
\[Alpha].10 7.23.09 ToTorus; ShowTissue[Torus]; ConnectionMatrix/List[torus];\
\n2.1.\[Alpha].9 7.22.09 add randomness option to \
Rectangularize>>RegularizeMass\n2.1.\[Alpha].8 7.21.09 start ToTorus\n2.1.\
\[Alpha].7 7.20.09 change default debug to off  in TemplateRandom. Fix \
failure of AddCorners when a corner is already there. Fix bug in \
Rectangularize when cell is not sorted in proper direction.\n2.1.\[Alpha].6 \
7.17.09 Debug DivideCell; finish Rectangularize\n2.1.\[Alpha].5 7.16.09 add \
default color & error function for ShowTissueCells. New Function \
PrimaryAxesVectors, DivideCell\n2.1.\[Alpha].4 7.14.09 change tolerance \
handling in PointOnLineSegment to relative; new functions InLineVertices; \
MergeEdges; \n2.1.\[Alpha].3 7.13.09 allow \"VertexNumbers\" or \"EdgeNumbers\
\" or \"Vertices\" to be True in ShowTissue; new function Rectangularize; \
additional DivideEdge(location)\n2.1.\[Alpha].1,2 7.11.09  consolidate some \
xSSA controls\n2.0 6.30.09 rebundle as 2.0 release\n\
------------------------------------------------------------------\n2.0.\
\[Alpha].4 6.29.09 Fix RectangularTemplate slowness\n2.0.\[Alpha].3 6.27.09 \
Fix PointQ to only allow pairs of Atoms; Make Perimeter work on tissues. Fill \
in additional help strings.\n2.0.\[Alpha].2 6.24.09 Remove some duplicated \
references; add \"danglingEdges\" option to ShowTissue; Workaround M701 \
Sqrt/Kernel quitting issue in FitEllipse. InertiaMatrix[tissue].\n\
2.0.\[Alpha].1 6.21.09 Remove trace from TemplateRandomSquareGrid\n2.0.\
\[Alpha].0 6.19.09 Fork from xStatic; complete redesign from original \
Cellzilla.\n\nCellzilla2D is a complete redesign of Cellzilla 1.0. Hence the \
first version is 2.0. \nThe original version described cells by nuclear \
points and cell walls by their corresponding Voronoi Diagram. The Voronoi \
Diagram / Delaunay Triangulation is not required in the current version, \
although they are still used to generate randomized templates by some \
functions.  The external software required by Cellzilla 1.0 (qHull) is not \
required by Cellzilla2D, as two-dimensional Voronoi diagrams can be generated \
efficiently by ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " now. "
}], "Text",
 CellChangeTimes->{
  3.4524447952988234`*^9, {3.453146247324645*^9, 3.4531462875504627`*^9}, {
   3.453222549200404*^9, 3.453222559743885*^9}, {3.453225028316599*^9, 
   3.453225029826713*^9}, {3.453225245579628*^9, 3.453225263699028*^9}, {
   3.453484934741302*^9, 3.45348495616354*^9}, {3.453735839323079*^9, 
   3.453735843577138*^9}, {3.454070709091835*^9, 3.454070718987959*^9}, {
   3.45410269210774*^9, 3.454102704537142*^9}, {3.454155633195863*^9, 
   3.454155636784642*^9}, {3.454163014678822*^9, 3.4541630641641083`*^9}, {
   3.4544146791835203`*^9, 3.454414704282816*^9}, {3.454615879301445*^9, 
   3.4546159003583593`*^9}, {3.454878497052758*^9, 3.454878520807238*^9}, {
   3.454947811162711*^9, 3.454947830816935*^9}, {3.455017302499254*^9, 
   3.455017330912356*^9}, {3.455062409494647*^9, 3.455062415527203*^9}, {
   3.45512643846638*^9, 3.4551264527169533`*^9}, {3.4551275741016483`*^9, 
   3.455127578079358*^9}, {3.455129066364915*^9, 3.4551290705054617`*^9}, {
   3.455291725491269*^9, 3.455291742003779*^9}, {3.4553798458972263`*^9, 
   3.455379876685377*^9}, {3.456320631073978*^9, 3.456320685094318*^9}, {
   3.456532429617703*^9, 3.456532429874214*^9}, {3.456580185530526*^9, 
   3.456580191281708*^9}, {3.456590920432673*^9, 3.456590968667881*^9}, {
   3.456598299671794*^9, 3.4565983071267443`*^9}, {3.4566885431843557`*^9, 
   3.456688548096389*^9}, {3.456688703881175*^9, 3.456688719411537*^9}, {
   3.456695473800503*^9, 3.456695482641343*^9}, {3.456748750669979*^9, 
   3.4567487600583553`*^9}, {3.456749230774418*^9, 3.456749264905517*^9}, {
   3.456750511660378*^9, 3.456750521057941*^9}, {3.456772193553767*^9, 
   3.456772223524329*^9}, {3.4568602122088413`*^9, 3.45686023637599*^9}, {
   3.457101457009283*^9, 3.4571014793791924`*^9}, {3.457102908234104*^9, 
   3.457102916864592*^9}, {3.4571063835776463`*^9, 3.4571063996273317`*^9}, {
   3.457276390810556*^9, 3.457276448251239*^9}, {3.457354329682989*^9, 
   3.457354335982415*^9}, {3.45738780968515*^9, 3.457387825075955*^9}, {
   3.4573921544525547`*^9, 3.457392161071909*^9}, {3.457447311470664*^9, 
   3.457447319302865*^9}, {3.457454408568305*^9, 3.4574544261130857`*^9}, {
   3.4574546102079163`*^9, 3.457454623339704*^9}, {3.4590078044637203`*^9, 
   3.459007848756072*^9}, {3.459017701496333*^9, 3.459017717876966*^9}, {
   3.459267852831458*^9, 3.4592678617982388`*^9}, {3.459272592374234*^9, 
   3.4592726092383003`*^9}, {3.459273021122666*^9, 3.4592730367677402`*^9}, {
   3.45954024361108*^9, 3.459540281608851*^9}, {3.45960351363209*^9, 
   3.459603529875334*^9}, {3.459622344837454*^9, 3.45962234895654*^9}, {
   3.459625830230503*^9, 3.45962583558115*^9}, {3.459628415212386*^9, 
   3.459628501643578*^9}, {3.461166636893752*^9, 3.4611666554815063`*^9}, {
   3.461173737237927*^9, 3.461173754205278*^9}, {3.461173865929042*^9, 
   3.461173870454557*^9}, {3.470524462099873*^9, 3.47052454507152*^9}, {
   3.488799224185186*^9, 3.488799260490004*^9}, {3.488799590204317*^9, 
   3.4887995949317703`*^9}, {3.488905032399328*^9, 3.488905074502903*^9}, {
   3.488905995701621*^9, 3.488906012709155*^9}, {3.488908908398217*^9, 
   3.488908944124919*^9}, {3.488910831327017*^9, 3.4889108423771477`*^9}, {
   3.4890726549096403`*^9, 3.489072662797327*^9}, {3.4891729185071173`*^9, 
   3.4891729358837767`*^9}, {3.4891852990929203`*^9, 3.489185322500412*^9}, {
   3.4891861018537807`*^9, 3.489186107828829*^9}, {3.489186239638032*^9, 
   3.489186423719975*^9}, {3.489500103609043*^9, 3.489500127402356*^9}, {
   3.489502070104203*^9, 3.489502079270999*^9}, {3.489528644069479*^9, 
   3.48952865210007*^9}, {3.489581857479967*^9, 3.489581872425159*^9}, {
   3.489594776223624*^9, 3.48959478039452*^9}, {3.489599546358903*^9, 
   3.489599553445969*^9}, {3.4904640609378567`*^9, 3.4904640813535423`*^9}, {
   3.4923818283938828`*^9, 3.492381853832823*^9}, {3.492719276298833*^9, 
   3.492719285546547*^9}, {3.494191163127665*^9, 3.494191231544264*^9}, {
   3.494553478964487*^9, 3.4945535067114363`*^9}, {3.494933478522702*^9, 
   3.494933580238579*^9}, {3.494956504677062*^9, 3.494956513691464*^9}, {
   3.495144551035173*^9, 3.495144557497035*^9}, {3.495499410541114*^9, 
   3.495499445204793*^9}, {3.500423358552849*^9, 3.500423401005906*^9}, {
   3.507576264030871*^9, 3.5075762851594763`*^9}, {3.507594176196891*^9, 
   3.507594191628158*^9}, {3.511716748936874*^9, 3.511716825669545*^9}, {
   3.5122182718552094`*^9, 3.512218311943791*^9}, {3.512218760910523*^9, 
   3.512218767206703*^9}, {3.512219862968925*^9, 3.5122198820815773`*^9}, {
   3.517266025160874*^9, 3.517266036046763*^9}, {3.533588008845088*^9, 
   3.533588033275733*^9}, {3.534206589499896*^9, 3.5342066401492977`*^9}, {
   3.534854945318975*^9, 3.534854994543849*^9}, {3.544268160504195*^9, 
   3.544268181144541*^9}, {3.5447347798115683`*^9, 3.544734806516953*^9}, {
   3.5447443992740383`*^9, 3.5447444090005283`*^9}, {3.545005964050056*^9, 
   3.545005978225564*^9}, {3.545071385476355*^9, 3.545071389864606*^9}, {
   3.545155934660138*^9, 3.5451559517707987`*^9}, {3.545393838040143*^9, 
   3.545393850120571*^9}, {3.545836357595744*^9, 3.5458363779858637`*^9}, {
   3.5461127075873804`*^9, 3.5461127181674867`*^9}, {3.54704695662145*^9, 
   3.5470469681883173`*^9}, {3.5477661364688463`*^9, 3.547766162398752*^9}, {
   3.547910111421558*^9, 3.547910136205008*^9}, {3.5566649495237837`*^9, 
   3.556664953610434*^9}, {3.5581816279976063`*^9, 3.558181658313161*^9}, {
   3.558185423105515*^9, 3.558185475890441*^9}, {3.558186689852571*^9, 
   3.5581867180602217`*^9}, {3.558367699314197*^9, 3.558367709342978*^9}, {
   3.55838644396691*^9, 3.558386459286331*^9}, {3.558393682014306*^9, 
   3.558393719956655*^9}, {3.558537492985689*^9, 3.558537529499008*^9}, {
   3.558548672887184*^9, 3.558548703173818*^9}, {3.558549648569655*^9, 
   3.558549659448002*^9}, {3.5586968784342422`*^9, 3.558696897221396*^9}, {
   3.558872995151435*^9, 3.558873028890308*^9}, {3.558991622930688*^9, 
   3.558991642905723*^9}, {3.559004705816251*^9, 3.559004718087331*^9}, {
   3.55908472742305*^9, 3.559084779006495*^9}, {3.559091755527246*^9, 
   3.559091762382498*^9}, {3.559247842696783*^9, 3.559247902327732*^9}, {
   3.5594224533011913`*^9, 3.559422484881939*^9}, {3.5594252892154713`*^9, 
   3.559425291558573*^9}, {3.5595982385768147`*^9, 3.559598243187291*^9}, {
   3.559598283522911*^9, 3.559598301447818*^9}, {3.56000561366924*^9, 
   3.560005640125244*^9}, {3.561454115047871*^9, 3.561454126498559*^9}, 
   3.561480457062278*^9, {3.561480489358577*^9, 3.561480550805738*^9}, {
   3.561486387783155*^9, 3.561486397382161*^9}, {3.56150417652523*^9, 
   3.5615041950916967`*^9}, {3.561513240894936*^9, 3.561513255725985*^9}, {
   3.561557533943398*^9, 3.561557537445692*^9}, {3.561585082729371*^9, 
   3.561585096425199*^9}, {3.5616566029262247`*^9, 3.561656635686297*^9}, {
   3.561759627700233*^9, 3.561759711298231*^9}, {3.561814704449809*^9, 
   3.5618147348010283`*^9}, {3.562355632994934*^9, 3.5623556593616533`*^9}, {
   3.562442912806003*^9, 3.562442917404457*^9}, {3.562600699414871*^9, 
   3.562600733141769*^9}, {3.5642665771185617`*^9, 3.564266586317429*^9}, {
   3.564340850666662*^9, 3.564340881321506*^9}, {3.5654634035744553`*^9, 
   3.565463443287703*^9}, {3.56614096162836*^9, 3.566140967788121*^9}, {
   3.566141001187804*^9, 3.566141017265362*^9}, {3.566487754476015*^9, 
   3.566487757779353*^9}, {3.570902946697698*^9, 3.570902957402679*^9}, {
   3.571008699371966*^9, 3.571008720260045*^9}, {3.571061156787849*^9, 
   3.571061187268243*^9}, {3.571690801786248*^9, 3.571690813726057*^9}, {
   3.57201755898377*^9, 3.572017596821265*^9}, {3.572089589481161*^9, 
   3.572089622149887*^9}, {3.572223229740135*^9, 3.572223273056123*^9}, 
   3.572223336120501*^9, {3.572228374605936*^9, 3.572228389021106*^9}, {
   3.572370091040736*^9, 3.5723701328468857`*^9}, {3.572397915152405*^9, 
   3.5723979615993834`*^9}, {3.5724590392199497`*^9, 
   3.5724590620354424`*^9}, {3.572462893249482*^9, 3.572462906103194*^9}, {
   3.572463296573073*^9, 3.5724633035175734`*^9}, {3.572828257640501*^9, 
   3.572828273803878*^9}, {3.572830752035571*^9, 3.572830765627492*^9}, {
   3.572988872071185*^9, 3.572988922779193*^9}, {3.57304905271316*^9, 
   3.573049099469645*^9}, {3.574026871192438*^9, 3.574026884276594*^9}, {
   3.574030942451253*^9, 3.574030964354247*^9}, {3.5740320121804743`*^9, 
   3.574032017361334*^9}, {3.574035172078554*^9, 3.574035219299593*^9}, {
   3.574086286463869*^9, 3.574086319948634*^9}, {3.57437564136215*^9, 
   3.5743756908952208`*^9}, {3.574522047252674*^9, 3.574522054433025*^9}, {
   3.574597260743987*^9, 3.574597290540545*^9}, {3.57461852697889*^9, 
   3.574618577729219*^9}, {3.574708771483637*^9, 3.574708786948691*^9}, {
   3.574791615511478*^9, 3.574791639268845*^9}, {3.5747925793210287`*^9, 
   3.574792599869657*^9}, {3.57481230452808*^9, 3.57481231204565*^9}, {
   3.574981757687181*^9, 3.5749817951717567`*^9}, {3.575235232137871*^9, 
   3.575235262373604*^9}, {3.575236294510915*^9, 3.5752362963478613`*^9}, {
   3.575310159064971*^9, 3.57531017767841*^9}, {3.5753964312176123`*^9, 
   3.575396477829555*^9}, {3.575493711067546*^9, 3.575493722784335*^9}, {
   3.5755705291446743`*^9, 3.57557053764846*^9}, {3.5756387912878103`*^9, 
   3.57563882461129*^9}, {3.5758435403983*^9, 3.57584355089886*^9}, {
   3.5759908104728622`*^9, 3.575990823910756*^9}, {3.576008628672483*^9, 
   3.576008630516501*^9}, {3.5760086607007093`*^9, 3.576008687156363*^9}, {
   3.576011705288333*^9, 3.576011722935834*^9}, {3.576082381917047*^9, 
   3.576082409376935*^9}, {3.576256098833907*^9, 3.5762561072629013`*^9}, {
   3.576261946880177*^9, 3.576261952039135*^9}, {3.5766136720752697`*^9, 
   3.576613675348703*^9}, {3.5766186611940413`*^9, 3.5766187092976913`*^9}, {
   3.576626705245098*^9, 3.576626735467705*^9}, {3.576682517273307*^9, 
   3.576682581108452*^9}, {3.576685964108535*^9, 3.576685977427164*^9}, {
   3.576795226519442*^9, 3.576795236292285*^9}, {3.577035641554883*^9, 
   3.5770356775597982`*^9}, {3.57721220094302*^9, 3.5772122150173264`*^9}, {
   3.577317467401299*^9, 3.57731748958206*^9}, {3.577317908995802*^9, 
   3.577317910339313*^9}, {3.5774945390348454`*^9, 3.57749454386906*^9}, {
   3.577637614888356*^9, 3.577637621592078*^9}, {3.577982768191517*^9, 
   3.577982806828854*^9}, {3.578004229970479*^9, 3.5780042535378237`*^9}, {
   3.5780459884028053`*^9, 3.578045997545356*^9}, {3.57808019004184*^9, 
   3.578080253661989*^9}, {3.578162120196496*^9, 3.578162158259688*^9}, {
   3.578356194595522*^9, 3.578356236044758*^9}, {3.578400887508738*^9, 
   3.578400928129777*^9}, {3.578587785302391*^9, 3.578587799536701*^9}, {
   3.583704726803606*^9, 3.583704743336172*^9}, {3.584829137514471*^9, 
   3.584829187481983*^9}, {3.5848310697812777`*^9, 3.584831122683654*^9}, {
   3.585940800076371*^9, 3.585940836209903*^9}, {3.5912936881745663`*^9, 
   3.591293692605611*^9}, {3.592574130886695*^9, 3.592574147558488*^9}, {
   3.6059562031868563`*^9, 3.605956228374139*^9}, {3.6114455404694223`*^9, 
   3.611445604430179*^9}, {3.625610154950742*^9, 3.6256101817873573`*^9}, {
   3.705711067075838*^9, 3.705711093730508*^9}, {3.705711750556438*^9, 
   3.7057117675530653`*^9}, {3.705711902612565*^9, 3.7057119113953667`*^9}, {
   3.705714094445448*^9, 3.705714121118927*^9}, {3.705860657157978*^9, 
   3.705860709228663*^9}, {3.70586079908773*^9, 3.705860799164042*^9}, {
   3.705860921880576*^9, 3.705860931277861*^9}, {3.7059653314950047`*^9, 
   3.7059653609101353`*^9}, {3.705965406743236*^9, 3.705965458525155*^9}, {
   3.705966177951785*^9, 3.705966199784214*^9}, {3.705966231080345*^9, 
   3.705966253079398*^9}, {3.706109617556114*^9, 3.706109631552868*^9}, {
   3.706113980204009*^9, 3.706113998973353*^9}, 3.7061140693637533`*^9, {
   3.706190690221682*^9, 3.706190714705084*^9}, {3.7064568252132797`*^9, 
   3.7064568330502234`*^9}},ExpressionUUID->"f3126382-f7a2-4fbc-b6ed-\
f6f2e53490d4"]
}, Closed]],

Cell[CellGroupData[{

Cell["Version", "Subtitle",
 CellChangeTimes->{{3.449154177644119*^9, 
  3.449154178315691*^9}},ExpressionUUID->"5270b78c-3cc1-4aff-b182-\
04ace7bff920"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BeginPackage", "[", "\"\<Cellzilla2D`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"$Cellzilla2DVersion", "=", "\"\<3.0.51f (14 June 2017)\>\"", 
  "  "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.44708550146164*^9, 3.447085519729595*^9}, {
   3.447246560164815*^9, 3.447246561370977*^9}, {3.447378444256976*^9, 
   3.4473784448966*^9}, {3.447513448343235*^9, 3.447513452062564*^9}, {
   3.448464499162474*^9, 3.448464503184067*^9}, {3.448536579758813*^9, 
   3.448536583206728*^9}, {3.448641627466339*^9, 3.448641632968729*^9}, {
   3.448672437102291*^9, 3.448672447909139*^9}, {3.448672623317397*^9, 
   3.448672625686824*^9}, {3.448706043238247*^9, 3.448706043347466*^9}, {
   3.448914938980966*^9, 3.448914939274298*^9}, {3.448979158003643*^9, 
   3.448979162953196*^9}, {3.449044763799004*^9, 3.449044764502652*^9}, {
   3.449154166367378*^9, 3.449154191058763*^9}, {3.44915425401509*^9, 
   3.449154272402611*^9}, {3.449154310399824*^9, 3.449154312957228*^9}, {
   3.450098799512031*^9, 3.450098800254355*^9}, {3.450720701340384*^9, 
   3.450720749321821*^9}, {3.450800428266364*^9, 3.450800428897212*^9}, {
   3.450807811690387*^9, 3.450807827625998*^9}, {3.4510508271622343`*^9, 
   3.45105082727341*^9}, {3.451738694260494*^9, 3.451738694552915*^9}, {
   3.4518420735388317`*^9, 3.451842073767502*^9}, {3.451935552116736*^9, 
   3.451935552989931*^9}, {3.4523280497005367`*^9, 3.452328050704438*^9}, {
   3.4523570478321133`*^9, 3.4523570482466784`*^9}, {3.452439655902934*^9, 
   3.452439662367014*^9}, {3.4528778621810713`*^9, 3.452877873038556*^9}, {
   3.453145528514715*^9, 3.453145531440771*^9}, {3.453222538872039*^9, 
   3.453222542518283*^9}, {3.4534837164241533`*^9, 3.453483717079914*^9}, {
   3.4537358466639433`*^9, 3.453735849547385*^9}, {3.454070732523788*^9, 
   3.454070732661178*^9}, {3.454155640464971*^9, 3.454155641920703*^9}, {
   3.454414709844427*^9, 3.4544147288772793`*^9}, {3.454433911520977*^9, 
   3.454433922852908*^9}, 3.4544339608724947`*^9, {3.454434703983547*^9, 
   3.454434709362465*^9}, {3.454615903881719*^9, 3.454615913522326*^9}, {
   3.454878546114135*^9, 3.454878548299066*^9}, {3.4549616195490837`*^9, 
   3.454961620933508*^9}, {3.4550172983850813`*^9, 3.4550172986836233`*^9}, {
   3.455120226415049*^9, 3.455120230969994*^9}, {3.455291747409445*^9, 
   3.455291749415958*^9}, {3.455379798141774*^9, 3.455379807664893*^9}, {
   3.456320609078105*^9, 3.4563206247533903`*^9}, {3.456532412766273*^9, 
   3.456532416059662*^9}, {3.456580195267208*^9, 3.456580199176642*^9}, {
   3.456688551788109*^9, 3.456688553866485*^9}, {3.456748770479512*^9, 
   3.456748773417966*^9}, {3.456846112638721*^9, 3.456846116634095*^9}, {
   3.457101204264512*^9, 3.457101208425262*^9}, {3.45727440503828*^9, 
   3.457274409359655*^9}, {3.457354344474598*^9, 3.457354346813746*^9}, {
   3.457447325609497*^9, 3.45744732741833*^9}, {3.459005529179584*^9, 
   3.4590055362757473`*^9}, {3.459266371347254*^9, 3.459266373961815*^9}, {
   3.459539026136714*^9, 3.4595390307534847`*^9}, {3.4596035331498747`*^9, 
   3.4596035336797543`*^9}, {3.459622355559682*^9, 3.459622357081716*^9}, {
   3.4608242204333267`*^9, 3.460824224035262*^9}, {3.461166310140079*^9, 
   3.461166311734499*^9}, {3.4611721307146463`*^9, 3.4611721313749323`*^9}, 
   3.461173767099345*^9, {3.46117388219135*^9, 3.461173896660584*^9}, {
   3.4705241475221367`*^9, 3.4705241550659943`*^9}, {3.488798643544065*^9, 
   3.488798650188335*^9}, {3.488900016126696*^9, 3.488900017074338*^9}, {
   3.48917301003386*^9, 3.489173010280579*^9}, {3.489499532135942*^9, 
   3.489499533111123*^9}, {3.4904640541544*^9, 3.490464054881823*^9}, {
   3.492362685827731*^9, 3.492362688030909*^9}, {3.4923818761003933`*^9, 
   3.492381879132498*^9}, {3.494189732471513*^9, 3.494189743325204*^9}, {
   3.494553517691255*^9, 3.4945535199303713`*^9}, {3.4949311656905193`*^9, 
   3.494931169945162*^9}, {3.500423297236657*^9, 3.500423303562611*^9}, {
   3.507576152710991*^9, 3.5075761616695833`*^9}, {3.507686095693809*^9, 
   3.5076861079081573`*^9}, {3.511716429618547*^9, 3.5117164398407516`*^9}, {
   3.512215786274899*^9, 3.512215792873933*^9}, {3.512322329616261*^9, 
   3.512322330616124*^9}, {3.51234054699522*^9, 3.51234054846666*^9}, {
   3.517264474022727*^9, 3.517264481988309*^9}, {3.5335883319711246`*^9, 
   3.533588339378306*^9}, {3.534204082243291*^9, 3.5342040864016943`*^9}, {
   3.534851733479195*^9, 3.534851740588972*^9}, {3.544268137473881*^9, 
   3.5442681491266108`*^9}, {3.544460741519628*^9, 3.544460748648841*^9}, 
   3.54473483395792*^9, {3.544998709848447*^9, 3.5449987135186653`*^9}, {
   3.545393857102591*^9, 3.545393857813809*^9}, {3.5455005147878375`*^9, 
   3.5455005152898664`*^9}, {3.545649443302464*^9, 3.5456494450538692`*^9}, {
   3.5458342858182707`*^9, 3.545834286023719*^9}, {3.546005930991746*^9, 
   3.546005931120894*^9}, {3.546108944980999*^9, 3.546108945339799*^9}, {
   3.546201181613468*^9, 3.54620118179708*^9}, 3.546253511897476*^9, {
   3.5463582510351562`*^9, 3.546358252775344*^9}, {3.54663912181666*^9, 
   3.546639124399823*^9}, {3.5466965584958572`*^9, 3.546696558703662*^9}, {
   3.546808557156961*^9, 3.546808557308679*^9}, {3.546882366969089*^9, 
   3.546882367104013*^9}, {3.547042574596425*^9, 3.547042574781206*^9}, {
   3.547474132685233*^9, 3.547474133283309*^9}, {3.547558049336248*^9, 
   3.547558052078658*^9}, 3.5476628178501253`*^9, {3.547728276163315*^9, 
   3.547728276313635*^9}, {3.547905526796579*^9, 3.5479055269485493`*^9}, {
   3.548004384065071*^9, 3.548004384312443*^9}, {3.548254587189589*^9, 
   3.548254589636963*^9}, {3.5484360241735563`*^9, 3.548436024676516*^9}, {
   3.548516185952137*^9, 3.548516186199692*^9}, {3.5490273989108047`*^9, 
   3.549027399727854*^9}, 3.5491351103117743`*^9, {3.549202524974557*^9, 
   3.549202526772113*^9}, {3.549470215872946*^9, 3.549470216038929*^9}, {
   3.549576181187986*^9, 3.549576181445174*^9}, {3.549719828709611*^9, 
   3.549719830661035*^9}, {3.549915853322287*^9, 3.5499158540442123`*^9}, {
   3.556661163080236*^9, 3.556661166491499*^9}, {3.5567254074846153`*^9, 
   3.556725407637013*^9}, {3.5567983377271023`*^9, 3.556798339909964*^9}, {
   3.557001581913188*^9, 3.557001584313135*^9}, {3.55786644663547*^9, 
   3.557866447783628*^9}, 3.5579326207121162`*^9, {3.558021796538807*^9, 
   3.558021797140864*^9}, {3.558086707006822*^9, 3.558086709309671*^9}, {
   3.558177694234133*^9, 3.558177697018387*^9}, {3.558177837474662*^9, 
   3.5581778377536297`*^9}, {3.558180718400077*^9, 3.558180718675803*^9}, {
   3.55836366414389*^9, 3.558363671334004*^9}, {3.5585347955141706`*^9, 
   3.558534799808444*^9}, {3.55869690191341*^9, 3.5586969027771397`*^9}, {
   3.558873034343175*^9, 3.558873035142398*^9}, {3.558991653208816*^9, 
   3.558991653408649*^9}, {3.559091771246608*^9, 3.559091773214361*^9}, {
   3.5592481715573673`*^9, 3.559248171692778*^9}, {3.559416797872671*^9, 
   3.55941679821621*^9}, {3.559422448561824*^9, 3.559422448737699*^9}, {
   3.559477879812079*^9, 3.559477880370246*^9}, {3.559592113052796*^9, 
   3.5595921151418257`*^9}, {3.5595983063789997`*^9, 3.559598306505699*^9}, 
   3.5596620589853086`*^9, {3.560004236050498*^9, 3.560004236129284*^9}, {
   3.560168349201996*^9, 3.560168349507159*^9}, {3.5612574344818707`*^9, 
   3.5612574378175077`*^9}, {3.561454107732936*^9, 3.5614541099872007`*^9}, 
   3.561501543918487*^9, 3.561503087325507*^9, {3.56155562727705*^9, 
   3.561555627955369*^9}, {3.5615824903009033`*^9, 3.561582492642645*^9}, {
   3.561656653432905*^9, 3.561656653631219*^9}, {3.561759622268152*^9, 
   3.561759622484111*^9}, {3.5620039440893793`*^9, 3.56200394424105*^9}, {
   3.562108285199733*^9, 3.562108285686264*^9}, {3.5623421393476343`*^9, 
   3.562342139565906*^9}, {3.5624402454789267`*^9, 3.562440246301701*^9}, {
   3.562598706343018*^9, 3.562598706570384*^9}, {3.5630325179611597`*^9, 
   3.563032518520108*^9}, {3.564262069953206*^9, 3.564262074539961*^9}, {
   3.564340475436475*^9, 3.5643404755753393`*^9}, {3.564512573450746*^9, 
   3.56451257363447*^9}, {3.5654562579927807`*^9, 3.565456258077729*^9}, {
   3.565712044720213*^9, 3.56571204526383*^9}, {3.56575920100202*^9, 
   3.565759201632815*^9}, {3.566139605275189*^9, 3.56613961109*^9}, {
   3.5664021331092873`*^9, 3.56640213471673*^9}, {3.566487764288877*^9, 
   3.566487764862852*^9}, {3.566647245845598*^9, 3.56664724658989*^9}, {
   3.569092460673101*^9, 3.569092478321368*^9}, {3.57090292593153*^9, 
   3.570902934616634*^9}, 3.571008727212014*^9, {3.571061148394177*^9, 
   3.571061149095945*^9}, {3.571678167216798*^9, 3.5716781723969593`*^9}, {
   3.572011418107815*^9, 3.57201142121845*^9}, {3.572089627428521*^9, 
   3.572089629194045*^9}, 3.5721125330080833`*^9, {3.572223219583076*^9, 
   3.572223224514703*^9}, 3.572260104344119*^9, {3.572368700509377*^9, 
   3.572368702524081*^9}, {3.57245861198978*^9, 3.5724586174329357`*^9}, {
   3.572825275015183*^9, 3.572825279279624*^9}, {3.572872407553199*^9, 
   3.572872408902668*^9}, {3.572988058430952*^9, 3.572988060116938*^9}, {
   3.5730490460582943`*^9, 3.5730490477290154`*^9}, {3.574026891340238*^9, 
   3.574026896963447*^9}, {3.574083258983027*^9, 3.574083262190094*^9}, {
   3.574375631325313*^9, 3.574375634700243*^9}, {3.574518244796863*^9, 
   3.574518249820745*^9}, {3.5745972515398493`*^9, 3.5745972570010233`*^9}, {
   3.574708764711067*^9, 3.574708767213328*^9}, {3.574791609282895*^9, 
   3.574791611480311*^9}, {3.574977144780205*^9, 3.574977147788497*^9}, {
   3.575231645990945*^9, 3.57523164613443*^9}, {3.575310144682959*^9, 
   3.5753101527780313`*^9}, {3.5753897505592527`*^9, 3.575389753890798*^9}, {
   3.575493697373358*^9, 3.575493700299707*^9}, {3.5755707501324177`*^9, 
   3.575570750475045*^9}, {3.575638785363598*^9, 3.57563878755899*^9}, {
   3.575843530809259*^9, 3.5758435360795937`*^9}, {3.575990803005501*^9, 
   3.575990805443763*^9}, {3.57600864349714*^9, 3.576008669889195*^9}, {
   3.576082373112791*^9, 3.5760823766141233`*^9}, {3.576255498294958*^9, 
   3.576255501570739*^9}, {3.576255650761153*^9, 3.5762556539695272`*^9}, {
   3.576613680204083*^9, 3.576613687554138*^9}, {3.576682594442863*^9, 
   3.5766825989304857`*^9}, {3.576795242993816*^9, 3.576795245128213*^9}, {
   3.5770356827158003`*^9, 3.577035686347796*^9}, {3.577212220777014*^9, 
   3.5772122241289597`*^9}, {3.577317446619585*^9, 3.577317452034346*^9}, {
   3.577494532438858*^9, 3.577494534261024*^9}, {3.5776376016094017`*^9, 
   3.577637602581216*^9}, {3.577740591198957*^9, 3.577740591357602*^9}, {
   3.577982756355104*^9, 3.577982781674941*^9}, 3.578000878811577*^9, {
   3.578046003149976*^9, 3.5780460037575397`*^9}, {3.578080183612945*^9, 
   3.578080184243245*^9}, {3.578159120134213*^9, 3.578159120227735*^9}, {
   3.5783420116756907`*^9, 3.578342014926396*^9}, {3.5784008798406477`*^9, 
   3.578400880055729*^9}, {3.5785207499278193`*^9, 3.5785207503751507`*^9}, {
   3.578584892997176*^9, 3.5785848949087553`*^9}, {3.578587771000266*^9, 
   3.57858777126396*^9}, {3.583704749566231*^9, 3.583704756274871*^9}, {
   3.5848281286921673`*^9, 3.5848281341769657`*^9}, {3.585940785628714*^9, 
   3.585940793197504*^9}, {3.59129357135674*^9, 3.5912935827656507`*^9}, {
   3.592574113409676*^9, 3.592574118640286*^9}, {3.605956186406021*^9, 
   3.605956196429347*^9}, {3.611445528286327*^9, 3.6114455351270237`*^9}, {
   3.6256101418065033`*^9, 3.625610147593519*^9}, {3.705710858984627*^9, 
   3.705710883884767*^9}, {3.705860879361043*^9, 3.705860882116622*^9}, {
   3.705947855790847*^9, 3.7059478595060997`*^9}, {3.705965320503347*^9, 
   3.7059653206969357`*^9}, {3.7061096396618757`*^9, 3.706109644058687*^9}, {
   3.706190724915502*^9, 3.7061907299278708`*^9}, {3.706456844183362*^9, 
   3.706456845821886*^9}},ExpressionUUID->"2a0ca561-6b71-4679-88f6-\
835bac325486"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Entry Points", "Subtitle",
 CellChangeTimes->{{3.446838472865799*^9, 3.446838476297995*^9}, {
  3.447356305364802*^9, 
  3.447356306492139*^9}},ExpressionUUID->"6837c32b-afc1-4f7e-b186-\
f8cf5abdb1d0"],

Cell[CellGroupData[{

Cell[TextData[{
 "Test for ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " Version Compatibility"
}], "Subsubsection",
 CellChangeTimes->{{3.461173789208498*^9, 
  3.4611737949705257`*^9}},ExpressionUUID->"bc40ed0d-c9f2-4447-8c7d-\
77a0c30e66e1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"$VersionNumber", "<", "6"}], ",", " ", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<This package requires Mathematica Version 6.0.3 or higher.\>\"", 
       "]"}], ";", " ", 
      RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"$VersionNumber", "\[Equal]", "6"}], " ", "\[And]", " ", 
      RowBox[{"$ReleaseNumber", "<", "3"}]}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<This package requires Mathematica Version 6.0.3 or higher; You \
have version 6.0.\>\"", "<>", 
        RowBox[{"ToString", "[", "$ReleaseNumber", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Abort", "[", "]"}], ";"}]}], " ", "\[IndentingNewLine]", "]"}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Needs", "[", "\"\<XML`\>\"", "]"}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.446837661329038*^9, 3.446837675247263*^9}, {
   3.448486036959854*^9, 3.448486071718078*^9}, {3.448718046013006*^9, 
   3.448718063630794*^9}, {3.448718191840066*^9, 3.448718253926471*^9}, 
   3.449154161822623*^9, 3.449154320617636*^9, {3.4611737822215233`*^9, 
   3.461173782830442*^9}},ExpressionUUID->"90578cbe-3f29-4f7e-8ca2-\
cad21dd85d84"]
}, Closed]],

Cell[CellGroupData[{

Cell["Memory Testing (Jlink)", "Subsubsection",
 CellChangeTimes->{{3.549204090145067*^9, 3.549204093312233*^9}, {
  3.549204225225087*^9, 
  3.54920422901679*^9}},ExpressionUUID->"d996549c-0024-4f85-83ff-\
e04cbeb82f03"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MemoryInstalled", "::", "usage"}], "=", 
   "\"\<MemoryInstalled[] is the missing function in Mathematica that tells \
you how much memory you have installed. It requires JLink so it may not work \
on all operating systems.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MemoryFree", "::", "usage"}], "=", 
   "\"\<MemoryFree[] is the missing function in Mathematica that tells you \
how much system memory is free (the complement of MemoryInUse[]). Requires \
JLink so it may not work on all operating systems.\>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.549204095061039*^9, 
  3.549204220048308*^9}},ExpressionUUID->"3ecc12ca-045a-47f2-885c-\
a648887c8ed8"]
}, Closed]],

Cell[CellGroupData[{

Cell["mPower compatibility", "Subsubsection",
 CellChangeTimes->{{3.454162873151237*^9, 
  3.454162875598526*^9}},ExpressionUUID->"57dede2b-12ea-4a25-971e-\
b46b47d28120"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DelaunayMean", "::", "usage"}], "=", 
    "\"\<DelaunayMean[{{\!\(\*SubscriptBox[\(x\), \
\(1\)]\),\!\(\*SubscriptBox[\(y\), \(1\)]\)},{\!\(\*SubscriptBox[\(x\), \
\(2\)]\),\!\(\*SubscriptBox[\(y\), \(2\)]\)},...}]\\nReturns the average \
length of all the links in the Delaunay Triangulation\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DelaunayEdges", "::", "usage"}], "=", 
    "\"\<DelaunayEdges[{{\!\(\*SubscriptBox[\(x\), \
\(1\)]\),\!\(\*SubscriptBox[\(y\), \(1\)]\)},{\!\(\*SubscriptBox[\(x\), \
\(2\)]\),\!\(\*SubscriptBox[\(y\), \(2\)]\)},...}]\\nReturns a the \
coordinates of the end points of all the links in the Delaunay Triangulation, \
{\!\(\*SubscriptBox[\(link\), \(1\)]\), \!\(\*SubscriptBox[\(link\), \
\(2\)]\),..} where each \!\(\*SubscriptBox[\(link\), \(i\)]\) has the form {{\
\!\(\*SubscriptBox[\(x\), \(1\)]\),\!\(\*SubscriptBox[\(y\), \(1\)]\)}, {\!\(\
\*SubscriptBox[\(x\), \(2\)]\),\!\(\*SubscriptBox[\(y\), \(2\)]\)}}.\>\""}], 
   ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConvexHullVertices", "::", "usage"}], "=", 
    "\"\<ConvexHullVertices[{{\!\(\*SubscriptBox[\(x\), \
\(1\)]\),\!\(\*SubscriptBox[\(y\), \(1\)]\)},{\!\(\*SubscriptBox[\(x\), \
\(2\)]\),\!\(\*SubscriptBox[\(y\), \(2\)]\)}, ...}]\\nReturns the convex hull \
as a list of vertex coordinates.\>\""}], ";"}], " "}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GenerateBoundaryLayer", "::", "usage"}], "=", 
    "\"\<GenerateBoundaryLayer[{{\!\(\*SubscriptBox[\(x\), \
\(1\)]\),\!\(\*SubscriptBox[\(y\), \(1\)]\)},{\!\(\*SubscriptBox[\(x\), \
\(2\)]\),\!\(\*SubscriptBox[\(y\), \(2\)]\)}, ...}]\\nReturns an artificial \
boundary layer of points obtained by extending the convex hull out by a \
diameter equal to the average length of the delaunay triangulation (before \
extension).\>\""}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BoundedCellVoronoi", "::", "usage"}], "=", 
    "\"\<BoundedCellVoronoi[{{\!\(\*SubscriptBox[\(x\), \
\(1\)]\),\!\(\*SubscriptBox[\(y\), \(1\)]\)}, {\!\(\*SubscriptBox[\(x\), \
\(2\)]\),\!\(\*SubscriptBox[\(y\), \(2\)]\)}, ...}]\\nreturns a Tissue[..] \
object that represente the Bounded-Cell Voronoi Diagram, obtained as the \
Voronoi Diagram of the original cells after adding artificial cells around \
the convex hull.\>\""}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PrunedDelaunayEdges", "::", "usage"}], "=", 
   "\"\<PrunedDelaunayEdges[poitns] gives coordinates of endpoints of links \
in Pruned Delaunay Triangulation. The Delaunay Triangulation is is pruned by \
removing links that are not between cells that are touching in the Bounded \
Cell Voronoi.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PrunedDelaunayPairs", "::", "usage"}], "=", 
    "\"\<PrunedDelaunayPairs[points] returns a list of the {i,j} pairs in the \
pruned Delaunay Triangulation. The indices {i,j} refer to positions in the \
list of points. Only links between cells that are connected according to the \
BoundedCellVoronoi are included; other links in the Delaunay Triangulation \
are excluded. To get the actual coordinates of the links, use \
PrunedDelaunayEdges.\>\""}], ";"}], "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DelaunayPairs", "::", "usage"}], "=", 
  "\"\<DelaunayPairs[{{\!\(\*SubscriptBox[\(x\), \(1\)]\),\!\(\*SubscriptBox[\
\(y\), \(1\)]\)},{\!\(\*SubscriptBox[\(x\), \
\(2\)]\),\!\(\*SubscriptBox[\(y\), \(2\)]\)},...}]\\nReturns a the indices of \
the endpoints of the unique edges in the Delaunay Triangulation, as {i,j} \
pairs in the list of vertices.\>\""}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.454155901989496*^9, 3.454155905440239*^9}, {
  3.454156550269745*^9, 3.454156553114883*^9}, {3.454157330853731*^9, 
  3.454157462706805*^9}, {3.454157628094369*^9, 3.4541576575905743`*^9}, {
  3.4541577825311623`*^9, 3.4541577877807503`*^9}, {3.454160085347495*^9, 
  3.454160209418919*^9}, {3.454161976689928*^9, 3.4541619821953506`*^9}, {
  3.454162883244145*^9, 3.4541629732931223`*^9}, {3.4541631471232862`*^9, 
  3.454163163153646*^9}, {3.454163477257538*^9, 3.4541634814246492`*^9}, {
  3.454163789825686*^9, 3.454163795387982*^9}, {3.454163833417745*^9, 
  3.454163834011723*^9}, {3.454164005465733*^9, 
  3.454164258641667*^9}},ExpressionUUID->"e2f0ae0e-1b93-4f9a-a4f6-\
8a2443d31b26"],

Cell[BoxData["\<\"DelaunayPairs[{{\\!\\(\\*SubscriptBox[\\(x\\), \\(1\\)]\\),\
\\!\\(\\*SubscriptBox[\\(y\\), \\(1\\)]\\)},{\\!\\(\\*SubscriptBox[\\(x\\), \
\\(2\\)]\\),\\!\\(\\*SubscriptBox[\\(y\\), \\(2\\)]\\)},...}]\\nReturns a the \
indices of the endpoints of the unique edges in the Delaunay Triangulation, \
as {i,j} pairs in the list of vertices.\"\>"], "Output",
 CellChangeTimes->{3.488911070250724*^9, 3.54844462020714*^9, 
  3.572227430028776*^9},ExpressionUUID->"6e6bbaa3-66a8-4326-b209-\
e06c83ba0be5"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["simulations", "Subsubsection",
 CellChangeTimes->{{3.454162866562899*^9, 3.454162867012754*^9}, {
  3.4541665585276318`*^9, 
  3.4541665606760807`*^9}},ExpressionUUID->"034078c6-4c36-400c-9e8a-\
f7c7919adb1f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"go", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"grow", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"StaticSimulation", "::", "usage"}], "=", 
    "\"\<StaticSimulation[DTissue, start, stop, options] is a wrapper for \
grow that configures a static (non-growing) simulation. The tissue does not \
grow and cell division does not occur.  Equivalent to grow with a division \
threshold of \[Infinity] and \\\"Growing\\\"\[Rule]False. All non-growth \
related options for grow are still valid. \>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RunSim", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BinData", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SimBinData", "::", "usage"}], "=", 
    "\"\<SimBinData[variable, binspec,options] bins data from a saved \
simulation into a format that can be used to produce \
histograms.\\nbinspec={min,max,delta}\\noptions \
are:\\n\\\"Samples\\\"\[Rule]100 (default value), number of time samples, \
equally space\\n\\nReturn Value is a list of lists of the form {time, mean, \
sigma, bins}, where bins is a list of integer counts. \>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Bins2Histogram", "::", "usage"}], "=", 
    "\"\<Bins2Histogram[bins,{binmin,binmax,bindelta}] returns a plot, where \
bins is the output of SimBinData; and {binmin,binmax,bindelta} are the same \
as were passed to SimBinData. Options \
include:\\n\\\"Mean\\\"\[Rule]{Thick,Red} (styles for average histogram)\\n\\\
\"Style\\\"\[Rule]{Black} (styles for ensemble histograms)\\n\\\"Scatter\\\"\
\[Rule]True (include all histograms; if False, just plot \
mean)\\n\\\"ErrorBars\\\"\[Rule]True\\n\\\"Normalize\\\"\[Rule]False\\n\\\"\
Rounding\\\"\[Rule].1 - rounding for printing of stats on plots (on used for \
printing, not calculation).\\nas well as any Plot option.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SimBinSides", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SimPlot", "::", "usage"}], "=", 
   "\"\<SimPlot[sim, variable, {tstart, tend}, options] (any option for Plot)\
\\nSimPlot[sim, {tstart, tend}, options] - plots all variables\\nSimPlot[sim, \
{variables}, {tstart, tend}, options}] - plot specific \
variables\\nSimPlot[sim, options] - autodetect time \
span\\nOptions:\\n\\\"Grid\\\"\[Rule]False\\n\\\"Columns\\\"\[Rule]3 (if \
Grid=True)\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MultiSimPlot", "::", "usage"}], "=", 
   "\"\<MultSimPlot[sim, variable, {tstart, tend}, options]\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ShowInitialRates", "::", "usage"}], "=", 
    "\"\<ShowInitialRates[newtork, ic, rates, BoundaryConditions]\>\""}], 
   ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HasSufficientInfo", "::", "usage"}], "=", 
   "\"\<HasSufficientInfo[network, ic, parameters] returns True if there is \
sufficient informaiton to run a simulation (NDSolve) and False \
otherwise\\nHasSufficientInfo[network, ic, parameters, True] returns a string \
`This simulation is (not) complete and may (not) be used to run a \
simulation.' instead of a Boolean flag. \>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SimShow", "::", "usage"}], "=", 
    "\"\<SimShow[solution,variable, time, tissue, {rgbfrom, rgbto}, {vmin, \
vmax}]\\nTo display a legend use SimShowAt instead.\\nOptions:\\n\\\"Hues\\\"\
\[Rule]False or {hmin,hmax} where 0\[LessEqual]hmin,hmax\[LessEqual]1 are hue \
values that override the rgb color specs. Legends are not implemented with \
hues. \\nAny option for graphics or plot may also be used. \>\""}], ";"}], 
  "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SimShowFinal", "::", "usage"}], "=", 
    "\"\<SimShowFinal[solution, variable, template, {colormin, colormax}, \
options]\>\""}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SimShowThreshold", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SimShowAt", "::", "usage"}], "=", 
    "\"\<SimShowAt[solution,variable,time, template,{colormin, colormax}, \
options] or \\nSimShowAt[solution,variable,time,template,{colormin,colormax}, \
{vmin,vmax}, optoins]\\nLike SimShow but with a legend.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SimAnimate", "::", "usage"}], "=", 
    "\"\<SimAnimate[solution, Variable, Template, {tstart, tend, deltat}, \
{colormin, colormax}, {valmin, valmax}, options]\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"WTAAnimate", "::", "usage"}], "=", 
   "\"\<\nWTAAnimate[{var1, var2,...}, {color1, color2, ...}, opt___?OptionQ]\
\nWinner Take All SimAnimate: Performs a winner-take-all strategy on the \
variables listed and displays the color of the corresponding maximum variable \
in each cell\nOptions are the same as SimAnimate (except colors are defined \
by arguments)\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"WTAShow", "::", "usage"}], "=", 
   "\"\<\nWTAShow[Tissue, Solution, Time, {var1, var2, ...}, {Color1, Color2, \
...}, options]\nWinner Take All SimShow: Performs a winner-take-all strategy \
on the variables listed and displays the color of the corresponding maximum \
variable in each cell\n[Tissue, Solution, Time,   {var1, var2, ...}, {Color1, \
Color2, ...}, backgroundColor,  {min, max},  options]\nAllows all values to \
be displayed using RGBInterpolate on a range of [backgroundColor --> Color] \
on the same scale\nOptions for SimShow may be used\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LineageAnimate", "::", "usage"}], "=", 
    "\"\<LineageAnimate[options] or LineageAnimate[folder, options], displays \
the tissue as an animation of the lineags of the ancestral cells (in the \
first tissue). Options are the same as SimAnimate; additionally, \\\"Colors\\\
\" may be specified (up to the number of cells in the original tissue). \
\>\""}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LineageShow", "::", "usage"}], "=", 
    "\"\<LineageShow[Tissue, Lineage] or LineageShow[DTissue, Solution, Time, \
Lineage]. Lieage is the lineage data structure written by Grow.\>\""}], ";"}],
   " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SaveFrames", "::", "usage"}], "=", 
   "\"\<SaveFrames[pictures_?ListQ,type_, size_, movieType_:\\\".avi\\\",  \
label_:\\\"MovieData\\\", framerate_:8]\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ToAVI", "::", "usage"}], "=", 
   "\"\<ToAvi[pics_,title_:\\\"MovieData\\\",  size_:400, rate_:16]\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ToMOV", "::", "usage"}], "=", 
    "\"\<ToMOV[pics_,title_:\\\"MovieData\\\",  size_:400, rate_:16]\>\""}], 
   ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SimRange", "::", "usage"}], "=", 
    "\"\<SimRange[solution, Variable,time] gives {min, max} of variable over \
the tissute.\>\""}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SimInterpolate", "::", "usage"}], "=", 
    "\"\<SimInterpolate[solution, variable, time] returns list of values of \
variable in each cell.\>\""}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CommonTimeDomain", "::", "usage"}], "=", 
    "\"\<CommonTimeDomain[solution] returns the time range represented by all \
variables in the solution.\>\""}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BellCurve", "::", "usage"}], "=", "\"\<\>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwdy3lI02Ecx/HpPNAEAzFJdHmULnMmYxlpth6P8mCIBUFlmatwarZpzjAJ
zDNniI01j63MWErLNLU/VGSSmeiMUNHUNbW8f4+hwyMv0p7v748PL/jA210o
vnTXnMFgcMnANNXnX4nNFMqSiqbBEHFU02wrhUxGDe25e+EFZm0U+j5iWQje
5Po4mBPdHpW7gsr53Sqw912SGhQqeG3gDS9uJ6iN6B4DLbO8x8FknW4SNKV+
pZ2lOv+B+bbxTCZRcmyxZ5T4Y8qxF7ylqWHFtVPIOZjtBvI4poQc4qer1UIw
n5OmBZVvh2lDS+v7wP4Mfz04uNlk84QYOPeCBUqaZA0uHRS6ZtXQAobnyZWu
xDvPC1+C7JVGDO6cl62BFXw7dSQxxC+RNlcnljb0UEj/NDQT1BzV/DXsUyhd
INgEtb4WF0YsMRo3LsSCW1cGhxqTMOqSekyDdVWbc6Bxj0fRf7HNOuivv70L
nnlm7yRIxqjkVCdtLbs0Flyyq7oMtpZNrI6lYOTjFbMGarOLu9ippF/doF1J
d/gdfR8jWdlp2lWvysDgXIzmt7yDQL4qOltMNHiclYNfyvZ4acSK8sMBoHuS
7XYukfXxMTOPyOG71LYQj/sP0S531+nBhDrGKBhmsHGIz8PIL9T6CDjcx9mp
Jy7rDph9IPqme8pT8zGaGlDQRotED8RqjERRzRlg92DMQgZRtzGLwcztgkgp
cbHaXADaB7xXgBZtKa/B6xPrHlY1GAkfzniCyUWSEAPxm9rpIsjCA/s/iVz7
oINGYsSJV46gc6zqECgzWY+1v8EozmWGNkwwpOogKif/1IMnt4tyBMwl1J85
UwL+B4DmrFA=
  "],ExpressionUUID->"634819c7-e1c0-480d-8c02-41d040529c58"]
}, Open  ]],

Cell[CellGroupData[{

Cell["networks", "Subsubsection",
 CellChangeTimes->{{3.4541665529782743`*^9, 
  3.454166553867962*^9}},ExpressionUUID->"7f7eb231-eeca-4a0e-a38e-\
2bdbee1f8a31"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CelleratorNetwork", "::", "usage"}], "=", 
    "\"\<CelleratorNetwork[tissue,options]\\n\\\"Reactions\\\"-> network , \
wherenetwork is any xCellerator reaction network, e.g., as stored in Sigmoid \
(NOT indexed by cell; the cell indices will be added\\n\\\"Diffusion\\\"-> \
{{x,\!\(\*SubscriptBox[\(\[Beta]\), \(x\)]\)}, {y, \!\(\*SubscriptBox[\(\
\[Beta]\), \(y\)]\)}, ...}, list of species and penetrability coefficients \
constants.\\n\\\"Verbose\\\"\[Rule]True, set to false to suppress printing \
summary message.\\n\\\"Area\\\"\[Rule]None, specify a symbol to replace \
\!\(\*SubscriptBox[\(A\), \(i\)]\) with var[i][t] \\n\\\"Edge\\\"\[Rule]None, \
specify a symbol to replace  \!\(\*SubscriptBox[\(\[ScriptL]\), \(ij\)]\) \
with edge[p][t] where p is the edge number between nodes i and j.\\n\\nIf \
cell sizes will change during the simulation the options \\\"Area\\\" and \
\\\"Edge\\\" must be specified. If one is specified but the other is not a \
unique variable name will be generated.\>\""}], " ", ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"WalledNetwork", "::", "usage"}], "=", 
    "\"\<WalledNetwork[internalReactions,\\nDiffusionReactions,\n\\\"Area\\\"\
\[Rule]Area Variable Name (None or not used: statis values from tissue),\n\
\\\"Edge\\\"\[Rule]Edge Variable Name (None or not used: static values from \
tissue),\n\\\"WallReactions\\\"\[Rule]Optional List of (unindexed) reactions \
to instantiate in walls,\n\\\"BoudaryConditions\\\"\[Rule]Options List of \
(uninexed) constant boundary conditions\\n]\ninternalReactions is any \
(unindexed) Cellerator network; the indices will be instantiated in every \
cell and edge at run time. Values in cells will be X[i]; values in edges will \
become x[cellnumber, edgenumber].\\nDiffusionReactions = {reaction, reaction, \
...} where each reaction is:\\n{variable, {betaout, betain, betawall}, {fout, \
fin, fwall}}\\nwhere the out, in, and wall refers to efflux from the cell; \
influx to the cell; and wall to wall component diffusion. Each wall has two \
layers, adjacent to each cell, except for the outer boundary of the tissue. \
The Functions each have three arguments of the form f[cell1, cell2, \
edgenumber], and are optional. The total penetrability is given by \
beta*function. \>\""}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SSANetwork", "::", "usage"}], "=", 
    "\"\<SSANetwork[network, diffusion, tissue]\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"X2SSANetwork", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQ/SBz45HLO146+mnePAqixZhlP0bteun4b9mPfyCa
pclJJBpIz7j7Vx5E929lVwXRq5KLzUD0HT5LKxDd/vpwKIhOmtq4JuPAS8eK
6t1rQXSW0bx3ILqgbuNXEN3x/uaBif9eOm7vnHcZRC+7u+46iH6mz/EIRM9d
8JC7LeOV45WAJTwguiCB43d/5itHG5VXFhOANNuiHDsQPSm92BlEu3+dkXYO
SAek6GeB6IMe9xQ98l85brnRrASiI/490wXRRgu/GoHoK7yeF2QLXjkqLZsI
phMWvXO83fHKcYJluQeIDnK95Auin1/a4Qei6/7lBYPouWHtYSDa5baKbFDn
K8etxv8UQDQAOLKvdg==
  
  "],ExpressionUUID->"120041ca-780e-4729-a6ac-6fcf720532d4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DivisionPotential", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OptimizeDivisionPotential", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PrincipalGrowthDirection", "::", "usage"}], "=", 
   "\"\<PrincipalGrowthDirection[DTissue,cellnumber, solution,time,xvar,yvar]\
\\ndetermines the principle direction of cell growth, taken as the \
eigenvector of the covariance matrix of the velocity vectors, with the \
largest eigenvalue.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PrincipalCellDirection", "::", "usage"}], "=", 
    "\"\<PrincipalGrowthDirection[DTissue,cellnumber, \
solution,time,xvar,yvar]\\ndetermines the principle direction of the cell, \
taken as the eigenvector of the covariance matrix of the coordinates of the \
vertices of the cell, with the largest eigenvalue.\>\""}], ";"}], 
  "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SetNextIC", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetRandomizedIC", "::", "usage"}], "=", 
   "\"\<SetRandomizedIC[tissue_?TissueQ,network_,ell_,area_,resting_,x_,y_,\
extension_,rmin_,rmax_]\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DetermineCellDivisionPoints", "::", "usage"}], "=", "\"\<\>\""}],
    ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BalanceLineage", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ShowBalancedLineage", "::", "usage"}], "\[Equal]", "\"\<\>\""}], 
   ";"}], " ", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$SIMDIR", "::", "usage"}], "=", 
   "\"\<Name of the last folder that simulations were written to\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$ODEFILE", "::", "usage"}], "=", 
   "\"\<Name of last ODE file saved during a growth simulation.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$OPTIONFILE", "::", "usage"}], "=", 
   "\"\<Name of last option file saved during a growth simulation.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$TISSUEFILE", "::", "usage"}], "=", 
   "\"\<Name of last tissue file saved during a growth simulation.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$NETFILE", "::", "usage"}], "=", 
   "\"\<Name of last reaction network file saved during a growth \
simulation.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$EQNFILE", "::", "usage"}], "=", 
   "\"\<Name of last equation file saved during a growth simulation.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$SOLUTIONFILE", "::", "usage"}], "=", 
   "\"\<Name of last solution file saved during a growth simulation.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$LINEAGEFILE", "::", "usage"}], "=", 
   "\"\<Name of last lineage file saved during a growth simulation.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$EDGELINEAGEFILE", "::", "usage"}], "=", 
   "\"\<Name of last edge lineage file saved during a growth \
simulation.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$ICFILE", "::", "usage"}], "=", 
   "\"\<Name of last set of initial conditions saved during a growth \
simulation.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ShowSavedFiles", "::", "usage"}], "=", 
   "\"\<ShowSavedFiles[] displays all the files saved in \
$SIMDIR\\nShowSavedFiles[type] shows all the files of the specified type in \
$SIMDIR. Values for type are: \\\"IC\\\",\\\"ODE\\\",  \\\"Options\\\", \
\\\"Tissue\\\", \\\"Net\\\", \\\"Equation\\\", \\\"Solution\\\", \
\\\"Lineage\\\",\\\"EdgeLineage\\\". Note that this will only show the files \
in the most recently run simulation. \>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetSavedFile", "::", "usage"}], "=", 
   "\"\<GetSavedFile[folder, type, n] returns the nth saved file of type in \
folder.\\nGetSavedFile[type] returns the last saved object, if it exists, \
that was saved during a growth simulation. \\nValues for type are: \
\\\"IC\\\",\\\"ODE\\\",  \\\"Options\\\", \\\"Tissue\\\", \\\"Net\\\", \
\\\"Equation\\\", \\\"Solution\\\", \\\"Lineage\\\",\\\"EdgeLineage\\\". Note \
that this will only return the last file in the most recent simulation, not \
earlier files, or earlier simulations.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetODES", "::", "usage"}], "=", 
    "\"\<GetODES[ODES, var] or GetODES[ODES,{var1,var2,...}] extracts all \
ODES for the specified indexed variables var[i], var[p,1], etc. \>\""}], 
   ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ShowResults", "::", "usage"}], "=", 
  "\"\<ShowResults[directory, number, spec, options] where spec is a list of \
the form {spec1, spec2, ...} and each spec ={variable, {color, color}, \
{value, value}}\>\""}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Transport", "::", "usage"}], "=", 
    "\"\<Transport is a header for a Transport Arrow\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Diffusion", "::", "Usage"}], "=", 
    "\"\<Diffusion is a header for a Diffusion Arrow\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IGRN", "::", "Usage"}], "=", 
  "\"\<IGRN is a header for an Intercellular GRN Reaction\>\""}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.488911071477083*^9, {3.546643385166605*^9, 3.546643400935603*^9}, {
   3.54664550002141*^9, 3.546645503604074*^9}, {3.5466978526703176`*^9, 
   3.5466978631852016`*^9}, {3.5467018228128*^9, 3.546701826828426*^9}, {
   3.547668735591831*^9, 3.547668880810328*^9}, {3.547730284087472*^9, 
   3.547730289975049*^9}, {3.548254604188097*^9, 3.548254610946848*^9}, {
   3.54825496159667*^9, 3.5482549716123333`*^9}, {3.5567966521297007`*^9, 
   3.5567968288886747`*^9}, {3.5567973158785152`*^9, 3.556797317485812*^9}, {
   3.556797594271989*^9, 3.5567976088215857`*^9}, {3.556798044065589*^9, 
   3.556798123015934*^9}, {3.556798155946563*^9, 3.556798290998331*^9}, {
   3.5567991804765577`*^9, 3.556799190878804*^9}, {3.5567993975774612`*^9, 
   3.556799451215362*^9}, {3.5570003697453747`*^9, 3.557000425788169*^9}, {
   3.5570013331636257`*^9, 3.5570013979131107`*^9}, {3.575393540886526*^9, 
   3.575393549243833*^9}, {3.575395684863953*^9, 3.575395689786623*^9}, {
   3.575395924242647*^9, 3.5753959618965816`*^9}, {3.575570566889583*^9, 
   3.575570583995207*^9}},ExpressionUUID->"f152c873-43c1-4cb3-adec-\
d1b863dab78e"]
}, Closed]],

Cell[CellGroupData[{

Cell["templates", "Subsubsection",
 CellChangeTimes->{{3.454166568668249*^9, 
  3.454166570545089*^9}},ExpressionUUID->"ad680f60-cc02-483f-93b5-\
6c00cc7ee682"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TemplateHoneycombCover", "::", "usage"}], "=", 
   "\"\<TemplateHoneycombCover[xmax,ymax]\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TemplateRectangular", "::", "usage"}], "=", 
    "\"\<TemplateRectangular[nx,ny]\\nTemplateRectangular[{xmin,xmax,dx}, \
{ymin,ymax,dy}]\>\""}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TemplateRectangularCover", "::", "usage"}], "=", 
   "\"\<TemplateRectangularCover[xmax, ymax, dx, dy, offset:.5]\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TemplateCircularHoneycomb", "::", "usage"}], "=", 
    "\"\<TemplateCircularHoneycomb[n,area]\\nwhere n is the number layers and \
area is the desired area of each cell.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TemplateCircularHoneycombCover", "::", "usage"}], "=", 
    "\"\<TemplateCircularHoneycombCover[radius, mode]\\nmode=-1: \
circle\\nmode=0: semiscircle\\nmode=n>0: semicircle atop base of n \
rows.\>\""}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RandomizeTemplate", "::", "usage"}], "=", 
   "\"\<RandomizeTemplate[tissue, rand:.1]\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TemplateRandom", "::", "usage"}], "=", 
   "\"\<TemplateRandom[npoints, {{x1,y1}, {x2,y2},..} (boundary)] generates a \
template of totally random cells that fall within the specified boundary \
(uses a Voronoi based model).\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TemplatePolygon", "::", "usage"}], "=", 
   "\"\<TemplatePolygon[...] returns a single-cell tissue in the shape of a \
polygon. Arguments are idential to regularPolygon.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TemplateRing", "::", "usage"}], "=", 
   "\"\<TemplateRing[number-of-cells, outer-Radius, Area-Per-Cell]\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TemplateRandomCircularGrid", "::", "usage"}], "=", 
    "\"\<TemplateRandomCircularGrid[numberOfCells, radius]\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TemplateRandomSemicircularGrid", "::", "usage"}], "=", 
    "\"\<TemplateRandomSemicircularGrid[n, radius, nbottom]\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TemplateRandomSquareGrid", "::", "usage"}], "=", 
    "\"\<TemplateRandom[npoints, {xmin, ymin}, {xmax, ymax}]\\n generates a \
random template in the specified box with the cell centers on a randomized \
hexagonal grid (uses a Voronoi based model).\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TemplateRandomOvalish", "::", "usage"}], "=", 
   "\"\<TemplateRandomOvalish[n, {a, b}]\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"VoronoiToTissue", "::", "usage"}], "=", 
    "\"\<VoronoiToTissue[points, boundary]\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CellVerticesToTissue", "::", "usage"}], "=", 
    "\"\<CellVerticesToTissue[{cell1, cell2, ...}] where celli={{x,y}, \
{x,y},...}\>\""}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TemplateParabolic", "::", "usage"}], "=", 
   "\"\<TemplateParabolic[height, rows, randomization:0] returns a template \
constrained to a parabolic dome with width equal to twice the height and \
`rows` rows of cells arranged in concentric parabolas, offset by one \
diameter. In the present version the aspect ratio of teh parabola is fixed.\>\
\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.450732300270131*^9, 3.45073232106188*^9}, {
   3.4508011546846027`*^9, 3.450801184705406*^9}, {3.451055322317774*^9, 
   3.45105537549975*^9}, 3.451066958566024*^9, {3.4517671427610273`*^9, 
   3.4517672135716352`*^9}, {3.451842767687619*^9, 3.451842776643633*^9}, {
   3.45184283926434*^9, 3.451842841363598*^9}, {3.4518467576163607`*^9, 
   3.451846766539654*^9}, {3.451849496352442*^9, 3.451849502238495*^9}, {
   3.451849553822835*^9, 3.451849676288872*^9}, {3.4518503134673634`*^9, 
   3.451850314653874*^9}, {3.451853978288218*^9, 3.4518539829548817`*^9}, {
   3.4518575294274054`*^9, 3.4518575691133957`*^9}, {3.455291762353786*^9, 
   3.455291767861758*^9}, {3.4552964062671843`*^9, 3.4552964294422092`*^9}, {
   3.455314361982946*^9, 3.455314376386162*^9}, {3.456861571027389*^9, 
   3.456861574212*^9}, {3.470524373684963*^9, 3.470524400873867*^9}, {
   3.489528246112968*^9, 3.489528279822442*^9}, {3.512215808164225*^9, 
   3.512215861315892*^9}, {3.512215893214617*^9, 3.512215895334422*^9}, 
   3.5122161297365713`*^9, {3.5348517517271557`*^9, 3.534851762526582*^9}, {
   3.534854901323155*^9, 3.534854924922751*^9}, {3.545839294755673*^9, 
   3.545839349750536*^9}, {3.572223168702404*^9, 3.5722231982699966`*^9}, 
   3.57222334065617*^9, {3.572463257005888*^9, 3.572463267692802*^9}, {
   3.572463312740636*^9, 3.5724633925279922`*^9}, {3.5724634286522617`*^9, 
   3.5724634434719973`*^9}, {3.705710938947269*^9, 
   3.705710954413871*^9}},ExpressionUUID->"0cf1c740-6d37-4f14-b9d9-\
2062ff7d5fa9"]
}, Closed]],

Cell[CellGroupData[{

Cell["plotting", "Subsubsection",
 CellChangeTimes->{{3.454166583135771*^9, 3.454166583994173*^9}, {
  3.459269528796967*^9, 
  3.4592695305207787`*^9}},ExpressionUUID->"a6ce5bb6-2f60-4a53-b325-\
112936f453fa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"MultiPlot", "::", "usage"}], "=", 
     "\"\<MultiPlot[solution, {variables, ...}, {t, tstart, tend}, options]\>\
\""}], ";", " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RowPlot", "::", "usage"}], "=", 
     "\"\<RowPlot[solution, {variables, ...}, {t, tstart, tend}, \
options]\>\""}], ";"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"SolutionVariables", "::", "usage"}], "=", 
     "\"\<SolutionVariables[sim]\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SolutionVars", "::", "usage"}], "=", 
     "\"\<SoltionVars[sim]\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"GeometricSnapShot", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
   " "}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.448727826680936*^9, 3.44872783006674*^9}, {
  3.448728320183986*^9, 3.448728327777943*^9}, {3.449001229062161*^9, 
  3.449001246472637*^9}, {3.449058293592927*^9, 3.4490582981373*^9}, {
  3.449058662886573*^9, 3.449058690519176*^9}, {3.455125081317162*^9, 
  3.4551250880358953`*^9}, {3.461166586748909*^9, 
  3.461166611310622*^9}},ExpressionUUID->"f576295d-a6e7-434f-9150-\
273b6a7647ae"]
}, Closed]],

Cell[CellGroupData[{

Cell["Tissue construction", "Subsubsection",
 CellChangeTimes->{{3.4541665988795557`*^9, 
  3.454166603886265*^9}},ExpressionUUID->"f6fcc6a4-5b59-4f8f-90cf-\
47b1d8c65b27"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SmootheCell", "::", "usage"}], "=", 
    "\"\<SmootheCell[tissue, cellNumber]\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SmootheCells", "::", "usage"}], "=", 
   "\"\<SmootheCells[tissue, {cellNum, cellNum, ...}]\\nSmoothCells[tissue] \
for all cells on boundary\>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4517766257193747`*^9, 3.4517766599301233`*^9}, {
  3.451776710157179*^9, 
  3.451776722660808*^9}},ExpressionUUID->"9a4ab341-91f5-4f7c-9c41-\
e82b37132e08"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Tissue", "::", "usage"}], "=", 
    "\"\<Tissue[vertices, edges, faces]\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Tissue3D", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FlatTissue", "::", "usage"}], "=", 
    "\"\<Tissue[vertices,faces]\>\""}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tissue2FlatTissue", "::", "usage"}], "=", 
   "\"\<Tissue2FlatTissue[FlatTissue]\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FlatTissue2Tissue", "::", "usage"}], "=", 
    "\"\<FlatTissue2Tissue[Tissue]\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TissueQ", "::", "usage"}], "=", "\"\<TissueQ[Tissue[...]]\>\""}],
    ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DTissue", "::", "usage"}], "=", 
   "\"\<DTissue[vertices, edges, {n1->face1,n2->face2,...}]\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DTissueQ", "::", "usage"}], "=", 
    "\"\<DTissueQ[DTissue[...]]\>\""}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ISTissue", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tissue2DTissue", "::", "usage"}], "=", 
   "\"\<Tissue2DTissue[tissue]\\noption: \\\"Numbers\\\"\[Rule]list of \
numbers\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DTissue2Tissue", "::", "usage"}], "=", 
    "\"\<DTissue2Tissue[tissue]\\nDTissue2Tissue[dtissue, sim, time]\>\""}], 
   ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TissueCheck", "::", "usage"}], "=", "\"\<TissueCheck\>\""}], 
   ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MidPoint", "::", "usage"}], "=", 
    "\"\<MidPoint[p1,p2]\\nMidPoint[{p1,p2}]\\nMidPoint[{p1,p2,...}, i] - \
find midpoints of edge i (0 means all)\\nMidPoint[{p1,p2,...}] - find \
midpoints of all edges\\nMidPoint[Tissue[..]] - find midpoints of all edges \
in all cells\\nMidPoint[Tissue,cellNumber] - find midpoints of all edges in \
given cell\\nMidPoint[Tissue,cellNumber, edgeNumber] - midpoint of given edge \
in given cell.\>\""}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BoundaryCell", "::", "usage"}], "=", 
    "\"\<BoundaryCell[Tissue] returns information about a fictitious cell \
compoese whose vertices are the boundary of the entire tissue. Returned as an \
option list {\\\"Coordinates\\\"->{{x,y,z},{x,y,z},...}, \
\\\"Edges\\\"->{i,j,k,...}, \\\"Vertices\\\"->{i,j,k,...}}\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SharedWall", "::", "usage"}], "=", 
   "\"\<SharedWall[Tissue,p,q] returns a list {\\\"Edges\\\"->{i,j,..}, \
\\\"Vertices\\\"-> {i,j,..}, \\\"Coordinates\\\"-> \
{{x,y,z},{x,y,z},...}\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AdjacentVertices", "::", "usage"}], "=", 
   "\"\<AdjacentVertices[g,i] returns a list of the vertices that are \
adjacent to vertex i in g\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AdjacentBoundaryVertices", "::", "usage"}], "=", 
    "\"\<AdjacentBoundaryVertices[g,i] returns a list of vertices that are \
adjacent to vertex i in g and lie on the boundary. If no vertices lie on the \
boundary then a null list is returned.\>\""}], ";"}], 
  "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VerticesOnBottom", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"VerticesOnTop", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"VerticesOnRight", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"VerticesOnLeft", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CellsOnLeft", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CellsOnRight", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CellsOnTop", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CellsOnBottom", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EdgesOnTop", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EdgesOnLeft", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EdgesOnRight", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EdgesOnBottom", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IntersectingEdges", "::", "usage"}], "=", 
    "\"\<IntersectingEdges[(D)Tissue,edgenumber]\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"L1Cells", "::", "usage"}], "=", 
   "\"\<L1Cells[Tissue, options]; \\\"Bottom\\\"->Value will exclude cells \
with centroid y values smaller than specificed. use \\\"Bottom\\\"->Default \
to exclude cells beneath y = 1 mean cell diameter, \\\"Bottom\\\"->Infinity \
to use all Boundary cells.\\n \\\"MinimumRadius\\\"->0,in case of central \
hole \>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"L2Cells", "::", "usage"}], "=", 
    "\"\<L2Cells[Tissue, options]\>\""}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ConnectionList", "::", "usage"}], "=", 
   "\"\<ConnectionList[tissue]\\nOptions:\\n\\\"UpperTriangular\\\"\[Rule]\
False, include both {i,j} and {j,i}; if True, only the one with i<j will be \
included\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConnectionMatrix", "::", "usage"}], "=", 
    "\"\<ConnectionMatrix[tissue] returns a SparseArray[..] object\\nOptions \
are the same as ConnectionList\>\""}], ";"}], "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EdgeLengths", "::", "usage"}], "=", 
    "\"\<EdgeLengths[tissue] returns a list of the lengths of all the edges \
in the tissue\>\""}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CellEdgeLengths", "::", "usage"}], "=", 
   "\"\<CellEdgeLengths[tissue, cellNumber]\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EdgeLength", "::", "usage"}], "=", 
    "\"\<EdgeLength[tissue, Edge Number]\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EdgeVertices", "::", "usage"}], "=", 
    "\"\<EdgeVertices[edge, list-of-vertices] - where edge = {i,j} is pair of \
vertex indices and list-of-vertices is a list of coordinate pairs.  Returns \
{{x1,y1}, {x2,y2}} for the two endpoints of the edge. \
\\nEdgeVertices[list-of-edges, list-of-vertices] - where list-of-vertices is \
a list of {i,j} pairs. Returns a list of vertex pairs.\\nEdgeVertices[tissue] \
- returns {{x1,y1}, {x2, y2}} for all edges in tissue. \>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CellVertexNumbers", "::", "usage"}], "=", 
    "\"\<CellVertexNumbers[cell, \
list-of-cells]\\nCellVertexNumbers[list-of-cells, \
list-of-vertices]\\nCellVertexNumbers[Tissue]\\nCellVertexNumbers[Tissue, \
cellNumber]\>\""}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SortCellsCounterClockwise", "::", "usage"}], "=", 
   "\"\<SortCellClockwise[tissue] returns a list {s1,s2,...} where each si is \
a rule list {\\\"Edges\\\"-> {e1,e2, ...}, \\\"Vertices\\\"->{v1,v2,...}} \
where e1,e2,... are edge numbers of si, and v1,v2,... are the vertex numbers \
of cell i, arranged counter-clockwise.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SortCellEdges", "::", "usage"}], "=", 
    "\"\<SortCellEdges[cell, edges] returns a rule list {\\\"Edges\\\"-> \
{e1,e2, ...}, \\\"Vertices\\\"->{v1,v2,...}} where e1,e2,... are edge numbers \
of cell, and v1,v2,... are the vertex numbers of cell. Here cell is the list \
of edges numbers, and edges is the list of edge vertex pairs, as given in the \
tissue object.\>\""}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CellVertexCoordinates", "::", "usage"}], "=", "\"\<\>\""}], 
   ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CellsOnBoundary", "::", "usage"}], "=", 
    "\"\<CellsOnBoundary[tissue]\>\""}], ";"}], " "}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InteriorCells", "::", "usage"}], "=", 
    "\"\<InteriorCells[tissue]\>\""}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"VerticesOnBoundary", "::", "usage"}], "=", 
    "\"\<VerticesOnBoundary[tissue]  returns a list of the indices of the \
vertices that are on the outer edge of the tissue.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"VerticesNotOnBoundary", "::", "usage"}], "=", 
    "\"\<VerticesNotOnBoundary[tissue] returns a list of the indices of the \
vertices that are not on the out edge of the tissuue.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EdgesOnBoundary", "::", "usage"}], "=", 
    "\"\<EdgesOnBoundary[tissue] returns a list of the indices of the edges \
that are on the outer edges of the tissue.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EdgesNotOnBoundary", "::", "usage"}], "=", 
   "\"\<EdgesNotOnBoundary[tissue] returns a list of the indices of the edges \
that are not on the outer boundary of the tissue.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DivideEdge", "::", "usage"}], "=", 
    "\"\<DivideEdge[tissue, edgeNumber, number of segments, \
randomness]\>\""}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DivideEdges", "::", "usage"}], "=", 
    "\"\<DivideEdge[tissue, number of segments, randomness] or \
\\nDivideEdge[tissue, {n1,n2,...}, number of segments, randomness]\>\""}], 
   ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MergeEdges", "::", "usage"}], "=", 
    "\"\<MergeEdges[tissue, edge1, edge2] returns a new tissue object with \
the specified edges merged together; the two edges must share a common \
vertex. \\nOptions:\\n\\\"Undangle\\\"\[Rule]True - if True, dangling edges \
and vertices will be removed after the merge; if False, they will not be \
removed.\>\""}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NeighborQ", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MergeCells", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MergeVertices", "::", "usage"}], "=", 
    "\"\<MergeVertices[tissue, {v1,v2}] returns a tissue with the edge \
between {v1,v2} removed; or an error if there is no such \
edge.\\nMergeVertices[tissue, n] returns a tissue with the nth redge removed. \
\\nOptions:\\n\\\"Changes\\\"->False; if True, a list {changes, newtissue} is \
returned. the list changes indicates edge number changes, oldNumber -> \
newNumber, with {} for a removed number.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DivideCell", "::", "usage"}], "=", 
    "\"\<DivideCell[tissue, cellNumber, {{x1,y1}, {x2,y2}}] returns a tissue \
with the specified cells replaced by two daughter cells; the cell is divided \
along a single line segment determined by that part of the line through \
{x1,y1} and {x2,y2} that is not exterior to the cell.\\nIf the option \
\\\"Changes\\\"\[Rule]True is used, instead of returning a tissue object, a \
list {changes, tissue} is returned, where changes is a list of rules giving \
the edge number changes, e.g., 3->{3,17} means edge 3 becomes edges 3 and 17 \
and {}-> 42 means the new edge is number 42.\>\""}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DanglingEdges", "::", "usage"}], "=", 
    "\"\<DanglingEdges[tissue]\>\""}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DanglingVertices", "::", "usage"}], "=", 
    "\"\<DanglingVertices[tissue]\>\""}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UndangleEdge", "::", "usage"}], "=", 
    "\"\<UndangleEdge[tissue, edgeNumber]\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RemoveEdge", "::", "usage"}], "=", 
    "\"\<RemoveEdge[tissue, edgeNumber]\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RemoveEdges", "::", "usage"}], "=", 
    "\"\<RemoveEdges[tissue, list-of-edge-Numbers]\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UndangleEdges", "::", "usage"}], "=", 
    "\"\<UndangleEdges[tissue]\>\""}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UndangleVertex", "::", "usage"}], "=", 
    "\"\<UndangleVertex[tissue, vertexNumber]\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RemoveVertex", "::", "usage"}], "=", 
    "\"\<RemoveVertex[tissue, vertexNumber]\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RemoveVertices", "::", "usage"}], "=", 
    "\"\<RemoveVertices[tissue, list-of-vertex-numbers]\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UndangleVertices", "::", "usage"}], "=", 
    "\"\<UndangleVertices[tissue]\>\""}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RemoveShortEdges", "::", "usage"}], "=", 
    "\"\<RemoveShortEdges[tissue, threshold], threshold is fraction of length \
of average edge.\>\""}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InLineVertices", "::", "usage"}], "=", 
    "\"\<InLineVertices[tissue] returns a list of the vertices that fall are \
shared by precisely two edges which are co-linear and fall between those two \
vertices (and hence the middle vertex could presumably be removed). The \
return value is a list of the form {{v, {e1,e2}}, {v, {e1,e2}}, ...} where v \
is the vertex number and e1, e2 are the numbers of the two shared edges. \
\\n\\nOptions\\n\\\"Vertices\\\"\[Rule]{n1,n2,...} subset of list of vertex \
numbers to check (rather than checking all vertices).\>\""}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TissueCells", "::", "usage"}], "=", 
   "\"\<TissueCells[tissue] returns a list of the cells in a tissue object. \
Each cell is a list of edge numbers.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TissueEdges", "::", "usage"}], "=", 
    "\"\<TissueEdges[tissue] returns a list of the edges in a tissue object; \
each edge is a pair of vertex numbers.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TissueVertices", "::", "usage"}], "=", 
    "\"\<TissueVertices[tissue] returns a list of the vertices in a tissue. \
Each vertex is a coordinate pair {x,y}.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NTissueCells", "::", "usage"}], "=", 
   "\"\<NTissueCells[tissue] returns the number of cells in a tissue.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NTissueEdges", "::", "usage"}], "=", 
    "\"\<NTissueEdges[tissue] returns the number of edges in a tissue.\>\""}],
    ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NTissueVertices", "::", "usage"}], "=", 
    "\"\<NTissueVertices[tissue] returns the number of vertices in a \
tissue.\>\""}], ";"}], " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"DynamicalEquations", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"SpringEquations", "::", "usage"}], "=", "\"\<\>\""}], ";", " ", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"PressureEquations", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DeleteCell", "::", "usage"}], "=", 
    "\"\<DeleteCell[dtissue,number]\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RemoveCell", "::", "usage"}], "=", 
   "\"\<RemoveCell[tissue, cellNumber]\\nremoveCell[tissue,{cell1,cell2,...}]\
\\nremoves a specififed cell (or list of cells) and removes any remaining \
dangling edges and vertices\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AddVertex", "::", "usage"}], "=", 
    "\"\<AddVertex[tissue, {x,y}]\>\""}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AddEdge", "::", "usage"}], "=", 
    "\"\<AddEdge[tissue, {i,j}]\>\""}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AddCell", "::", "usage"}], "=", 
    "\"\<AddCell[tissue, {i1,i2,i3,...}]\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EdgesUsed", "::", "usage"}], "=", "\"\<EdgesUsed[tissue]\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"VerticesUsed", "::", "usage"}], "=", 
    "\"\<VerticesUsed[tissue]\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CellEdgePairs", "::", "usage"}], "=", 
   "\"\<CellWallPairs[tissue] returns a list {{cell, edge}, {cell, edge}, \
...} of pairs of cells of and walls.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CellNeighbors", "::", "usage"}], "=", 
    "\"\<CellNeighbors[tissue, n] returns a list of neighbors of cell n in \
tissue\\ncellNeighbors[tissue] returns a list of list of all neighbors of all \
cells.\>\""}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"VertexNeighbors", "::", "usage"}], "=", 
    "\"\<VertexNeighbors[tissue,n]\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TissueOrTorusQ", "::", "usage"}], "=", 
    "\"\<True if either a tissue or torus; otherwise, False.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EdgeBetween", "::", "usage"}], "=", 
   "\"\<EdgeBetween[tissue, i, j] returns the integer number of the edge \
between cell i and cell j, or {} if they are not neighbors.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EdgesBetween", "::", "usage"}], "=", 
    "\"\<EdgesBetween[tissue] returns a sparse array that gives the number of \
edge between two cells, if they are neighbors, and a zero otherwise.\>\""}], 
   ";"}], "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PartitionPolygon", "::", "usage"}], "=", 
   "\"\<PartitionPolygon[{point1,point2,...}, n] returns a list of points \
that represents the polygon partitioning into n edges.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RadialPolygon", "::", "usage"}], "=", 
   "\"\<RadialPolygon[Points,n] returns an interpolating function f[theta] \
that gives the distance from the polygon centroid to its perimeter as a \
function of central angle.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AngularPerimeterFunction", "::", "usage"}], "=", 
   "\"\<AngularPerimeterFunction[points,n] returns a function f[theta] that \
gives the distance meastured along the perimeter between 0 and theta, where 0 \
\[LessEqual] theta \[LessEqual] 2\[Pi].\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EquiperimeterPoints", "::", "usage"}], "=", 
   "\"\<EquiperimeterPoints[points, n] returns a list of n points equally \
spaced in distance along the perimeter of the cell defined by the list of \
points.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RotateTissue", "::", "usage"}], "=", 
   "\"\<RotateTissue[Tissue, angle in degrees]\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ReflectTissue", "::", "usage"}], "=", 
    "\"\<ReflectTissueX[Tissue, axis]\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TranslateTissue", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TranslateToOrigin", "::", "usage"}], "=", 
   "\"\<TranslateToOrigin[Tissue]\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Polygonalize", "::", "usage"}], "=", 
   "\"\<Polygonalize[Tissue, threshold:.5]\>\""}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.448464145636045*^9, 3.448464217272934*^9}, {
   3.448464604516963*^9, 3.448464637070943*^9}, {3.448464756359129*^9, 
   3.448464764717423*^9}, {3.448470793205986*^9, 3.448470859350535*^9}, {
   3.448472175000557*^9, 3.448472187484626*^9}, {3.448472431483161*^9, 
   3.448472435663145*^9}, {3.448474064053416*^9, 3.44847408164547*^9}, {
   3.448474189309593*^9, 3.4484741955955*^9}, {3.448474556151385*^9, 
   3.448474602595858*^9}, {3.448486494822903*^9, 3.448486498803606*^9}, {
   3.448495627213998*^9, 3.448495642149518*^9}, {3.448536597487708*^9, 
   3.448536603017118*^9}, {3.448545107296982*^9, 3.448545112734589*^9}, {
   3.448546903158277*^9, 3.448547079609514*^9}, {3.448547980586907*^9, 
   3.448548000502067*^9}, {3.448641758247852*^9, 3.448641764756068*^9}, {
   3.448653800184428*^9, 3.448653924095302*^9}, {3.448654075542287*^9, 
   3.448654080632995*^9}, {3.448705298819261*^9, 3.448705350355893*^9}, {
   3.448705411688918*^9, 3.448705417531166*^9}, {3.448705504233979*^9, 
   3.448705545565276*^9}, {3.449080354295869*^9, 3.449080358457573*^9}, {
   3.449083282227328*^9, 3.449083287981495*^9}, {3.449083893523583*^9, 
   3.44908389868219*^9}, {3.449154374028528*^9, 3.449154379946668*^9}, {
   3.449155270841575*^9, 3.449155276056946*^9}, {3.449156032108363*^9, 
   3.449156087274967*^9}, {3.45080196968324*^9, 3.4508019745551033`*^9}, {
   3.450802213143478*^9, 3.4508022518981543`*^9}, {3.450802599406603*^9, 
   3.450802661358581*^9}, {3.450804294879689*^9, 3.450804315404758*^9}, {
   3.450804380245575*^9, 3.450804381727243*^9}, {3.4510512151563177`*^9, 
   3.451051257011841*^9}, {3.451051536331416*^9, 3.4510515589033003`*^9}, {
   3.4510551325017843`*^9, 3.45105517122255*^9}, {3.4510555257004747`*^9, 
   3.451055537409546*^9}, {3.451066947531741*^9, 3.4510669490349283`*^9}, {
   3.452328594757024*^9, 3.452328623277547*^9}, {3.452329478876532*^9, 
   3.4523295419544487`*^9}, {3.4523301873253193`*^9, 
   3.4523302319659986`*^9}, {3.4523302952491713`*^9, 3.452330317253915*^9}, {
   3.454071048301997*^9, 3.454071064660124*^9}, {3.4549615979022493`*^9, 
   3.454961600770095*^9}, {3.45506480442065*^9, 3.455064833469474*^9}, {
   3.455312014399075*^9, 3.4553120233466997`*^9}, {3.456688874632146*^9, 
   3.456688880797773*^9}, {3.4566913454652452`*^9, 3.4566914219365587`*^9}, {
   3.4566920350129433`*^9, 3.456692077439242*^9}, {3.456692372944593*^9, 
   3.456692454424115*^9}, {3.456692792074902*^9, 3.456692796426896*^9}, 
   3.456692893386052*^9, {3.4566954156505632`*^9, 3.4566954611502953`*^9}, {
   3.456698624969925*^9, 3.456698678626277*^9}, {3.456752438312689*^9, 
   3.4567524477859993`*^9}, {3.4567720744965773`*^9, 3.45677218321159*^9}, {
   3.459266460610113*^9, 3.4592664834182568`*^9}, {3.4592667181208467`*^9, 
   3.459266723338256*^9}, {3.4592668513429623`*^9, 3.4592668608854733`*^9}, {
   3.459267784347021*^9, 3.459267820878237*^9}, {3.459268247293707*^9, 
   3.459268253066264*^9}, {3.4592695389110928`*^9, 3.4592695422635612`*^9}, {
   3.459270261715173*^9, 3.4592704036997633`*^9}, {3.459276327936934*^9, 
   3.459276332223013*^9}, {3.459277035034453*^9, 3.4592770918216457`*^9}, {
   3.4887993018683453`*^9, 3.488799313601468*^9}, {3.488906033701745*^9, 
   3.4889061615406647`*^9}, 3.489069908251555*^9, {3.489069965194105*^9, 
   3.489069987346931*^9}, 3.489070034878499*^9, {3.489071619742093*^9, 
   3.489071620495517*^9}, {3.48907209457423*^9, 3.489072215455573*^9}, {
   3.489172900389628*^9, 3.489172906606113*^9}, {3.4891844773796577`*^9, 
   3.489184570604217*^9}, {3.48950178352468*^9, 3.489501821397011*^9}, {
   3.489594239078939*^9, 3.489594268066516*^9}, {3.4895993579650383`*^9, 
   3.4895993626684027`*^9}, {3.489599528848578*^9, 3.489599537307222*^9}, {
   3.4949311932750893`*^9, 3.49493120077746*^9}, {3.494931541270961*^9, 
   3.4949316117345753`*^9}, {3.494931774407729*^9, 3.494931804869687*^9}, 
   3.494932040192266*^9, {3.494955290962175*^9, 3.494955337660133*^9}, {
   3.511716499608047*^9, 3.511716546711731*^9}, {3.5447345481705647`*^9, 
   3.54473460918464*^9}, {3.546082528649234*^9, 3.5460825478115387`*^9}, {
   3.546083080717965*^9, 3.546083108976639*^9}, {3.546083145513482*^9, 
   3.546083165229075*^9}, {3.546083392182684*^9, 3.546083407406156*^9}, {
   3.546085890458314*^9, 3.546085904766202*^9}, {3.546273335507889*^9, 
   3.546273378629167*^9}, {3.546273648006001*^9, 3.546273666986485*^9}, {
   3.546274940491284*^9, 3.546274979312125*^9}, {3.546882773281035*^9, 
   3.5468828063399467`*^9}, {3.546883483868752*^9, 3.546883497864002*^9}, {
   3.547045118697969*^9, 3.547045142190713*^9}, {3.547045505472933*^9, 
   3.547045509659093*^9}, {3.5476563749847116`*^9, 3.547656391624161*^9}, {
   3.5499162781527576`*^9, 3.549916325631947*^9}, {3.5499178419375553`*^9, 
   3.549917880354495*^9}, {3.54991796240519*^9, 3.5499179668123093`*^9}, {
   3.549918196978791*^9, 3.549918251813223*^9}, {3.558995149252818*^9, 
   3.558995153057889*^9}, {3.562598175334826*^9, 3.562598190292094*^9}, {
   3.562598646710444*^9, 3.5625986754255342`*^9}, {3.563032639557631*^9, 
   3.563032647730529*^9}, {3.564262106204722*^9, 3.564262131176469*^9}, {
   3.5642624468789177`*^9, 3.564262531496414*^9}, {3.564262561706843*^9, 
   3.564262575660076*^9}, {3.564266437254714*^9, 3.56426647196117*^9}, {
   3.564266548241768*^9, 3.5642665625422897`*^9}, {3.5643404861233473`*^9, 
   3.5643405398158073`*^9}, {3.564512613539383*^9, 3.5645126250007057`*^9}, {
   3.574977000433749*^9, 3.574977139118434*^9}, {3.575991205411175*^9, 
   3.5759912373143177`*^9}, {3.576255879015478*^9, 3.576255891664538*^9}, {
   3.576256063344741*^9, 3.57625608789176*^9}, {3.576260898300498*^9, 
   3.5762609026799603`*^9}, {3.5762612213578663`*^9, 3.576261225629717*^9}, {
   3.591293543073092*^9, 
   3.591293560787353*^9}},ExpressionUUID->"19798b20-1c8e-473c-b35a-\
2256aa30f525"]
}, Closed]],

Cell[CellGroupData[{

Cell["Periodic Boundary Condition Construction (exp't)", "Subsubsection",
 CellChangeTimes->{{3.4565808061504097`*^9, 
  3.456580821796414*^9}},ExpressionUUID->"474d0aca-36a6-442f-8f1c-\
ea8f086ab9fb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Rectangularize", "::", "usage"}], "=", 
   "\"\<Rectangularize[tissue, options]\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "Rectangularize", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<Corners\>\"", "\[Rule]", " ", "\"\<Automatic\>\""}], ",", 
     " ", 
     RowBox[{"\"\<Method\>\"", "\[Rule]", " ", "\"\<Perpendicular\>\""}], ",",
      " ", 
     RowBox[{"\"\<Quiet\>\"", "\[Rule]", " ", "False"}], ",", "  ", 
     RowBox[{"\"\<Debug\>\"", "\[Rule]", " ", "False"}], ",", " ", 
     RowBox[{"\"\<Randomness\>\"", "\[Rule]", " ", "0.25"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ToTorus", "::", "usage"}], "=", 
   "\"\<ToTorus[Tissue[..],..]\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ToTorus", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<Tolerance\>\"", "\[Rule]", " ", 
      RowBox[{"1.0", " ", 
       RowBox[{"10", "^", 
        RowBox[{"-", "5"}]}]}]}], ",", " ", 
     RowBox[{"\"\<Debug\>\"", "\[Rule]", " ", "False"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TorusQ", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TorusCheck", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Torus", "::", "usage"}], "=", 
   "\"\<Torus[.. TBD ..] is an uninstantiated function indicating a \
Tissue[..] object with Toroidal connectivity.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TorusTissue", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TorusRules", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
  " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4565808249766493`*^9, 3.4565808405834618`*^9}, {
  3.456581006780752*^9, 3.456581047061255*^9}, {3.4565811184366493`*^9, 
  3.456581121776074*^9}, {3.456581883981738*^9, 3.4565818853340054`*^9}, {
  3.456582337867876*^9, 3.456582342546258*^9}, {3.456699727848597*^9, 
  3.456699732866157*^9}, {3.4571152616079884`*^9, 3.457115284252623*^9}, {
  3.457118670188816*^9, 3.4571187135201063`*^9}, {3.4572751726473*^9, 
  3.457275187318453*^9}, {3.457276455453614*^9, 3.45727645699228*^9}, {
  3.4573551260899267`*^9, 3.457355158957024*^9}, {3.457361238188932*^9, 
  3.457361241476685*^9}, {3.457361415212558*^9, 3.457361419134678*^9}, {
  3.457387180751186*^9, 
  3.457387209659264*^9}},ExpressionUUID->"2a221bab-ecc6-4770-b401-\
379c29665611"]
}, Closed]],

Cell[CellGroupData[{

Cell["etc/unfiled", "Subsubsection",
 CellChangeTimes->{{3.454166626132855*^9, 
  3.454166651899753*^9}},ExpressionUUID->"c85b6ec5-ba9a-4f7e-a4d8-\
a1a452db733c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Help", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"$XLR8RLOAD", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"$XSSALOAD", "::", "usage"}], "=", "\"\<\>\""}], ";"}], " ", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"QuadraticFit", "::", "usage"}], "=", 
     "\"\<QuadraticFit[P0, P1, V0, V1, t]\>\""}], ";", " ", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"QuadraticFitCoefficients", "::", "usage"}], "=", 
     "\"\<QuadraticFitCoefficients[P0, P1, PC]\>\""}], ";"}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Boundary", "::", "usage"}], "=", 
    "\"\<Boundary[points, directives, options]\>\""}], ";"}], " ", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"DrawSpokes", "::", "usage"}], "=", 
     "\"\<DrawSpokes[outputOfDropSpokes]\>\""}], ";"}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"regularPolygon", "::", "usage"}], "=", 
    "\"\<regularPolygons[NumberOfSides, StartAngle:0, aspect:1, \
Randomness:-1, RotationAngle:0]\>\""}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RegularStar", "::", "usage"}], "=", 
   "\"\<RegularStar[NumberOfSides, Rbig/Rlittle:0, StartAngle:0, \
AspectRatio:1, Random:-1, RotationAngle:0] \>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Centeroid", "::", "usage"}], "=", 
    "\"\<Finds the Mean coordinates of a set of points. This function is used \
when Centroid fails because the Centroid Algorithm only works for \
Non-intersecting polygons.\>\""}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Centroid", "::", "usage"}], "=", 
    "\"\<Centroid[{v1,v2, ...}]\\nCentroid[tissue, n]\\nCentroid[tissue, \
{n1,n2,...}]\\nCentroid[tissue] - list of all centrois.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"areafunction", "::", "usage"}], "=", 
    "\"\<areafunction[{v1, v2, ...}] - area of polygon with specified \
vertices\\nareafunction[tissue,i] - area of cell i in \
tissue\\nareafunction[tissue] - list of all areas\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"perimeterLength", "::", "usage"}], "=", 
    "\"\<perimeterLength[{v1, v2, ...}]\\nperimeterLength[Tissue, CellNumber]\
\\nperimeterLength[Tissue]\>\""}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IsoPerimetricRatio", "::", "usage"}], "=", 
    "\"\<IsoPerimetricRatio[{point1,  \
point2,...)]\\nIsoPerimetricRatio[Tissue, \
CellNumber]\\nIsoPerimetricRatio[Tissue]\\nComputes \
Q=4\[Pi]A/\!\(\*SuperscriptBox[\(P\), \(2\)]\) for the polygon, cell, or all \
cells; where A is the area and P is the perimeter. It is normalized so that \
the isoperimetric ratio of a circle is 1.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InertiaMatrix", "::", "usage"}], "=", 
    "\"\<InertiaMatrix[{v1, v2, ...}]\>\""}], ";"}], 
  "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"distance", "::", "usage"}], "=", "\"\<distance[p1, p2]\>\""}], 
   ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"unitVector", "::", "usage"}], "=", 
    "\"\<unitVector[pointFrom, pointTo]\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Vector", "::", "usage"}], "=", "\"\<Vector[from,to]\>\""}], 
   ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PointQ", "::", "usage"}], "=", 
    "\"\<True if {x, y}; otherwise False\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NumericPointQ", "::", "usage"}], "=", 
    "\"\<True if {x,y} are numeric; else False\>\""}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Inside", "::", "usage"}], "=", 
    "\"\<Inside[{v1, v2, ...}, point]\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NormalVector", "::", "usage"}], "=", 
    "\"\<NormalVector[{v1,v2,...}, index]\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OutwardNormalVector", "::", "usage"}], "=", 
    "\"\<OutwardNormalVector[{v1,v2,..}, index]\\nindex=0 means return all \
outward normals in the cell\\nOutwardNormalVector[{v1,v2,..}] is equivalent \
to setting index=0\\nOutwardNormalVector[tissue] - all cells and all \
edges\\nOutwardNormalVector[tissue, cellnumber] all edges in given cel \
\\nOutwardNormalVector[tissue, cellnumber, edgenumber]\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CellOutwardVector", "::", "usage"}], "=", 
   "\"\<CellOutwardVector[Tissue, cellnumber, vertexnumber]\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"VertexOutwardVector", "::", "usage"}], "=", 
    "\"\<VertexOutwardVector[tissue,i,mean:T/F] Return an outward pointing \
mean-normal vector to a boundary vertex or a null vector if the vertex is not \
on the boundary. The mean is the average of the outward normals of the edges \
on either side of the vertex (when Mean=True). If Mean is False (the default) \
then a list of vectors is returned for each edge. \>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PrimaryAxes", "::", "usage"}], "=", 
    "\"\<PrimaryAxes[{v1, v2, ...}] or \\nPrimaryAxes[tissue,i] or \
\\nPrimaryAxes[tissue, {i1,i2,...}] or \\nPrimaryAxes[tissue]\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PrimaryAxesVectors", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FitEllipse", "::", "usage"}], "=", 
    "\"\<FitEllipse[{v1, v2, ...}]\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LineEdgeIntersection", "::", "usage"}], "=", 
    "\"\<LineEdgeIntersection[Edge, Point, Direction] where\\nEdge={point1, \
point2}\\nPoint={x,y}\\nDirection={vx, vy}\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DropPerpendicular", "::", "usage"}], "=", 
    "\"\<DropPerpendicular[Point, Edge, Slide:False]\\nIf Slide is True, and \
the perp. misses the edges, the result will be allowed to slide to the \
nearest endpoint; if Slide is false, the value $Failed is returned when the \
perpindiclar line misses the edge.\>\""}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PolygonIntersection", "::", "usage"}], "=", 
    "\"\<PolygonIntersection[{vx,vy}, {v1, v2, ...}] where {vx,vy} are the \
coordinates of a direction vector; and the line is assumed to pass through \
the centroid;  or \\nPolygonIntersection[{p1,p2}, {v1,v2,...}], where p1,p2 \
are two points that determine the line (p1\[NotEqual]p2)\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ShowTissueCells", "::", "usage"}], "=", 
    "\"\<ShowTissueCells[Tissue[..], {n1,n2,...}, color,opt] highlights \
specific cells.\\nShowTissueCells[Tissue[..],{n1,n2,..}] uses a default \
color.\>\""}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ShowTissue", "::", "usage"}], "=", 
    "\"\<ShowTisue[Tissue[..], options]\n\\\"CellStyle\\\" \[Rule] List of \
cell colors or Automatic or \\\"None\\\". If \\\"Nucleus\\\" is in the list \
the cells will be plotted as points rather than filled polygons. \
\\n\\\"BoundaryStyle\\\" \[Rule] Color, thickness of walls (automatic) or \
\\\"None\\\"\n\\\"CellNumbers\\\" \[Rule] True or False\n\\\"CellNumberStyles\
\\\" \[Rule] Text style directives for cell numbers\n\\\"Vertices\\ \[Rule] \
True or False\n\\\"VertexNumbers\\\" \[Rule] {} or style parameeters to print \
numbers\n\\\"EdgeNumbers\\\" \[Rule] True or False\n\\\"EdgeNumberStyle\\\"\
\[Rule]{} or styles for edge numbers\n\
\\\"EdgeCellPairs\\\"\[Rule]{{cellnumber,edgenumber, style}, {cellnumber, \
edgenumber, style}, ...}; the edge cellpair colors are slightly offset to the \
interior of the cell from the edge to indicate a different color on each side \
of the edge. Use EdgeStyles for the central wall. \n\
\\\"EdgeStyles\\\"\[Rule]{style,style,...}, one for each edge - used for cell \
edges. If both EdgeStyles and EdgeCellPairs are used a French-Flag type edge \
with 3 stripes will appear.\n\\\"All\\\"\[Rule]False, if True, will print any \
dangling edges or vertices that are not part of cells. Normally Dangling \
edges are not printed.\\n\\\"Outer\\\"\[Rule]Style for outer edge of tissue \
(default is \\\"None\\\" which defaults to \\\"BoundaryStyle\\\")\n\\\"Dome\\\
\"\[Rule]False, if True, plots on a parabolid dome, and optiosn to \
ParaboloidPlot also apply\n\\\"xrange\\\"\[Rule]All (default) or {xmin,xmax}, \
\\\"yrange\\\"\[Rule]All (default) or {ymin,ymax} will clip the plotting of \
cells, vertices and edges (but not the tissue boundary)\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ShowTissueFunction", "::", "usage"}], "=", 
    "\"\<ShowTissueFunction[tissue, f, {fmin, fmax}, {colormin, colormax}, \
options]\\nf[x,y] gives a function that depends on cell centroid \
location.\>\""}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ShowEdgeNormal", "::", "usage"}], "=", 
    "\"\<ShowEdgeNormal[{p1,p2}, style:{}, edge:False]\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ShowOutwardNormals", "::", "usage"}], "=", 
   "\"\<ShowOutwardNormals[{p1,p2,...}, style:{}, edge:False]\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PointOnLineSegment", "::", "usage"}], "=", 
    "\"\<PointOnLineSegment[{{x1,y1}, {x2,y2}}, {x,y}, Tolerance]\\nReturns \
True if {x,y} falls on the line segment from {x1,y1} to {x2, y2} and False \
otherwise, to within a specified tolerance. If not specified the default \
tolerance is \!\(\*SuperscriptBox[\(10\), \(-10\)]\).\>\""}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EntangledVertices", "::", "usage"}], "=", 
   "\"\<EntangledVertices[tissue] returns a list of lists of vertex numbers \
that fall on each edge that are not endpoints .. and hence should be resolved \
because this is a poorly defined tissue.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DisentangleVertices", "::", "usage"}], "=", 
    "\"\<DisentangleVertices[tissue] returns a tissue with all the entangled \
vertices fixed.\>\""}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RGBInterpolate", "::", "usage"}], "=", 
    "\"\<RGBInterpolate[value, {vmin, vmax}, {rgbfrom, rgbto}]\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HueInterpolate", "::", "usage"}], "=", 
   "\"\<HueInterpolate[value, {vmin, vmax}, {huefrom, hueto}]\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ColorBlendRectangle", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ShowTissueBoundary", "::", "usage"}], "=", 
    "\"\<ShowTissueBoundary[tissue, style directives]\>\""}], ";"}], 
  " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.446837733080073*^9, 3.446837738251648*^9}, {
   3.446837810779008*^9, 3.44683781463636*^9}, {3.446837881594413*^9, 
   3.446837905472398*^9}, {3.446838735907164*^9, 3.446838856899154*^9}, {
   3.446838938270261*^9, 3.446838964841762*^9}, {3.446839059123119*^9, 
   3.446839065898655*^9}, {3.446839133164037*^9, 3.446839136269532*^9}, {
   3.446839290527261*^9, 3.446839296024756*^9}, {3.446839442779112*^9, 
   3.446839458052958*^9}, {3.446839619852873*^9, 3.446839620786905*^9}, {
   3.44683984141603*^9, 3.446839843197753*^9}, {3.44684011648302*^9, 
   3.446840119497341*^9}, {3.446840230672402*^9, 3.446840289467161*^9}, {
   3.446840447165929*^9, 3.446840448261004*^9}, {3.446840564172064*^9, 
   3.446840579156464*^9}, {3.4468411251202*^9, 3.446841144989822*^9}, {
   3.44684128683203*^9, 3.446841321662353*^9}, {3.446841397047544*^9, 
   3.446841400897502*^9}, {3.446841942663744*^9, 3.446841948696372*^9}, {
   3.446842159530226*^9, 3.446842198319298*^9}, {3.446842255385829*^9, 
   3.446842404447237*^9}, {3.446842679936314*^9, 3.446842705398091*^9}, {
   3.446844146856861*^9, 3.446844266792324*^9}, {3.446844379951294*^9, 
   3.446844438847008*^9}, {3.446851982124828*^9, 3.446851990253768*^9}, 
   3.446852035620281*^9, {3.446852102802384*^9, 3.446852120164339*^9}, {
   3.44685215278962*^9, 3.446852179509541*^9}, {3.446855037065769*^9, 
   3.446855054018484*^9}, {3.446856960875628*^9, 3.446856964928537*^9}, {
   3.447187586168488*^9, 3.447187591276648*^9}, {3.447197951005801*^9, 
   3.447197999356068*^9}, {3.447246502091996*^9, 3.447246522844889*^9}, {
   3.447356343543337*^9, 3.447356348540082*^9}, {3.447356804817805*^9, 
   3.447356811642076*^9}, {3.447356861985972*^9, 3.447356886513246*^9}, {
   3.4473736237004*^9, 3.447373629203972*^9}, {3.447377985767619*^9, 
   3.447378094257919*^9}, {3.447378146973564*^9, 3.447378307639678*^9}, {
   3.447378389460446*^9, 3.447378434708511*^9}, {3.447513458885289*^9, 
   3.447513493203851*^9}, 3.448464212076745*^9, {3.448464658844572*^9, 
   3.448464659402558*^9}, {3.44847544020035*^9, 3.448475443544999*^9}, {
   3.44848224122098*^9, 3.448482257809076*^9}, {3.448484152631272*^9, 
   3.448484156761338*^9}, {3.448536714967187*^9, 3.448536769054344*^9}, {
   3.448537624312773*^9, 3.448537653717447*^9}, {3.44853920001373*^9, 
   3.44853928191868*^9}, {3.448540440297836*^9, 3.44854045485354*^9}, {
   3.448544837693735*^9, 3.448544935246232*^9}, {3.449084265404659*^9, 
   3.449084430749514*^9}, {3.451056936539566*^9, 3.451056942988469*^9}, {
   3.45105970195226*^9, 3.4510597460775633`*^9}, {3.4510598131377687`*^9, 
   3.4510598199823837`*^9}, {3.451066883482477*^9, 3.4510668994760227`*^9}, {
   3.452328546806715*^9, 3.4523285825637007`*^9}, {3.453222481793515*^9, 
   3.453222509718536*^9}, {3.454075407796398*^9, 3.45407547645564*^9}, {
   3.454614248735712*^9, 3.454614262861917*^9}, 3.4548785321178637`*^9, {
   3.454878618789748*^9, 3.454878619312011*^9}, {3.454947744031793*^9, 
   3.454947776007629*^9}, {3.454960303909992*^9, 3.4549603046116543`*^9}, {
   3.454960403213731*^9, 3.454960405478592*^9}, {3.4549604784488497`*^9, 
   3.454960482079668*^9}, {3.454961543739729*^9, 3.4549615859105387`*^9}, {
   3.454963055359839*^9, 3.454963058699358*^9}, {3.455064844870138*^9, 
   3.4550648987813473`*^9}, {3.455064973581807*^9, 3.4550649772523317`*^9}, {
   3.455128663482848*^9, 3.455128684162306*^9}, {3.455128863523737*^9, 
   3.4551290229282627`*^9}, {3.455231637537649*^9, 3.4552316380274553`*^9}, 
   3.455232379514765*^9, {3.45674918749516*^9, 3.456749204809288*^9}, {
   3.456750047607636*^9, 3.456750079449093*^9}, {3.456750143377314*^9, 
   3.456750152437904*^9}, {3.456754275855641*^9, 3.456754419129344*^9}, {
   3.45735482557236*^9, 3.457354835931068*^9}, {3.4611722723216047`*^9, 
   3.461172278386476*^9}, {3.461172577903132*^9, 3.4611725819163647`*^9}, {
   3.461172635935054*^9, 3.461172659542244*^9}, {3.461173814644153*^9, 
   3.461173852349111*^9}, {3.4949320492273407`*^9, 3.494932064811153*^9}, {
   3.494932372303092*^9, 3.4949323735792093`*^9}, {3.4949338129360943`*^9, 
   3.494933906638604*^9}, {3.495144536867156*^9, 3.4951445404539957`*^9}, {
   3.512217734005028*^9, 3.5122177452585917`*^9}, {3.5122182216815233`*^9, 
   3.5122182336180563`*^9}, {3.512218630029751*^9, 3.512218637977662*^9}, {
   3.512218679845345*^9, 3.512218732540112*^9}, {3.512219817979539*^9, 
   3.512219850929055*^9}, {3.54474696335141*^9, 3.544747124567892*^9}, {
   3.5447471603204937`*^9, 3.544747178845405*^9}, {3.5451340039557133`*^9, 
   3.5451340058764677`*^9}, {3.545134061476778*^9, 3.545134224693453*^9}, {
   3.5580852523563433`*^9, 3.55808527264149*^9}, {3.558373186771805*^9, 
   3.55837323250939*^9}, {3.558873104273734*^9, 3.558873156149808*^9}, {
   3.559422514996111*^9, 3.559422576762768*^9}, {3.561454072967581*^9, 
   3.561454098215105*^9}, {3.561478427848639*^9, 3.561478450914618*^9}, 
   3.561478501066101*^9, {3.561479103677549*^9, 3.561479108562787*^9}, {
   3.5614804570979357`*^9, 3.5614804572685738`*^9}, {3.561555652857134*^9, 
   3.5615556745601377`*^9}, {3.561555990433052*^9, 3.561555998009713*^9}, {
   3.561557255673064*^9, 3.5615574835417967`*^9}, {3.561584843055086*^9, 
   3.561585006186161*^9}, {3.5615850364532433`*^9, 3.561585063103129*^9}, {
   3.70571094074667*^9, 3.705710959504071*^9}, {3.7057111224526653`*^9, 
   3.705711156764476*^9}, {3.705711286807056*^9, 3.705711325203603*^9}, {
   3.7057117969721737`*^9, 
   3.705711800694792*^9}},ExpressionUUID->"fc45fc17-4d39-4b2d-aa7e-\
c58580d352f9"]
}, Closed]],

Cell[CellGroupData[{

Cell["projections", "Subsubsection",
 CellChangeTimes->{{3.4923626960554247`*^9, 
  3.492362697207362*^9}},ExpressionUUID->"d41040b2-c582-4852-b493-\
e5383f9469d0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"LambertPlaneToDome", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LambertDomeToPlane", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ShowTissueOnDome", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ParaboloidPlot", "::", "usage"}], "=", 
    "\"\<ParaboloidPlot[T,r,a,h,k,options]\\nParaboloidPlot[T,options]\\nwith \
options\\n\\\"radius\\\",\\\"a\\\",\\\"h\\\",\\\"k\\\". The paraboloid is \
parallel to the z-axis, offset by (h,k) (default, (0,0)), and decreases as \
-a(x^2+y^2). radius gives the radius of the \
mask.\\n\\\"Boundary\\\"\[Rule]False(default) or Directive[{color, style, \
etc}]. Values of True or Automatic are equivalent to \
Directive[{Thick,Black}]. Used for outer boundary of tissue.\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "ShowTissueOnDome", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<CellStyle\>\"", "\[Rule]", " ", "Automatic"}], ",", " ", 
      RowBox[{"\"\<EdgeStyle\>\"", "\[Rule]", " ", "Black"}], ",", " ", 
      RowBox[{"\"\<Radius\>\"", "\[Rule]", " ", 
       RowBox[{"-", "1"}]}]}], "}"}]}], ";"}], 
  " "}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.492362699032424*^9, 3.4923627316662817`*^9}, {
  3.492366212088069*^9, 3.492366215303905*^9}, {3.492366734720133*^9, 
  3.492366788849697*^9}, {3.49236715912915*^9, 3.492367160288776*^9}, {
  3.4923694007914257`*^9, 3.4923694036394043`*^9}, {3.4923727917971287`*^9, 
  3.492372792620798*^9}, {3.5491227000151377`*^9, 3.5491227037046022`*^9}, {
  3.549134959612226*^9, 3.549135075165842*^9}, {3.558873178021014*^9, 
  3.558873275555498*^9}},ExpressionUUID->"6610808e-2fdb-4aa4-a1a0-\
1d97fb081feb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TissueCentroid", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
  " "}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4949330340528393`*^9, 
  3.494933039283475*^9}},ExpressionUUID->"d7c03f35-acb0-4f44-b3d2-\
e6c8e74337fc"],

Cell["Tiss", "Text",
 CellChangeTimes->{{3.494933030207354*^9, 
  3.494933030767062*^9}},ExpressionUUID->"933c5951-257d-4176-8179-\
6713da1fb7e8"]
}, Closed]],

Cell[CellGroupData[{

Cell["text file outputs", "Subsubsection",
 CellChangeTimes->{{3.517264522050948*^9, 
  3.517264527098218*^9}},ExpressionUUID->"9277226d-1e00-4573-90de-\
f11872c0a490"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FlatFile", "::", "usage"}], "=", 
   "\"\<FlatFile[tissue] returns a list\\nFlatFile[tissue,file] outputs the \
tissue to a flat file.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CSVFile", "::", "usage"}], "=", 
    "\"\<CSVFile[tissue], CSVFile[tissue, filename], CSVFile[tissue, \
filename, flat:False]\>\""}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CSVToTissue", "::", "usage"}], "=", 
    "\"\<CSVToTissue[filename] returns a Tissue object. The CSV file must \
either be formatted as \n\tn,dimensions\n\tn,vertices\n\tn,edges\n\tn,faces\n\
\tx,y\n\tx,y\n\t...\n\ti,j\n\ti,j\n\t...\n\tp,q,r,..\n\tp,q,r,..\n\t...\n\
where the strings \\\"dimensions\\\",\\\"vertices\\\",\\\"edges\\\" and \
\\\"faces\\\" are required; n is an integer; x,y (or x,y,z) are the \
coordinates of the ith vertex; i,j are the vertex indices of the pth edge; \
and p,q,r,... are the edge indices of the kth cell; or as\n\tn,dimensions\n\t\
n,vertices\n\tn,faces\n\tx,y\n\tx,y\n\t...\n\ts,t,u,..\n\ts,t,u,...\n\t...\n\
where s,t,u,... are the vertex indices of the kth cell, and everything else \
is as defined for the first case.\nIn either case, a Tissue object is \
returned (the cells are expanded into their edge components, in the second \
case). \n\>\""}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TissueToPLY", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PLYToTissue", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PLYToTissue3D", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
  " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.517264540101059*^9, 3.517264589563569*^9}, {
  3.517265415033455*^9, 3.5172654533230143`*^9}, {3.5442681907821407`*^9, 
  3.5442681980784473`*^9}, {3.5589951623671494`*^9, 3.558995169119309*^9}, {
  3.5624403783770227`*^9, 3.562440382608335*^9}, {3.562441064173295*^9, 
  3.5624410860515003`*^9}, {3.5626001253920927`*^9, 3.5626001475842247`*^9}, {
  3.562600366973703*^9, 
  3.562600680993703*^9}},ExpressionUUID->"53c86dba-a865-4635-8d20-\
fb9a7760a4d1"]
}, Closed]],

Cell[CellGroupData[{

Cell["Some 3D stuff", "Subsubsection",
 CellChangeTimes->{{3.559092691160293*^9, 3.559092693223864*^9}, 
   3.559092745999453*^9},ExpressionUUID->"b3e6a710-65bc-44cf-b9ce-\
c94e2cfc77bb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ShowTissue3D", "::", "usage"}], "=", 
   RowBox[{
   "\"\<ShowTissue3D[T,edge-style]\\n\>\"", "<>", 
    "\"\<ShowTissue3D[T,edgeStyle,cellNumberStyle,edgeNumberStyle]\\n\>\"", "<>",
     "\[IndentingNewLine]", 
    "\"\<ShowTissue3D[T,edgeStyle,cellNumberStyle,edgeNumberStyle,xrange,\
yrange,zrange]\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ShowZProjection", "::", "usage"}], "=", 
   "\"\<ShowZProjection[T,options]\\nSame options as ShowTissue.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PolygonArea", "::", "usage"}], "=", 
   "\"\<PolygonArea[vertices]\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ZProjection", "::", "usage"}], "=", 
   "\"\<ZProjection[Tissue]\>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.559092697605287*^9, 3.5590927402401257`*^9}, {
  3.559422610681982*^9, 3.559422730588111*^9}, {3.559424997171194*^9, 
  3.559425020769966*^9}, {3.559425614382349*^9, 3.559425625148913*^9}, {
  3.559426085714238*^9, 
  3.5594260947293053`*^9}},ExpressionUUID->"2bce2fe8-ae4e-4be8-af67-\
e67a049a3095"]
}, Closed]],

Cell[CellGroupData[{

Cell["Cell Extraction", "Subsubsection",
 CellChangeTimes->{{3.562342163518154*^9, 
  3.562342173136404*^9}},ExpressionUUID->"77c0b875-dc9c-4137-891a-\
c877b3818f17"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BelowLine", "::", "usage"}], "=", 
    "\"\<BelowLine[A, B, C] returns True if y<mx+b, where A=(x,y), and m and \
b are the slope and y-intercept of the line from B to C; and returns False \
otherwise\>\""}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AboveLine", "::", "usage"}], "=", 
   "\"\<AboveLine[A,B,C] returns True if BelowLine[A,B,C] is False.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CellsBelowLine", "::", "usage"}], "=", 
   "\"\<CellsBelowLine[Tissue, point1, point2] returns a list of cell numbers \
of the cells that fall below (smaller y coordinate) the non-vertical line \
connecting the two points.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CellsAboveLine", "::", "usage"}], "=", 
   "\"\<CellsAboveLine[Tissue, point1, point2] returns a list of cell numbers \
of the cells that fall above (larger y coordinate) the non-vertical line \
connecting the two points.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetTissueBelowLine", "::", "usage"}], "=", 
   "\"\<GetTissueBelowLine[Tissue, point1, point2] returns a tissue composed \
of only those cells with centers below (smaller y coordinated) that the line \
connecting the two points. The two points must not lie on a vertical \
line.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetTissueAboveLine", "::", "usage"}], "=", 
   "\"\<GetTissueAboveLine[Tissue, point1, point2] returns a tissue composed \
of only those cells with centers above (larger y coordinated) that the line \
connecting the two points. The two points must not lie on a vertical \
line.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CellsInsidePolygon", "::", "usage"}], "=", 
   "\"\<CellsInsidePolygon[Tissue, {v1,v2,..}] retursn a list of the cell \
numbers of cells with centers falling inside the specified polygon.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetTissueInsidePolygon", "::", "usage"}], "=", 
   "\"\<GetTissueInisdePolygon[Tissue, {v1,v2,...}] returns the tissue \
composed of cells with centers falling inside the specified polygon.\>\""}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.56234216338487*^9, 3.56234219253671*^9}, {
  3.562342533041215*^9, 3.5623425439880466`*^9}, {3.56234262884527*^9, 
  3.56234262964823*^9}, {3.562342757095635*^9, 3.56234277223741*^9}, {
  3.5623538570856657`*^9, 3.5623538697071257`*^9}, {3.56235391280513*^9, 
  3.562353918079239*^9}, {3.562355190308272*^9, 
  3.562355602862213*^9}},ExpressionUUID->"5f1fadbd-1e2b-44cd-ae4f-\
a2ecba61587d"]
}, Closed]],

Cell[CellGroupData[{

Cell["Growth Arrows", "Subsubsection",
 CellChangeTimes->{{3.576613996171207*^9, 3.5766139995545387`*^9}, {
  3.576614939813106*^9, 
  3.576614943243986*^9}},ExpressionUUID->"0d845cc3-1bbe-4552-a3cb-\
bc0db3cb80c9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Spring", "::", "usage"}], "=", 
   "\"\<Spring is an uninstantiated function used by Cellzilla \
arrows.\\nSpring[variable, function] where variable is the spring connstant \
variable (typically k), and function is a function giving its dependence on \
cell and edge index length. Identical to the control parameter \\\"k\\\" \
except that it is encapsulated by the function Spring instead of k.\>\""}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Grow", "::", "usage"}], "\[Equal]", 
    "\"\<Grow is an uninstantiated function used by the Cellzilla Arrow cell\
\[LongRightArrow]cell, Grow[Spring[..],Rate[..],Pressure[..]]\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GrowthRate", "::", "usage"}], "=", 
   "\"\<GrowthRate is an uninstantiated function used by Cellzilla \
arrows.\\nRate[variable, function] where variable is the spring rest length \
variable, and function is a function giving its growth length. Identical to \
the control parameter \\\"mu\\\" except that it is encapsulated by the \
function Rate instead of List.\>\""}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Pressure", "::", "usage"}], "=", 
    "\"\<Pressure is an uninstantiated function used by Cellzilla \
arrows.\\nPressure[variable, function] is a function that the user supplies \
to define the pressure as part of a Cellzilla cell growth arrow. Identical to \
the control parameter \\\"P\\\" except that it is encapsulated by the \
function Pressure instead of List. \>\""}], ";"}], " ", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"cell", "::", "usage"}], "=", 
    "\"\<cell is the default name for a cell; lower case must be used to \
avoid conflict with the built in Mathematica variable Cell.\>\""}], "*)"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ErreraRule", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Potential", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ShowCellExtensions", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5766140008827753`*^9, 3.576614019342045*^9}, {
   3.576614148526204*^9, 3.576614197967717*^9}, {3.57661494666469*^9, 
   3.576615347076653*^9}, {3.576616659545637*^9, 3.576616664493572*^9}, {
   3.5766175136887608`*^9, 3.576617516992579*^9}, 3.576619755047666*^9, {
   3.5766198366036453`*^9, 3.576619842112941*^9}, {3.576619949002659*^9, 
   3.5766199532184896`*^9}, {3.5766226108385572`*^9, 3.57662264030243*^9}, {
   3.576622959656166*^9, 3.576622968204618*^9}, {3.577640732737132*^9, 
   3.5776407385441008`*^9}},ExpressionUUID->"0e1d50dc-1ff0-4537-906b-\
84d626c41635"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Code", "Subtitle",
 CellChangeTimes->{{3.446838465217635*^9, 3.446838465657779*^9}, {
  3.455125248853187*^9, 
  3.455125250081627*^9}},ExpressionUUID->"ea186c1e-18a5-490d-b302-\
ce08b98d311f"],

Cell[CellGroupData[{

Cell["Begin, Needs", "Subsubsection",
 CellChangeTimes->{{3.454166947161983*^9, 
  3.4541669556690083`*^9}},ExpressionUUID->"fc29c71d-e3a2-43a2-b20f-\
8cf3b2b045cc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Needs", "[", "\"\<ComputationalGeometry`\>\"", "]"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Needs", "[", "\"\<ErrorBarPlots`\>\"", "]"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "Needs", "[", "\"\<DifferentialEquations`InterpolatingFunctionAnatomy`\>\"",
    "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"Names", "[", "\"\<FLAGS`ECHOLOAD\>\"", "]"}], "]"}], ">", 
     "0"}], ",", "\[IndentingNewLine]", 
    RowBox[{"msgflag", "=", 
     RowBox[{"ToExpression", "[", "\"\<FLAGS`ECHOLOAD\>\"", "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"msgflag", "=", "True"}], ";"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"saveEcho", "=", "msgflag"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FLAGS`ECHOLOAD", "=", "False"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Quiet", "[", 
   RowBox[{"Needs", "[", "\"\<xlr8r`\>\"", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$XLR8RLOAD", "=", "True"}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"Names", "[", "\"\<$xlr8r$Version\>\"", "]"}], "]"}], "<", 
     "1"}], ",", " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"$XLR8RLOAD", "=", "False"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"\"\<Warning: \>\"", ",", " ", "Bold", ",", " ", "Read"}], 
        "]"}], ",", " ", 
       RowBox[{"Style", "[", 
        RowBox[{
        "\"\<Cellzilla2D: xlr8r.m not found in path. It should be loaded \
manually before any xlr8r simulations can be run.\>\"", ",", " ", "Bold"}], 
        "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$XLR8RLOAD", " ", "=", " ", 
    RowBox[{"If", "[", 
     RowBox[{"$XLR8RLOAD", ",", " ", 
      RowBox[{"ToExpression", "[", "\"\<$xlr8r$Version\>\"", "]"}], ",", " ", 
      "\"\<** Not Found **\>\""}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FLAGS`ECHOLOAD", "=", "False"}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "may", " ", "get", " ", "reset", " ", "in", " ", "xlr8r", " ", "load"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Quiet", "[", 
   RowBox[{"Needs", "[", "\"\<xSSA`\>\"", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$XSSALOAD", "=", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"Names", "[", "\"\<$xSSA$Version\>\"", "]"}], "]"}], "<", "1"}],
     ",", " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"$XSSALOAD", "=", "False"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"\"\<Warning: \>\"", ",", " ", "Bold", ",", " ", "Red"}], 
        "]"}], ",", " ", 
       RowBox[{"Style", "[", 
        RowBox[{
        "\"\<Cellzilla2D: xSSA.m not found in path. Some stochastic \
conversion functions may not work as expected. It should be loaded manually \
before any xSSA (stochastic) simulations can be run.\>\"", ",", " ", "Bold"}],
         "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$XSSALOAD", "=", 
    RowBox[{"If", "[", 
     RowBox[{"$XSSALOAD", ",", " ", 
      RowBox[{"ToExpression", "[", "\"\<$xSSA$Version\>\"", "]"}], ",", " ", 
      "\"\<** Not Found **\>\""}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FLAGS`ECHOLOAD", "=", "saveEcho"}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.446837676531289*^9, 3.446837686241798*^9}, {
   3.45184251260244*^9, 3.451842527713546*^9}, {3.452331031820655*^9, 
   3.452331051272696*^9}, {3.452331275347823*^9, 3.452331282130229*^9}, {
   3.452331422099516*^9, 3.452331426918646*^9}, {3.452331807463965*^9, 
   3.452331838235259*^9}, {3.452440924347*^9, 3.452440932989333*^9}, {
   3.4544354176758327`*^9, 3.454435439344841*^9}, {3.456320707939005*^9, 
   3.456320715000964*^9}, {3.4563207546200027`*^9, 3.456320797046344*^9}, 
   3.456580625494774*^9, {3.457354396710671*^9, 3.457354405720319*^9}, {
   3.4573545303669653`*^9, 3.457354712883954*^9}, {3.4573549331857853`*^9, 
   3.457354955625078*^9}, {3.4574474806385927`*^9, 3.457447487765945*^9}, {
   3.457447524245676*^9, 3.4574475614725533`*^9}, {3.457447834709581*^9, 
   3.4574478354270277`*^9}, {3.5583849152546577`*^9, 
   3.558384927027862*^9}},ExpressionUUID->"5ac3a6ed-ee6f-41c6-833b-\
33180ac5b8e4"]
}, Closed]],

Cell[CellGroupData[{

Cell["Jlink based System memory inquiry", "Section",
 CellChangeTimes->{{3.549203923777011*^9, 
  3.549203945136812*^9}},ExpressionUUID->"60062061-bfea-49f3-a118-\
1f432871b2a4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Needs", "[", "\"\<JLink`\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InstallJava", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "LoadJavaClass", "[", "\"\<java.lang.management.ManagementFactory\>\"", 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"JMemQuest", "[", "x_", "]"}], ":=", " ", 
   RowBox[{
    RowBox[{
    "java`lang`management`ManagementFactory`getOperatingSystemMXBean", "[", 
     "]"}], "@", 
    RowBox[{"x", "[", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MemoryInstalled", "[", "]"}], ":=", " ", 
   RowBox[{"JMemQuest", "[", "getTotalPhysicalMemorySize", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MemoryFree", "[", "]"}], ":=", " ", 
   RowBox[{"JMemQuest", "[", "getFreePhysicalMemorySize", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5492039667706127`*^9, 
  3.5492040727769327`*^9}},ExpressionUUID->"6c044596-20ae-448c-927a-\
f3e22ff5baac"]
}, Closed]],

Cell[CellGroupData[{

Cell["Utility", "Section",
 CellChangeTimes->{{3.446843655527812*^9, 
  3.446843656520915*^9}},ExpressionUUID->"d4e5cfe1-bd05-4da9-b220-\
b760b264f5ce"],

Cell[CellGroupData[{

Cell["MyFilterOptions", "Subsection",
 CellChangeTimes->{{3.448486084235524*^9, 
  3.448486087755056*^9}},ExpressionUUID->"c291e662-420d-407f-8835-\
abe1de2acb5d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MyFilterOptions", "[", 
    RowBox[{"f_", ",", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Sequence", "@@", 
    RowBox[{"FilterRules", "[", 
     RowBox[{
      RowBox[{"Flatten", "[", 
       RowBox[{"{", "opt", "}"}], "]"}], ",", 
      RowBox[{"Options", "[", "f", "]"}]}], "]"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.448485963971858*^9, 3.448485977230622*^9}, {
  3.448486007929703*^9, 
  3.448486012901706*^9}},ExpressionUUID->"b6e36904-6a47-4e17-ad0d-\
2c06970a808c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["DifferentQ", "Subsection",
 CellChangeTimes->{{3.448469632657759*^9, 
  3.448469633689558*^9}},ExpressionUUID->"fef76b5c-27ca-49ec-a700-\
19b027634fe6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DifferentQ", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], ":=", " ", 
    RowBox[{"Not", "[", 
     RowBox[{"SameQ", "[", 
      RowBox[{"x", ",", "y"}], "]"}], "]"}]}], ";"}], " "}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.446843633798665*^9, 
  3.44684364485109*^9}},ExpressionUUID->"13fe91e7-5478-4a17-91c8-\
9f34c20d1cf4"]
}, Closed]],

Cell[CellGroupData[{

Cell["numPairQ, intPairQ, intListQ, NumBer", "Subsection",
 CellChangeTimes->{{3.448469611777957*^9, 3.44846962547356*^9}, {
  3.558995548558159*^9, 
  3.558995550077924*^9}},ExpressionUUID->"cd02afec-f6d2-4310-9e4d-\
f1b06ae642c1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"numPairQ", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x_", "?", "NumericQ"}], ",", " ", 
       RowBox[{"y_", "?", "NumericQ"}]}], "}"}], "]"}], ":=", " ", "True"}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"\[Infinity]", ",", "\[Infinity]"}], ")"}], " ", "used", " ", 
    "as", " ", "a", " ", "flag", " ", "for", " ", "special", " ", 
    "vertices"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"numPairQ", "[", 
    RowBox[{"{", 
     RowBox[{"Infinity", ",", "Infinity"}], "}"}], "]"}], ":=", " ", "True"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"numPairQ", "[", "x___", "]"}], ":=", " ", "False"}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NumBerQ", "[", 
    RowBox[{"x_", "?", "NumericQ"}], "]"}], ":=", "True"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NumBerQ", "[", "Infinity", "]"}], ":=", "True"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NumBerQ", "[", "z___", "]"}], ":=", " ", "False"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NumTripleQ", "[", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
   RowBox[{"And", "@@", 
    RowBox[{"(", " ", 
     RowBox[{"NumBerQ", "/@", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NumTripleQ", "[", "x___", "]"}], ":=", " ", "False"}], ";"}], 
  " ", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"intPairQ", "[", 
    RowBox[{"{", 
     RowBox[{"i_Integer", ",", " ", "j_Integer"}], "}"}], "]"}], ":=", " ", 
   "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"intPairQ", "[", "x___", "]"}], ":=", " ", "False"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"intListQ", "[", 
    RowBox[{"{", "i___Integer", "}"}], "]"}], ":=", " ", "True"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"intListQ", "[", "x___", "]"}], ":=", " ", "False"}], ";"}], 
  " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.448482175906633*^9, 3.448482182358682*^9}, {
   3.547053099099288*^9, 3.547053178910595*^9}, {3.558995461419755*^9, 
   3.558995616721951*^9}, 
   3.559084316417251*^9},ExpressionUUID->"a41cd6c8-69ca-4b54-9cc7-\
a785a3347882"]
}, Closed]],

Cell[CellGroupData[{

Cell["argument", "Subsection",
 CellChangeTimes->{{3.448474491614548*^9, 
  3.448474492542245*^9}},ExpressionUUID->"d79375ca-9d13-409c-8e49-\
377168f5e940"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"argument", "[", 
     RowBox[{"f_", "[", "x___", "]"}], "]"}], ":=", " ", 
    RowBox[{"{", "x", "}"}]}], ";"}], " "}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.448474495840126*^9, 
  3.448474509598709*^9}},ExpressionUUID->"3601b1ca-e27f-4232-a707-\
9618c6754d5f"]
}, Closed]],

Cell[CellGroupData[{

Cell["stringify (convert an object to a string)", "Subsection",
 CellChangeTimes->{{3.412729386314872*^9, 
  3.412729394540382*^9}},ExpressionUUID->"9eca98d9-ce7c-4491-9c50-\
0048b80ff7ec"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"stringify", "[", 
    RowBox[{"x_", "?", "StringQ"}], "]"}], ":=", " ", "x"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"stringify", "[", "x_", "]"}], ":=", " ", 
   RowBox[{"ToString", "[", "x", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"stringify", "[", "x__", "]"}], ":=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Error: Multiple arguments to stringify: \>\"", ",", "x"}], 
      "]"}], ";", " ", 
     RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4126921368908587`*^9, 3.412692181400323*^9}, {
  3.412692231526958*^9, 3.412692274554245*^9}, {3.4126933874031277`*^9, 
  3.412693426069847*^9}, {3.412693494514379*^9, 3.412693494672491*^9}, {
  3.412693531522835*^9, 3.412693533915955*^9}, {3.412729373752129*^9, 
  3.412729378229249*^9}},ExpressionUUID->"ee486556-ad4d-48b6-8126-\
542184a6b37d"]
}, Closed]],

Cell[CellGroupData[{

Cell["hasValue", "Subsection",
 CellChangeTimes->{{3.412729354957015*^9, 
  3.412729355865838*^9}},ExpressionUUID->"14edb4cd-4acf-4455-aeed-\
a53790d59572"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"hasvalue", "[", "x_", "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"ToString", "[", 
     RowBox[{"ToExpression", "[", "x", "]"}], "]"}], "\[NotEqual]", " ", 
    "x"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4126921368908587`*^9, 3.412692181400323*^9}, {
  3.412692231526958*^9, 3.412692274554245*^9}, {3.4126933874031277`*^9, 
  3.412693426069847*^9}, {3.412693494514379*^9, 3.412693494672491*^9}, {
  3.412693531522835*^9, 3.412693533915955*^9}, {3.412729346610742*^9, 
  3.4127293500782623`*^9}},ExpressionUUID->"c2da9407-c5ed-4ae4-b9d6-\
7eddb4d8de88"]
}, Closed]],

Cell[CellGroupData[{

Cell["contextify ", "Subsection",
 CellChangeTimes->{{3.4127293035215263`*^9, 3.412729311359481*^9}, {
  3.448486880312552*^9, 
  3.448486885743784*^9}},ExpressionUUID->"5ccc7464-7d4b-46af-9465-\
10bff3462b86"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"default$context", "=", "\"\<sim\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"current$context", "=", "default$context"}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"contextify", "[", 
   RowBox[{"item_", ",", " ", 
    RowBox[{"context_:", "current$context"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "res", ",", " ", "thecontext", ",", " ", "theitem", ",", " ", 
      "badcontext"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"badcontext", "[", "u_", "]"}], ":=", "  ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"hasvalue", "[", 
         RowBox[{"ToExpression", "[", "u", "]"}], "]"}], ",", " ", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Warning: contextify: the symbol: \>\"", ",", "u", ",", 
           "\"\< already has a value assigned to it. This could lead to \
unexpected results: \>\"", ",", " ", 
           RowBox[{"ToExpression", "[", "u", "]"}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"badcontext", "[", "item", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"badcontext", "[", "context", "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"theitem", "=", 
      RowBox[{"stringify", "[", "item", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"thecontext", "=", 
      RowBox[{"stringify", "[", "context", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"StringLength", "[", "thecontext", "]"}], ">", "1"}], " ", 
        "\[And]", 
        RowBox[{
         RowBox[{"StringTake", "[", 
          RowBox[{"thecontext", ",", 
           RowBox[{"-", "1"}]}], "]"}], "\[Equal]", "\"\<`\>\""}]}], ",", 
       RowBox[{"thecontext", "=", 
        RowBox[{"StringDrop", "[", 
         RowBox[{"thecontext", ",", 
          RowBox[{"-", "1"}]}], "]"}]}]}], " ", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"thecontext", "==", "\"\<\>\""}], " ", "\[Or]", " ", 
        RowBox[{
         RowBox[{"ToUpperCase", "[", "thecontext", "]"}], "\[Equal]", 
         "\"\<NONE\>\""}]}], ",", " ", 
       RowBox[{"thecontext", "=", "\"\<Global\>\""}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"thecontext", "<>", "\"\<`\>\"", "<>", "theitem"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"badcontext", "[", "res", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"ToExpression", "[", "res", "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.412692334101809*^9, 3.4126924094988537`*^9}, {
  3.41269244376125*^9, 3.412692630898632*^9}, {3.412692678441533*^9, 
  3.4126928362549887`*^9}, {3.412692908385866*^9, 3.412692912529756*^9}, {
  3.4126929625100946`*^9, 3.412692988166709*^9}, {3.41269302132922*^9, 
  3.412693027153017*^9}, {3.412693101654097*^9, 3.412693103533782*^9}, {
  3.412693551255973*^9, 3.412693552438931*^9}, {3.41269359555431*^9, 
  3.41269360500172*^9}, {3.412694036412774*^9, 3.412694162460805*^9}, {
  3.4126942231925507`*^9, 3.412694278826043*^9}, {3.412694373928149*^9, 
  3.412694448483089*^9}, {3.420315340320765*^9, 3.42031535981831*^9}, {
  3.420315390006062*^9, 3.420315392656065*^9}, {3.448486910960276*^9, 
  3.448486911248108*^9}},ExpressionUUID->"962f680e-01d6-47a1-9877-\
6bd0f81ad3a0"],

Cell[CellGroupData[{

Cell["decontextify", "Subsubsection",
 CellChangeTimes->{{3.454152699020874*^9, 
  3.454152703214369*^9}},ExpressionUUID->"aefec1df-b4f6-4d2a-a0fe-\
e18dfd95191d"],

Cell["from mathsbml 2.9.0", "Text",
 CellChangeTimes->{{3.454152726343986*^9, 
  3.454152729089542*^9}},ExpressionUUID->"9edbde67-4d87-4cfc-aa0e-\
444083c8ef68"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"decontextify", "[", 
    RowBox[{"x_", "?", "StringQ"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p", ",", "q"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"p", " ", "=", " ", 
       RowBox[{"StringPosition", "[", 
        RowBox[{"x", ",", "\"\<`\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "p", "]"}], "<", "1"}], ",", " ", 
        RowBox[{"Return", "[", "x", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"p", "=", 
       RowBox[{"Map", "[", 
        RowBox[{"First", ",", "p"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"p", " ", "=", " ", 
       RowBox[{"Last", "[", "p", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"q", "=", " ", 
       RowBox[{"StringDrop", "[", 
        RowBox[{"x", ",", "p"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "q", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"decontextify", "[", 
    RowBox[{"x_", "?", "ListQ"}], "]"}], ":=", " ", 
   RowBox[{"Map", "[", 
    RowBox[{"decontextify", ",", "x"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"decontextify", "[", "x_", "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "s", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"decontextify", "[", 
          RowBox[{"ToString", "[", 
           RowBox[{"InputForm", "[", "x", "]"}], "]"}], "]"}], "//", 
         "ToExpression"}], "//", "Return"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"decontextify", "[", 
     RowBox[{
      RowBox[{"x_", "?", "StringQ"}], ",", " ", 
      RowBox[{"context_", "?", "StringQ"}]}], "]"}], ":=", " ", 
    RowBox[{"StringReplace", "[", 
     RowBox[{"x", ",", " ", 
      RowBox[{"{", 
       RowBox[{"context", "\[Rule]", " ", "\"\<\>\""}], "}"}]}], "]"}]}], 
   ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"decontextify", "[", 
     RowBox[{
      RowBox[{"x_", "?", "ListQ"}], ",", " ", 
      RowBox[{"context_", "?", "StringQ"}]}], "]"}], ":=", " ", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"decontextify", "[", 
        RowBox[{"#", ",", "context"}], "]"}], "&"}], ",", "x"}], "]"}]}], 
   ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"decontextify", "[", 
     RowBox[{"x_", ",", " ", 
      RowBox[{"context_", "?", "StringQ"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"decontextify", "[", 
          RowBox[{
           RowBox[{"ToString", "[", 
            RowBox[{"InputForm", "[", "x", "]"}], "]"}], ",", "context"}], 
          "]"}], "//", "ToExpression"}], "//", "Return"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.454152714798139*^9, 
  3.4541527568275633`*^9}},ExpressionUUID->"9dfed5d2-2797-469b-9a2a-\
5f167b909636"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["SymbolAppend", "Subsection",
 CellChangeTimes->{{3.448707830593134*^9, 
  3.448707845481009*^9}},ExpressionUUID->"af1df55e-c557-40b4-bacc-\
f2b130cb4a9d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymbolAppend", "[", 
     RowBox[{
      RowBox[{"name_", "?", "AtomQ"}], ",", " ", 
      RowBox[{"appendix_", "?", "StringQ"}]}], "]"}], ":=", 
    RowBox[{"Symbol", "[", 
     RowBox[{
      RowBox[{"stringify", "[", "name", "]"}], "<>", "appendix"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SymbolAppend", "[", "x___", "]"}], ":=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<Expecting SymbolAppend[Atom, Sring], not SymbolAppend[\>\"", ",", 
       "x", ",", "\"\<]\>\""}], "]"}], ";", " ", "$Failed"}], ")"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.448707846809282*^9, 3.448708022662789*^9}, 
   3.448708785476777*^9},ExpressionUUID->"b33a576e-46da-4e19-b1da-\
c286ef4ce13e"]
}, Closed]],

Cell[CellGroupData[{

Cell["RuleQ", "Subsection",
 CellChangeTimes->{{3.448715350318395*^9, 
  3.44871535362986*^9}},ExpressionUUID->"6f90126b-ec09-4950-bd8e-\
469986e2af8c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RuleQ", "[", 
     RowBox[{"x_", "?", "ListQ"}], "]"}], ":=", " ", 
    RowBox[{"And", "@@", 
     RowBox[{"RuleQ", "/@", "x"}]}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RuleQ", "[", "x_", "]"}], ":=", " ", 
   RowBox[{"SameQ", "[", 
    RowBox[{
     RowBox[{"Head", "[", "x", "]"}], ",", " ", "Rule"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RuleQ", "[", 
    RowBox[{"x_", ",", " ", "y__"}], "]"}], ":=", " ", "False"}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.448715354731402*^9, 3.448715383573237*^9}, {
  3.448715462138903*^9, 3.448715476313953*^9}, {3.448715516244577*^9, 
  3.448715516457636*^9}, {3.448715551392587*^9, 
  3.448715613513109*^9}},ExpressionUUID->"4c639142-3c27-40ce-b097-\
1e11d880a2bd"]
}, Closed]],

Cell[CellGroupData[{

Cell["Symbols", "Subsection",
 CellChangeTimes->{{3.448718013585406*^9, 
  3.448718022688627*^9}},ExpressionUUID->"174cae2f-b40d-47c2-af74-\
893c4a17d708"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Symbols", "[", "expression_", "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "xml", ",", " ", "XML", ",", " ", "contexts", ",", " ", "nonSystem"}], 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"XML", "[", 
       RowBox[{"_", ",", " ", "_", ",", " ", 
        RowBox[{"{", "u___", "}"}]}], "]"}], ":=", " ", 
      RowBox[{"{", "u", "}"}]}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"xml", "=", 
      RowBox[{"XML`MathML`ExpressionToSymbolicMathML", "[", 
       RowBox[{"expression", ",", " ", 
        RowBox[{
        "\"\<Formats\>\"", "\[Rule]", " ", "\"\<ContentMathML\>\""}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"xml", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{"xml", ",", 
        RowBox[{"XMLElement", "[", 
         RowBox[{"\"\<ci\>\"", ",", "__"}], "]"}], ",", " ", "Infinity"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"xml", " ", "=", " ", 
      RowBox[{"xml", "/.", 
       RowBox[{"{", 
        RowBox[{"XMLElement", "\[Rule]", " ", "XML"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"xml", "=", 
      RowBox[{"Flatten", "[", "xml", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"xml", "=", 
      RowBox[{"Union", "[", "xml", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"xml", " ", "=", " ", 
      RowBox[{"Symbol", "/@", "xml"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"contexts", " ", "=", " ", 
      RowBox[{"Context", "/@", "xml"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nonSystem", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{"Equal", "[", 
          RowBox[{"#", ",", "\"\<System`\>\""}], "]"}], "]"}], "&"}], "/@", 
       "contexts"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"xml", " ", "=", " ", 
      RowBox[{"Pick", "[", 
       RowBox[{"xml", ",", " ", "nonSystem"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "xml", "]"}], ";"}]}], " ", "\[IndentingNewLine]",
    "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.448718025625149*^9, 3.448718034525993*^9}, {
  3.448718419955709*^9, 3.448718435784377*^9}, {3.448718598388321*^9, 
  3.448718613936758*^9}, {3.448718657681776*^9, 3.448718658472611*^9}, {
  3.448718711678856*^9, 3.448718742204606*^9}, {3.448721892178538*^9, 
  3.448721896771047*^9}, {3.448999716009757*^9, 3.448999766256592*^9}, {
  3.448999801230753*^9, 
  3.448999893914106*^9}},ExpressionUUID->"b0449264-e339-4457-8b82-\
dc19263ff56d"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[CapitalPsi][u]=u if u > 0 and 0 otherwise (implemented as (u+|u|)/2", \
"Subsection",
 CellChangeTimes->{{3.546209283965515*^9, 3.5462092985554533`*^9}, {
  3.5462093398037863`*^9, 
  3.5462093478853483`*^9}},ExpressionUUID->"7fcfa019-b385-41ac-b15b-\
10dcb8480377"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalPsi]", "[", "u_", "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"u", "+", 
      RowBox[{"Abs", "[", "u", "]"}]}], ")"}], "/", "2"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"5b1e9899-f6c7-440c-8e9b-e4d0c2e74c66"]
}, Closed]],

Cell[CellGroupData[{

Cell["yymmdd, hhmmss, now, etc.", "Subsection",
 CellChangeTimes->{{3.547499222368506*^9, 3.547499251543955*^9}, 
   3.5474994318484793`*^9, {3.547558734648147*^9, 3.547558735799068*^9}, {
   3.556725342021607*^9, 
   3.556725344597748*^9}},ExpressionUUID->"2c493b6b-b2f2-4d89-a793-\
dd7793d69b18"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"yymmdd", "[", "]"}], ":=", 
   RowBox[{"DateString", "[", 
    RowBox[{"{", 
     RowBox[{"\"\<YearShort\>\"", ",", "\"\<Month\>\"", ",", "\"\<Day\>\""}], 
     "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"dd\[UnderBracket]mon\[UnderBracket]yy", "[", "]"}], ":=", " ", 
    RowBox[{"DateString", "[", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Day\>\"", ",", "\"\<-\>\"", ",", "\"\<MonthNameShort\>\"", ",", 
       "\"\<-\>\"", ",", "\"\<YearShort\>\""}], "}"}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"dd\[UnderBracket]mon\[UnderBracket]yyyy", "[", "]"}], ":=", " ", 
    
    RowBox[{"DateString", "[", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Day\>\"", ",", "\"\<-\>\"", ",", "\"\<MonthNameShort\>\"", ",", 
       "\"\<-\>\"", ",", "\"\<Year\>\""}], "}"}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"dd\[UnderBracket]month\[UnderBracket]yyyy", "[", "]"}], ":=", 
    " ", 
    RowBox[{"DateString", "[", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Day\>\"", ",", "\"\<-\>\"", ",", "\"\<MonthName\>\"", ",", 
       "\"\<-\>\"", ",", "\"\<Year\>\""}], "}"}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"hhmmss", "[", "]"}], " ", ":=", " ", 
    RowBox[{"DateString", "[", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Hour24\>\"", ",", " ", "\"\<Minute\>\"", ",", "\"\<Second\>\""}], 
      "}"}], "]"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"now", "[", "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"dd\[UnderBracket]mon\[UnderBracket]yyyy", "[", "]"}], "<>", 
    "\"\<-at-\>\"", "<>", 
    RowBox[{"DateString", "[", "\"\<Time\>\"", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"dmyhms", "[", "]"}], ":=", " ", 
    RowBox[{"now", "[", "]"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5474992291683064`*^9, 3.5474992882081003`*^9}, {
   3.5474994342404947`*^9, 3.547499463091082*^9}, 3.547499503979518*^9, {
   3.54749953444558*^9, 3.547499535474545*^9}, {3.547559206080415*^9, 
   3.547559292223343*^9}, {3.556710241034321*^9, 3.556710269309457*^9}, {
   3.556710332535206*^9, 3.556710378833001*^9}, {3.556725349313829*^9, 
   3.556725356749338*^9}},ExpressionUUID->"fa994547-4942-4563-bc7e-\
7fec1195aaef"]
}, Closed]],

Cell[CellGroupData[{

Cell["createHomeFolder", "Subsection",
 CellChangeTimes->{{3.585939744885577*^9, 
  3.5859397478133383`*^9}},ExpressionUUID->"6f5a8712-2a9f-4351-bca9-\
12b8abd7f1bd"],

Cell["\<\
Creates the \[OpenCurlyDoubleQuote]Cellzilla\[CloseCurlyDoubleQuote] folder \
in the home folder. If the folder already exists, it does nothing. If a file \
by that name already exists,\
\>", "Text",
 CellChangeTimes->{{3.585940306440357*^9, 
  3.5859403572398653`*^9}},ExpressionUUID->"eb75b3d6-cde1-4092-a944-\
4d4bdba9cf59"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CreateHomeFolder", "[", "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"h", ",", "d", ",", "i"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"i", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"d", "=", "$HomeDirectory"}], ";", " ", "\[IndentingNewLine]", 
       
       RowBox[{"h", "=", 
        RowBox[{"ToFileName", "[", 
         RowBox[{"d", ",", " ", "\"\<Cellzilla\>\""}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"FileExistsQ", "[", "h", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"DirectoryQ", "[", "h", "]"}], ",", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"Return", "[", "h", "]"}], ",", " ", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<Error, the file \>\"", ",", " ", "h", ",", " ", 
               "\"\< exists and is not a directory. Please rename this file \
or move it to another location. \>\""}], "]"}], ";", " ", 
             RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
          ";"}], " ", "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"CreateDirectory", "[", "h", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "h", "]"}]}]}], "\[IndentingNewLine]", 
        "]"}]}]}], "]"}]}], ";"}], " "}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5859401577238626`*^9, 3.585940295409734*^9}, {
  3.585940410033225*^9, 3.585940510853537*^9}, {3.585940543448522*^9, 
  3.5859405605251226`*^9}, {3.592572271109342*^9, 
  3.592572300424767*^9}},ExpressionUUID->"b69dd458-2339-49c8-851e-\
d4d3f4b72c82"]
}, Closed]],

Cell[CellGroupData[{

Cell["createTodaysFolder", "Subsection",
 CellChangeTimes->{{3.5474995564726*^9, 
  3.547499582392111*^9}},ExpressionUUID->"86b4142b-6587-4970-8e40-\
46bfc3bff14b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"createTodaysFolder", "[", 
   RowBox[{"base_:", "\"\<Simulations-\>\""}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"f", ",", "f1", ",", "i"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"f", "=", 
      RowBox[{
       RowBox[{"ToString", "[", "base", "]"}], "<>", 
       RowBox[{"dd\[UnderBracket]mon\[UnderBracket]yy", "[", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"f1", "=", "f"}], ";", 
     RowBox[{"i", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"FileExistsQ", "[", "f1", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"DirectoryQ", "[", "f1", "]"}], ",", 
          RowBox[{"Return", "[", "f1", "]"}]}], "]"}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"i", "=", 
         RowBox[{"i", "+", "1"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"f1", "=", 
         RowBox[{"f", "<>", 
          RowBox[{"ToString", "[", "i", "]"}]}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"CreateDirectory", "[", "f1", "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"Return", "[", "f1", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.547499585169544*^9, 3.547499726010201*^9}, {
  3.5474998158310633`*^9, 3.547499837432732*^9}, {3.547499867457115*^9, 
  3.547499946235539*^9}, {3.547558071411128*^9, 3.547558120959282*^9}, {
  3.5475593316384897`*^9, 3.547559339030509*^9}, {3.547561113293766*^9, 
  3.5475611253867407`*^9}, {3.585940144530542*^9, 
  3.585940146114119*^9}},ExpressionUUID->"b40d29d2-00a8-40f1-8464-\
3b408436a7c7"]
}, Closed]],

Cell[CellGroupData[{

Cell["createUniqueFolder", "Subsection",
 CellChangeTimes->{{3.547558658703562*^9, 3.547558660656226*^9}, {
  3.5475587934472523`*^9, 
  3.5475587942951097`*^9}},ExpressionUUID->"7bf31552-4f6b-491b-ac39-\
f5c1a4c437d5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"createUniqueFolder", "[", 
   RowBox[{"base_:", "\"\<Simulation-\>\""}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"f", ",", "f1", ",", "i"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"f", "=", 
       RowBox[{
        RowBox[{"ToString", "[", "base", "]"}], "<>", 
        RowBox[{"hhmmss", "[", "]"}]}]}], ";"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"f", "=", 
      RowBox[{
       RowBox[{"ToString", "[", "base", "]"}], "<>", 
       RowBox[{"DateString", "[", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Day\>\"", ",", "\"\<MonthNameShort\>\"", ",", 
          "\"\<YearShort\>\"", ",", "\"\<-\>\"", ",", "\"\<Hour24\>\"", ",", 
          "\"\<Minute\>\""}], "}"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"f1", "=", "f"}], ";", 
     RowBox[{"i", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"FileExistsQ", "[", "f1", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"i", "=", 
         RowBox[{"i", "+", "1"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"f1", "=", 
         RowBox[{"f", "<>", "\"\<-\>\"", "<>", 
          RowBox[{"ToString", "[", "i", "]"}]}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"CreateDirectory", "[", "f1", "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"Return", "[", "f1", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.547558669742971*^9, 3.5475587697627087`*^9}, 
   3.5475610725404654`*^9, {3.55674553298297*^9, 
   3.5567455655674*^9}},ExpressionUUID->"32a06456-c30e-444d-81ad-\
1660d6c3dfe6"]
}, Closed]],

Cell[CellGroupData[{

Cell["UniqueFileName", "Subsection",
 CellChangeTimes->{{3.547500021513011*^9, 
  3.547500027168417*^9}},ExpressionUUID->"0733a711-7d14-456f-84ba-\
1cff0d3d2973"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"UniqueFileName", "[", 
    RowBox[{"folder_", ",", "base_", ",", "extension_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"f", ",", "f1", ",", "i", ",", "b"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"b", "=", "base"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"f", "=", 
       RowBox[{"ToFileName", "[", 
        RowBox[{"folder", ",", " ", "base"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"i", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"f1", "=", " ", 
       RowBox[{"f", "<>", "\"\<.\>\"", "<>", "extension"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"FileExistsQ", "[", "f1", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"i", "=", 
          RowBox[{"i", "+", "1"}]}], ";", " ", "\[IndentingNewLine]", 
         RowBox[{"f1", "=", 
          RowBox[{"f", "+", 
           RowBox[{
            RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<.\>\"", "<>", 
            "extension"}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "f1"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TimedUniqueFileName", "[", 
    RowBox[{"folder_", ",", "base_", ",", "extension_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"b", ",", "d"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"d", "=", 
       RowBox[{"hhmmss", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"b", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"StringLength", "[", "base", "]"}], ">", "0"}], ",", 
         RowBox[{"base", "<>", "\"\<-\>\"", "<>", "d"}], ",", "d"}], "]"}]}], 
      ";", " ", "\[IndentingNewLine]", 
      RowBox[{"UniqueFileName", "[", 
       RowBox[{"folder", ",", "b", ",", "extension"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UniqueFileName", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Expecting UniqueFileName[folder,base,extension], not \
UniqueFileName[\>\"", ",", "x", ",", "\"\<]\>\""}], "]"}], ";", " ", 
      RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";"}], 
  " "}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.547500028163148*^9, 3.5475002516990232`*^9}, {
  3.547500314231168*^9, 3.547500372339744*^9}, {3.547500403326476*^9, 
  3.547500514119423*^9}, {3.5585486090608397`*^9, 
  3.558548657239266*^9}},ExpressionUUID->"4adebb37-27fa-4045-be10-\
3980cebd21bc"]
}, Closed]],

Cell[CellGroupData[{

Cell["Intersects", "Subsection",
 CellChangeTimes->{{3.54765645102567*^9, 
  3.5476564529293213`*^9}},ExpressionUUID->"562475cd-68b1-498a-834f-\
770cd1a09631"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Intersects", "[", 
     RowBox[{
      RowBox[{"A_", "?", "ListQ"}], ",", 
      RowBox[{"B_", "?", "ListQ"}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"Intersection", "[", 
       RowBox[{"A", ",", "B"}], "]"}], "]"}], ">", "0"}]}], ";"}], 
  "\n"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5476564591871853`*^9, 
  3.54765645918874*^9}},ExpressionUUID->"83b21852-0017-486c-9672-\
bdc0b4821135"]
}, Closed]],

Cell[CellGroupData[{

Cell["AbortIf", "Subsection",
 CellChangeTimes->{{3.557000497544787*^9, 
  3.55700049947114*^9}},ExpressionUUID->"2582523c-2952-4123-bcc2-\
f0bb635c0208"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AbortIf", "[", 
     RowBox[{"flag_", ",", " ", "message_"}], "]"}], ":=", " ", 
    RowBox[{"If", "[", 
     RowBox[{"flag", ",", " ", 
      RowBox[{
       RowBox[{"Print", "[", "message", "]"}], ";", 
       RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], ";"}], " "}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"d2da5ecc-ddc2-4ee7-aeec-cd954136d1d9"]
}, Closed]],

Cell[CellGroupData[{

Cell["IntervalCheck", "Subsection",
 CellChangeTimes->{{3.5594187583960457`*^9, 
  3.559418760380459*^9}},ExpressionUUID->"1d4d03f8-83c7-4b2d-aee5-\
0e11e5e5ca24"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IntervalCheck", "[", 
     RowBox[{"x_", ",", " ", "All"}], "]"}], ":=", " ", "True"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IntervalCheck", "[", 
    RowBox[{"x_", ",", " ", 
     RowBox[{"{", 
      RowBox[{"xmin_", ",", "xmax_"}], "}"}]}], "]"}], ":=", " ", 
   RowBox[{"IntervalMemberQ", "[", 
    RowBox[{
     RowBox[{"Interval", "[", 
      RowBox[{"{", 
       RowBox[{"xmax", ",", "xmin"}], "}"}], "]"}], ",", " ", "x"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IntervalCheck", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_"}], "}"}], ",", " ", "xrange_", ",", "yrange_"}],
     "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"xok", ",", "yok", ",", "zok"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"xok", " ", "=", " ", 
       RowBox[{"IntervalCheck", "[", 
        RowBox[{"x", ",", " ", "xrange"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"yok", "=", 
       RowBox[{"IntervalCheck", "[", 
        RowBox[{"y", ",", " ", "yrange"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"And", "[", 
       RowBox[{"xok", ",", "yok"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IntervalCheck", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", " ", "xrange_", ",", 
    "yrange_", ",", "zrange_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"xok", ",", "yok", ",", "zok"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"xok", " ", "=", " ", 
      RowBox[{"IntervalCheck", "[", 
       RowBox[{"x", ",", " ", "xrange"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"yok", "=", 
      RowBox[{"IntervalCheck", "[", 
       RowBox[{"y", ",", " ", "yrange"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"zok", " ", "=", " ", 
      RowBox[{"IntervalCheck", "[", 
       RowBox[{"z", ",", "zrange"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"And", "[", 
      RowBox[{"xok", ",", "yok", ",", "zok"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.559418761324051*^9, 
  3.559419029509966*^9}},ExpressionUUID->"fc08534e-88ef-4e6c-ac0f-\
b347a64a4f36"]
}, Closed]],

Cell[CellGroupData[{

Cell["BellCurve", "Subsection",
 CellChangeTimes->{{3.574083884965684*^9, 
  3.574083886149455*^9}},ExpressionUUID->"5d75aeba-c7ad-4f34-87ac-\
5a28a405d4f0"],

Cell["\<\
Returns a pure function shaped like a gaussian, with a maximum value of max. 

to invoke call BellCuve[max, {mux,muy}, {sx, xy}][xval,yval]\
\>", "Text",
 CellChangeTimes->{{3.574084336138885*^9, 
  3.574084388529916*^9}},ExpressionUUID->"07ace70e-37e2-42b4-af9b-\
61eb6cbcc084"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BellCurve", "[", 
    RowBox[{"max_", ",", " ", 
     RowBox[{"{", 
      RowBox[{"mux_", ",", "muy_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"sigmax_", ",", "sigmay_"}], "}"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "m", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"m", "=", 
       RowBox[{"(", 
        RowBox[{"2.0", "*", "Pi", "*", "sigmax", "*", "sigmay"}], ")"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"max", "*", "m"}], ")"}], "*", 
        RowBox[{"PDF", "[", 
         RowBox[{
          RowBox[{"BinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"mux", ",", "muy"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"sigmax", ",", "sigmay"}], "}"}], ",", " ", "0"}], "]"}],
           ",", " ", 
          RowBox[{"{", 
           RowBox[{"#1", ",", "#2"}], "}"}]}], "]"}]}], "&"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BellCurve", "[", 
     RowBox[{"max_", ",", " ", "mu_", ",", " ", "sigma_"}], "]"}], ":=", " ", 
    
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "m", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"m", "=", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"2.0", "*", "Pi"}], "]"}], "*", "sigma"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"m", "*", "max", "*", 
         RowBox[{
          RowBox[{"PDF", "[", 
           RowBox[{"NormalDistribution", "[", 
            RowBox[{"mu", ",", "sigma"}], "]"}], "]"}], "[", "#", "]"}]}], 
        "&"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.574083886968689*^9, 3.5740839891700993`*^9}, {
  3.574084045875996*^9, 3.5740840479478683`*^9}, {3.574084126499125*^9, 
  3.5740841307149773`*^9}, {3.574084200714291*^9, 3.574084282796215*^9}, {
  3.574084948134959*^9, 3.574085012104341*^9}, {3.574085091956321*^9, 
  3.574085118991229*^9}},ExpressionUUID->"d4e0c8af-39ce-42d6-88ba-\
56b4aeb8897d"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Vectors", "Section",
 CellChangeTimes->{{3.446839017897811*^9, 3.446839020818054*^9}, {
  3.448505313030313*^9, 
  3.448505313892901*^9}},ExpressionUUID->"65920b74-659a-45a1-a367-\
0fce37e4b369"],

Cell[CellGroupData[{

Cell["distance", "Subsection",
 CellChangeTimes->{{3.446839029957945*^9, 
  3.446839031217324*^9}},ExpressionUUID->"2f89121c-84ff-4294-8024-\
c90570bdd9ee"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"distance", "[", 
    RowBox[{
     RowBox[{"v1_", "?", "ListQ"}], ",", 
     RowBox[{"v2_", "?", "ListQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v", ",", "nv1", ",", "nv2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nv1", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"Norm", "[", "v1", "]"}], "]"}], "\[Equal]", 
         "\[Infinity]"}], ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nv2", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"Norm", "[", "v2", "]"}], "]"}], "\[Equal]", 
         "\[Infinity]"}], ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"nv1", " ", "\[And]", "nv2"}], ",", " ", 
        RowBox[{"Return", "[", "Indeterminate", "]"}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"nv1", "\[Or]", "nv2"}], ",", " ", 
        RowBox[{"Return", "[", "\[Infinity]", "]"}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{"v1", "-", "v2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"v", ".", "v"}], "]"}], "]"}], ";"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.547304876868088*^9, 
  3.547304997741084*^9}},ExpressionUUID->"30dba2af-d11f-4410-8e8a-\
60eab52ae770"]
}, Closed]],

Cell[CellGroupData[{

Cell["Vector", "Subsection",
 CellChangeTimes->{{3.446851905430449*^9, 
  3.446851906198315*^9}},ExpressionUUID->"dd5cdea7-ad2f-4e94-9b07-\
6a1d0fc20aaa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Vector", "[", 
     RowBox[{
      RowBox[{"from_", "?", "PointQ"}], ",", " ", 
      RowBox[{"to_", "?", "PointQ"}]}], "]"}], ":=", " ", 
    RowBox[{"to", "-", "from"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Vector", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"from_", "?", "PointQ"}], ",", " ", 
      RowBox[{"to_", "?", "PointQ"}]}], "}"}], "]"}], ":=", " ", 
   RowBox[{"to", "-", "from"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.44685190197853*^9, 
  3.446851976322486*^9}},ExpressionUUID->"efb96ded-e14b-4717-902d-\
84b1631275ac"]
}, Open  ]],

Cell[CellGroupData[{

Cell["unitVector", "Subsection",
 CellChangeTimes->{{3.446839049549381*^9, 
  3.446839050781061*^9}},ExpressionUUID->"151bf860-fc85-41cd-b0ff-\
107dff72380a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"unitVector", "[", 
    RowBox[{
     RowBox[{"v1_", "?", "ListQ"}], ",", 
     RowBox[{"v2_", "?", "ListQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v", ",", "d"}], "}"}], ",", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"v1", "\[Equal]", "v2"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{"v1", "-", "v2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"distance", "[", 
        RowBox[{"v1", ",", "v2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{"v", "/", "d"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "v", "]"}], ";"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.446839046137644*^9, 
  3.446839047047435*^9}},ExpressionUUID->"d344e6f4-b739-469e-9256-\
3487b3f96a80"]
}, Closed]],

Cell[CellGroupData[{

Cell["Points, Edges", "Subsection",
 CellChangeTimes->{{3.446839116815683*^9, 3.446839117452589*^9}, {
  3.446841244080963*^9, 
  3.446841244809108*^9}},ExpressionUUID->"13e2db22-daed-4527-87bf-\
6457dcc7051b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PointQ", "[", 
    RowBox[{"{", 
     RowBox[{"x_Symbol", ",", "y_Symbol"}], "}"}], "]"}], ":=", "True"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"PointQ", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x_", "[", "t_", "]"}], ",", " ", 
      RowBox[{"y_", "[", "t_", "]"}]}], "}"}], "]"}], ":=", " ", "True"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PointQ", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"x_", "[", "i_", "]"}], "[", "t_", "]"}], ",", " ", 
      RowBox[{
       RowBox[{"y_", "[", "i_", "]"}], "[", "t_", "]"}]}], "}"}], "]"}], ":=",
    " ", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PointQ", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x_", "?", "NumericQ"}], ",", " ", 
       RowBox[{"y_", "?", "NumericQ"}]}], "}"}], "]"}], ":=", " ", "True"}], 
   ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PointQ", "[", "x___", "]"}], ":=", "False"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NumericPointQ", "[", "u___", "]"}], ":=", " ", 
    RowBox[{"numPairQ", "[", "u", "]"}]}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PointListQ", "[", 
    RowBox[{"{", 
     RowBox[{"p__", "?", "PointQ"}], "}"}], "]"}], ":=", " ", "True"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PointListQ", "[", "x___", "]"}], ":=", " ", "False"}], ";"}], 
  " ", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CZEdgeQ", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"p1_", "?", "PointQ"}], ",", " ", 
      RowBox[{"p2_", "?", "PointQ"}]}], "}"}], "]"}], ":=", " ", "True"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CZEdgeQ", "[", "x___", "]"}], ":=", " ", "False"}], ";"}], 
  " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.446839126459106*^9, 3.446839130994662*^9}, {
  3.44684125052585*^9, 3.446841284180578*^9}, {3.446841359291948*^9, 
  3.446841390529028*^9}, {3.448482197368036*^9, 3.448482232337626*^9}, {
  3.455126380025221*^9, 3.455126395540772*^9}, {3.455146831169072*^9, 
  3.455146849468646*^9}, {3.49046030133383*^9, 3.490460304664567*^9}, {
  3.490463857529841*^9, 3.490463923782206*^9}, {3.490463960431232*^9, 
  3.490463987548519*^9}, {3.507576190471627*^9, 3.507576194899815*^9}, {
  3.5590858596352873`*^9, 
  3.559085908116485*^9}},ExpressionUUID->"4be517c8-d3d6-4bf8-9b74-\
cd670f8a4f95"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Points2Edges", "Subsection",
 CellChangeTimes->{{3.44684444502502*^9, 
  3.446844446890032*^9}},ExpressionUUID->"e6259a53-6769-4f6b-9969-\
2cc823641ca4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Points2Edges", "[", 
   RowBox[{"{", 
    RowBox[{"points__", "?", "PointQ"}], "}"}], "]"}], ":=", " ", 
  RowBox[{"Partition", "[", 
   RowBox[{
    RowBox[{"{", "points", "}"}], ",", " ", "2", ",", " ", "1", ",", "1"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.446844447813362*^9, 3.446844481403044*^9}, {
  3.446844517124511*^9, 
  3.446844519776596*^9}},ExpressionUUID->"83eae8a8-62fc-45b0-84c5-\
6abd056372ef"]
}, Closed]],

Cell[CellGroupData[{

Cell["PointOnLineSegment", "Subsection",
 CellChangeTimes->{{3.451056875412595*^9, 
  3.451056878484357*^9}},ExpressionUUID->"b027c45c-52c1-4d62-9c73-\
ad49d5ac2465"],

Cell["\<\
2.1.\[Alpha].4 change tolerance from absolute to fraction of length of \
segment
2.1.\[Alpha].4 fix bug in calculating ymin\
\>", "Text",
 CellChangeTimes->{{3.456688570733632*^9, 3.456688585341053*^9}, {
  3.456691122021778*^9, 
  3.4566911323184767`*^9}},ExpressionUUID->"73b86e53-3173-4c60-af12-\
8ba75b6e0d6c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PointOnLineSegment", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x1_", ",", " ", "y1_"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"x2_", ",", " ", "y2_"}], "}"}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"p_", ",", " ", "q_"}], "}"}], ",", " ", 
      RowBox[{"tol_:", "0.00001"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "tolerance", ",", "x", ",", "y", ",", " ", "xmin", ",", " ", "xmax", 
        ",", " ", "ymin", ",", " ", "ymax", ",", " ", "tx", ",", " ", "ty", 
        ",", " ", "segLen"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"segLen", " ", "=", " ", 
        RowBox[{"distance", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x1", ",", "y1"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"x2", ",", "y2"}], "}"}]}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"tolerance", "=", 
        RowBox[{
         RowBox[{"Max", "[", 
          RowBox[{"tol", ",", " ", "0"}], "]"}], "*", "segLen"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"xmin", "=", 
        RowBox[{"Min", "[", 
         RowBox[{"x1", ",", "x2"}], "]"}]}], ";", " ", 
       RowBox[{"xmax", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"x1", ",", "x2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ymin", " ", "=", " ", 
        RowBox[{"Min", "[", 
         RowBox[{"y1", ",", "y2"}], "]"}]}], ";", " ", 
       RowBox[{"ymax", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"y1", ",", " ", "y2"}], "]"}]}], ";", "   ", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"y1", "\[Equal]", "y2"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"y", "=", "y1"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"q", "-", "y"}], "]"}], "\[LessEqual]", " ", 
              "tolerance"}], ")"}], "\[And]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"xmin", "-", "tolerance"}], "\[LessEqual]", " ", "p"}], 
             ")"}], " ", "\[And]", " ", 
            RowBox[{"(", 
             RowBox[{"p", "\[LessEqual]", " ", 
              RowBox[{"xmax", "+", "tolerance"}]}], ")"}]}], "]"}], ";"}]}], 
        " ", "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"x1", "\[Equal]", "x2"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<x1=x2\>\"", "]"}], ";"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"x", "=", "x1"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"{", 
              RowBox[{"tolerance", ",", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{"p", "-", "x"}], "]"}], "\[LessEqual]", " ", 
                 "tolerance"}], ")"}], " ", ",", "p", ",", "x", ",", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"ymin", "-", "tolerance"}], "\[LessEqual]", " ", 
                 "q"}], ")"}], " ", ",", "ymin", ",", " ", "q", ",", "ymax", 
               ",", " ", 
               RowBox[{"(", 
                RowBox[{"q", "\[LessEqual]", " ", 
                 RowBox[{"ymax", "+", "tolerance"}]}], ")"}]}], "}"}], "]"}], 
            ";"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
          
          RowBox[{"Return", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"p", "-", "x"}], "]"}], "\[LessEqual]", " ", 
              "tolerance"}], ")"}], " ", "\[And]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"ymin", "-", "tolerance"}], "\[LessEqual]", " ", "q"}], 
             ")"}], " ", "\[And]", " ", 
            RowBox[{"(", 
             RowBox[{"q", "\[LessEqual]", " ", 
              RowBox[{"ymax", "+", "tolerance"}]}], ")"}]}], "]"}], ";"}]}], 
        " ", "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
       " ", "\[IndentingNewLine]", 
       RowBox[{"tx", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"p", "-", "x1"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"x2", "-", "x1"}], ")"}]}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"ty", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"q", "-", "y1"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"y2", "-", "y1"}], ")"}]}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"tx", "-", "ty"}], "]"}], "\[LessEqual]", " ", 
         "tolerance"}], "]"}], ";"}]}], " ", "\[IndentingNewLine]", "]"}]}], 
   ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PointOnLineSegment", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Expecting PointOnLineSegment[{{x1,y1}, {x2,y2}}, {xp,yp}, \
tolerance]\>\"", "]"}], ";", " ", "$Failed"}], ")"}]}], ";"}], 
  " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.451056880671523*^9, 3.451056917575962*^9}, {
  3.45105696768223*^9, 3.451057414599799*^9}, {3.451057508555138*^9, 
  3.451057560993976*^9}, {3.451057607322576*^9, 3.451057609742481*^9}, {
  3.451057706099489*^9, 3.451057718334607*^9}, {3.456688592510591*^9, 
  3.456688650039208*^9}, {3.456690696628809*^9, 3.456690701019785*^9}, {
  3.456690747535981*^9, 3.456690778844902*^9}, {3.456690821242992*^9, 
  3.456690841019973*^9}, {3.4566910739006567`*^9, 
  3.45669110604324*^9}},ExpressionUUID->"1114850e-7fd8-4b1b-aace-\
c97a0e34bb2b"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Graphics", "Section",
 CellChangeTimes->{{3.446852134642721*^9, 3.44685213561616*^9}, 
   3.448486658559607*^9},ExpressionUUID->"b261906f-67c2-4a68-81e1-\
eaa327454fbe"],

Cell[CellGroupData[{

Cell["Boundary", "Subsection",
 CellChangeTimes->{{3.44685506539389*^9, 
  3.446855074395809*^9}},ExpressionUUID->"a5e0e0b8-ac98-458d-a60c-\
75e578c804b8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Boundary", "[", 
     RowBox[{"{", 
      RowBox[{"points__", "?", "PointQ"}], "}"}], "]"}], ":=", " ", 
    RowBox[{"Boundary", "[", 
     RowBox[{
      RowBox[{"{", "points", "}"}], ",", " ", 
      RowBox[{"{", "}"}]}], "]"}]}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Boundary", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"points__", "?", "PointQ"}], "}"}], ",", " ", 
    RowBox[{"{", "dir___", "}"}], ",", " ", 
    RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "g", "}"}], ",", " ", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"g", "=", 
      RowBox[{"Line", "[", 
       RowBox[{"Append", "[", 
        RowBox[{
         RowBox[{"{", "points", "}"}], ",", " ", 
         RowBox[{"First", "[", 
          RowBox[{"{", "points", "}"}], "]"}]}], "]"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"{", "dir", "}"}], "]"}], ">", "0"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"g", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Directive", "@@", 
           RowBox[{"{", "dir", "}"}]}], ",", " ", "g"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"g", "=", 
        RowBox[{"{", "g", "}"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"g", "=", 
      RowBox[{"Graphics", "[", 
       RowBox[{"g", ",", " ", "opt"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "g", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.446852141696427*^9, 3.446852145582772*^9}, {
   3.446852187983159*^9, 3.446852224397597*^9}, {3.446852301018129*^9, 
   3.446852405225401*^9}, {3.446852446873285*^9, 3.446852541773109*^9}, {
   3.446907143355713*^9, 3.446907161562105*^9}, {3.446907284376292*^9, 
   3.446907290766434*^9}, 
   3.446907323778108*^9},ExpressionUUID->"e691472c-112e-4b2d-a193-\
5d203ff04bcc"]
}, Closed]],

Cell[CellGroupData[{

Cell["DrawSpokes", "Subsection",
 CellChangeTimes->{{3.446855078433957*^9, 
  3.446855082173516*^9}},ExpressionUUID->"f6213cc8-9581-4f3e-96b2-\
c681dfce95e9"],

Cell["\<\
DrawSpokes is used by the division model which is currently suppressed.\
\>", "Text",
 CellChangeTimes->{{3.4549603771869717`*^9, 
  3.454960392983035*^9}},ExpressionUUID->"72b93a44-9106-41b1-b869-\
f623f6203838"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DrawSpokes", "[", 
   RowBox[{"SpokeData_", ",", " ", 
    RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "g", ",", " ", "ep", ",", " ", "angles", ",", " ", "vectors", ",", " ", 
      "pointstyle", ",", " ", "spokestyle", ",", " ", "points", ",", " ", 
      "number", ",", " ", "numbers", " ", ",", " ", "np", ",", " ", "origin", 
      ",", " ", "textcolor", ",", " ", "textstyle", ",", " ", "offset"}], 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ep", "=", 
      RowBox[{"\"\<Endpoints\>\"", "/.", "SpokeData"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"vectors", "=", 
      RowBox[{"\"\<Spokes\>\"", "/.", "SpokeData"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"angles", "=", 
      RowBox[{"\"\<Angles\>\"", "/.", "SpokeData"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"origin", "=", 
      RowBox[{"\"\<Origin\>\"", "/.", "SpokeData"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"spokestyle", "=", 
      RowBox[{
       RowBox[{"\"\<SpokeStyle\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<SpokeStyle\>\"", "\[Rule]", " ", 
         RowBox[{"{", 
          RowBox[{"Thin", ",", " ", "Blue", ",", " ", "Dotted"}], "}"}]}], 
        "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"pointstyle", "=", 
      RowBox[{
       RowBox[{"\"\<PointStyle\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<PointStyle\>\"", "\[Rule]", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"PointSize", "[", ".015", "]"}], ",", " ", "Red"}], 
          "}"}]}], "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"number", "=", 
      RowBox[{
       RowBox[{"\"\<Numbers\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<Number\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";", 
     " ", "\[IndentingNewLine]", 
     RowBox[{"offset", " ", "=", " ", 
      RowBox[{
       RowBox[{"\"\<Offset\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<Offset\>\"", "\[Rule]", " ", ".1"}], "}"}]}]}], ";", " ",
      "\[IndentingNewLine]", 
     RowBox[{"textcolor", "=", 
      RowBox[{
       RowBox[{"\"\<TextColor\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<TextColor\>\"", "\[Rule]", " ", "Black"}], "}"}]}]}], 
     ";", " ", "\[IndentingNewLine]", 
     RowBox[{"textstyle", "=", 
      RowBox[{
       RowBox[{"\"\<TextStyle\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<TextStyle\>\"", "\[Rule]", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"FontFamily", "\[Rule]", " ", "\"\<Times\>\""}], ",", " ", 
           
           RowBox[{"FontSize", "\[Rule]", " ", "16"}]}], "}"}]}], "}"}]}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"g", " ", "=", " ", 
      RowBox[{"Line", "/@", "vectors"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"spokestyle", "=", 
      RowBox[{"Directive", "@@", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", "spokestyle", "}"}], "]"}]}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"g", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"{", 
        RowBox[{"spokestyle", ",", " ", "g"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"points", " ", "=", " ", 
      RowBox[{"Point", "/@", "ep"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pointstyle", "=", " ", 
      RowBox[{"Directive", "@@", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", "pointstyle", "}"}], "]"}]}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"g", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"{", 
        RowBox[{"g", ",", " ", "pointstyle", ",", " ", "points"}], "}"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"number", ",", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"numbers", "=", 
         RowBox[{"ToString", "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "ep", "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"vectors", " ", "=", " ", 
         RowBox[{"Vector", "/@", "vectors"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"np", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                FractionBox["offset", 
                 RowBox[{"Norm", "[", "#", "]"}]]}], ")"}]}], "+", "origin"}],
             ")"}], "&"}], "/@", "vectors"}]}], ";", " ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"numbers", " ", "=", " ", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Text", ",", " ", 
           RowBox[{"{", 
            RowBox[{"numbers", ",", " ", "np"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"g", "=", " ", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{"g", ",", "textcolor", ",", "  ", "numbers"}], "}"}], 
          "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"g", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"{", 
        RowBox[{"g", ",", " ", 
         RowBox[{"BaseStyle", "\[Rule]", " ", "textstyle"}]}], "}"}], "]"}]}],
      ";", " ", "\[IndentingNewLine]", " ", 
     RowBox[{"Return", "[", "g", "]"}], ";"}]}], " ", "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.446855083471903*^9, 3.446855294188427*^9}, {
   3.446855337685351*^9, 3.446855486703989*^9}, {3.446855516881006*^9, 
   3.446855570215077*^9}, {3.446855701743728*^9, 3.446855729612434*^9}, {
   3.446855764936284*^9, 3.446855891135344*^9}, {3.446855923518124*^9, 
   3.446856048111923*^9}, {3.446856148489527*^9, 3.446856166063101*^9}, {
   3.446856489029863*^9, 3.446856597525986*^9}, 3.446856792089742*^9, {
   3.447187888617782*^9, 
   3.447187889477321*^9}},ExpressionUUID->"ceaa73c1-3a30-4997-abbe-\
a1fd8b24cab9"]
}, Closed]],

Cell[CellGroupData[{

Cell["ShowTissue", "Subsection",
 CellChangeTimes->{{3.448484174632155*^9, 
  3.448484175911521*^9}},ExpressionUUID->"4d6ac615-8d34-4319-96b5-\
56ffe2392500"],

Cell["\<\
Options:
\t\"CellStyles\" --> List of cell colors or Automatic
\t\"BoundaryStyle\"-->Color, thickness of walls (automatic)
\t\"CellNumbers\" --> List of numbers to label cells with (or True/False)
\t\"NumberStyle\" --> Text style directives for cell numbers
\t\"Vertices\"-->{} or False/True or style parameters for vertices, e.g., \
color, PointSize
\t\"VertexNumbers\"->{}or False/True  or style parameeters to print numbers
\t\"EdgeNumbers\"->{} or False/True or  style parameters to print numbers
\t\[OpenCurlyDoubleQuote]EdgeCellPairs\[CloseCurlyDoubleQuote]->{{Cell,Edge, \
Style}, {Cell, Edge, Style}, ...} or {} for edge styles.
\t\"DanglingEdges\"-> False
\t\[OpenCurlyDoubleQuote]Outer\[CloseCurlyDoubleQuote]->None
\t\[OpenCurlyDoubleQuote]Dome\[CloseCurlyDoubleQuote]->False
\t\"
\t
Extensively modified v 2.2.8 to allow Boundaries between cells to be labeled \
as X[cell-number, edge-number] 
\
\>", "Text",
 CellChangeTimes->{{3.449009358566766*^9, 3.449009521438282*^9}, {
   3.451740913882516*^9, 3.4517409166891108`*^9}, {3.454947691548765*^9, 
   3.454947695873035*^9}, {3.4565907790602627`*^9, 3.456590780288207*^9}, {
   3.4565909128027*^9, 3.456590913673601*^9}, {3.456598286705696*^9, 
   3.4565983166135283`*^9}, {3.456771933615519*^9, 3.456771941780696*^9}, {
   3.512218356169771*^9, 3.512218363777718*^9}, {3.544744296613027*^9, 
   3.544744376192689*^9}, {3.549134928164482*^9, 3.54913493238374*^9}, 
   3.558991471049614*^9},ExpressionUUID->"f95607c4-cd61-4ce1-898e-\
92a6ce13ea13"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ShowTissue", "[", 
   RowBox[{
    RowBox[{"tissue_", "?", "DTissueQ"}], ",", 
    RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "cellnumbers", ",", "T", ",", "g", ",", "c", ",", "toDynamicNumberRules",
       ",", "toStaticNumberRules"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cellnumbers", "=", 
      RowBox[{
       RowBox[{"\"\<CellNumbers\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<CellNumbers\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], 
     ";", " ", "\[IndentingNewLine]", 
     RowBox[{"T", "=", 
      RowBox[{"DTissue2Tissue", "[", "tissue", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"First", "/@", 
       RowBox[{"TissueCells", "[", "tissue", "]"}]}]}], ";", " ", 
     RowBox[{"toDynamicNumberRules", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{"Rule", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "c", "]"}], "]"}], ",", "c"}], "}"}]}], 
       "]"}]}], ";", 
     RowBox[{"toStaticNumberRules", "=", 
      RowBox[{"Reverse", "/@", "toDynamicNumberRules"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"cellnumbers", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cellnumbers", "=", 
         RowBox[{"First", "/@", 
          RowBox[{"TissueCells", "[", "tissue", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"g", "=", 
         RowBox[{"ShowTissue", "[", 
          RowBox[{"T", ",", 
           RowBox[{"\"\<CellNumbers\>\"", "\[Rule]", " ", "cellnumbers"}], 
           ",", " ", 
           RowBox[{
           "\"\<ToDynamic\>\"", "\[Rule]", " ", "toDynamicNumberRules"}], ",", 
           RowBox[{
           "\"\<ToStatic\>\"", "\[Rule]", " ", "toStaticNumberRules"}], ",", 
           " ", "opt"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "g", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"ShowTissue", "[", 
      RowBox[{"T", ",", 
       RowBox[{"\"\<ToDynamic\>\"", "\[Rule]", " ", "toDynamicNumberRules"}], 
       ",", 
       RowBox[{"\"\<ToStatic\>\"", "\[Rule]", " ", "toStaticNumberRules"}], 
       ",", "opt"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.546086725069508*^9, 3.546086740217008*^9}, {
  3.546086916692697*^9, 3.546087091866757*^9}, {3.546087142330513*^9, 
  3.546087180199645*^9}, {3.546171941975738*^9, 3.54617194259969*^9}, {
  3.547216467650783*^9, 3.547216572960929*^9}, {3.547216797348875*^9, 
  3.547216895839045*^9}},ExpressionUUID->"8cad2cb5-996b-4d8e-95da-\
e6f145649424"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ShowTissue", "[", 
   RowBox[{
    RowBox[{"tissue_", "?", "TissueQ"}], ",", " ", 
    RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "cellstyles", ",", " ", "n", ",", " ", "nv", ",", " ", "ne", ",", 
      "cells", ",", " ", "boundarystyle", ",", " ", "cellnumbers", ",", 
      "vertexnumbers", ",", "vnstyle", ",", "vertexstyle", ",", "numberstyle",
       ",", " ", "gvertex", ",", " ", "gedgenums", ",", "edgenumbers", ",", 
      " ", "edgenumberstyle", ",", " ", "danglingEdges", ",", " ", "deg", ",",
       " ", "gdir", ",", " ", "outer", ",", " ", "picture", ",", " ", 
      "edgestyles", ",", " ", "firststyle", ",", " ", "nuclear", ",", " ", 
      "gBoundary", ",", "vertexnumberstyle", ",", "\[IndentingNewLine]", 
      "poly", ",", " ", "polys", ",", " ", "v", ",", " ", "e", ",", " ", 
      "starts", ",", " ", "ends", ",", "vers", ",", " ", "edges", ",", " ", 
      "line", ",", " ", "edgecellpairs", ",", " ", "centroids", ",", " ", 
      "gedges", ",", " ", "cc", ",", "ee", ",", "st", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"DefaultEDGECCOLOR", "=", "Black"}], ",", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"DefaultCELLCOLOR", "=", "LightGreen"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"DefaultBORDERCOLOR", "=", "Brown"}], ",", 
      "\[IndentingNewLine]", "dbg", ",", "dPrint", ",", " ", "all", ",", 
      "vflags", ",", "eflags", ",", "eused", ",", "vused", ",", "toStatic", 
      ",", "toDynamic", ",", " ", "dome", ",", " ", "flat", ",", " ", 
      "\[IndentingNewLine]", "xrange", ",", " ", "yrange", ",", "vertices", 
      ",", " ", "cell1"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dbg", " ", "=", " ", 
      RowBox[{
       RowBox[{"\"\<DebugShowTissue\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<DebugShowTissue\>\"", "\[Rule]", "False"}], "}"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dPrint", "[", "x___", "]"}], ":=", " ", 
      RowBox[{"If", "[", 
       RowBox[{"dbg", ",", " ", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<ShowTissue: \>\"", ",", "x"}], "]"}]}], "]"}]}], ";", 
     " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"dome", " ", "=", " ", 
      RowBox[{
       RowBox[{"\"\<Dome\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<Dome\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";", 
     " ", "\[IndentingNewLine]", 
     RowBox[{"flat", " ", "=", " ", 
      RowBox[{"Not", "[", "dome", "]"}]}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"xrange", "=", 
      RowBox[{
       RowBox[{"\"\<xrange\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<xrange\>\"", "\[Rule]", " ", "All"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"yrange", "=", 
      RowBox[{
       RowBox[{"\"\<yrange\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<yrange\>\"", "\[Rule]", " ", "All"}], "}"}]}]}], ";", 
     " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"cells", "=", 
      RowBox[{"CellVertexCoordinates", "[", "tissue", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "cells", "]"}], "<", "1"}], ",", " ", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<No Cells\>\"", "]"}], ";", " ", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"cell1", "=", 
      RowBox[{"cells", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"cell1", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], ">", "2"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"ShowZProjection", "[", 
         RowBox[{"tissue", ",", " ", "opt"}], "]"}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"centroids", " ", "=", " ", 
      RowBox[{"Centroid", "[", "tissue", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<options: \>\"", ",", 
       RowBox[{"{", "opt", "}"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"toStatic", " ", "=", " ", 
      RowBox[{
       RowBox[{"\"\<ToStatic\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<ToStatic\>\"", "\[Rule]", " ", 
         RowBox[{"{", "}"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"toDynamic", " ", "=", " ", 
      RowBox[{
       RowBox[{"\"\<ToDynamic\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<ToDynamic\>\"", "\[Rule]", " ", 
         RowBox[{"{", "}"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"cells", ",", " ", "$Failed"}], "]"}], ",", " ", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<Warning: ShowTissue: unable to plot some cells becasue of \
inconsistent data.\>\"", "]"}], ";"}]}], " ", "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "cells", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"*", " ", "cell", " ", "colors"}], " ", "**)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"cellstyles", "=", 
      RowBox[{
       RowBox[{"\"\<CellStyles\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<CellStyles\>\"", "\[Rule]", " ", 
         RowBox[{"Table", "[", 
          RowBox[{"Automatic", ",", " ", 
           RowBox[{"{", "n", "}"}]}], "]"}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"ListQ", "[", "cellstyles", "]"}]}], ",", " ", 
       RowBox[{"cellstyles", "=", 
        RowBox[{"{", "cellstyles", "}"}]}]}], "]"}], ";", "  ", 
     "\[IndentingNewLine]", 
     RowBox[{"firststyle", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "cellstyles", "]"}], ">", "0"}], ",", 
        RowBox[{"Last", "[", "cellstyles", "]"}], ",", "Automatic"}], "]"}]}],
      ";", " ", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "cellstyles", "]"}], "\[NotEqual]", "  ", 
        "n"}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{"cellstyles", "=", 
        RowBox[{"PadRight", "[", 
         RowBox[{"cellstyles", ",", "n", ",", "  ", "firststyle"}], "]"}]}]}],
       "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<cellstyles: \>\"", ",", " ", 
       RowBox[{"Short", "[", 
        RowBox[{"cellstyles", ",", "10"}], "]"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"nuclear", " ", "=", " ", 
      RowBox[{
       RowBox[{"\"\<Nucleus\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<Nucleus\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";", 
     " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"nuclear", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{"{", "nuclear", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"firststyle", "=", 
      RowBox[{"Last", "[", "nuclear", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"nuclear", "=", 
      RowBox[{"PadRight", "[", 
       RowBox[{"nuclear", ",", "n", ",", "firststyle"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"boundarystyle", "=", 
      RowBox[{
       RowBox[{"\"\<BoundaryStyle\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<BoundaryStyle\>\"", "\[Rule]", " ", "Automatic"}], 
        "}"}]}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"flat", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"gBoundary", "=", 
         RowBox[{"ShowTissueBoundary", "[", 
          RowBox[{"tissue", ",", " ", "boundarystyle"}], "]"}]}], ";"}]}], 
      " ", "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"*", " ", "cell", " ", "boundary", " ", "and", " ", "labels"}], 
      " ", "**)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"cellnumbers", "=", 
      RowBox[{
       RowBox[{"\"\<CellNumbers\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<CellNumbers\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], 
     ";", " ", "\[IndentingNewLine]", 
     RowBox[{"numberstyle", "=", 
      RowBox[{
       RowBox[{"\"\<CellNumberStyle\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<CellNumberStyle\>\"", "\[Rule]", " ", "Automatic"}], 
        "}"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"cellnumbers", " ", "\[Equal]", " ", "True"}], ",", 
       RowBox[{"cellnumbers", "=", 
        RowBox[{"Range", "[", "n", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"cellnumbers", " ", "\[Equal]", " ", "False"}], ",", " ", 
       RowBox[{"cellnumbers", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"-", "1"}], ",", " ", 
          RowBox[{"{", "n", "}"}]}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"poly", "[", 
       RowBox[{
       "vers_", ",", " ", "color_", ",", " ", "number_", ",", "nuclear_"}], 
       "]"}], ":=", " ", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"c", ",", "x", ",", "num", ",", "ok"}], "}"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"c", "=", 
          RowBox[{"color", "/.", 
           RowBox[{"{", 
            RowBox[{"Automatic", "\[Rule]", " ", "DefaultCELLCOLOR"}], 
            "}"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"x", " ", "=", " ", 
          RowBox[{"Centroid", "[", "vers", "]"}]}], ";", "  ", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"number", ">", "0"}], ",", " ", 
           RowBox[{"num", "=", 
            RowBox[{"ToString", "[", "number", "]"}]}], ",", " ", 
           RowBox[{"num", "=", "\"\<\>\""}]}], "]"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"nuclear", ",", "\[IndentingNewLine]", 
           RowBox[{"Graphics", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Directive", "[", 
               RowBox[{"Flatten", "[", 
                RowBox[{"{", "c", "}"}], "]"}], "]"}], ",", " ", 
              RowBox[{"Point", "[", "x", "]"}], ",", "Black", ",", " ", 
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{"num", ",", 
                  RowBox[{"Directive", "[", 
                   RowBox[{"{", "numberstyle", "}"}], "]"}]}], "]"}], ",", 
                " ", "x"}], "]"}]}], "}"}], "]"}], "\[IndentingNewLine]", ",",
            "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ok", "=", 
             RowBox[{"Or", "@@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"IntervalCheck", "[", 
                  RowBox[{"#", ",", "xrange", ",", "yrange"}], "]"}], "&"}], "/@",
                 "vers"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{"ok", ",", "\[IndentingNewLine]", 
              RowBox[{"Graphics", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Directive", "[", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{"{", "c", "}"}], "]"}], "]"}], ",", " ", 
                 RowBox[{"Polygon", "[", "vers", "]"}], ",", "Black", ",", 
                 " ", 
                 RowBox[{"Text", "[", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{"num", ",", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"{", "numberstyle", "}"}], "]"}]}], "]"}], ",", 
                   " ", "x"}], "]"}]}], "}"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Graphics", "[", 
               RowBox[{"{", "}"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
          "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", "  ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"flat", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"polys", " ", "=", " ", 
         RowBox[{"Show", "[", 
          RowBox[{"MapThread", "[", 
           RowBox[{"poly", ",", " ", 
            RowBox[{"{", 
             RowBox[{
             "cells", ",", " ", "cellstyles", ",", " ", "cellnumbers", ",", 
              " ", "nuclear"}], "}"}]}], "]"}], "]"}]}], ";"}]}], " ", 
      "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"e", "=", 
      RowBox[{"TissueEdges", "[", "tissue", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ne", " ", "=", " ", 
      RowBox[{"NTissueEdges", "[", "tissue", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"v", "=", 
      RowBox[{"TissueVertices", "[", "tissue", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nv", "=", 
      RowBox[{"NTissueVertices", "[", "tissue", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "do", " ", "we", " ", "want", " ", "to", " ", "plot", " ", "ALL", " ", 
        "the", " ", "vertices", " ", "and", " ", "edges"}], ",", " ", 
       RowBox[{"or", " ", "just", " ", "the", " ", "ones", " ", "in", " ", 
        RowBox[{"CELLS", "?"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"all", " ", "=", " ", 
      RowBox[{
       RowBox[{"\"\<All\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<All\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";", " ",
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"all", ",", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"eflags", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{"True", ",", 
           RowBox[{"{", "ne", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vflags", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{"True", ",", " ", 
           RowBox[{"{", "nv", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"eused", "=", 
         RowBox[{"Range", "[", "ne", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vused", "=", 
         RowBox[{"Range", "[", "nv", "]"}]}], ";"}], " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       " ", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"eused", " ", "=", " ", 
         RowBox[{"EdgesUsed", "[", "tissue", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"vused", " ", "=", " ", 
         RowBox[{"VerticesUsed", "[", "tissue", "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"eflags", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"eused", ",", "#"}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", "ne", "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vflags", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"vused", ",", " ", "#"}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", "nv", "]"}]}]}], ";"}]}], " ", 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "*", " ", "label", " ", "the", " ", "edges", " ", "if", " ", 
       "requested"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"edgenumbers", " ", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", " ", 
          RowBox[{"\"\<EdgeNumbers\>\"", "/.", 
           RowBox[{"{", "opt", "}"}]}], ")"}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<EdgeNumbers\>\"", "\[Rule]", " ", "False"}], "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"False", "\[Rule]", 
          RowBox[{"Pick", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"-", "1"}], ",", " ", 
              RowBox[{"{", "ne", "}"}]}], "]"}], ",", "eflags"}], "]"}]}], 
         "}"}]}], ")"}]}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"edgestyles", "=", 
      RowBox[{
       RowBox[{"\"\<EdgeStyles\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<EdgeStyles\>\"", "\[Rule]", " ", 
         RowBox[{"Table", "[", 
          RowBox[{"Automatic", ",", " ", 
           RowBox[{"{", "ne", "}"}]}], "]"}]}], "}"}]}]}], ";", "  ", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"ListQ", "[", "edgestyles", "]"}]}], ",", " ", 
       RowBox[{"edgestyles", "=", 
        RowBox[{"{", "edgestyles", "}"}]}]}], "]"}], ";", "  ", 
     "\[IndentingNewLine]", 
     RowBox[{"firststyle", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "edgestyles", "]"}], ">", "0"}], ",", 
        RowBox[{"edgestyles", "//", "Last"}], ",", "Automatic"}], "]"}]}], 
     ";", " ", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "edgestyles", "]"}], "\[NotEqual]", "  ", 
        RowBox[{"Length", "[", "eused", "]"}]}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"edgestyles", "=", 
        RowBox[{"PadRight", "[", 
         RowBox[{"edgestyles", ",", "ne", ",", "  ", "firststyle"}], 
         "]"}]}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"edgestyles", " ", "=", " ", 
      RowBox[{"Pick", "[", 
       RowBox[{"edgestyles", ",", "eflags"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"edgenumberstyle", "=", " ", "Automatic"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"edgenumbers", ",", "  ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"edgenumbers", " ", "=", " ", 
         RowBox[{"Pick", "[", 
          RowBox[{
           RowBox[{"Range", "[", "ne", "]"}], ",", "eflags"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"edgenumberstyle", "=", 
         RowBox[{
          RowBox[{"\"\<EdgeNumberStyle\>\"", "/.", 
           RowBox[{"{", "opt", "}"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{"\"\<EdgeNumberStyle\>\"", "\[Rule]", " ", "Automatic"}], 
           "}"}]}]}], ";"}], "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"edgenumbers", "=", 
         RowBox[{"Pick", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"-", "1"}], ",", " ", 
             RowBox[{"{", "ne", "}"}]}], "]"}], ",", "eflags"}], "]"}]}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", " ", 
     "\[IndentingNewLine]", " ", "\[IndentingNewLine]", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"line", "[", 
       RowBox[{
       "v1_", ",", " ", "v2_", ",", "  ", "color_", ",", " ", "number_"}], 
       "]"}], ":=", " ", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"c", ",", "l", ",", "text", ",", "ok"}], "}"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"c", "=", 
          RowBox[{"color", "/.", 
           RowBox[{"{", 
            RowBox[{"Automatic", "\[Rule]", " ", "DefaultEDGECCOLOR"}], 
            "}"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"l", "=", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{"v1", ",", " ", "v2"}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"text", " ", "=", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"number", ">", "0"}], ",", " ", 
            RowBox[{"ToString", "[", "number", "]"}], ",", " ", "\"\<\>\""}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ToString", "[", "color", "]"}], "\[Equal]", 
            "\"\<None\>\""}], ",", "\[IndentingNewLine]", 
           RowBox[{"Graphics", "[", 
            RowBox[{"{", "}"}], "]"}], "\[IndentingNewLine]", ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ok", "=", 
             RowBox[{"Or", "@@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"IntervalCheck", "[", 
                  RowBox[{"#", ",", "xrange", ",", "yrange"}], "]"}], "&"}], "/@", 
                RowBox[{"{", 
                 RowBox[{"v1", ",", "v2"}], "}"}]}], ")"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{"ok", ",", " ", "\[IndentingNewLine]", 
              RowBox[{"Graphics", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Directive", "[", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{"{", "c", "}"}], "]"}], "]"}], ",", " ", "l", ",", 
                 " ", "Black", ",", " ", 
                 RowBox[{"Text", "[", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{"text", ",", 
                    RowBox[{"Directive", "[", "edgenumberstyle", "]"}]}], 
                    "]"}], ",", " ", 
                   RowBox[{"0.5", "*", 
                    RowBox[{"(", 
                    RowBox[{"v1", "+", "v2"}], ")"}]}]}], "]"}]}], "}"}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Graphics", "[", 
               RowBox[{"{", "}"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
          "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"vers", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"v", "[", 
         RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
       RowBox[{"Pick", "[", 
        RowBox[{"e", ",", "eflags"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"starts", ",", " ", "ends"}], "}"}], "=", 
      RowBox[{"Transpose", "[", "vers", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"flat", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"edges", " ", "=", 
         RowBox[{"Show", "[", " ", 
          RowBox[{"MapThread", "[", 
           RowBox[{"line", ",", " ", 
            RowBox[{"{", 
             RowBox[{
             "starts", ",", " ", "ends", ",", " ", "edgestyles", ",", " ", 
              "edgenumbers"}], " ", "}"}]}], "]"}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", " ", "]"}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "*", " ", "display", " ", "the", " ", "vertices", " ", "if", " ", 
       "requested"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"flat", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"vertexstyle", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"\"\<Vertices\>\"", "/.", 
            RowBox[{"{", "opt", "}"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{"False", "\[Rule]", " ", 
             RowBox[{"{", "}"}]}], "}"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{"\"\<Vertices\>\"", "\[Rule]", " ", 
            RowBox[{"{", "}"}]}], "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
        
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"vertexstyle", "\[Equal]", "True"}], ",", " ", 
          RowBox[{"vertexstyle", "=", " ", 
           RowBox[{"{", "Black", "}"}]}]}], "]"}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"gvertex", "=", 
         RowBox[{"Graphics", "[", 
          RowBox[{"{", "}"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"allvertices", " ", "=", " ", 
         RowBox[{"TissueVertices", "[", "tissue", "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"pickable", "[", "j_", "]"}], ":=", " ", 
         RowBox[{"IntervalCheck", "[", 
          RowBox[{
           RowBox[{"allvertices", "[", 
            RowBox[{"[", "j", "]"}], "]"}], ",", "xrange", ",", "yrange"}], 
          "]"}]}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"pickTheseVertices", " ", "=", " ", 
         RowBox[{"pickable", "/@", "vused"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"pickTheseVertices", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"vused", ",", " ", 
           RowBox[{
            RowBox[{"pickable", "[", "#", "]"}], "&"}]}], "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"vertices", " ", "=", " ", 
         RowBox[{"allvertices", "[", 
          RowBox[{"[", "pickTheseVertices", "]"}], "]"}]}], ";", " ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{
             RowBox[{"{", "vertexstyle", "}"}], "//", "Flatten"}], "]"}], ">",
            "0"}], ",", " ", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"vertexstyle", "=", 
            RowBox[{"Directive", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", "vertexstyle", "}"}], "]"}], "]"}]}], ";", " ", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"gvertex", " ", "=", " ", 
            RowBox[{"Point", "/@", "vertices"}]}], ";", "  ", 
           "\[IndentingNewLine]", 
           RowBox[{"gvertex", "=", 
            RowBox[{"Graphics", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{"vertexstyle", ",", " ", "gvertex"}], "}"}], "]"}], 
             "]"}]}], ";"}]}], " ", "\[IndentingNewLine]", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "*", " ", "label", " ", "the", " ", "vertices", " ", "if", " ", 
       "requested"}], " ", "**)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"flat", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"vertexnumbers", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\"\<VertexNumbers\>\"", "/.", 
              RowBox[{"{", "opt", "}"}]}], ")"}], "/.", 
            RowBox[{"{", 
             RowBox[{"False", "\[Rule]", " ", 
              RowBox[{"{", "}"}]}], "}"}]}], ")"}], "/.", 
          RowBox[{"{", 
           RowBox[{"\"\<VertexNumbers\>\"", "\[Rule]", " ", 
            RowBox[{"{", "}"}]}], "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
        
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"vertexnumbers", "\[Equal]", "True"}], ",", " ", 
          RowBox[{"vertexnumbers", "=", 
           RowBox[{"{", 
            RowBox[{"Darker", "[", "Red", "]"}], "}"}]}]}], "]"}], ";", " ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"vertexnumberstyle", "=", " ", "Automatic"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"vertexnumberstyle", "=", 
         RowBox[{
          RowBox[{"\"\<VertexNumberStyle\>\"", "/.", 
           RowBox[{"{", "opt", "}"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{"\"\<VertexNumberStyle\>\"", "\[Rule]", " ", "Automatic"}],
            "}"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{
             RowBox[{"{", "vertexnumbers", "}"}], "//", "Flatten"}], "]"}], 
           ">", "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"vnstyle", "=", 
            RowBox[{"Directive", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", "vertexnumbers", "}"}], "]"}], "]"}]}], ";", " ", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"vertexnumbers", "=", 
              RowBox[{"Pick", "[", 
               RowBox[{
                RowBox[{"Range", "[", "nv", "]"}], ",", "vflags"}], "]"}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"vertexnumbers", " ", "=", " ", 
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Text", "[", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{"#1", ",", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"{", "vertexnumberstyle", "}"}], "]"}]}], "]"}], 
                   ",", "#2"}], "]"}], "&"}], ",", " ", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"vertexnumbers", ",", " ", 
                  RowBox[{"Pick", "[", 
                   RowBox[{
                    RowBox[{"TissueVertices", "[", "tissue", "]"}], ",", 
                    "vflags"}], "]"}]}], "}"}]}], "]"}]}], ";"}], 
            "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"vertexnumbers", " ", "=", " ", 
            RowBox[{"MapThread", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Text", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"#1", ",", 
                   RowBox[{"Directive", "[", 
                    RowBox[{"{", "vertexnumberstyle", "}"}], "]"}]}], "]"}], 
                 ",", "#2"}], "]"}], "&"}], ",", " ", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"pickTheseVertices", ",", " ", "vertices"}], "}"}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"vertexnumbers", "=", 
            RowBox[{"Graphics", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{"vnstyle", ",", " ", "vertexnumbers"}], "}"}], "]"}], 
             "]"}]}], ";"}], " ", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"vertexnumbers", "=", 
            RowBox[{"Graphics", "[", 
             RowBox[{"{", "}"}], "]"}]}], ";"}]}], " ", "\[IndentingNewLine]",
          "]"}], ";"}]}], " ", "\[IndentingNewLine]", "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"flat", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"outer", " ", "=", " ", 
         RowBox[{
          RowBox[{"\"\<Outer\>\"", "/.", 
           RowBox[{"{", "opt", "}"}]}], "/.", 
          RowBox[{"\"\<Outer\>\"", "\[Rule]", " ", "\"\<None\>\""}]}]}], ";", 
        " ", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ToString", "[", "outer", "]"}], "\[NotEqual]", " ", 
           "\"\<None\>\""}], ",", " ", "\[IndentingNewLine]", 
          RowBox[{"outer", " ", "=", " ", 
           RowBox[{"ShowTissueBoundary", "[", 
            RowBox[{"tissue", ",", " ", "outer"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"outer", "=", 
           RowBox[{"Graphics", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
        ";"}]}], " ", "\[IndentingNewLine]", "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"EdgeCellLine", "[", 
       RowBox[{"cell_", ",", " ", "edge_", ",", " ", "style_", ",", " ", 
        RowBox[{"offset_:", "0.02"}]}], "]"}], ":=", " ", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2", ",", " ", "p1", ",", " ", "p2", ",", "c"}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"vertex", " ", "numbers"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}], "=", 
          RowBox[{"e", "[", 
           RowBox[{"[", "edge", "]"}], "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"vertex", " ", "coordinates"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"p1", "=", 
          RowBox[{"v", "[", 
           RowBox[{"[", "v1", "]"}], "]"}]}], ";", " ", 
         RowBox[{"p2", "=", 
          RowBox[{"v", "[", 
           RowBox[{"[", "v2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"c", " ", "=", " ", 
          RowBox[{"centroids", "[", 
           RowBox[{"[", "cell", "]"}], "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"p1", " ", "=", "   ", 
          RowBox[{"p1", " ", "+", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"c", "-", "p1"}], ")"}], "*", "offset"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"p2", " ", "=", " ", 
          RowBox[{"p2", " ", "+", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"c", "-", "p2"}], ")"}], "*", "offset"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"line", "[", 
          RowBox[{"p1", ",", "p2", ",", " ", "style", ",", " ", 
           RowBox[{"-", "1"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"edgecellpairs", "=", 
      RowBox[{
       RowBox[{"\"\<EdgeCellPairs\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<EdgeCellPairs\>\"", "\[Rule]", " ", 
         RowBox[{"{", "}"}]}], "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<edgeCellPairs: \>\"", ",", " ", "edgecellpairs"}], "]"}], 
     ";", " ", "\[IndentingNewLine]", " ", "\[IndentingNewLine]", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "edgecellpairs", "]"}], ">", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"cc", ",", "ee", ",", "st"}], "}"}], "=", 
         RowBox[{"Transpose", "[", "edgecellpairs", "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"dPrint", "[", 
         RowBox[{"\"\<toStatic: \>\"", ",", " ", "toStatic"}], "]"}], ";", 
        " ", "\[IndentingNewLine]", 
        RowBox[{"cc", " ", "=", " ", 
         RowBox[{"cc", "/.", "toStatic"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"gedges", " ", "=", " ", 
         RowBox[{"Show", "[", 
          RowBox[{"MapThread", "[", 
           RowBox[{"EdgeCellLine", ",", 
            RowBox[{"{", 
             RowBox[{"cc", ",", "ee", ",", "st"}], "}"}]}], "]"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "now", " ", "it", " ", "is", " ", "in", " ", "static", " ", 
           "coordinates"}], ",", " ", 
          RowBox[{
          "in", " ", "case", " ", "needed", " ", "for", " ", "dome"}]}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"edgecellpairs", "=", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"cc", ",", "ee", ",", "st"}], "}"}], "]"}]}], ";"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"gedges", "=", 
         RowBox[{"Graphics", "[", 
          RowBox[{"{", "}"}], "]"}]}], ";"}]}], " ", "\[IndentingNewLine]", 
      "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"picture", "=", 
      RowBox[{"Graphics", "[", 
       RowBox[{"{", "}"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"flat", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"picture", "=", "\[IndentingNewLine]", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"gopt", "=", 
             RowBox[{"MyFilterOptions", "[", 
              RowBox[{"Graphics", ",", "opt"}], "]"}]}], "}"}], ",", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"Show", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "polys", ",", " ", "edges", ",", " ", "gvertex", ",", " ", 
               "vertexnumbers", ",", "outer", ",", " ", "gedges", ",", 
               "gBoundary"}], "}"}], ",", "\[IndentingNewLine]", "gopt"}], 
            "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"dome", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dPrint", "[", 
         RowBox[{"\"\<cellstyles=\>\"", ",", " ", 
          RowBox[{"Short", "[", 
           RowBox[{"cellstyles", ",", "5"}], "]"}]}], "]"}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"picture", "=", 
         RowBox[{"ParaboloidPlot", "[", 
          RowBox[{"tissue", ",", " ", 
           RowBox[{"\"\<CellStyle\>\"", "\[Rule]", " ", 
            RowBox[{"(", 
             RowBox[{"cellstyles", "/.", 
              RowBox[{"{", 
               RowBox[{"Automatic", "\[Rule]", " ", "DefaultCELLCOLOR"}], 
               "}"}]}], ")"}]}], ",", " ", 
           RowBox[{"\"\<EdgeStyle\>\"", "\[Rule]", " ", 
            RowBox[{"(", 
             RowBox[{"edgestyles", "/.", 
              RowBox[{"{", 
               RowBox[{"Automatic", "\[Rule]", " ", "DefaultEDGECCOLOR"}], 
               "}"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"\"\<EdgeCellPairs\>\"", "\[Rule]", " ", "edgecellpairs"}],
            ",", "opt"}], "\[IndentingNewLine]", "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "picture", "]"}], ";"}]}], " ", 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.448484176752344*^9, 3.448484281045575*^9}, {
   3.44848439018312*^9, 3.448484398102242*^9}, {3.448484479933086*^9, 
   3.448484790001554*^9}, {3.448484834859272*^9, 3.448484871116749*^9}, {
   3.448484921718705*^9, 3.448484933924478*^9}, {3.448484991068179*^9, 
   3.448485008525708*^9}, {3.448485039207444*^9, 3.448485054288298*^9}, {
   3.448485091576427*^9, 3.448485290530859*^9}, {3.448485328848827*^9, 
   3.448485344060778*^9}, {3.448485397414261*^9, 3.448485400303052*^9}, 
   3.44848561032414*^9, {3.448486125848863*^9, 3.448486145871179*^9}, {
   3.448486203068745*^9, 3.44848623885086*^9}, {3.449006289456757*^9, 
   3.449006292125152*^9}, {3.449006415595799*^9, 3.449006599587472*^9}, {
   3.449008298273251*^9, 3.449008398537017*^9}, {3.449008435842843*^9, 
   3.449008620055552*^9}, {3.449008654089742*^9, 3.44900870034728*^9}, {
   3.449008747798618*^9, 3.449008777237863*^9}, {3.449008856756214*^9, 
   3.449008875412932*^9}, {3.449008927559936*^9, 3.449009054329853*^9}, {
   3.449009091921559*^9, 3.449009114230198*^9}, {3.449009168965631*^9, 
   3.449009194379592*^9}, {3.449009243339228*^9, 3.449009268614873*^9}, {
   3.449009305698901*^9, 3.449009352949371*^9}, {3.449009525490273*^9, 
   3.449009663834267*^9}, {3.449009760985441*^9, 3.449009781314197*^9}, 
   3.449009827155438*^9, {3.449009931866278*^9, 3.449010014805541*^9}, {
   3.449044798272755*^9, 3.449044799648544*^9}, {3.449080081451451*^9, 
   3.449080091966665*^9}, {3.451053362446987*^9, 3.451053368614237*^9}, 
   3.451053426069573*^9, {3.451053908107502*^9, 3.451053959260078*^9}, {
   3.4510541271522703`*^9, 3.45105412758395*^9}, {3.4517408940029173`*^9, 
   3.4517409087068777`*^9}, {3.4532256699225197`*^9, 3.45322567043373*^9}, {
   3.454946907784383*^9, 3.454947032368709*^9}, {3.4549470716870947`*^9, 
   3.454947111024528*^9}, {3.454947165454273*^9, 3.454947324423492*^9}, {
   3.454947413810708*^9, 3.4549474210929413`*^9}, {3.454947535586549*^9, 
   3.454947540656912*^9}, {3.454947589764203*^9, 3.454947646510839*^9}, {
   3.4565906127908487`*^9, 3.45659066732871*^9}, {3.456590701446693*^9, 
   3.456590706787417*^9}, {3.456590752772585*^9, 3.4565907603576736`*^9}, {
   3.456590800297275*^9, 3.45659082182934*^9}, {3.456590883397627*^9, 
   3.456590893685617*^9}, {3.456598200874175*^9, 3.456598217251692*^9}, {
   3.456598258935852*^9, 3.456598262345024*^9}, {3.456771785980192*^9, 
   3.4567719114106073`*^9}, {3.456771971224641*^9, 3.456771976908688*^9}, {
   3.494553450040715*^9, 3.494553462799033*^9}, {3.494553656007832*^9, 
   3.494553701226934*^9}, {3.512218385300474*^9, 3.512218526805821*^9}, {
   3.512220614085425*^9, 3.5122206948704643`*^9}, 3.5122207592728*^9, {
   3.512224939026216*^9, 3.51222497231176*^9}, {3.544735535242259*^9, 
   3.544735536928719*^9}, {3.544735587499721*^9, 3.544735616005229*^9}, {
   3.544739887572373*^9, 3.544739888000307*^9}, {3.5447399616500683`*^9, 
   3.544740290839785*^9}, {3.544740353358038*^9, 3.544740450317171*^9}, {
   3.5447404855967827`*^9, 3.5447404880618896`*^9}, {3.544740572899358*^9, 
   3.5447411606877947`*^9}, {3.5447411948888893`*^9, 3.544741237264929*^9}, {
   3.544741345648131*^9, 3.544741474913938*^9}, {3.544741526287054*^9, 
   3.54474155915411*^9}, {3.544741618810514*^9, 3.544741629345686*^9}, 
   3.544741670716558*^9, {3.5447417298251762`*^9, 3.54474199266614*^9}, {
   3.5447420285281*^9, 3.544742226059503*^9}, {3.544742259445953*^9, 
   3.5447424280024157`*^9}, {3.544742466918661*^9, 3.544742499274138*^9}, {
   3.544742606517847*^9, 3.544742613208352*^9}, {3.544742645347845*^9, 
   3.544742670820052*^9}, {3.5447427055074453`*^9, 3.544742710256287*^9}, {
   3.5447427885105553`*^9, 3.544742789221711*^9}, {3.544742873395026*^9, 
   3.544743207976555*^9}, {3.544743238092971*^9, 3.544743539674416*^9}, {
   3.544743575136897*^9, 3.544743650596669*^9}, {3.544743744029831*^9, 
   3.544743809291184*^9}, {3.54474385158248*^9, 3.544743909981903*^9}, {
   3.54474395449128*^9, 3.544743954683483*^9}, 3.5447439851064377`*^9, {
   3.5447442916192503`*^9, 3.5447442926342487`*^9}, {3.5447446373549023`*^9, 
   3.54474464097787*^9}, {3.5451330441133833`*^9, 3.545133064104772*^9}, {
   3.5451331687499866`*^9, 3.545133206654821*^9}, {3.5451332973542757`*^9, 
   3.545133409832054*^9}, {3.545133511513556*^9, 3.5451335923045397`*^9}, {
   3.545133636310124*^9, 3.5451336752104893`*^9}, {3.5451337205449333`*^9, 
   3.545133755902631*^9}, {3.5451338164599047`*^9, 3.545133826331237*^9}, {
   3.5451344037396383`*^9, 3.545134705580841*^9}, {3.5451348308358507`*^9, 
   3.545134943047887*^9}, {3.5451350376239357`*^9, 3.5451350710649853`*^9}, {
   3.545135184027619*^9, 3.545135274488968*^9}, 3.545135326839951*^9, {
   3.545135382078738*^9, 3.54513539691404*^9}, {3.545135428886409*^9, 
   3.5451354388999367`*^9}, {3.545135553660774*^9, 3.5451355696612473`*^9}, {
   3.5451356588663483`*^9, 3.545135669954513*^9}, {3.545135761785626*^9, 
   3.5451357625581827`*^9}, {3.5451358540353823`*^9, 3.545135910777281*^9}, {
   3.545135946401289*^9, 3.545135965647833*^9}, {3.545136831427684*^9, 
   3.545136831734364*^9}, {3.545136950936452*^9, 3.545137081877367*^9}, {
   3.545137137335808*^9, 3.545137220871737*^9}, 3.545137254769998*^9, {
   3.545137293575058*^9, 3.545137300588673*^9}, {3.5451374332652283`*^9, 
   3.545137472205661*^9}, {3.545137522775593*^9, 3.545137530014134*^9}, {
   3.545137638524743*^9, 3.545137687694189*^9}, {3.545137717825749*^9, 
   3.5451377520643063`*^9}, {3.54513787112613*^9, 3.5451379198148203`*^9}, {
   3.545137953694906*^9, 3.5451379562137203`*^9}, {3.545138140680038*^9, 
   3.545138169387463*^9}, {3.5453993394782133`*^9, 3.5453993988483152`*^9}, {
   3.545399500829673*^9, 3.5453995068183203`*^9}, {3.545399662877577*^9, 
   3.5453996794120007`*^9}, 3.5460868130960083`*^9, {3.546086855956918*^9, 
   3.54608685865739*^9}, {3.546086891506624*^9, 3.546086898533812*^9}, {
   3.546172014834715*^9, 3.546172029170862*^9}, {3.546172068869691*^9, 
   3.546172083994969*^9}, 3.546266912544744*^9, {3.546267076473556*^9, 
   3.546267079574316*^9}, 3.546267179330084*^9, {3.5469605496268873`*^9, 
   3.546960594948049*^9}, {3.546960690494452*^9, 3.546960847341156*^9}, {
   3.546960990564353*^9, 3.546961082526128*^9}, {3.5470455920093184`*^9, 
   3.547045610194993*^9}, {3.547045743944785*^9, 3.547046015059701*^9}, {
   3.547046106982472*^9, 3.5470461326174927`*^9}, {3.547046241410231*^9, 
   3.547046255947953*^9}, {3.54704629819177*^9, 3.547046334618656*^9}, {
   3.547046373636743*^9, 3.547046421098239*^9}, {3.547046459939521*^9, 
   3.547046488170434*^9}, {3.5470465485130568`*^9, 3.547046566661622*^9}, {
   3.547046689846661*^9, 3.5470467114314117`*^9}, {3.547046773138585*^9, 
   3.5470468018820057`*^9}, {3.547055346397603*^9, 3.547055473568179*^9}, {
   3.547216264493868*^9, 3.547216265147019*^9}, {3.5472165807029667`*^9, 
   3.547216639880086*^9}, {3.547216673425198*^9, 3.547216749333825*^9}, {
   3.547217232425364*^9, 3.5472172423924837`*^9}, {3.547907756193378*^9, 
   3.547907832325067*^9}, 3.547907869073971*^9, {3.547908688275185*^9, 
   3.547908723671239*^9}, {3.548524009142774*^9, 3.5485240303012047`*^9}, 
   3.549128299180832*^9, {3.549128867913208*^9, 3.549129170801414*^9}, {
   3.549129217022031*^9, 3.549129253231882*^9}, {3.54912930939252*^9, 
   3.549129329634946*^9}, {3.549129620560554*^9, 3.549129640200622*^9}, 
   3.5491300845217943`*^9, {3.549130122790153*^9, 3.549130126311502*^9}, {
   3.549130165820387*^9, 3.549130166116609*^9}, {3.54913029134823*^9, 
   3.549130298384779*^9}, {3.5491303712000637`*^9, 3.549130380967827*^9}, {
   3.549131630562421*^9, 3.549131656569757*^9}, {3.549131897318674*^9, 
   3.549131909827879*^9}, {3.549132130430635*^9, 3.549132138636747*^9}, {
   3.5491329867983923`*^9, 3.549132988045535*^9}, {3.549133026465728*^9, 
   3.549133055780504*^9}, {3.5491340319859467`*^9, 3.549134035703681*^9}, {
   3.54913408166372*^9, 3.549134088380494*^9}, {3.549134131706808*^9, 
   3.54913413679145*^9}, {3.549134223699068*^9, 3.5491342371003103`*^9}, {
   3.5491342776000357`*^9, 3.5491342836356*^9}, {3.54913432894411*^9, 
   3.5491344192002783`*^9}, {3.5491403389166327`*^9, 
   3.5491403729129333`*^9}, {3.5491404130176487`*^9, 3.549140435775998*^9}, {
   3.5594205554237223`*^9, 3.559420588794366*^9}, {3.559420641255155*^9, 
   3.559420746423789*^9}, {3.559420882643702*^9, 3.559420897026141*^9}, {
   3.55942092872773*^9, 3.559420947102075*^9}, {3.559421014257389*^9, 
   3.559421034023101*^9}, {3.5594210788726873`*^9, 3.559421180741287*^9}, {
   3.5594213008742723`*^9, 3.5594213886362886`*^9}, {3.559421476355612*^9, 
   3.5594216703588943`*^9}, {3.5594217261688757`*^9, 3.559421743853405*^9}, {
   3.559421790494087*^9, 3.5594218213251877`*^9}, {3.559421857410162*^9, 
   3.559421871381598*^9}, {3.559421928442705*^9, 3.559422020984428*^9}, {
   3.559422092090597*^9, 3.559422133686511*^9}, {3.561414088373645*^9, 
   3.5614140962059097`*^9}, {3.562355055358447*^9, 
   3.562355154523697*^9}},ExpressionUUID->"21573d01-9514-4fd4-9b97-\
795865fbdc16"],

Cell[CellGroupData[{

Cell["ShowTissue[Torus]", "Subsubsection",
 CellChangeTimes->{{3.457387722241206*^9, 
  3.457387725324381*^9}},ExpressionUUID->"c1aee495-843d-4b37-b763-\
98ea30daee36"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ShowTissue", "[", 
    RowBox[{
     RowBox[{"tissue_", "?", "TorusQ"}], ",", " ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
   RowBox[{"ShowTissue", "[", 
    RowBox[{
     RowBox[{"TorusTissue", "[", "tissue", "]"}], ",", " ", "opt"}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.457387740413211*^9, 
  3.457387765431417*^9}},ExpressionUUID->"19019aa6-7af7-4f12-9ec7-\
5f2d24400ae4"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["ShowEdgeNormal, ShowOutwardNormals", "Subsection",
 CellChangeTimes->{{3.448537646036416*^9, 3.448537647851002*^9}, {
  3.448540473687979*^9, 
  3.448540476244983*^9}},ExpressionUUID->"288e3968-0d25-4763-93b0-\
38fbecab9628"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ShowEdgeNormal", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"p1_", "?", "PointQ"}], ",", " ", 
      RowBox[{"p2_", "?", "PointQ"}]}], "}"}], ",", " ", 
    RowBox[{"style_:", 
     RowBox[{"{", "}"}]}], ",", " ", 
    RowBox[{"edge_:", "False"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"nv", ",", " ", "origin", ",", " ", "g", ",", " ", "l"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nv", "=", 
      RowBox[{"NormalVector", "[", 
       RowBox[{"{", 
        RowBox[{"p1", ",", "p2"}], "}"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"origin", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"p1", "+", "p2"}], ")"}], "/", "2"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"nv", "=", 
      RowBox[{"{", 
       RowBox[{"style", ",", " ", 
        RowBox[{"Arrow", "[", 
         RowBox[{"{", 
          RowBox[{"origin", ",", " ", 
           RowBox[{"origin", "+", "nv"}]}], "}"}], "]"}]}], "}"}]}], ";", 
     "  ", "\[IndentingNewLine]", 
     RowBox[{"g", "=", 
      RowBox[{"Graphics", "[", 
       RowBox[{"Flatten", "[", "nv", "]"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"edge", ",", "\[IndentingNewLine]", 
       RowBox[{"l", "=", 
        RowBox[{"Graphics", "[", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{"p1", ",", " ", "p2"}], "}"}], "]"}], "]"}]}], ",", "  ", 
       "\[IndentingNewLine]", 
       RowBox[{"l", "=", 
        RowBox[{"Graphics", "[", "]"}]}]}], " ", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"Show", "[", 
       RowBox[{"g", ",", " ", "l"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.448537658006986*^9, 3.448537696615362*^9}, {
  3.448537798292781*^9, 3.448537828129191*^9}, {3.448537891855772*^9, 
  3.448537960994094*^9}, {3.448538022172364*^9, 3.448538023916815*^9}, {
  3.448538128407202*^9, 3.448538259670582*^9}, {3.448538540839089*^9, 
  3.44853854172723*^9}},ExpressionUUID->"c8c2a5f1-e58d-49bc-bb6c-\
eb5e3b60875f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ShowOutwardNormals", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p__", "?", "PointQ"}], "}"}], ",", " ", 
     RowBox[{"style_:", 
      RowBox[{"{", "}"}]}], ",", " ", 
     RowBox[{"edge_:", "False"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "e", ",", " ", "vecs", ",", " ", "midpoints", ",", " ", "arrows", ",", 
       " ", "l"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"vecs", " ", "=", " ", 
       RowBox[{"OutwardNormalVector", "[", 
        RowBox[{
         RowBox[{"{", "p", "}"}], ",", " ", "0"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"e", "=", 
       RowBox[{"Append", "[", 
        RowBox[{
         RowBox[{"{", "p", "}"}], ",", " ", 
         RowBox[{"First", "[", 
          RowBox[{"{", "p", "}"}], "]"}]}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"midpoints", " ", "=", " ", 
       RowBox[{"Mean", "/@", 
        RowBox[{"Partition", "[", 
         RowBox[{"e", ",", "2", ",", "1"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"arrows", " ", "=", " ", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Arrow", "[", 
           RowBox[{"{", 
            RowBox[{"#1", ",", " ", "#2"}], "}"}], "]"}], "&"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"midpoints", ",", " ", 
           RowBox[{"midpoints", "+", "vecs"}]}], "}"}]}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"arrows", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"style", ",", " ", "arrows"}], "}"}], "//", "Flatten"}]}], 
      ";", " ", "\[IndentingNewLine]", 
      RowBox[{"arrows", "=", 
       RowBox[{"Graphics", "[", "arrows", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"edge", ",", "\[IndentingNewLine]", 
        RowBox[{"l", "=", 
         RowBox[{"Graphics", "[", 
          RowBox[{"Line", "[", "e", "]"}], "]"}]}], ",", "  ", 
        "\[IndentingNewLine]", 
        RowBox[{"l", "=", 
         RowBox[{"Graphics", "[", "]"}]}]}], " ", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Show", "[", 
       RowBox[{"arrows", ",", " ", "l"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ShowOutwardNormals", "[", 
   RowBox[{
    RowBox[{"T_", "?", "TissueQ"}], ",", " ", 
    RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "edges", ",", " ", "cells", ",", " ", "CVC", ",", " ", "g1", ",", " ", 
      "style", ",", " ", "v", ",", " ", "e", ",", " ", "g2"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cells", "=", 
      RowBox[{
       RowBox[{"\"\<Cells\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<Cells\>\"", "\[Rule]", " ", 
         RowBox[{"{", "}"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"edges", "=", 
      RowBox[{
       RowBox[{"\"\<Edges\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<Edges\>\"", "\[Rule]", " ", 
         RowBox[{"{", "}"}]}], "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"style", "=", 
      RowBox[{
       RowBox[{"\"\<Style\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<Style\>\"", "\[Rule]", " ", 
         RowBox[{"{", "}"}]}], "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"g1", "=", 
      RowBox[{"Graphics", "[", 
       RowBox[{"{", "}"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "cells", "]"}], ">", "0"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"CVC", " ", "=", " ", 
         RowBox[{
          RowBox[{"CellVertexCoordinates", "[", "T", "]"}], "[", 
          RowBox[{"[", "cells", "]"}], "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"g1", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"ShowOutwardNormals", "[", 
            RowBox[{"#", ",", " ", "style"}], "]"}], "&"}], "/@", "CVC"}]}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"g2", "=", 
      RowBox[{"Graphics", "[", 
       RowBox[{"{", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "edges", "]"}], ">", "0"}], ",", "  ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"e", "=", 
         RowBox[{
          RowBox[{"EdgeVertices", "[", "T", "]"}], "[", 
          RowBox[{"[", "edges", "]"}], "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"g2", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"ShowOutwardNormals", "[", 
            RowBox[{"#", ",", "style"}], "]"}], "&"}], "/@", "e"}]}], ";"}]}],
       " ", "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{"g1", ",", "g2"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.448539160136671*^9, 3.44853918927453*^9}, {
  3.448539942354639*^9, 3.448539988879304*^9}, {3.44854010211494*^9, 
  3.448540183144063*^9}, {3.448540220597301*^9, 3.448540290001339*^9}, {
  3.448540325025745*^9, 3.4485403546351*^9}, {3.561485566971336*^9, 
  3.5614857288868303`*^9}, {3.561485760438128*^9, 3.561485934562117*^9}, {
  3.5614861615203753`*^9, 3.561486163381351*^9}, {3.561486227968883*^9, 
  3.561486231729836*^9}},ExpressionUUID->"3973617a-3b9f-4aba-a0d7-\
6090434dc0d2"]
}, Closed]],

Cell[CellGroupData[{

Cell["ShowTissueCells", "Subsection",
 CellChangeTimes->{
  3.454075499399891*^9},ExpressionUUID->"b95531cd-7cb1-4842-9030-\
e9b4cf4d8e18"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ShowTissueCells", "[", 
    RowBox[{
     RowBox[{"tissue_", "?", "TissueQ"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"cells__", "?", "IntegerQ"}], "}"}], ",", " ", "color_", ",", 
     " ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "colors", ",", "p", ",", "n", ",", " ", "dc", ",", " ", "T1", ",", "v", 
       ",", "e", ",", "c"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"NTissueCells", "[", "tissue", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"dc", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<CellStyles\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<CellStyle\>\"", "\[Rule]", " ", "LightGreen"}], 
         "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"colors", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"{", "cells", "}"}], ",", " ", "#"}], "]"}], ",", " ", 
           "color", ",", " ", "dc"}], "]"}], "&"}], "/@", 
        RowBox[{"Range", "[", "n", "]"}]}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{
           RowBox[{"TissueVertices", "[", "tissue", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[Equal]", "3"}], ",", " ",
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"v", ",", "e", ",", "c"}], "}"}], "=", 
          RowBox[{"tissue", "/.", 
           RowBox[{"{", 
            RowBox[{"Tissue", "\[Rule]", " ", "List"}], "}"}]}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"T1", "=", 
          RowBox[{"Tissue", "[", 
           RowBox[{
            RowBox[{"Most", "/@", "v"}], ",", "e", ",", "c"}], "]"}]}], ";"}],
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        RowBox[{"T1", "=", "tissue"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"p", "=", 
       RowBox[{"ShowTissue", "[", 
        RowBox[{"T1", ",", " ", 
         RowBox[{"\"\<CellStyles\>\"", "\[Rule]", " ", "colors"}], ",", " ", 
         "opt"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "p", "]"}], ";"}]}], " ", "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ShowTissueCells", "[", 
    RowBox[{
     RowBox[{"tissue_", "?", "TissueQ"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"cells__", "?", "IntegerQ"}], "}"}]}], "]"}], ":=", " ", 
   RowBox[{"ShowTissueCells", "[", 
    RowBox[{"tissue", ",", " ", 
     RowBox[{"{", "cells", "}"}], ",", " ", "LightPink"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ShowTissueCells", "[", "x___", "]"}], ":=", " ", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{
       RowBox[{"Short", "/@", 
        RowBox[{"{", "x", "}"}]}], ",", "15"}], "]"}], ";", " ", 
     RowBox[{
     "Print", "[", 
      "\"\<Error: Expecting ShowTissueCells[tissue, {i1,i2,...}] or \
\\nShowTissueCells[tissue, {i1, i2, ..}, color, options]\>\"", "]"}], ";", 
     " ", "$Failed"}], ")"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.454075506115494*^9, 3.454075607002658*^9}, {
   3.454075661372604*^9, 3.454075667040722*^9}, {3.454075704197836*^9, 
   3.4540757170728703`*^9}, {3.455276284291012*^9, 3.455276330839017*^9}, {
   3.456748940799862*^9, 3.456748976040578*^9}, 3.456749007133704*^9, {
   3.456749073543929*^9, 3.456749167985165*^9}, {3.512220371298045*^9, 
   3.512220387366584*^9}, 3.5122204278082523`*^9, {3.5589914752235003`*^9, 
   3.5589914777909527`*^9}, {3.56210774187738*^9, 3.562107752027925*^9}, {
   3.562107816535323*^9, 3.5621078315682583`*^9}, {3.562107867411346*^9, 
   3.562107872196753*^9}, {3.562107926508726*^9, 3.5621080323910513`*^9}, {
   3.562108097985165*^9, 
   3.5621080986948357`*^9}},ExpressionUUID->"75793ca0-6622-44f5-8c6b-\
acf6dd8393c2"]
}, Closed]],

Cell[CellGroupData[{

Cell["ShowTissueFunction", "Subsection",
 CellChangeTimes->{{3.461172288885181*^9, 
  3.46117229187768*^9}},ExpressionUUID->"94f9ebbd-b623-409a-9ba3-\
dafd0ab36231"],

Cell["f[x, y] is a function by cell centroid coordinates", "Text",
 CellChangeTimes->{{3.4611724057968884`*^9, 3.4611724141517563`*^9}, {
  3.461172861824274*^9, 3.4611728667331343`*^9}, {3.461172917054174*^9, 
  3.461172919206663*^9}, {3.4611729772390614`*^9, 
  3.461172978541338*^9}},ExpressionUUID->"894ef992-9503-4145-becd-\
f79abb134640"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ShowTissueFunction", "[", 
    RowBox[{
     RowBox[{"tissue_", "?", "TissueQ"}], ",", " ", "\[IndentingNewLine]", 
     "f_", ",", " ", 
     RowBox[{"{", 
      RowBox[{"fmin_", ",", " ", "fmax_"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"cmin_", ",", " ", "cmax_"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "n", ",", " ", "centroids", ",", " ", "values", ",", "colors", ",", 
       "pic"}], "}"}], ",", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"NTissueCells", "[", "tissue", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"centroids", " ", "=", " ", 
       RowBox[{"Centroid", "[", "tissue", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"values", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"f", "@@", "#"}], ")"}], "&"}], "/@", "centroids"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"colors", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"RGBInterpolate", "[", 
          RowBox[{"#", ",", " ", 
           RowBox[{"{", 
            RowBox[{"fmin", ",", " ", "fmax"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"cmin", ",", " ", "cmax"}], "}"}]}], "]"}], "&"}], "/@", 
        "values"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"pic", " ", "=", " ", 
       RowBox[{"ShowTissue", "[", 
        RowBox[{"tissue", ",", " ", 
         RowBox[{"\"\<CellStyle\>\"", "\[Rule]", " ", "colors"}], ",", " ", 
         "opt"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "pic", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.461172307251038*^9, 3.4611724737207212`*^9}, {
  3.4611729319649754`*^9, 3.461172990096962*^9}, {3.461173060195469*^9, 
  3.461173063282843*^9}, {3.461173093495906*^9, 3.461173102729705*^9}, {
  3.461173134600938*^9, 3.4611731591408987`*^9}, {3.461173225490828*^9, 
  3.461173294544977*^9}, {3.461173330636725*^9, 3.461173332487988*^9}, {
  3.461173528033622*^9, 
  3.4611735612936783`*^9}},ExpressionUUID->"fa22c944-8215-4b70-b3fd-\
add5cbe37c7e"]
}, Closed]],

Cell[CellGroupData[{

Cell["ShowTissueBoundary", "Subsection",
 CellChangeTimes->{{3.5122177629193296`*^9, 
  3.512217770223145*^9}},ExpressionUUID->"8e0e4d6e-486c-4371-add7-\
3474342bedfa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ShowTissueBoundary", "[", 
   RowBox[{"q_", ",", " ", 
    RowBox[{"style_:", 
     RowBox[{"{", 
      RowBox[{"Thin", ",", "Black"}], "}"}]}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"eb", ",", "v", ",", "e", ",", 
      RowBox[{"defaultStyle", "=", 
       RowBox[{"{", 
        RowBox[{"Thin", ",", "Black"}], "}"}]}], ",", " ", "STYLE"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"STYLE", "=", "style"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "[", "STYLE", "]"}], "\[Equal]", 
        "\"\<Automatic\>\""}], ",", " ", 
       RowBox[{"STYLE", "=", "defaultStyle"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "[", "STYLE", "]"}], "\[Equal]", "\"\<None\>\""}],
        ",", " ", 
       RowBox[{"Return", "[", 
        RowBox[{"Graphics", "[", 
         RowBox[{"{", "}"}], "]"}], "]"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"eb", " ", "=", " ", 
      RowBox[{"EdgesOnBoundary", "[", "q", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"e", "=", 
      RowBox[{
       RowBox[{"TissueEdges", "[", "q", "]"}], "[", 
       RowBox[{"[", "eb", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"v", "=", 
      RowBox[{"TissueVertices", "[", "q", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Directive", "[", "STYLE", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Line", "[", 
           RowBox[{"v", "[", 
            RowBox[{"[", "#", "]"}], "]"}], "]"}], "&"}], "/@", "e"}]}], 
       "}"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.512217770964429*^9, 3.512217880996792*^9}, {
  3.512218042146769*^9, 3.512218114383648*^9}, {3.545137767781507*^9, 
  3.545137854453949*^9}},ExpressionUUID->"367825e0-d016-4c02-87e9-\
10f57a551943"]
}, Closed]],

Cell[CellGroupData[{

Cell["Circle3D", "Subsection",
 CellChangeTimes->{{3.558871247435409*^9, 
  3.5588712720983963`*^9}},ExpressionUUID->"a8c948e2-e6cf-4921-885d-\
e5af3df4d3e7"],

Cell["\<\
Generates a 3D graphics primitive of a horizontal circle (parallel to xy \
plane) with center at {x,y,z} and radius r\
\>", "Text",
 CellChangeTimes->{{3.5588712750270443`*^9, 
  3.558871295378557*^9}},ExpressionUUID->"2b1d2790-557a-422b-9be2-\
38e52d72a19e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Circle3D", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", "r_"}], "]"}], ":=", 
  RowBox[{"Line", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"r", "*", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", "#", "]"}], ",", 
          RowBox[{"Sin", "[", "#", "]"}], ",", "0"}], "}"}]}], "+", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], ")"}], "&"}], "/@", 
    RowBox[{"Range", "[", 
     RowBox[{"0", ",", 
      RowBox[{"2", " ", "Pi"}], ",", 
      RowBox[{"2", " ", 
       RowBox[{"Pi", "/", "100."}]}]}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.558871228406555*^9, 
  3.558871228407957*^9}},ExpressionUUID->"0439463d-1e08-45cb-9e8c-\
e6c5a28d1607"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Plotting", "Section",
 CellChangeTimes->{{3.448727818182528*^9, 
  3.448727819149977*^9}},ExpressionUUID->"60d40666-d85c-423f-89d5-\
793c1a48906e"],

Cell[CellGroupData[{

Cell["SolutionVariables, SolutionVars", "Subsection",
 CellChangeTimes->{{3.449000527780984*^9, 3.449000531332936*^9}, {
  3.4611665585161457`*^9, 
  3.461166560043208*^9}},ExpressionUUID->"5c2f2ae3-f28d-46f2-a345-\
dc3b43ed822f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SolutionVars", "[", "system_", "]"}], ":=", " ", 
    RowBox[{"Union", "[", 
     RowBox[{"Head", "/@", 
      RowBox[{"SolutionVariables", "[", "system", "]"}]}], "]"}]}], ";"}], 
  " "}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4611665616773033`*^9, 
  3.461166578437587*^9}},ExpressionUUID->"fcb9bdd3-6647-48a9-afa9-\
7c9920f32a5b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SolutionVariables", "[", "system_", "]"}], ":=", " ", 
    RowBox[{"SolutionVariables", "[", 
     RowBox[{"system", ",", " ", 
      RowBox[{"{", "}"}]}], "]"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SolutionVariables", "[", 
    RowBox[{"system_", ",", " ", 
     RowBox[{"{", "var___", "}"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s", ",", "v", ",", " ", "p"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"s", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", "system", "}"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{"First", "/@", "s"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"{", "var", "}"}], "]"}], "==", "0"}], ",", " ", 
        RowBox[{"Return", "[", "v", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Cases", "[", " ", 
            RowBox[{"v", ",", "#", ",", " ", "Infinity"}], "]"}], ",", " ", 
           RowBox[{"Cases", "[", 
            RowBox[{"v", ",", " ", 
             RowBox[{"#", "[", "_", "]"}], ",", " ", "Infinity"}], "]"}], ",",
            " ", 
           RowBox[{"Cases", "[", 
            RowBox[{"v", ",", " ", 
             RowBox[{
              RowBox[{"#", "[", "_", "]"}], "[", "_", "]"}], ",", " ", 
             "Infinity"}], "]"}]}], "]"}], "&"}], "/@", 
        RowBox[{"{", "var", "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{"Flatten", "[", "v", "]"}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SolutionVariables", "[", "x___", "]"}], ":=", " ", "\"\<??\>\""}],
   ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.448728250114996*^9, 3.448728312459572*^9}, {
  3.448728346366336*^9, 3.448728379920174*^9}, {3.448728489178943*^9, 
  3.448728526534562*^9}, {3.448728570981435*^9, 3.448728651591072*^9}, {
  3.448728688582143*^9, 
  3.448728771438163*^9}},ExpressionUUID->"fa4f30ec-b587-4086-bf60-\
570ff5f4b90a"]
}, Closed]],

Cell[CellGroupData[{

Cell["MultiPlot", "Subsection",
 CellChangeTimes->{{3.448727842254881*^9, 
  3.448727844582215*^9}},ExpressionUUID->"6979c1e3-01ad-4ceb-842c-\
58097b6e890a"],

Cell["Superceded by SimPlot", "Text",
 CellChangeTimes->{{3.4551250016251087`*^9, 3.455125005317918*^9}, {
  3.455125046808957*^9, 
  3.45512504805227*^9}},ExpressionUUID->"b2b4449c-8bad-4a04-866f-\
0ba98436fe11"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MultiPlot", "[", 
    RowBox[{"solution_", ",", " ", 
     RowBox[{"{", "var__", "}"}], ",", "  ", 
     RowBox[{"{", 
      RowBox[{"time_", ",", " ", "tstart_", ",", " ", "tend_"}], "}"}], ",", 
     " ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "variables", ",", " ", "points", ",", " ", "data", ",", " ", "sol1", 
       ",", " ", "times", ",", " ", "singleLine", ",", " ", "singleCurve", 
       ",", " ", "dir", ",", " ", "n"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"points", "=", 
       RowBox[{
        RowBox[{"\"\<PlotPoints\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<PlotPoints\>\"", "\[Rule]", " ", "50"}], "}"}]}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"variables", "=", 
       RowBox[{"SolutionVariables", "[", 
        RowBox[{"solution", ",", " ", 
         RowBox[{"{", "var", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sol1", "=", 
       RowBox[{"variables", "/.", "solution"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"times", " ", "=", " ", 
       RowBox[{"Range", "[", 
        RowBox[{"tstart", ",", " ", "tend", ",", 
         RowBox[{"1.0", "*", " ", 
          FractionBox[
           RowBox[{"(", 
            RowBox[{"tend", "-", "tstart"}], ")"}], "points"]}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"data", "[", "oneSolution_", "]"}], ":=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"oneSolution", "/.", 
           RowBox[{"{", 
            RowBox[{"time", "\[Rule]", " ", "#"}], "}"}]}], ")"}], "&"}], "/@",
         "times"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"singleLine", "[", "oneSolution_", "]"}], ":=", " ", 
       RowBox[{"Line", "[", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{"times", ",", " ", 
           RowBox[{"data", "[", "oneSolution", "]"}]}], "}"}], "]"}], "]"}]}],
       ";", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"singleCurve", "[", 
        RowBox[{"oneSolution_", ",", " ", "graphicsDirectives_"}], "]"}], ":=", 
       RowBox[{"Graphics", "[", 
        RowBox[{"{", 
         RowBox[{"graphicsDirectives", ",", " ", 
          RowBox[{"singleLine", "[", "oneSolution", "]"}]}], "}"}], "]"}]}], 
      ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dir", "=", 
       RowBox[{
        RowBox[{"\"\<GraphicsDirectives\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<GraphicsDirectives\>\"", "\[Rule]", " ", "Automatic"}], 
         "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "sol1", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ToString", "[", "dir", "]"}], "\[Equal]", 
         "\"\<Automatic\>\""}], ",", "\[IndentingNewLine]", 
        RowBox[{"dir", "=", 
         RowBox[{"Hue", "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1.0", "/", "n"}], ")"}], "*", 
            RowBox[{"Range", "[", 
             RowBox[{"0", ",", 
              RowBox[{"n", "-", "1"}]}], "]"}]}], ")"}]}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"ListQ", "[", "dir", "]"}]}], ",", " ", 
        RowBox[{"dir", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{"dir", ",", " ", 
           RowBox[{"{", "n", "}"}]}], "]"}]}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"dir", " ", "=", " ", 
       RowBox[{
        RowBox[{"PadRight", "[", 
         RowBox[{"dir", ",", " ", "n", ",", " ", "Indeterminate"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{"Indeterminate", "\[Rule]", " ", 
          RowBox[{"{", "}"}]}], "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ShowOptions", "=", 
          RowBox[{"MyFilterOptions", "[", 
           RowBox[{"Graphics", ",", "opt"}], "]"}]}], "}"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"MapThread", "[", 
           RowBox[{"singleCurve", ",", " ", 
            RowBox[{"{", 
             RowBox[{"sol1", ",", " ", "dir"}], "}"}]}], "]"}], ",", " ", 
          "ShowOptions", ",", " ", "\[IndentingNewLine]", 
          RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", " ", 
          RowBox[{"FrameTicks", "\[Rule]", " ", 
           RowBox[{"{", 
            RowBox[{
            "Automatic", ",", "Automatic", ",", " ", "None", ",", " ", 
             "None"}], "}"}]}], ",", " ", 
          RowBox[{"AspectRatio", "\[Rule]", " ", "1"}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MultiPlot", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"Print", "[", "\"\<??\>\"", "]"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.448727845572557*^9, 3.448727878103269*^9}, {
  3.448727915706307*^9, 3.448727927597368*^9}, {3.448727963228118*^9, 
  3.448727981880738*^9}, {3.448728858109104*^9, 3.448728867134355*^9}, {
  3.448728936359088*^9, 3.448728973235687*^9}, {3.44872901595182*^9, 
  3.448729062037986*^9}, {3.448729162388637*^9, 3.448729416489841*^9}, {
  3.448915562380432*^9, 3.44891558693695*^9}, {3.448915664254303*^9, 
  3.44891605875878*^9}, {3.448916096972494*^9, 3.448916118632925*^9}, {
  3.44891624517863*^9, 3.448916252616892*^9}, {3.448916534068271*^9, 
  3.448916542252816*^9}, {3.448916598067286*^9, 3.448916626123801*^9}, {
  3.448916672714466*^9, 3.448916673211441*^9}, {3.449000596048881*^9, 
  3.44900066935497*^9}, {3.44900072227017*^9, 3.449000777082996*^9}, {
  3.44900081991622*^9, 3.44900084169231*^9}, {3.44905738410794*^9, 
  3.449057387521468*^9}},ExpressionUUID->"bdf32782-5076-4da4-a6eb-\
0c00fb480fba"]
}, Closed]],

Cell[CellGroupData[{

Cell["RowPlot", "Subsection",
 CellChangeTimes->{{3.449058308547492*^9, 
  3.44905830984321*^9}},ExpressionUUID->"3b57b968-1736-4546-821d-\
403dd81a03d5"],

Cell["Superceded by SimPlot", "Text",
 CellChangeTimes->{{3.455125019613813*^9, 
  3.455125039257848*^9}},ExpressionUUID->"6b320b84-c60b-4095-a441-\
5c8b4ea87be0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RowPlot", "[", 
    RowBox[{"solution_", ",", " ", 
     RowBox[{"{", "var__", "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"t_", ",", " ", "tstart_", ",", " ", "tend_"}], "}"}], ",", " ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"gropt", "=", 
       RowBox[{"MyFilterOptions", "[", 
        RowBox[{"GraphicsRow", ",", " ", "opt"}], "]"}]}], "}"}], ",", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"GraphicsRow", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"MultiPlot", "[", 
          RowBox[{"solution", ",", " ", 
           RowBox[{"{", "#", "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"t", ",", " ", "tstart", ",", " ", "tend"}], "}"}], ",", 
           " ", "opt", ",", " ", 
           RowBox[{"PlotLabel", "\[Rule]", " ", 
            RowBox[{"ToString", "[", "#", "]"}]}]}], "]"}], "&"}], "/@", 
        RowBox[{"{", "var", "}"}]}], ",", " ", "gropt"}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.449058310692983*^9, 3.449058512264515*^9}, {
  3.449058554382873*^9, 3.449058555513713*^9}, {3.449058594858929*^9, 
  3.44905860284137*^9}},ExpressionUUID->"2b6d37c4-7fab-49ad-a305-\
36a96da06302"]
}, Closed]],

Cell[CellGroupData[{

Cell["GeometricSnapShot", "Subsection",
 CellChangeTimes->{{3.449001289150461*^9, 
  3.449001294798336*^9}},ExpressionUUID->"6635f162-a16b-4f2a-99d1-\
2945aeb976b0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GeometricSnapShot", "[", 
    RowBox[{
     RowBox[{"tissue_", "?", "TissueQ"}], ",", " ", "solution_", ",", " ", 
     RowBox[{"{", 
      RowBox[{"x_", ",", " ", "y_"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"timeVariable_", ",", " ", "time_"}], "}"}], ",", " ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c", ",", "e", ",", " ", "n", ",", " ", "v", ",", " ", "p"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "=", 
       RowBox[{"TissueCells", "[", "tissue", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"e", "=", 
       RowBox[{"TissueEdges", "[", "tissue", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"NTissueVertices", "[", "tissue", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", " ", 
      RowBox[{"v", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"x", "[", "#", "]"}], "[", "timeVariable", "]"}], ",", 
              " ", 
              RowBox[{
               RowBox[{"y", "[", "#", "]"}], "[", "timeVariable", "]"}]}], 
             "}"}], "&"}], "/@", 
           RowBox[{"Range", "[", "n", "]"}]}], ")"}], "/.", "solution"}], "/.", 
        RowBox[{"{", 
         RowBox[{"timeVariable", "\[Rule]", " ", "time"}], "}"}]}]}], " ", 
      ";", "\[IndentingNewLine]", 
      RowBox[{"p", "=", 
       RowBox[{"Tissue", "[", 
        RowBox[{"v", ",", "e", ",", "c"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"p", "=", 
       RowBox[{"ShowTissue", "[", 
        RowBox[{"p", ",", " ", "opt"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "p", "]"}], ";"}]}], " ", "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GeometricSnapShot", "[", 
     RowBox[{"DT_DTissue", ",", " ", "x___"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "T", "}"}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"T", "=", 
        RowBox[{"DTissue2Tissue", "[", "DT", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"GeometricSnapShot", "[", 
        RowBox[{"T", ",", " ", "x"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], " ", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GeometricSnapShot", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Expecting GeometricSnapShot[Tissue, solution, {x,y}, \
{timevariable, time}]\>\"", "]"}], ";", " ", 
      RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.449001295620476*^9, 3.44900137684172*^9}, {
  3.449001419938926*^9, 3.449001524432122*^9}, {3.449001787951539*^9, 
  3.44900181528268*^9}, {3.449001860923253*^9, 3.449001886030495*^9}, {
  3.449001921961017*^9, 3.449001972060937*^9}, {3.449002037163716*^9, 
  3.449002050016493*^9}, {3.561502097090662*^9, 3.561502211354444*^9}, {
  3.561502313327046*^9, 3.561502338037465*^9}, {3.5615024480620823`*^9, 
  3.561502476807768*^9}},ExpressionUUID->"7edbdd49-9728-4c39-825c-\
d4e0b37fa006"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Shapes", "Section",
 CellChangeTimes->{{3.446838589686492*^9, 
  3.446838590702457*^9}},ExpressionUUID->"2c758c77-8eb3-45ec-8d40-\
b6ceedf00a77"],

Cell[CellGroupData[{

Cell["regularPolygon", "Subsection",
 CellChangeTimes->{{3.446838605656767*^9, 3.44683860941035*^9}, {
   3.446838698671276*^9, 3.446838699582169*^9}, 
   3.7057109492925367`*^9},ExpressionUUID->"5ac4a78b-31d6-4733-a884-\
0aad6b2c7411"],

Cell[BoxData[
 RowBox[{
  RowBox[{"regularPolygon", "[", 
   RowBox[{"n_", ",", 
    RowBox[{"start_:", " ", "0"}], ",", 
    RowBox[{"aspect_:", " ", "1.0"}], ",", 
    RowBox[{"rnd_:", "-", "1"}], ",", 
    RowBox[{"rotationAngle_:", " ", "0"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"v", ",", "angles", ",", "rv", ",", "RM"}], "}"}], ",", 
    RowBox[{"(*", 
     RowBox[{
     "generate", " ", "the", " ", "precise", " ", "vertex", " ", 
      "coordinates"}], "*)"}], 
    RowBox[{
     RowBox[{"angles", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"j", ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"0.0", "+", "start"}], ",", 
          RowBox[{"0.0", "+", "start", "+", 
           RowBox[{"2.0", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"n", "-", "1"}], ")"}], "/", "n"}], ")"}], " ", 
            "Pi"}]}], ",", 
          RowBox[{"2.0", "*", 
           RowBox[{"Pi", "/", "n"}]}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"v", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", "#", "]"}], ",", 
          RowBox[{"aspect", "*", 
           RowBox[{"Sin", "[", "#", "]"}]}]}], "}"}], "&"}], "/@", 
       "angles"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"add", " ", "randomness", " ", "if", " ", "desired"}], "*)"}], 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"rnd", ">", "0"}], ",", 
       RowBox[{
        RowBox[{"rv", ":=", 
         RowBox[{"RandomReal", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "rnd"}], ",", "rnd"}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"v", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"rv", ",", "rv"}], "}"}], "+", "#"}], "&"}], ",", "v"}],
           "]"}]}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "rotation", " ", "through", " ", "an", " ", "angle", " ", 
       "rotationAngle"}], "*)"}], 
     RowBox[{"RM", "=", 
      RowBox[{"RotationMatrix", "[", "rotationAngle", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"v", "=", 
      RowBox[{"v", ".", "RM"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "v", "]"}], ";"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.446838694840952*^9, 3.44683869571164*^9}, 
   3.705710950389983*^9},ExpressionUUID->"94e60b2f-58a9-4cdf-a6cd-\
f41088b7b4b1"]
}, Closed]],

Cell[CellGroupData[{

Cell["RegularStar", "Subsection",
 CellChangeTimes->{{3.446838646864353*^9, 3.446838649417566*^9}, {
  3.446839279258344*^9, 
  3.446839280158879*^9}},ExpressionUUID->"90fa0851-c058-412f-bc90-\
a496e9704645"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RegularStar", "[", 
   RowBox[{"npoints_", ",", 
    RowBox[{"ROverr_:", " ", "0"}], ",", 
    RowBox[{"start_:", " ", "0"}], ",", 
    RowBox[{"aspect_:", " ", "1.0"}], ",", 
    RowBox[{"rand_:", "-", "1"}], ",", 
    RowBox[{"rotationAngle_:", " ", "0"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "v", ",", "n", ",", "angles", ",", "rv", ",", "RM", ",", "Rr", ",", 
      "mults", ",", "rnd"}], "}"}], ",", 
    RowBox[{"(*", 
     RowBox[{
     "generate", " ", "the", " ", "precise", " ", "vertex", " ", 
      "coordinates"}], "*)"}], 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{"npoints", "*", "2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rnd", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"rand", ">", "0"}], ",", "rand", ",", "0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Rr", "=", 
      RowBox[{"Abs", "[", "ROverr", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Rr", "\[Equal]", "0"}], ",", 
       RowBox[{"Rr", "=", "1"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Rr", "<", "1"}], ",", 
       RowBox[{"Rr", "=", 
        RowBox[{"1", "/", "Rr"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"angles", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"j", ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"0.0", "+", "start"}], ",", 
          RowBox[{"0.0", "+", "start", "+", 
           RowBox[{"2.0", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"n", "-", "1"}], ")"}], "/", "n"}], ")"}], " ", 
            "Pi"}]}], ",", 
          RowBox[{"2.0", "*", 
           RowBox[{"Pi", "/", "n"}]}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mults", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"EvenQ", "[", "j", "]"}], ",", "Rr", ",", "1"}], "]"}], 
         "*", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "rnd"}], ",", "rnd"}], "}"}], "]"}]}], ")"}]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "0", ",", 
          RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"v", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", "#", "]"}], ",", 
          RowBox[{"aspect", "*", 
           RowBox[{"Sin", "[", "#", "]"}]}]}], "}"}], "&"}], "/@", 
       "angles"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"v", "=", 
      RowBox[{"mults", "*", "v"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "rotation", " ", "through", " ", "an", " ", "angle", " ", 
       "rotationAngle"}], "*)"}], 
     RowBox[{"RM", "=", 
      RowBox[{"RotationMatrix", "[", "rotationAngle", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"v", "=", 
      RowBox[{"v", ".", "RM"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "v", "]"}], ";"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.446838749618628*^9, 
  3.446838750513906*^9}},ExpressionUUID->"94e53764-816e-436e-b02d-\
c15230631a3d"]
}, Closed]],

Cell[CellGroupData[{

Cell["InertiaMatrix", "Subsection",
 CellChangeTimes->{{3.446839173760506*^9, 
  3.446839185893077*^9}},ExpressionUUID->"ab1137b8-fd2e-4c3d-a7e7-\
124d7091772b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"InertiaMatrix", "[", 
   RowBox[{"{", 
    RowBox[{"xydata__", "?", "PointQ"}], "}"}], "]"}], ":=", 
  RowBox[{"InertiaMatrix", "[", "xydata", "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InertiaMatrix", "[", 
     RowBox[{"xydata__", "?", "PointQ"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "v", ",", "n", ",", "Ixx", ",", "Ixy", ",", "Iyy", ",", "x", ",", "y", 
        ",", "Inertia"}], "}"}], ",", 
      RowBox[{
       RowBox[{"v", "=", 
        RowBox[{"{", "xydata", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "v", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"v", ",", 
         RowBox[{"v", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"x", "[", "i_", "]"}], ":=", 
        RowBox[{"v", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"y", "[", "i_", "]"}], ":=", 
        RowBox[{"v", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Ixx", "=", "0"}], ";", 
       RowBox[{"Ixy", "=", "0"}], ";", 
       RowBox[{"Iyy", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "2"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"n", "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", 
         RowBox[{
          RowBox[{"Ixx", "=", 
           RowBox[{"Ixx", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"x", "[", "i", "]"}], "^", "3"}], "+", 
               RowBox[{
                RowBox[{
                 RowBox[{"x", "[", "i", "]"}], "^", "2"}], " ", 
                RowBox[{"x", "[", 
                 RowBox[{"i", "-", "1"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"x", "[", "i", "]"}], " ", 
                RowBox[{
                 RowBox[{"x", "[", 
                  RowBox[{"i", "-", "1"}], "]"}], "^", "2"}]}], "+", 
               RowBox[{
                RowBox[{"x", "[", 
                 RowBox[{"i", "-", "1"}], "]"}], "^", "3"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"y", "[", "i", "]"}], "-", 
               RowBox[{"y", "[", 
                RowBox[{"i", "-", "1"}], "]"}]}], ")"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Iyy", "=", 
           RowBox[{"Iyy", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"y", "[", "i", "]"}], "^", "3"}], "+", 
               RowBox[{
                RowBox[{
                 RowBox[{"y", "[", "i", "]"}], "^", "2"}], " ", 
                RowBox[{"y", "[", 
                 RowBox[{"i", "-", "1"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"y", "[", "i", "]"}], " ", 
                RowBox[{
                 RowBox[{"y", "[", 
                  RowBox[{"i", "-", "1"}], "]"}], "^", "2"}]}], "+", 
               RowBox[{
                RowBox[{"y", "[", 
                 RowBox[{"i", "-", "1"}], "]"}], "^", "3"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"x", "[", "i", "]"}], "-", 
               RowBox[{"x", "[", 
                RowBox[{"i", "-", "1"}], "]"}]}], ")"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Ixy", "=", 
           RowBox[{"Ixy", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"y", "[", "i", "]"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"3", " ", 
                   RowBox[{
                    RowBox[{"x", "[", "i", "]"}], "^", "2"}]}], "+", 
                  RowBox[{"2", " ", 
                   RowBox[{"x", "[", "i", "]"}], " ", 
                   RowBox[{"x", "[", 
                    RowBox[{"i", "-", "1"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"x", "[", 
                    RowBox[{"i", "-", "1"}], "]"}], "^", "2"}]}], ")"}]}], 
               "+", 
               RowBox[{
                RowBox[{"y", "[", 
                 RowBox[{"i", "-", "1"}], "]"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"x", "[", "i", "]"}], "^", "2"}], "+", 
                  RowBox[{"2", " ", 
                   RowBox[{"x", "[", "i", "]"}], " ", 
                   RowBox[{"x", "[", 
                    RowBox[{"i", "-", "1"}], "]"}]}], "+", 
                  RowBox[{"3", " ", 
                   RowBox[{
                    RowBox[{"x", "[", 
                    RowBox[{"i", "-", "1"}], "]"}], "^", "2"}]}]}], ")"}]}]}],
               ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"y", "[", "i", "]"}], "-", 
               RowBox[{"y", "[", 
                RowBox[{"i", "-", "1"}], "]"}]}], ")"}]}]}]}]}]}], "]"}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"Ixx", "=", 
        RowBox[{
         RowBox[{"Abs", "[", "Ixx", "]"}], "/", "12"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Iyy", "=", 
        RowBox[{
         RowBox[{"Abs", "[", "Iyy", "]"}], "/", "12"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Ixy", "=", 
        RowBox[{
         RowBox[{"Abs", "[", "Ixy", "]"}], "/", "24"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Inertia", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Ixx", ",", "Ixy"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Ixy", ",", "Iyy"}], "}"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "Inertia", "]"}], ";"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InertiaMatrix", "[", 
    RowBox[{
     RowBox[{"tis_", "?", "TissueQ"}], ",", 
     RowBox[{"n_", "?", "IntegerQ"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"n", "<", "1"}], " ", "\[Or]", " ", 
         RowBox[{"n", ">", 
          RowBox[{"NTissueCells", "[", "tis", "]"}]}]}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Error: InertiaMatrix[tissue,\>\"", ",", "n", ",", 
           "\"\<]; tissue only has \>\"", ",", " ", 
           RowBox[{"NTissueCells", "[", "tis", "]"}], ",", 
           "\"\< cells.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"InertiaMatrix", "[", 
        RowBox[{"CellVertexCoordinates", "[", 
         RowBox[{"tis", ",", "n"}], "]"}], "]"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InertiaMatrix", "[", 
     RowBox[{"tis_", "?", "TissueQ"}], "]"}], ":=", " ", 
    RowBox[{"InertiaMatrix", "/@", 
     RowBox[{"CellVertexCoordinates", "[", "tis", "]"}]}]}], ";"}], " ", 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InertiaMatrix", "[", "x___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
     "Print", "[", 
      "\"\<Error: Expecting InertiaMatrix[point1, point2, ...] or \
\\nInertiaMatrix[tissue,n] or \\nInertiaMatrix[tissue]\>\"", "]"}], ";", " ", 
     "$Failed"}], ")"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.446839178567347*^9, 3.446839272748975*^9}, {
  3.455062064370709*^9, 3.455062162773982*^9}, {3.45506221388317*^9, 
  3.4550622592793617`*^9}, {3.455062359758663*^9, 
  3.455062388619752*^9}},ExpressionUUID->"689e9f4c-6407-478c-b37e-\
215a24a4a488"]
}, Closed]],

Cell[CellGroupData[{

Cell["Mass", "Subsection",
 CellChangeTimes->{{3.446839648156895*^9, 
  3.44683964856243*^9}},ExpressionUUID->"54394051-ebfc-4790-9e6d-\
26717eb11d19"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Mass", "[", 
     RowBox[{"{", 
      RowBox[{"xydata__", "?", "PointQ"}], "}"}], "]"}], ":=", " ", 
    RowBox[{"Mass", "[", "xydata", "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Mass", "[", 
    RowBox[{"xydata__", "?", "PointQ"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v", ",", "j", ",", "n", ",", "x", ",", "y", ",", "mass"}], 
      "}"}], ",", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "will", " ", "be", " ", "negative", " ", "if", " ", "cells", " ", 
        "are", " ", "clockwise"}], ",", 
       RowBox[{"positive", " ", "otherwise"}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"v", "=", 
       RowBox[{"{", "xydata", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "v", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"mass", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"x", "[", "i_", "]"}], ":=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"i", "\[Equal]", "0"}], ",", 
         RowBox[{"v", "[", 
          RowBox[{"[", 
           RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"v", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"y", "[", "i_", "]"}], ":=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"i", "\[Equal]", "0"}], ",", 
         RowBox[{"v", "[", 
          RowBox[{"[", 
           RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{"v", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "0"}], ",", 
        RowBox[{"j", "<", "n"}], ",", 
        RowBox[{"j", "++"}], ",", 
        RowBox[{
         RowBox[{"mass", "=", 
          RowBox[{"mass", "+", 
           RowBox[{
            RowBox[{"x", "[", "j", "]"}], "*", 
            RowBox[{"y", "[", 
             RowBox[{"j", "+", "1"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{"j", "+", "1"}], "]"}], " ", 
            RowBox[{"y", "[", "j", "]"}]}]}]}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"mass", "=", 
       RowBox[{"mass", "/", "2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "mass", "]"}], ";"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MassSign", "[", 
    RowBox[{"xydata__", "?", "PointQ"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "m", "}"}], ",", 
     RowBox[{
      RowBox[{"m", "=", 
       RowBox[{"Mass", "[", "xydata", "]"}]}], ";", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"m", "\[NotEqual]", "0"}], ",", 
        RowBox[{"m", "=", 
         RowBox[{"m", "/", 
          RowBox[{"Abs", "[", "m", "]"}]}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "m", "]"}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MassSign", "[", 
    RowBox[{"{", 
     RowBox[{"x__", "?", "PointQ"}], "}"}], "]"}], ":=", 
   RowBox[{"MassSign", "[", "x", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Mass", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", "\"\<Expecting Mass[..list of points..]\>\"", "]"}], ";", 
      " ", 
      RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.446839656134309*^9, 3.446839691989489*^9}, {
  3.446839918106633*^9, 3.446839929301408*^9}, {3.5590849416056767`*^9, 
  3.559084964982678*^9}},ExpressionUUID->"34909300-ffde-4400-bd78-\
976da6170d16"]
}, Closed]],

Cell[CellGroupData[{

Cell["areafunction (formerly Area)", "Subsection",
 CellChangeTimes->{{3.446839531213762*^9, 3.446839531653427*^9}, {
  3.705951420830779*^9, 
  3.705951428362981*^9}},ExpressionUUID->"4cce845c-2238-4c39-af47-\
532c765cdabd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"areafunction", "[", 
     RowBox[{"{", "}"}], "]"}], ":=", " ", "0"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"areafunction", "[", 
     RowBox[{"xydata__", "?", "PointQ"}], "]"}], ":=", 
    RowBox[{"Abs", "[", 
     RowBox[{"Mass", "[", "xydata", "]"}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"areafunction", "[", 
     RowBox[{"{", 
      RowBox[{"xydata__", "?", "PointQ"}], "}"}], "]"}], ":=", 
    RowBox[{"areafunction", "[", "xydata", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"areafunction", "[", 
     RowBox[{
      RowBox[{"tis_", "?", "TissueQ"}], ",", " ", 
      RowBox[{"i_", "?", "IntegerQ"}]}], "]"}], ":=", " ", 
    RowBox[{"areafunction", "[", 
     RowBox[{"CellVertexCoordinates", "[", 
      RowBox[{"tis", ",", "i"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"areafunction", "[", 
    RowBox[{
     RowBox[{"tis_", "?", "TissueQ"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i__", "?", "IntegerQ"}], "}"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "cvc", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cvc", " ", "=", " ", 
       RowBox[{"CellVertexCoordinates", "[", "tis", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"cvc", " ", "=", " ", 
       RowBox[{"cvc", "[", 
        RowBox[{"[", 
         RowBox[{"{", "i", "}"}], "]"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"areafunction", "/@", "cvc"}], "]"}], ";"}]}], " ", 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"areafunction", "[", 
     RowBox[{"tis_", "?", "TissueQ"}], "]"}], ":=", " ", 
    RowBox[{"areafunction", "/@", 
     RowBox[{"CellVertexCoordinates", "[", "tis", "]"}]}]}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"areafunction", "[", 
     RowBox[{"DT_", "?", "DTissueQ"}], "]"}], ":=", " ", 
    RowBox[{"areafunction", "/@", 
     RowBox[{"CellVertexCoordinates", "[", "DT", "]"}]}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"areafunction", "[", 
     RowBox[{
      RowBox[{"DT_", "?", "DTissueQ"}], ",", " ", 
      RowBox[{"i_", "?", "IntegerQ"}]}], "]"}], ":=", " ", 
    RowBox[{"areafunction", "[", 
     RowBox[{"CellVertexCoordinates", "[", 
      RowBox[{"DT", ",", "i"}], "]"}], "]"}]}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"areafunction", "[", 
     RowBox[{"P_", "?", "PointList3DQ"}], "]"}], ":=", " ", 
    RowBox[{"PolygonArea", "[", "P", "]"}]}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"areafunction", "[", "x___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<Expecting areafunction[P1, P2, ...] or areafunction[tissue, i] or \
areafunction[tissue], not \>\"", ",", " ", "x"}], "]"}], ";", " ", "$Failed", 
     ";", " ", 
     RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.446839535858194*^9, 3.446839598590862*^9}, {
   3.446839711413702*^9, 3.446839714861324*^9}, {3.446839754326276*^9, 
   3.446839772034912*^9}, {3.452328138603052*^9, 3.4523281855282793`*^9}, {
   3.452328288588202*^9, 3.452328325995894*^9}, {3.452328708470128*^9, 
   3.452328716353593*^9}, {3.456699424611848*^9, 3.456699456556116*^9}, {
   3.456699524802924*^9, 3.4566995505853786`*^9}, 3.456699628805702*^9, {
   3.547147007924474*^9, 3.54714709853415*^9}, {3.559084846160698*^9, 
   3.559084852223626*^9}, {3.561556598932426*^9, 3.561556616698222*^9}, {
   3.705711170461268*^9, 3.705711235596209*^9}, {3.7057113742245207`*^9, 
   3.70571140952081*^9}, {3.705711654502481*^9, 3.705711655995345*^9}, {
   3.705949924985222*^9, 
   3.7059499501646223`*^9}},ExpressionUUID->"032ebb94-cd73-40ad-a856-\
6876c5bac9e0"]
}, Closed]],

Cell[CellGroupData[{

Cell["CentroidFormula", "Subsection",
 CellChangeTimes->{{3.574027008149226*^9, 
  3.5740270106282787`*^9}},ExpressionUUID->"e364f237-72e8-49c0-9d7b-\
9952c2a14687"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CentroidFormula", "[", 
   RowBox[{"T_Tissue", ",", "j_", ",", " ", "x_", ",", "y_", ",", "area_"}], 
   "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "cv", ",", "n", ",", "myx", ",", "myy", ",", "f", ",", "XVAR", ",", 
      "YVAR", ",", "sign"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cv", "=", 
      RowBox[{"CellVertexNumbers", "[", 
       RowBox[{"T", ",", "j"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sign", "=", 
      RowBox[{"MassSign", "[", 
       RowBox[{"CellVertexCoordinates", "[", 
        RowBox[{"T", ",", "j"}], "]"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "cv", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"myx", "[", "i_", "]"}], ":=", " ", 
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"cv", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], "[", "Global`t", "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"myy", "[", "i_", "]"}], ":=", " ", 
      RowBox[{
       RowBox[{"y", "[", 
        RowBox[{"cv", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], "[", "Global`t", "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"f", "=", 
      RowBox[{"CentroidFormula", "[", 
       RowBox[{"XVAR", ",", "YVAR", ",", "n"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"sign", "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"f", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"XVAR", "\[Rule]", " ", "myx"}], ",", " ", 
           RowBox[{"YVAR", "\[Rule]", " ", "myy"}]}], "}"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"6", "*", 
         RowBox[{
          RowBox[{"area", "[", "j", "]"}], "[", "Global`t", "]"}]}], 
        ")"}]}]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.574027717119979*^9, 3.574027836480742*^9}, {
  3.5740278715620737`*^9, 3.5740279938858137`*^9}, {3.574028050054652*^9, 
  3.574028063662088*^9}, {3.5740280962389383`*^9, 3.574028104636079*^9}, {
  3.574028137974177*^9, 3.5740281398745413`*^9}, {3.574028218742818*^9, 
  3.5740282215064297`*^9}, {3.5740285984762497`*^9, 
  3.5740286401228724`*^9}},ExpressionUUID->"42f74a92-3087-48b6-b2ca-\
d36bb8f44168"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CentroidFormula", "[", 
   RowBox[{"xvar_", ",", "yvar_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "y", ",", " ", "cx", ",", " ", "cy", ",", "j"}], "}"}],
     ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"x", "[", "0", "]"}], ":=", " ", 
      RowBox[{"xvar", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"x", "[", "i_", "]"}], ":=", " ", 
      RowBox[{"xvar", "[", "i", "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"y", "[", "0", "]"}], ":=", " ", 
      RowBox[{"yvar", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"y", "[", "i_", "]"}], ":=", 
      RowBox[{"yvar", "[", "i", "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"cx", " ", "=", " ", 
      RowBox[{"cy", " ", "=", " ", "0"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", "0"}], ",", 
       RowBox[{"j", "<", "n"}], ",", 
       RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cx", "=", 
         RowBox[{"cx", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"x", "[", "j", "]"}], "+", 
             RowBox[{"x", "[", 
              RowBox[{"j", "+", "1"}], "]"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"x", "[", "j", "]"}], " ", 
              RowBox[{"y", "[", 
               RowBox[{"j", "+", "1"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"j", "+", "1"}], "]"}], " ", 
              RowBox[{"y", "[", "j", "]"}]}]}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"cy", "=", 
         RowBox[{"cy", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "j", "]"}], "+", 
             RowBox[{"y", "[", 
              RowBox[{"j", "+", "1"}], "]"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"x", "[", "j", "]"}], " ", 
              RowBox[{"y", "[", 
               RowBox[{"j", "+", "1"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"j", "+", "1"}], "]"}], " ", 
              RowBox[{"y", "[", "j", "]"}]}]}], ")"}]}]}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"cx", ",", " ", "cy"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5740270130623827`*^9, 3.574027171774509*^9}, {
  3.574027238664673*^9, 3.5740272524700336`*^9}, {3.574027317256695*^9, 
  3.574027320943041*^9}, {3.574027361776435*^9, 
  3.574027416768839*^9}},ExpressionUUID->"7a6a1788-77e6-4bb1-b509-\
a1c26a36390d"]
}, Closed]],

Cell[CellGroupData[{

Cell["Centroid", "Subsection",
 CellChangeTimes->{{3.446839427282797*^9, 
  3.446839431324315*^9}},ExpressionUUID->"05f3564f-d678-4671-94b1-\
0d26e941ca88"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Centroid", "[", 
     RowBox[{"{", 
      RowBox[{"xydata__", "?", "PointQ"}], "}"}], "]"}], ":=", " ", 
    RowBox[{"Centroid", "[", "xydata", "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Centroid", "[", 
    RowBox[{"xydata__", "?", "PointQ"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "v", ",", "j", ",", "n", ",", "x", ",", "y", ",", "cx", ",", "cy", ",", 
       "area", ",", "sign", ",", "centroid"}], "}"}], ",", 
     RowBox[{
      RowBox[{"v", "=", 
       RowBox[{"{", "xydata", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "v", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cx", "=", 
       RowBox[{"cy", "=", "0"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sign", "=", 
       RowBox[{"MassSign", "[", "xydata", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"area", "=", 
       RowBox[{"areafunction", "[", "xydata", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"x", "[", "i_", "]"}], ":=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"i", "\[Equal]", "0"}], ",", 
         RowBox[{"v", "[", 
          RowBox[{"[", 
           RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"v", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"y", "[", "i_", "]"}], ":=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"i", "\[Equal]", "0"}], ",", 
         RowBox[{"v", "[", 
          RowBox[{"[", 
           RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{"v", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "0"}], ",", 
        RowBox[{"j", "<", "n"}], ",", 
        RowBox[{"j", "++"}], ",", 
        RowBox[{
         RowBox[{"cx", "=", 
          RowBox[{"cx", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"x", "[", "j", "]"}], "+", 
              RowBox[{"x", "[", 
               RowBox[{"j", "+", "1"}], "]"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"x", "[", "j", "]"}], " ", 
               RowBox[{"y", "[", 
                RowBox[{"j", "+", "1"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{"j", "+", "1"}], "]"}], " ", 
               RowBox[{"y", "[", "j", "]"}]}]}], ")"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"cy", "=", 
          RowBox[{"cy", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"y", "[", "j", "]"}], "+", 
              RowBox[{"y", "[", 
               RowBox[{"j", "+", "1"}], "]"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"x", "[", "j", "]"}], " ", 
               RowBox[{"y", "[", 
                RowBox[{"j", "+", "1"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{"j", "+", "1"}], "]"}], " ", 
               RowBox[{"y", "[", "j", "]"}]}]}], ")"}]}]}]}], ";"}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"area", ",", "0"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"centroid", "=", 
          RowBox[{"sign", "*", 
           RowBox[{"{", 
            RowBox[{"cx", ",", "cy"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
         
         RowBox[{"centroid", "=", 
          RowBox[{"Centeroid", "[", 
           RowBox[{"{", "xydata", "}"}], "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "centroid", "]"}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Equal", "[", 
         RowBox[{"area", ",", "0"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"centroid", "=", 
          RowBox[{"sign", "*", 
           RowBox[{"{", 
            RowBox[{"cx", ",", "cy"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
         
         RowBox[{"centroid", "=", 
          RowBox[{"Centeroid", "[", 
           RowBox[{"{", "xydata", "}"}], "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "centroid", "]"}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"centroid", "=", 
       RowBox[{"sign", "*", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"cx", ",", "cy"}], "}"}], "/", 
         RowBox[{"(", 
          RowBox[{"6", "*", "area"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "centroid", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Centroid", "[", 
     RowBox[{"tiss_", "?", "TissueQ"}], "]"}], ":=", " ", 
    RowBox[{"Centroid", "/@", 
     RowBox[{"CellVertexCoordinates", "[", "tiss", "]"}]}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Centroid", "[", 
     RowBox[{
      RowBox[{"tiss_", "?", "TissueQ"}], ",", " ", 
      RowBox[{"cellNumber_", "?", "IntegerQ"}]}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"Centroid", "[", 
      RowBox[{"tiss", ",", " ", 
       RowBox[{"{", "cellNumber", "}"}]}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Centroid", "[", 
    RowBox[{
     RowBox[{"tiss_", "?", "TissueQ"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"cells__", "?", "IntegerQ"}], "}"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cvc", ",", " ", "centroids", ",", "n"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cvc", " ", "=", " ", 
       RowBox[{"CellVertexCoordinates", "[", "tiss", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"NTissueCells", "[", "tiss", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", ">", "n"}], ")"}], "\[Or]", 
           RowBox[{"(", 
            RowBox[{"#", "<", "1"}], ")"}]}], ",", " ", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Error: Centroid: Cell \>\"", ",", " ", "#", ",", " ", 
            "\"\< does not exist.\>\""}], "]"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "cells", "}"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"cvc", " ", "=", " ", 
       RowBox[{"cvc", "[", 
        RowBox[{"[", 
         RowBox[{"{", "cells", "}"}], "]"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"centroids", " ", "=", " ", 
       RowBox[{"Centroid", "/@", "cvc"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "centroids", "]"}], ";"}]}], " ", 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Centroid", "[", 
     RowBox[{
      RowBox[{"q_", "?", "DTissueQ"}], ",", " ", "x___"}], "]"}], ":=", " ", 
    RowBox[{"Centroid", "[", 
     RowBox[{
      RowBox[{"DTissue2Tissue", "[", "q", "]"}], ",", " ", "x"}], "]"}]}], 
   ";"}], " ", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Centroid", "[", "x___", "]"}], ":=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
     "Print", "[", "\"\<Error: Expecting Centroid[{v1,v2, ...}]\>\"", "]"}], 
     ";", " ", "$Failed"}], ")"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.446839461895984*^9, 3.44683946702772*^9}, {
   3.4468396097066*^9, 3.446839613946241*^9}, {3.446839789962728*^9, 
   3.446839791154385*^9}, {3.446840696791044*^9, 3.446840745593558*^9}, {
   3.453222040932521*^9, 3.453222233390233*^9}, {3.453222290427587*^9, 
   3.453222390593988*^9}, {3.4532224245627527`*^9, 3.453222445746829*^9}, {
   3.500423334323045*^9, 3.500423338602271*^9}, {3.5490596048754473`*^9, 
   3.549059635484146*^9}, {3.559085071757105*^9, 3.559085100439575*^9}, {
   3.559085422751338*^9, 3.5590854439575253`*^9}, {3.55908561875799*^9, 
   3.5590856263127117`*^9}, {3.5740267883900557`*^9, 3.5740268308242683`*^9}, 
   3.705711426703204*^9},ExpressionUUID->"38d42d55-823b-4a0b-88fb-\
272ec9738f0b"]
}, Closed]],

Cell[CellGroupData[{

Cell["Centeroid", "Subsection",
 CellChangeTimes->{{3.558373073777863*^9, 
  3.558373075761718*^9}},ExpressionUUID->"f225e097-f678-4d36-9bf5-\
5bfaabfc0676"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Centeroid", "[", 
    RowBox[{"{", 
     RowBox[{"xydata__", "?", "PointQ"}], "}"}], "]"}], ":=", " ", 
   RowBox[{"Mean", "[", 
    RowBox[{"{", "xydata", "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Centeroid", "[", 
    RowBox[{"T_", "?", "ISTissue"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "cvc", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cvc", "=", 
       RowBox[{"CellVertexCoordinates", "[", "T", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"Centeroid", "/@", "cvc"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Centeroid", "[", 
    RowBox[{
     RowBox[{"T_", "?", "ISTissue"}], ",", " ", "n_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "cvc", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cvc", "=", 
       RowBox[{"CellVertexCoordinates", "[", 
        RowBox[{"T", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Centeroid", "[", "cvc", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Centeroid", "[", "x___", "]"}], ":=", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<Expecting Centeroid[{{x1,y1},{x2,y2},...}] or Centeroid[Tissue] or \
Centeroid[Tissue,number], not:\>\"", ",", " ", "x"}], "]"}], ";", " ", 
    RowBox[{"Abort", "[", "]"}], ";"}], ")"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.558373076840847*^9, 3.5583731497818613`*^9}, {
   3.558373245806232*^9, 3.5583732533508587`*^9}, {3.558384140748891*^9, 
   3.55838415526926*^9}, {3.558384226421043*^9, 3.55838425002862*^9}, {
   3.5583842823246717`*^9, 3.5583842932920027`*^9}, {3.5583843386770277`*^9, 
   3.558384361317399*^9}, {3.55838440774809*^9, 3.558384548746421*^9}, 
   3.558384597641397*^9, {3.5590855944424543`*^9, 
   3.55908559936231*^9}},ExpressionUUID->"ddec6e2d-4ce1-41b0-82e2-\
1417ca0841b7"]
}, Closed]],

Cell[CellGroupData[{

Cell["TissueCentroid", "Subsection",
 CellChangeTimes->{{3.4949330164948673`*^9, 
  3.4949330182468557`*^9}},ExpressionUUID->"19181caa-74e4-46ef-9986-\
851deae058da"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TissueCentroid", "[", "g_Tissue", "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"e", ",", "v", ",", "c", ",", " ", "G"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "create", " ", "a", " ", "tissue", " ", "with", " ", "a", " ", "single",
        " ", "cell", " ", "that", " ", "has", " ", "only", " ", "the", " ", 
       "boundary", " ", "edges"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"e", "=", 
       RowBox[{"TissueEdges", "[", "g", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{"TissueVertices", "[", "g", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{"EdgesOnBoundary", "[", "g", "]"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"G", "=", 
       RowBox[{"Tissue", "[", 
        RowBox[{"v", ",", "e", ",", "c"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "need", " ", "to", " ", "sort", " ", "the", " ", "edges", " ", "to", 
        " ", "make", " ", "the", " ", "algorithm", " ", "work", " ", 
        "properly"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{"\"\<Edges\>\"", "/.", 
         RowBox[{
          RowBox[{"SortCellsCounterClockwise", "[", "G", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"G", "=", 
       RowBox[{"Tissue", "[", 
        RowBox[{"v", ",", "e", ",", "c"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Centroid", "[", 
       RowBox[{"G", ",", "1"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TissueCentroid", "[", "g_DTissue", "]"}], ":=", " ", 
    RowBox[{"TissueCentroid", "[", 
     RowBox[{"DTissue2Tissue", "[", "g", "]"}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TissueCentroid", "[", "x___", "]"}], ":=", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
    "Print", "[", "\"\<Unexpected Input for TissueCentroid[]\>\"", "]"}], ";",
     " ", 
    RowBox[{"{", 
     RowBox[{"Indeterminate", ",", " ", "Indeterminate"}], "}"}]}], 
   ")"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.494933049869267*^9, 3.494933164156143*^9}, {
  3.494933255637939*^9, 3.494933331241912*^9}, {3.49493336917933*^9, 
  3.4949334096056843`*^9}, {3.5485179789755077`*^9, 3.548518035468377*^9}, {
  3.54851811040232*^9, 3.548518112076035*^9}, {3.5490595554632807`*^9, 
  3.549059578438362*^9}, {3.549059647535829*^9, 
  3.549059691131043*^9}},ExpressionUUID->"570b9fde-695b-4f8e-85d5-\
88799ceaee67"]
}, Closed]],

Cell[CellGroupData[{

Cell["PerimeterFormula", "Subsection",
 CellChangeTimes->{{3.574031178080222*^9, 
  3.574031181967703*^9}},ExpressionUUID->"89185236-9c8c-4f63-b714-\
85b20377cd51"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PerimeterFormula", "[", 
   RowBox[{"T_Tissue", ",", "j_", ",", " ", "edgeVariable_"}], "]"}], ":=", 
  " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "c", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"c", "=", 
      RowBox[{
       RowBox[{"TissueCells", "[", "T", "]"}], "[", 
       RowBox[{"[", "j", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Plus", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"edgeVariable", "[", "#", "]"}], "[", "Global`t", "]"}], 
         "&"}], "/@", "c"}], ")"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5740312190756273`*^9, 3.574031271109947*^9}, {
  3.574031323710661*^9, 
  3.574031418297621*^9}},ExpressionUUID->"7e123abc-8da7-4785-b3c0-\
6a3562bbf519"]
}, Closed]],

Cell[CellGroupData[{

Cell["perimeterLength", "Subsection",
 CellChangeTimes->{{3.446839991319931*^9, 3.446840000031572*^9}, {
   3.5740309984806633`*^9, 3.574030999921673*^9}, 
   3.705711810386012*^9},ExpressionUUID->"2c061600-108f-424c-80f1-\
3445a171647d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"perimeterLength", "[", 
    RowBox[{"{", 
     RowBox[{"points__", "?", "PointQ"}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pts", ",", "c"}], "}"}], ",", 
     RowBox[{
      RowBox[{"pts", "=", 
       RowBox[{"Partition", "[", 
        RowBox[{
         RowBox[{"{", "points", "}"}], ",", "2", ",", "1", ",", "1"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"distance", "@@", "#"}], "&"}], "/@", "pts"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"Plus", "@@", "c"}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"perimeterLength", "[", 
     RowBox[{"points__", "?", "PointQ"}], "]"}], ":=", " ", 
    RowBox[{"perimeterLength", "[", 
     RowBox[{"{", "points", "}"}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"perimeterLength", "[", 
     RowBox[{
      RowBox[{"tissue_", "?", "TissueQ"}], ",", " ", "i_"}], "]"}], ":=", " ", 
    RowBox[{"perimeterLength", "[", 
     RowBox[{"CellVertexCoordinates", "[", 
      RowBox[{"tissue", ",", "i"}], "]"}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"perimeterLength", "[", 
     RowBox[{
      RowBox[{"tissue_", "?", "DTissueQ"}], ",", " ", "i_"}], "]"}], ":=", 
    " ", 
    RowBox[{"perimeterLength", "[", 
     RowBox[{"CellVertexCoordinates", "[", 
      RowBox[{"tissue", ",", "i"}], "]"}], "]"}]}], ";"}], " ", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"perimeterLength", "[", 
     RowBox[{"tissue_", "?", "TissueQ"}], "]"}], ":=", " ", 
    RowBox[{"perimeterLength", "/@", 
     RowBox[{"CellVertexCoordinates", "[", "tissue", "]"}]}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"perimeterLength", "[", 
    RowBox[{"tissue_", "?", "DTissueQ"}], "]"}], ":=", " ", 
   RowBox[{"perimeterLength", "[", 
    RowBox[{"DTissue2Tissue", "[", "tissue", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"perimeterLength", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Error: Expecting perimeterLength[Point1, Point2, ...] or \
\\nperimeterLength[tissue] or \\nperimeterLength[tissue, i]\>\"", "]"}], ";", 
      " ", "$Failed"}], ")"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.446840024731774*^9, 3.446840111977274*^9}, 
   3.446840153209142*^9, {3.455127459743202*^9, 3.455127541351643*^9}, {
   3.561555710091255*^9, 3.5615557115554743`*^9}, {3.561555822936983*^9, 
   3.561555867632885*^9}, {3.561555903185298*^9, 3.5615559412971697`*^9}, {
   3.705711813768094*^9, 
   3.705711831734071*^9}},ExpressionUUID->"110a1639-86c4-468c-abae-\
9b34082632e1"]
}, Closed]],

Cell[CellGroupData[{

Cell["IsoPerimetricRatio", "Subsection",
 CellChangeTimes->{{3.561556010992773*^9, 
  3.561556014416608*^9}},ExpressionUUID->"462839ad-5d26-4fde-87ca-\
5ef08a9cf72b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"IsoPerimetricRatio", "[", 
    RowBox[{"{", 
     RowBox[{"points__", "?", "PointQ"}], "}"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "P", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"P", "=", 
       RowBox[{"{", "points", "}"}]}], ";", "  ", "\[IndentingNewLine]", 
      RowBox[{"4", "Pi", " ", 
       RowBox[{
        RowBox[{"areafunction", "[", "P", "]"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"perimeterLength", "[", "P", "]"}], "^", "2"}], 
         ")"}]}]}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IsoPerimetricRatio", "[", 
     RowBox[{
      RowBox[{"T_", "?", "TissueQ"}], ",", " ", "n_"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "cell", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"cell", "=", 
        RowBox[{"CellVertexCoordinates", "[", 
         RowBox[{"T", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"IsoPerimetricRatio", "[", "cell", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IsoPerimetricRatio", "[", 
     RowBox[{
      RowBox[{"DT_", "?", "DTissueQ"}], ",", " ", "n_"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "cell", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"cell", "=", 
        RowBox[{"CellVertexCoordinates", "[", 
         RowBox[{"DT", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"IsoPerimetricRatio", "[", "cell", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IsoPerimetricRatio", "[", 
     RowBox[{"T_", "?", "TissueQ"}], "]"}], ":=", " ", 
    RowBox[{"IsoPerimetricRatio", "/@", 
     RowBox[{"CellVertexCoordinates", "[", "T", "]"}]}]}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IsoPerimetricRatio", "[", 
     RowBox[{"P_", "?", "PointList3DQ"}], "]"}], ":=", " ", 
    RowBox[{"4", "Pi", "*", 
     RowBox[{
      RowBox[{"areafunction", "[", "P", "]"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"perimeterLength", "[", "P", "]"}], "^", "2"}], ")"}]}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IsoPerimetricRatio", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", "\"\<Expecting IsoPerimetricRatio[{points}]\>\"", "]"}], 
      ";", " ", 
      RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.561556015701757*^9, 3.561556068188147*^9}, {
  3.56155621081009*^9, 3.561556288584075*^9}, {3.561556433419478*^9, 
  3.561556547154241*^9}, {3.5615566687072973`*^9, 3.561556734862146*^9}, {
  3.561557185109235*^9, 3.561557209497856*^9}, {3.7057114331045923`*^9, 
  3.705711435570774*^9}, {3.705711849962015*^9, 
  3.70571185143582*^9}},ExpressionUUID->"2583c168-9489-4d5f-968d-\
a90004a7b2b4"]
}, Closed]],

Cell[CellGroupData[{

Cell["Inside", "Subsection",
 CellChangeTimes->{{3.446840296649515*^9, 
  3.44684029754934*^9}},ExpressionUUID->"2b98e7fb-2dde-45ce-9209-\
7e9bcd46eab2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Inside", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"vertices__", "?", "PointQ"}], "}"}], ",", 
      RowBox[{"point_", "?", "PointQ"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "i", ",", "j", ",", "c", ",", "n", ",", "xp", ",", "yp", ",", "x", ",",
         " ", "y", ",", "  ", "points"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"points", "=", 
        RowBox[{"{", "vertices", "}"}]}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}], "=", "point"}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"from", " ", 
          RowBox[{"http", ":"}]}], "//", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
             "local", ".", "wasp", ".", "uwa", ".", "edu", ".", "au"}], "/", 
             RowBox[{"~", "pbourke"}]}], "/", "geometry"}], "/", 
           "insidepoly"}], "/"}]}], "*)"}], 
       RowBox[{
        RowBox[{"xp", "[", "k_", "]"}], ":=", 
        RowBox[{"points", "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"yp", "[", "k_", "]"}], ":=", 
        RowBox[{"points", "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"c", "=", "False"}], ";", "\[IndentingNewLine]", 
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "points", "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"i", "=", "1"}], ";", 
          RowBox[{"j", "=", "n"}], ";"}], ",", 
         RowBox[{"i", "\[LessEqual]", "n"}], ",", 
         RowBox[{"j", "=", 
          RowBox[{"i", "++"}]}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"yp", "[", "i", "]"}], "\[LessEqual]", "y"}], ")"}],
                 "&&", 
                RowBox[{"(", 
                 RowBox[{"y", "<", 
                  RowBox[{"yp", "[", "j", "]"}]}], ")"}]}], ")"}], "||", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"yp", "[", "j", "]"}], "\[LessEqual]", "y"}], ")"}],
                 "&&", 
                RowBox[{"(", 
                 RowBox[{"y", "<", 
                  RowBox[{"yp", "[", "i", "]"}]}], ")"}]}], ")"}]}], ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{"x", "<", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"xp", "[", "j", "]"}], "-", 
                  RowBox[{"xp", "[", "i", "]"}]}], ")"}], "*", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"y", "-", 
                   RowBox[{"yp", "[", "i", "]"}]}], ")"}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"yp", "[", "j", "]"}], "-", 
                   RowBox[{"yp", "[", "i", "]"}]}], ")"}]}]}], "+", 
               RowBox[{"xp", "[", "i", "]"}]}]}], ")"}]}], ",", 
           RowBox[{"c", "=", 
            RowBox[{"\[Not]", "c"}]}]}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "c", "]"}], ";"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Inside", "[", 
     RowBox[{"T_Tissue", ",", " ", 
      RowBox[{"cell_", "?", "IntegerQ"}], ",", " ", 
      RowBox[{"point_", "?", "PointQ"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "cvc", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"AbortIf", "[", 
        RowBox[{
         RowBox[{"cell", "<", "1"}], ",", " ", 
         RowBox[{"\"\<Inside: Invalid Cell Number: \>\"", "<>", 
          RowBox[{"ToString", "[", "cell", "]"}]}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"AbortIf", "[", 
        RowBox[{
         RowBox[{"cell", ">", 
          RowBox[{"NTissueCells", "[", "T", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<Inside: Invalid Cell Number: \>\"", "<>", 
          RowBox[{"ToString", "[", "cell", "]"}]}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"cvc", "=", 
        RowBox[{"CellVertexCoordinates", "[", 
         RowBox[{"T", ",", "cell"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"Inside", "[", 
        RowBox[{"cvc", ",", " ", "point"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Inside", "[", 
    RowBox[{"DT_DTissue", ",", " ", 
     RowBox[{"cell_", "?", "IntegerQ"}], ",", " ", 
     RowBox[{"point_", "?", "PointQ"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cvc", ",", " ", "cn"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cn", "=", 
       RowBox[{"First", "/@", 
        RowBox[{"TissueCells", "[", "DT", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AbortIf", "[", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"cn", ",", "cell"}], "]"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<Inside: Invalid Cell Number: \>\"", "<>", 
         RowBox[{"ToString", "[", "cell", "]"}]}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"cvc", "=", 
       RowBox[{"CellVertexCoordinates", "[", 
        RowBox[{"DT", ",", "cell"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"Inside", "[", 
       RowBox[{"cvc", ",", " ", "point"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Inside", "[", "x___", "]"}], ":=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
     "Print", "[", "\"\<Error: Expecting Inside[{v1, v2, ...}, point]\>\"", 
      "]"}], ";", " ", "$Failed", ";"}], ")"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4468403073432*^9, 3.446840420211536*^9}, {
   3.561503420621317*^9, 3.56150346246798*^9}, {3.561503561480837*^9, 
   3.561503769352438*^9}, {3.561503813550569*^9, 3.56150381788776*^9}, 
   3.561504000645452*^9},ExpressionUUID->"98341632-575d-4aa6-aaa9-\
07edf3172d58"]
}, Closed]],

Cell[CellGroupData[{

Cell["OusideBox", "Subsection",
 CellChangeTimes->{{3.450808243038925*^9, 
  3.450808244878635*^9}},ExpressionUUID->"baf960bc-0bed-4ddc-90aa-\
3f4dbd26bdfc"],

Cell["Is an object entirelly outside of a specified box", "Text",
 CellChangeTimes->{{3.45080824951542*^9, 
  3.4508082568176537`*^9}},ExpressionUUID->"da81c5e4-efca-4537-8efb-\
f763146a84c3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"OutsideBox", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"objectVertices__", "?", "numPairQ"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"boxVertices__", "?", "numPairQ"}], "}"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"vertexOutside", ",", " ", "outside"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"vertexOutside", "[", 
       RowBox[{"{", 
        RowBox[{"x_", ",", " ", "y_"}], "}"}], "]"}], ":=", " ", 
      RowBox[{"!", 
       RowBox[{"Inside", "[", 
        RowBox[{
         RowBox[{"{", "boxVertices", "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"outside", " ", "=", " ", 
      RowBox[{"vertexOutside", "/@", 
       RowBox[{"{", "objectVertices", "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"outside", "=", 
      RowBox[{"And", "@@", "outside"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "outside", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.450808259019128*^9, 3.450808355576075*^9}, {
  3.450808386961268*^9, 
  3.4508084307006187`*^9}},ExpressionUUID->"347026c9-1c41-4e6e-891a-\
e41ad461ba19"]
}, Closed]],

Cell[CellGroupData[{

Cell["PrimaryAxes", "Subsection",
 CellChangeTimes->{{3.446840557457813*^9, 
  3.446840559824922*^9}},ExpressionUUID->"bffd3f36-a5a9-4488-b20f-\
203460896790"],

Cell["\<\
2.0.\[Alpha].2 workaround M7.0.1 Sqrt bug; replace Sqrt[eigenvalues] with \
Sqrt/@eigenvalues (because of Kernel quitting issue).
2.0.\[Alpha].5 add tissue versions\
\>", "Text",
 CellChangeTimes->{{3.4550172210229473`*^9, 3.4550172526866837`*^9}, {
  3.4567501604838953`*^9, 
  3.456750175530106*^9}},ExpressionUUID->"6bc86ef3-6983-45fc-8742-\
d25538136b3e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PrimaryAxes", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"vertices__", "?", "PointQ"}], "}"}], ",", " ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "M", ",", "evalues", ",", "relativeEigenvalues", ",", "evectors", ",", 
       "norms", ",", "centroid", ",", "arrows", ",", "g", ",", "angles", ",", 
       "V", ",", " ", "dbg", ",", " ", "dPrint", ",", " ", "listOfVertices", 
       ",", " ", "eigenvalues"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dbg", "=", " ", 
       RowBox[{
        RowBox[{"\"\<Debug\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Debug\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dPrint", "[", "x___", "]"}], ":=", " ", 
       RowBox[{"If", "[", 
        RowBox[{"dbg", ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<PrimaryAxes: \>\"", ",", " ", "x"}], "]"}]}], "]"}]}], 
      ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"listOfVertices", "=", 
       RowBox[{"{", "vertices", "}"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<list of vertices: \>\"", ",", " ", "listOfVertices"}], 
       "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"centroid", "=", 
       RowBox[{"Centroid", "[", "listOfVertices", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<centroid: \>\"", ",", " ", "centroid"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"V", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"#", "-", "centroid"}], ")"}], "&"}], "/@", 
        "listOfVertices"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"M", "=", 
       RowBox[{
        RowBox[{"Transpose", "[", "V", "]"}], ".", "V"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"eigenvalues", "=", 
       RowBox[{"Eigenvalues", "[", "M", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"evalues", "=", 
       RowBox[{"Sqrt", "/@", "eigenvalues"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"find", " ", "\"\<relative\>\"", " ", "eigenvalues"}], "*)"}], 
      
      RowBox[{"relativeEigenvalues", "=", 
       RowBox[{"evalues", "/", 
        RowBox[{"Norm", "[", "evalues", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "find", " ", "eigenvectors", " ", "and", " ", "normalize", " ", 
        "relative", " ", "to", " ", "the", " ", "magnitudes", " ", "of", " ", 
        "the", " ", "eigenvalaues"}], "*)"}], 
      RowBox[{"evectors", "=", 
       RowBox[{"Eigenvectors", "[", "M", "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"norms", "=", 
       RowBox[{"Norm", "/@", "evectors"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"evectors", "=", 
       RowBox[{"evectors", "/", "norms"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"evectors", "=", 
       RowBox[{"evectors", "*", "relativeEigenvalues"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"angles", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"ArcTan", "@@", "#"}], "&"}], "/@", "evectors"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{
         "convert", " ", "eigenvectors", " ", "to", " ", "graphical", " ", 
          "arrows"}], "&"}], " ", "vectors", " ", "from", " ", "the", " ", 
        "centroid"}], "*)"}], 
      RowBox[{"evectors", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"centroid", ",", 
           RowBox[{"centroid", "+", "#"}]}], "}"}], "&"}], "/@", 
        "evectors"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"arrows", "=", 
       RowBox[{"Arrow", "/@", "evectors"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"g", "=", 
       RowBox[{"Graphics", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Line", "[", 
           RowBox[{"Append", "[", 
            RowBox[{"listOfVertices", ",", 
             RowBox[{"listOfVertices", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"PointSize", "[", 
           RowBox[{
            RowBox[{"\"\<PointSize\>\"", "/.", 
             RowBox[{"{", "opt", "}"}]}], "/.", 
            RowBox[{"{", 
             RowBox[{"\"\<PointSize\>\"", "\[Rule]", " ", ".02"}], "}"}]}], 
           "]"}], ",", " ", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\"\<PointColor\>\"", "/.", 
            RowBox[{"{", "opt", "}"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{"\"\<PointColor\>\"", "\[Rule]", " ", "Red"}], "}"}]}], 
          ",", " ", "\[IndentingNewLine]", 
          RowBox[{"Point", "[", "centroid", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\"\<Color\>\"", "/.", 
            RowBox[{"{", "opt", "}"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{"\"\<Color\>\"", "\[Rule]", " ", "Blue"}], "}"}]}], ",", 
          "arrows"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<Vectors\>\"", "\[Rule]", "evectors"}], ",", 
         RowBox[{"\"\<Graphics\>\"", "\[Rule]", "g"}], ",", 
         RowBox[{"\"\<Eigenvalues\>\"", "\[Rule]", "relativeEigenvalues"}], 
         ",", 
         RowBox[{"\"\<Angles\>\"", "\[Rule]", "angles"}]}], "}"}], "]"}]}]}], 
    "\n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PrimaryAxes", "[", 
    RowBox[{
     RowBox[{"tiss_", "?", "TissueQ"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i__", "?", "IntegerQ"}], "}"}], ",", " ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cvc", ",", " ", "pa"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cvc", "=", 
       RowBox[{
        RowBox[{"CellVertexCoordinates", "[", "tiss", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"{", "i", "}"}], "]"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"pa", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"PrimaryAxes", "[", 
          RowBox[{"#", ",", " ", "opt"}], "]"}], "&"}], "/@", "cvc"}]}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "pa", "]"}], ";"}]}], " ", "\[IndentingNewLine]",
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PrimaryAxes", "[", 
     RowBox[{
      RowBox[{"tiss_", "?", "TissueQ"}], ",", " ", 
      RowBox[{"i_", "?", "IntegerQ"}], ",", " ", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"PrimaryAxes", "[", 
      RowBox[{"tiss", ",", " ", 
       RowBox[{"{", "i", "}"}], ",", " ", "opt"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PrimaryAxes", "[", 
    RowBox[{
     RowBox[{"tiss_", "?", "TissueQ"}], ",", " ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
   RowBox[{"PrimaryAxes", "[", 
    RowBox[{"tiss", ",", " ", 
     RowBox[{"Range", "[", 
      RowBox[{"NTissueCells", "[", "tiss", "]"}], "]"}], ",", " ", "opt"}], 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.446840600830026*^9, 3.446840625940313*^9}, {
  3.446840892624905*^9, 3.446841057778588*^9}, {3.446841185682936*^9, 
  3.44684119041124*^9}, {3.45496599069697*^9, 3.4549660560933847`*^9}, {
  3.4549664153536997`*^9, 3.4549664232224627`*^9}, {3.454966683184366*^9, 
  3.454966697202544*^9}, {3.455016954411701*^9, 3.455016959261011*^9}, {
  3.4567495602414627`*^9, 3.456749744656274*^9}, {3.4567498489616823`*^9, 
  3.456749875105856*^9}, {3.456749909404655*^9, 
  3.456749961352744*^9}},ExpressionUUID->"5ffec901-fb22-4f1e-95e2-\
e62ba51cd061"]
}, Closed]],

Cell[CellGroupData[{

Cell["PrimaryAxesVectors", "Subsection",
 CellChangeTimes->{{3.456750187219614*^9, 
  3.456750190782237*^9}},ExpressionUUID->"4c7bc802-9c85-4137-95a9-\
ddabbf3d4a1f"],

Cell["\<\
New in 2.1.alpha.5.
Return the eigenvectors of the \"fit\" system with the vector corresponding \
to the smaller eigenvalue first.\
\>", "Text",
 CellChangeTimes->{{3.456750315328953*^9, 3.4567503438344593`*^9}, {
  3.456750400513967*^9, 3.456750402453999*^9}, {3.456751867883327*^9, 
  3.456751877477727*^9}},ExpressionUUID->"f80ce5bb-09bb-443c-9e24-\
6f80636955de"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PrimaryAxesVectors", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"vertices__", "?", "NumericPointQ"}], "}"}], ",", " ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pa", ",", " ", "evectors", ",", " ", "evalues"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"pa", "=", 
       RowBox[{"PrimaryAxes", "[", 
        RowBox[{"{", "vertices", "}"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"evectors", " ", "=", " ", 
       RowBox[{"\"\<Vectors\>\"", "/.", "pa"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"evalues", " ", "=", " ", 
       RowBox[{"\"\<Eigenvalues\>\"", "/.", "pa"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pa", " ", "=", " ", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"evalues", ",", " ", "evectors"}], "}"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"pa", " ", "=", " ", 
       RowBox[{"Sort", "[", "pa", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pa", " ", "=", " ", 
       RowBox[{"Last", "/@", "pa"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "pa", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PrimaryAxesVectors", "[", 
    RowBox[{
     RowBox[{"tiss_", "?", "TissueQ"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i__", "?", "IntegerQ"}], "}"}], ",", " ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cvc", ",", " ", "pa"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cvc", " ", "=", " ", 
       RowBox[{
        RowBox[{"CellVertexCoordinates", "[", "tiss", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"{", "i", "}"}], "]"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"pa", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"PrimaryAxesVectors", "[", 
          RowBox[{"#", ",", "opt"}], "]"}], "&"}], "/@", "cvc"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "pa", "]"}], ";"}]}], " ", "\[IndentingNewLine]",
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PrimaryAxesVectors", "[", 
     RowBox[{
      RowBox[{"tiss_", "?", "TissueQ"}], ",", " ", 
      RowBox[{"i_", "?", "IntegerQ"}], ",", " ", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"PrimaryAxesVectors", "[", 
      RowBox[{"tiss", ",", " ", 
       RowBox[{"{", "i", "}"}], ",", " ", "opt"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PrimaryAxesVectors", "[", 
     RowBox[{
      RowBox[{"tiss_", "?", "TissueQ"}], ",", " ", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
    RowBox[{"PrimaryAxesVectors", "[", 
     RowBox[{"tiss", ",", " ", 
      RowBox[{"Range", "[", 
       RowBox[{"NTissueCells", "[", "tiss", "]"}], "]"}], ",", " ", "opt"}], 
     "]"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.45675019242108*^9, 3.4567503108081408`*^9}, {
  3.456751371349461*^9, 3.456751393406755*^9}, {3.456751433877009*^9, 
  3.456751497206396*^9}, {3.456751549500787*^9, 3.456751684622664*^9}, {
  3.456751725417574*^9, 3.456751726998646*^9}, {3.456751789179257*^9, 
  3.456751790188121*^9}, {3.4567518321867743`*^9, 
  3.456751837534711*^9}},ExpressionUUID->"6e9424d2-a825-4c11-8328-\
4823048e260b"]
}, Closed]],

Cell[CellGroupData[{

Cell["FitEllipse", "Subsection",
 CellChangeTimes->{{3.446841156702491*^9, 
  3.446841158157275*^9}},ExpressionUUID->"c755b0df-37d4-4e16-b2b6-\
1e11d51e6183"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FitEllipse", "[", "V_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "axes", ",", "V1", ",", "V2", ",", "\[Lambda]1", ",", "\[Lambda]2", ",", 
      "K", ",", "axis1", ",", "axis2", ",", "A", ",", "Centroid", ",", 
      "\[Theta]1", ",", "\[Theta]2", ",", "g"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"axes", "=", 
      RowBox[{"PrimaryAxes", "[", "V", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"V1", ",", "V2"}], "}"}], "=", 
      RowBox[{"\"\<Vectors\>\"", "/.", "axes"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Lambda]1", ",", "\[Lambda]2"}], "}"}], "=", 
      RowBox[{"\"\<Eigenvalues\>\"", "/.", "axes"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"K", "=", 
      RowBox[{"\[Lambda]1", "/", "\[Lambda]2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"A", "=", 
      RowBox[{"areafunction", "[", "V", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"axis2", "=", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"A", "/", 
        RowBox[{"(", 
         RowBox[{"\[Pi]", "*", "K"}], ")"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"axis1", "=", 
      RowBox[{"K", "*", "axis2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Centroid", "=", 
      RowBox[{"V1", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Theta]1", ",", "\[Theta]2"}], "}"}], "=", 
      RowBox[{"\"\<Angles\>\"", "/.", "axes"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"g", "=", 
      RowBox[{"\"\<Graphics\>\"", "/.", "axes"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"g", "=", 
      RowBox[{"Show", "[", 
       RowBox[{"g", ",", 
        RowBox[{"Graphics", "[", 
         RowBox[{"{", 
          RowBox[{"Purple", ",", 
           RowBox[{"Rotate", "[", 
            RowBox[{
             RowBox[{"Circle", "[", 
              RowBox[{"Centroid", ",", 
               RowBox[{"{", 
                RowBox[{"axis1", ",", "axis2"}], "}"}]}], "]"}], ",", 
             "\[Theta]1"}], "]"}]}], "}"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<Angle\>\"", "\[Rule]", "\[Theta]1"}], ",", 
        RowBox[{"\"\<Axes\>\"", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"axis1", ",", "axis2"}], "}"}]}], ",", 
        RowBox[{"\"\<Graphics\>\"", "\[Rule]", "g"}]}], "}"}], "]"}], ";"}]}],
    "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.446841167078496*^9, 3.446841167571629*^9}, 
   3.446841350250013*^9, 
   3.705711439230751*^9},ExpressionUUID->"812fcdbf-63db-41d3-8cfe-\
00ec1ab66635"]
}, Closed]],

Cell[CellGroupData[{

Cell["LineEdgeIntersection", "Subsection",
 CellChangeTimes->{{3.446841333361566*^9, 
  3.446841336114152*^9}},ExpressionUUID->"8bc32a26-7619-4d9f-acd3-\
90e5bfceadc3"],

Cell["\<\
Find intersection of a edge from {x1, y1} to {x2, y2} and line throuch {xc, \
yc} in vector direction {v1, v2}
Returns the {x, y} coordinates of the intersecton or returns $Failed if \
either (a) the lines do not intersect at all, e .. g, they are parallel; or \
(b) the intersection exists but is not along the physical edge, i.e., not \
between the points {x1, y1} and {x2, y2}
2.2.8 (6/3/11) fix bug in determining parallel lines and test for special \
cases of vertical lines/edges\
\>", "Text",
 CellChangeTimes->{{3.547743684736577*^9, 
  3.547743713547792*^9}},ExpressionUUID->"00d40cd5-2cd7-47b9-bc7a-\
f2a8027266d8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"LineEdgeIntersection", "[", 
    RowBox[{
     RowBox[{"edge_", "?", "CZEdgeQ"}], ",", 
     RowBox[{"point_", "?", "PointQ"}], ",", 
     RowBox[{"direction_", "?", "PointQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "vedge", ",", "\[CapitalDelta]y", ",", "\[CapitalDelta]x", ",", "A", 
       ",", "Ainv", ",", "b", ",", "x", ",", "y", ",", " ", "p1", ",", " ", 
       "p2", ",", " ", "xc", ",", " ", "yc", ",", " ", "v1", ",", " ", "v2", 
       ",", " ", "x1", ",", " ", "y1", ",", " ", "x2", ",", " ", "y2", ",", 
       RowBox[{"dbg", "=", "False"}], ",", " ", "dPrint", ",", "VERYSMALL", 
       ",", "NotSoSmall", ",", "dot"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"VERYSMALL", "[", "u_", "]"}], ":=", " ", 
       RowBox[{
        RowBox[{"Abs", "[", "u", "]"}], "<", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"-", "10"}], ")"}]}]}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NotSoSmall", "[", "u_", "]"}], ":=", " ", 
       RowBox[{"Not", "[", 
        RowBox[{"VERYSMALL", "[", "u", "]"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dPrint", "[", "u___", "]"}], ":=", " ", 
       RowBox[{"If", "[", 
        RowBox[{"dbg", ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<LineEdgeIntersection: \>\"", ",", " ", "u"}], "]"}]}], 
        "]"}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"p1", ",", " ", "p2"}], "}"}], "=", "edge"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x1", ",", " ", "y1"}], "}"}], " ", "=", "p1"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<p1(x1,y1)=\>\"", ",", " ", "p1"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x2", ",", " ", "y2"}], "}"}], "=", "p2"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<p2(x2,y2)=\>\"", ",", " ", "p2"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"xc", ",", " ", "yc"}], "}"}], " ", "=", " ", "point"}], ";", 
      "  ", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<point(xc,yc)=\>\"", ",", " ", "point"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v1", ",", " ", "v2"}], "}"}], "=", 
       RowBox[{"Normalize", "[", "direction", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<direction (v1,v2):\>\"", ",", " ", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"\[CapitalDelta]x", "=", 
       RowBox[{"x2", "-", "x1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[CapitalDelta]y", "=", 
       RowBox[{"y2", "-", "y1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vedge", "=", 
       RowBox[{"Normalize", "[", 
        RowBox[{"{", 
         RowBox[{"\[CapitalDelta]x", ",", "\[CapitalDelta]y"}], "}"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[CapitalDelta]x", ",", "\[CapitalDelta]y"}], "}"}], "=", 
       "vedge"}], ";", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{
       "\"\<vedge {\[CapitalDelta]x,\[CapitalDelta]y}=\>\"", ",", " ", 
        "vedge"}], "]"}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"both", " ", "parallel"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalDelta]y", " ", "v1"}], "\[Equal]", 
         RowBox[{"\[CapitalDelta]x", " ", "v2"}]}], ",", 
        RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dot", " ", "=", " ", 
       RowBox[{"1.0", "-", 
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}], ".", 
          RowBox[{"{", 
           RowBox[{"\[CapitalDelta]x", ",", "\[CapitalDelta]y"}], "}"}]}], 
         "]"}]}]}], ";", " ", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<**** dot = \>\"", ",", " ", "dot"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"VERYSMALL", "[", "dot", "]"}], ",", " ", 
        RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"VERYSMALL", "[", "\[CapitalDelta]x", "]"}], " ", "\[And]", 
         " ", 
         RowBox[{"VERYSMALL", "[", "v1", "]"}]}], ",", " ", 
        RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"VERYSMALL", "[", "\[CapitalDelta]x", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"x", "=", "x1"}], ";", "\[IndentingNewLine]", 
         RowBox[{"y", " ", "=", " ", 
          RowBox[{"yc", " ", "+", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"v2", "/", "v1"}], ")"}], "*", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "xc"}], ")"}]}]}]}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"VERYSMALL", "[", "v1", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"x", "=", "xc"}], ";", " ", "\[IndentingNewLine]", 
         RowBox[{"y", "=", 
          RowBox[{"y1", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[CapitalDelta]y", "/", "\[CapitalDelta]x"}], ")"}], 
            "*", 
            RowBox[{"(", 
             RowBox[{"xc", "-", "x1"}], ")"}]}]}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"NotSoSmall", "[", "\[CapitalDelta]x", "]"}], " ", "\[And]", 
         " ", 
         RowBox[{"NotSoSmall", "[", "v1", "]"}]}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"A", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"v2", ",", 
              RowBox[{"-", "v1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[CapitalDelta]y", ",", 
              RowBox[{"-", "\[CapitalDelta]x"}]}], "}"}]}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"dPrint", "[", 
          RowBox[{"\"\<A: \>\"", ",", " ", 
           RowBox[{"MatrixForm", "[", "A", "]"}]}], "]"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"Ainv", "=", 
          RowBox[{"Inverse", "[", "A", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"dPrint", "[", 
          RowBox[{"\"\<Ainv:\>\"", ",", " ", 
           RowBox[{"Ainv", "//", "MatrixForm"}]}], "]"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"b", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"v2", " ", "xc"}], "-", 
             RowBox[{"v1", " ", "yc"}]}], ",", 
            RowBox[{
             RowBox[{"x1", " ", "\[CapitalDelta]y"}], "-", 
             RowBox[{"y1", " ", "\[CapitalDelta]x"}]}]}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "y"}], "}"}], "=", 
          RowBox[{"Ainv", ".", "b"}]}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", " ", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"we", " ", "could", " ", "use", " ", "the", " ", "worked"}], 
        "-", "\[IndentingNewLine]", 
        RowBox[{
        "out", " ", "formula", " ", "but", " ", "its", " ", "not", " ", "as", 
         " ", 
         RowBox[{"pretty", ":"}]}]}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"v2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "x1"}], "+", "x2"}], ")"}], " ", "xc"}], "+", 
            RowBox[{"v1", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"x2", " ", 
                RowBox[{"(", 
                 RowBox[{"y1", "-", "yc"}], ")"}]}], "+", 
               RowBox[{"x1", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "y2"}], "+", "yc"}], ")"}]}]}], ")"}]}]}], 
           ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"v2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "x1"}], "+", "x2"}], ")"}]}], "+", 
            RowBox[{"v1", " ", 
             RowBox[{"(", 
              RowBox[{"y1", "-", "y2"}], ")"}]}]}], ")"}]}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"v2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"x2", " ", "y1"}], "-", 
               RowBox[{"xc", " ", "y1"}], "-", 
               RowBox[{"x1", " ", "y2"}], "+", 
               RowBox[{"xc", " ", "y2"}]}], ")"}]}], "+", 
            RowBox[{"v1", " ", 
             RowBox[{"(", 
              RowBox[{"y1", "-", "y2"}], ")"}], " ", "yc"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"v2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "x1"}], "+", "x2"}], ")"}]}], "+", 
            RowBox[{"v1", " ", 
             RowBox[{"(", 
              RowBox[{"y1", "-", "y2"}], ")"}]}]}], ")"}]}]}], "}"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "check", " ", "to", " ", "make", " ", "sure", " ", "the", " ", 
        "intersection", " ", "is", " ", "within", " ", "the", " ", "edge"}], 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"x", "<", 
         RowBox[{"Min", "[", 
          RowBox[{"x1", ",", "x2"}], "]"}]}], ",", 
        RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"x", ">", 
         RowBox[{"Max", "[", 
          RowBox[{"x1", ",", "x2"}], "]"}]}], ",", 
        RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"y", "<", 
         RowBox[{"Min", "[", 
          RowBox[{"y1", ",", "y2"}], "]"}]}], ",", 
        RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"y", ">", 
         RowBox[{"Max", "[", 
          RowBox[{"y1", ",", "y2"}], "]"}]}], ",", 
        RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}], "]"}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"LineEdgeIntersection", "[", "x___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<Error: Expecting LineEdgeIntersection[edge, point, direction]: \
\>\"", ",", " ", 
       RowBox[{"{", "x", "}"}]}], "]"}], ";", " ", "$Failed"}], ")"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.446841488895275*^9, 3.446841693000213*^9}, {
   3.44684336311879*^9, 3.446843368191261*^9}, {3.446843411880632*^9, 
   3.446843415249206*^9}, 3.5075762000842867`*^9, {3.547740329233858*^9, 
   3.547740385552936*^9}, 3.547740445470746*^9, {3.547740848098711*^9, 
   3.5477408550498867`*^9}, {3.54774098665497*^9, 3.547741005376985*^9}, {
   3.547741080523583*^9, 3.547741088496696*^9}, {3.5477423913548727`*^9, 
   3.547742411616476*^9}, {3.547742450529356*^9, 3.547742462625135*^9}, {
   3.5477425240375443`*^9, 3.5477427459612083`*^9}, {3.547742785080461*^9, 
   3.5477428456557913`*^9}, 3.5477428786523457`*^9, {3.547743152888917*^9, 
   3.5477432026019*^9}, {3.547743413759091*^9, 3.547743449022975*^9}, {
   3.547743488030766*^9, 3.547743641384223*^9}, {3.5477436779940166`*^9, 
   3.547743678736779*^9}},ExpressionUUID->"7be5a116-619c-4248-8560-\
c6bf4f6b4257"]
}, Closed]],

Cell[CellGroupData[{

Cell["DropPerpendicular", "Subsection",
 CellChangeTimes->{{3.446842716519147*^9, 
  3.446842719139444*^9}},ExpressionUUID->"190d1f79-ceaa-4eb4-bf1b-\
57e886454a6b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DropPerpendicular", "[", 
    RowBox[{
     RowBox[{"point_", "?", "PointQ"}], ",", " ", 
     RowBox[{"edge_", "?", "CZEdgeQ"}], ",", " ", 
     RowBox[{"slide_:", "False"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "perp", ",", " ", "intersection", ",", " ", "d1", ",", " ", "d2"}], 
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"distance", "@@", "edge"}], "\[Equal]", "0"}], ",", " ", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Error: DropPerpendicular: Edge \>\"", ",", " ", "edge", ",", 
           " ", "\"\< has zero length.\>\""}], "]"}], ";", " ", 
         RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"perp", "=", 
       RowBox[{
        RowBox[{"edge", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "-", 
        RowBox[{"edge", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", " ", "\[IndentingNewLine]", 
      
      RowBox[{"perp", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"perp", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
         RowBox[{"perp", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"perp", " ", "=", 
       RowBox[{"perp", "/", 
        RowBox[{"Norm", "[", "perp", "]"}]}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"intersection", "=", 
       RowBox[{"LineEdgeIntersection", "[", 
        RowBox[{"edge", ",", " ", "point", ",", " ", "perp"}], "]"}]}], ";", 
      " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"DifferentQ", "[", 
         RowBox[{"intersection", " ", ",", "$Failed"}], "]"}], ",", " ", 
        RowBox[{"Return", "[", "intersection", "]"}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"The", " ", "perpendicular", " ", "missed", " ", "the", " ", 
        RowBox[{"edge", ".", " ", "Should"}], " ", "we", " ", "slide", " ", 
        "it", " ", "to", " ", "the", " ", 
        RowBox[{"endpoint", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", "slide"}], ",", " ", 
        RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"d1", " ", "=", " ", 
       RowBox[{"distance", "[", 
        RowBox[{"point", ",", " ", 
         RowBox[{"edge", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"d2", " ", "=", " ", 
       RowBox[{"distance", "[", 
        RowBox[{"point", ",", " ", 
         RowBox[{"edge", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"d1", " ", "\[LessEqual]", " ", "d2"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"edge", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"edge", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
       "]"}], ";"}]}], "  ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DropPerpendicular", "[", "x___", "]"}], ":=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
     "Print", "[", 
      "\"\<Error: Expecing DropPerpendicular[point, edge, slide]\>\"", "]"}], 
     ";", " ", "$Failed"}], ")"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.446842720171131*^9, 3.446843149360598*^9}, {
   3.446843206448499*^9, 3.446843293297532*^9}, {3.446843392803947*^9, 
   3.44684339888136*^9}, 3.446843433468192*^9, {3.446843585208469*^9, 
   3.446843598163856*^9}, {3.446843675129124*^9, 3.446843686165389*^9}, {
   3.446843769975089*^9, 3.446843773575172*^9}, {3.446843831621112*^9, 
   3.446843866662154*^9}, {3.446843963083164*^9, 3.446843968071904*^9}, 
   3.507576209467907*^9},ExpressionUUID->"c1997126-f1f7-4b83-bae7-\
f44544a25ee2"]
}, Closed]],

Cell[CellGroupData[{

Cell["DropLineToNearestPointOnEdge", "Subsection",
 CellChangeTimes->{
  3.446844282538772*^9},ExpressionUUID->"392b9368-81ae-45b3-97ea-\
a8fd335ec2ff"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DropLineToNearestPointOnEdge", "[", 
    RowBox[{
     RowBox[{"point_", "?", "PointQ"}], ",", " ", 
     RowBox[{"edge_", "?", "CZEdgeQ"}]}], "]"}], ":=", " ", 
   RowBox[{"DropPerpendicular", "[", 
    RowBox[{"point", ",", " ", "edge", ",", " ", "True"}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.446844286150895*^9, 3.446844308738772*^9}, 
   3.507576214433526*^9},ExpressionUUID->"85bf200e-31f7-4f84-a714-\
792a6ff25cd1"]
}, Closed]],

Cell[CellGroupData[{

Cell["PolygonIntersection", "Subsection",
 CellChangeTimes->{{3.446841867559286*^9, 3.446841872337073*^9}, {
  3.446842006009037*^9, 
  3.44684200618438*^9}},ExpressionUUID->"820da3e6-4b5c-45ad-b033-\
9f7e2c01e86c"],

Cell["\<\
Revised 2.1.\[Alpha].21a algorithm to fix > 2 intersections: figure out which \
segment is correct. (previously rotated).
Revised 2.1.\[Alpha].20 to not print error message when intersection occurs \
on existing vertex.
Thus 2, 3, or 4 points may be returned; if >2, existing vertex(or vertices)\
\>", "Text",
 CellChangeTimes->{{3.488904892429613*^9, 3.488904940917754*^9}, {
  3.494191239897381*^9, 
  3.4941912777796383`*^9}},ExpressionUUID->"3c799434-f470-4ce0-a634-\
86b488d7e188"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PolygonIntersection", "[", 
   RowBox[{
    RowBox[{"vector_", "?", "PointQ"}], ",", 
    RowBox[{"{", 
     RowBox[{"vertex__", "?", "PointQ"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"nv", ",", "centroid", ",", "edges", ",", 
      RowBox[{"debug", "=", "False"}], ",", "int", ",", "range", ",", "v", 
      ",", " ", "ok"}], "}"}], ",", 
    RowBox[{
     RowBox[{"nv", "=", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "vertex", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"nv", "<", "3"}], ",", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<eh? polygonIntersect: expecting more than \>\"", ",", "nv", 
          ",", "\"\< vertices. Vector: \>\"", ",", "vector", ",", 
          "\"\< vertices: \>\"", ",", 
          RowBox[{"{", "vertex", "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "$Failed", "]"}], ";"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"centroid", "=", 
      RowBox[{"Centroid", "[", 
       RowBox[{"{", "vertex", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "\[IndentingNewLine]", 
      RowBox[{"PolygonIntersection", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"centroid", ",", " ", 
          RowBox[{"centroid", "+", "vector"}]}], "}"}], ",", " ", 
        RowBox[{"{", "vertex", "}"}]}], "]"}], "\[IndentingNewLine]", "]"}], 
     ";"}]}], "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.446841890122995*^9, 3.446841926422393*^9}, {
   3.44684200380305*^9, 3.446842003983873*^9}, {3.446842099878262*^9, 
   3.446842117470086*^9}, {3.456753894342574*^9, 3.4567538950307293`*^9}, {
   3.456754135330647*^9, 3.456754182078936*^9}, 
   3.4889048821626873`*^9},ExpressionUUID->"d2d51b4c-312a-4d9b-b0e7-\
2463560ed01e"],

Cell["\<\
Point p1 is the \"primary\" point which should lie \"between\" the two \
intersection points, if possible. \
\>", "Text",
 CellChangeTimes->{{3.494189862647307*^9, 
  3.494189884042338*^9}},ExpressionUUID->"16da5388-9b49-4696-8c7e-\
631685fb9a92"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PolygonIntersection", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p1_", "?", "PointQ"}], ",", " ", 
       RowBox[{"p2_", "?", "PointQ"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"vertex__", "?", "PointQ"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nv", ",", "edges", ",", "vector", ",", " ", 
       RowBox[{"debug", "=", "False"}], ",", "int", ",", "range", ",", "v", 
       ",", "ok", ",", " ", "toomany", ",", " ", "dPrint"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"dPrint", "[", "x___", "]"}], ":=", " ", 
       RowBox[{"If", "[", 
        RowBox[{"debug", ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<PolygonIntersection: \>\"", ",", " ", "x"}], "]"}]}], 
        "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"nv", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"{", "vertex", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"nv", "<", "3"}], ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<eh? polygonIntersect: expecting more than \>\"", ",", "nv", 
           ",", "\"\< vertices. Vector: \>\"", ",", "vector", ",", 
           "\"\< vertices: \>\"", ",", 
           RowBox[{"{", "vertex", "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
         
         RowBox[{"Return", "[", "$Failed", "]"}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"edges", "=", 
       RowBox[{"Partition", "[", 
        RowBox[{
         RowBox[{"{", "vertex", "}"}], ",", "2", ",", "1", ",", "1"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vector", "=", 
       RowBox[{"Subtract", "@@", 
        RowBox[{"{", 
         RowBox[{"p1", ",", "p2"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"int", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"LineEdgeIntersection", "[", 
          RowBox[{"#", ",", "p1", ",", "vector"}], "]"}], "&"}], "/@", 
        "edges"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<polygonIntersect[\>\"", ",", "vector", ",", 
        RowBox[{"{", "vertex", "}"}], ",", "\"\<]\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<p1,p2,vector: \>\"", ",", 
        RowBox[{"{", 
         RowBox[{"p1", ",", "p2", ",", "vector"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<edges: \>\"", ",", "edges"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<intersectons: \>\"", ",", "int"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"range", "=", 
       RowBox[{"Range", "[", "nv", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ok", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ToString", "[", "#", "]"}], "\[NotEqual]", 
           "\"\<$Failed\>\""}], ")"}], "&"}], "/@", "int"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"int", "=", 
       RowBox[{"Pick", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"range", ",", "int"}], "}"}], "]"}], ",", "ok"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"nv", "=", 
       RowBox[{"Length", "[", "int", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"dPrint", "[", 
         RowBox[{"\"\<Edge \>\"", ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "\"\< intersection at \>\"", 
          ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}], "/@", "int"}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"2", " ", "intersections", " ", "is", " ", "normal"}], ";", 
        " ", 
        RowBox[{
        "3", " ", "or", " ", "4", " ", "means", " ", "it", " ", "occurs", " ",
          "at", " ", "existing", " ", "vertices"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"toomany", "=", "False"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nv", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", "\"\<Warning: PolygonIntersect: no intersections.\>\"",
           "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Points,vector: \>\"", ",", " ", 
           RowBox[{"{", 
            RowBox[{"p1", ",", "p2", ",", "vector"}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Vertices: \>\"", ",", " ", 
           RowBox[{"{", "vertex", "}"}]}], "]"}], ";"}], " ", 
        "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"nv", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Warning: PolygonIntersect: only 1 intersection: \>\"", ",", 
          "int"}], "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"nv", ">", "2"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"dPrint", "[", 
          RowBox[{
          "\"\<Warning: PolygonIntersect: too many intersections = \>\"", ",",
            "int"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"toomany", "=", "True"}], ";"}]}], " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"toomany", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Block", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "pts", ",", " ", "pos", ",", " ", "i", ",", " ", "j", ",", " ", 
             "points"}], "}"}], ",", " ", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
            "dPrint", "[", "\"\<Handling too many intersections.\>\"", "]"}], 
            ";", " ", "\[IndentingNewLine]", 
            RowBox[{"pts", " ", "=", " ", 
             RowBox[{"Last", "/@", "int"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "Fix", " ", "in", " ", "the", " ", "case", " ", "of", " ", 
               "non"}], "-", 
              RowBox[{"convex", " ", "cell"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "Also", " ", "works", " ", "if", " ", "the", " ", 
              "intersections", " ", "fall", " ", "on", " ", "a", " ", 
              RowBox[{"vertex", "!"}]}], " ", "*)"}], "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"pts", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}], "\[Equal]", 
               RowBox[{"pts", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{"vertical", " ", "line"}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"pts", " ", "=", " ", 
               RowBox[{"Reverse", "/@", 
                RowBox[{"Sort", "[", 
                 RowBox[{"Reverse", "/@", 
                  RowBox[{"Append", "[", 
                   RowBox[{"pts", ",", " ", "p1"}], "]"}]}], "]"}]}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{"not", " ", "a", " ", "vertical", " ", "line"}], " ", 
                "-", " ", 
                RowBox[{
                "can", " ", "sort", " ", "by", " ", "x", " ", 
                 "coordinate"}]}], " ", "*)"}], "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"pts", " ", "=", " ", 
                RowBox[{"Sort", "[", 
                 RowBox[{"Append", "[", 
                  RowBox[{"pts", ",", "p1"}], "]"}], "]"}]}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
            RowBox[{"pos", " ", "=", " ", 
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"pts", ",", " ", "p1"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"pos", "\[Equal]", "1"}], " ", "\[Or]", " ", 
               RowBox[{"pos", "\[Equal]", 
                RowBox[{"Length", "[", "pts", "]"}]}]}], ",", " ", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{
                "\"\<Error: Point p1 \>\"", ",", " ", "p1", ",", 
                 "\"\< is not an interior point. \>\""}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"pos", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"i", " ", "=", " ", 
                   RowBox[{"pos", "+", "1"}]}], ";", " ", 
                  RowBox[{"j", " ", "=", " ", 
                   RowBox[{"pos", " ", "+", " ", "2"}]}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"i", " ", "=", " ", 
                   RowBox[{"pos", "-", "2"}]}], ";", " ", 
                  RowBox[{"j", " ", "=", " ", 
                   RowBox[{"pos", " ", "-", "1"}]}], ";"}]}], " ", 
                "\[IndentingNewLine]", "]"}]}], ",", " ", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"i", " ", "=", " ", 
                RowBox[{"pos", "-", "1"}]}], ";", " ", 
               RowBox[{"j", " ", "=", " ", 
                RowBox[{"pos", " ", "+", " ", "1"}]}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"dPrint", "[", 
             RowBox[{
             "\"\<p1: \>\"", ",", " ", "p1", ",", " ", "\"\< pos: \>\"", ",", 
              " ", "pos", ",", " ", "\"\< i, j: \>\"", ",", " ", "i", ",", 
              "\"\<,\>\"", ",", " ", "j"}], "]"}], ";", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"dPrint", "[", 
             RowBox[{"\"\<pts: \>\"", ",", " ", "pts"}], "]"}], ";", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"Extract", " ", "Proper", " ", "Points"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"i", "=", 
             RowBox[{"pts", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ";", " ", 
            RowBox[{"j", " ", "=", " ", 
             RowBox[{"pts", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], ";", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"i", "=", 
             RowBox[{"int", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"int", ",", " ", "i"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
            " ", "\[IndentingNewLine]", 
            RowBox[{"j", " ", "=", " ", 
             RowBox[{"int", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"int", ",", " ", "j"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
            " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"dPrint", "[", 
             RowBox[{"\"\<{i,j}:\>\"", ",", " ", 
              RowBox[{"{", 
               RowBox[{"i", ",", "j"}], "}"}]}], "]"}], ";", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"int", " ", "=", " ", 
             RowBox[{"Sort", "[", 
              RowBox[{"{", 
               RowBox[{"i", ",", "j"}], "}"}], "]"}]}], ";"}]}], " ", 
          "\[IndentingNewLine]", "]"}], ";"}]}], " ", "\[IndentingNewLine]", 
       "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "int", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PolygonIntersection", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Error: Expecting PolygonIntersection[{point1, point2}, \
{vertices}] or PolygonIntersection[DirectionVector, {vertices}]\>\"", "]"}], 
      ";", " ", "$Failed"}], ")"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.446841890122995*^9, 3.446841926422393*^9}, {
  3.44684200380305*^9, 3.446842003983873*^9}, {3.446842099878262*^9, 
  3.446842117470086*^9}, {3.456753761414813*^9, 3.456753889008127*^9}, {
  3.456754472594549*^9, 3.456754537034341*^9}, {3.488904701082986*^9, 
  3.488904761975943*^9}, {3.488904831656039*^9, 3.488904872895568*^9}, {
  3.494189894410968*^9, 3.4941898951390543`*^9}, {3.494189950862968*^9, 
  3.494190451726824*^9}, {3.494190482098695*^9, 3.4941905639623528`*^9}, {
  3.494190602294464*^9, 3.49419075438682*^9}, {3.494190786063195*^9, 
  3.494190979353629*^9}, {3.4941911050302887`*^9, 3.494191121415975*^9}, {
  3.494191363262773*^9, 3.49419136380177*^9}, {3.547740267020812*^9, 
  3.547740267525907*^9}, {3.547743722716238*^9, 3.5477437233865547`*^9}, {
  3.5661423992994947`*^9, 
  3.5661424696608763`*^9}},ExpressionUUID->"c24958be-e496-4fbb-8241-\
0fd964babca1"]
}, Closed]],

Cell[CellGroupData[{

Cell["OutwardNormalVector,  NormalVector", "Subsection",
 CellChangeTimes->{{3.44853668859813*^9, 3.448536698046889*^9}, {
  3.448536778515573*^9, 
  3.448536780798844*^9}},ExpressionUUID->"c0d75ced-61a1-4ee6-bb50-\
06398ba61425"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NormalVector", "[", 
     RowBox[{"{", 
      RowBox[{"p1_", ",", " ", "p2_"}], "}"}], "]"}], ":=", " ", 
    RowBox[{"NormalVector", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p1", ",", "p2"}], "}"}], ",", " ", "1"}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NormalVector", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p__", "?", "PointQ"}], "}"}], ",", " ", "i_Integer"}], "]"}], ":=",
    " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v", ",", " ", "e", ",", " ", "vec"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"v", "=", 
       RowBox[{"Append", "[", 
        RowBox[{
         RowBox[{"{", "p", "}"}], ",", " ", 
         RowBox[{"First", "[", 
          RowBox[{"{", "p", "}"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"edge", " ", "vector"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"e", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
         RowBox[{"v", "[", 
          RowBox[{"[", 
           RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vec", "=", 
       RowBox[{"Vector", "@@", "e"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"normal", " ", "vector"}], " ", "*)"}], "\[IndentingNewLine]", 
      
      RowBox[{"vec", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"vec", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
         RowBox[{"vec", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vec", " ", "=", " ", 
       RowBox[{"vec", "/", 
        RowBox[{"Norm", "[", "vec", "]"}]}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NormalVector", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Expecting NormalVector[{vertex, vertex, ...}, index].\>\"", "]"}],
       ";", " ", "$Failed"}], ")"}]}], ";"}], 
  " "}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->
  True,ExpressionUUID->"a01fa62a-12d1-43bf-898e-77b352f41c64"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OutwardNormalVector", "[", 
     RowBox[{"{", 
      RowBox[{"pt__", "?", "PointQ"}], "}"}], "]"}], ":=", " ", 
    RowBox[{"OutwardNormalVector", "[", 
     RowBox[{
      RowBox[{"{", "pt", "}"}], ",", " ", "0"}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OutwardNormalVector", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pt__", "?", "PointQ"}], "}"}], ",", " ", "j_Integer"}], "]"}],
     ":=", " ", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"v", ",", " ", "OutwardNormal"}], "}"}], ",", " ", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"v", "=", 
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"{", "pt", "}"}], ",", " ", 
          RowBox[{"First", "[", 
           RowBox[{"{", "pt", "}"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"OutwardNormal", "[", " ", "i_Integer", "]"}], ":=", " ", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", " ", 
           RowBox[{
           "e", ",", " ", "vec", ",", " ", "origin", ",", " ", "epsilon", ",",
             " ", "point"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"edge", " ", "vector"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", "\[GreaterEqual]", " ", 
              RowBox[{"Length", "[", "v", "]"}]}], ",", " ", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<Error: OutwardNormalVector: edge \>\"", ",", " ", "i", 
                ",", " ", "\"\< does not exist: points=\>\"", ",", " ", 
                RowBox[{"{", "pt", "}"}]}], "]"}], ";", " ", 
              RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", " ", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"e", "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"v", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
              RowBox[{"v", "[", 
               RowBox[{"[", 
                RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "}"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"vec", "=", 
            RowBox[{"Vector", "@@", "e"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"normal", " ", "vector"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"vec", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"vec", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
              RowBox[{"vec", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"vec", " ", "=", " ", 
            RowBox[{"vec", "/", 
             RowBox[{"Norm", "[", "vec", "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"origin", " ", "=", " ", 
            RowBox[{"Mean", "[", "e", "]"}]}], ";", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"epsilon", "=", 
            RowBox[{"0.01", "*", 
             RowBox[{"Norm", "[", "e", "]"}]}]}], ";", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"point", "=", 
            RowBox[{"origin", "+", 
             RowBox[{"vec", "*", "epsilon"}]}]}], ";", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"Inside", "[", 
              RowBox[{
               RowBox[{"{", "pt", "}"}], ",", " ", "point"}], "]"}], " ", ",",
              " ", 
             RowBox[{"Return", "[", 
              RowBox[{"-", "vec"}], "]"}], ",", " ", 
             RowBox[{"Return", "[", "vec", "]"}]}], "]"}], ";"}]}], " ", 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"j", ">", "0"}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"OutwardNormal", "[", "j", "]"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"OutwardNormal", "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", 
             RowBox[{"{", "pt", "}"}], "]"}], "]"}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<OutwardNormalVector: Program Error: \>\"", ",", " ", 
         RowBox[{"{", 
          RowBox[{"pt", ",", " ", "j"}], "}"}]}], "]"}], ";"}]}], " ", 
     "\[IndentingNewLine]", "]"}]}], ";"}], " ", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OutwardNormalVector", "[", 
     RowBox[{"tissue_", "?", "TissueQ"}], "]"}], ":=", " ", 
    RowBox[{"OutwardNormalVector", "[", 
     RowBox[{"tissue", ",", " ", "0", ",", " ", "0"}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OutwardNormalVector", "[", 
     RowBox[{
      RowBox[{"tissue_", "?", "TissueQ"}], ",", " ", "cellNum_"}], "]"}], ":=",
     " ", 
    RowBox[{"OutwardNormalVector", "[", 
     RowBox[{"tissue", ",", " ", "cellNum", ",", " ", "0"}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OutwardNormalVector", "[", 
     RowBox[{
      RowBox[{"tissue_", "?", "TissueQ"}], ",", " ", "cellNumber_Integer", 
      ",", " ", "edgeNumber_Integer"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p", ",", " ", "nv"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"cellNumber", ">", "0"}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"single", " ", "cell"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"p", "=", 
           RowBox[{"CellVertexCoordinates", "[", 
            RowBox[{"tissue", ",", " ", "cellNumber"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Return", "[", 
           RowBox[{"OutwardNormalVector", "[", 
            RowBox[{"p", ",", " ", "edgeNumber"}], "]"}], "]"}], ";"}], " ", 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"all", " ", "cells"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "ignore", " ", "edge", " ", "number", " ", "in", " ", "this", " ", 
           "case"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"p", "=", 
           RowBox[{"CellVertexCoordinates", "[", "tissue", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "set", " ", "edgenumber", " ", "to", " ", "zero", " ", "to", " ", 
            "force", " ", "all", " ", "edges"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"nv", " ", "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"OutwardNormalVector", "[", 
              RowBox[{"#", ",", " ", "0"}], "]"}], "&"}], "/@", "p"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "nv", "]"}], ";"}]}], " ", 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<Error: Outward Normal Vector: Program Error: \>\"", ",", " ", 
         RowBox[{"{", 
          RowBox[{"tissue", ",", " ", "cellNumber", ",", " ", "edgeNumber"}], 
          "}"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "$Failed", "]"}], ";"}]}], " ", 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OutwardNormalVector", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Error; Expecting OutwardNormalVector[{p1,p2,...}, index:0] or \
OutwardNormalVector[Tissue, cellNumber:0, edgeNumber:0] (0 means all)\>\"", 
       "]"}], ";", " ", 
      RowBox[{"Return", "[", "$Failed", "]"}]}], ")"}]}], ";"}], 
  " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.448536782137778*^9, 3.448536846633141*^9}, {
   3.448536964831889*^9, 3.448537017055719*^9}, {3.448537066885338*^9, 
   3.448537079433793*^9}, {3.448537240158274*^9, 3.448537248446424*^9}, {
   3.448537305584664*^9, 3.448537321562405*^9}, {3.448537502974315*^9, 
   3.448537509021855*^9}, {3.448537764047196*^9, 3.44853778004577*^9}, {
   3.448538576039031*^9, 3.448538708027371*^9}, {3.448538910581874*^9, 
   3.448538931366951*^9}, {3.448538963891272*^9, 3.448539019018729*^9}, {
   3.448539346706127*^9, 3.448539709983364*^9}, 3.448540422723775*^9, {
   3.448543366953201*^9, 3.448543367102*^9}, {3.448543546816192*^9, 
   3.448543687391912*^9}, {3.448543724742989*^9, 3.448543786385696*^9}, {
   3.448543849336089*^9, 3.448543881443024*^9}, {3.448543929903632*^9, 
   3.448544078686192*^9}, {3.448544127743551*^9, 3.448544161312557*^9}, {
   3.448544209311253*^9, 3.448544226503979*^9}, {3.448544259082332*^9, 
   3.448544385011072*^9}, {3.448544429431442*^9, 3.448544480398526*^9}, {
   3.448544517879029*^9, 3.448544669179633*^9}, {3.448544724154441*^9, 
   3.44854476743871*^9}, {3.448544802314463*^9, 
   3.448544806014152*^9}},ExpressionUUID->"d3694e8b-c072-4149-b9cc-\
d9a409b61e7f"]
}, Closed]],

Cell[CellGroupData[{

Cell["Midpoint", "Subsection",
 CellChangeTimes->{{3.448545123630323*^9, 
  3.448545133565559*^9}},ExpressionUUID->"72b65e62-274e-4d5e-93f3-\
8eaece8be182"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MidPoint", "[", 
    RowBox[{
     RowBox[{"p1_", "?", "PointQ"}], ",", " ", 
     RowBox[{"p2_", "?", "PointQ"}]}], "]"}], ":=", " ", 
   RowBox[{"Mean", "[", 
    RowBox[{"{", 
     RowBox[{"p1", ",", "p2"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MidPoint", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p1_", "?", "PointQ"}], ",", " ", 
       RowBox[{"p2_", "?", "PointQ"}]}], "}"}], "]"}], ":=", " ", 
    RowBox[{"Mean", "[", 
     RowBox[{"{", 
      RowBox[{"p1", ",", "p2"}], "}"}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MidPoint", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p1_", "?", "PointQ"}], ",", " ", 
       RowBox[{"p2_", "?", "PointQ"}], ",", " ", 
       RowBox[{"p3__", "?", "PointQ"}]}], "}"}], "]"}], ":=", 
    RowBox[{"MidPoint", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p1", ",", "p2", ",", " ", "p3"}], "}"}], ",", " ", "0"}], 
     "]"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MidPoint", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p1_", "?", "PointQ"}], ",", " ", 
       RowBox[{"p2_", "?", "PointQ"}], ",", " ", 
       RowBox[{"p3__", "?", "PointQ"}]}], "}"}], ",", " ", "i_Integer"}], 
    "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v", ",", " ", "mp"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"v", "=", 
       RowBox[{"{", 
        RowBox[{"p1", ",", "p2", ",", " ", "p3", ",", " ", "p1"}], "}"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"i", "\[GreaterEqual]", " ", 
         RowBox[{"Length", "[", "v", "]"}]}], ",", " ", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Error: Midpoint: edge \>\"", ",", " ", "i", ",", " ", 
           "\"\< does not exist in polygon \>\"", ",", " ", "v"}], "]"}], ";",
          " ", 
         RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", "  ", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"i", ">", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"mp", "=", 
          RowBox[{"MidPoint", "[", 
           RowBox[{
            RowBox[{"v", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
            RowBox[{"v", "[", 
             RowBox[{"[", 
              RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "]"}]}], ";"}], 
        "\[IndentingNewLine]", ",", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"v", "=", " ", 
          RowBox[{"Partition", "[", 
           RowBox[{"v", ",", " ", "2", ",", " ", "1"}], "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"mp", " ", "=", " ", 
          RowBox[{"MidPoint", "/@", "v"}]}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "mp", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MidPoint", "[", 
     RowBox[{
      RowBox[{"tissue_", "?", "TissueQ"}], ",", " ", "cellNumber_Integer"}], 
     "]"}], ":=", " ", 
    RowBox[{"MidPoint", "[", 
     RowBox[{"tissue", ",", " ", "cellNumber", ",", " ", "0"}], "]"}]}], 
   ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MidPoint", "[", 
     RowBox[{"tissue_", "?", "TissueQ"}], "]"}], ":=", " ", 
    RowBox[{"MidPoint", "[", 
     RowBox[{"tissue", ",", " ", "0", ",", " ", "0"}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MidPoint", "[", 
     RowBox[{
      RowBox[{"tissue_", "?", "TissueQ"}], ",", " ", "cellNumber_Integer", 
      ",", " ", "edgeNumber_Integer"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"v", ",", " ", "mp"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"cellNumber", ">", "0"}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"v", "=", 
           RowBox[{"CellVertexCoordinates", "[", 
            RowBox[{"tissue", ",", " ", "cellNumber"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"mp", "=", 
           RowBox[{"MidPoint", "[", 
            RowBox[{"v", ",", " ", "edgeNumber"}], "]"}]}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"v", "=", 
           RowBox[{"CellVertexCoordinates", "[", "tissue", "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"mp", "=", 
           RowBox[{"MidPoint", "/@", "v"}]}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "mp", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.448545135236854*^9, 3.448545220607024*^9}, {
  3.448545274926639*^9, 3.448545356181335*^9}, {3.448545390157772*^9, 
  3.448545571919936*^9}, {3.448545604535806*^9, 3.448545638644896*^9}, {
  3.448545722314926*^9, 3.448545744104387*^9}, {3.448545800991292*^9, 
  3.448545810174946*^9}, {3.448545856663621*^9, 3.448546061790486*^9}, {
  3.448546613254437*^9, 3.448546639625826*^9}, {3.448546685906713*^9, 
  3.44854669922253*^9}, {3.44854676396149*^9, 3.448546764139742*^9}, {
  3.448546834764355*^9, 
  3.448546839281032*^9}},ExpressionUUID->"c496faf8-6394-4c4b-809d-\
5496c188a640"],

Cell["", "Subsubsection",ExpressionUUID->"3e95eccc-6a72-4152-a147-712cb1d47ad0"]
}, Closed]],

Cell[CellGroupData[{

Cell["PartitionPolygon", "Subsection",
 CellChangeTimes->{
  3.5462734108698874`*^9},ExpressionUUID->"dc483cf7-eaa4-48b9-bc0e-\
455511412e9d"],

Cell["\<\
Given a polygon that is specified as a list of vertex coordinates, return a \
new polygon with n vertices. 
Supposedly n >> than the original number of vertices, so that the polygon can \
be graphically approximated by a sequence of dots. 
For example to Partition a Triangle into 100 points use \
PartitionPolygon[{p1,p2,p3}, 100]
The points will be \[OpenCurlyDoubleQuote]approximately\
\[CloseCurlyDoubleQuote] equally spaced, and the number of points will be \
approximately n, but because of rounding the interval size will be adjusted \
for each edge, to maintain an equal spacing on each edge, so the total may be \
sliglhty more than n. \
\>", "Text",
 CellChangeTimes->{{3.5462734415817423`*^9, 
  3.546273625838114*^9}},ExpressionUUID->"774c8e21-2c74-40db-88a7-\
c0d25de4ea33"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PartitionPolygon", "[", 
   RowBox[{
    RowBox[{"points_", "?", "ListQ"}], ",", "n_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "input", ",", "perimeter", ",", "DL", ",", "PartitionSegment", ",", 
      "segments", ",", "partitioning", ",", "distances", ",", "short"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{"input", "=", 
      RowBox[{"Append", "[", 
       RowBox[{"points", ",", 
        RowBox[{"First", "[", "points", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"perimeter", "=", 
      RowBox[{"perimeterLength", "[", "points", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"DL", "=", 
      RowBox[{"perimeter", "/", 
       RowBox[{"(", 
        RowBox[{"1.0", "*", "n"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PartitionSegment", "[", 
       RowBox[{"p1_", ",", "p2_", ",", "DL_"}], "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"d", ",", "m"}], "}"}], ",", 
        RowBox[{
         RowBox[{"d", "=", 
          RowBox[{"distance", "[", 
           RowBox[{"p1", ",", "p2"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"m", "=", 
          RowBox[{"Round", "[", 
           RowBox[{"0.5", "+", 
            RowBox[{"(", 
             RowBox[{"d", "/", "DL"}], ")"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"p1", "+", 
            RowBox[{"1.0", "*", "j", "*", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p2", "-", "p1"}], ")"}], "/", "m"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "0", ",", "m"}], "}"}]}], "]"}]}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"segments", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{"input", ",", "2", ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"partitioning", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"PartitionSegment", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", "DL"}], "]"}], "&"}], "/@", 
         "segments"}], ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"distances", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"distance", "@@", "#"}], "&"}], "/@", 
       RowBox[{"Partition", "[", 
        RowBox[{"partitioning", ",", "2", ",", "1", ",", "1"}], "]"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"short", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"#", "<", 
          RowBox[{"0.1", "*", "DL"}]}], ")"}], "&"}], "/@", "distances"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"partitioning", "=", 
      RowBox[{"Pick", "[", 
       RowBox[{"partitioning", ",", 
        RowBox[{"Not", "/@", "short"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.546273417359961*^9, 3.546273436600617*^9}, 
   3.7057118594178753`*^9},ExpressionUUID->"7c742fc1-5a80-49b8-b682-\
dd242002197d"]
}, Closed]],

Cell[CellGroupData[{

Cell["RadialPolygon", "Subsection",
 CellChangeTimes->{{3.546274892903109*^9, 
  3.546274897190802*^9}},ExpressionUUID->"7d5a516d-9912-4b04-9e91-\
43bcc3ba6cc6"],

Cell["\<\
Returns an interpolating function for the radius as a function of central \
angle for a polygon\
\>", "Text",
 CellChangeTimes->{{3.546274906070839*^9, 
  3.5462749244556026`*^9}},ExpressionUUID->"43ad2970-4ae6-4a0b-b5c4-\
4c2d076afa00"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RadialPolygon", "[", 
   RowBox[{
    RowBox[{"inputdata_", "?", "ListQ"}], ",", "n_", ",", 
    RowBox[{"order_:", "1"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "p", ",", "c", ",", "pts", ",", "thetas", ",", "rs", ",", " ", "data", 
      ",", "lastpoint", ",", " ", "firstpoint", ",", "r", ",", "points"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"points", " ", "=", " ", "inputdata"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"First", "[", "points", "]"}], "\[Equal]", 
        RowBox[{"Last", "[", "points", "]"}]}], ",", " ", 
       RowBox[{"points", "=", 
        RowBox[{"Most", "[", "points", "]"}]}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"Centroid", "[", "points", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"pts", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"#", "-", "c"}], ")"}], "&"}], "/@", "points"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"p", "=", 
      RowBox[{"PartitionPolygon", "[", 
       RowBox[{"pts", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"thetas", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"ArcTan", "@@", "#"}], "&"}], "/@", "p"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"thetas", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"#", "<", "0"}], ",", 
          RowBox[{"#", "+", 
           RowBox[{"2", "Pi"}]}], ",", "#"}], "]"}], "&"}], "/@", 
       "thetas"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rs", " ", "=", " ", 
      RowBox[{"Norm", "/@", "p"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"sort", " ", "data", " ", "by", " ", "angle"}], " ", "*)"}], 
     " ", "\[IndentingNewLine]", 
     RowBox[{"data", " ", "=", " ", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"thetas", ",", "rs"}], "}"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"Sort", "[", "data", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "copy", " ", "end", " ", "points", " ", "at", " ", "0", " ", "and", " ",
        "2", "Pi", " ", "to", " ", "ensure", " ", "full", " ", "coverage"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"lastpoint", " ", "=", " ", 
      RowBox[{"Last", "[", "data", "]"}]}], ";", " ", 
     RowBox[{"lastpoint", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"lastpoint", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "-", 
         RowBox[{"2", "Pi"}]}], ",", 
        RowBox[{"lastpoint", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"firstpoint", " ", "=", " ", 
      RowBox[{"First", "[", "data", "]"}]}], ";", " ", 
     RowBox[{"firstpoint", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"firstpoint", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", 
         RowBox[{"2", "Pi"}]}], ",", " ", 
        RowBox[{"firstpoint", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"data", " ", "=", " ", 
      RowBox[{"Append", "[", " ", 
       RowBox[{
        RowBox[{"Prepend", "[", 
         RowBox[{"data", ",", " ", "lastpoint"}], "]"}], ",", "firstpoint"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Now", " ", "make", " ", "it", " ", "periodic", " ", 
       RowBox[{"on", " ", "[", 
        RowBox[{"0", ",", 
         RowBox[{"2", "Pi"}]}], "]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"r", "=", 
      RowBox[{"Interpolation", "[", 
       RowBox[{"data", ",", 
        RowBox[{"InterpolationOrder", "\[Rule]", " ", "order"}]}], "]"}]}], 
     ";", " ", "\[IndentingNewLine]", 
     RowBox[{"data", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"2.0", "*", "Pi", "*", 
           RowBox[{"i", "/", "n"}]}], ",", 
          RowBox[{"r", "[", 
           RowBox[{"2.0", "*", "Pi", "*", 
            RowBox[{"i", "/", "n"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"r", "=", 
      RowBox[{"Interpolation", "[", 
       RowBox[{"data", ",", 
        RowBox[{"InterpolationOrder", "\[Rule]", " ", "order"}], ",", " ", 
        RowBox[{"PeriodicInterpolation", "\[Rule]", " ", "True"}]}], 
       "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.546273677172176*^9, 3.5462737800352373`*^9}, {
  3.546273884804538*^9, 3.546274018246725*^9}, {3.546274075240347*^9, 
  3.546274110838661*^9}, {3.546274171087186*^9, 3.5462742439533377`*^9}, {
  3.546274300137435*^9, 3.546274357802677*^9}, {3.5462743934891357`*^9, 
  3.546274428310541*^9}, {3.546274554772345*^9, 3.5462748834764547`*^9}, {
  3.546375726647807*^9, 3.5463757590404053`*^9}, {3.547578261725049*^9, 
  3.547578268052685*^9}, {3.5475783682268057`*^9, 3.5475785246334133`*^9}, {
  3.547578578164213*^9, 3.547578587680978*^9}, {3.547578792946164*^9, 
  3.547578814329341*^9}, {3.547578900273738*^9, 3.547578910645543*^9}, {
  3.549918925112301*^9, 
  3.549918958298613*^9}},ExpressionUUID->"649e56b9-5bd0-47ad-9143-\
10c5b4256504"]
}, Closed]],

Cell[CellGroupData[{

Cell["AngularPerimeterFunction, EquiperimeterPoints", "Subsection",
 CellChangeTimes->{{3.549916153915745*^9, 3.5499161771717157`*^9}, {
  3.549916252882753*^9, 3.5499162536271963`*^9}, {3.549918178317566*^9, 
  3.549918188564823*^9}},ExpressionUUID->"dfc5647d-de2d-4429-a22c-\
c9e63dd3cef9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AngularPerimeterFunction", "[", 
    RowBox[{"points_", ",", 
     RowBox[{"n_:", "100"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ptab", ",", "pfunc"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ptab", " ", "=", " ", 
       RowBox[{"AngularPerimeterInterpolationTable", "[", 
        RowBox[{"points", ",", "n"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"pfunc", "=", 
       RowBox[{"Interpolation", "[", "ptab", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "pfunc", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AngularPerimeterInterpolationTable", "[", 
    RowBox[{"points_", ",", 
     RowBox[{"n_:", "100"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "r", ",", "integrand", ",", " ", "itab", ",", " ", "i", ",", " ", 
       "perimeter", ",", "ptab", ",", "data"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", " ", "=", " ", "points"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"First", "[", "data", "]"}], "\[Equal]", 
         RowBox[{"Last", "[", "data", "]"}]}], ",", " ", 
        RowBox[{"data", " ", "=", " ", 
         RowBox[{"Most", "[", "data", "]"}]}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"r", "=", 
       RowBox[{"RadialPolygon", "[", 
        RowBox[{"data", ",", "n"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"integrand", "[", "t_", "]"}], ":=", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"r", "[", "t", "]"}], "^", "2"}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"r", "'"}], "[", "t", "]"}], "^", "2"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"itab", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t", ",", 
           RowBox[{"integrand", "[", "t", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", 
           RowBox[{"2", " ", "Pi"}], ",", 
           RowBox[{"2.0", " ", 
            RowBox[{"Pi", "/", "n"}]}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"i", "=", 
       RowBox[{"Interpolation", "[", "itab", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"perimeter", "[", "t_", "]"}], ":=", 
       RowBox[{"Integrate", "[", 
        RowBox[{
         RowBox[{"i", "[", "s", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "0", ",", "t"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ptab", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t", ",", 
           RowBox[{"perimeter", "[", "t", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", 
           RowBox[{"2", " ", "Pi"}], ",", 
           RowBox[{"2.0", " ", 
            RowBox[{"Pi", "/", "n"}]}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "ptab", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EquiperimeterPoints", "[", 
   RowBox[{"points_", ",", " ", "n_"}], " ", "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "ptab", ",", "i", ",", " ", "p", ",", "perimeter", ",", "delta", ",", 
      " ", "distances", ",", " ", "angles", ",", " ", "r", ",", " ", "radii", 
      ",", " ", "P2R", ",", " ", "C"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"C", "=", 
      RowBox[{"Centroid", "[", "points", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"P2R", "[", 
       RowBox[{"r_", ",", "theta_"}], "]"}], ":=", 
      RowBox[{"C", "+", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"r", "*", 
          RowBox[{"Cos", "[", "theta", "]"}]}], ",", " ", 
         RowBox[{"r", "*", 
          RowBox[{"Sin", "[", "theta", "]"}]}]}], "}"}]}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"ptab", " ", "=", " ", 
      RowBox[{"AngularPerimeterInterpolationTable", "[", 
       RowBox[{"points", ",", "100"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"p", "=", 
      RowBox[{"Interpolation", "[", "ptab", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"ptab", " ", "=", " ", 
      RowBox[{"Reverse", "/@", "ptab"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"i", " ", "=", " ", 
      RowBox[{"Interpolation", "[", "ptab", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"perimeter", " ", "=", " ", 
      RowBox[{"p", "[", 
       RowBox[{"2", " ", "Pi"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"delta", " ", "=", " ", 
      RowBox[{"perimeter", "/", "n"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"distances", " ", "=", " ", 
      RowBox[{"delta", "*", 
       RowBox[{"Range", "[", 
        RowBox[{"0", ",", 
         RowBox[{"n", "-", "1"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"angles", " ", "=", " ", 
      RowBox[{"i", "/@", "distances"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"r", " ", "=", " ", 
      RowBox[{"RadialPolygon", "[", 
       RowBox[{"points", ",", "100"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"radii", " ", "=", " ", 
      RowBox[{"r", "/@", "angles"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"MapThread", "[", 
      RowBox[{"P2R", ",", " ", 
       RowBox[{"{", 
        RowBox[{"radii", ",", " ", "angles"}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5499161818694277`*^9, 3.549916250900193*^9}, {
   3.549916343753367*^9, 3.549916355899726*^9}, {3.549917322772345*^9, 
   3.5499174571302433`*^9}, {3.5499175144345837`*^9, 3.549917555215664*^9}, {
   3.5499175936937647`*^9, 3.5499175959853888`*^9}, {3.5499179032964163`*^9, 
   3.54991790703788*^9}, {3.549917972258897*^9, 3.549918070239547*^9}, 
   3.549918133647965*^9, 3.549918163857079*^9, {3.549918258879374*^9, 
   3.549918315164179*^9}, {3.549918366063039*^9, 3.549918384633762*^9}, {
   3.549918514971733*^9, 3.549918615280531*^9}, {3.549918645435397*^9, 
   3.5499187186229067`*^9}, {3.549918781620515*^9, 3.549918903349434*^9}, {
   3.5499190445634737`*^9, 3.5499190904869537`*^9}, {3.5499196903378267`*^9, 
   3.549919708924808*^9}},ExpressionUUID->"9fa061bb-16eb-4183-945f-\
8d734ebe06d4"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["3D Analysis Functions", "Section",
 CellChangeTimes->{{3.5590859295749197`*^9, 
  3.559085933365759*^9}},ExpressionUUID->"b3a55a39-087e-4b6a-8bd8-\
0804e09d5518"],

Cell[CellGroupData[{

Cell["Point2DQ, Point3DQ, PointList3DzQ", "Subsection",
 CellChangeTimes->{{3.559085962062508*^9, 3.55908597019837*^9}, {
  3.559086004070126*^9, 3.5590860072057943`*^9}, {3.5590875341160173`*^9, 
  3.559087538499061*^9}},ExpressionUUID->"0515f781-6d43-40f0-a4f1-\
aa96a1fc0a7d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Point2DQ", "[", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_"}], "}"}], "]"}], ":=", " ", "True"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Point2DQ", "[", "x___", "]"}], ":=", " ", "False"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Point3DQ", "[", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", " ", "True"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Point3DQ", "[", "x___", "]"}], ":=", " ", "False"}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PointList3DQ", "[", 
     RowBox[{"{", 
      RowBox[{"v___", "?", "Point3DQ"}], "}"}], "]"}], ":=", "True"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PointList3DQ", "[", "x___", "]"}], ":=", " ", "False"}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.559085935285983*^9, 3.559086031785767*^9}, {
  3.559087511686219*^9, 
  3.5590875315748*^9}},ExpressionUUID->"58651802-23ad-4e4e-98c7-758c346c3678"]
}, Closed]],

Cell[CellGroupData[{

Cell["Perimeter3D (perimeterLength)", "Subsection",
 CellChangeTimes->{{3.5590860420298*^9, 3.559086061373312*^9}, {
  3.706371151043111*^9, 
  3.706371156200234*^9}},ExpressionUUID->"c87b0ec4-65e3-41db-916c-\
5fdf9c383751"],

Cell[BoxData[
 RowBox[{
  RowBox[{"perimeterLength", "[", 
   RowBox[{"p_", "?", "PointList3DQ"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"pointPairs", ",", "segments", ",", "lengths"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "p", "]"}], "<", "2"}], ",", " ", 
       RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"pointPairs", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{"p", ",", "2", ",", "1", ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"segments", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Subtract", "@@", "#"}], "&"}], "/@", "pointPairs"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"lengths", " ", "=", " ", 
      RowBox[{"Norm", "/@", "segments"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"Plus", "@@", "lengths"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.559086065493293*^9, 3.559086132455756*^9}, {
   3.559086184550867*^9, 3.559086220750602*^9}, {3.559086366126566*^9, 
   3.559086430679501*^9}, 
   3.705712022544304*^9},ExpressionUUID->"4e529ad1-d31b-4772-a93d-\
677ab63c55f0"]
}, Closed]],

Cell[CellGroupData[{

Cell["Centroid", "Subsection",
 CellChangeTimes->{{3.559086514162624*^9, 
  3.559086515034319*^9}},ExpressionUUID->"a83906a5-45d6-475a-9801-\
6f259d317158"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Centeroid", "[", 
     RowBox[{"p_", "?", "PointList3DQ"}], "]"}], ":=", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "p", "]"}], "<", "1"}], ",", " ", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], "]"}], ",", " ", 
      RowBox[{"Mean", "[", "p", "]"}]}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Centroid", "[", 
     RowBox[{"p_", "?", "PointList3DQ"}], "]"}], ":=", " ", 
    RowBox[{"Centeroid", "[", "p", "]"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.55908651666026*^9, 3.559086580149259*^9}, {
  3.559090026690041*^9, 3.559090054242757*^9}, {3.559090200770199*^9, 
  3.5590902198354807`*^9}},ExpressionUUID->"266e280b-6140-40ad-a2c6-\
f8496a6ec2c8"]
}, Closed]],

Cell[CellGroupData[{

Cell["Hero", "Subsection",
 CellChangeTimes->{{3.559086667129506*^9, 3.5590866804892273`*^9}, {
  3.559086715625184*^9, 
  3.55908671691288*^9}},ExpressionUUID->"93562c25-ee68-48bb-bc07-\
d3ef6d81ee9a"],

Cell["\<\
Finds area of a triangle from the lengths of th sides
Hero[side,side,side]
Hero1[vertex, vertex, vertex]

The Abs[A] is returned because sometimes for very small narrow triangles the \
product of differences could give (numerically) an excruciatingly tiny \
negative number and this will force instead an excruciatingly tiny positive \
number so the square root will be real (i.e, 10^-7 rather than 10^-7i)\
\>", "Text",
 CellChangeTimes->{{3.559086739152464*^9, 3.559086746240991*^9}, {
  3.559088602365636*^9, 3.559088652187565*^9}, {3.565482735608677*^9, 
  3.565482813974402*^9}},ExpressionUUID->"0464fc59-b739-4f05-b364-\
8b21081f2ccd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Hero", "[", 
    RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s", ",", "A"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"s", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"a", "+", "b", "+", "c"}], ")"}], "/", "2"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"A", "=", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"s", 
         RowBox[{"(", 
          RowBox[{"s", "-", "a"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"s", "-", "b"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"s", "-", "c"}], ")"}]}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"Abs", "[", "A", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Hero1", "[", 
    RowBox[{
     RowBox[{"p_", "?", "Point3DQ"}], ",", " ", 
     RowBox[{"q_", "?", "Point3DQ"}], ",", 
     RowBox[{"r_", "?", "Point3DQ"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "sides", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sides", "=", 
       RowBox[{"Norm", "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Subtract", "@@", "#"}], "&"}], "/@", 
          RowBox[{"Partition", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"p", ",", "q", ",", "r"}], "}"}], ",", "2", ",", "1", 
            ",", "1"}], "]"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Hero", "@@", "sides"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Hero1", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"p_", "?", "Point3DQ"}], ",", " ", 
      RowBox[{"q_", "?", "Point3DQ"}], ",", 
      RowBox[{"r_", "?", "Point3DQ"}]}], "}"}], "]"}], ":=", " ", 
   RowBox[{"Hero1", "[", 
    RowBox[{"p", ",", "q", ",", "r"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Hero2", "[", 
   RowBox[{"r1_", ",", " ", "r2_", ",", " ", "theta_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"c", ",", "  ", 
      RowBox[{"teeny", "=", ".0001"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"c", "=", 
      RowBox[{
       RowBox[{"r1", "*", "r1"}], "+", 
       RowBox[{"r2", "*", "r2"}], "-", 
       RowBox[{"2", "r1", "*", "r2", "*", 
        RowBox[{"Cos", "[", "theta", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"c", "=", 
      RowBox[{"Max", "[", 
       RowBox[{"c", ",", "0.0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"Sqrt", "[", "c", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"c", "<", "teeny"}], ",", 
       RowBox[{"Return", "[", "0.0", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Hero", "[", 
      RowBox[{"r1", ",", "r2", ",", "c"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.559086712425609*^9, 3.559086785875502*^9}, {
  3.559088317409306*^9, 3.55908842078968*^9}, {3.5590884576862907`*^9, 
  3.559088460717514*^9}, {3.565482708197721*^9, 3.565482710680381*^9}, {
  3.565792799355434*^9, 
  3.56579293193407*^9}},ExpressionUUID->"3c4b5b8e-3a15-4b10-aa18-\
1df0f18d69e2"]
}, Closed]],

Cell[CellGroupData[{

Cell["AreaTriangle", "Subsection",
 CellChangeTimes->{{3.559087304668983*^9, 
  3.5590873097646837`*^9}},ExpressionUUID->"083d469f-8fa7-4ae4-835e-\
356a7fa2373b"],

Cell["\<\
Note: Using Hero\[CloseCurlyQuote]s formula is faster than doing a cross \
product calculation!\
\>", "Text",
 CellChangeTimes->{{3.559088550035885*^9, 
  3.559088567995976*^9}},ExpressionUUID->"ddf5fbb2-16ec-4380-adda-\
39229189a64f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AreaTriangle", "[", 
     RowBox[{
      RowBox[{"p_", "?", "Point3DQ"}], ",", " ", 
      RowBox[{"q_", "?", "Point3DQ"}], ",", 
      RowBox[{"r_", "?", "Point3DQ"}]}], "]"}], ":=", " ", 
    RowBox[{"Hero1", "[", 
     RowBox[{"p", ",", "q", ",", "r"}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AreaTriangle", "[", 
    RowBox[{
     RowBox[{"p_", "?", "Point2DQ"}], ",", " ", 
     RowBox[{"q_", "?", "Point2DQ"}], ",", " ", 
     RowBox[{"r_", "?", "Point2DQ"}]}], "]"}], ":=", " ", 
   RowBox[{"AreaTriangle", "[", 
    RowBox[{
     RowBox[{"Append", "[", 
      RowBox[{"p", ",", "0"}], "]"}], ",", 
     RowBox[{"Append", "[", 
      RowBox[{"q", ",", "0"}], "]"}], ",", " ", 
     RowBox[{"Append", "[", 
      RowBox[{"r", ",", "0"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AreaTriangle", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"p_", "?", "Point3DQ"}], ",", " ", 
      RowBox[{"q_", "?", "Point3DQ"}], ",", 
      RowBox[{"r_", "?", "Point3DQ"}]}], "}"}], "]"}], ":=", " ", 
   RowBox[{"AreaTriangle", "[", 
    RowBox[{"p", ",", "q", ",", "r"}], "]"}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AreaTriangle", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p_", "?", "Point2DQ"}], ",", " ", 
       RowBox[{"q_", "?", "Point2DQ"}], ",", " ", 
       RowBox[{"r_", "?", "Point2DQ"}]}], "}"}], "]"}], ":=", " ", 
    RowBox[{"AreaTriangle", "[", 
     RowBox[{"p", ",", "q", ",", "r"}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AreaTriangle", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Expecting AreaTriangle[point,point,point], not: \>\"", ",", " ", 
        "x"}], "]"}], ";", " ", 
      RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.559087311149829*^9, 3.5590874040957317`*^9}, {
   3.559087471310622*^9, 3.559087476055299*^9}, {3.559087547534842*^9, 
   3.559087609268374*^9}, {3.559087648233213*^9, 3.559087793187703*^9}, {
   3.559088296113832*^9, 3.5590883229609203`*^9}, {3.559088533053347*^9, 
   3.559088547732643*^9}, 
   3.559088666647621*^9},ExpressionUUID->"18d3abb6-4da0-46e5-b791-\
ba7fefabc058"]
}, Closed]],

Cell[CellGroupData[{

Cell["AltitudeTriangle", "Subsection",
 CellChangeTimes->{{3.565459278388609*^9, 
  3.565459285805867*^9}},ExpressionUUID->"95759bec-7baa-47e4-b96c-\
372593200af5"],

Cell[TextData[{
 "finds the altitude to side a of a triangle to side a. Based on Heron\
\[CloseCurlyQuote]s formula \nA = ",
 Cell[BoxData[
  FormBox[
   SqrtBox[
    RowBox[{
     RowBox[{"s", " ", 
      RowBox[{"(", 
       RowBox[{"s", " ", "-", " ", "a"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"s", " ", "-", " ", "b"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"s", " ", "-", " ", "c"}], ")"}]}], "]"}]], TraditionalForm]],
  ExpressionUUID->"f22fd322-03b3-4073-8779-0f643d4e51fa"],
 "= ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox["1", "2"], "a", "*", "h"}], TraditionalForm]],ExpressionUUID->
  "8767a2ac-3819-4461-9025-c0cabda0d4e0"],
 " hence the formula for h=2A/a\nThe Absolute value is used to force a real \
number in the event of excruciatinly shallow triangles where the numerical \
computation could give a small imaginary number (e.g, if b+c=a with 1 ulp \
error)\n\nIn the second form theta is the angle between r1 and r2 and the \
altitude is to the unspecified side.\n"
}], "Text",
 CellChangeTimes->{{3.565459302109209*^9, 3.565459317612259*^9}, {
   3.5654593565809803`*^9, 3.565459422116378*^9}, {3.565482865724131*^9, 
   3.565482942835929*^9}, 3.565705110142421*^9, {3.565705148153234*^9, 
   3.565705151815061*^9}, {3.565705270484085*^9, 
   3.565705295599534*^9}},ExpressionUUID->"7265fbf1-9858-44fa-90a4-\
187c26509836"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AltitudeTriangle", "[", 
    RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "s", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Abs", "[", 
      RowBox[{
       RowBox[{"Hero", "[", 
        RowBox[{"a", ",", "b", ",", "c"}], "]"}], "*", 
       RowBox[{"2", "/", "a"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AltitudeTriangle1", "[", 
   RowBox[{"r1_", ",", " ", "r2_", ",", " ", "theta_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "a2", ",", " ", 
      RowBox[{"teeny", "=", ".0001"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a2", "=", 
      RowBox[{
       RowBox[{"r1", "*", "r1"}], "+", 
       RowBox[{"r2", "*", "r2"}], "-", 
       RowBox[{"2", "r1", "*", "r2", "*", 
        RowBox[{"Cos", "[", "theta", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"a2", "=", 
      RowBox[{"Max", "[", 
       RowBox[{"a2", ",", "0.0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"Sqrt", "[", "a2", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"a", "<", "teeny"}], ",", 
       RowBox[{"Return", "[", "r1", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AltitudeTriangle", "[", 
      RowBox[{"a", ",", "r1", ",", "r2"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5654592868117247`*^9, 3.565459297758003*^9}, {
  3.565459502976573*^9, 3.565459554155135*^9}, {3.565482860721196*^9, 
  3.565482863685811*^9}, {3.565705081651658*^9, 3.565705123413233*^9}, {
  3.565705171747967*^9, 3.56570526852868*^9}, {3.5657101934042387`*^9, 
  3.565710211141165*^9}, {3.565711144631501*^9, 
  3.565711146478804*^9}},ExpressionUUID->"1655effe-5dc8-417a-9933-\
2f04e3637b3f"]
}, Closed]],

Cell[CellGroupData[{

Cell["PolygonArea", "Subsection",
 CellChangeTimes->{{3.559088676427904*^9, 
  3.5590886807149563`*^9}},ExpressionUUID->"6f26c7d1-6be0-47d1-a8b7-\
e946a87b9be4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PolygonArea", "[", "p_", "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "center", ",", " ", "triangles", ",", " ", "pairs", ",", " ", "areas", 
       ",", "area"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "p", "]"}], "<", "3"}], ",", " ", 
        RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"center", " ", "=", " ", 
       RowBox[{"Centeroid", "[", "p", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"triangles", " ", "=", " ", 
       RowBox[{"Partition", "[", 
        RowBox[{"p", ",", "2", ",", "1", ",", "1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"triangles", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Append", "[", 
          RowBox[{"#", ",", "center"}], "]"}], "&"}], "/@", "triangles"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"areas", " ", "=", " ", 
       RowBox[{"AreaTriangle", "/@", "triangles"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"area", " ", "=", " ", 
       RowBox[{"Plus", "@@", "areas"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "area", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.55908868231736*^9, 3.559088834118842*^9}, {
  3.5590889031349688`*^9, 3.5590889564150553`*^9}, {3.561556577622994*^9, 
  3.5615565914979963`*^9}, {3.565457637063287*^9, 
  3.565457692861308*^9}},ExpressionUUID->"663675cd-5ddd-44ec-bd41-\
36f8bb18e487"]
}, Closed]],

Cell[CellGroupData[{

Cell["ZProjection", "Subsection",
 CellChangeTimes->{{3.559425983570223*^9, 
  3.559425985554513*^9}},ExpressionUUID->"cf92fcf1-f91e-498a-a49f-\
842d7ee27999"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ZProjection", "[", 
    RowBox[{"T_", "?", "TissueQ"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v", ",", "e", ",", "c"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v", ",", "e", ",", "c"}], "}"}], "=", 
       RowBox[{"T", "/.", 
        RowBox[{"{", 
         RowBox[{"Tissue", "\[Rule]", " ", "List"}], "}"}]}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"Tissue", "[", 
       RowBox[{
        RowBox[{"Most", "/@", "v"}], ",", "e", ",", "c"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5594259891730433`*^9, 3.559426002549168*^9}, {
  3.55942603661663*^9, 
  3.5594260557903852`*^9}},ExpressionUUID->"426ac368-6252-4cd0-bde6-\
476bdcf503f4"]
}, Closed]],

Cell[CellGroupData[{

Cell["ShowZProjection", "Subsection",
 CellChangeTimes->{{3.559424910897941*^9, 
  3.559424913817069*^9}},ExpressionUUID->"b34e7cc1-e4a8-46de-bf77-\
aa407a9ec7d8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ShowZProjection", "[", 
    RowBox[{
     RowBox[{"T_", "?", "TissueQ"}], ",", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "T1", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"T1", "=", 
       RowBox[{"ZProjection", "[", "T", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"ShowTissue", "[", 
       RowBox[{"T1", ",", "opt"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ShowZProjection", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", "\"\<Expecting ShowZProjection[Tissue,options]\>\"", 
       "]"}], ";", 
      RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5594249224768057`*^9, 3.559424984068349*^9}, {
  3.5594260101651583`*^9, 3.559426034402165*^9}, {3.559426069325284*^9, 
  3.559426078908917*^9}},ExpressionUUID->"6c6d6087-e8a4-4ae3-a9ec-\
9c435b18ab93"]
}, Closed]],

Cell[CellGroupData[{

Cell["ShowTissue3D", "Subsection",
 CellChangeTimes->{{3.55909186492548*^9, 
  3.55909186679767*^9}},ExpressionUUID->"231bee83-f2f9-4214-a102-\
444c3e53ef21"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ShowTissue3D", "[", 
    RowBox[{"T_", ",", " ", 
     RowBox[{"edgestyle_:", "Black"}], ",", 
     RowBox[{"cellnumberstyle_:", "None"}], ",", " ", 
     RowBox[{"edgenumberstyle_:", "None"}], ",", " ", 
     RowBox[{"xrange_:", "All"}], ",", " ", 
     RowBox[{"yrange_:", "All"}], ",", 
     RowBox[{"zrange_:", "All"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "v", ",", "e", ",", "c", ",", "ne", ",", "edges", ",", "cellnumbers", 
       ",", "CVC", ",", "CC", ",", "CellNumbers", ",", "EdgeNumbers", ",", 
       "edgenumbers", ",", "EVC", ",", "EC", ",", " ", "edgesUsedInCells", 
       ",", "edgeInRange", ",", "plottableEdges", ",", "plottable"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"v", "=", 
       RowBox[{"TissueVertices", "[", "T", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"TissueCells", "[", "T", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"e", "=", 
       RowBox[{"TissueEdges", "[", "T", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Make", " ", "sure", " ", "to", " ", "only", " ", "plot", " ", "edges",
         " ", "that", " ", "are", " ", "ACTUALLY", " ", "USED", " ", "in", 
        " ", "cells"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      
      RowBox[{"(*", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ne", "=", 
         RowBox[{"Length", "[", "e", "]"}]}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"edges", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Line", "[", 
            RowBox[{"v", "[", 
             RowBox[{"[", 
              RowBox[{"e", "[", 
               RowBox[{"[", "#", "]"}], "]"}], "]"}], "]"}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", "ne", "]"}]}]}], ";"}], "\[IndentingNewLine]",
        "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"edgesUsedInCells", " ", "=", " ", 
       RowBox[{"Union", "[", 
        RowBox[{"Flatten", "[", "c", "]"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"edges", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"v", "[", 
           RowBox[{"[", 
            RowBox[{"e", "[", 
             RowBox[{"[", "#", "]"}], "]"}], "]"}], "]"}], "]"}], "&"}], "/@",
         "edgesUsedInCells"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"edgeInRange", "[", "j_", "]"}], ":=", " ", 
       RowBox[{"Or", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"IntervalCheck", "[", 
            RowBox[{"#", ",", "xrange", ",", "yrange", ",", "zrange"}], "]"}],
            "&"}], "/@", 
          RowBox[{"v", "[", 
           RowBox[{"[", 
            RowBox[{"e", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}], ")"}]}]}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{"plottableEdges", " ", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"edgesUsedInCells", ",", " ", 
         RowBox[{
          RowBox[{"edgeInRange", "[", "#", "]"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"edges", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"v", "[", 
           RowBox[{"[", 
            RowBox[{"e", "[", 
             RowBox[{"[", "#", "]"}], "]"}], "]"}], "]"}], "]"}], "&"}], "/@",
         "plottableEdges"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"cellnumberstyle", ",", "None"}], "]"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"CellNumbers", "=", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"cellnumbers", "=", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "c", "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"CVC", "=", 
          RowBox[{"CellVertexCoordinates", "[", "T", "]"}]}], ";", "  ", 
         "\[IndentingNewLine]", 
         RowBox[{"CC", "=", 
          RowBox[{"Centroid", "/@", "CVC"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"plottable", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"IntervalCheck", "[", 
             RowBox[{"#", ",", "xrange", ",", "yrange", ",", "zrange"}], 
             "]"}], "&"}], "/@", "CC"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"cellnumbers", "=", 
          RowBox[{"Pick", "[", 
           RowBox[{"cellnumbers", ",", "plottable"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"CC", "=", 
          RowBox[{"Pick", "[", 
           RowBox[{"CC", ",", "plottable"}], "]"}]}], ";", " ", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"CellNumbers", "=", 
          RowBox[{"Graphics3D", "[", 
           RowBox[{"Prepend", "[", 
            RowBox[{
             RowBox[{"MapThread", "[", 
              RowBox[{"Text", ",", 
               RowBox[{"{", 
                RowBox[{"cellnumbers", ",", "CC"}], "}"}]}], "]"}], ",", 
             "cellnumberstyle"}], "]"}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"edgenumberstyle", ",", "None"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"EdgeNumbers", "=", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"edgenumbers", "=", 
           RowBox[{"Range", "[", "ne", "]"}]}], ";"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"edgenumbers", " ", "=", " ", "edgesUsedInCells"}], ";", " ",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"edgenumbers", "=", "plottableEdges"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"EVC", "=", 
          RowBox[{"EdgeVertices", "[", "T", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"EVC", "=", 
          RowBox[{"EVC", "[", 
           RowBox[{"[", "edgenumbers", "]"}], "]"}]}], ";", " ", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         
         RowBox[{"EC", "=", 
          RowBox[{"Centroid", "/@", "EVC"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"EdgeNumbers", "=", 
          RowBox[{"Graphics3D", "[", 
           RowBox[{"Prepend", "[", 
            RowBox[{
             RowBox[{"MapThread", "[", 
              RowBox[{"Text", ",", 
               RowBox[{"{", 
                RowBox[{"edgenumbers", ",", "EC"}], "}"}]}], "]"}], ",", 
             "edgenumberstyle"}], "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Show", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"edgestyle", ",", " ", "edges"}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", "CellNumbers", ",", "\[IndentingNewLine]", 
        "EdgeNumbers"}], "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ShowTissue3D", "[", "x___", "]"}], ":=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
     "Print", "[", 
      "\"\<Expecting ShowTissue3D[Tissue, Edge-Styles, \
Cell-Number-Styles:None, Edge-Number-Styles:None\>\"", "]"}], ";", " ", 
     RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQ/W3/0cu5La8cZ+mL3ALRf9Rj74PoBTOUnoLopt3t
L0F00q1gjjwgfTJ1Ch+I7mE+YAqijR+U+PO0vnJUu3siAES33IwPBdFOznci
QXTC9dexIDruR3U8iH6zwS8dRBvsDcgD0RZpekUg+t7Ea2B6TZNyBC+Qbmr5
Hguiy2Ybp4H53kZZIDou/edSEP3Zo2sDiBapTdsGog3W9u0F0YsnJpwD0ef3
zroEot0jbjwE0QzJF56C6F8B396B6BaN6g8gepn63O8gepXWfx4+IC1xjlME
ROfFPxQF0bfWcn3/2P3KMW1DIZgGAH41mQs=
  
  "],ExpressionUUID->"627c521f-3a93-4de2-b373-a7873d03172b"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Projections", "Section",
 CellChangeTimes->{{3.492362767391283*^9, 
  3.4923627683510923`*^9}},ExpressionUUID->"938ef006-6605-4991-8cb8-\
8db0639000ae"],

Cell[CellGroupData[{

Cell["Lambert Azimuth Equal Area Projection", "Subsection",
 CellChangeTimes->{{3.492362770959318*^9, 3.492362779463111*^9}, 
   3.4923725072326393`*^9},ExpressionUUID->"e27c7728-7983-459c-84a9-\
ad27f8422c7e"],

Cell["\<\
This does a Lambert projection for the bottom half of the sphere, which \
corresponds to the center of the tissue, e.g., the center of the meristem. \
Points  which would go beyond the equator are projected onto the equator. \
\>", "Text",
 CellChangeTimes->{{3.4923631424470043`*^9, 3.49236317193519*^9}, {
  3.49237251063986*^9, 
  3.492372572071651*^9}},ExpressionUUID->"e96d336d-13d1-4715-bdc6-\
539c638ac630"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LambertPlaneToDome", "[", 
     RowBox[{"{", 
      RowBox[{"p_", ",", " ", "q_"}], "}"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z", ",", " ", "r", ",", " ", "theta"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "transform", " ", "to", " ", "a", " ", "dome", " ", "with", " ", "the",
         " ", "north", " ", "pole", " ", "at", " ", 
        RowBox[{"(", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{"-", "1"}]}], ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"r", "=", 
        RowBox[{
         RowBox[{"p", "^", "2"}], "+", 
         RowBox[{"q", "^", "2"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"r", " ", "\[LessEqual]", "2"}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"x", "=", 
           RowBox[{"p", 
            SqrtBox[
             RowBox[{"1", "-", 
              RowBox[{"(", 
               RowBox[{"r", "/", "4"}], ")"}]}]]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"y", "=", 
           RowBox[{"q", 
            SqrtBox[
             RowBox[{"1", "-", 
              RowBox[{"(", 
               RowBox[{"r", "/", "4"}], ")"}]}]]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"z", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"r", "/", "2"}], ")"}], "-", "1"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "switch", " ", "south", " ", "pole", " ", "to", " ", "north", " ", 
            "pole"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"z", "=", 
             RowBox[{"2", "-", "z", "-", "2"}]}], ";"}], " ", "*)"}], " ", 
          "\[IndentingNewLine]", 
          RowBox[{"z", "=", 
           RowBox[{"1", "-", 
            RowBox[{"r", "/", "2"}]}]}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "z"}], "}"}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Need", " ", "Code", " ", "Here", " ", "for", " ", "r"}], 
         " ", ">", 
         RowBox[{"4", "/", "3"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"theta", " ", "=", " ", 
        RowBox[{"ArcTan", "[", 
         RowBox[{"p", ",", " ", "q"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"x", "=", 
        RowBox[{"Cos", "[", "theta", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"y", "=", 
        RowBox[{"Sin", "[", "theta", "]"}]}], ";", "  ", 
       "\[IndentingNewLine]", 
       RowBox[{"z", "=", 
        RowBox[{"1", "-", 
         RowBox[{"r", "/", "2"}]}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"z", "=", 
        RowBox[{"1", "-", 
         SqrtBox[
          RowBox[{"r", "/", "2"}]]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "put", " ", "the", " ", "point", " ", "on", " ", "the", " ", "edge", 
         " ", "of", " ", "the", " ", "dome"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"z", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LambertDomeToPlane", "[", 
   RowBox[{"{", 
    RowBox[{"x_", ",", " ", "y_", ",", "z_"}], "}"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p", ",", "q", ",", " ", "r"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"r", "=", 
      RowBox[{"2", "/", 
       RowBox[{"(", 
        RowBox[{"1", "-", "z"}], ")"}]}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"p", "=", 
      SqrtBox[
       RowBox[{"r", "*", "x"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"q", "=", 
      SqrtBox[
       RowBox[{"r", "*", "y"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{"p", ",", "q"}], "}"}], "]"}], ";"}]}], " ", 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQ/eYUp6s66ytHtinfgkB0j5J5BIiu+DMzGkSfeeWd
BqInMf7IB9F/zyw9BaLX8KacAdE3LBv/g2ijWRvBdFRkd4gWkPa6NDEJRP/Z
pZsBoq08JHNB9Nev3oUgOuVmTxGI5lrz+TOIXsHj/wVE6y61+Qui2/oVmbSB
9KJLzdwgek3SHDDNyvVGBES/CLMUBdE61yOlQTRT9AZ1ED2F4605iP710dgW
RF+S/u0Eopf8rXcD0UXdb4NAdIvWvhAQfSHuzxcQHedQ9wtE82R0i3kD6QSv
ZWA687FySyCQNjk+swNEW8SoLAfRRUZGYBoA9yaGpA==
  
  "],ExpressionUUID->"c6eeec6b-bbef-42c4-aa71-3587ca32c1b3"]
}, Closed]],

Cell[CellGroupData[{

Cell["Equal Area Paraboloid Projection", "Subsection",
 CellChangeTimes->{{3.5342043355004587`*^9, 
  3.534204350980294*^9}},ExpressionUUID->"564b459d-1c5c-429d-874d-\
3025019b188d"],

Cell[TextData[{
 "Assumes that the center of the paraboloid is at the origin.  This formula \
is will give the meristem the same surface area on the projected paraboloid \
as it has on the original plane. The equation of the paraboloid is ",
 Cell[BoxData[
  FormBox[
   RowBox[{"z", "=", 
    RowBox[{
     RowBox[{"-", "a"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"]}], ")"}], ".", " "}]}]}], TraditionalForm]],
  ExpressionUUID->"c034a77b-fc33-4433-8e7d-6500c92074a9"]
}], "Text",
 CellChangeTimes->{{3.534204437612368*^9, 3.534204455516399*^9}, {
  3.534206649581276*^9, 
  3.534206713999103*^9}},ExpressionUUID->"684242c2-6ef0-453f-a82f-\
883ba2899059"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ProjectPlaneToParaboloid", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x_", ",", "y_"}], "}"}], ",", " ", 
      RowBox[{"a_:", ".01"}], ",", " ", 
      RowBox[{"h_:", "0"}], ",", 
      RowBox[{"k_:", "0"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"r", ",", " ", "rp", ",", " ", "\[Lambda]"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"r", "=", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x", "-", "h"}], ")"}], "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"y", "-", "k"}], ")"}], "^", "2"}]}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"rp", " ", "=", " ", 
        FractionBox[
         SqrtBox[
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1.0", "+", 
              RowBox[{"6", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"a", " ", "*", " ", "r"}], ")"}], "2"]}]}], ")"}], 
            "^", 
            RowBox[{"(", 
             RowBox[{"2", "/", "3"}], ")"}]}], "-", "1"}]], 
         RowBox[{"2.0", "*", "a"}]]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", "rp", "]"}], "<", "\[Infinity]"}], ",", 
         RowBox[{"\[Lambda]", "=", 
          FractionBox["rp", "r"]}], ",", 
         RowBox[{"\[Lambda]", "=", "1"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"h", "+", 
           RowBox[{"x", "*", "\[Lambda]"}]}], ",", " ", 
          RowBox[{"k", "+", 
           RowBox[{"y", "*", "\[Lambda]"}]}], ",", 
          RowBox[{
           RowBox[{"-", "a"}], "*", 
           RowBox[{"rp", "^", "2"}]}]}], "}"}], "]"}]}]}], " ", 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.534204354387414*^9, 3.5342043752655983`*^9}, {
  3.534204462153248*^9, 3.534204497843316*^9}, {3.5342045578432827`*^9, 
  3.534204729124127*^9}, {3.53420571358608*^9, 3.534205718892952*^9}, {
  3.534206197658141*^9, 3.534206198369463*^9}, {3.5491235038901873`*^9, 
  3.5491235168840322`*^9}, {3.549123560485096*^9, 3.549123611968836*^9}, {
  3.549125073829214*^9, 
  3.549125127620564*^9}},ExpressionUUID->"012b244d-868b-4564-8255-\
6f2ea191da14"]
}, Open  ]],

Cell[CellGroupData[{

Cell["ParaboloidPlot", "Subsection",
 CellChangeTimes->{{3.549122424181357*^9, 
  3.549122440693791*^9}},ExpressionUUID->"bd28ae30-7169-47dc-9f04-\
2825cbedd895"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ParaboloidPlot", "[", 
    RowBox[{
     RowBox[{"tissue_", "?", "TissueQ"}], ",", 
     RowBox[{"r_", "?", "NumberQ"}], ",", " ", 
     RowBox[{"a_", "?", "NumberQ"}], ",", " ", 
     RowBox[{"h_", "?", "NumberQ"}], ",", " ", 
     RowBox[{"k_", "?", "NumberQ"}], ",", " ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"ShowTissueOnDome", "[", 
      RowBox[{"tissue", ",", 
       RowBox[{"\"\<shape\>\"", "\[Rule]", " ", "\"\<Paraboloid\>\""}], ",", 
       " ", 
       RowBox[{"\"\<Radius\>\"", "\[Rule]", " ", "r"}], ",", " ", 
       RowBox[{"\"\<A\>\"", "\[Rule]", " ", "a"}], ",", " ", 
       RowBox[{"\"\<h\>\"", "\[Rule]", " ", "h"}], ",", " ", 
       RowBox[{"\"\<k\>\"", "\[Rule]", " ", "k"}], ",", " ", "opt"}], "]"}]}],
     " ", "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    RowBox[{"ParaboloidPlot", "[", 
     RowBox[{
      RowBox[{"tissue_", "?", "TissueQ"}], ",", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"r", ",", "a", ",", "h", ",", "k"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"r", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<Radius\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"Options", "[", "ShowTissueOnDome", "]"}]}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"a", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<A\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<A\>\"", "\[Rule]", " ", "0.01"}], "}"}]}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"h", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<h\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<h\>\"", "\[Rule]", " ", "0"}], "}"}]}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"k", "=", 
        RowBox[{
         RowBox[{"\"\<k\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<k\>\"", "\[Rule]", " ", "0"}], "}"}]}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"ShowTissueOnDome", "[", 
        RowBox[{"tissue", ",", 
         RowBox[{"\"\<shape\>\"", "\[Rule]", " ", "\"\<Paraboloid\>\""}], ",",
          " ", 
         RowBox[{"\"\<Radius\>\"", "\[Rule]", " ", "r"}], ",", " ", 
         RowBox[{"\"\<A\>\"", "\[Rule]", " ", "a"}], ",", " ", 
         RowBox[{"\"\<h\>\"", "\[Rule]", " ", "h"}], ",", " ", 
         RowBox[{"\"\<k\>\"", "\[Rule]", " ", "k"}], ",", " ", "opt"}], 
        "]"}]}]}], " ", "\[IndentingNewLine]", "]"}]}], ";"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.54912244224048*^9, 3.549122662133141*^9}, 
   3.549123170241848*^9, {3.549124654983594*^9, 3.5491246551687813`*^9}, {
   3.5491251530078506`*^9, 3.5491252556869097`*^9}, {3.5491256903184013`*^9, 
   3.549125745837425*^9}, {3.549127957253067*^9, 3.5491279636085033`*^9}, {
   3.549129487595396*^9, 3.549129533783942*^9}, {3.549129587424674*^9, 
   3.549129587889165*^9}, {3.54912965034378*^9, 
   3.54912968178376*^9}},ExpressionUUID->"e4ed3dd4-8b3f-4c7d-947e-\
c22a98157b14"]
}, Closed]],

Cell[CellGroupData[{

Cell["ShowTissueOnDome", "Subsection",
 CellChangeTimes->{{3.492366202868638*^9, 
  3.492366205484494*^9}},ExpressionUUID->"e748bae3-63f5-4d87-84c4-\
fdfee0d1b12f"],

Cell["\<\
Added \[OpenCurlyDoubleQuote]Boundary\[CloseCurlyDoubleQuote] -> False \
(default), True, or Direcive[{...}] for outer edge. True is equivalent to \
Directive[{Thick,Black}]\
\>", "Text",
 CellChangeTimes->{{3.558872934207405*^9, 
  3.558872979094926*^9}},ExpressionUUID->"c221b7fa-7d30-4f59-839e-\
3b20b375a987"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ShowTissueOnDome", "[", 
    RowBox[{"tissue_Tissue", ",", " ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "v", ",", "n", ",", "vdome", ",", " ", "c", ",", " ", "cc", ",", 
       "scalefactor", ",", "r", ",", "colors", ",", "cg", ",", "edges", ",", 
       "cells", ",", "ToDome", ",", " ", "ToParaboloid", ",", " ", "cdome", 
       ",", " ", "edome", ",", " ", "e", ",", " ", "eg", ",", " ", "radius", 
       ",", " ", "a", ",", "h", ",", "k", ",", " ", "shape", ",", " ", 
       "eused", ",", "smax", ",", "EdgeCellLine", ",", "edgecellpairs", ",", 
       " ", "centroids", ",", " ", "u", ",", " ", "xmax", ",", " ", "zmax", 
       ",", " ", "plotrange", ",", " ", "gedges", ",", " ", "scale", ",", " ",
        "origin", ",", "x0", ",", "y0", ",", " ", "boundary", ",", " ", 
       "circle", ",", " ", 
       RowBox[{"shapes", "=", 
        RowBox[{"{", 
         RowBox[{"\"\<Paraboloid\>\"", ",", "\"\<Hemisphere\>\""}], "}"}]}]}],
       "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"e", "=", 
       RowBox[{"TissueEdges", "[", "tissue", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"TissueCells", "[", "tissue", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "c", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"centroids", " ", "=", " ", 
       RowBox[{"Centroid", "[", "tissue", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"origin", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<Origin\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Origin\>\"", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"scale", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<ScaleMultiple\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<ScaleMultiple\>\"", "\[Rule]", " ", "1.1"}], "}"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x0", ",", "y0"}], "}"}], "=", "origin"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"boundary", "=", 
       RowBox[{
        RowBox[{"\"\<Boundary\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Boundary\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], 
      ";", " ", "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<None\>\"", ",", " ", "None", ",", " ", "\"\<False\>\""}], 
           "}"}], ",", " ", "boundary"}], "]"}], ",", " ", 
        RowBox[{"boundary", "=", "False"}], ",", "\[IndentingNewLine]", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<Automatic\>\"", ",", " ", "Automatic", ",", " ", "True", ",", 
            " ", "\"\<True\>\""}], "}"}], ",", " ", "boundary"}], "]"}], ",", 
        " ", 
        RowBox[{"boundary", "=", 
         RowBox[{"Directive", "[", 
          RowBox[{"Thick", ",", " ", "Black"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ListQ", "[", "boundary", "]"}], ",", " ", 
        RowBox[{"boundary", "=", 
         RowBox[{"Directive", "@@", "boundary"}]}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{"TissueVertices", "[", "tissue", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"cc", "=", 
       RowBox[{"Centroid", "[", 
        RowBox[{"v", "[", 
         RowBox[{"[", 
          RowBox[{"VerticesOnBoundary", "[", "tissue", "]"}], "]"}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"radius", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<Radius\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"Options", "[", "ShowTissueOnDome", "]"}]}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"a", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<A\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<A\>\"", "\[Rule]", " ", "0.01"}], "}"}]}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"h", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<h\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<h\>\"", "\[Rule]", " ", "0"}], "}"}]}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"k", "=", 
       RowBox[{
        RowBox[{"\"\<k\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<k\>\"", "\[Rule]", " ", "0"}], "}"}]}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"shape", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<shape\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<shape\>\"", "\[Rule]", " ", "\"\<Paraboloid\>\""}], 
         "}"}]}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"cells", "=", 
       RowBox[{"CellVertexCoordinates", "[", "tissue", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"plotrange", "=", "Automatic"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"Switch", "[", 
       RowBox[{
       "shape", ",", "\[IndentingNewLine]", "\"\<Paraboloid\>\"", ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"ToParaboloid", "[", 
           RowBox[{"{", 
            RowBox[{"x_", ",", "y_"}], "}"}], "]"}], ":=", " ", 
          RowBox[{"ProjectPlaneToParaboloid", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "y"}], "}"}], ",", "a", ",", "h", ",", "k"}], 
           "]"}]}], ";", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ToParaboloid", "[", "listOfPairs_", "]"}], ":=", " ", 
          RowBox[{"ToParaboloid", "/@", "listOfPairs"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"cdome", "=", 
          RowBox[{"ToParaboloid", "/@", "cells"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"vdome", " ", "=", " ", 
          RowBox[{"ToParaboloid", "/@", "v"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"smax", "[", "u_", "]"}], ":=", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"a", " ", "*", " ", "u", " ", "*", " ", 
              RowBox[{"Sqrt", "[", 
               RowBox[{"1", "+", 
                RowBox[{"4", " ", 
                 RowBox[{"a", "^", "2"}], " ", 
                 RowBox[{"u", "^", "2"}]}]}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"1", "/", "2"}], " ", 
              RowBox[{"ArcSinh", "[", 
               RowBox[{"2", " ", "*", " ", "a", " ", "*", " ", "u"}], 
               "]"}]}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", "*", " ", "a"}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"xmax", " ", "=", 
          RowBox[{"u", "/.", " ", 
           RowBox[{"FindRoot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"smax", "[", "u", "]"}], "-", "radius"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"u", ",", "radius"}], "}"}], ",", " ", 
             RowBox[{"AccuracyGoal", "\[Rule]", " ", "4"}], ",", " ", 
             RowBox[{"PrecisionGoal", "\[Rule]", " ", "4"}]}], "]"}]}]}], ";",
          " ", "\[IndentingNewLine]", 
         RowBox[{"zmax", " ", "=", " ", 
          RowBox[{"a", "*", "xmax", "*", "xmax"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"plotrange", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x0", "-", 
               RowBox[{"scale", "*", "xmax"}]}], ",", 
              RowBox[{"x0", "+", 
               RowBox[{"scale", "*", "xmax"}]}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"y0", "-", 
               RowBox[{"scale", "*", "xmax"}]}], ",", " ", 
              RowBox[{"y0", "+", 
               RowBox[{"scale", "*", "xmax"}]}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "zmax"}], ",", " ", "0"}], "}"}]}], "}"}]}], ";"}],
         " ", "\[IndentingNewLine]", ",", " ", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\"\<Hemisphere\>\"", ",", " ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"v", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "-", "cc"}], ")"}], "&"}], "/@", "v"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"radius", ">", "0"}], ",", "\[IndentingNewLine]", 
           RowBox[{"scalefactor", "=", "radius"}], ",", "\[IndentingNewLine]", 
           RowBox[{"scalefactor", " ", "=", " ", 
            RowBox[{"Max", "[", 
             RowBox[{"Norm", "/@", "v"}], "]"}]}]}], "\[IndentingNewLine]", 
          "]"}], ";", "  ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"scalefactor", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", 
             RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}], "*", "scalefactor"}]}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"v", "=", 
          RowBox[{"v", "/", 
           RowBox[{"(", "scalefactor", ")"}]}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"vdome", " ", "=", " ", 
          RowBox[{"scalefactor", "*", 
           RowBox[{"LambertPlaneToDome", "/@", "v"}]}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ToDome", "[", 
           RowBox[{"{", 
            RowBox[{"x_", ",", "y_"}], "}"}], "]"}], ":=", 
          RowBox[{"scalefactor", "*", 
           RowBox[{"LambertPlaneToDome", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", "y"}], "}"}], "-", "cc"}], ")"}], "/", 
             "scalefactor"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ToDome", "[", "listOfPairs_", "]"}], ":=", 
          RowBox[{"ToDome", "/@", "listOfPairs"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"cdome", "=", 
          RowBox[{"ToDome", "/@", "cells"}]}], ";"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "_", ",", " ", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Unknown Shape: \>\"", ",", " ", "shape", ",", " ", 
           "\"\< - allowed shapes are \>\"", ",", " ", "shapes"}], "]"}], ";",
          " ", 
         RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"colors", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<CellStyle\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<CellStyle\>\"", "\[Rule]", " ", "\"\<Automatic\>\""}], 
         "}"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ListQ", "[", "colors", "]"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"colors", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"{", "colors", "}"}], "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "colors", "]"}], "\[Equal]", "1"}], ",", 
           " ", 
           RowBox[{"colors", "=", 
            RowBox[{"PadRight", "[", 
             RowBox[{"colors", ",", " ", "n", ",", " ", 
              RowBox[{"First", "[", "colors", "]"}]}], "]"}]}]}], "]"}], ";", 
         " ", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "colors", "]"}], "<", "n"}], ",", "  ", 
           RowBox[{"colors", "=", 
            RowBox[{"PadRight", "[", 
             RowBox[{"colors", ",", " ", "n", ",", " ", "White"}], "]"}]}]}], 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "colors", "]"}], ">", "n"}], ",", " ", 
           RowBox[{"colors", " ", "=", " ", 
            RowBox[{"Take", "[", 
             RowBox[{"colors", ",", " ", "n"}], "]"}]}]}], "]"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"cg", "=", 
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Graphics3D", "[", 
              RowBox[{"{", 
               RowBox[{"#1", ",", 
                RowBox[{"Polygon", "[", "#2", "]"}]}], "}"}], "]"}], "&"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"colors", ",", "cdome"}], "}"}]}], "]"}]}], ";"}], 
        "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        RowBox[{"colors", " ", "\[Equal]", " ", "\"\<Colorful\>\""}], 
        "\[IndentingNewLine]", ",", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"r", ":=", 
          RowBox[{"RandomReal", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", ".7"}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"colors", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Hue", "[", "r", "]"}], ",", 
            RowBox[{"{", "n", "}"}]}], "]"}]}], " ", ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"cg", "=", 
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Graphics3D", "[", 
              RowBox[{"{", 
               RowBox[{"#1", ",", 
                RowBox[{"Polygon", "[", "#2", "]"}]}], "}"}], "]"}], "&"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"colors", ",", "cdome"}], "}"}]}], "]"}]}], ";"}], 
        "\[IndentingNewLine]", ",", " ", "\[IndentingNewLine]", 
        RowBox[{"colors", "==", " ", "\"\<Automatic\>\""}], 
        "\[IndentingNewLine]", ",", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"cg", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Graphics3D", "[", 
             RowBox[{"Polygon", "[", "#", "]"}], "]"}], "&"}], "/@", 
           "cdome"}]}], ";"}]}], " ", "\[IndentingNewLine]", "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"cg", " ", "=", " ", 
       RowBox[{"Show", "[", "cg", "]"}]}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"eused", "=", 
       RowBox[{"EdgesUsed", "[", "tissue", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "eused", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"colors", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<EdgeStyle\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"Options", "[", "ShowTissueOnDome", "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"colors", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", "colors", "}"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "colors", "]"}], "\[Equal]", "1"}], ",", " ", 
        
        RowBox[{"colors", "=", 
         RowBox[{"PadRight", "[", 
          RowBox[{"colors", ",", " ", "n", ",", " ", 
           RowBox[{"First", "[", "colors", "]"}]}], "]"}]}]}], "]"}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "colors", "]"}], "<", "n"}], ",", "  ", 
        RowBox[{"colors", "=", 
         RowBox[{"PadRight", "[", 
          RowBox[{"colors", ",", " ", "n", ",", " ", "Black"}], "]"}]}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "colors", "]"}], ">", "n"}], ",", " ", 
        RowBox[{"colors", " ", "=", " ", 
         RowBox[{"Take", "[", 
          RowBox[{"colors", ",", " ", "n"}], "]"}]}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"edome", " ", "=", " ", 
       RowBox[{"Line", "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"vdome", "[", 
            RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{"e", "[", 
            RowBox[{"[", "eused", "]"}], "]"}], ")"}]}], ")"}]}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"eg", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Graphics3D", "[", 
             RowBox[{"{", 
              RowBox[{"#1", ",", "#2"}], "}"}], "]"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"colors", ",", "edome"}], "}"}]}], "]"}]}], ";"}], "*)"}],
       "\[IndentingNewLine]", 
      RowBox[{"eg", "=", " ", 
       RowBox[{"Show", "[", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"colors", ",", "edome"}], "}"}], "]"}], "]"}], "]"}]}], 
      ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"edgecellpairs", "=", 
       RowBox[{
        RowBox[{"\"\<EdgeCellPairs\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<EdgeCellPairs\>\"", "\[Rule]", " ", 
          RowBox[{"{", "}"}]}], "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "edgecellpairs", "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"edgecellpairs", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"edgecellpairs", ",", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"eused", ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"EdgeCellLine", "[", 
        RowBox[{"cell_", ",", " ", "edge_", ",", " ", "style_", ",", " ", 
         RowBox[{"offset_:", "0.02"}]}], "]"}], ":=", " ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "v1", ",", "v2", ",", " ", "p1", ",", " ", "p2", ",", "p1z", ",", 
           "p2z", ",", "cen"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"vertex", " ", "numbers"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"v1", ",", "v2"}], "}"}], "=", 
           RowBox[{"e", "[", 
            RowBox[{"[", "edge", "]"}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"vertex", " ", "coordinates"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"p1", "=", 
           RowBox[{"v", "[", 
            RowBox[{"[", "v1", "]"}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"p2", "=", 
           RowBox[{"v", "[", 
            RowBox[{"[", "v2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"cen", " ", "=", " ", 
           RowBox[{"centroids", "[", 
            RowBox[{"[", "cell", "]"}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"p1", " ", "=", "   ", 
           RowBox[{"p1", " ", "+", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"cen", "-", "p1"}], ")"}], "*", "offset"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"p1z", " ", "=", " ", 
           RowBox[{"ProjectPlaneToParaboloid", "[", 
            RowBox[{"p1", ",", "a", ",", "h", ",", "k"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"p2", " ", "=", " ", 
           RowBox[{"p2", " ", "+", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"cen", "-", "p2"}], ")"}], "*", "offset"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"p2z", " ", "=", " ", 
           RowBox[{"ProjectPlaneToParaboloid", "[", 
            RowBox[{"p2", ",", "a", ",", "h", ",", "k"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"Graphics3D", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Directive", "[", "style", "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Line", "[", 
              RowBox[{"{", " ", 
               RowBox[{"p1z", " ", ",", "p2z"}], "}"}], "]"}]}], "}"}], 
           "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "edgecellpairs", "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"gedges", " ", "=", " ", 
          RowBox[{"Show", "[", 
           RowBox[{"MapThread", "[", 
            RowBox[{"EdgeCellLine", ",", 
             RowBox[{"Transpose", "[", "edgecellpairs", "]"}]}], "]"}], 
           "]"}]}], ";"}], "\[IndentingNewLine]", ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"gedges", "=", 
          RowBox[{"Graphics3D", "[", 
           RowBox[{"{", "}"}], "]"}]}], ";"}]}], " ", "\[IndentingNewLine]", 
       "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"boundary", ",", "False"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"circle", "=", 
          RowBox[{"Graphics3D", "[", 
           RowBox[{"{", "}"}], "]"}]}], ";"}], ",", " ", 
        "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"circle", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"xmax", "*", "scale", "*", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Cos", "[", "#", "]"}], ",", 
                RowBox[{"Sin", "[", "#", "]"}]}], "}"}]}], ")"}], "&"}], "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"0", ",", 
             RowBox[{"2", " ", "Pi"}], ",", 
             RowBox[{"2", " ", 
              RowBox[{"Pi", "/", "100."}]}]}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"circle", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"ProjectPlaneToParaboloid", "[", 
             RowBox[{"#", ",", "a", ",", "h", ",", "h"}], "]"}], "&"}], "/@", 
           "circle"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"circle", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}], "/@", 
           "circle"}]}], ";", " ", "\[IndentingNewLine]", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"circle", " ", "=", " ", 
          RowBox[{"Graphics3D", "[", 
           RowBox[{"{", 
            RowBox[{"boundary", ",", " ", 
             RowBox[{"Line", "[", "circle", "]"}]}], "}"}], "]"}]}], ";"}]}], 
       " ", "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"gopt", "=", 
             RowBox[{"MyFilterOptions", "[", 
              RowBox[{"Graphics3D", ",", "opt"}], "]"}]}], "}"}], ",", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"Show", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"circle", ",", " ", "cg", ",", "eg", ",", "gedges"}], 
              "}"}], ",", "   ", "gopt"}], "]"}]}], "]"}], "]"}], ";"}], " ", 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"gopt", "=", 
          RowBox[{"MyFilterOptions", "[", 
           RowBox[{"Graphics3D", ",", "opt"}], "]"}]}], "}"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"{", " ", 
            RowBox[{"circle", ",", " ", "cg", ",", "eg", ",", " ", "gedges"}],
             "}"}], ",", " ", "gopt", ",", " ", 
           RowBox[{"PlotRange", "\[Rule]", " ", "plotrange"}]}], "]"}], 
         "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.492366219715727*^9, 3.492366253407607*^9}, {
   3.492366288471829*^9, 3.492366326265215*^9}, {3.492366386689178*^9, 
   3.4923663940341797`*^9}, {3.492366428321629*^9, 3.49236643594587*^9}, 
   3.492366495522807*^9, {3.4923665619764423`*^9, 3.49236664684196*^9}, {
   3.492366805913416*^9, 3.492366877196224*^9}, {3.492366912436289*^9, 
   3.492367145890201*^9}, 3.492367184156568*^9, {3.4923672300736437`*^9, 
   3.492367569535281*^9}, 3.492367614908277*^9, {3.492367664406877*^9, 
   3.492367746279867*^9}, {3.4923677830539627`*^9, 3.492367866049809*^9}, {
   3.492368758124567*^9, 3.492368778237566*^9}, {3.492369351172068*^9, 
   3.492369452160055*^9}, {3.492369503624131*^9, 3.49236951211936*^9}, {
   3.492369582404917*^9, 3.492369583732066*^9}, 3.4923697984157124`*^9, {
   3.492369877536524*^9, 3.492369878671081*^9}, {3.492370548661484*^9, 
   3.492370549716316*^9}, {3.492372728616625*^9, 3.492372831422306*^9}, {
   3.492436108565414*^9, 3.49243612533891*^9}, {3.4924714436429777`*^9, 
   3.492471458721133*^9}, {3.492476290393166*^9, 3.492476290751925*^9}, {
   3.534204153451375*^9, 3.5342041846778812`*^9}, 3.534204246710393*^9, {
   3.534204761777484*^9, 3.534205143612306*^9}, {3.5342052268005447`*^9, 
   3.534205270177188*^9}, {3.534205360743023*^9, 3.534205370997229*^9}, {
   3.534205491477827*^9, 3.534205560174685*^9}, {3.534205615857534*^9, 
   3.534205642399921*^9}, 3.534205680689966*^9, {3.534205767496467*^9, 
   3.534205887881825*^9}, {3.534206029726913*^9, 3.5342060338976994`*^9}, {
   3.534206261560565*^9, 3.5342062618478003`*^9}, {3.534206471832158*^9, 
   3.534206473446279*^9}, {3.549123733944969*^9, 3.549123744972725*^9}, {
   3.549123928763945*^9, 3.5491239905981083`*^9}, {3.549124034233739*^9, 
   3.549124043532518*^9}, {3.549124428512895*^9, 3.549124584629764*^9}, {
   3.5491247536762867`*^9, 3.549124770725256*^9}, {3.549125293061517*^9, 
   3.549125319985585*^9}, {3.5491253612343397`*^9, 3.549125361934451*^9}, 
   3.549125439852241*^9, {3.549127419734576*^9, 3.5491274967646523`*^9}, {
   3.5491276025757008`*^9, 3.549127757558063*^9}, {3.549127804350109*^9, 
   3.549127835002384*^9}, {3.549127877373567*^9, 3.549127881178671*^9}, {
   3.549127918089018*^9, 3.549127918486823*^9}, {3.549130224129342*^9, 
   3.549130262097872*^9}, {3.549130395247299*^9, 3.54913048384918*^9}, {
   3.549130606256792*^9, 3.549130610653261*^9}, {3.549130662914001*^9, 
   3.5491306684300632`*^9}, {3.549130730709496*^9, 3.5491307646529303`*^9}, {
   3.549130831274639*^9, 3.549130843177083*^9}, {3.549130876741097*^9, 
   3.5491311491543407`*^9}, {3.549131774544457*^9, 3.549131810989167*^9}, {
   3.549131930252118*^9, 3.549131951968566*^9}, {3.549132205130046*^9, 
   3.549132254333156*^9}, {3.5491325074233847`*^9, 3.5491326385237427`*^9}, {
   3.5491326697214003`*^9, 3.549132727439706*^9}, {3.549132767668171*^9, 
   3.549132773135972*^9}, {3.549132841989669*^9, 3.549132893914063*^9}, {
   3.549133085579768*^9, 3.549133207027501*^9}, {3.54913324011474*^9, 
   3.549133288362516*^9}, {3.5491333567204227`*^9, 3.549133378643671*^9}, {
   3.549133423876027*^9, 3.549133464613497*^9}, {3.549133513408545*^9, 
   3.549133523749612*^9}, {3.549133623348452*^9, 3.5491336506559*^9}, {
   3.549133927721942*^9, 3.549133990532387*^9}, {3.549134158079055*^9, 
   3.549134161134708*^9}, 3.5491344328748198`*^9, {3.549134667569921*^9, 
   3.549134668771905*^9}, {3.5491347068666697`*^9, 3.549134751133975*^9}, {
   3.549137979302381*^9, 3.549138024810711*^9}, {3.5491381271198883`*^9, 
   3.5491382105315847`*^9}, {3.54914051441133*^9, 3.549140556269162*^9}, {
   3.5491406474322577`*^9, 3.549140717498279*^9}, {3.549140777336431*^9, 
   3.549140972957611*^9}, {3.549141007906363*^9, 3.549141010672985*^9}, {
   3.549141077666215*^9, 3.5491411245628347`*^9}, {3.549141154782721*^9, 
   3.549141170758925*^9}, {3.54914124835353*^9, 3.5491412926512136`*^9}, 
   3.549141343602441*^9, {3.5491415086058292`*^9, 3.5491415183483*^9}, 
   3.549141571289195*^9, {3.558871307143087*^9, 3.558871388584412*^9}, {
   3.55887163898577*^9, 3.558871671952283*^9}, {3.558871709587006*^9, 
   3.558871735861628*^9}, {3.558871793253051*^9, 3.558872020760477*^9}, {
   3.558872065015979*^9, 3.5588723296066017`*^9}, {3.558872384802484*^9, 
   3.558872395217636*^9}, {3.558872425710387*^9, 3.558872426592443*^9}, {
   3.558872602062368*^9, 3.558872604472682*^9}, {3.558872652797469*^9, 
   3.558872861209063*^9}, {3.558872895388578*^9, 
   3.558872909572998*^9}},ExpressionUUID->"c93ba093-46ef-49b5-81da-\
811d16a36e94"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Tissues", "Section",
 CellChangeTimes->{{3.448464233986095*^9, 
  3.448464239785555*^9}},ExpressionUUID->"50ce2120-c178-4ae4-9bb3-\
455b74ca1bfd"],

Cell[CellGroupData[{

Cell["TissueQ", "Subsection",
 CellChangeTimes->{{3.448469570273582*^9, 3.448469581953371*^9}, {
  3.448469648361903*^9, 
  3.448469650833847*^9}},ExpressionUUID->"d09f2eed-871b-41d1-b50d-\
3c0e39ca3dff"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TissueQ", "[", "object_", "]"}], ":=", 
    RowBox[{"TissueCheck", "[", 
     RowBox[{"object", ",", " ", 
      RowBox[{"\"\<Quiet\>\"", "\[Rule]", " ", "True"}]}], "]"}]}], ";"}], 
  " "}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.448464247984179*^9, 3.448464472866875*^9}, 
   3.448464717142807*^9, {3.448464774775979*^9, 3.448464892393885*^9}, {
   3.448464926469419*^9, 3.448465129399933*^9}, {3.44846517778672*^9, 
   3.44846522695318*^9}, 3.448465261703339*^9, 3.448469600649832*^9, {
   3.448469640516409*^9, 3.448469644605044*^9}, {3.448469685644079*^9, 
   3.448469701103547*^9}, {3.448469943539042*^9, 
   3.448469986723967*^9}},ExpressionUUID->"777e830a-2e92-43dc-b40d-\
b29a70ddad90"]
}, Closed]],

Cell[CellGroupData[{

Cell["TissueOrTorusQ", "Subsection",
 CellChangeTimes->{{3.459266817399591*^9, 
  3.459266821465211*^9}},ExpressionUUID->"3bb17198-c705-4b5b-b9ff-\
e56d1cec992a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TissueOrTorusQ", "[", "object_", "]"}], ":=", " ", 
  RowBox[{"Or", "[", 
   RowBox[{
    RowBox[{"TissueQ", "[", "object", "]"}], ",", " ", 
    RowBox[{"TorusQ", "[", "object", "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.459266822599555*^9, 
  3.459266841270133*^9}},ExpressionUUID->"0cf67fe9-120c-4ae5-bcc5-\
ed6903ccb5e0"]
}, Closed]],

Cell[CellGroupData[{

Cell["TisueCells, TissueVertices, TissueEdges, N(same ...)", "Subsection",
 CellChangeTimes->{{3.448474446974329*^9, 3.448474463016664*^9}, {
  3.448474813465642*^9, 
  3.448474825320377*^9}},ExpressionUUID->"bc13dc1a-2469-4bed-be5a-\
f3babac73080"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TissueCells", "[", 
     RowBox[{"tissue_", "?", "TissueQ"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"argument", "[", "tissue", "]"}], "[", 
     RowBox[{"[", "3", "]"}], "]"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TissueCells", "[", 
     RowBox[{"torus_", "?", "TorusQ"}], "]"}], ":=", " ", 
    RowBox[{"TissueCells", "[", 
     RowBox[{"TorusTissue", "[", "torus", "]"}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TissueCells", "[", 
     RowBox[{"tissue_", "?", "DTissueQ"}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"argument", "[", "tissue", "]"}], "[", 
     RowBox[{"[", "3", "]"}], "]"}]}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TissueVertices", "[", 
     RowBox[{"tissue_", "?", "TissueQ"}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"argument", "[", "tissue", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TissueVertices", "[", 
     RowBox[{"torus_", "?", "TorusQ"}], "]"}], ":=", " ", 
    RowBox[{"TissueVertices", "[", 
     RowBox[{"TorusTissue", "[", "torus", "]"}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TissueVertices", "[", 
     RowBox[{"tissue_", "?", "DTissueQ"}], "]"}], ":=", " ", 
    RowBox[{"TissueVertices", "[", 
     RowBox[{"DTissue2Tissue", "[", "tissue", "]"}], "]"}]}], ";"}], " ", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TissueEdges", "[", 
     RowBox[{"tissue_", "?", "TissueQ"}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"argument", "[", "tissue", "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TissueEdges", "[", 
     RowBox[{"torus_", "?", "TorusQ"}], "]"}], ":=", " ", 
    RowBox[{"TissueEdges", "[", 
     RowBox[{"TorusTissue", "[", "torus", "]"}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TissueEdges", "[", 
     RowBox[{"tissue_", "?", "DTissueQ"}], "]"}], ":=", " ", 
    RowBox[{"TissueEdges", "[", 
     RowBox[{"DTissue2Tissue", "[", "tissue", "]"}], "]"}]}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NTissueCells", "[", 
     RowBox[{"tissue_", "?", "TissueQ"}], "]"}], ":=", " ", 
    RowBox[{"Length", "[", 
     RowBox[{"TissueCells", "[", "tissue", "]"}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NTissueCells", "[", 
     RowBox[{"torus_", "?", "TorusQ"}], "]"}], ":=", " ", 
    RowBox[{"NTissueCells", "[", 
     RowBox[{"TorusTissue", "[", "torus", "]"}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NTissueCells", "[", 
     RowBox[{"tissue_", "?", "DTissueQ"}], "]"}], ":=", " ", 
    RowBox[{"NTissueCells", "[", 
     RowBox[{"DTissue2Tissue", "[", "tissue", "]"}], "]"}]}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NTissueVertices", "[", 
    RowBox[{"tissue_", "?", "TissueQ"}], "]"}], ":=", " ", 
   RowBox[{"Length", "[", 
    RowBox[{"TissueVertices", "[", "tissue", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NTissueVertices", "[", 
     RowBox[{"torus_", "?", "TorusQ"}], "]"}], ":=", " ", 
    RowBox[{"NTissueVertices", "[", 
     RowBox[{"TorusTissue", "[", "torus", "]"}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NTissueVertices", "[", 
     RowBox[{"tissue_", "?", "DTissueQ"}], "]"}], ":=", " ", 
    RowBox[{"NTissueVertices", "[", 
     RowBox[{"DTissue2Tissue", "[", "tissue", "]"}], "]"}]}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NTissueEdges", "[", 
     RowBox[{"tissue_", "?", "TissueQ"}], "]"}], ":=", " ", 
    RowBox[{"Length", "[", 
     RowBox[{"TissueEdges", "[", "tissue", "]"}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NTissueEdges", "[", 
     RowBox[{"torus_", "?", "TorusQ"}], "]"}], ":=", " ", 
    RowBox[{"NTissueEdges", "[", 
     RowBox[{"TorusTissue", "[", "torus", "]"}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NTissueEdges", "[", 
     RowBox[{"tissue_", "?", "DTissueQ"}], "]"}], ":=", " ", 
    RowBox[{"NTissueEdges", "[", 
     RowBox[{"DTissue2Tissue", "[", "tissue", "]"}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.448474430759716*^9, 3.448474478428188*^9}, {
   3.448474521044261*^9, 3.448474541473218*^9}, {3.448474610312247*^9, 
   3.448474714398217*^9}, 3.448474802345872*^9, {3.459270421687213*^9, 
   3.459270551133546*^9}, {3.5460834870861797`*^9, 3.546083627611273*^9}, {
   3.546083682941318*^9, 
   3.546083688759967*^9}},ExpressionUUID->"3458ef91-29fe-4bb3-ae68-\
06afbffe5de9"]
}, Closed]],

Cell[CellGroupData[{

Cell["AdjacentVertices, AdjacentBoundaryVertices", "Subsection",
 CellChangeTimes->{{3.49493129798098*^9, 3.4949313003248158`*^9}, {
  3.494931729900612*^9, 
  3.4949317361234303`*^9}},ExpressionUUID->"98e83a10-2c5a-41ac-8d0e-\
4d93bfc36707"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AdjacentVertices", "[", 
    RowBox[{"g_Tissue", ",", 
     RowBox[{"i_", "?", "IntegerQ"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"e", ",", "vb"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"e", "=", 
       RowBox[{"TissueEdges", "[", "g", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Complement", "[", 
       RowBox[{
        RowBox[{"Union", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Select", "[", 
           RowBox[{"e", ",", " ", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{"#", ",", "i"}], "]"}], "&"}]}], "]"}], "]"}], "]"}], 
        ",", 
        RowBox[{"{", "i", "}"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AdjacentVertices", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", "\"\<Expecting AdjacentVertices[Tisue, integer]\>\"", 
       "]"}], ";", " ", 
      RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.494931302497219*^9, 3.494931372018004*^9}, {
  3.494931405186842*^9, 3.4949314321381283`*^9}, {3.494931670934866*^9, 
  3.494931672118711*^9}},ExpressionUUID->"a4064c76-3fe4-4616-9475-\
c4dd4e68bd96"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AdjacentBoundaryVertices", "[", 
    RowBox[{"g_Tissue", ",", 
     RowBox[{"i_", "?", "IntegerQ"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"e", ",", "vb", ",", "adj", ",", " ", "bv"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"e", "=", 
       RowBox[{"TissueEdges", "[", "g", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"bv", " ", "=", 
       RowBox[{"VerticesOnBoundary", "[", "g", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"adj", "=", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"Union", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Select", "[", 
            RowBox[{"e", ",", " ", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{"#", ",", "i"}], "]"}], "&"}]}], "]"}], "]"}], "]"}], 
         ",", 
         RowBox[{"{", "i", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Intersection", "[", 
       RowBox[{"adj", ",", "bv"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AdjacentBoundaryVertices", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Expecting AdjacentBoundaryVertices[Tisue, integer]\>\"", "]"}], 
      ";", " ", 
      RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.494931635827376*^9, 
  3.494931709945725*^9}},ExpressionUUID->"5b116982-84b5-492e-97ab-\
d34eade8e503"]
}, Closed]],

Cell[CellGroupData[{

Cell["CellOutwardVector, OutwardVector", "Subsection",
 CellChangeTimes->{{3.561478018735627*^9, 3.5614780234560747`*^9}, {
  3.56147907649603*^9, 3.561479078455756*^9}, {3.577982695718175*^9, 
  3.577982698803652*^9}},ExpressionUUID->"9bd2f52c-1c68-4b65-befd-\
b73a97279f92"],

Cell["\<\
Outward Normal is really a unit vector from the centroid to the vertex. \
\>", "Text",
 CellChangeTimes->{{3.5614790576154613`*^9, 
  3.56147907153621*^9}},ExpressionUUID->"9bd0912a-7590-4508-9126-\
2417d2dc16fa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CellOutwardVector", "[", 
   RowBox[{"T_Tissue", ",", " ", 
    RowBox[{"cell_", "?", "IntegerQ"}], ",", " ", 
    RowBox[{"vertex_", "?", "IntegerQ"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"cvn", ",", " ", "c", ",", " ", "v", ",", " ", "vec"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"c", "=", 
      RowBox[{"Centroid", "[", 
       RowBox[{"T", ",", " ", "cell"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"cvn", " ", "=", " ", 
      RowBox[{"CellVertexNumbers", "[", 
       RowBox[{"T", ",", " ", "cell"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"AbortIf", "[", 
      RowBox[{
       RowBox[{"Not", "[", 
        RowBox[{"MemberQ", "[", 
         RowBox[{"cvn", ",", "vertex"}], "]"}], "]"}], ",", " ", 
       RowBox[{"\"\<CellOutwardVector: Vertex \>\"", "<>", 
        RowBox[{"ToString", "[", "vertex", "]"}], "<>", 
        "\"\< is not part of Cell \>\"", "<>", 
        RowBox[{"ToString", "[", "cell", "]"}]}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"v", "=", 
      RowBox[{
       RowBox[{"TissueVertices", "[", "T", "]"}], "[", 
       RowBox[{"[", "vertex", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"vec", " ", "=", " ", 
      RowBox[{"Normalize", "[", 
       RowBox[{"v", "-", "c"}], "]"}]}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.561478030314782*^9, 3.561478106440014*^9}, {
  3.561478149138212*^9, 3.5614783011579533`*^9}, {3.5614791128792048`*^9, 
  3.561479118318931*^9}},ExpressionUUID->"bc842eef-7285-4268-a5e5-\
2d3426974163"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"OutwardVector", "[", 
    RowBox[{"xyall_", ",", " ", "xy_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c", ",", "vec"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "=", 
       RowBox[{"Centroid", "[", "xyall", "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"Return", "[", 
       RowBox[{"Normalize", "[", 
        RowBox[{"xy", "-", "c"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.577978339993059*^9, 
  3.577978449298892*^9}},ExpressionUUID->"b0c610e3-8a0a-4032-b2f6-\
02e413a3e4ff"]
}, Closed]],

Cell[CellGroupData[{

Cell["VertexOutwardVector", "Subsection",
 CellChangeTimes->{{3.494931813532659*^9, 3.49493181566866*^9}, {
   3.4949320895049047`*^9, 3.494932090280875*^9}, 
   3.561480457465119*^9},ExpressionUUID->"03e2d32d-d8a2-454f-92b6-\
a08c016fa02f"],

Cell["\<\
Change to be based on CellOutwardVectors rather than looking at edges\
\>", "Text",
 CellChangeTimes->{{3.561479041528686*^9, 3.561479053776052*^9}, 
   3.561479123948698*^9},ExpressionUUID->"4ba4ded4-2034-4a6c-8d17-\
1b7aa3479f10"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"VertexOutwardVector", "[", 
     RowBox[{"tis_Tissue", ",", " ", "i_", ",", " ", 
      RowBox[{"mean_:", "False"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "bv", ",", "abv", ",", "v", ",", "P", ",", "edges", ",", "nvs", ",", 
        "center", ",", "vc", ",", "cvn", ",", "whichcells"}], "}"}], ",", 
      RowBox[{
       RowBox[{"bv", "=", 
        RowBox[{"VerticesOnBoundary", "[", "tis", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"MemberQ", "[", 
           RowBox[{"bv", ",", "i"}], "]"}]}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"cvn", "=", 
        RowBox[{"CellVertexNumbers", "[", "tis", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"whichcells", "=", 
        RowBox[{"First", "/@", 
         RowBox[{"Position", "[", 
          RowBox[{"cvn", ",", "i"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"v", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"CellOutwardVector", "[", 
           RowBox[{"tis", ",", "#", ",", "i"}], "]"}], "&"}], "/@", 
         "whichcells"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"mean", ",", 
         RowBox[{"v", "=", 
          RowBox[{"Mean", "[", "v", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "v", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], " ", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"VertexOutwardVector", "[", 
     RowBox[{"T_DTissue", ",", " ", "x___"}], "]"}], " ", ":=", " ", 
    RowBox[{"VertexOutwardVector", "[", 
     RowBox[{
      RowBox[{"DTissue2Tissue", "[", "T", "]"}], ",", " ", "x"}], "]"}]}], 
   ";"}], " ", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"VertexOutwardVector", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", "\"\<Expecting VertexOutwardVector[tissue, integer]\>\"", 
       "]"}], ";", " ", 
      RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4949320916753607`*^9, 3.494932094532238*^9}, {
   3.494932135212666*^9, 3.4949323253633957`*^9}, {3.494932465952218*^9, 
   3.494932477779489*^9}, {3.494932524872809*^9, 3.494932528326222*^9}, {
   3.494932576769389*^9, 3.494932578201084*^9}, {3.494932623375918*^9, 
   3.494932714157373*^9}, {3.494933620946673*^9, 3.494933703023218*^9}, {
   3.494933743694333*^9, 3.494933778041582*^9}, {3.494933917415555*^9, 
   3.494933922818247*^9}, {3.561479019587854*^9, 3.561479029190753*^9}, 
   3.561479130118844*^9, {3.561480162240699*^9, 3.561480198416791*^9}, {
   3.5614804574982367`*^9, 
   3.561480458162657*^9}},ExpressionUUID->"a1783b0f-3db9-47a5-8fed-\
6ac75d62f43b"]
}, Closed]],

Cell[CellGroupData[{

Cell["VerticesOnLeft,Right,Top,Bottom", "Subsection",
 CellChangeTimes->{{3.494955350154059*^9, 3.494955353241835*^9}, {
  3.5117165578533487`*^9, 
  3.511716563005404*^9}},ExpressionUUID->"67851bf7-285c-41a5-8ed0-\
1ffe18089016"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"VerticesOnDirectional", "[", 
      RowBox[{"q_Tissue", ",", " ", 
       RowBox[{"{", 
        RowBox[{"dx_", ",", "dy_"}], "}"}]}], "]"}], ":=", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "cob", ",", "cvc", ",", "cvn", ",", "ISB", ",", "PB", ",", "vobq", 
         ",", "i", ",", "v", ",", "vall", ",", "cellNumber", ",", "xy", ",", 
         "xys", ",", "OK", ",", "dPrint", ",", 
         RowBox[{"dbg", "=", "False"}], ",", "BV"}], "}"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"dPrint", "[", "x___", "]"}], ":=", 
         RowBox[{"If", "[", 
          RowBox[{"dbg", ",", 
           RowBox[{"Print", "[", "x", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ISB", "[", 
          RowBox[{"xys_", ",", "xy_"}], "]"}], ":=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"OutwardVector", "[", 
             RowBox[{"xys", ",", "xy"}], "]"}], ".", 
            RowBox[{"{", 
             RowBox[{"dx", ",", "dy"}], "}"}]}], ")"}], ">", "0"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"PB", "[", 
          RowBox[{"xys_", ",", "nums_"}], "]"}], ":=", 
         RowBox[{"Pick", "[", 
          RowBox[{"nums", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"ISB", "[", 
              RowBox[{"xys", ",", "#"}], "]"}], "&"}], "/@", "xys"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vall", "=", 
         RowBox[{"TissueVertices", "[", "q", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"vobq", "=", 
         RowBox[{"VerticesOnBoundary", "[", "q", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"cvn", "=", 
         RowBox[{"CellVertexNumbers", "[", "q", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"cob", "=", 
         RowBox[{"CellsOnBoundary", "[", "q", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"cvc", "=", 
         RowBox[{"CellVertexCoordinates", "[", "q", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"BV", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"Length", "[", "vobq", "]"}]}], ",", 
          RowBox[{"i", "++"}], ",", 
          RowBox[{
           RowBox[{"v", "=", 
            RowBox[{"vobq", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"cellNumber", "=", 
            RowBox[{"Intersection", "[", 
             RowBox[{"cob", ",", 
              RowBox[{"First", "/@", 
               RowBox[{"Position", "[", 
                RowBox[{"cvn", ",", "v"}], "]"}]}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"xys", "=", 
            RowBox[{"cvc", "[", 
             RowBox[{"[", "cellNumber", "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"xy", "=", 
            RowBox[{"vall", "[", 
             RowBox[{"[", "v", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"OK", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"ISB", "[", 
               RowBox[{"#", ",", "xy"}], "]"}], "&"}], "/@", "xys"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"OK", "=", 
            RowBox[{"And", "@@", "OK"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"dPrint", "[", 
            RowBox[{
            "\"\<vertex \>\"", ",", "v", ",", "\"\< is \>\"", ",", 
             "cellNumber", ",", "\"\< xy = \>\"", ",", "xy", ",", 
             "\"\< xys = \>\"", ",", "xys", ",", "\"\< OK = \>\"", ",", 
             "OK"}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"OK", ",", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"BV", ",", "v"}], "]"}]}], "]"}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "BV", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"VerticesOnBottom", "[", "q_Tissue", "]"}], ":=", 
     RowBox[{"VerticesOnDirectional", "[", 
      RowBox[{"q", ",", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", " ", 
         RowBox[{"-", "1.0"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"VerticesOnRight", "[", "q_Tissue", "]"}], ":=", 
     RowBox[{"VerticesOnDirectional", "[", 
      RowBox[{"q", ",", " ", 
       RowBox[{"{", 
        RowBox[{"1.0", ",", " ", "0.0"}], "}"}]}], "]"}]}], ";", " ", 
    RowBox[{
     RowBox[{"VerticesOnTop", "[", "q_Tissue", "]"}], ":=", 
     RowBox[{"VerticesOnDirectional", "[", 
      RowBox[{"q", ",", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "1.0"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"VerticesOnLeft", "[", "q_Tissue", "]"}], ":=", 
     RowBox[{"VerticesOnDirectional", "[", 
      RowBox[{"q", ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1.0"}], ",", " ", "0.0"}], "}"}]}], "]"}]}], ";"}], 
   " ", "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"VerticesOnTop", "[", "w_DTissue", "]"}], ":=", " ", 
     RowBox[{"VerticesOnTop", "[", 
      RowBox[{"DTissue2Tissue", "[", "w", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"VerticesOnBottom", "[", "w_DTissue", "]"}], ":=", " ", 
     RowBox[{"VerticesOnBottom", "[", 
      RowBox[{"DTissue2Tissue", "[", "w", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"VerticesOnLeft", "[", "w_DTissue", "]"}], ":=", " ", 
     RowBox[{"VerticesOnLeft", "[", 
      RowBox[{"DTissue2Tissue", "[", "w", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"VerticesOnRight", "[", "w_DTissue", "]"}], ":=", " ", 
     RowBox[{"VerticesOnRight", "[", 
      RowBox[{"DTissue2Tissue", "[", "w", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.494955354191951*^9, 3.4949555722963057`*^9}, {
  3.494955602800529*^9, 3.494955608840317*^9}, {3.4949556720162983`*^9, 
  3.494955694281374*^9}, {3.494955738331201*^9, 3.494955821934926*^9}, {
  3.494955948207827*^9, 3.494955960959526*^9}, {3.494956009474551*^9, 
  3.494956025826109*^9}, {3.494956061364571*^9, 3.494956145334978*^9}, {
  3.4949563527342033`*^9, 3.494956469487956*^9}, {3.56147758551644*^9, 
  3.561477629983848*^9}, {3.561479230051043*^9, 3.5614792415948963`*^9}, {
  3.561479307000597*^9, 3.561479317008988*^9}, {3.561479349546376*^9, 
  3.56147939080199*^9}, {3.561480458334298*^9, 3.561480458838139*^9}, {
  3.577982299617638*^9, 3.57798232881456*^9}, {3.577982365781045*^9, 
  3.5779825847842693`*^9}, {3.577982626765931*^9, 3.577982668455833*^9}, {
  3.577982706964275*^9, 
  3.577982740332459*^9}},ExpressionUUID->"dc141b50-45e2-43fb-9be7-\
20302da8f811"]
}, Closed]],

Cell[CellGroupData[{

Cell["EdgesOnLeft,Right,Top,Bottom", "Subsection",
 CellChangeTimes->{{3.5117165699096127`*^9, 
  3.51171658378204*^9}},ExpressionUUID->"70418ce3-b55a-4e32-9ce0-\
f19c56aabf8a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EdgesOnLeft", "[", "w_Tissue", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"e", ",", "cb", ",", "vb", ",", "el", ",", "uel"}], "}"}], ",", 
      RowBox[{
       RowBox[{"e", "=", 
        RowBox[{"TissueEdges", "[", "w", "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"cb", "=", 
        RowBox[{"CellsOnBoundary", "[", "w", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"vb", "=", 
        RowBox[{"VerticesOnLeft", "[", "w", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"el", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"e", ",", "#"}], "]"}], "&"}], "/@", "vb"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"el", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"First", "/@", 
          RowBox[{"Transpose", "/@", "el"}]}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "edge", " ", "numbers", " ", "that", " ", "touch", " ", "LHS"}], 
        "*)"}], 
       RowBox[{"uel", "=", 
        RowBox[{"Union", "[", "el", "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{"unique", " ", "edge", " ", "numbers"}], "*)"}], 
       RowBox[{"(*", 
        RowBox[{
        "select", " ", "only", " ", "edge", " ", "numbers", " ", "that", " ", 
         "have", " ", "two", " ", "vertices", " ", "on", " ", "the", " ", 
         "LHS"}], "*)"}], 
       RowBox[{"Select", "[", 
        RowBox[{"uel", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Count", "[", 
            RowBox[{"el", ",", "#"}], "]"}], ">", "1"}], "&"}]}], "]"}]}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EdgesOnRight", "[", "w_Tissue", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"e", ",", "cb", ",", "vb", ",", "el", ",", "uel"}], "}"}], ",", 
      RowBox[{
       RowBox[{"e", "=", 
        RowBox[{"TissueEdges", "[", "w", "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"cb", "=", 
        RowBox[{"CellsOnBoundary", "[", "w", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"vb", "=", 
        RowBox[{"VerticesOnRight", "[", "w", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"el", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"e", ",", "#"}], "]"}], "&"}], "/@", "vb"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"el", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"First", "/@", 
          RowBox[{"Transpose", "/@", "el"}]}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "edge", " ", "numbers", " ", "that", " ", "touch", " ", "LHS"}], 
        "*)"}], 
       RowBox[{"uel", "=", 
        RowBox[{"Union", "[", "el", "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{"unique", " ", "edge", " ", "numbers"}], "*)"}], 
       RowBox[{"(*", 
        RowBox[{
        "select", " ", "only", " ", "edge", " ", "numbers", " ", "that", " ", 
         "have", " ", "two", " ", "vertices", " ", "on", " ", "the", " ", 
         "LHS"}], "*)"}], 
       RowBox[{"Select", "[", 
        RowBox[{"uel", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Count", "[", 
            RowBox[{"el", ",", "#"}], "]"}], ">", "1"}], "&"}]}], "]"}]}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EdgesOnTop", "[", "w_Tissue", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"e", ",", "cb", ",", "vb", ",", "el", ",", "uel"}], "}"}], ",", 
      RowBox[{
       RowBox[{"e", "=", 
        RowBox[{"TissueEdges", "[", "w", "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"cb", "=", 
        RowBox[{"CellsOnBoundary", "[", "w", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"vb", "=", 
        RowBox[{"VerticesOnTop", "[", "w", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"el", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"e", ",", "#"}], "]"}], "&"}], "/@", "vb"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"el", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"First", "/@", 
          RowBox[{"Transpose", "/@", "el"}]}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "edge", " ", "numbers", " ", "that", " ", "touch", " ", "LHS"}], 
        "*)"}], 
       RowBox[{"uel", "=", 
        RowBox[{"Union", "[", "el", "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{"unique", " ", "edge", " ", "numbers"}], "*)"}], 
       RowBox[{"(*", 
        RowBox[{
        "select", " ", "only", " ", "edge", " ", "numbers", " ", "that", " ", 
         "have", " ", "two", " ", "vertices", " ", "on", " ", "the", " ", 
         "LHS"}], "*)"}], 
       RowBox[{"Select", "[", 
        RowBox[{"uel", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Count", "[", 
            RowBox[{"el", ",", "#"}], "]"}], ">", "1"}], "&"}]}], "]"}]}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EdgesOnBottom", "[", "w_Tissue", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"e", ",", "cb", ",", "vb", ",", "el", ",", "uel"}], "}"}], ",", 
      RowBox[{
       RowBox[{"e", "=", 
        RowBox[{"TissueEdges", "[", "w", "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"cb", "=", 
        RowBox[{"CellsOnBoundary", "[", "w", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"vb", "=", 
        RowBox[{"VerticesOnBottom", "[", "w", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"el", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"e", ",", "#"}], "]"}], "&"}], "/@", "vb"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"el", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"First", "/@", 
          RowBox[{"Transpose", "/@", "el"}]}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "edge", " ", "numbers", " ", "that", " ", "touch", " ", "LHS"}], 
        "*)"}], 
       RowBox[{"uel", "=", 
        RowBox[{"Union", "[", "el", "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{"unique", " ", "edge", " ", "numbers"}], "*)"}], 
       RowBox[{"(*", 
        RowBox[{
        "select", " ", "only", " ", "edge", " ", "numbers", " ", "that", " ", 
         "have", " ", "two", " ", "vertices", " ", "on", " ", "the", " ", 
         "LHS"}], "*)"}], 
       RowBox[{"Select", "[", 
        RowBox[{"uel", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Count", "[", 
            RowBox[{"el", ",", "#"}], "]"}], ">", "1"}], "&"}]}], "]"}]}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EdgesOnTop", "[", "w_DTissue", "]"}], ":=", " ", 
   RowBox[{"EdgesOnTop", "[", 
    RowBox[{"DTissue2Tissue", "[", "w", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EdgesOnBottom", "[", "w_DTissue", "]"}], ":=", " ", 
   RowBox[{"EdgesOnLeft", "[", 
    RowBox[{"DTissue2Tissue", "[", "w", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EdgesOnLeft", "[", "w_DTissue", "]"}], ":=", " ", 
   RowBox[{"EdgesOnBottom", "[", 
    RowBox[{"DTissue2Tissue", "[", "w", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", GridBox[{
   {
    RowBox[{
     RowBox[{
      RowBox[{"EdgesOnRight", "[", "w_DTissue", "]"}], ":=", " ", 
      RowBox[{"EdgesOnRight", "[", 
       RowBox[{"DTissue2Tissue", "[", "w", "]"}], "]"}]}], ";"}]},
   {"\[IndentingNewLine]"}
  }]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.511716590663148*^9, 3.511716652982175*^9}, {
  3.561472280552189*^9, 3.561472328743318*^9}, {3.561477485901309*^9, 
  3.561477551927293*^9}},ExpressionUUID->"06375f2a-f069-425b-88a0-\
793be17abcbc"]
}, Closed]],

Cell[CellGroupData[{

Cell["CellsOnLeft,Right,Top,Bottom", "Subsection",
 CellChangeTimes->{{3.511716664416898*^9, 
  3.5117166696808233`*^9}},ExpressionUUID->"d3ce5bc5-2299-4753-bba4-\
1acfbd68fb5a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"StaticToDynamicNumberRules", "[", "DT_DTissue", "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"cn", ",", "nc", ",", "s2d"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cn", "=", 
      RowBox[{"First", "/@", 
       RowBox[{"TissueCells", "[", "DT", "]"}]}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"nc", " ", "=", " ", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", "cn", "]"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"s2d", " ", "=", " ", 
      RowBox[{"MapThread", "[", 
       RowBox[{"Rule", ",", 
        RowBox[{"{", 
         RowBox[{"nc", ",", "cn"}], "}"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5749759948213663`*^9, 3.5749760388580217`*^9}, 
   3.574976283956182*^9},ExpressionUUID->"1fe73ec6-2a49-4805-b25d-\
f3a5f5708ab8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CellsOnLeft", "[", "w_Tissue", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cb", ",", "el", ",", "c", ",", "cl"}], "}"}], ",", 
     RowBox[{
      RowBox[{"cb", "=", 
       RowBox[{"CellsOnBoundary", "[", "w", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"el", "=", 
       RowBox[{"EdgesOnLeft", "[", "w", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"TissueCells", "[", "w", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cl", "=", 
       RowBox[{"Union", "[", 
        RowBox[{"First", "/@", 
         RowBox[{"First", "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", "el"}], ")"}]}]}], 
        "]"}]}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CellsOnLeft", "[", "w_DTissue", "]"}], ":=", " ", 
    RowBox[{"CellsOnLeft", "[", 
     RowBox[{
      RowBox[{"DTissue2Tissue", "[", "w", "]"}], "/.", 
      RowBox[{"StaticToDynamicNumberRules", "[", "w", "]"}]}], "]"}]}], ";"}],
   " ", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CellsOnRight", "[", "w_Tissue", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cb", ",", "el", ",", "c", ",", "cl"}], "}"}], ",", 
     RowBox[{
      RowBox[{"cb", "=", 
       RowBox[{"CellsOnBoundary", "[", "w", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"el", "=", 
       RowBox[{"EdgesOnRight", "[", "w", "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"c", "=", 
       RowBox[{"TissueCells", "[", "w", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cl", "=", 
       RowBox[{"Union", "[", 
        RowBox[{"First", "/@", 
         RowBox[{"First", "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", "el"}], ")"}]}]}], 
        "]"}]}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CellsOnRight", "[", "w_DTissue", "]"}], ":=", " ", 
    RowBox[{"CellsOnRight", "[", 
     RowBox[{
      RowBox[{"DTissue2Tissue", "[", "w", "]"}], "/.", 
      RowBox[{"StaticToDynamicNumberRules", "[", "w", "]"}]}], "]"}]}], ";"}],
   " ", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CellsOnTop", "[", "w_Tissue", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cb", ",", "el", ",", "c", ",", "cl"}], "}"}], ",", 
     RowBox[{
      RowBox[{"cb", "=", 
       RowBox[{"CellsOnBoundary", "[", "w", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"el", "=", 
       RowBox[{"EdgesOnTop", "[", "w", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"TissueCells", "[", "w", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cl", "=", 
       RowBox[{"Union", "[", 
        RowBox[{"First", "/@", 
         RowBox[{"First", "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", "el"}], ")"}]}]}], 
        "]"}]}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CellsOnTop", "[", "w_DTissue", "]"}], ":=", " ", 
    RowBox[{"CellsOnTop", "[", 
     RowBox[{
      RowBox[{"DTissue2Tissue", "[", "w", "]"}], "/.", 
      RowBox[{"StaticToDynamicNumberRules", "[", "w", "]"}]}], "]"}]}], ";"}],
   " ", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CellsOnBottom", "[", "w_Tissue", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cb", ",", "el", ",", "c", ",", "cl"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cb", "=", 
       RowBox[{"CellsOnBoundary", "[", "w", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"el", "=", 
       RowBox[{"EdgesOnBottom", "[", "w", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"TissueCells", "[", "w", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cl", "=", 
       RowBox[{"Union", "[", 
        RowBox[{"First", "/@", 
         RowBox[{"First", "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", "el"}], ")"}]}]}], 
        "]"}]}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CellsOnBottom", "[", "w_DTissue", "]"}], ":=", " ", 
    RowBox[{"CellsOnBottom", "[", 
     RowBox[{
      RowBox[{"DTissue2Tissue", "[", "w", "]"}], "/.", 
      RowBox[{"StaticToDynamicNumberRules", "[", "w", "]"}]}], "]"}]}], ";"}],
   " "}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.51171667554283*^9, 3.511716724343618*^9}, {
   3.5614721135229893`*^9, 3.561472118202791*^9}, {3.561472150883875*^9, 
   3.5614722570795927`*^9}, 3.574975817139244*^9, {3.574976057556726*^9, 
   3.5749760585413933`*^9}, {3.5749763004506407`*^9, 
   3.5749763396325903`*^9}},ExpressionUUID->"bb21435c-ab4d-469e-b27f-\
15667f0429c3"]
}, Closed]],

Cell[CellGroupData[{

Cell["TissueCheck", "Subsection",
 CellChangeTimes->{{3.448465273064306*^9, 
  3.448465274432005*^9}},ExpressionUUID->"8030b3a2-e261-4a8d-8626-\
1728e7e881ce"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TissueCheck", "[", 
    RowBox[{
     RowBox[{"Tissue", "[", 
      RowBox[{"v_", ",", " ", "e_", ",", " ", "f_"}], "]"}], ",", " ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ok", ",", " ", "notok", ",", " ", "num", ",", " ", "ne", ",", " ", 
       "nv", ",", " ", "nf", ",", " ", "quiet", ",", " ", "qPrint", ",", " ", 
       "passed", ",", " ", "dangEdge", ",", "ok3"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"quiet", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<Quiet\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Quiet\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"qPrint", "[", "x___", "]"}], ":=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", "quiet"}], ",", " ", 
         RowBox[{"Print", "[", "x", "]"}]}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"passed", " ", "=", " ", "True"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Check", " ", "Vertices"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ListQ", "[", "v", "]"}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"nv", "=", 
          RowBox[{"Length", "[", "v", "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"qPrint", "[", 
          RowBox[{"nv", ",", " ", "\"\< Vertices.\>\""}], "]"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"nv", "<", "3"}], ",", " ", 
           RowBox[{
            RowBox[{
            "qPrint", "[", 
             "\"\<TissueCheck: Error: There must be at least 3 vertices.\>\"",
              "]"}], ";", " ", "\[IndentingNewLine]", 
            RowBox[{"passed", "=", "False"}], ";"}]}], " ", 
          "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
         RowBox[{"ok", " ", "=", " ", 
          RowBox[{"numPairQ", "/@", "v"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"ok3", "=", 
          RowBox[{"numTripleQ", "/@", "v"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"num", "=", 
          RowBox[{"Range", "[", "nv", "]"}]}], ";", " ", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"!", "#1"}], ",", 
                RowBox[{"qPrint", "[", 
                 RowBox[{
                 "\"\<TissueCheck: Error: Vertex \>\"", ",", " ", "#2", ",", 
                  "\"\< = \>\"", ",", " ", "#3", ",", " ", 
                  "\"\< is not a pair of numbers.\>\""}], "]"}]}], "]"}], 
              "&"}], ",", " ", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"ok", ",", " ", "num", ",", " ", "v"}], "}"}]}], "]"}], 
           ";"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"ok", " ", "=", " ", 
          RowBox[{"And", "@@", "ok"}]}], ";", " ", "\[IndentingNewLine]", 
         RowBox[{"ok3", "=", 
          RowBox[{"And", "@@", "ok3"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"\[Not]", 
            RowBox[{"Or", "[", 
             RowBox[{"ok", ",", "ok3"}], "]"}]}], ",", " ", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"passed", "=", "False"}], ";", "\[IndentingNewLine]", 
            RowBox[{
            "qPrint", "[", 
             "\"\<TissueCheck: Error: Vertices must all be length 2 or all \
length 3\>\"", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";"}], " ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "qPrint", "[", 
          "\"\<TissueCheck: Error: First argument of tissue must be a list of \
vertex coordinates.\>\"", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"passed", "=", "False"}], ";"}]}], " ", 
       "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Check", " ", "Edges"}], " ", "*)"}], " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ListQ", "[", "e", "]"}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ne", "=", 
          RowBox[{"Length", "[", "e", "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"qPrint", "[", 
          RowBox[{"ne", ",", " ", "\"\< Edges.\>\""}], "]"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ne", "<", "3"}], ",", " ", 
           RowBox[{
            RowBox[{
            "qPrint", "[", 
             "\"\<TissueCheck: Error: There must be at least 3 edges.\>\"", 
             "]"}], ";", " ", "\[IndentingNewLine]", 
            RowBox[{"passed", "=", "False"}], ";"}]}], " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"ok", " ", "=", " ", 
          RowBox[{"intPairQ", "/@", "e"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"num", "=", 
          RowBox[{"Range", "[", "ne", "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", "#1"}], ",", 
              RowBox[{"qPrint", "[", 
               RowBox[{
               "\"\<TissueCheck: Error: Edge \>\"", ",", " ", "#2", ",", 
                "\"\< = \>\"", ",", " ", "#3", ",", " ", 
                "\"\< is not a pair of integers.\>\""}], "]"}]}], "]"}], 
            "&"}], ",", " ", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"ok", ",", " ", "num", ",", " ", "e"}], "}"}]}], "]"}], 
         ";", " ", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"\[Not]", 
            RowBox[{"(", 
             RowBox[{"And", "@@", "ok"}], ")"}]}], ",", " ", 
           RowBox[{"passed", "=", "False"}]}], "]"}], ";", " ", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Block", "[", 
          RowBox[{
           RowBox[{"{", "vnumok", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"vnumok", "[", "x_", "]"}], ":=", " ", 
             RowBox[{
              RowBox[{"x", ">", "0"}], " ", "\[And]", " ", 
              RowBox[{"x", "\[LessEqual]", " ", "nv"}]}]}], ";", " ", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"vnumok", "[", 
              RowBox[{"{", 
               RowBox[{"i_", ",", " ", "j_"}], "}"}], "]"}], ":=", " ", 
             RowBox[{
              RowBox[{"vnumok", "[", "i", "]"}], " ", "\[And]", " ", 
              RowBox[{"vnumok", "[", "j", "]"}]}]}], ";", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"ok", " ", "=", " ", 
             RowBox[{"vnumok", "/@", "e"}]}], ";", " ", "\[IndentingNewLine]",
             "\[IndentingNewLine]", 
            RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"!", "#1"}], ",", 
                 RowBox[{"qPrint", "[", 
                  RowBox[{
                  "\"\<TissueCheck: Error: Edge \>\"", ",", " ", "#2", ",", 
                   "\"\< = \>\"", ",", " ", "#3", ",", " ", 
                   "\"\< refers to a non-existent vertex.\>\""}], "]"}]}], 
                "]"}], "&"}], ",", " ", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"ok", ",", " ", "num", ",", " ", "e"}], "}"}]}], "]"}],
             ";", " ", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"\[Not]", 
               RowBox[{"(", 
                RowBox[{"And", "@@", "ok"}], ")"}]}], ",", " ", 
              RowBox[{"passed", "=", "False"}]}], "]"}], ";"}]}], " ", 
          "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "qPrint", "[", 
          "\"\<TissueCheck: Error: second argument of tissue must be a list \
of edges ({i,j} pairs).\>\"", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"passed", "=", "False"}], ";"}]}], " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Check", " ", "Faces"}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ListQ", "[", "f", "]"}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"nf", "=", 
          RowBox[{"Length", "[", "f", "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"qPrint", "[", 
          RowBox[{"nf", ",", " ", "\"\< Faces.\>\""}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"nf", "<", "1"}], ",", " ", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
            "qPrint", "[", 
             "\"\<TissueCheck: Error: there must be at leaat one face.\>\"", 
             "]"}], ";", " ", "\[IndentingNewLine]", 
            RowBox[{"passed", "=", "False"}], ";"}]}], " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"ok", " ", "=", " ", 
          RowBox[{"intListQ", "/@", "f"}]}], ";", " ", "\[IndentingNewLine]", 
         
         RowBox[{"num", "=", 
          RowBox[{"Range", "[", "nf", "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", "#1"}], ",", 
              RowBox[{"qPrint", "[", 
               RowBox[{
               "\"\<TissueCheck: Error: Face \>\"", ",", " ", "#2", ",", 
                "\"\< = \>\"", ",", " ", "#3", ",", " ", 
                "\"\< is not a list of integers.\>\""}], "]"}]}], "]"}], 
            "&"}], ",", " ", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"ok", ",", " ", "num", ",", " ", "f"}], "}"}]}], "]"}], 
         ";", " ", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"\[Not]", 
            RowBox[{"(", 
             RowBox[{"And", "@@", "ok"}], ")"}]}], ",", " ", 
           RowBox[{"passed", "=", "False"}]}], "]"}], ";", " ", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Block", "[", 
          RowBox[{
           RowBox[{"{", "enumok", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"enumok", "[", "x_", "]"}], ":=", " ", 
             RowBox[{
              RowBox[{"x", ">", "0"}], " ", "\[And]", " ", 
              RowBox[{"x", "\[LessEqual]", " ", "ne"}]}]}], ";", " ", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"enumok", "[", 
              RowBox[{"{", "i__", "}"}], "]"}], ":=", 
             RowBox[{"And", "@@", 
              RowBox[{"(", 
               RowBox[{"enumok", "/@", 
                RowBox[{"{", "i", "}"}]}], ")"}]}]}], ";", " ", 
            "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
            RowBox[{"ok", " ", "=", " ", 
             RowBox[{"enumok", "/@", "f"}]}], ";", " ", "\[IndentingNewLine]",
             "\[IndentingNewLine]", 
            RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"!", "#1"}], ",", 
                 RowBox[{"qPrint", "[", 
                  RowBox[{
                  "\"\<TissueCheck: Error: Cell \>\"", ",", " ", "#2", ",", 
                   "\"\< = \>\"", ",", " ", "#3", ",", " ", 
                   "\"\< refers to a non-existent edge.\>\""}], "]"}]}], 
                "]"}], "&"}], ",", " ", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"ok", ",", " ", "num", ",", " ", "f"}], "}"}]}], "]"}],
             ";", " ", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"\[Not]", 
               RowBox[{"(", 
                RowBox[{"And", "@@", "ok"}], ")"}]}], ",", " ", 
              RowBox[{"passed", "=", "False"}]}], "]"}], ";"}]}], " ", 
          "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "qPrint", "[", 
          "\"\<TissueCheck: Error: Third argument of tissue must be a list of \
faces (cells in 2D), each face as list of edge numbers\>\"", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"passed", "=", "False"}], ";"}]}], " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "passed", "]"}], ";"}]}], " ", 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TissueCheck", "[", 
     RowBox[{"x_", ",", " ", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"quiet", ",", " ", "qPrint"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"quiet", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<Quiet\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<Quiet\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";", 
       " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"qPrint", "[", "v___", "]"}], ":=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", "quiet"}], ",", " ", 
          RowBox[{"Print", "[", "v", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "qPrint", "[", 
        "\"\<TissueCheck: Error: Expecting Tissue[vertices, edges, faces]. \
Input does not appear to be a Tissue[...] object. \>\"", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", " ", "False"}]}], 
     "]"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.448465285584707*^9, 3.448465460728862*^9}, {
  3.448465501309967*^9, 3.448465530133078*^9}, {3.448465564650793*^9, 
  3.448465663468923*^9}, {3.448465718640257*^9, 3.448465794889608*^9}, {
  3.448465880957412*^9, 3.448466580767586*^9}, {3.448466614286131*^9, 
  3.448466724645252*^9}, {3.448466763312736*^9, 3.448466763961323*^9}, {
  3.448466849983788*^9, 3.448466960726231*^9}, {3.448469396235185*^9, 
  3.448469499886408*^9}, {3.448469535461906*^9, 3.448469542951596*^9}, {
  3.449083361555083*^9, 3.449083460748149*^9}, {3.449083590361805*^9, 
  3.449083610831854*^9}, {3.449083700225912*^9, 3.449083704421167*^9}, {
  3.449083786939319*^9, 3.449083797836503*^9}, {3.558995667654426*^9, 
  3.55899593141599*^9}},ExpressionUUID->"d3244706-cfb1-4b2d-8db2-\
aaf004cccf6c"]
}, Closed]],

Cell[CellGroupData[{

Cell["DanglingEdges,DanglingVertices", "Subsection",
 CellChangeTimes->{{3.449083304539052*^9, 3.449083307954715*^9}, {
  3.449084067695714*^9, 
  3.449084082556019*^9}},ExpressionUUID->"5f89d035-7bb6-4473-9d57-\
13186bf3c122"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DanglingEdges", "[", 
    RowBox[{"tissue_", "?", "TissueQ"}], "]"}], ":=", " ", 
   RowBox[{"Complement", "[", 
    RowBox[{
     RowBox[{"Range", "[", 
      RowBox[{"NTissueEdges", "[", "tissue", "]"}], "]"}], ",", 
     RowBox[{"Union", "[", 
      RowBox[{
       RowBox[{"TissueCells", "[", "tissue", "]"}], "//", "Flatten"}], 
      "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.449083308725888*^9, 3.44908332766406*^9}, {
  3.449083862578627*^9, 
  3.449083873651819*^9}},ExpressionUUID->"0cf4b89d-0e35-4df5-929a-\
61a383f674ce"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DanglingVertices", "[", 
   RowBox[{"tissue_", "?", "TissueQ"}], "]"}], ":=", " ", 
  RowBox[{"Complement", "[", 
   RowBox[{
    RowBox[{"Range", "[", 
     RowBox[{"NTissueVertices", "[", "tissue", "]"}], "]"}], ",", " ", 
    RowBox[{"Union", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"TissueEdges", "[", "tissue", "]"}], "]"}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.449083910166099*^9, 3.449083962395692*^9}, {
  3.449084038843616*^9, 3.449084052632352*^9}, {3.44908413680126*^9, 
  3.449084137405638*^9}},ExpressionUUID->"0890c381-fd49-4326-a172-\
7c4e5ef4baf0"]
}, Closed]],

Cell[CellGroupData[{

Cell["UndangleEdge, RemoveEdge", "Subsection",
 CellChangeTimes->{{3.449155291966023*^9, 3.449155294870033*^9}, {
  3.451055191397604*^9, 
  3.451055197365185*^9}},ExpressionUUID->"0006591d-20eb-49e8-abe8-\
276d819b3577"],

Cell["\<\
remove a specific edge, if it is dangling (has no cell pointing to it)
rev. 2.1.a.20 - remove the edge even if it is not dangling, using \
RemoveVertices to shrink the two endpoints into a single edge. \
\>", "Text",
 CellChangeTimes->{{3.450802680687249*^9, 3.450802691686384*^9}, {
  3.489185197727291*^9, 
  3.489185225596889*^9}},ExpressionUUID->"421e09fc-9f6e-4a34-b963-\
ca454e230a93"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UndangleEdge", "[", 
     RowBox[{
      RowBox[{"tissue_", "?", "TissueQ"}], ",", " ", "number_"}], "]"}], ":=",
     " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "v", ",", "e", ",", "c", ",", " ", "n", ",", " ", "q", ",", " ", 
        "edgen"}], "}"}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"v", "=", 
        RowBox[{"TissueVertices", "[", "tissue", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"e", "=", 
        RowBox[{"TissueEdges", "[", "tissue", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"c", "=", 
        RowBox[{"TissueCells", "[", "tissue", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "e", "]"}]}], ";", " ", "\[IndentingNewLine]", 
       
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"DanglingEdges", "[", "tissue", "]"}], ",", " ", 
            "number"}], "]"}]}], ",", " ", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "If", " ", "the", " ", "edge", " ", "is", " ", "not", " ", 
           "Dangling", " ", "use", " ", "RemoveVertices"}], " ", "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"MergeVertices", "[", 
           RowBox[{"tissue", ",", " ", "number"}], "]"}], "]"}]}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Old", " ", "version"}], " ", "-", " ", 
          RowBox[{
          "only", " ", "allows", " ", "removing", " ", "dangling", " ", 
           "edges"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Error: UndangleEdge: edge \>\"", ",", " ", "number", ",", 
            " ", "\"\< is not a dangling edge and cannot be removed.\>\""}], 
           "]"}], ";", " ", 
          RowBox[{"Return", "[", "tissue", "]"}], ";"}], 
         "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"if", " ", "last", " ", "edge"}], ",", " ", 
         RowBox[{"just", " ", "make", " ", "it", " ", "go", " ", "away"}]}], 
        " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[Equal]", "number"}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"e", "=", 
           RowBox[{"Most", "[", "e", "]"}]}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"q", "=", 
           RowBox[{"Tissue", "[", 
            RowBox[{"v", ",", "e", ",", "c"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "q", "]"}], ";"}]}], " ", 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"if", " ", "not", " ", "last", " ", "edge"}], ",", " ", 
         RowBox[{
         "move", " ", "edge", " ", "n", " ", "to", " ", "old", " ", "edge", 
          " ", "number", " ", "place"}]}], " ", "*)"}], "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"edgen", "=", 
        RowBox[{"Last", "[", "e", "]"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"e", "=", 
        RowBox[{"ReplacePart", "[", 
         RowBox[{
          RowBox[{"Most", "[", "e", "]"}], ",", " ", 
          RowBox[{"number", "\[Rule]", " ", "edgen"}]}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"c", " ", "=", " ", 
        RowBox[{"c", "/.", 
         RowBox[{"{", 
          RowBox[{"n", "\[Rule]", " ", "number"}], "}"}]}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"q", "=", 
        RowBox[{"Tissue", "[", 
         RowBox[{"v", ",", "e", ",", "c"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "q", "]"}], ";"}]}], " ", "\[IndentingNewLine]",
      "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UndangleEdge", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", "\"\<Error: Expecting UndangleEdge[tissue, number]\>\"", 
       "]"}], ";", " ", "$Failed"}], ")"}]}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RemoveEdge", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"UndangleEdge", "[", "x", "]"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.449155295853579*^9, 3.449155565650764*^9}, {
  3.449155856976081*^9, 3.449155883997852*^9}, {3.4510552112322598`*^9, 
  3.4510552204937057`*^9}, {3.489185147054307*^9, 3.4891851934430647`*^9}, {
  3.489185231560873*^9, 3.4891852764416447`*^9}, {3.489185354284685*^9, 
  3.489185356074267*^9}},ExpressionUUID->"bde3880d-b0c2-4ce0-92c4-\
95dc4ee849cb"]
}, Closed]],

Cell[CellGroupData[{

Cell["RemoveEdges", "Subsection",
 CellChangeTimes->{{3.576255718585956*^9, 
  3.576255720001396*^9}},ExpressionUUID->"b8a9b6a7-85cc-47e1-9247-\
754bfcf02b59"],

Cell["\<\
RemoveEdges removes specific edges; Undnalge Edges only removes dangling edges\
\>", "Text",
 CellChangeTimes->{{3.576255838416738*^9, 
  3.5762558521517973`*^9}},ExpressionUUID->"6331c050-e817-4eba-9dc8-\
d76c75af7af0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RemoveEdges", "[", 
    RowBox[{
     RowBox[{"T_", "?", "TissueQ"}], ",", " ", 
     RowBox[{"edges_", "?", "ListQ"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ed", ",", "T1", ",", "ne"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"T1", "=", "T"}], ";", "\[IndentingNewLine]", 
      RowBox[{"ed", "=", 
       RowBox[{"Sort", "[", "edges", "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "ed", "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ne", "=", 
          RowBox[{"Last", "[", "ed", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"ed", "=", 
          RowBox[{"Most", "[", "ed", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"T1", "=", 
          RowBox[{"RemoveEdge", "[", 
           RowBox[{"T1", ",", "ne"}], "]"}]}], ";"}]}], "\[IndentingNewLine]",
        "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "T1", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RemoveEdges", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
     "Print", "[", 
      "\"\<Error: Expecting RemoveEdge[tissue, list-of-edge-numbers]\>\"", 
      "]"}], ")"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.576255721896182*^9, 3.57625583359097*^9}, {
  3.576255901075272*^9, 
  3.576255934111697*^9}},ExpressionUUID->"4317f11f-8afe-42dd-8fd6-\
ddb3555c1c6b"]
}, Closed]],

Cell[CellGroupData[{

Cell["UndangleEdges", "Subsection",
 CellChangeTimes->{{3.450802284247986*^9, 
  3.450802287448772*^9}},ExpressionUUID->"2896684c-a495-4042-afcb-\
3bf4e808b323"],

Cell["remove all dangling edges", "Text",
 CellChangeTimes->{{3.450802698205943*^9, 
  3.450802700790077*^9}},ExpressionUUID->"20da976b-bb97-4b74-8d7e-\
c869aaec7c78"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"UndangleEdges", "[", 
    RowBox[{"tissue_", "?", "TissueQ"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"danglers", ",", " ", "q"}], "}"}], ",", " ", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"danglers", " ", "=", " ", 
       RowBox[{"DanglingEdges", "[", "tissue", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"danglers", " ", "=", " ", 
       RowBox[{"Reverse", "[", 
        RowBox[{"Sort", "[", "danglers", "]"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"q", "=", "tissue"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "danglers", "]"}], ">", "0"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q", "=", 
          RowBox[{"UndangleEdge", "[", 
           RowBox[{"q", ",", " ", 
            RowBox[{"First", "[", "danglers", "]"}]}], "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"danglers", "=", 
          RowBox[{"Rest", "[", "danglers", "]"}]}], ";"}]}], " ", 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "q", "]"}], ";"}]}], " ", "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UndangleEdges", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Print", "[", "\"\<Expecing UndangleEdges[tissue]\>\"", "]"}], 
      ";", " ", "$Failed"}], ")"}]}], ";"}], 
  " "}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.450802289101508*^9, 3.4508023542470827`*^9}, {
  3.450802386574697*^9, 3.450802448496962*^9}, {3.450803534004403*^9, 
  3.450803540325678*^9}, {3.576255668949731*^9, 
  3.5762556839930067`*^9}},ExpressionUUID->"f11db7a1-62e3-43be-ae18-\
99401778309a"]
}, Closed]],

Cell[CellGroupData[{

Cell["Undangle Vertex, RemoveVertex", "Subsection",
 CellChangeTimes->{{3.4508027157314043`*^9, 3.450802717908751*^9}, {
  3.451055202205426*^9, 
  3.4510552042217627`*^9}},ExpressionUUID->"8c179d25-e036-4375-b376-\
cc24f441e272"],

Cell["remove a dangling vertex", "Text",
 CellChangeTimes->{{3.450802720106765*^9, 
  3.450802723489174*^9}},ExpressionUUID->"e1f73258-68de-41be-84a0-\
871648c0f5ec"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UndangleVertex", "[", 
     RowBox[{
      RowBox[{"tissue_", "?", "TissueQ"}], ",", " ", 
      RowBox[{"vNumber_", "?", "IntegerQ"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "dv", ",", " ", "nv", ",", " ", "ne", ",", " ", "rule", ",", " ", "i", 
        ",", " ", "e", ",", " ", "c", ",", " ", "v"}], "}"}], ",", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dv", " ", "=", " ", 
        RowBox[{"DanglingVertices", "[", "tissue", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"MemberQ", "[", 
           RowBox[{"dv", ",", " ", "vNumber"}], "]"}]}], ",", " ", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Error: UndangleVertex: Vertex: \>\"", ",", " ", "vNumber", 
            ",", " ", "\"\< is not dangling and cannot be removed.\>\""}], 
           "]"}], ";", " ", 
          RowBox[{"Return", "[", "tissue", "]"}]}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"e", "=", 
        RowBox[{"TissueEdges", "[", "tissue", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"c", "=", 
        RowBox[{"TissueCells", "[", "tissue", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"v", "=", 
        RowBox[{"TissueVertices", "[", "tissue", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"nv", " ", "=", " ", 
        RowBox[{"Length", "[", "v", "]"}]}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"if", " ", "its", " ", "at", " ", "the", " ", "end"}], ",", 
         " ", 
         RowBox[{"no", " ", "need", " ", "to", " ", "renumber"}]}], " ", 
        "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"vNumber", "\[Equal]", "nv"}], ",", " ", 
         RowBox[{
          RowBox[{"v", "=", 
           RowBox[{"Most", "[", "v", "]"}]}], ";", " ", 
          RowBox[{"Return", "[", 
           RowBox[{"Tissue", "[", 
            RowBox[{"v", ",", " ", "e", ",", " ", "c"}], "]"}], "]"}]}]}], 
        "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"remove", " ", "the", " ", "vertex"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"v", "=", 
        RowBox[{"Drop", "[", 
         RowBox[{"v", ",", " ", 
          RowBox[{"{", "vNumber", "}"}]}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"ne", " ", "=", " ", 
        RowBox[{"Length", "[", "e", "]"}]}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "renumber", " ", "all", " ", "the", " ", "vertex", " ", "references", 
         " ", "for", " ", "all", " ", "the", " ", "higher", " ", "numberd", 
         " ", "vertices"}], " ", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "vNumber"}], ",", " ", 
         RowBox[{"i", "\[LessEqual]", " ", "nv"}], ",", " ", 
         RowBox[{"i", "++"}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"rule", " ", "=", " ", 
           RowBox[{"Rule", "[", 
            RowBox[{"i", ",", " ", 
             RowBox[{"i", "-", "1"}]}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"e", " ", "=", " ", 
           RowBox[{"e", "/.", "rule"}]}]}]}], "\[IndentingNewLine]", "]"}], 
       ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"Tissue", "[", 
         RowBox[{"v", ",", " ", "e", ",", " ", "c"}], "]"}], "]"}], ";"}]}], 
     " ", "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UndangleVertex", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", "\"\<Expecting[UndangleVertex[tissue, vertexNumber]\>\"", 
       "]"}], ";", " ", "$Failed"}], ")"}]}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RemoveVertex", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"UndangleVertex", "[", "x", "]"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4508027244138317`*^9, 3.450802842338064*^9}, {
  3.450802878466118*^9, 3.4508029537689962`*^9}, {3.450802993207674*^9, 
  3.450803347402204*^9}, {3.4510552276030273`*^9, 
  3.4510552476458473`*^9}},ExpressionUUID->"bfd22ec1-d189-4852-8054-\
76cc5d06a244"]
}, Closed]],

Cell[CellGroupData[{

Cell["RemoveVertices", "Subsection",
 CellChangeTimes->{{3.576255950392961*^9, 
  3.576255952295512*^9}},ExpressionUUID->"a557e1dd-57d5-4044-86ec-\
eb8c10b49ac1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RemoveVertices", "[", 
    RowBox[{
     RowBox[{"T_", "?", "TissueQ"}], ",", " ", 
     RowBox[{"vlist_", "?", "ListQ"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"vl", ",", "T1", ",", "vn"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"T1", "=", "T"}], ";", "\[IndentingNewLine]", 
      RowBox[{"vl", "=", 
       RowBox[{"Sort", "[", "vlist", "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "vl", "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"vn", "=", 
          RowBox[{"Last", "[", "vl", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"vl", "=", 
          RowBox[{"Most", "[", "vl", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"T1", "=", 
          RowBox[{"RemoveVertex", "[", 
           RowBox[{"T1", ",", "vn"}], "]"}]}], ";"}]}], "\[IndentingNewLine]",
        "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "T1", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RemoveVertices", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
     "Print", "[", 
      "\"\<Error: Expecting RemoveVertices[tissue, \
list-of-vertex-numbers]\>\"", "]"}], ")"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.576255963993442*^9, 
  3.576256048714912*^9}},ExpressionUUID->"efc63f1a-4f3a-42bf-a076-\
97acb31b069b"]
}, Closed]],

Cell[CellGroupData[{

Cell["UndangleVertices", "Subsection",
 CellChangeTimes->{{3.450802479896813*^9, 3.450802481879664*^9}, {
  3.45080270658237*^9, 
  3.450802707394575*^9}},ExpressionUUID->"192b94be-13de-4c26-9ba8-\
4c7b4753493f"],

Cell["remove all dangling vertices", "Text",
 CellChangeTimes->{{3.450802709816291*^9, 
  3.450802712809729*^9}},ExpressionUUID->"5e1db84c-a9f0-44ea-a36e-\
babbd9414d03"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UndangleVertices", "[", 
     RowBox[{"tissue_", "?", "TissueQ"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"dv", ",", " ", "q"}], "}"}], ",", " ", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"dv", " ", "=", " ", 
        RowBox[{"DanglingVertices", "[", "tissue", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"dv", " ", "=", " ", 
        RowBox[{"Reverse", "[", 
         RowBox[{"Sort", "[", "dv", "]"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"q", "=", "tissue"}], ";", "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "dv", "]"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"q", "=", 
           RowBox[{"UndangleVertex", "[", 
            RowBox[{"q", ",", " ", 
             RowBox[{"First", "[", "dv", "]"}]}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"dv", " ", "=", " ", 
           RowBox[{"Rest", "[", "dv", "]"}]}], ";"}]}], " ", 
        "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "q", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UndangleVertices", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", "\"\<Expecting UndangleVertices[tissue]\>\"", "]"}], ";", 
      " ", "$Failed"}], ")"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.450802482995902*^9, 3.4508025137904377`*^9}, {
  3.4508033867906523`*^9, 3.450803428928342*^9}, {3.450803582508748*^9, 
  3.4508035871281567`*^9}},ExpressionUUID->"a405ae7d-217b-4bfc-80f4-\
e2da158060af"]
}, Closed]],

Cell[CellGroupData[{

Cell["EdgeVertices", "Subsection",
 CellChangeTimes->{{3.448470173980991*^9, 
  3.448470229261087*^9}},ExpressionUUID->"51c6cb84-88f0-4531-99a4-\
9701197bb322"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EdgeVertices", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i_", ",", " ", "j_"}], "}"}], ",", " ", "vertices_"}], "]"}], 
    ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"vertices", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
      RowBox[{"vertices", "[", 
       RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EdgeVertices", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"edge__", "?", "intPairQ"}], "}"}], ",", " ", "vertices_"}], 
     "]"}], ":=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"EdgeVertices", "[", 
       RowBox[{"#", ",", " ", "vertices"}], "]"}], "&"}], "/@", 
     RowBox[{"{", "edge", "}"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EdgeVertices", "[", 
     RowBox[{"tissue_", "?", "TissueQ"}], "]"}], ":=", 
    RowBox[{"EdgeVertices", "[", 
     RowBox[{
      RowBox[{"TissueEdges", "[", "tissue", "]"}], ",", " ", 
      RowBox[{"TissueVertices", "[", "tissue", "]"}]}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EdgeVertices", "[", 
     RowBox[{"DT_", "?", "DTissueQ"}], "]"}], ":=", " ", 
    RowBox[{"EdgeVertices", "[", 
     RowBox[{"DTissue2Tissue", "[", "DT", "]"}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EdgeVertices", "[", "u_", "]"}], ":=", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
    "Print", "[", 
     "\"\<Expecting EdgeVertices[tissue] or EdgeVertices[dtissue]\>\"", "]"}],
     ";", 
    RowBox[{"Abort", "[", "]"}], ";"}], ")"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.448470179761858*^9, 3.448470181081423*^9}, {
  3.448470244722495*^9, 3.448470377368564*^9}, {3.448470456353961*^9, 
  3.448470516241083*^9}, {3.448653677100779*^9, 3.448653713538923*^9}, {
  3.448653760501812*^9, 3.448653777170839*^9}, {3.45926967887085*^9, 
  3.4592697465670033`*^9}, {3.459269870259347*^9, 3.459269871025537*^9}, {
  3.547139784183844*^9, 3.547139843852969*^9}, {3.547139931381894*^9, 
  3.547139931712536*^9}, {3.547139987336619*^9, 
  3.5471400091737013`*^9}},ExpressionUUID->"24038631-cf26-4f38-a600-\
994da6a8d4d1"]
}, Closed]],

Cell[CellGroupData[{

Cell["EdgeLengths, EdgeLength, CellEdgeLengths", "Subsection",
 CellChangeTimes->{{3.448654107685948*^9, 3.448654109261792*^9}, {
  3.4592695510358467`*^9, 3.45926955270912*^9}, {3.489501835577743*^9, 
  3.489501837648921*^9}},ExpressionUUID->"304b0183-d4d8-4cb8-b4b0-\
553c8f32e77c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EdgeLengths", "[", 
     RowBox[{"tissue_", "?", "TissueQ"}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"distance", "@@", "#"}], "&"}], "/@", 
     RowBox[{"EdgeVertices", "[", "tissue", "]"}]}]}], ";"}], 
  "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EdgeLengths", "[", 
     RowBox[{"DT_", "?", "DTissueQ"}], "]"}], ":=", " ", 
    RowBox[{"EdgeLengths", "[", 
     RowBox[{"DTissue2Tissue", "[", "DT", "]"}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EdgeLength", "[", 
     RowBox[{
      RowBox[{"DT_", "?", "DTissueQ"}], ",", " ", 
      RowBox[{"i_", "?", "IntegerQ"}]}], "]"}], ":=", " ", 
    RowBox[{"EdgeLength", "[", 
     RowBox[{
      RowBox[{"DTissue2Tissue", "[", "DT", "]"}], ",", "i"}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EdgeLength", "[", 
    RowBox[{
     RowBox[{"tissue_", "?", "TissueQ"}], ",", " ", 
     RowBox[{"i_", "?", "IntegerQ"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ne", ",", " ", "el"}], "}"}], ",", " ", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"ne", "=", 
       RowBox[{"NTissueEdges", "[", "tissue", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"i", ">", "ne"}], " ", "\[Or]", " ", 
         RowBox[{"i", "<", " ", "1"}]}], ",", " ", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Error: EdgeLength: edge \>\"", ",", " ", "i", ",", " ", 
           "\"\< does not exist.\>\""}], "]"}], ";", " ", 
         RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", " ", 
      RowBox[{"el", " ", "=", " ", 
       RowBox[{"distance", "@@", 
        RowBox[{
         RowBox[{"EdgeVertices", "[", "tissue", "]"}], "[", 
         RowBox[{"[", "i", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "el", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EdgeLength", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", "\"\<Expecting EdgeLength[(d)tissue, edgeNumber]\>\"", 
       "]"}], ";", " ", 
      RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EdgeLengths", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Print", "[", "\"\<Expecting EdgeLengths[(d)tissue]\>\"", "]"}],
       ";", " ", 
      RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CellEdgeLengths", "[", 
    RowBox[{
     RowBox[{"tissue_", "?", "TissueQ"}], ",", " ", 
     RowBox[{"cellNumber_", "?", "NumberQ"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"EdgeLength", "[", 
      RowBox[{"tissue", ",", " ", "#"}], "]"}], "&"}], "/@", 
    RowBox[{
     RowBox[{"TissueCells", "[", "tissue", "]"}], " ", "[", 
     RowBox[{"[", "cellNumber", "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CellEdgeLengths", "[", 
   RowBox[{
    RowBox[{"DT_", "?", "DTissueQ"}], ",", 
    RowBox[{"cellNumber_", "?", "NumberQ"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"c", ",", "i", ",", "T"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"i", "=", 
      RowBox[{"Position", "[", 
       RowBox[{
        RowBox[{"First", "/@", 
         RowBox[{"TissueCells", "[", "DT", "]"}]}], ",", " ", "cellNumber"}], 
       "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"ListQ", "[", "i", "]"}], ",", " ", 
       RowBox[{"i", "=", 
        RowBox[{"First", "[", "i", "]"}]}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"CellEdgeLengths", "[", 
      RowBox[{
       RowBox[{"DTissue2Tissue", "[", "DT", "]"}], ",", "i"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CellEdgeLengths", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", "\"\<Expecting CellEdgeLengths[tissue, cellNumber]\>\"", 
       "]"}], ";", " ", 
      RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.44865411848842*^9, 3.448654196818213*^9}, 
   3.448654228065306*^9, {3.459269557562831*^9, 3.459269628626339*^9}, {
   3.459269666163694*^9, 3.459269673424478*^9}, {3.4592698748939342`*^9, 
   3.4592698758658047`*^9}, {3.4592699152068167`*^9, 3.459269921149005*^9}, {
   3.459269973379562*^9, 3.4592699755984898`*^9}, {3.489501842311263*^9, 
   3.4895019717893887`*^9}, {3.547140054788426*^9, 3.5471401116873302`*^9}, {
   3.547140155329282*^9, 3.547140159212202*^9}, {3.547140267784255*^9, 
   3.547140389755698*^9}, {3.547140468070347*^9, 3.547140473429143*^9}, {
   3.5471422102083597`*^9, 3.5471422115024242`*^9}, {3.547142245024127*^9, 
   3.5471423189230556`*^9}},ExpressionUUID->"d3e34456-ab85-4731-ab8a-\
e729370ed759"]
}, Closed]],

Cell[CellGroupData[{

Cell["SortCellsCounterClockwise", "Subsection",
 CellChangeTimes->{{3.489070007406302*^9, 3.4890700190147448`*^9}, 
   3.489071634121089*^9},ExpressionUUID->"18465736-dda5-4337-9b98-\
9f8d354ce892"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SortCellsCounterClockwise", "[", "tis_Tissue", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "centroids", ",", " ", "c", ",", "nc", ",", " ", "e", ",", " ", "s", 
       ",", " ", "v", ",", " ", "clockwise", ",", " ", "snew", ",", " ", "i", 
       ",", " ", "vnext", ",", " ", "enext"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"centroids", "=", 
       RowBox[{"Centroid", "[", "tis", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"TissueCells", "[", "tis", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nc", "=", 
       RowBox[{"Length", "[", "c", "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"e", "=", 
       RowBox[{"TissueEdges", "[", "tis", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{"TissueVertices", "[", "tis", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"s", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"SortCellEdges", "[", 
          RowBox[{
           RowBox[{"c", "[", 
            RowBox[{"[", "#", "]"}], "]"}], ",", " ", "e"}], "]"}], "&"}], "/@", 
        RowBox[{"Range", "[", "nc", "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"clockwise", "[", "i_", "]"}], ":=", " ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"v1", ",", "v2", ",", " ", "\[Theta]1", ",", "\[Theta]2"}], 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"v1", "=", 
           RowBox[{
            RowBox[{"v", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"\"\<Vertices\>\"", "/.", 
                 RowBox[{"s", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "-", 
            RowBox[{"centroids", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"v1", "=", 
           RowBox[{"v1", "/", 
            RowBox[{"Norm", "[", "v1", "]"}]}]}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"v2", "=", 
           RowBox[{
            RowBox[{"v", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"\"\<Vertices\>\"", "/.", 
                 RowBox[{"s", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "-", 
            RowBox[{"centroids", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"v2", "=", 
           RowBox[{"v2", "/", 
            RowBox[{"Norm", "[", "v2", "]"}]}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"v1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], 
             RowBox[{"v2", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"v2", "[", 
              RowBox[{"[", "1", "]"}], "]"}], 
             RowBox[{"v1", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "<", "0"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"snew", "=", 
       RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", " ", 
        RowBox[{"i", "\[LessEqual]", " ", "nc"}], ",", " ", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"clockwise", "[", "i", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"vnext", "=", 
             RowBox[{"RotateRight", "[", 
              RowBox[{
               RowBox[{"Reverse", "[", 
                RowBox[{"\"\<Vertices\>\"", "/.", 
                 RowBox[{"s", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", "1"}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"enext", " ", "=", 
             RowBox[{"Reverse", "[", 
              RowBox[{"\"\<Edges\>\"", "/.", 
               RowBox[{"s", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"snew", ",", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\"\<Edges\>\"", "\[Rule]", " ", "enext"}], ",", " ", 
                
                RowBox[{"\"\<Vertices\>\"", "\[Rule]", " ", "vnext"}]}], 
               "}"}]}], "]"}], ";"}], " ", "\[IndentingNewLine]", ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{"snew", ",", " ", 
              RowBox[{"s", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], " ", "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "snew", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SortCellsCounterClockwise", "[", "x_", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", "\"\<Expecting SortCellsCounterClockwise[tissue]\>\"", 
       "]"}], ";", " ", 
      RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.489070040818225*^9, 3.48907005845289*^9}, {
  3.4890700894592953`*^9, 3.489070096333467*^9}, {3.489070169022359*^9, 
  3.4890704098726797`*^9}, {3.489070460127522*^9, 3.489070595453657*^9}, {
  3.4890706582515306`*^9, 3.489070779627779*^9}, {3.489070999774687*^9, 
  3.489071013464142*^9}, {3.489071204172011*^9, 3.489071292183628*^9}, {
  3.489071536805399*^9, 3.4890715661763077`*^9}, {3.4890716312257442`*^9, 
  3.489071812621842*^9}, {3.489072226919236*^9, 
  3.48907224949547*^9}},ExpressionUUID->"c59ef459-dc84-4d0a-a00a-\
246aee41e215"]
}, Closed]],

Cell[CellGroupData[{

Cell["SortCellEdges", "Subsection",
 CellChangeTimes->{{3.448472425186425*^9, 
  3.448472426796706*^9}},ExpressionUUID->"837137ee-1fa1-4d80-850c-\
21607fec85c9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SortCellEdges", "[", 
   RowBox[{
    RowBox[{"edges_", "?", "intListQ"}], ",", "alledges_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"dbg", "=", "False"}], ",", "dPrint", ",", "edgepairs", ",", 
      "allVertices", ",", "EndPoints", ",", "ep1", ",", "ep2", ",", "i", ",", 
      "pair", ",", "result", ",", "v", ",", "eresult", ",", "EdgeNumber", ",",
       "vresult", ",", "lastpoint"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"dPrint", "[", "u___", "]"}], ":=", 
      RowBox[{"If", "[", 
       RowBox[{"dbg", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<SCE: \>\"", ",", "u"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"edgepairs", "=", 
      RowBox[{"alledges", "[", 
       RowBox[{"[", "edges", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"allVertices", "=", 
      RowBox[{"Union", "[", 
       RowBox[{"Flatten", "[", "edgepairs", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"EdgeNumber", "[", 
       RowBox[{"{", 
        RowBox[{"i_", ",", "j_"}], "}"}], "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"p1", ",", "p2"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"p1", "=", 
          RowBox[{"Position", "[", 
           RowBox[{"alledges", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "j"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"p2", "=", 
          RowBox[{"Position", "[", 
           RowBox[{"alledges", ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "i"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "p1", "]"}], ">", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Return", "[", 
            RowBox[{"p1", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Return", "[", 
            RowBox[{"p2", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}]}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"EndPoints", "=", 
      RowBox[{"Pick", "[", 
       RowBox[{"allVertices", ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Position", "[", 
             RowBox[{"edgepairs", ",", "#"}], "]"}], "]"}], "<", "2"}], "&"}],
          "/@", "allVertices"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<edgepairs: \>\"", ",", "edgepairs"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<allVertices: \>\"", ",", "allVertices"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<EndPoints: \>\"", ",", "EndPoints"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "EndPoints", "]"}], ">", "2"}], "\[Or]", 
        RowBox[{
         RowBox[{"Length", "[", "EndPoints", "]"}], "\[Equal]", "1"}]}], ",", 
       
       RowBox[{"Print", "[", 
        RowBox[{"GraphPlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Rule", "[", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}], "/@", 
           "edgepairs"}], ",", 
          RowBox[{"VertexLabeling", "\[Rule]", "True"}]}], "]"}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AbortIf", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "EndPoints", "]"}], ">", "2"}], ",", 
       RowBox[{"\"\<SortCellEdges: Found To many End Points \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"InputForm", "[", "EndPoints", "]"}], "]"}], "<>", 
        "\"\< in list \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"InputForm", "[", "edgepairs", "]"}], "]"}], "<>", 
        "\"\< (There must be zero or two end points.)\>\""}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AbortIf", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "EndPoints", "]"}], "\[Equal]", "1"}], ",", 
       RowBox[{
       "\"\<SortCellEdges: Found Precisely One End Point \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"InputForm", "[", "EndPoints", "]"}], "]"}], "<>", 
        "\"\< in list \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"InputForm", "[", "edgepairs", "]"}], "]"}], "<>", 
        "\"\< (There must be zero or two end points.)\>\""}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "EndPoints", "]"}], "\[Equal]", "2"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"ep1", ",", "ep2"}], "}"}], "=", "EndPoints"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"i", "=", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"edgepairs", ",", "ep1"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dPrint", "[", 
         RowBox[{
         "\"\<ep1 \>\"", ",", "ep1", ",", "\"\< is at \>\"", ",", "i"}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"pair", "=", 
         RowBox[{"edgepairs", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pair", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "ep1"}], ",", 
          RowBox[{"pair", "=", 
           RowBox[{"Reverse", "[", "pair", "]"}]}]}], "]"}], ";"}], ",", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"pair", "=", 
         RowBox[{"edgepairs", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{"{", "pair", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"AbortIf", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "edgepairs", "]"}], "<", "i"}], ",", " ", 
       RowBox[{
       "\"\<SortCellEdges: (Possible Program Error 1) Attempt to remove \
element \>\"", "<>", 
        RowBox[{"ToString", "[", "i", "]"}], "<>", 
        "\"\< from edgepairs of length \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"Length", "[", "edgepairs", "]"}], "]"}]}]}], "]"}], ";", 
     " ", "\[IndentingNewLine]", 
     RowBox[{"AbortIf", "[", 
      RowBox[{
       RowBox[{"Not", "[", 
        RowBox[{"IntegerQ", "[", "i", "]"}], "]"}], ",", " ", 
       RowBox[{
       "\"\<SortCellEdges: (Possible Program Error 2) Attempt to remove \
element \>\"", "<>", 
        RowBox[{"ToString", "[", "i", "]"}], "<>", 
        "\"\< from edgepairs of length \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"Length", "[", "edgepairs", "]"}], "]"}]}]}], "]"}], ";", 
     " ", "\[IndentingNewLine]", 
     RowBox[{"edgepairs", "=", 
      RowBox[{"Delete", "[", 
       RowBox[{"edgepairs", ",", "i"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{
      "\"\<result=\>\"", ",", "result", ",", "\"\< edgepairs=\>\"", ",", 
       "edgepairs"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "edgepairs", "]"}], ">", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"v", "=", 
         RowBox[{"pair", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"i", "=", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"edgepairs", ",", "v"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"pair", "=", 
         RowBox[{"edgepairs", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pair", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "v"}], ",", 
          RowBox[{"pair", "=", 
           RowBox[{"Reverse", "[", "pair", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dPrint", "[", 
         RowBox[{
         "\"\<vertex \>\"", ",", "v", ",", "\"\< is it \>\"", ",", "i", ",", 
          "\"\< pair = \>\"", ",", "pair"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AbortIf", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "edgepairs", "]"}], "<", "i"}], ",", " ", 
          RowBox[{
          "\"\<SortCellEdges: (Possible Program Error 3) Attempt to remove \
element \>\"", "<>", 
           RowBox[{"ToString", "[", "i", "]"}], "<>", 
           "\"\< from edgepairs of length \>\"", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{"Length", "[", "edgepairs", "]"}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AbortIf", "[", 
         RowBox[{
          RowBox[{"Not", "[", 
           RowBox[{"IntegerQ", "[", "i", "]"}], "]"}], ",", " ", 
          RowBox[{
          "\"\<SortCellEdges: (Possible Program Error 4) Attempt to remove \
element \>\"", "<>", 
           RowBox[{"ToString", "[", "i", "]"}], "<>", 
           "\"\< from edgepairs of length \>\"", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{"Length", "[", "edgepairs", "]"}], "]"}], "<>", 
           "\"\< result = \>\"", "<>", 
           RowBox[{"ToString", "[", "result", "]"}], "<>", "\"\< v=\>\"", "<>", 
           RowBox[{"ToString", "[", "v", "]"}], "<>", "\"\< edges=\>\"", "<>",
            " ", 
           RowBox[{"ToString", "[", "edges", "]"}], "<>", 
           "\"\< alledges[[edges]]=\>\"", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{"alledges", "[", 
             RowBox[{"[", "edges", "]"}], "]"}], "]"}], "<>", 
           "\"\< alledges=\>\"", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{"InputForm", "[", "alledges", "]"}], "]"}]}]}], "]"}], 
        ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"edgepairs", "=", 
         RowBox[{"Delete", "[", 
          RowBox[{"edgepairs", ",", "i"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"result", ",", "pair"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"dPrint", "[", 
         RowBox[{
         "\"\<result=\>\"", ",", "result", ",", "\"\< edgepairs=\>\"", ",", 
          "edgepairs"}], "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"eresult", "=", 
      RowBox[{"EdgeNumber", "/@", "result"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vresult", "=", 
      RowBox[{"First", "/@", "result"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"lastpoint", "=", 
      RowBox[{"Last", "[", 
       RowBox[{"Last", "[", "result", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{"vresult", ",", "lastpoint"}], "]"}]}], ",", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"vresult", ",", "lastpoint"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<eresult: \>\"", ",", "eresult"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<vresult: \>\"", ",", "vresult"}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<Edges\>\"", "\[Rule]", "eresult"}], ",", 
        RowBox[{"\"\<Vertices\>\"", "\[Rule]", "vresult"}]}], "}"}], "]"}], 
     ";"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SortCellEdges", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Expecting SortCellEdges[cell, edges], where cell={e1,e2,...} and \
edges={{v11,v12}, {v21, v22}, ...}\>\"", "]"}], ";", " ", 
      RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5781592533223953`*^9, 3.578159283911112*^9}, {
   3.578159317880862*^9, 3.578159318594043*^9}, {3.57815935710318*^9, 
   3.5781593978705053`*^9}, {3.578573419056319*^9, 3.5785735364414988`*^9}, {
   3.578573573856914*^9, 3.5785735773785763`*^9}, {3.578574216973969*^9, 
   3.5785743195443773`*^9}, {3.578574411608801*^9, 3.5785744271399603`*^9}, {
   3.5785745112619953`*^9, 3.578574553482937*^9}, {3.578574756617043*^9, 
   3.578574790071286*^9}, 3.5785748268041553`*^9, {3.578574935869495*^9, 
   3.578575063779643*^9}, {3.578575131004922*^9, 3.5785751976685877`*^9}, {
   3.578576660917184*^9, 
   3.578576678821137*^9}},ExpressionUUID->"b7ab066a-1c9c-4361-86f9-\
652930f34008"],

Cell[CellGroupData[{

Cell["earlier version of sortCellEdges", "Subsubsection",
 CellChangeTimes->{{3.5785767976948547`*^9, 
  3.5785768147476997`*^9}},ExpressionUUID->"efc326c3-1da1-4408-bc26-\
283aae502b53"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"SortCellEdges", "[", 
     RowBox[{
      RowBox[{"cell_", "?", "intListQ"}], ",", " ", "edges_"}], "]"}], ":=", 
    " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "ep", ",", " ", "num", " ", ",", " ", "sortedep", ",", " ", 
        "sortednums", ",", " ", "edge", ",", " ", "v2", ",", "p", ",", " ", 
        "index", ",", " ", "vertices", ",", " ", 
        RowBox[{"dbg", "=", "False"}], " ", ",", " ", "firstpair", ",", " ", 
        "dPrint", ",", " ", "lastver", ",", " ", "setappend"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"dPrint", "[", "u___", "]"}], ":=", " ", 
        RowBox[{"If", "[", 
         RowBox[{"dbg", " ", ",", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<SortCellEdges: \>\"", ",", " ", "u"}], "]"}]}], 
         "]"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "cell", "]"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ep", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"edges", "[", 
              RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "cell"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ep", " ", "=", " ", 
           RowBox[{"Sort", "/@", "ep"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"edge", "=", 
           RowBox[{"First", "[", "ep", "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"sortedep", "=", 
           RowBox[{"{", "edge", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"index", "=", "1"}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"sortednums", "=", 
           RowBox[{"{", "index", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"num", "=", 
           RowBox[{"Range", "[", 
            RowBox[{"2", ",", " ", 
             RowBox[{"Length", "[", "cell", "]"}]}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"firstpair", "=", "True"}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
             RowBox[{"allow", " ", "non"}], "-", 
             RowBox[{"cyclic", " ", "cells"}]}], ",", " ", 
            RowBox[{"e", ".", "g", "."}], ",", " ", "walls"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"setappend", "=", "True"}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "sortednums", "]"}], "<", 
             RowBox[{"Length", "[", "cell", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"dPrint", "[", "\"\<new pair *****\>\"", "]"}], ";", " ",
              "\[IndentingNewLine]", 
             RowBox[{"v2", "=", 
              RowBox[{"edge", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"p", "=", 
              RowBox[{"Position", "[", 
               RowBox[{"ep", ",", " ", "v2"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"p", " ", "=", " ", 
              RowBox[{"Select", "[", 
               RowBox[{"p", ",", " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"First", "[", "#", "]"}], "\[NotEqual]", " ", 
                  "index"}], "&"}]}], "]"}]}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"dPrint", "[", 
              RowBox[{"\"\<p=\>\"", ",", " ", "p"}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"setappend", "=", "True"}], ";", " ", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "p", "]"}], "<", "1"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{"firstpair", ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"v2", "=", 
                    RowBox[{"edge", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"p", "=", 
                    RowBox[{"Position", "[", 
                    RowBox[{"ep", ",", " ", "v2"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"p", " ", "=", " ", 
                    RowBox[{"Select", "[", 
                    RowBox[{"p", ",", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], "\[NotEqual]", " ", 
                    "index"}], "&"}]}], "]"}]}], ";"}], " ", 
                  "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"v2", "=", 
                    RowBox[{"sortedep", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"dPrint", "[", 
                    RowBox[{"\"\<revised v2=\>\"", ",", "v2"}], "]"}], ";", 
                   " ", "\[IndentingNewLine]", 
                   RowBox[{"dPrint", "[", 
                    RowBox[{"\"\<ep=\>\"", " ", ",", "ep"}], "]"}], ";", " ", 
                   "\[IndentingNewLine]", 
                   RowBox[{"p", "=", 
                    RowBox[{"Position", "[", 
                    RowBox[{"ep", ",", " ", "v2"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"dPrint", "[", 
                    RowBox[{"\"\<Revised p: \>\"", ",", " ", "p"}], "]"}], 
                   ";", "\[IndentingNewLine]", 
                   RowBox[{"setappend", "=", "False"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", " ", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", "p", "]"}], "<", "1"}], ",", " ", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Print", "[", 
                   RowBox[{"GraphPlot", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Rule", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}], "/@", 
                    "ep"}], ",", 
                    RowBox[{"VertexLabeling", "\[Rule]", "True"}]}], "]"}], 
                   "]"}]}], "\[IndentingNewLine]", "]"}], ";", " ", 
                "\[IndentingNewLine]", 
                RowBox[{"AbortIf", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", "p", "]"}], "<", "1"}], ",", " ", 
                  "\[IndentingNewLine]", 
                  RowBox[{"\"\<Error: SortCellEdges: Cell \>\"", "<>", 
                   RowBox[{"ToString", "[", 
                    RowBox[{"InputForm", "[", " ", "cell", "]"}], "]"}], "<>",
                    " ", "\"\< is unsortable. Edge Pairs: \>\"", "<>", 
                   RowBox[{"ToString", "[", 
                    RowBox[{"InputForm", "[", "ep", "]"}], "]"}]}]}], 
                 "]"}]}]}], " ", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{"Return", "[", "$Failed", "]"}], "*)"}], 
              "\[IndentingNewLine]", "]"}], ";", "  ", "\[IndentingNewLine]", 
             
             RowBox[{"firstpair", "=", "False"}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"dPrint", "[", 
              RowBox[{"\"\<p=\>\"", ",", " ", "p"}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"p", "=", 
              RowBox[{"First", "/@", "p"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"dPrint", "[", 
              RowBox[{"\"\<p=\>\"", ",", " ", "p"}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"edge", " ", "=", " ", 
              RowBox[{"ep", "[", 
               RowBox[{"[", 
                RowBox[{"p", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"dPrint", "[", 
              RowBox[{"\"\<edge=\>\"", ",", " ", "edge"}], "]"}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"While", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{"sortedep", ",", "edge"}], "]"}], " ", "\[Or]", " ", 
                
                RowBox[{"MemberQ", "[", 
                 RowBox[{"sortedep", ",", " ", 
                  RowBox[{"Reverse", "[", "edge", "]"}]}], "]"}]}], ",", " ", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"p", "=", 
                 RowBox[{"Rest", "[", "p", "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"dPrint", "[", 
                 RowBox[{"\"\<p=\>\"", ",", " ", "p"}], "]"}], ";", " ", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", "p", "]"}], "<", "1"}], ",", " ", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Print", "[", 
                   RowBox[{"GraphPlot", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Rule", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}], "/@", 
                    "ep"}], ",", 
                    RowBox[{"VertexLabeling", "\[Rule]", "True"}]}], "]"}], 
                   "]"}]}], "\[IndentingNewLine]", "]"}], ";", " ", 
                "\[IndentingNewLine]", 
                RowBox[{"AbortIf", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", "p", "]"}], "<", "1"}], ",", " ", 
                  "\[IndentingNewLine]", 
                  RowBox[{"\"\<Error: SortCellEdges: Cell \>\"", "<>", 
                   RowBox[{"ToString", "[", 
                    RowBox[{"InputForm", "[", " ", "cell", "]"}], "]"}], "<>",
                    " ", "\"\< is unsortable. Edge Pairs: \>\"", "<>", 
                   RowBox[{"ToString", "[", 
                    RowBox[{"InputForm", "[", "ep", "]"}], "]"}]}]}], "]"}], 
                " ", ";", "\[IndentingNewLine]", " ", 
                RowBox[{"edge", "=", 
                 RowBox[{"ep", "[", 
                  RowBox[{"[", 
                   RowBox[{"p", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ";", " ", 
                "\[IndentingNewLine]", 
                RowBox[{"dPrint", "[", 
                 RowBox[{"\"\<edge=\>\"", ",", " ", "edge"}], "]"}], ";"}]}], 
              " ", "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"edge", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "\[NotEqual]", " ", "v2"}], 
               ",", " ", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"edge", "=", 
                 RowBox[{"Reverse", "[", "edge", "]"}]}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{"setappend", ",", " ", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"sortedep", ",", " ", "edge"}], "]"}], ",", " ", 
               RowBox[{"PrependTo", "[", 
                RowBox[{"sortedep", ",", 
                 RowBox[{"Reverse", "[", "edge", "]"}]}], "]"}]}], "]"}], ";",
              " ", "\[IndentingNewLine]", 
             RowBox[{"dPrint", "[", 
              RowBox[{"\"\<sortedep: \>\"", ",", " ", "sortedep"}], "]"}], 
             ";", " ", "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"sortednums", ",", " ", 
               RowBox[{"p", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"dPrint", "[", 
              RowBox[{"\"\<sortednums: \>\"", ",", " ", "sortednums"}], "]"}],
              ";", " ", "\[IndentingNewLine]", 
             RowBox[{"index", " ", "=", " ", 
              RowBox[{"p", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"{", 
               RowBox[{
               "sortedep", ",", " ", "sortednums", ",", " ", "v2", ",", " ", 
                "p", ",", " ", "edge"}], "}"}], "]"}], ";"}], " ", "*)"}], 
           "\[IndentingNewLine]", " ", "\[IndentingNewLine]", "]"}], ";", " ",
           "\[IndentingNewLine]", 
          RowBox[{"sortednums", "=", 
           RowBox[{"cell", "[", 
            RowBox[{"[", "sortednums", "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<sortednums: \>\"", ",", " ", "sortednums"}], "]"}], 
          ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"lastver", " ", "=", " ", 
           RowBox[{"Last", "[", 
            RowBox[{"Last", "/@", "sortedep"}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"sortedep", " ", "=", " ", 
           RowBox[{"First", "/@", "sortedep"}]}], ";", " ", 
          "\[IndentingNewLine]", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"MemberQ", "[", 
              RowBox[{"sortedep", ",", "lastver"}], "]"}]}], ",", " ", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"sortedep", ",", " ", "lastver"}], "]"}]}], "]"}], ";", 
          " ", "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<sortedep: \>\"", ",", " ", "sortedep"}], "]"}], ";"}],
          " ", "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"sortednums", "=", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"sortedep", "=", 
           RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<Edges\>\"", "\[Rule]", " ", "sortednums"}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<Vertices\>\"", "\[Rule]", " ", "sortedep"}]}], 
         "\[IndentingNewLine]", "}"}], "]"}], ";"}]}], " ", 
     "\[IndentingNewLine]", " ", "\[IndentingNewLine]", "]"}]}], ";", " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SortCellEdges", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Expecting SortCellEdges[cell, edges], where cell={e1,e2,...} and \
edges={{v11,v12}, {v21, v22}, ...}\>\"", "]"}], ";", " ", 
      RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";"}], "  ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwdz11IU2EAxvEZClHWUFJvan0wosZaptMkEDo1s4WFSW4OtSjmmBJ5ygic
bQsTWm1NzI1JWFGukVvbUmfFFivkGIaRlmt+rNYHI9o8lRjdDJX2vBcPv7sH
/lvPNFc1rOJwOKLU4NHHe5rpgThFi82dsCB4wArbpfQz+Jn1BWB1+i0GKhyX
x2CyTDkJZ0KZH6FMTv+EFW0GFupMWYtQeDuDcz5l65wnDUbbtesgtdbIhUV2
Fw92m6N8yLYKhPBXma4AasclxbBBv3EvlJVo6Lqncarfwl6EgW87u76uxCmz
d9kGz520H27qSFB1rukKaPgxUNhpSFCb/+UUQVZVaG57lKCyxYMW6BeYemEw
amRg/8uecRib7pqCF0pDc1CUvikCaycaYzD3OkO06dcvwd+1NFF2SphvSVnj
PkicDFxSQeeXDxp49diSHg7+iRnglR3KHmj/6yVWLtd74A2n+wk8Ec4LQgdj
JYZHwhZ3ykw2QfwkKr8He0t8DhhtYtzQO2T1wMoJ/hBcfeeuD7LqUT98p6Fe
QLFuzRu4L22BKChWTMGsQy6isi80A9XdI7Ow/njed/K3xU3cv606DpNy6SJ8
fu1VEtpu1vA8KV/rd/FhduQ9cXa+SghNlpbd8MHZFjF8eL+DOMo1lUIdOyaB
5dwVKdREM47A7Ty/HC40Rk5DybBWBeedRqK6b3jDW3RIFTnwP+AInl0=
  
  "],ExpressionUUID->"2aa5358c-9195-4dd0-909d-71768756fb63"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["CellVertexNumbers", "Subsection",
 CellChangeTimes->{{3.448470445351214*^9, 3.448470446334359*^9}, 
   3.448472205187098*^9},ExpressionUUID->"d78be728-5cae-4d6b-b433-\
c75bdbdf71d4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CellVertexNumbers", "[", 
     RowBox[{
      RowBox[{"cell_", "?", "intListQ"}], ",", " ", "edges_"}], "]"}], ":=", 
    " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "f", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"f", "=", 
        RowBox[{"SortCellEdges", "[", 
         RowBox[{"cell", ",", " ", "edges"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"f", "===", "$Failed"}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<Error: CellVertexNumbers: Failure code from \
SortCellEdges.\>\"", "]"}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"\"\<Vertices\>\"", "/.", "f"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CellVertexNumbers", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cell__", "?", "intListQ"}], "}"}], ",", " ", "edges_"}], "]"}],
    ":=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"CellVertexNumbers", "[", 
      RowBox[{"#", ",", "edges"}], "]"}], "&"}], "/@", 
    RowBox[{"{", "cell", "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CellVertexNumbers", "[", 
     RowBox[{
      RowBox[{"tissue_", "?", "TissueQ"}], ",", " ", "cellNumber_"}], "]"}], ":=",
     " ", 
    RowBox[{"CellVertexNumbers", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"TissueCells", "[", "tissue", "]"}], "[", 
       RowBox[{"[", "cellNumber", "]"}], "]"}], ",", " ", 
      RowBox[{"TissueEdges", "[", "tissue", "]"}]}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CellVertexNumbers", "[", 
     RowBox[{"tissue_", "?", "TissueQ"}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"CellVertexNumbers", "[", 
       RowBox[{"tissue", ",", " ", "#"}], "]"}], "&"}], "/@", 
     RowBox[{"Range", "[", 
      RowBox[{"NTissueCells", "[", "tissue", "]"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CellVertexNumbers", "[", 
    RowBox[{
     RowBox[{"T_", "?", "DTissueQ"}], ",", "n_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"C", ",", "CN", ",", "T1", ",", "C1", ",", "n1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"C", "=", 
       RowBox[{"n", "/.", 
        RowBox[{"TissueCells", "[", "T", "]"}]}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"T1", "=", 
       RowBox[{"DTissue2Tissue", "[", "T", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"C1", "=", 
       RowBox[{"TissueCells", "[", "T1", "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"n1", "=", 
       RowBox[{"Position", "[", 
        RowBox[{"C1", ",", "C"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"ListQ", "[", "n1", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "n1", "]"}], "\[Equal]", "1"}], ",", 
          RowBox[{"n1", "=", 
           RowBox[{"First", "[", "n1", "]"}]}], ",", 
          RowBox[{"Break", "[", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ListQ", "[", "n1", "]"}], ",", " ", 
        RowBox[{"Return", "[", 
         RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"CellVertexNumbers", "[", 
       RowBox[{"T1", ",", "n1"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CellVertexNumbers", "[", 
   RowBox[{"T_", "?", "DTissueQ"}], "]"}], ":=", " ", 
  RowBox[{"CellVertexNumbers", "[", 
   RowBox[{"DTissue2Tissue", "[", "T", "]"}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.448470447765112*^9, 3.44847044881108*^9}, {
  3.448470542253583*^9, 3.448470590655803*^9}, {3.448470694265166*^9, 
  3.448470747143012*^9}, {3.44847220010453*^9, 3.448472204194492*^9}, {
  3.448474093394727*^9, 3.448474129014023*^9}, {3.448547833663097*^9, 
  3.448547943048004*^9}, {3.4510530010405607`*^9, 3.451053083420238*^9}, {
  3.451053117652341*^9, 3.4510531223355227`*^9}, {3.451053199370446*^9, 
  3.4510532102490063`*^9}, {3.4510537390487127`*^9, 3.451053747387129*^9}, {
  3.5466997458855343`*^9, 3.546699951321526*^9}, {3.546700032622799*^9, 
  3.5467001395623417`*^9}, {3.546700203100032*^9, 3.546700204387714*^9}, {
  3.546700234892159*^9, 3.546700266400766*^9}, {3.5471311634990664`*^9, 
  3.5471312235433397`*^9}},ExpressionUUID->"9c62b4c3-6e75-410b-abe9-\
f7c7f4439d00"]
}, Closed]],

Cell[CellGroupData[{

Cell["CellVertexCoordinates", "Subsection",
 CellChangeTimes->{{3.448474205700951*^9, 
  3.448474208612415*^9}},ExpressionUUID->"5a0c7a9e-f594-4c8a-a7b9-\
38d6a163b6b3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CellVertexCoordinates", "[", 
    RowBox[{
     RowBox[{"cell_", "?", "intListQ"}], ",", " ", "edges_", ",", " ", 
     "vertices_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "v", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"v", "=", 
       RowBox[{"CellVertexNumbers", "[", 
        RowBox[{"cell", ",", " ", "edges"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"v", "===", "$Failed"}], ",", " ", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<Error: CellVertexCoordinates: Failure code returned from \
CellVertexNumbers.\>\"", "]"}], ";", " ", 
         RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{"vertices", "[", 
        RowBox[{"[", "v", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "v", "]"}], ";"}]}], " ", "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CellVertexCoordinates", "[", 
    RowBox[{
     RowBox[{"tiss_", "?", "TissueQ"}], ",", " ", "n_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "v", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"n", ">", 
          RowBox[{"NTissueCells", "[", "tiss", "]"}]}], " ", "\[Or]", " ", 
         RowBox[{"n", "<", "1"}]}], ",", " ", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Error: CellVertexCoordinates: nonexistent cell number \>\"", 
           ",", " ", "n", ",", " ", "\"\< requested.\>\""}], "]"}], ";", " ", 
         
         RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{"CellVertexCoordinates", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"TissueCells", "[", "tiss", "]"}], "[", 
          RowBox[{"[", "n", "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"TissueEdges", "[", "tiss", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TissueVertices", "[", "tiss", "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"v", "===", "$Failed"}], ",", " ", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Error: CellVertexCoordinates: Failure code returned from \
CellVertexNumbers for cell \>\"", ",", "n"}], "]"}], ";", " ", 
         RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "v", "]"}], ";"}]}], " ", "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CellVertexCoordinates", "[", 
     RowBox[{"tiss_", "?", "TissueQ"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"v", ",", "e", ",", " ", "c", ",", " ", "n", ",", " ", "cvc"}],
        "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"NTissueCells", "[", "tiss", "]"}]}], " ", ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"v", "=", 
        RowBox[{"TissueVertices", "[", "tiss", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"e", "=", 
        RowBox[{"TissueEdges", "[", "tiss", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"c", "=", 
        RowBox[{"TissueCells", "[", "tiss", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"cvc", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"CellVertexCoordinates", "[", 
           RowBox[{"#", ",", " ", "e", ",", " ", "v"}], "]"}], "&"}], "/@", 
         "c"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "cvc", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CellVertexCoordinates", "[", 
     RowBox[{
      RowBox[{"DT_", "?", "DTissueQ"}], ",", 
      RowBox[{"i_", "?", "IntegerQ"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"T", ",", "c"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"c", "=", 
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"First", "/@", 
           RowBox[{"TissueCells", "[", "DT", "]"}]}], ",", "i"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"c", "\[Equal]", 
          RowBox[{"{", "}"}]}], ",", " ", 
         RowBox[{"c", "=", "0"}], ",", " ", 
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{"ListQ", "[", "c", "]"}], ",", " ", 
           RowBox[{"c", "=", 
            RowBox[{"First", "[", "c", "]"}]}]}], "]"}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"CellVertexCoordinates", "[", 
        RowBox[{
         RowBox[{"DTissue2Tissue", "[", "DT", "]"}], ",", "c"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CellVertexCoordinates", "[", 
     RowBox[{"DT_", "?", "DTissueQ"}], "]"}], ":=", " ", 
    RowBox[{"CellVertexCoordinates", "[", 
     RowBox[{"DTissue2Tissue", "[", "DT", "]"}], "]"}]}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CellVertexCoordinates", "[", "x__", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Expecting CellVertexCoordinates[(d)tissue, (number)]\>\"", "]"}], 
      ";", 
      RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.448474210237874*^9, 3.4484743113222*^9}, {
   3.448474358890733*^9, 3.448474420188217*^9}, 3.448474735518409*^9, {
   3.448474849742812*^9, 3.448474906659935*^9}, {3.44847494294392*^9, 
   3.448475188140663*^9}, {3.4510531516718607`*^9, 3.451053193459057*^9}, {
   3.451053225060594*^9, 3.451053296854165*^9}, {3.4510534586536207`*^9, 
   3.451053505922884*^9}, {3.4510536763092327`*^9, 3.451053684791925*^9}, 
   3.451053767531596*^9, {3.45105379791945*^9, 3.451053801680591*^9}, {
   3.547142483397028*^9, 3.5471426064298143`*^9}, {3.5471462262862988`*^9, 
   3.547146246207069*^9}, {3.5471462808387127`*^9, 3.547146359426717*^9}, {
   3.5471464594576263`*^9, 3.5471464738016577`*^9}, {3.54714693352619*^9, 
   3.547146957419311*^9}},ExpressionUUID->"bbc59df5-4f0b-4197-92b2-\
cc2730316a1e"]
}, Closed]],

Cell[CellGroupData[{

Cell["Vertices_, Cells_, EdgesOnBoundary", "Subsection",
 CellChangeTimes->{{3.448494397300658*^9, 3.448494411092105*^9}, {
  3.448494498533273*^9, 3.448494503316756*^9}, {3.448495711061532*^9, 
  3.448495725539909*^9}},ExpressionUUID->"a0a9bed5-ab5d-439e-a5f1-\
7c96c1cd1133"],

Cell["\<\
An edge is \"on the boundary\" if it is only contained in one cell.
A vertex is \"on the boundary\" if it is a member of an edge that is \"on the \
boundary\"
A cell is \"on the boundary\" if it contains an edge that is \"on the \
boundary\"\
\>", "Text",
 CellChangeTimes->{{3.448494420581146*^9, 3.448494477196818*^9}, {
  3.448494507241483*^9, 3.448494521644791*^9}, {3.448495740600079*^9, 
  3.448495766816794*^9}, {3.448505275854307*^9, 
  3.448505286389057*^9}},ExpressionUUID->"5a43ad5f-872b-4001-b23e-\
7923703ab1de"],

Cell[CellGroupData[{

Cell["EdgesOnBoundary", "Subsubsection",
 CellChangeTimes->{{3.44849568395759*^9, 
  3.448495686195568*^9}},ExpressionUUID->"6bff5257-c498-4407-a5fe-\
1e44099bcaa4"],

Cell["\<\
Return a list of Edges that are on the Boundary. The edges are sorted in \
order around the boundary.
v13: sorting is turned off because the sorting algorithm fails if there is \
more than one distinct component to the edges. (E.g., a hole in the tissue!). \
\>", "Text",
 CellChangeTimes->{{3.448495091336958*^9, 3.448495097000088*^9}, {
  3.448557484824128*^9, 3.448557492837011*^9}, {3.45407197181273*^9, 
  3.4540720076632023`*^9}},ExpressionUUID->"783d59a0-6b45-4da5-8cc9-\
f310949a350d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"EdgesOnBoundary", "[", 
    RowBox[{"tissue_", "?", "TissueQ"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ne", ",", " ", "c", ",", "e", ",", "  ", "keep", ",", " ", 
       "edgenums"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"e", "=", 
       RowBox[{"TissueEdges", "[", "tissue", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ne", "=", 
       RowBox[{"Length", "[", "e", "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"TissueCells", "[", "tissue", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"edgenums", "=", 
       RowBox[{"Range", "[", "ne", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"keep", " ", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Length", "[", "#", "]"}], "\[Equal]", "1"}], ")"}], "&"}],
         "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"c", ",", "#", ",", " ", "2"}], "]"}], "&"}], "/@", 
          "edgenums"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"keep", "=", 
       RowBox[{"Pick", "[", 
        RowBox[{"edgenums", ",", " ", "keep"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Print", "[", "keep", "]"}], ";", " ", "\[IndentingNewLine]", 
        
        RowBox[{"keep", "=", 
         RowBox[{"\"\<Edges\>\"", "/.", 
          RowBox[{"SortCellEdges", "[", 
           RowBox[{"keep", ",", " ", "e"}], "]"}]}]}], ";"}], " ", 
       "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "keep", "]"}], ";"}]}], " ", 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EdgesOnBoundary", "[", 
    RowBox[{"DT_", "?", "DTissueQ"}], "]"}], ":=", " ", 
   RowBox[{"EdgesOnBoundary", "[", 
    RowBox[{"DTissue2Tissue", "[", "DT", "]"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.448494546588526*^9, 3.448494644440431*^9}, {
  3.448494688046802*^9, 3.44849489725983*^9}, {3.448494959257452*^9, 
  3.448495075479431*^9}, {3.448557321234789*^9, 3.448557459000079*^9}, {
  3.454071801723605*^9, 3.45407180391405*^9}, {3.454071852964301*^9, 
  3.454071880508647*^9}, {3.4540719214941063`*^9, 3.454071928188541*^9}, {
  3.454072012016514*^9, 3.454072015048827*^9}, {3.548516960964679*^9, 
  3.548516980456956*^9}},ExpressionUUID->"63f16654-0ee0-440a-ba04-\
9f3cd05ed87a"]
}, Closed]],

Cell[CellGroupData[{

Cell["EdgesNotOnBoundary", "Subsubsection",
 CellChangeTimes->{{3.448705209374878*^9, 
  3.448705216432842*^9}},ExpressionUUID->"baae1198-78dc-49cc-864c-\
2407efb279b1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"EdgesNotOnBoundary", "[", 
    RowBox[{"tissue_", "?", "TissueQ"}], "]"}], ":=", 
   RowBox[{"Complement", "[", 
    RowBox[{
     RowBox[{"Range", "[", 
      RowBox[{"NTissueEdges", "[", "tissue", "]"}], "]"}], ",", " ", 
     RowBox[{"EdgesOnBoundary", "[", "tissue", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EdgesNotOnBoundary", "[", 
    RowBox[{"DT_", "?", "DTissueQ"}], "]"}], ":=", " ", 
   RowBox[{"EdgesNotOnBoundary", "[", 
    RowBox[{"DTissue2Tissue", "[", "DT", "]"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.448705225712159*^9, 3.44870528544133*^9}, {
  3.548517035586233*^9, 
  3.5485170590576963`*^9}},ExpressionUUID->"e4c46f85-c2b9-4e47-81b4-\
0cd2d29c12bf"]
}, Closed]],

Cell[CellGroupData[{

Cell["VerticesOnBoundary", "Subsubsection",
 CellChangeTimes->{{3.448495690808994*^9, 
  3.448495694355815*^9}},ExpressionUUID->"0a57cf57-bafe-4fd9-af07-\
21ba862c6edf"],

Cell["\<\
Return a list of Vertices that are on the boundary. The vertices are sorted \
(in order around the edge).\
\>", "Text",
 CellChangeTimes->{{3.448495121840539*^9, 3.448495130112516*^9}, {
  3.448557264123379*^9, 
  3.448557275442698*^9}},ExpressionUUID->"e17c6602-eed4-4c61-9d1e-\
8aac2c5ed32b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"VerticesOnBoundary", "[", 
    RowBox[{"tissue_", "?", "TissueQ"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"be", ",", " ", "e"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"be", "=", 
       RowBox[{"EdgesOnBoundary", "[", "tissue", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"e", "=", 
       RowBox[{"TissueEdges", "[", "tissue", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Union", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"e", "[", 
           RowBox[{"[", "be", "]"}], "]"}], "]"}], "]"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<Vertices\>\"", "/.", 
        RowBox[{"SortCellEdges", "[", 
         RowBox[{"be", ",", " ", "e"}], "]"}]}], "\[IndentingNewLine]", "]"}],
       ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"VerticesOnBoundary", "[", 
     RowBox[{"DT_", "?", "DTissueQ"}], "]"}], ":=", " ", 
    RowBox[{"VerticesOnBoundary", "[", 
     RowBox[{"DTissue2Tissue", "[", "DT", "]"}], "]"}]}], ";"}], 
  " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.448495131527074*^9, 3.44849528359337*^9}, {
  3.448495519106284*^9, 3.448495525354342*^9}, {3.448557201739568*^9, 
  3.448557240643723*^9}, {3.5485170005754967`*^9, 
  3.548517020103936*^9}},ExpressionUUID->"e87d2c9e-0462-4d1b-b253-\
cb9ac53d07ba"]
}, Closed]],

Cell[CellGroupData[{

Cell["VerticesNotOnBoundary", "Subsubsection",
 CellChangeTimes->{{3.448705427840108*^9, 
  3.448705430751859*^9}},ExpressionUUID->"4c2138d2-ddd7-465e-86c0-\
43189e55dfb5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"VerticesNotOnBoundary", "[", 
     RowBox[{"tissue_", "?", "TissueQ"}], "]"}], ":=", " ", 
    RowBox[{"Complement", "[", 
     RowBox[{
      RowBox[{"Range", "[", 
       RowBox[{"NTissueVertices", "[", "tissue", "]"}], "]"}], ",", " ", 
      RowBox[{"VerticesOnBoundary", "[", "tissue", "]"}]}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VerticesNotOnBoundary", "[", 
    RowBox[{"DT_", "?", "DTissueQ"}], "]"}], ":=", " ", 
   RowBox[{"VerticesNotOnBoundary", "[", 
    RowBox[{"DTissue2Tissue", "[", "DT", "]"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.448705431861597*^9, 3.448705453730614*^9}, {
  3.548517077576625*^9, 
  3.548517097761505*^9}},ExpressionUUID->"16243632-3f94-44a0-bf76-\
0e935e0a0513"]
}, Closed]],

Cell[CellGroupData[{

Cell["CellsOnBoundary", "Subsubsection",
 CellChangeTimes->{{3.448495700428255*^9, 
  3.44849570653188*^9}},ExpressionUUID->"2aa46966-ef5c-4604-b977-\
4c68bf7d3c35"],

Cell["Return a list of Cells that are on the boundary", "Text",
 CellChangeTimes->{{3.448495287714011*^9, 
  3.448495292301738*^9}},ExpressionUUID->"f4350397-4093-45e8-a61b-\
3f7c4c1a9742"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CellsOnBoundary", "[", 
     RowBox[{"tissue_", "?", "TissueQ"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"be", ",", " ", "c", ",", " ", "keep"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"be", "=", 
        RowBox[{"EdgesOnBoundary", "[", "tissue", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"c", "=", 
        RowBox[{"TissueCells", "[", "tissue", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"keep", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Length", "[", "#", "]"}], ">", "0"}], ")"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Intersection", "[", 
             RowBox[{"be", ",", " ", "#"}], "]"}], "&"}], "/@", "c"}], 
          ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"Pick", "[", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "c", "]"}], "]"}], ",", " ", "keep"}], 
         "]"}], "]"}], ";"}]}], " ", "\[IndentingNewLine]", "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CellsOnBoundary", "[", 
     RowBox[{"DT_", "?", "DTissueQ"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"T", ",", "bc", ",", "cn", ",", " ", "s2d", ",", "nc"}], "}"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"bc", "=", 
        RowBox[{"CellsOnBoundary", "[", 
         RowBox[{"DTissue2Tissue", "[", "DT", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"cn", "=", 
        RowBox[{"First", "/@", 
         RowBox[{"TissueCells", "[", "DT", "]"}]}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"nc", " ", "=", " ", 
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", "cn", "]"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"s2d", " ", "=", " ", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", 
          RowBox[{"{", 
           RowBox[{"nc", ",", "cn"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{"bc", "/.", "s2d"}], ")"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CellsOnBoudary", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", "\"\<Expecting CellsOnBoundary[tissue]\>\"", "]"}], ";", 
      RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.448495293311065*^9, 3.44849532536676*^9}, {
  3.448495364853854*^9, 3.448495566553418*^9}, {3.4895993707388268`*^9, 
  3.489599386420327*^9}, {3.548516913911923*^9, 3.548516937402267*^9}, {
  3.5485172060340347`*^9, 3.548517254298017*^9}, {3.54851729421369*^9, 
  3.548517300931573*^9}, {3.548517351502153*^9, 
  3.5485174016015997`*^9}},ExpressionUUID->"916d3514-3da0-492c-b9f8-\
f8baa2a84396"]
}, Open  ]],

Cell[CellGroupData[{

Cell["InteriorCells", "Subsubsection",
 CellChangeTimes->{{3.489599389643078*^9, 
  3.4895993913945436`*^9}},ExpressionUUID->"481d3c32-fc81-419a-87e0-\
b18b13e4fcb5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"InteriorCells", "[", 
    RowBox[{"tissue_", "?", "TissueQ"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nc", ",", "bc", ",", "ic"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"bc", "=", 
       RowBox[{"CellsOnBoundary", "[", "tissue", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nc", "=", 
       RowBox[{"NTissueCells", "[", "tissue", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"Range", "[", "nc", "]"}], ",", " ", "bc"}], "]"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InteriorCells", "[", 
   RowBox[{"DT_", "?", "DTissueQ"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"bc", ",", "cn"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"bc", "=", 
      RowBox[{"CellsOnBoundary", "[", "DT", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"cn", " ", "=", " ", 
      RowBox[{"First", "/@", 
       RowBox[{"TissueCells", "[", "DT", "]"}]}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"Complement", "[", 
      RowBox[{"cn", ",", "bc"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InteriorCells", "[", "x___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Print", "[", "\"\<Expecting InteriorCells[tissue]\>\"", "]"}], 
     ";", 
     RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.489599396302741*^9, 3.4895994800962353`*^9}, {
  3.548517119116434*^9, 3.548517174173869*^9}, {3.548517419457893*^9, 
  3.54851747321074*^9}},ExpressionUUID->"8272f387-72b6-4cf4-b17c-\
d8f52af4201c"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["DivideEdge(s)", "Subsection",
 CellChangeTimes->{{3.449080317698165*^9, 3.449080338636972*^9}, {
  3.449156018595079*^9, 
  3.449156019367492*^9}},ExpressionUUID->"a93de186-c78a-4e4e-a1f9-\
ba68528b110a"],

Cell["\<\
Note that DivideEdge might leave the sequence of edge numbers in a cell out \
of order\
\>", "Text",
 CellChangeTimes->{{3.4566941166650476`*^9, 
  3.4566941277085953`*^9}},ExpressionUUID->"baf896a3-b22f-416c-968c-\
c80b7c0ae061"],

Cell[CellGroupData[{

Cell["\<\
DivideEdges[tissue, {edgeNumbers,...}, {segments,...}, random]\
\>", "Subsubsection",
 CellChangeTimes->{{3.456590024090959*^9, 
  3.456590043792959*^9}},ExpressionUUID->"c86bde1d-c46e-4a9d-811c-\
84394012a0ab"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DivideEdges", "[", 
     RowBox[{
      RowBox[{"tissue_", "?", "TissueQ"}], ",", " ", 
      RowBox[{"edgeNumbers_", "?", "intListQ"}], ",", "\[IndentingNewLine]", 
      RowBox[{"segments_", "?", "IntegerQ"}], ",", " ", 
      RowBox[{"randomness_:", "0"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"edges2divide", ",", " ", "next", ",", " ", "new"}], "}"}], 
      ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"edges2divide", "=", "edgeNumbers"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"new", "=", "tissue"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "edges2divide", "]"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"next", "=", 
           RowBox[{"First", "[", "edges2divide", "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"edges2divide", "=", 
           RowBox[{"Rest", "[", "edges2divide", "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"new", " ", "=", " ", 
           RowBox[{"DivideEdge", "[", 
            RowBox[{
            "new", ",", " ", "next", ",", " ", "segments", ",", " ", 
             "randomness"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
       ";", " ", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "new", "]"}], ";"}]}], " ", 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DivideEdges", "[", 
     RowBox[{
      RowBox[{"tissue_", "?", "TissueQ"}], ",", 
      RowBox[{"segments_", "?", "IntegerQ"}], ",", " ", 
      RowBox[{"randomness_:", "0"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "n", "}"}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"NTissueEdges", "[", "tissue", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"DivideEdges", "[", 
         RowBox[{"tissue", ",", "  ", 
          RowBox[{"Range", "[", "n", "]"}], ",", " ", "segments", ",", " ", 
          "randomness"}], "]"}], "]"}]}]}], "]"}]}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DivideEdges", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Error: expecting DivideEdges[tissue, segments, random] or \
DivideEdges[tissue, {n1,n2, ...}, segments, random]\>\"", "]"}], ";", " ", 
      "$Failed"}], ")"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.449154388742048*^9, 3.449154423099053*^9}, {
  3.449154459117134*^9, 3.449154678568732*^9}, {3.449154737365021*^9, 
  3.44915481116217*^9}, {3.449155932487581*^9, 
  3.449155971805858*^9}},ExpressionUUID->"0fbe2728-2171-46f5-be0e-\
e561a46836f9"]
}, Closed]],

Cell[CellGroupData[{

Cell["DIvideEdge[tissue, edgeNumber, parts, random]", "Subsubsection",
 CellChangeTimes->{{3.4565900092848663`*^9, 
  3.45659001793191*^9}},ExpressionUUID->"27542171-e4d8-4c19-b005-\
5fe6214aa418"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DivideEdge", "[", 
     RowBox[{
      RowBox[{"tissue_", "?", "TissueQ"}], ",", " ", 
      RowBox[{"edgeNumber_", "?", "IntegerQ"}], ",", "\[IndentingNewLine]", 
      RowBox[{"parts_", "?", "IntegerQ"}], ",", " ", 
      RowBox[{"random_:", "0"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "r", ",", " ", "e", ",", " ", "ne", ",", "nv", ",", " ", "i", ",", " ",
         "j", ",", "v", ",", " ", "c", ",", "  ", "vi", ",", " ", "vj", ",", 
        " ", 
        RowBox[{"dbg", "=", "False"}], ",", " ", "dPrint", ",", " ", "vnew", 
        ",", " ", "newEdgeNumbers", ",", " ", "newEdges", ",", " ", "length", 
        ",", " ", "randoms", ",", " ", "q"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"dPrint", "[", "x___", "]"}], ":=", " ", 
        RowBox[{"If", "[", 
         RowBox[{"dbg", ",", " ", 
          RowBox[{"Print", "[", "x", "]"}]}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"limit", " ", "randomization", " ", "to", " ", "25", "%"}], 
        " ", "*)"}], " ", "\[IndentingNewLine]", 
       RowBox[{"r", "=", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{"0", ",", " ", "random"}], "]"}], ",", " ", ".25"}], 
         "]"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"r", "\[NotEqual]", " ", "random"}], ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Warning: DivideEdge: random must be in [0,.25]; value used:  \
\>\"", ",", " ", "r"}], "]"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"check", " ", "validity", " ", "of", " ", "input"}], " ", 
        "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"e", "=", 
        RowBox[{"TissueEdges", "[", "tissue", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"ne", " ", "=", " ", 
        RowBox[{"Length", "[", "e", "]"}]}], ";", " ", "\[IndentingNewLine]", 
       
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"edgeNumber", "<", "1"}], " ", "\[Or]", " ", 
          RowBox[{"edgeNumber", " ", ">", " ", "ne"}]}], ",", " ", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Error: DivideEdge: nonexistent edge \>\"", ",", " ", 
            "edgeNumber", ",", "\"\< requested. Must be between 1 and \>\"", 
            ",", " ", "ne"}], "]"}], ";", " ", 
          RowBox[{"Return", "[", "tissue", "]"}]}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"parts", "<", "2"}], ",", " ", 
         RowBox[{"Return", "[", "tissue", "]"}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"input", " ", "is", " ", "all", " ", "valid"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "j"}], "}"}], " ", "=", " ", 
        RowBox[{"e", "[", 
         RowBox[{"[", "edgeNumber", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"v", "=", 
        RowBox[{"TissueVertices", "[", "tissue", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"nv", "=", 
        RowBox[{"Length", "[", "v", "]"}]}], ";", " ", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"{", 
         RowBox[{"vi", ",", "vj"}], "}"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
          RowBox[{"v", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"vnew", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"vi", " ", "+", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1.0", "*", 
               RowBox[{"#", "/", "parts"}]}], ")"}], 
             RowBox[{"(", 
              RowBox[{"vj", "-", "vi"}], ")"}]}]}], ")"}], "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"1", ",", " ", 
           RowBox[{"parts", "-", "1"}]}], "]"}]}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"and", " ", "randomness"}], " ", "*)"}], " ", 
       "\[IndentingNewLine]", 
       RowBox[{"length", " ", "=", " ", 
        RowBox[{
         RowBox[{"distance", "[", 
          RowBox[{"vi", ",", "vj"}], "]"}], "*", 
         RowBox[{"(", 
          RowBox[{"1.0", "/", "parts"}], ")"}]}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"randoms", " ", "=", " ", 
        RowBox[{"length", "*", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"RandomReal", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "r"}], ",", "r"}], "}"}], "]"}], ",", " ", 
             RowBox[{"RandomReal", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "r"}], ",", "r"}], "}"}], "]"}]}], "}"}], ",", 
           " ", 
           RowBox[{"{", 
            RowBox[{"parts", "-", "1"}], "}"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"vnew", " ", "=", " ", 
        RowBox[{"vnew", "+", "randoms"}]}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"v", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"v", ",", " ", "vnew"}], "]"}]}], ";", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"newEdgeNumbers", "=", 
        RowBox[{"Range", "[", 
         RowBox[{
          RowBox[{"ne", "+", "1"}], ",", " ", 
          RowBox[{"ne", "+", "parts"}]}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"newEdges", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"i", ",", " ", 
              RowBox[{"Range", "[", 
               RowBox[{
                RowBox[{"nv", "+", "1"}], ",", " ", 
                RowBox[{"nv", "+", "parts", "-", "1"}]}], "]"}]}], "}"}], 
            "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Range", "[", 
               RowBox[{
                RowBox[{"nv", "+", "1"}], ",", " ", 
                RowBox[{"nv", "+", "parts", "-", "1"}]}], "]"}], ",", " ", 
              "j"}], "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"e", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"e", ",", " ", "newEdges"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"c", "=", 
        RowBox[{"Flatten", "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"TissueCells", "[", "tissue", "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{"edgeNumber", "\[Rule]", " ", "newEdgeNumbers"}], "}"}]}],
           ")"}]}]}], " ", ";", "\[IndentingNewLine]", 
       RowBox[{"c", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\"\<Edges\>\"", "/.", "#"}], ")"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"SortCellEdges", "[", 
             RowBox[{"#", ",", " ", "e"}], "]"}], "&"}], "/@", "c"}], 
          ")"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<{i,j}: \>\"", ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", "j"}], "}"}], ",", " ", "\"\<\\n{vi,vj}:\>\"", 
         ",", " ", 
         RowBox[{"{", 
          RowBox[{"vi", ",", "vj"}], "}"}], ",", " ", "\[IndentingNewLine]", 
         "\"\<\\nrandoms:\>\"", ",", " ", "randoms", ",", "\"\<\\nvnew=\>\"", 
         ",", " ", "vnew", ",", " ", "\"\<\\nv (revised):\>\"", ",", " ", "v",
          ",", " ", "\"\<\\nnewEdgeNumbers:\>\"", ",", " ", "newEdgeNumbers", 
         ",", "\"\<\\nnewEdges:\>\"", ",", " ", "newEdges", ",", " ", 
         "\"\<\\ne (revised):\>\"", ",", " ", "e", ",", " ", 
         "\"\<\\nc (revised):\>\"", ",", " ", "c"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"q", "=", 
        RowBox[{"Tissue", "[", 
         RowBox[{"v", ",", "e", ",", "c"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<Undangling old edge \>\"", ",", " ", "edgeNumber"}], 
        "]"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"q", "=", 
        RowBox[{"UndangleEdge", "[", 
         RowBox[{"q", ",", " ", "edgeNumber"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Warning: Edge \>\"", ",", " ", "#", ",", " ", 
           "\"\< is dangling and should be removed.\>\""}], "]"}], "&"}], "/@", 
        RowBox[{"DanglingEdges", "[", "q", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "q", "]"}], ";"}]}], " ", "\[IndentingNewLine]",
      "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.449080390713366*^9, 3.449080504849089*^9}, {
   3.449080535637354*^9, 3.449080795141175*^9}, {3.449080826074785*^9, 
   3.449080855098211*^9}, {3.44908088843978*^9, 3.449080913739305*^9}, {
   3.449081027366533*^9, 3.449081115717975*^9}, {3.449081147519193*^9, 
   3.449081287094022*^9}, {3.449081391547851*^9, 3.449081407819792*^9}, {
   3.449081493128637*^9, 3.449081493550983*^9}, {3.449081592235962*^9, 
   3.449081620799853*^9}, {3.449081689203528*^9, 3.449081752246945*^9}, {
   3.449082107690936*^9, 3.449082189608807*^9}, {3.449082339508616*^9, 
   3.449082442663368*^9}, {3.449082498967788*^9, 3.449082627579288*^9}, {
   3.449082799684571*^9, 3.449083065968765*^9}, {3.449083104389652*^9, 
   3.449083126158927*^9}, {3.449084189100581*^9, 3.449084189966392*^9}, {
   3.449155085844756*^9, 3.449155124237536*^9}, {3.449155750039218*^9, 
   3.449155804015081*^9}, 3.449155836291107*^9, 
   3.456591098882118*^9},ExpressionUUID->"df9bc658-b212-441f-b5d7-\
5c4c7275eb35"]
}, Closed]],

Cell[CellGroupData[{

Cell["DivideEdge[tissue, number, {x,y}]", "Subsubsection",
 CellChangeTimes->{{3.456591068664865*^9, 
  3.456591076887341*^9}},ExpressionUUID->"8dd6f298-f94e-494b-a7fa-\
39362ed67b2e"],

Cell["\<\
Divide a specified edge at a specific location WITHOUT doing any topological \
checking.\[LineSeparator]this version added 2.1.\[Alpha].3 7.14.09\
\>", "Text",
 CellChangeTimes->{{3.456591579704121*^9, 3.456591602034935*^9}, {
  3.4565918677958813`*^9, 
  3.456591877551916*^9}},ExpressionUUID->"19286b87-5807-4561-afee-\
712fa6054384"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DivideEdge", "[", 
    RowBox[{
     RowBox[{"tissue_", "?", "TissueQ"}], ",", " ", 
     RowBox[{"edgeNumber_", "?", "IntegerQ"}], ",", "  ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x_", "?", "NumericQ"}], ",", " ", 
       RowBox[{"y_", "?", "NumericQ"}]}], "}"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "v", ",", "e", ",", "c", ",", "ne", ",", " ", "v1", ",", " ", "v2", ",",
        "e1", ",", " ", "e2", ",", "  ", "nv", ",", " ", "q"}], "}"}], ",", 
     " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"e", "=", 
       RowBox[{"TissueEdges", "[", "tissue", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ne", "=", 
       RowBox[{"Length", "[", "e", "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"edgeNumber", ">", "ne"}], " ", "\[Or]", " ", 
         RowBox[{"edgeNumber", "<", "1"}]}], ",", " ", "\[IndentingNewLine]", 
        
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Error: DivideEdge: requested edge \>\"", ",", " ", 
           "edgeNumber", ",", "\"\< does not exist.\>\""}], "]"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "tissue", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"add", " ", "the", " ", "new", " ", "vertex"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{"TissueVertices", "[", "tissue", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"v", ",", " ", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"nv", " ", "=", " ", 
       RowBox[{"Length", "[", "v", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"TissueCells", "[", "tissue", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"add", " ", "new", " ", "edge", " ", "at", " ", "end"}], ",", 
        " ", 
        RowBox[{"and", " ", "replace", " ", "old", " ", "edge"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"v1", ",", "v2"}], ")"}], " ", "--"}], ">", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"v1", ",", " ", "ne"}], ")"}], " ", "+", " ", 
         RowBox[{"(", 
          RowBox[{"ne", ",", " ", "v2"}], ")"}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "need", " ", "to", " ", "keep", " ", "each", " ", "edge", " ", 
         "sorted", " ", "with", " ", "v1"}], " ", "<", " ", "v2"}], " ", 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v1", ",", " ", "v2"}], "}"}], " ", "=", " ", 
       RowBox[{"e", "[", 
        RowBox[{"[", "edgeNumber", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"e1", "=", 
       RowBox[{"{", 
        RowBox[{"v1", ",", " ", "nv"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"e2", "=", 
       RowBox[{"{", 
        RowBox[{"v2", ",", " ", "nv"}], "}"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"e", "=", 
       RowBox[{"ReplacePart", "[", 
        RowBox[{"e", ",", " ", 
         RowBox[{"edgeNumber", "\[Rule]", " ", "e1"}]}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"e", ",", " ", "e2"}], "]"}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"fix", " ", "cells"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"c", " ", "=", " ", 
       RowBox[{"c", "/.", 
        RowBox[{"{", 
         RowBox[{"edgeNumber", "\[Rule]", " ", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"{", 
            RowBox[{"edgeNumber", ",", " ", 
             RowBox[{"ne", "+", "1"}]}], "}"}]}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"q", "=", 
       RowBox[{"Tissue", "[", 
        RowBox[{"v", ",", "e", ",", "c"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "q", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.456591023308219*^9, 3.456591055406097*^9}, {
  3.456591142250621*^9, 3.456591517701386*^9}, {3.456849667931212*^9, 
  3.456849726221826*^9}},ExpressionUUID->"aebbf969-99b8-44c3-821d-\
316a65799af8"]
}, Closed]],

Cell[CellGroupData[{

Cell["DivideEdger[error]", "Subsubsection",
 CellChangeTimes->{{3.456591104756816*^9, 
  3.4565911125873528`*^9}},ExpressionUUID->"6a636bab-5b6f-4e21-923a-\
63fcfe93b439"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DivideEdge", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Error: Expecting DivideEdge[tissue, edge number, parts, random] \
or \\nDivideEdge[tissue, edge number, {x,y}]\\ninstead of \\n\>\"", ",", 
        RowBox[{"{", "x", "}"}]}], "]"}], ";", " ", "$Failed"}], ")"}]}], 
   ";"}], " "}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.456591121901326*^9, 3.456591134831903*^9}, {
  3.4565920700868483`*^9, 
  3.456592099185835*^9}},ExpressionUUID->"cf8c2119-f47a-41dc-99f0-\
d8c433a644d8"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["MergeEdges", "Subsection",
 CellChangeTimes->{{3.4566928075874662`*^9, 3.4566928089017363`*^9}, 
   3.456692886810318*^9},ExpressionUUID->"188ddb0c-021d-4727-96a3-\
e1ac8e5ac6ad"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MergeEdges", "[", 
     RowBox[{
      RowBox[{"tissue_", "?", "TissueQ"}], ",", " ", 
      RowBox[{"e1_", "?", "IntegerQ"}], ",", " ", 
      RowBox[{"e2_", "?", "IntegerQ"}], ",", " ", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "v", ",", "e", ",", "c", ",", " ", "tnew", ",", " ", "edge1", ",", " ",
         "edge2", ",", "ne", ",", " ", "vcommon", ",", " ", "v1", ",", " ", 
        "v2", ",", " ", "enew", ",", " ", "cnew", ",", " ", "cchanged", ",", 
        " ", "cnum", ",", " ", "csorted", ",", " ", "cunsorted", ",", " ", 
        "undangle", ",", " ", "sharedwith"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"v", "=", 
        RowBox[{"TissueVertices", "[", "tissue", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"e", "=", 
        RowBox[{"TissueEdges", "[", "tissue", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ne", " ", "=", " ", 
        RowBox[{"Length", "[", "e", "]"}]}], ";", " ", "\[IndentingNewLine]", 
       
       RowBox[{"AbortIf", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"e1", ">", "ne"}], " ", "\[Or]", " ", 
          RowBox[{"e1", "<", "1"}], " ", "\[Or]", 
          RowBox[{"e2", ">", "ne"}], " ", "\[Or]", 
          RowBox[{"e2", "<", "1"}]}], ",", " ", 
         RowBox[{
         "\"\<Error: MergeEdges: edge numbers must be between 1 and \>\"", "<>", 
          RowBox[{"ToString", "[", "ne", "]"}], "<>", " ", 
          "\"\< requested values are \>\"", "<>", 
          RowBox[{"ToString", "[", "e1", "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"ToString", "[", "e2", "]"}]}]}], "\[IndentingNewLine]", 
        "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"edge1", "=", 
        RowBox[{"e", "[", 
         RowBox[{"[", "e1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"edge2", "=", 
        RowBox[{"e", "[", 
         RowBox[{"[", "e2", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"vcommon", " ", "=", " ", 
        RowBox[{"Intersection", "[", 
         RowBox[{"edge1", ",", "edge2"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"AbortIf", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "vcommon", "]"}], "<", "1"}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<Error: MergeEdges: edges \>\"", "<>", 
          RowBox[{"ToString", "[", "e1", "]"}], "<>", "\"\< = \>\"", "<>", 
          RowBox[{"ToString", "[", "edge1", "]"}], "<>", " ", "\"\< and \>\"",
           "<>", 
          RowBox[{"ToString", "[", "e2", "]"}], "<>", " ", "\"\< = \>\"", "<>", 
          RowBox[{"ToString", "[", "edge2", "]"}], "<>", " ", 
          "\"\< do not share a common vertex.\>\""}]}], "\[IndentingNewLine]",
         "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"sharedwith", "=", 
        RowBox[{"Complement", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"First", "/@", 
              RowBox[{"Position", "[", 
               RowBox[{"e", ",", "#"}], "]"}]}], "&"}], "/@", "vcommon"}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"e1", ",", "e2"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"AbortIf", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "sharedwith", "]"}], ">", "0"}], ",", " ", 
         "\"\<The requested edges cannot be merged because they share their \
intersection with another edge.\>\""}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"v1", " ", "=", " ", 
        RowBox[{
         RowBox[{"Complement", "[", 
          RowBox[{"edge1", ",", " ", "vcommon"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"v2", "=", " ", 
        RowBox[{
         RowBox[{"Complement", "[", 
          RowBox[{"edge2", ",", " ", "vcommon"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"vcommon", " ", "=", " ", 
        RowBox[{"First", "[", "vcommon", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"enew", " ", "=", " ", 
        RowBox[{"Sort", "[", 
         RowBox[{"{", 
          RowBox[{"v1", ",", " ", "v2"}], "}"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"e", ",", " ", "enew"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"ne", " ", "=", " ", 
        RowBox[{"ne", "+", "1"}]}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"c", "=", 
        RowBox[{"TissueCells", "[", "tissue", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"cnew", " ", "=", " ", 
        RowBox[{"c", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"e1", "\[Rule]", " ", "ne"}], ",", " ", 
           RowBox[{"e2", "\[Rule]", " ", "ne"}]}], "}"}]}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"cchanged", " ", "=", " ", 
        RowBox[{"Pick", "[", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "c", "]"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#1", "\[NotEqual]", " ", "#2"}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"c", ",", "cnew"}], "}"}]}], "]"}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "  ", "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "cchanged", "]"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"cnum", " ", "=", " ", 
           RowBox[{"First", "[", "cchanged", "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"cchanged", "=", 
           RowBox[{"Rest", "[", "cchanged", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"cunsorted", " ", "=", " ", 
           RowBox[{"Union", "[", 
            RowBox[{"cnew", "[", 
             RowBox[{"[", "cnum", "]"}], "]"}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
          RowBox[{"csorted", " ", "=", " ", 
           RowBox[{"\"\<Edges\>\"", "/.", 
            RowBox[{"SortCellEdges", "[", 
             RowBox[{"cunsorted", ",", " ", "e"}], "]"}]}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"cnew", " ", "=", " ", 
           RowBox[{"ReplacePart", "[", 
            RowBox[{"cnew", ",", " ", 
             RowBox[{"cnum", "\[Rule]", " ", "csorted"}]}], "]"}]}], ";"}]}], 
        " ", "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"tnew", " ", "=", " ", 
        RowBox[{"Tissue", "[", 
         RowBox[{"v", ",", "e", ",", "cnew"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"undangle", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<Undangle\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<Undangle\>\"", "\[Rule]", " ", "True"}], "}"}]}]}], 
       ";", " ", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"undangle", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tnew", " ", "=", " ", 
           RowBox[{"UndangleEdges", "[", "tnew", "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"tnew", " ", "=", " ", 
           RowBox[{"UndangleVertices", "[", "tnew", "]"}]}], ";"}]}], " ", 
        "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "tnew", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MergeEdges", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", "\"\<Error: Expecting MergeEdges[tissue, e1, e2]\>\"", 
       "]"}], ";", " ", "$Failed"}], ")"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.456692810280085*^9, 3.456692811374316*^9}, {
   3.456692843982501*^9, 3.456693254687854*^9}, {3.4566934157125177`*^9, 
   3.456693444544251*^9}, {3.4566934892836723`*^9, 3.456693492675846*^9}, {
   3.45669357199035*^9, 3.456693679232967*^9}, {3.4566937398072367`*^9, 
   3.456693743174924*^9}, 3.456694268969845*^9, {3.456694338684573*^9, 
   3.456694473807981*^9}, {3.45669450450114*^9, 3.4566945271375017`*^9}, {
   3.4566945652870293`*^9, 3.4566947657386427`*^9}, {3.456694813356675*^9, 
   3.456694815930606*^9}, {3.456694895502592*^9, 3.456694933148553*^9}, {
   3.4566950825051947`*^9, 3.4566951232327423`*^9}, {3.456695174224025*^9, 
   3.456695176230976*^9}, {3.456695283073524*^9, 3.4566952979641933`*^9}, {
   3.456695350891212*^9, 3.4566953745566463`*^9}, {3.456698538627026*^9, 
   3.456698578413953*^9}, {3.456857017214357*^9, 3.456857060753705*^9}, {
   3.561512818948649*^9, 
   3.561513143599955*^9}},ExpressionUUID->"98f8d7e0-36cd-4b64-877c-\
a9206fe3d6cb"]
}, Closed]],

Cell[CellGroupData[{

Cell["MergeVertices", "Subsection",
 CellChangeTimes->{{3.489173058043545*^9, 
  3.489173060202093*^9}},ExpressionUUID->"59805ba4-04b7-4803-8183-\
1937be1ab619"],

Cell["\<\
MergeVertices[tissue, edge] removes the specified edge, merging its two \
vertices into a single vertex. One of the vertices is chosen for removal. All \
edge links to the removed vertex are pointed to the new vertex. All cell \
links to the removed edge are deleted. Then the removed vertex and removed \
edge are deleted and the edges/vertices renumbered. \
\>", "Text",
 CellChangeTimes->{{3.489176395021872*^9, 
  3.4891764915566807`*^9}},ExpressionUUID->"a63dd3bb-3ad5-4919-9855-\
fe8d4a5bc867"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MergeVertices", "[", 
     RowBox[{"tissue_Tissue", ",", " ", "edge_Integer", ",", " ", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "v", ",", "e", ",", "c", ",", "ne", ",", " ", "v1", ",", " ", "v2", 
        ",", " ", "keep", ",", " ", "chuck", ",", " ", "enew", ",", " ", 
        "cnew", ",", "vnew", ",", "vkeep", ",", " ", "tnew", ",", " ", 
        "edgeChanges"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"c", "=", 
        RowBox[{"TissueCells", "[", "tissue", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"e", "=", 
        RowBox[{"TissueEdges", "[", "tissue", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"v", "=", 
        RowBox[{"TissueVertices", "[", "tissue", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"ne", "=", 
        RowBox[{"Length", "[", "e", "]"}]}], ";", " ", "\[IndentingNewLine]", 
       
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"edge", ">", "ne"}], " ", "\[Or]", " ", 
          RowBox[{"edge", " ", "<", "1"}]}], ",", " ", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Error: MergeVertices: Edge \>\"", ",", " ", "edge", ",", " ", 
            "\"\< does not exist.\>\""}], " ", "]"}], ";", " ", 
          RowBox[{"Return", "[", "tissue", "]"}]}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "=", 
        RowBox[{"e", "[", 
         RowBox[{"[", "edge", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"keep", "=", 
        RowBox[{"Min", "[", 
         RowBox[{"v1", ",", "v2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"chuck", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"v1", ",", "v2"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
       
       RowBox[{"vkeep", "=", 
        RowBox[{"0.5", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "keep", "]"}], "]"}], "+", 
           RowBox[{"v", "[", 
            RowBox[{"[", "chuck", "]"}], "]"}]}], ")"}]}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"vnew", " ", "=", " ", 
        RowBox[{"ReplacePart", "[", 
         RowBox[{"v", ",", " ", 
          RowBox[{"keep", "\[Rule]", " ", "vkeep"}]}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"enew", " ", "=", " ", 
        RowBox[{"e", "/.", 
         RowBox[{"{", 
          RowBox[{"chuck", "\[Rule]", " ", "keep"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"cnew", " ", "=", " ", 
        RowBox[{"c", "/.", 
         RowBox[{"{", 
          RowBox[{"edge", "\[Rule]", " ", 
           RowBox[{"{", "}"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"cnew", "=", 
        RowBox[{"Flatten", "/@", "cnew"}]}], ";", " ", "\[IndentingNewLine]", 
       
       RowBox[{"tnew", "=", " ", 
        RowBox[{"Tissue", "[", 
         RowBox[{"vnew", ",", " ", "enew", ",", " ", "cnew"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tnew", " ", "=", " ", 
        RowBox[{"RemoveEdge", "[", 
         RowBox[{"tnew", ",", " ", "edge"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tnew", "=", 
        RowBox[{"UndangleVertices", "[", "tnew", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"\"\<Changes\>\"", "/.", 
           RowBox[{"{", "opt", "}"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{"\"\<Changes\>\"", "\[Rule]", " ", "False"}], "}"}]}], ",",
          " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"edge", "<", "ne"}], ",", " ", 
            RowBox[{"edgeChanges", "=", 
             RowBox[{"{", 
              RowBox[{"ne", "\[Rule]", " ", "edge"}], "}"}]}], ",", " ", 
            RowBox[{"edgeChanges", "=", 
             RowBox[{"{", 
              RowBox[{"ne", "\[Rule]", " ", 
               RowBox[{"{", "}"}]}], "}"}]}]}], "]"}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"edgeChanges", ",", " ", 
            RowBox[{"edge", "\[Rule]", " ", 
             RowBox[{"{", "}"}]}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Union", "[", "edgeChanges", "]"}], ",", " ", "tnew"}], 
            "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "tnew", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MergeVertices", "[", 
     RowBox[{"tissue_Tissue", ",", " ", 
      RowBox[{"{", 
       RowBox[{"v1_Integer", ",", " ", "v2_Integer"}], "}"}], ",", " ", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "i", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"e", "=", 
        RowBox[{"Sort", "/@", 
         RowBox[{"TissueEdges", "[", "tissue", "]"}]}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"i", "=", 
        RowBox[{"Position", "[", 
         RowBox[{"e", ",", " ", 
          RowBox[{"Sort", "[", 
           RowBox[{"{", 
            RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "i", "]"}], "<", "1"}], ",", " ", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<Error: MergeVertices: Edge \>\"", ",", " ", 
            RowBox[{"{", 
             RowBox[{"v1", ",", "v2"}], "}"}], ",", " ", 
            "\"\< not found.\>\""}], "]"}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\"\<Changes\>\"", "/.", 
              RowBox[{"{", "opt", "}"}]}], "/.", 
             RowBox[{"{", 
              RowBox[{"\"\<Changes\>\"", "\[Rule]", " ", "False"}], "}"}]}], 
            ",", " ", "\[IndentingNewLine]", 
            RowBox[{"Return", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "}"}], ",", " ", "tissue"}], "}"}], "]"}], ",", 
            " ", "\[IndentingNewLine]", 
            RowBox[{"Return", "[", "tissue", "]"}]}], "]"}]}]}], "]"}], ";", 
       " ", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "i", "]"}], ">", "1"}], ",", " ", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<Error: MergeVertices: Edge \>\"", ",", " ", 
            RowBox[{"{", 
             RowBox[{"v1", ",", " ", "v2"}], "}"}], ",", " ", 
            "\"\< found in multiple locations in tissue. Check tissue for \
errors.\>\""}], "]"}], ";", " ", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"i", "=", 
        RowBox[{"First", "[", 
         RowBox[{"Flatten", "[", "i", "]"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
       RowBox[{"MergeVertices", "[", 
        RowBox[{"tissue", ",", " ", "i", ",", " ", "opt"}], "]"}]}]}], 
     "]"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MergeVertices", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Expecting MergeVertices[tissue, {v1,v2}] or MergeVertices[tissue, \
edgeNumber.]\>\"", "]"}], ";", " ", 
      RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.489173078952305*^9, 3.489173124095565*^9}, {
   3.489176754527972*^9, 3.489176759824935*^9}, {3.489176906815074*^9, 
   3.489177007031619*^9}, {3.4891770642308817`*^9, 3.489177136905787*^9}, {
   3.489177198078209*^9, 3.489177251010898*^9}, {3.489177371295993*^9, 
   3.4891774221576843`*^9}, {3.489177456947578*^9, 3.489177552326974*^9}, {
   3.489177626576139*^9, 3.48917762733235*^9}, {3.48918305443624*^9, 
   3.489183105573311*^9}, {3.489183156875758*^9, 3.489183182474761*^9}, 
   3.489183414936879*^9, {3.489183675934375*^9, 3.489183758550268*^9}, {
   3.489183805668605*^9, 3.48918388487389*^9}, {3.4891839749665737`*^9, 
   3.4891841757892103`*^9}, {3.489184218519559*^9, 3.489184255502306*^9}, {
   3.489184308241928*^9, 3.489184332641789*^9}, {3.4891843731125717`*^9, 
   3.4891844492923727`*^9}, 
   3.706190668869501*^9},ExpressionUUID->"06803b8e-c282-4f85-8a9e-\
da94ef3623d7"]
}, Closed]],

Cell[CellGroupData[{

Cell["DivideCell", "Subsection",
 CellChangeTimes->{{3.456752803717329*^9, 
  3.456752805460414*^9}},ExpressionUUID->"fa775827-422d-4b2d-9d5d-\
519aeec6e46a"],

Cell["\<\
 Return a tissue with a specified cell divided on a particular line.
Rev. 2.1.\[Alpha]20 - if division line hits an existing vertex, rotate the \
line a little tiny bit. This will create very short edges. This edge can be \
removed using MergeVertices if desired.
\
\>", "Text",
 CellChangeTimes->{{3.456752910620041*^9, 3.4567529415197906`*^9}, {
  3.488904955470221*^9, 3.488904982806831*^9}, {3.4895820371494017`*^9, 
  3.489582098178735*^9}},ExpressionUUID->"1583c748-aee1-4109-8a02-\
d84b0b88b97c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DivideCell", "[", 
     RowBox[{
      RowBox[{"tiss_", "?", "TissueQ"}], ",", " ", 
      RowBox[{"j_", "?", "IntegerQ"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p1in_", "?", "NumericPointQ"}], ",", " ", 
        RowBox[{"p2in_", "?", "NumericPointQ"}]}], "}"}], ",", " ", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "dbg", ",", " ", "dPrint", ",", " ", "c", ",", "v", ",", "e", ",", " ",
         "nv", ",", " ", "ne", ",", " ", "nc", ",", " ", "cvc", ",", " ", 
        "intersections", ",", " ", "ce1", ",", "ce2", ",", " ", "e1", ",", 
        "e2", ",", " ", "v1", ",", " ", "v2", ",", " ", "enew", ",", " ", 
        "e1val", ",", " ", "e2val", ",", " ", "e1new", ",", " ", "e2new", ",",
         "ne1", ",", " ", "ne2", ",", "  ", "ne1new", ",", " ", "ne2new", ",",
         " ", "cold", ",", " ", "cnew", ",", " ", "coldvn", ",", " ", 
        "cnewvn", ",", " ", "Sorted", ",", " ", "p1", ",", " ", "p2", ",", 
        " ", "edgechanges", ",", " ", "cj"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Sorted", "[", 
         RowBox[{"{", 
          RowBox[{"x_", ",", "y_"}], "}"}], "]"}], ":=", " ", 
        RowBox[{"x", "\[LessEqual]", "y"}]}], ";", " ", "\[IndentingNewLine]",
        " ", "\[IndentingNewLine]", 
       RowBox[{"p1", "=", "p1in"}], ";", " ", 
       RowBox[{"p2", "=", "p2in"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"dbg", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<Debug\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<Debug\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";", 
       " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dPrint", "[", "x___", "]"}], ":=", " ", 
        RowBox[{"If", "[", 
         RowBox[{"dbg", ",", " ", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<DivideCell: \>\"", ",", " ", "x"}], "]"}]}], "]"}]}], 
       ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<points: \>\"", ",", " ", 
         RowBox[{"{", 
          RowBox[{"p1", ",", " ", "p2"}], "}"}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"c", "=", 
        RowBox[{"TissueCells", "[", "tiss", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"v", "=", 
        RowBox[{"TissueVertices", "[", "tiss", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"e", "=", 
        RowBox[{"TissueEdges", "[", "tiss", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Sort", " ", "pairs", " ", "so", " ", "that", " ", "indices", " ", 
         "are", " ", 
         RowBox[{"{", 
          RowBox[{"smaller", ",", " ", "larger"}], "}"}], " ", 
         "\[IndentingNewLine]", "   ", "bug", " ", "fix", " ", 
         RowBox[{"2.1", ".", "a"}], ".20"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"e", "=", 
        RowBox[{"Sort", "/@", "e"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<Sorted: \>\"", ",", " ", 
         RowBox[{"And", "@@", 
          RowBox[{"(", 
           RowBox[{"Sorted", "/@", "e"}], ")"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nc", "=", 
        RowBox[{"Length", "[", "c", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"nv", "=", 
        RowBox[{"Length", "[", "v", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ne", "=", 
        RowBox[{"Length", "[", "e", "]"}]}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<c[[j]]:\>\"", ",", " ", 
         RowBox[{"c", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"If", " ", 
         RowBox[{"c", "[", 
          RowBox[{"[", "j", "]"}], "]"}], " ", "is", " ", "not", " ", 
         "sorted", " ", "then", " ", "Cell", " ", "Vertex", " ", 
         "Coordinates", " ", "might", " ", "return", " ", "the", " ", 
         "vertices", " ", "in", " ", "backwards", " ", "order"}], " ", "*)"}],
        "\[IndentingNewLine]", 
       RowBox[{"cj", "=", 
        RowBox[{"\"\<Edges\>\"", "/.", 
         RowBox[{"SortCellEdges", "[", 
          RowBox[{
           RowBox[{"c", "[", 
            RowBox[{"[", "j", "]"}], "]"}], ",", " ", "e"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<cj sorted:\>\"", ",", " ", "cj"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"c", "=", 
        RowBox[{"ReplacePart", "[", 
         RowBox[{"c", ",", " ", 
          RowBox[{"j", "\[Rule]", " ", "cj"}]}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<c[[j]]:\>\"", ",", " ", 
         RowBox[{"c", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"cvc", " ", "=", " ", 
        RowBox[{"CellVertexCoordinates", "[", 
         RowBox[{"tiss", ",", "j"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<cvc: \>\"", ",", " ", "cvc"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"intersections", " ", "=", " ", 
        RowBox[{"PolygonIntersection", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"p1", ",", "p2"}], "}"}], ",", " ", "cvc"}], "]"}]}], ";", 
       " ", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<intersections: \>\"", ",", " ", "intersections"}], "]"}],
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "V", ",", "  ", "iteration", ",", " ", "theta", ",", " ", "k", ",", 
           " ", "p2new"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"iteration", "=", "1"}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"p2new", "=", "p2"}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"k", "=", "1"}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "intersections", "]"}], ">", "2"}], ",", 
            " ", 
            RowBox[{
             RowBox[{
             "Print", "[", 
              "\"\<Warning: DivideCell: Existing Vertex or non-convex cell.\>\
\"", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"iteration", "++"}], ">", "5"}], ",", " ", 
               RowBox[{"Abort", "[", "]"}]}], "]"}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<Attempting Recovery, rotating line of division by \>\"", 
               ",", " ", "k", ",", " ", "\"\< degrees\>\""}], "]"}], ";", " ",
              "\[IndentingNewLine]", 
             RowBox[{"theta", " ", "=", " ", 
              RowBox[{"(", 
               RowBox[{"k", "*", 
                RowBox[{"Pi", "/", "180.0"}]}], ")"}]}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
              "move", " ", "each", " ", "end", " ", "point", " ", "a", " ", 
               "little", " ", "bit", " ", "\[IndentingNewLine]", "   ", 
               "perpendicular", " ", "to", " ", "line"}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"V", "=", 
              RowBox[{"p2", "-", "p1"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"p2new", " ", "=", " ", 
              RowBox[{"p1", "+", 
               RowBox[{
                RowBox[{"RotationMatrix", "[", "theta", "]"}], ".", "V"}]}]}],
              ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"intersections", " ", "=", " ", 
              RowBox[{"PolygonIntersection", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"p1", ",", "p2new"}], "}"}], ",", " ", "cvc"}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"k", "=", 
              RowBox[{"(", 
               RowBox[{"k", "+", "1"}], ")"}]}], ";"}]}], " ", 
           "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"p2", "=", "p2new"}], ";"}]}], "\[IndentingNewLine]", "]"}],
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "intersections", "]"}], "<", "2"}], ",", " ",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<Unable to perform cell division.\>\"", "]"}], 
          ";", " ", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\"\<Changes\>\"", "/.", 
              RowBox[{"{", "opt", "}"}]}], "/.", 
             RowBox[{"{", 
              RowBox[{"\"\<Changes\>\"", "\[Rule]", " ", "False"}], "}"}]}], 
            ",", " ", 
            RowBox[{"Return", "[", 
             RowBox[{"{", 
              RowBox[{"$Failed", ",", "tiss"}], "}"}], "]"}], ",", " ", 
            RowBox[{"Return", "[", "tiss", "]"}]}], "]"}]}]}], "]"}], ";", 
       " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ce1", ",", " ", "v1"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"ce2", ",", " ", "v2"}], "}"}]}], "}"}], "=", 
        "intersections"}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "add", " ", "in", " ", "the", " ", "new", " ", "vertices", " ", "and",
          " ", "determine", " ", "their", " ", "vertex", " ", "numbers"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"first", " ", "use", " ", "v1"}], ",", 
         RowBox[{
          RowBox[{"v2", " ", "as", " ", "coordinates"}], ";", " ", 
          RowBox[{"then", " ", "as", " ", "vertex", " ", "numbers"}]}]}], " ",
         "*)"}], "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"v", ",", " ", "v1"}], "]"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"v", ",", " ", "v2"}], "]"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"v1", "=", 
        RowBox[{"nv", "+", "1"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"v2", "=", 
        RowBox[{"nv", "+", "2"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{
        "\"\<New Vertices are \>\"", ",", "v1", ",", "\"\<,\>\"", ",", "v2"}],
         "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "add", " ", "in", " ", "the", " ", "new", " ", "edge", " ", "for", 
         " ", "the", " ", "dividing", " ", "line"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "first", " ", "use", " ", "enew", " ", "as", " ", "an", " ", 
          "edge"}], ",", " ", 
         RowBox[{"then", " ", "as", " ", "an", " ", "edge", " ", "number"}]}],
         " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"enew", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}]}], ";", " ", "\[IndentingNewLine]", 
       
       RowBox[{"AppendTo", "[", 
        RowBox[{"e", ",", 
         RowBox[{"Sort", "[", "enew", "]"}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"enew", " ", "=", " ", 
        RowBox[{"ne", "+", "1"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<Sorted: \>\"", ",", " ", 
         RowBox[{"And", "@@", 
          RowBox[{"(", 
           RowBox[{"Sorted", "/@", "e"}], ")"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"modify", " ", "the", " ", "old", " ", "edges"}], " ", "*)"}],
        "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"ne1", ",", " ", 
         RowBox[{
         "ne2", " ", "are", " ", "edges", " ", "numbers", " ", "of", " ", 
          "the", " ", "two", " ", "split", " ", "edges"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"e1val", ",", " ", 
         RowBox[{
         "e2val", " ", "are", " ", "the", " ", "vertex", " ", "numbers", " ", 
          
          RowBox[{"(", 
           RowBox[{"before", " ", "splitting"}], " "}]}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"ne1", " ", "=", " ", 
        RowBox[{"c", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "ce1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ne2", " ", "=", " ", 
        RowBox[{"c", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", " ", "ce2"}], "]"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"e1val", " ", "=", " ", 
        RowBox[{"e", "[", 
         RowBox[{"[", "ne1", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
       
       RowBox[{"e2val", " ", "=", " ", 
        RowBox[{"e", "[", 
         RowBox[{"[", "ne2", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
       
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<{ne1,ne2}:\>\"", ",", " ", 
         RowBox[{"{", 
          RowBox[{"ne1", ",", " ", "ne2"}], "}"}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<(e1val, e2val}: \>\"", ",", " ", 
         RowBox[{"{", 
          RowBox[{"e1val", ",", " ", "e2val"}], "}"}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"e1", " ", "becomes", " ", "e1"}], "+", "e1new"}], ",", " ", 
         RowBox[{
          RowBox[{"e2", " ", "becomes", " ", "e2"}], "+", "e2new"}]}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "define", " ", "the", " ", "new", " ", "edges", " ", "and", " ", 
         "add", " ", "them", " ", "in"}], " ", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"e1", "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"e1val", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", " ", "v1"}], "}"}], "//", 
         "Sort"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"e1new", " ", "=", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"v1", ",", " ", 
           RowBox[{"e1val", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "//", "Sort"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"e", ",", " ", "e1new"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"ne1new", " ", "=", " ", 
        RowBox[{"ne", "+", "2"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{
        "\"\<(edge \>\"", ",", " ", "ne1", ",", "\"\<) e1\[Rule]\>\"", ",", 
         " ", "e1", ",", " ", "\"\< e1new\[Rule]\>\"", ",", " ", "e1new", ",",
          " ", "\"\< (edge \>\"", ",", " ", "ne1new", ",", "\"\<)\>\""}], 
        "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"e2", " ", "=", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"e2val", "[", 
            RowBox[{"[", "1", "]"}], "]"}], " ", ",", "v2"}], "}"}], "//", 
         "Sort"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"e2new", " ", "=", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"v2", ",", " ", 
           RowBox[{"e2val", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "//", "Sort"}]}], ";", 
       " ", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"e", " ", ",", "e2new"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"ne2new", " ", "=", " ", 
        RowBox[{"ne", "+", "3"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{
        "\"\<(edge \>\"", ",", " ", "ne2", ",", "\"\<) e2\[Rule]\>\"", ",", 
         " ", "e2", ",", " ", "\"\< e2new\[Rule]\>\"", ",", " ", "e2new", ",",
          " ", "\"\< (edge \>\"", ",", " ", "ne2new", ",", " ", "\"\<)\>\""}],
         "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "distribute", " ", "the", " ", "edges", " ", "in", " ", "the", " ", 
         "daughter", " ", "cells"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "make", " ", "sure", " ", "edges", " ", "are", " ", "sorted", " ", 
         "or", " ", "this", " ", 
         RowBox[{"won", "'"}], "t", " ", 
         RowBox[{"work", "!"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"cold", " ", "=", 
        RowBox[{"SortCellEdges", "[", " ", 
         RowBox[{
          RowBox[{"c", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", " ", "e"}], "]"}]}], ";", " ",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "list", " ", "of", " ", "old", " ", "cell", " ", "as", " ", "vertex", 
         " ", "numbers"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"coldvn", " ", "=", " ", 
        RowBox[{"e", "[", 
         RowBox[{"[", 
          RowBox[{"c", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "replace", " ", "each", " ", "split", " ", "edge", " ", "with", " ", 
         "new", " ", "pair", " ", "of", " ", "daughter", " ", "edges"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"cnewvn", "=", " ", 
        RowBox[{"coldvn", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"e1val", "\[Rule]", " ", 
            RowBox[{"Sequence", "[", 
             RowBox[{"e1", ",", "e1new"}], "]"}]}], ",", " ", 
           RowBox[{"e2val", "\[Rule]", " ", 
            RowBox[{"Sequence", "[", 
             RowBox[{"e2", ",", " ", "e2new"}], "]"}]}]}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<cold: \>\"", ",", " ", "cold"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<coldvn: \>\"", ",", " ", "coldvn"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<cnewvn: \>\"", ",", " ", "cnewvn"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "replace", " ", "the", " ", "original", " ", "edges", " ", "with", 
         " ", "their", " ", "\"\<first\>\"", " ", "half"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"e", "=", 
        RowBox[{"ReplacePart", "[", 
         RowBox[{"e", ",", " ", 
          RowBox[{"ne1", "\[Rule]", " ", "e1"}]}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"e", "=", 
        RowBox[{"ReplacePart", "[", 
         RowBox[{"e", ",", " ", 
          RowBox[{"ne2", "\[Rule]", " ", "e2"}]}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "vn", ",", " ", "vxy", ",", " ", "vec", ",", " ", "vecs", ",", " ", 
           "angles", ",", " ", "angle1", ",", " ", "angle2", ",", " ", 
           "cell1", ",", " ", "cell2", ",", " ", "pe1", ",", " ", "pe2"}], 
          "}"}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "determine", " ", "which", " ", "vertices", " ", "go", " ", "with", 
           " ", "which", " ", "cell"}], " ", "*)"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"vn", "=", 
           RowBox[{"Union", "[", 
            RowBox[{"Flatten", "[", "coldvn", "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"vxy", " ", "=", " ", 
           RowBox[{"v", "[", 
            RowBox[{"[", "vn", "]"}], "]"}]}], ";", "  ", 
          "\[IndentingNewLine]", 
          RowBox[{"vec", "=", 
           RowBox[{"p2", "-", "p1"}]}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"vecs", " ", "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#", "-", "p1"}], ")"}], "&"}], "/@", "vxy"}]}], ";", 
          " ", "\[IndentingNewLine]", 
          RowBox[{"angles", " ", "=", " ", 
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"ArcTan", "@@", "#"}], "&"}], "/@", "vecs"}], ",", " ", 
             RowBox[{"2", "Pi"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
          
          RowBox[{"angle1", "=", 
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{"ArcTan", "@@", "vec"}], ",", " ", 
             RowBox[{"2", "Pi"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"angle2", "=", 
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{"Pi", "+", "angle1"}], ",", " ", 
             RowBox[{"2", "Pi"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
          
          RowBox[{
           RowBox[{"{", 
            RowBox[{"angle1", ",", "angle2"}], "}"}], "=", 
           RowBox[{"Sort", "[", 
            RowBox[{"{", 
             RowBox[{"angle1", ",", "angle2"}], "}"}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"cell1", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"angle1", "\[LessEqual]", " ", "#"}], " ", "\[And]", 
               " ", 
               RowBox[{"#", "\[LessEqual]", " ", "angle2"}]}], ")"}], "&"}], "/@",
             "angles"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"cell2", "=", 
           RowBox[{"Not", "/@", "cell1"}]}], ";", "  ", "\[IndentingNewLine]", 
          RowBox[{"cell1", " ", "=", " ", 
           RowBox[{"Pick", "[", 
            RowBox[{"vn", ",", " ", "cell1"}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"cell2", "=", 
           RowBox[{"Pick", "[", 
            RowBox[{"vn", ",", " ", "cell2"}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<vn:\>\"", ",", " ", "vn"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<vxy:\>\"", ",", " ", "vxy"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<vecs: \>\"", ",", " ", "vecs"}], "]"}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<angles: \>\"", ",", " ", "angles"}], "]"}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<angle1,2: \>\"", ",", " ", 
            RowBox[{"{", 
             RowBox[{"angle1", ",", " ", "angle2"}], "}"}]}], "]"}], ";", " ",
           "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<cell1: \>\"", ",", " ", "cell1"}], "]"}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<cell2: \>\"", ",", " ", "cell2"}], "]"}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"now", " ", "figure", " ", "which", " ", "edges"}], " ", 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "position", " ", "in", " ", "the", " ", "list", " ", "of", " ", 
            "vertex", " ", "pairs"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"cell1", " ", "=", " ", 
           RowBox[{"Union", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"First", "/@", 
                RowBox[{"Position", "[", 
                 RowBox[{"cnewvn", ",", " ", "#"}], "]"}]}], "&"}], "/@", 
              "cell1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"cell2", "=", "  ", 
           RowBox[{"Union", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"First", "/@", 
                RowBox[{"Position", "[", 
                 RowBox[{"cnewvn", ",", " ", "#"}], "]"}]}], "&"}], "/@", 
              "cell2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"cell1", "=", 
           RowBox[{"Sort", "/@", 
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"cnewvn", "[", 
               RowBox[{"[", "cell1", "]"}], "]"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"v1", ",", "v2"}], "}"}]}], "]"}]}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"cell2", "=", " ", 
           RowBox[{"Sort", "/@", 
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"cnewvn", "[", 
               RowBox[{"[", "cell2", "]"}], "]"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"v1", ",", "v2"}], "}"}]}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<cell1: \>\"", ",", " ", "cell1"}], "]"}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<cell2: \>\"", ",", " ", "cell2"}], "]"}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"cell1", "=", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"e", ",", " ", "#"}], "]"}], "&"}], "/@", "cell1"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"cell2", "=", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"e", ",", "#"}], "]"}], "&"}], "/@", "cell2"}], 
            "]"}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<cell1 Flattened Positions: \>\"", ",", " ", "cell1"}],
            "]"}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<cell2 Flattened Positions: \>\"", ",", " ", "cell2"}],
            "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"cell1", "=", 
           RowBox[{"SortCellEdges", "[", 
            RowBox[{"cell1", ",", " ", "e"}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"SameQ", "[", 
             RowBox[{"cell1", ",", " ", "$Failed"}], "]"}], ",", " ", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<Error Exit: DivideCell.\>\"", "]"}], 
             ";", " ", 
             RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"cell1", "=", 
           RowBox[{"\"\<Edges\>\"", "/.", "cell1"}]}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"cell2", "=", 
           RowBox[{"SortCellEdges", "[", 
            RowBox[{"cell2", ",", " ", "e"}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"SameQ", "[", 
             RowBox[{"cell2", ",", " ", "$Failed"}], "]"}], ",", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<Error Exit: DivideCell\>\"", "]"}], 
             ";", "  ", 
             RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"cell2", " ", "=", " ", 
           RowBox[{"\"\<Edges\>\"", "/.", "cell2"}]}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<cell1: \>\"", ",", " ", "cell1"}], "]"}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<cell2: \>\"", ",", " ", "cell2"}], "]"}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"put", " ", "in", " ", "the", " ", "new", " ", "cells"}], 
           " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"c", "=", 
           RowBox[{"ReplacePart", "[", 
            RowBox[{"c", ",", " ", 
             RowBox[{"j", "\[Rule]", " ", "cell1"}]}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"c", ",", " ", "cell2"}], "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "check", " ", "to", " ", "see", " ", "if", " ", "either", " ", 
            "edge", " ", "is", " ", "part", " ", "of", " ", "any", " ", 
            "other", " ", 
            RowBox[{"cell", "!"}]}], " ", "*)"}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"pe1", "=", 
           RowBox[{"Complement", "[", 
            RowBox[{
             RowBox[{"First", "/@", 
              RowBox[{"Position", "[", 
               RowBox[{"c", ",", " ", "ne1"}], "]"}]}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"nc", "+", "1"}]}], "}"}]}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"pe2", "=", 
           RowBox[{"Complement", "[", 
            RowBox[{
             RowBox[{"First", "/@", 
              RowBox[{"Position", "[", 
               RowBox[{"c", ",", " ", "ne2"}], "]"}]}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"j", ",", " ", 
               RowBox[{"nc", "+", "1"}]}], "}"}]}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<pe1,pe2:\>\"", ",", " ", 
            RowBox[{"{", 
             RowBox[{"pe1", ",", " ", "pe2"}], "}"}]}], "]"}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "pe1", "]"}], ">", "0"}], ",", " ", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"pe1", "=", 
              RowBox[{"First", "[", "pe1", "]"}]}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"cell1", " ", "=", " ", 
              RowBox[{
               RowBox[{"c", "[", 
                RowBox[{"[", "pe1", "]"}], "]"}], "/.", 
               RowBox[{"{", 
                RowBox[{"ne1", "\[Rule]", " ", 
                 RowBox[{"Sequence", "[", 
                  RowBox[{"ne1", ",", " ", "ne1new"}], "]"}]}], "}"}]}]}], 
             ";", " ", "\[IndentingNewLine]", 
             RowBox[{"cell1", " ", "=", 
              RowBox[{"\"\<Edges\>\"", "/.", 
               RowBox[{"SortCellEdges", "[", 
                RowBox[{"cell1", ",", " ", "e"}], "]"}]}]}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"dPrint", "[", 
              RowBox[{"\"\<bordering cell1: \>\"", ",", " ", "cell1"}], "]"}],
              ";", " ", "\[IndentingNewLine]", 
             RowBox[{"c", "=", 
              RowBox[{"ReplacePart", "[", 
               RowBox[{"c", ",", " ", 
                RowBox[{"{", 
                 RowBox[{"pe1", "\[Rule]", " ", "cell1"}], "}"}]}], "]"}]}], 
             ";"}]}], " ", "\[IndentingNewLine]", "]"}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "pe2", "]"}], ">", "0"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"pe2", "=", 
              RowBox[{"First", "[", "pe2", "]"}]}], ";", "  ", 
             "\[IndentingNewLine]", 
             RowBox[{"cell2", "=", "  ", 
              RowBox[{
               RowBox[{"c", "[", 
                RowBox[{"[", "pe2", "]"}], "]"}], "/.", 
               RowBox[{"{", " ", 
                RowBox[{"ne2", "\[Rule]", " ", 
                 RowBox[{"Sequence", "[", 
                  RowBox[{"ne2", ",", " ", "ne2new"}], "]"}]}], "}"}]}]}], 
             ";", " ", "\[IndentingNewLine]", 
             RowBox[{"cell2", "=", 
              RowBox[{"\"\<Edges\>\"", "/.", 
               RowBox[{"SortCellEdges", "[", 
                RowBox[{"cell2", ",", " ", "e"}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"dPrint", "[", 
              RowBox[{"\"\<bordering cell2: \>\"", ",", " ", "cell2"}], "]"}],
              ";", " ", "\[IndentingNewLine]", 
             RowBox[{"c", "=", 
              RowBox[{"ReplacePart", "[", 
               RowBox[{"c", ",", " ", 
                RowBox[{"{", 
                 RowBox[{"pe2", "\[Rule]", " ", "cell2"}], "}"}]}], "]"}]}], 
             ";"}]}], " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           "]"}], ";"}]}], " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"edgechanges", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"0", "\[Rule]", " ", "enew"}], ",", " ", 
          RowBox[{"ne1", "\[Rule]", " ", "ne1"}], ",", " ", 
          RowBox[{"ne1", "\[Rule]", " ", "ne1new"}], ",", " ", 
          RowBox[{"ne2", "\[Rule]", " ", "ne2"}], ",", " ", 
          RowBox[{"ne2", "\[Rule]", " ", "ne2new"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<edgeChanges:\>\"", ",", " ", "edgechanges"}], "]"}], ";",
        " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"\"\<Changes\>\"", "/.", 
           RowBox[{"{", "opt", "}"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{"\"\<Changes\>\"", "\[Rule]", " ", "False"}], "}"}]}], ",",
          " ", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"{", 
           RowBox[{"edgechanges", ",", " ", 
            RowBox[{"Tissue", "[", 
             RowBox[{"v", ",", "e", ",", "c"}], "]"}]}], "}"}], "]"}], ",", 
         " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Return", "[", 
           RowBox[{"Tissue", "[", 
            RowBox[{"v", ",", "e", ",", "c"}], "]"}], "]"}], ";"}]}], " ", 
        "\[IndentingNewLine]", "]"}], ";"}]}], " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "]"}]}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DivideCell", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Error: Expecting DivideCell[tissue, cell-number, {point1,point2}]\
\>\"", "]"}], ";", " ", "$Failed"}], ")"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.456752806662963*^9, 3.45675290511405*^9}, {
   3.456752951516774*^9, 3.456753004995243*^9}, {3.456753236201322*^9, 
   3.4567532432097273`*^9}, {3.456753382516865*^9, 3.456753469165061*^9}, {
   3.456753708015975*^9, 3.456753708210807*^9}, {3.456754568717083*^9, 
   3.456754616420458*^9}, 3.4567546639018517`*^9, {3.4567549017465754`*^9, 
   3.4567552050703487`*^9}, {3.4567552715616617`*^9, 3.456755348861162*^9}, {
   3.456767581792056*^9, 3.456767673405724*^9}, {3.4567677036240997`*^9, 
   3.4567680961020737`*^9}, {3.456768178445546*^9, 3.456768322088263*^9}, {
   3.456768457949059*^9, 3.456768491154357*^9}, {3.4567685870952883`*^9, 
   3.456768589261611*^9}, {3.456768628934203*^9, 3.45676864554362*^9}, {
   3.456768693592754*^9, 3.4567687539154463`*^9}, {3.4567687886533947`*^9, 
   3.456768809334758*^9}, {3.456768860602206*^9, 3.4567689106204844`*^9}, {
   3.456769216380167*^9, 3.456769226511403*^9}, {3.45676969016107*^9, 
   3.456769737273093*^9}, {3.456769843795068*^9, 3.456769894810505*^9}, {
   3.4567699893139544`*^9, 3.456769991003027*^9}, {3.4567700361085978`*^9, 
   3.45677008522224*^9}, {3.4567701160147877`*^9, 3.456770210860303*^9}, {
   3.4567702519455137`*^9, 3.456770383596476*^9}, {3.456770415333721*^9, 
   3.456770442341777*^9}, {3.456770473350395*^9, 3.456770476368499*^9}, {
   3.456770517180522*^9, 3.4567706012530212`*^9}, {3.4567706637232847`*^9, 
   3.45677067276546*^9}, {3.456770777121727*^9, 3.4567708222131157`*^9}, {
   3.456770867197715*^9, 3.456770900251333*^9}, {3.456770957440943*^9, 
   3.45677102143708*^9}, {3.456771072317647*^9, 3.456771077146144*^9}, {
   3.456771113066174*^9, 3.4567711805795813`*^9}, {3.45677121226264*^9, 
   3.456771283237389*^9}, {3.456771342528974*^9, 3.456771389134028*^9}, {
   3.456771431177801*^9, 3.45677146720208*^9}, {3.456771500232361*^9, 
   3.4567715110258636`*^9}, 3.456771602830862*^9, {3.456773965570551*^9, 
   3.456774036247388*^9}, {3.456846584179905*^9, 3.456846730376795*^9}, {
   3.4568467665622168`*^9, 3.456846857673177*^9}, {3.456847136698923*^9, 
   3.456847156517243*^9}, {3.456847645018538*^9, 3.456847680555017*^9}, {
   3.45684784174116*^9, 3.45684785106583*^9}, {3.456847892679512*^9, 
   3.4568479084965897`*^9}, {3.45684803492915*^9, 3.4568480600765123`*^9}, {
   3.4568481235712967`*^9, 3.456848236174258*^9}, {3.4568482917346973`*^9, 
   3.456848435019533*^9}, {3.456848507975087*^9, 3.456848547970559*^9}, {
   3.456848942071087*^9, 3.456848947836473*^9}, {3.456849004584539*^9, 
   3.456849006221799*^9}, {3.456849067528205*^9, 3.456849206856413*^9}, {
   3.4568492470995817`*^9, 3.456849258902717*^9}, {3.456849315575453*^9, 
   3.4568494447013702`*^9}, {3.456849843861949*^9, 3.456849884168768*^9}, {
   3.456849926424077*^9, 3.4568499332423763`*^9}, {3.4568499872052803`*^9, 
   3.4568500174523773`*^9}, {3.456850047677518*^9, 3.4568500497031193`*^9}, {
   3.4568500866140957`*^9, 3.45685009136205*^9}, {3.45685014644046*^9, 
   3.456850223305616*^9}, {3.456850289022382*^9, 3.456850545673025*^9}, {
   3.4568505817312317`*^9, 3.4568506346689987`*^9}, {3.456850880295627*^9, 
   3.4568509572242727`*^9}, {3.4568509889468193`*^9, 3.456851009456059*^9}, {
   3.4568510395248537`*^9, 3.456851084365786*^9}, {3.4568558572692966`*^9, 
   3.45685588961609*^9}, {3.456856456194934*^9, 3.456856469385985*^9}, {
   3.456856512018496*^9, 3.4568565743775387`*^9}, {3.456857116144541*^9, 
   3.456857122156106*^9}, {3.457103539696604*^9, 3.45710357213306*^9}, {
   3.457103710647698*^9, 3.4571037421355343`*^9}, {3.457103793272119*^9, 
   3.457103826490712*^9}, {3.457104029303561*^9, 3.457104055187455*^9}, {
   3.4571055191834373`*^9, 3.457105530115233*^9}, {3.4889038075482073`*^9, 
   3.488903807906269*^9}, {3.4889038481434526`*^9, 3.488903964993824*^9}, {
   3.4889040422299623`*^9, 3.4889040604343224`*^9}, {3.488904196103511*^9, 
   3.488904623778227*^9}, {3.488905426325141*^9, 3.4889055104302807`*^9}, {
   3.488905572183773*^9, 3.488905573346766*^9}, {3.4889056162267227`*^9, 
   3.4889057386951427`*^9}, {3.488905786443281*^9, 3.488905857725869*^9}, {
   3.488908483748329*^9, 3.488908492442648*^9}, {3.488908603051394*^9, 
   3.488908641340127*^9}, {3.48890869149648*^9, 3.4889087431735477`*^9}, {
   3.488908853728155*^9, 3.488908892525691*^9}, {3.489581680515087*^9, 
   3.4895816831354923`*^9}, {3.4895817745518427`*^9, 3.489581787009334*^9}, {
   3.489581916391755*^9, 3.489582000349782*^9}, {3.489596941549056*^9, 
   3.489596944124497*^9}, {3.489597228532825*^9, 3.48959729001229*^9}, {
   3.489597369493949*^9, 3.489597475946719*^9}, {3.489597537551964*^9, 
   3.489597560971828*^9}, {3.489597607801421*^9, 3.489597608044882*^9}, 
   3.489597644905426*^9, {3.489597722557822*^9, 3.489597755958499*^9}, {
   3.494178710685603*^9, 3.494178731630658*^9}, {3.547475427702941*^9, 
   3.547475433459282*^9}, {3.5474755067684813`*^9, 3.547475530587496*^9}, {
   3.547585853819643*^9, 3.547585893762164*^9}, {3.5475859790800467`*^9, 
   3.5475860081202583`*^9}, {3.5475860500042686`*^9, 3.547586055252104*^9}, 
   3.547586171474827*^9, {3.5475864554774*^9, 3.5475864576543493`*^9}, {
   3.547740148477229*^9, 3.547740149045362*^9}, {3.5477437461331167`*^9, 
   3.547743746834156*^9}, {3.566142935913501*^9, 3.566142960036207*^9}, {
   3.566143359318472*^9, 
   3.566143367212935*^9}},ExpressionUUID->"dfcaf207-12f5-4da5-8b3e-\
bbb911d46867"]
}, Closed]],

Cell[CellGroupData[{

Cell["RemoveCell", "Subsection",
 CellChangeTimes->{{3.450801908174488*^9, 
  3.450801911520035*^9}},ExpressionUUID->"e8d94990-0bcf-4b5c-95ab-\
6834c7abff02"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RemoveCell", "[", 
     RowBox[{
      RowBox[{"tissue_", "?", "TissueQ"}], ",", " ", 
      RowBox[{"cellNumber_", "?", "IntegerQ"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "nc", ",", " ", "c", ",", " ", "v", ",", " ", "e", ",", " ", "q"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"v", "=", 
        RowBox[{"TissueVertices", "[", "tissue", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"e", "=", 
        RowBox[{"TissueEdges", "[", "tissue", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"c", "=", 
        RowBox[{"TissueCells", "[", "tissue", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"nc", "=", 
        RowBox[{"Length", "[", "c", "]"}]}], ";", " ", "\[IndentingNewLine]", 
       
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"cellNumber", ">", " ", "nc"}], " ", "\[Or]", " ", 
          RowBox[{"cellNumber", " ", "<", " ", "1"}]}], ",", " ", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Error: RemoveCell: Cell \>\"", ",", " ", "cellNumber", ",", 
            " ", "\"\< does not exist and cannot be removed.\>\""}], "]"}], 
          ";", " ", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "tissue", "]"}]}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"c", "=", 
        RowBox[{"Drop", "[", 
         RowBox[{"c", ",", " ", 
          RowBox[{"{", "cellNumber", "}"}]}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"q", " ", "=", " ", 
        RowBox[{"Tissue", "[", 
         RowBox[{"v", ",", " ", "e", ",", " ", "c"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"q", "=", 
        RowBox[{"UndangleEdges", "[", "q", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"q", "=", 
        RowBox[{"UndangleVertices", "[", "q", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "q", "]"}], ";"}]}], " ", "\[IndentingNewLine]",
      "]"}]}], " ", ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RemoveCell", "[", 
     RowBox[{
      RowBox[{"tissue_", "?", "TissueQ"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"cellNumber__", "?", "IntegerQ"}], "}"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "nc", ",", " ", "c", ",", " ", "v", ",", " ", "e", ",", " ", "q", ",", 
        " ", "keep", ",", " ", "remove"}], "}"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"v", "=", 
        RowBox[{"TissueVertices", "[", "tissue", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"e", "=", 
        RowBox[{"TissueEdges", "[", "tissue", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"c", "=", 
        RowBox[{"TissueCells", "[", "tissue", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"nc", "=", 
        RowBox[{"Length", "[", "c", "]"}]}], ";", " ", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#", ">", " ", "nc"}], " ", "\[Or]", " ", 
            RowBox[{"#", " ", "<", " ", "1"}]}], ",", " ", 
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Error: RemoveCell: Cell \>\"", ",", " ", "cellNumber", ",", 
             " ", "\"\< does not exist and cannot be removed.\>\""}], "]"}]}],
           "]"}], "&"}], "/@", 
        RowBox[{"{", "cellNumber", "}"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "pick", " ", "out", " ", "which", " ", "cells", " ", "to", " ", 
         "remove"}], " ", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"remove", " ", "=", " ", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"{", "cellNumber", "}"}], ",", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#", ">", "0"}], " ", "\[And]", " ", 
             RowBox[{"#", "\[LessEqual]", " ", "nc"}]}], ")"}], "&"}]}], 
         "]"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"keep", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{"True", ",", " ", 
          RowBox[{"{", "nc", "}"}]}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "remove", "]"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"keep", "[", 
            RowBox[{"[", 
             RowBox[{"First", "[", "remove", "]"}], "]"}], "]"}], "=", 
           "False"}], ";", "  ", "\[IndentingNewLine]", 
          RowBox[{"remove", "=", 
           RowBox[{"Rest", "[", "remove", "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"c", "=", 
        RowBox[{"Pick", "[", 
         RowBox[{"c", ",", " ", "keep"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"q", " ", "=", " ", 
        RowBox[{"Tissue", "[", 
         RowBox[{"v", ",", " ", "e", ",", " ", "c"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"q", "=", 
        RowBox[{"UndangleEdges", "[", "q", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"q", "=", 
        RowBox[{"UndangleVertices", "[", "q", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "q", "]"}], ";"}]}], " ", "\[IndentingNewLine]",
      "]"}]}], " ", ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RemoveCell", "[", "x___", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", "\"\<Expecting RemoveCell[tissue, cellNumber]\>\"", "]"}],
       ";", " ", "$Failed"}], ")"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.450801912534244*^9, 3.450801949788398*^9}, {
   3.450803619445475*^9, 3.450803742801427*^9}, 3.450804094282094*^9, {
   3.450804134142712*^9, 3.4508042187647676`*^9}, {3.450804406568871*^9, 
   3.450804468834669*^9}, {3.450804509238822*^9, 3.450804668392071*^9}, {
   3.450804720861506*^9, 
   3.4508047627647667`*^9}},ExpressionUUID->"d9245765-b79d-419f-bd5f-\
60eebf661aed"]
}, Closed]],

Cell[CellGroupData[{

Cell["AddVertex, AddEdge, AddCell", "Subsection",
 CellChangeTimes->{{3.451051289832301*^9, 
  3.451051301680978*^9}},ExpressionUUID->"91858adb-34e8-4316-bcc3-\
1c4462ace03a"],

Cell["\<\
no significant error checking is performed (e.g., edge intersection or \
duplicate vertex)\
\>", "Text",
 CellChangeTimes->{{3.451051304761582*^9, 
  3.451051321778719*^9}},ExpressionUUID->"814a06f5-ae18-42fa-a36d-\
c81ecec3330a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AddVertex", "[", 
    RowBox[{
     RowBox[{"tissue_", "?", "TissueQ"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x_", "?", "NumericQ"}], ",", " ", 
       RowBox[{"y_", "?", "NumericQ"}]}], "}"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v", ",", "e", ",", "c", ",", " ", "q"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"v", "=", 
       RowBox[{"Append", "[", 
        RowBox[{
         RowBox[{"TissueVertices", "[", "tissue", "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"e", "=", 
       RowBox[{"TissueEdges", "[", "tissue", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"TissueCells", "[", "tissue", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"Tissue", "[", 
        RowBox[{"v", ",", "e", ",", "c"}], "]"}], "]"}], ";"}]}], " ", 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AddVertex", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", "\"\<Expecting AddVertex[Tissue, {number, number}]\>\"", 
       "]"}], ";", " ", 
      RowBox[{"Return", "[", "$Failed", "]"}]}], ")"}]}], ";"}], 
  " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.451051323979815*^9, 3.451051468093154*^9}, 
   3.4510515682403927`*^9},ExpressionUUID->"9013f9f2-19ab-4d57-9f58-\
7069e8445966"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AddEdge", "[", 
    RowBox[{
     RowBox[{"tissue_", "?", "TissueQ"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i_", "?", "IntegerQ"}], ",", " ", 
       RowBox[{"j_", "?", "IntegerQ"}]}], "}"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "v", ",", "e", ",", "c", ",", " ", "nv", ",", " ", "q", ",", " ", 
       "failed"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"v", "=", 
       RowBox[{"TissueVertices", "[", "tissue", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nv", "=", 
       RowBox[{"Length", "[", "v", "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"failed", "=", "False"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "<", "1"}], " ", "\[Or]", " ", 
           RowBox[{"#", ">", "nv"}]}], ",", " ", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Error: AddEdge: Vertex \>\"", ",", " ", "#", ",", " ", 
             "\"\< does not exist.\>\""}], "]"}], ";", " ", 
           RowBox[{"failed", "=", "True"}]}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{"i", ",", "j"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"failed", ",", " ", 
        RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"e", "=", 
       RowBox[{"Append", "[", 
        RowBox[{
         RowBox[{"TissueEdges", "[", "tissue", "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", "j"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"TissueCells", "[", "tissue", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"q", "=", 
       RowBox[{"Tissue", "[", 
        RowBox[{"v", ",", "e", ",", "c"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "q", "]"}], ";"}]}], " ", "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AddEdge", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", "\"\<Expecting AddEdge[Tissue, {int, int}]\>\"", "]"}], 
      ";", " ", 
      RowBox[{"Return", "[", "$Failed", "]"}]}], ")"}]}], ";"}], 
  " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4510515695979223`*^9, 3.451051742031713*^9}, {
  3.451051800139056*^9, 3.451051803603888*^9}, {3.45105183823297*^9, 
  3.451051845114003*^9}, {3.4510518834490128`*^9, 
  3.451051931076789*^9}},ExpressionUUID->"dc7395a5-65d9-42ee-adfa-\
d92562796dac"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AddCell", "[", 
     RowBox[{
      RowBox[{"tissue_", "?", "TissueQ"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"i_", "?", "IntegerQ"}], ",", " ", 
        RowBox[{"j_", "?", "IntegerQ"}], ",", " ", 
        RowBox[{"k__", "?", "IntegerQ"}]}], "}"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "v", ",", "e", ",", "c", ",", "ne", ",", " ", "q", ",", " ", 
        "failed"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"v", "=", 
        RowBox[{"TissueVertices", "[", "tissue", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"e", "=", 
        RowBox[{"TissueEdges", "[", "tissue", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"ne", "=", 
        RowBox[{"Length", "[", "e", "]"}]}], ";", " ", "\[IndentingNewLine]", 
       
       RowBox[{"c", "=", 
        RowBox[{"TissueCells", "[", "tissue", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"failed", "=", "False"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "<", "1"}], " ", "\[Or]", " ", 
            RowBox[{"#", ">", "ne"}]}], ",", " ", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{
             "\"\<Error: AddCell: Edge \>\"", ",", " ", "#", ",", " ", 
              "\"\< does not exist.\>\""}], "]"}], ";", " ", 
            RowBox[{"failed", "=", "True"}]}]}], "]"}], "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{"i", ",", "j", ",", " ", "k"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"failed", ",", " ", 
         RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"c", "=", 
        RowBox[{"Append", "[", 
         RowBox[{"c", ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", "j", ",", "k"}], "}"}]}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"q", "=", 
        RowBox[{"Tissue", "[", 
         RowBox[{"v", ",", "e", ",", "c"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "q", "]"}], ";"}]}], " ", "\[IndentingNewLine]",
      "\[IndentingNewLine]", "]"}]}], ";"}], " "}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.451052179463688*^9, 
  3.4510523236494303`*^9}},ExpressionUUID->"d897e382-a356-45a6-a3ea-\
3e1853677003"]
}, Closed]],

Cell[CellGroupData[{

Cell["EntangledVertices", "Subsection",
 CellChangeTimes->{{3.4510588511094513`*^9, 3.451058863557766*^9}, {
  3.451058901497345*^9, 3.451058902121169*^9}, {3.4510596882211227`*^9, 
  3.4510596890762463`*^9}},ExpressionUUID->"7e8652ff-f30c-40a9-bb59-\
4fef697ddb80"],

Cell["\<\
check edges to see if there are any vertices fall on any edges.\
\>", "Text",
 CellChangeTimes->{{3.451058866846381*^9, 
  3.451058895544509*^9}},ExpressionUUID->"57fee702-9ec2-4402-9f5d-\
9789d3274c2b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"EntangledVertices", "[", 
   RowBox[{"tissue_", "?", "TissueQ"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "e", ",", "v", ",", " ", "entangled", ",", " ", "entanglements", ",", 
      " ", "unresolved", ",", " ", "rv", ",", " ", "nv", ",", " ", "ne"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"e", "=", 
      RowBox[{"TissueEdges", "[", "tissue", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ne", "=", 
      RowBox[{"Length", "[", "e", "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"v", "=", 
      RowBox[{"TissueVertices", "[", "tissue", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"nv", "=", 
      RowBox[{"Length", "[", "v", "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"rv", "=", 
      RowBox[{"Range", "[", "nv", "]"}]}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"entanglement", "[", 
        RowBox[{"e", ",", " ", "v"}], "]"}], " ", "returns", " ", 
       RowBox[{"True", "/", "Fals"}], " ", "if", " ", "v", " ", "falls", " ", 
       "on", " ", "edge"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"entangled", "[", 
       RowBox[{"edgeNumber_", ",", " ", "vertexNumber_"}], "]"}], ":=", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"PointOnLineSegment", "[", 
       RowBox[{
        RowBox[{"v", "[", 
         RowBox[{"[", 
          RowBox[{"e", "[", 
           RowBox[{"[", "edgeNumber", "]"}], "]"}], "]"}], "]"}], ",", " ", 
        RowBox[{"v", "[", 
         RowBox[{"[", "vertexNumber", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"entanglements", "[", "e", "]"}], " ", "returns", " ", "a", 
       " ", "list", " ", "of", " ", "the", " ", "points", " ", "that", " ", 
       "fall", " ", "on", " ", "edge", " ", "e"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"entanglements", "[", "edgeNumber_", "]"}], ":=", 
      RowBox[{"Pick", "[", 
       RowBox[{"rv", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"entangled", "[", 
           RowBox[{"edgeNumber", ",", " ", "#"}], "]"}], "&"}], "/@", 
         "rv"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"unresolved", "[", "e", "]"}], " ", "returns", " ", "a", " ", 
       "list", " ", "of", " ", "vertices", " ", "that", " ", "fall", " ", 
       "on", " ", "edge", " ", "e", " ", "but", " ", "are", " ", "not", " ", 
       "endpoints", " ", "of", " ", "e"}], " ", "*)"}], "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"unresolved", "[", "edgeNumber_", "]"}], ":=", " ", 
      RowBox[{"Complement", "[", 
       RowBox[{
        RowBox[{"entanglements", "[", "edgeNumber", "]"}], ",", " ", 
        RowBox[{"e", "[", 
         RowBox[{"[", "edgeNumber", "]"}], "]"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"unresolved", "/@", 
      RowBox[{"Range", "[", "ne", "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4510589063791513`*^9, 3.451059008997377*^9}, {
  3.451059045684746*^9, 3.451059127180496*^9}, {3.451059258959934*^9, 
  3.451059416375558*^9}, {3.451059450028048*^9, 3.451059633913419*^9}, {
  3.4510596923770733`*^9, 
  3.45105969290401*^9}},ExpressionUUID->"65062c82-b13d-41d6-aca0-\
5903962d4584"]
}, Closed]],

Cell[CellGroupData[{

Cell["DisentangleVertices", "Subsection",
 CellChangeTimes->{{3.451059850730444*^9, 
  3.4510598533301277`*^9}},ExpressionUUID->"4373574f-e8cd-4096-b80d-\
e62a4680fe5d"],

Cell["Fix any entangled vertices in tissue", "Text",
 CellChangeTimes->{{3.4510598687399483`*^9, 
  3.451059874307938*^9}},ExpressionUUID->"76538f34-58a9-4d64-a57a-\
d5cc39409202"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DisentangleVertices", "[", 
     RowBox[{"tissue_", "?", "TissueQ"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{"ev", ",", " ", "v", ",", " ", 
        RowBox[{"dbg", "=", "False"}], ",", " ", "dPrint", ",", " ", "e", ",",
         " ", "ne", ",", " ", "c", ",", " ", "nc", ",", " ", "entangled", ",",
         " ", "rules", ",", " ", "tnew"}], "}"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{
        RowBox[{"dPrint", "[", "x___", "]"}], ":=", " ", 
        RowBox[{"If", "[", 
         RowBox[{"dbg", ",", " ", 
          RowBox[{"Print", "[", "x", "]"}]}], "]"}]}], ";", "  ", 
       "\[IndentingNewLine]", 
       RowBox[{"v", "=", " ", 
        RowBox[{"TissueVertices", "[", "tissue", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"e", "=", 
        RowBox[{"TissueEdges", "[", "tissue", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"e", "=", 
        RowBox[{"Sort", "/@", "e"}]}], ";", " ", "\[IndentingNewLine]", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"ne", "=", 
        RowBox[{"Length", "[", "e", "]"}]}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"c", "=", 
        RowBox[{"TissueCells", "[", "tissue", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"nc", " ", "=", " ", 
        RowBox[{"Length", "[", "c", "]"}]}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"ev", "=", 
        RowBox[{"EntangledVertices", "[", "tissue", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"entangled", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Length", "[", "#", "]"}], ">", "0"}], ")"}], "&"}], "/@",
          "ev"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"ev", "=", 
        RowBox[{"Pick", "[", 
         RowBox[{"ev", ",", " ", "entangled"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"entangled", "=", 
        RowBox[{"Pick", "[", 
         RowBox[{
          RowBox[{"Range", "[", "ne", "]"}], ",", " ", "entangled"}], "]"}]}],
        ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
          "just", " ", "fix", " ", "the", " ", "first", " ", "one", " ", "in",
            " ", "each", " ", "case"}], ";", " ", 
          RowBox[{"if", " ", "there", " ", "are", " ", "multiple"}]}], ",", 
         " ", 
         RowBox[{
         "come", " ", "back", " ", "and", " ", "fix", " ", "it", " ", "on", 
          " ", "a", " ", "recursive", " ", "call"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{
        "\"\<ev: \>\"", ",", " ", "ev", ",", " ", "\"\< entangled: \>\"", ",",
          " ", "entangled"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"dPrint", "[", 
           RowBox[{
           "\"\<edge \>\"", ",", "#1", ",", " ", 
            "\"\< is entangled by vertices \>\"", ",", " ", "#2"}], "]"}], 
          "&"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"entangled", ",", " ", "ev"}], "}"}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "ev", "]"}], "<", "1"}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "dPrint", "[", "\"\<There are no entanglements remaining.\>\"", 
           "]"}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "tissue", "]"}]}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "...", " ", "code", " ", "to", " ", "fix", " ", "the", " ", "first", 
         " ", "entanglements"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "edges", ",", " ", "vertices", ",", " ", "nextedge", ",", " ", 
           "nextvertex", ",", " ", "nextvertices", ",", " ", "p", ",", " ", 
           "q", ",", " ", "new", ",", " ", "new1", ",", " ", "new2", ",", " ",
            "pnew1", ",", " ", "pnew2", ",", " ", "ep", ",", " ", "eq"}], 
          "}"}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"edges", "=", "entangled"}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"vertices", " ", "=", " ", "ev"}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"rules", " ", "=", " ", 
           RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "Loop", " ", "through", " ", "all", " ", "problem", " ", "edges"}],
            " ", "*)"}], " ", "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "edges", "]"}], ">", "0"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"nextedge", " ", "=", " ", 
              RowBox[{"First", "[", "edges", "]"}]}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"edges", " ", "=", " ", 
              RowBox[{"Rest", "[", "edges", "]"}]}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"nextvertices", "=", 
              RowBox[{"First", "[", "vertices", "]"}]}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"vertices", "=", 
              RowBox[{"Rest", "[", "vertices", "]"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
              "Loop", " ", "through", " ", "all", " ", "problem", " ", 
               "vertices", " ", "on", " ", "all", " ", "problem", " ", 
               "edges"}], " ", "*)"}], "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"While", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "nextvertices", "]"}], ">", "0"}], ",",
                "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"nextvertex", " ", "=", " ", 
                 RowBox[{"First", "[", "nextvertices", "]"}]}], ";", " ", 
                "\[IndentingNewLine]", 
                RowBox[{"nextvertices", "=", 
                 RowBox[{"Rest", "[", "nextvertices", "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"p", ",", " ", "q"}], "}"}], " ", "=", " ", 
                 RowBox[{"e", "[", 
                  RowBox[{"[", "nextedge", "]"}], "]"}]}], ";", "  ", 
                "\[IndentingNewLine]", 
                RowBox[{"dPrint", "[", 
                 RowBox[{
                 "\"\<Fixing edge \>\"", ",", " ", "nextedge", ",", 
                  "\"\< = \>\"", ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"p", ",", " ", "q"}], "}"}], ",", "  ", 
                  "\"\< vertex \>\"", ",", " ", "nextvertex"}], "]"}], ";", 
                " ", "\[IndentingNewLine]", 
                RowBox[{"new", " ", "=", 
                 RowBox[{"Sort", "/@", 
                  RowBox[{"(", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"nextvertex", ",", " ", "#"}], "}"}], "&"}], "/@", 
                    RowBox[{"{", 
                    RowBox[{"p", ",", "q"}], "}"}]}], ")"}]}]}], ";", " ", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"new1", ",", " ", "new2"}], "}"}], "=", "new"}], 
                ";", " ", "\[IndentingNewLine]", 
                RowBox[{"pnew1", "=", 
                 RowBox[{"Position", "[", 
                  RowBox[{"e", ",", "new1"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"pnew2", "=", 
                 RowBox[{"Position", "[", 
                  RowBox[{"e", ",", " ", "new2"}], "]"}]}], ";", " ", 
                "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"dPrint", "[", 
                 RowBox[{
                 "\"\<.. new: \>\"", ",", " ", "new", ",", " ", 
                  "\"\< curently at positions \>\"", ",", " ", "pnew1", ",", 
                  " ", "\"\< and \>\"", ",", " ", "pnew2"}], "]"}], ";", " ", 
                "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", "pnew1", "]"}], "<", "1"}], ",", 
                  " ", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"e", " ", "=", " ", 
                    RowBox[{"Append", "[", 
                    RowBox[{"e", ",", " ", "new1"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"ep", "=", 
                    RowBox[{"Length", "[", "e", "]"}]}], ";"}], " ", ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"ep", " ", "=", " ", 
                   RowBox[{"pnew1", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], 
                 "\[IndentingNewLine]", "]"}], ";", " ", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", "pnew2", "]"}], "<", "1"}], ",", 
                  " ", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"e", " ", "=", " ", 
                    RowBox[{"Append", "[", 
                    RowBox[{"e", ",", " ", "new2"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"eq", "=", 
                    RowBox[{"Length", "[", "e", "]"}]}], ";"}], " ", ",", " ",
                   "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"eq", "  ", "=", " ", 
                    RowBox[{"pnew2", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", " ", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"rules", ",", " ", 
                  RowBox[{"(", 
                   RowBox[{"nextedge", "\[Rule]", " ", 
                    RowBox[{"{", 
                    RowBox[{"ep", ",", " ", "eq"}], "}"}]}], ")"}]}], "]"}], 
                ";", " ", "\[IndentingNewLine]", 
                RowBox[{"dPrint", "[", 
                 RowBox[{"\"\<rules: \>\"", ",", " ", "rules"}], "]"}], 
                ";"}]}], " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              "]"}], ";", "  ", 
             RowBox[{"(*", "  ", 
              RowBox[{"End", " ", "whlie", " ", 
               RowBox[{"Length", "[", "nextvertices", "]"}]}], " ", "*)"}], 
             "\[IndentingNewLine]", "True", ";"}]}], " ", 
           "\[IndentingNewLine]", "]"}], ";", "  ", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"End", " ", "while", " ", 
             RowBox[{"Length", "[", "edges", "]"}]}], ">", "0"}], "*)"}], 
          "\[IndentingNewLine]", "True", ";"}]}], " ", "\[IndentingNewLine]", 
        "]"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"end", " ", "Block"}], " ", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"c", "=", " ", 
        RowBox[{"c", "/.", "rules"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"c", "=", " ", 
        RowBox[{"Flatten", "/@", "c"}]}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"tnew", " ", "=", " ", 
        RowBox[{"Tissue", "[", 
         RowBox[{"v", ",", " ", "e", ",", " ", "c"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"tnew", " ", "=", " ", 
        RowBox[{"UndangleEdges", "[", "tnew", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "tnew", "]"}], ";"}]}], " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}], 
  " "}]], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQB2IQ3f1O7Vz8tpeO657eugCiF/nqXQPRNvsOfAHRny61
/QbRu5Q3gOmod5//g+jN53+zJADppmPGPCD60a0cYRC9z7P8EohusN19BUS/
WvzqBoie9MT3Joje4NZxF0SLnKl9BKKTPsY8A9E+W0+9ANEWd3a8AdGq3uxM
iUBaRcyPDUS3FZqLgGjm6bMVQHTuU0U1EN2000wPRHN4KniC6IzXP3xAtPaU
9aUgmnNLfD2IfsaZ2Q6ifWTe3gLRx22C74PoLRMnvgLR9148/wwW53/yC0R7
BUrqJYHM3aRaAaJ/BZb2gGiWZ+smgGjxY1GTQPQ7Y4OZILpn2uLFIPpbbe8K
EL171oOVIHrr0uZtIPrxjFlgGgA2hc7C
  
  "],ExpressionUUID->"401eb19d-d4b5-484c-8ea0-a72717f05bfd"]
}, Closed]],

Cell[CellGroupData[{

Cell["SmoothCell", "Subsection",
 CellChangeTimes->{{3.451767696872517*^9, 
  3.4517676983824472`*^9}},ExpressionUUID->"e97e9988-add5-49b1-9099-\
f72050658f79"],

Cell["\<\
Removes vertices on boundary that have only two edges incident\
\>", "Text",
 CellChangeTimes->{{3.4517772897516823`*^9, 
  3.4517773143422527`*^9}},ExpressionUUID->"100102eb-c5f4-4d03-b659-\
022e6fc3d42c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SmootheCell", "[", 
     RowBox[{
      RowBox[{"tissue_", "?", "TissueQ"}], ",", " ", 
      RowBox[{"cellNumber_", "?", "IntegerQ"}]}], "]"}], ":=", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"SmootheCells", "[", 
     RowBox[{"tissue", ",", " ", 
      RowBox[{"{", "cellNumber", "}"}]}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SmootheCell", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", "\"\<Error: expecting SmootheCell[tissue, integer]\>\"", 
       "]"}], ";", " ", "$Failed"}], ")"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4517676999452343`*^9, 3.451767727216419*^9}, 
   3.4517677827759857`*^9, 3.4517678270185947`*^9, {3.4517678604999323`*^9, 
   3.451768301205974*^9}, {3.451768843909699*^9, 3.4517688882071342`*^9}, {
   3.4517689382777643`*^9, 3.451769072714859*^9}, {3.451769112927802*^9, 
   3.45176911915342*^9}, {3.451769211442626*^9, 3.45176923231781*^9}, {
   3.451769262911092*^9, 3.451769327808786*^9}, {3.451769415652623*^9, 
   3.451769469023815*^9}, {3.451769500448698*^9, 3.45176954824404*^9}, {
   3.451769720482478*^9, 3.451769933734305*^9}, {3.451769970153489*^9, 
   3.451769971737952*^9}, {3.451770007225588*^9, 3.451770027361425*^9}, {
   3.45177583927072*^9, 3.451775910764084*^9}, {3.451775961877215*^9, 
   3.451776022183847*^9}, {3.451776500694821*^9, 
   3.4517765328279533`*^9}},ExpressionUUID->"0910ae82-0d9b-4fed-b669-\
6c395b277e74"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SmootheCells", "[", 
     RowBox[{
      RowBox[{"tissue_", "?", "TissueQ"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"cellNumbers___", "?", "IntegerQ"}], "}"}], ",", " ", 
      RowBox[{"dbg_:", "False"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "c", ",", "v", ",", "e", ",", " ", "nc", ",", " ", "ne", ",", " ", 
        "bc", ",", "be", ",", "  ", "cell", ",", "edges", ",", "dPrint", ",", 
        " ", "newEdge", ",", " ", "newCell", ",", " ", "vertices", ",", " ", 
        "sortedEdgeNumbers", ",", " ", "cellNumber", ",", "newTissue", ",", 
        " ", "cn"}], "}"}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"dPrint", "[", "x___", "]"}], ":=", " ", 
        RowBox[{"If", "[", 
         RowBox[{"dbg", ",", " ", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<SmoothCell: \>\"", ",", " ", "x"}], "]"}]}], "]"}]}], 
       ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"cn", "=", 
        RowBox[{"{", "cellNumbers", "}"}]}], ";", " ", "\[IndentingNewLine]", 
       
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "cn", "]"}], "\[Equal]", "0"}], ",", " ", 
         RowBox[{"Return", "[", "tissue", "]"}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"newTissue", "=", "tissue"}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "cn", "]"}], ">", "0"}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"cellNumber", "=", 
           RowBox[{"First", "[", "cn", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"cn", "=", 
           RowBox[{"Rest", "[", "cn", "]"}]}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"c", "=", 
           RowBox[{"TissueCells", "[", "newTissue", "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"nc", "=", 
           RowBox[{"Length", "[", "c", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"e", "=", 
           RowBox[{"TissueEdges", "[", "newTissue", "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"v", "=", 
           RowBox[{"TissueVertices", "[", "newTissue", "]"}]}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"AbortIf", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "c", "]"}], "\[Equal]", "0"}], ",", " ", 
            "\"\<SmootheCells: no cells in tissue.\>\""}], "]"}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"AbortIf", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "e", "]"}], "\[Equal]", "0"}], ",", " ", 
            "\"\<SmootheCells: no edges in tissue.\>\""}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AbortIf", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "v", "]"}], "\[Equal]", "0"}], ",", " ", 
            "\"\<SmootheCells: no vertices in tissue.\>\""}], "]"}], ";", " ",
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"test", " ", "for", " ", "existing", " ", "cell"}], " ", 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"AbortIf", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"cellNumber", "<", "1"}], " ", "\[Or]", " ", 
             RowBox[{"cellNumber", ">", "nc"}]}], ",", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<SmootheCells: attempt to remove cell \>\"", "<>", 
             RowBox[{"ToString", "[", "cellNumber", "]"}], "<>", 
             "\"\< failed in tissue with \>\"", "<>", 
             RowBox[{"ToString", "[", "nc", "]"}], "<>", 
             "\"\< cells (possible program error).\>\""}]}], "]"}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"test", " ", "for", " ", "smoothable", " ", "cell"}], " ", 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"bc", " ", "=", " ", 
           RowBox[{"CellsOnBoundary", "[", "newTissue", "]"}]}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"AbortIf", "[", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"MemberQ", "[", 
              RowBox[{"bc", ",", " ", "cellNumber"}], "]"}]}], ",", " ", 
            RowBox[{"\"\<SmootheCells: SmoothCell: Cell \>\"", "<>", 
             RowBox[{"ToString", "[", "cellNumber", "]"}], "<>", 
             "\"\< is not on the boundary.\>\""}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"be", "=", 
           RowBox[{"EdgesOnBoundary", "[", "newTissue", "]"}]}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"first", ",", " ", 
            RowBox[{
            "cell", " ", "gives", " ", "the", " ", "list", " ", "of", " ", 
             "all", " ", "edges", " ", "in", " ", "the", " ", "cell"}]}], " ",
            "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"cell", " ", "=", " ", 
           RowBox[{"c", "[", 
            RowBox[{"[", "cellNumber", "]"}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"AbortIf", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "cell", "]"}], "\[Equal]", "0"}], " ", 
            ",", " ", 
            RowBox[{"\"\<SmootheCell: Cell \>\"", "<>", 
             RowBox[{"ToString", "[", "cellNumber", "]"}], "<>", 
             "\"\< ceased to exist (possible program error).\>\""}]}], "]"}], 
          ";", " ", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "then", " ", "cell", " ", "gives", " ", "the", " ", "list", " ", 
            "of", " ", "edge", " ", "numbers", " ", "in", " ", "the", " ", 
            "cell", " ", "on", " ", "the", " ", "boundary"}], " ", "*)"}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"cell", " ", "=", " ", 
           RowBox[{"Intersection", "[", 
            RowBox[{"cell", ",", " ", "be"}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"AbortIf", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "cell", "]"}], "\[Equal]", "0"}], " ", 
            ",", " ", 
            RowBox[{"\"\<SmootheCell: Cell \>\"", "<>", 
             RowBox[{"ToString", "[", "cellNumber", "]"}], "<>", 
             "\"\<has no boundary edges.\>\""}]}], "]"}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{
           "\"\<edges on the boundary in cell \>\"", ",", " ", "cellNumber", 
            ",", " ", "\"\<: \>\"", ",", " ", "cell"}], "]"}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "now", " ", "edges", " ", "collects", " ", "the", " ", "vertices", 
            " ", "of", " ", "the", " ", "endpoints", " ", "of", " ", "these", 
            " ", "edges", " ", "on", " ", "the", " ", "boundary"}], " ", 
           "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"edges", " ", "=", " ", 
           RowBox[{"e", "[", 
            RowBox[{"[", "cell", "]"}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{
           "\"\<edge Vertex numbers in cell \>\"", ",", " ", "cellNumber", 
            ",", " ", "\"\<: \>\"", ",", " ", "edges"}], "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "the", " ", "following", " ", "block", " ", "picks", " ", "up", 
            " ", "every", " ", "vertex", " ", "that", " ", "is", " ", "not", 
            " ", "shared", " ", "by", " ", "more", " ", "than", " ", "one", 
            " ", "edge"}], " ", "*)"}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "verticesInCellOnBoundary", ",", " ", "keepers", ",", " ", 
              "uniqueVertices"}], "}"}], ",", " ", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"verticesInCellOnBoundary", "=", 
              RowBox[{"Flatten", "[", "edges", "]"}]}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"uniqueVertices", "=", 
              RowBox[{"Union", "[", "verticesInCellOnBoundary", "]"}]}], ";", 
             "  ", "\[IndentingNewLine]", 
             RowBox[{"keepers", " ", "=", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"Position", "[", 
                    RowBox[{"verticesInCellOnBoundary", ",", " ", "#"}], 
                    "]"}], "]"}], "<", "2"}], ")"}], "&"}], "/@", 
               "uniqueVertices"}]}], ";", " ", "\[IndentingNewLine]", 
             RowBox[{"newEdge", " ", "=", " ", 
              RowBox[{"Pick", "[", 
               RowBox[{"uniqueVertices", ",", " ", "keepers"}], "]"}]}], ";", 
             " ", "\[IndentingNewLine]", 
             RowBox[{"newEdge", "=", 
              RowBox[{"Sort", "[", "newEdge", "]"}]}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"dPrint", "[", 
              RowBox[{"\"\<vertices on new Edge: \>\"", ",", " ", "newEdge"}],
               "]"}], ";"}]}], " ", "\[IndentingNewLine]", "]"}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"add", " ", "the", " ", "new", " ", "edge"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"AbortIf", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "newEdge", "]"}], ">", "2"}], ",", 
            RowBox[{
            "\"\<SmootheCell: Attempt to smoothe boundary on a cell that may \
have multiple disconnected boundary segments. Cell=\>\"", "<>", 
             RowBox[{"ToString", "[", "cellNumber", "]"}], "<>", 
             "\"\< edges = \>\"", "<>", 
             RowBox[{"ToString", "[", "edges", "]"}], "<>", 
             "\"\< The algorithm has not been implemented to cover this case. \
It may have occured as a result of random number generation by Cellzilla. If \
this is the case then re-run the program. \>\""}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"e", "=", 
           RowBox[{"Append", "[", 
            RowBox[{"e", ",", " ", "newEdge"}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"ne", "=", 
           RowBox[{"Length", "[", "e", "]"}]}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"newCell", " ", "=", " ", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"Complement", "[", 
              RowBox[{
               RowBox[{"c", "[", 
                RowBox[{"[", "cellNumber", "]"}], "]"}], ",", " ", "cell"}], 
              "]"}], ",", " ", "ne"}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"vertices", " ", "=", " ", 
           RowBox[{"e", "[", 
            RowBox[{"[", "newCell", "]"}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{
           "\"\<Edges in revised cell \>\"", ",", " ", "cellNumber", ",", 
            "\"\<:\>\"", ",", " ", "newCell"}], "]"}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{
           "\"\<Vertices in revised cell \>\"", ",", " ", "cellNumber", ",", 
            " ", "\"\<:\>\"", ",", " ", "vertices"}], "]"}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"sortedEdgeNumbers", "=", 
           RowBox[{"\"\<Edges\>\"", "/.", 
            RowBox[{"SortCellEdges", "[", 
             RowBox[{
              RowBox[{"Range", "[", 
               RowBox[{"Length", "[", "newCell", "]"}], "]"}], ",", " ", 
              "vertices"}], "]"}]}]}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"sortedEdgeNumbers", "=", 
           RowBox[{"newCell", "[", 
            RowBox[{"[", "sortedEdgeNumbers", "]"}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{
           "\"\<Sorted Edge numbers in revised cell \>\"", ",", " ", 
            "cellNumber", ",", " ", "\"\<:\>\"", ",", " ", 
            "sortedEdgeNumbers"}], "]"}], ";", " ", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"modify", " ", "the", " ", "cell"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"c", "=", 
           RowBox[{"ReplacePart", "[", 
            RowBox[{"c", ",", " ", 
             RowBox[{"cellNumber", "\[Rule]", " ", "sortedEdgeNumbers"}]}], 
            "]"}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"newTissue", "=", 
           RowBox[{"Tissue", "[", 
            RowBox[{"v", ",", "e", ",", "c"}], "]"}]}], ";"}]}], " ", 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"newTissue", "=", 
        RowBox[{"UndangleEdges", "[", "newTissue", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"newTissue", "=", 
        RowBox[{"UndangleVertices", "[", "newTissue", "]"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"added", " ", 
         RowBox[{"2.1", ".", "\[Alpha]"}], ".20"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "newTissue", "]"}], ";"}]}], " ", 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SmootheCells", "[", 
     RowBox[{"tissue_", "?", "TissueQ"}], "]"}], ":=", " ", 
    RowBox[{"SmootheCells", "[", 
     RowBox[{"tissue", ",", " ", 
      RowBox[{"CellsOnBoundary", "[", "tissue", "]"}]}], "]"}]}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SmootheCells", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Error: expecting SmootheCells[tissue, {integer, integer, \
...}]\>\"", "]"}], ";", " ", "$Failed"}], ")"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4517676999452343`*^9, 3.451767727216419*^9}, 
   3.4517677827759857`*^9, 3.4517678270185947`*^9, {3.4517678604999323`*^9, 
   3.451768301205974*^9}, {3.451768843909699*^9, 3.4517688882071342`*^9}, {
   3.4517689382777643`*^9, 3.451769072714859*^9}, {3.451769112927802*^9, 
   3.45176911915342*^9}, {3.451769211442626*^9, 3.45176923231781*^9}, {
   3.451769262911092*^9, 3.451769327808786*^9}, {3.451769415652623*^9, 
   3.451769469023815*^9}, {3.451769500448698*^9, 3.45176954824404*^9}, {
   3.451769720482478*^9, 3.451769933734305*^9}, {3.451769970153489*^9, 
   3.451769971737952*^9}, {3.451770007225588*^9, 3.451770027361425*^9}, {
   3.45177583927072*^9, 3.451775910764084*^9}, {3.451775961877215*^9, 
   3.451776022183847*^9}, {3.451776069871188*^9, 3.451776122182362*^9}, {
   3.4517761535044603`*^9, 3.451776276318882*^9}, {3.4517764331846457`*^9, 
   3.451776442305826*^9}, {3.451776537838966*^9, 3.4517765505720863`*^9}, {
   3.451776739446321*^9, 3.4517767656806717`*^9}, {3.488798699915183*^9, 
   3.488798718414274*^9}, {3.578519685355879*^9, 3.5785197485937347`*^9}, 
   3.578519863365699*^9, {3.5785200126778297`*^9, 3.57852001357091*^9}, {
   3.578520081420926*^9, 3.578520266581387*^9}, {3.578520432874345*^9, 
   3.578520438517207*^9}, 3.578520490982397*^9, {3.578520580973007*^9, 
   3.578520684416251*^9}, {3.5785731974290457`*^9, 3.5785732289111843`*^9}, {
   3.5785776902556973`*^9, 3.578577698756402*^9}, {3.578579601126297*^9, 
   3.5785796143051357`*^9}, {3.578579692422914*^9, 3.5785797998694353`*^9}, {
   3.57857990060506*^9, 3.5785799252987413`*^9}, {3.5785800242032843`*^9, 
   3.5785801114896183`*^9}},ExpressionUUID->"b8bdb6bf-119b-4b07-a842-\
de4f0a168da0"]
}, Closed]],

Cell[CellGroupData[{

Cell["ConnectionList, Matrix", "Subsection",
 CellChangeTimes->{{3.4523285194661016`*^9, 3.452328520929214*^9}, {
  3.4523295712963448`*^9, 
  3.452329572239099*^9}},ExpressionUUID->"335cd39e-3c72-4a4a-a93f-\
c1bf159b9b98"],

Cell[CellGroupData[{

Cell["Tissue Form", "Subsubsection",
 CellChangeTimes->{{3.457387949055461*^9, 
  3.4573879508540783`*^9}},ExpressionUUID->"233b2caf-32f9-4584-bbb0-\
fbf1b4a4c876"],

Cell["\<\
2.1.a.14 - fix to include nth cell; change impl. of connection matrix to use \
connection list\
\>", "Text",
 CellChangeTimes->{{3.459540147384972*^9, 
  3.4595401647175303`*^9}},ExpressionUUID->"40ced38e-03cf-4d57-a684-\
8bc039e5abbd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConnectionList", "[", 
     RowBox[{
      RowBox[{"tissue_", "?", "TissueQ"}], ",", " ", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "c", ",", " ", "clist", ",", " ", "n", ",", " ", "i", ",", " ", 
        "cell1", ",", " ", "connections", ",", " ", "cellnums", ",", " ", 
        "ut"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"c", "=", 
        RowBox[{"TissueCells", "[", "tissue", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"clist", "=", 
        RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "c", "]"}]}], ";", " ", "\[IndentingNewLine]", 
       
       RowBox[{"cellnums", " ", "=", " ", 
        RowBox[{"Range", "[", "n", "]"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", " ", 
         RowBox[{"i", "\[LessEqual]", " ", "n"}], ",", " ", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"cell1", "=", 
           RowBox[{"c", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"connections", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"Intersection", "[", 
                 RowBox[{"cell1", ",", "#"}], "]"}], "]"}], ">", "0"}], ")"}],
              "&"}], "/@", "c"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"connections", "=", 
           RowBox[{"Pick", "[", 
            RowBox[{"cellnums", ",", " ", "connections"}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"connections", "=", 
           RowBox[{"Complement", "[", 
            RowBox[{"connections", ",", " ", 
             RowBox[{"{", "i", "}"}]}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"connections", " ", "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", "#"}], "}"}], "&"}], "/@", "connections"}]}], 
          ";", " ", "\[IndentingNewLine]", 
          RowBox[{"clist", " ", "=", " ", 
           RowBox[{"Join", "[", 
            RowBox[{"clist", ",", " ", "connections"}], "]"}]}], ";"}]}], " ",
         "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"clist", "=", 
        RowBox[{"Sort", "[", "clist", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"ut", "=", 
        RowBox[{
         RowBox[{"\"\<UpperTriangular\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<UpperTriangular\>\"", "\[Rule]", " ", "False"}], 
          "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"ut", ",", " ", 
         RowBox[{"clist", " ", "=", " ", 
          RowBox[{"Select", "[", 
           RowBox[{"clist", ",", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ">", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "&"}]}], "]"}]}]}], 
        "]"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "clist", "]"}], ";"}]}], " ", 
     "\[IndentingNewLine]", "]"}]}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConnectionMatrix", "[", 
     RowBox[{
      RowBox[{"tissue_", "?", "TissueQ"}], ",", " ", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"SparseArray", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"#", "\[Rule]", " ", "1"}], ")"}], "&"}], "/@", 
      RowBox[{"ConnectionList", "[", 
       RowBox[{"tissue", ",", " ", "opt"}], "]"}]}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "clist", ",", " ", "n", ",", " ", "mat", ",", " ", "i", ",", " ", "p", 
        ",", " ", "q"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"clist", "=", 
        RowBox[{"ConnectionList", "[", 
         RowBox[{"tissue", ",", "opt"}], "]"}]}], ";", "\[IndentingNewLine]", 
       " ", 
       RowBox[{"n", "=", 
        RowBox[{"NTissueCells", "[", "tissue", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"mat", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", " ", 
          RowBox[{"{", 
           RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "clist", "]"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"p", ",", "q"}], "}"}], "=", 
           RowBox[{"First", "[", "clist", "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"clist", "=", 
           RowBox[{"Rest", "[", "clist", "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"mat", "[", 
            RowBox[{"[", 
             RowBox[{"p", ",", "q"}], "]"}], "]"}], "=", "1"}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"SparseArray", "[", "mat", "]"}], "]"}], ";"}]}], " ", 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "*)"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.452328522105218*^9, 3.452328523534855*^9}, {
  3.4523286354701366`*^9, 3.45232868771262*^9}, {3.452328755005212*^9, 
  3.4523287720696163`*^9}, {3.4523288086839647`*^9, 3.452328809436963*^9}, {
  3.452328914779546*^9, 3.4523292423906*^9}, {3.452329285191516*^9, 
  3.452329397610087*^9}, {3.452329575245956*^9, 3.452329623076692*^9}, {
  3.4523296825739393`*^9, 3.452329815306039*^9}, {3.4523300409798594`*^9, 
  3.452330045069812*^9}, {3.4523302504776278`*^9, 3.452330251515394*^9}, {
  3.457387969695774*^9, 3.4573879756303988`*^9}, {3.459540009598127*^9, 
  3.4595400097371683`*^9}, {3.459540120894061*^9, 
  3.459540140446145*^9}},ExpressionUUID->"77b512c0-dd44-41e9-84bb-\
42d27a7d3a4f"]
}, Closed]],

Cell[CellGroupData[{

Cell["Torus Form", "Subsubsection",
 CellChangeTimes->{{3.457387959210725*^9, 
  3.457387961234742*^9}},ExpressionUUID->"fbcf3877-8328-40e0-b553-\
f7a4ef24321b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConnectionList", "[", 
     RowBox[{
      RowBox[{"torus_", "?", "TorusQ"}], ",", " ", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "c", ",", " ", "clist", ",", " ", "tissue", ",", " ", "rules", ",", 
        " ", "incell", ",", " ", "r", ",", " ", "ut"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tissue", " ", "=", " ", 
        RowBox[{"TorusTissue", "[", "torus", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"c", "=", 
        RowBox[{"TissueCells", "[", "tissue", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"basic", " ", "connection", " ", "list"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"clist", " ", "=", " ", 
        RowBox[{"ConnectionList", "[", 
         RowBox[{"tissue", ",", " ", "opt"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"include", " ", "also", " ", "toroidal", " ", "connections"}],
         " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"rules", " ", "=", " ", 
        RowBox[{"TorusRules", "[", "torus", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"InCell", "[", 
         RowBox[{"Rule", "[", 
          RowBox[{"a_", ",", "b_"}], "]"}], "]"}], ":=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{"c", ",", "a"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", 
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{"c", ",", "b"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"r", "=", 
        RowBox[{"InCell", "/@", "rules"}]}], ";", " ", "\[IndentingNewLine]", 
       
       RowBox[{"r", "=", 
        RowBox[{"Sort", "[", 
         RowBox[{"Join", "[", 
          RowBox[{"r", ",", " ", 
           RowBox[{"Reverse", "/@", "r"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"clist", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{"clist", ",", " ", "r"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"clist", " ", "=", " ", 
        RowBox[{"Sort", "[", "clist", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"ut", "=", 
        RowBox[{
         RowBox[{"\"\<UpperTriangular\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<UpperTriangular\>\"", "\[Rule]", " ", "False"}], 
          "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"ut", ",", " ", 
         RowBox[{"clist", " ", "=", " ", 
          RowBox[{"Select", "[", 
           RowBox[{"clist", ",", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ">", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "&"}]}], "]"}]}]}], 
        "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "clist", "]"}], ";"}]}], " ", 
     "\[IndentingNewLine]", "]"}]}], ";"}], " ", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConnectionMatrix", "[", 
     RowBox[{
      RowBox[{"torus_", "?", "TorusQ"}], ",", " ", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"SparseArray", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"#", "\[Rule]", " ", "1"}], ")"}], "&"}], "/@", 
      RowBox[{"ConnectionList", "[", 
       RowBox[{"torus", ",", " ", "opt"}], "]"}]}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "clist", ",", " ", "n", ",", " ", "mat", ",", " ", "i", ",", " ", "p", 
        ",", " ", "q"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"clist", "=", 
        RowBox[{"ConnectionList", "[", 
         RowBox[{"torus", ",", "opt"}], "]"}]}], ";", "\[IndentingNewLine]", 
       " ", 
       RowBox[{"n", "=", 
        RowBox[{"NTissueCells", "[", 
         RowBox[{"TorusTissue", "[", "torus", "]"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"mat", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", " ", 
          RowBox[{"{", 
           RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "clist", "]"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"p", ",", "q"}], "}"}], "=", 
           RowBox[{"First", "[", "clist", "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"clist", "=", 
           RowBox[{"Rest", "[", "clist", "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"mat", "[", 
            RowBox[{"[", 
             RowBox[{"p", ",", "q"}], "]"}], "]"}], "=", "1"}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"SparseArray", "[", "mat", "]"}], "]"}], ";"}]}], " ", 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "*)"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.457387989101552*^9, 3.457388109281931*^9}, {
  3.4573914641246233`*^9, 3.457391489974321*^9}, {3.457391527356737*^9, 
  3.4573915569117413`*^9}, {3.457391742106563*^9, 3.457391795454341*^9}, {
  3.457391868366551*^9, 3.457391978376268*^9}, {3.4573920355955877`*^9, 
  3.457392091668563*^9}, {3.459540209123128*^9, 
  3.459540225478106*^9}},ExpressionUUID->"acd8755a-4dc8-4ee0-86c5-\
a05de08db7fd"]
}, Closed]],

Cell[CellGroupData[{

Cell["Error Form", "Subsubsection",
 CellChangeTimes->{{3.4573879635426826`*^9, 
  3.457387964756773*^9}},ExpressionUUID->"6707ecad-8680-4ed8-9160-\
a4dc98db743f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConnectionList", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", "\"\<Error: Expecting ConnectionList[tissue].\>\"", "]"}],
       ";", " ", "$Failed"}], ")"}]}], ";", " ", 
   RowBox[{
    RowBox[{"ConnectionMatrix", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", "\"\<Error: Expecting ConnectionMatrix[tissue].\>\"", 
       "]"}], ";", " ", "$Failed"}], ")"}]}], ";"}], " "}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.457387978262432*^9},ExpressionUUID->"378ae14f-f980-4c2e-91fd-\
0466b6381c71"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["InLineVertices", "Subsection",
 CellChangeTimes->{{3.456688889146058*^9, 
  3.456688911048623*^9}},ExpressionUUID->"5f6cb472-3af3-43cc-9692-\
f0366d565f27"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"InLineVertices", "[", 
    RowBox[{
     RowBox[{"tissue_", "?", "TissueQ"}], ",", " ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "dbg", ",", " ", "dPrint", ",", "v", ",", "e", ",", " ", "nv", ",", 
       "vn", ",", " ", "VerticesInEdge", ",", " ", "vie", ",", " ", 
       "candidates", ",", " ", "removable", ",", " ", "inline", ",", " ", 
       "vertices", ",", " ", "ok"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dbg", "=", 
       RowBox[{
        RowBox[{"\"\<Debug\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Debug\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dPrint", "[", "x___", "]"}], ":=", " ", 
       RowBox[{"If", "[", 
        RowBox[{"dbg", ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<InLineVertices: \>\"", ",", " ", "x"}], "]"}]}], 
        "]"}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"vertices", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<Vertices\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"\"\<Vertices\>\"", "\[Rule]", " ", "\"\<All\>\""}]}]}], ";", 
      " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{"TissueVertices", "[", "tissue", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"e", "=", 
       RowBox[{"TissueEdges", "[", "tissue", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"nv", "=", 
       RowBox[{"Length", "[", "v", "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"vn", "=", 
       RowBox[{"Range", "[", "nv", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{"vertices", "===", " ", "\"\<All\>\""}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ok", " ", "=", " ", 
          RowBox[{
           RowBox[{"ListQ", "[", "vertices", "]"}], " ", "\[And]", " ", 
           RowBox[{"And", "@@", 
            RowBox[{"(", 
             RowBox[{"IntegerQ", "/@", "vertices"}], ")"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"ok", ",", " ", 
           RowBox[{"ok", " ", "=", " ", 
            RowBox[{"ok", " ", "\[And]", 
             RowBox[{"And", "@@", 
              RowBox[{"(", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "\[GreaterEqual]", " ", "0"}], ")"}], 
                    "\[And]", 
                    RowBox[{"(", 
                    RowBox[{"#", "\[LessEqual]", " ", "nv"}], ")"}]}], ")"}], 
                  "&"}], "/@", "vertices"}], ")"}], ")"}]}]}]}]}], "]"}], ";",
          " ", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", "ok"}], ",", " ", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{
             "\"\<Error: InLineVertices: Invalid \\\"Vertices\\\"=\>\"", ",", 
              " ", "vertices"}], "]"}], ";", " ", 
            RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"vn", "=", "vertices"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "find", " ", "vertices", " ", "that", " ", "topologically", " ", 
        "connect", " ", "precisely", " ", "two", " ", "edges"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"VerticesInEdge", "[", "vertexNumber_", "]"}], ":=", " ", 
       RowBox[{"First", "/@", 
        RowBox[{"Position", "[", 
         RowBox[{"e", ",", "vertexNumber"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vie", " ", "=", " ", 
       RowBox[{"VerticesInEdge", "/@", "vn"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vie", " ", "=", " ", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"vn", ",", "vie"}], "}"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"candidates", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"vie", ",", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], "\[Equal]", "2"}], ")"}],
           "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<candidates: \>\"", ",", " ", "candidates"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"removable", "[", 
        RowBox[{"vnum_", ",", " ", 
         RowBox[{"{", 
          RowBox[{"e1_", ",", "e2_"}], "}"}]}], "]"}], ":=", " ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "v1", ",", "v2", ",", " ", "edge1", ",", " ", "edge2", ",", " ", 
           "onSeg"}], " ", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"edge1", "=", 
           RowBox[{"e", "[", 
            RowBox[{"[", "e1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"edge2", "=", 
           RowBox[{"e", "[", 
            RowBox[{"[", "e2", "]"}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"v1", "=", 
           RowBox[{
            RowBox[{"Complement", "[", 
             RowBox[{"edge1", ",", " ", 
              RowBox[{"{", "vnum", "}"}]}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"v2", "=", 
           RowBox[{
            RowBox[{"Complement", "[", 
             RowBox[{"edge2", ",", " ", 
              RowBox[{"{", "vnum", "}"}]}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]",
           "\[IndentingNewLine]", 
          RowBox[{"onSeg", " ", "=", " ", 
           RowBox[{"PointOnLineSegment", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"v", "[", 
                RowBox[{"[", "v1", "]"}], "]"}], ",", " ", 
               RowBox[{"v", "[", 
                RowBox[{"[", "v2", "]"}], "]"}]}], "}"}], ",", " ", 
             RowBox[{"v", "[", 
              RowBox[{"[", "vnum", "]"}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<{v, v1, v2, onSeg}:\>\"", ",", " ", 
            RowBox[{"{", 
             RowBox[{"vnum", ",", " ", "v1", ",", "v2", ",", " ", "onSeg"}], 
             "}"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "onSeg", "]"}], ";"}]}], " ", 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"inline", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"removable", "@@", "#"}], "&"}], "/@", "candidates"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"candidates", "=", 
         RowBox[{"First", "/@", "candidates"}]}], ";"}], "*)"}], "  ", 
      "\[IndentingNewLine]", 
      RowBox[{"inline", " ", "=", " ", 
       RowBox[{"Pick", "[", 
        RowBox[{"candidates", ",", " ", "inline"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "inline", "]"}], ";"}]}], " ", 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InLineVertices", "[", "x___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
    "Print", "[", "\"\<Error: Expecting InLineVertices[tissue].\>\"", "]"}], 
    ";", 
    RowBox[{"Return", "[", "$Failed", "]"}], ";"}], ")"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4566889128697433`*^9, 3.456688960432406*^9}, {
  3.4566889956189613`*^9, 3.456689142854549*^9}, {3.4566891882303667`*^9, 
  3.456689216422101*^9}, {3.456689256337007*^9, 3.456689323419921*^9}, {
  3.4566893603247547`*^9, 3.456689360446909*^9}, {3.456689408317471*^9, 
  3.456689546049921*^9}, {3.456689587271134*^9, 3.4566898194599667`*^9}, {
  3.4566898686129503`*^9, 3.4566898841300907`*^9}, {3.456690114811953*^9, 
  3.45669022475596*^9}, {3.456691160893374*^9, 3.4566911755126667`*^9}, {
  3.456691210765401*^9, 3.45669122457253*^9}, {3.45669125838513*^9, 
  3.4566913221677732`*^9}, {3.456691445763975*^9, 3.456691673777113*^9}, {
  3.456691705196743*^9, 3.45669185925027*^9}, {3.456691911917802*^9, 
  3.4566919481144247`*^9}, {3.456692327545168*^9, 
  3.456692331819522*^9}},ExpressionUUID->"6833d526-9ee8-479d-a765-\
4fbde8faab69"]
}, Closed]],

Cell[CellGroupData[{

Cell["VertexNeighbors", "Subsection",
 CellChangeTimes->{{3.488799369754788*^9, 
  3.4887993717542477`*^9}},ExpressionUUID->"aa7572db-311e-4107-9334-\
4879621aef54"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"VertexNeighbors", "[", 
    RowBox[{"tis_Tissue", ",", " ", "n_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Complement", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"TissueEdges", "[", "tis", "]"}], ",", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"#", ",", "n"}], "]"}], "&"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", "n", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"VertexNeighbors", "[", "tis_Tissue", "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "n", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"NTissueVertices", "[", "tis", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"VertexNeighbors", "[", 
          RowBox[{"tis", ",", "#"}], "]"}], "&"}], "/@", 
        RowBox[{"Range", "[", "n", "]"}]}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"VertexNeighbors", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", "\"\<Expecting VertexNeighbors[tissue, integer]\>\"", 
       "]"}], ";", " ", 
      RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.488799372972013*^9, 3.4887994273794603`*^9}, {
  3.488799544328429*^9, 3.488799570549848*^9}, {3.4887996654867563`*^9, 
  3.48879971536629*^9}, {3.4888000998211*^9, 
  3.488800133923635*^9}},ExpressionUUID->"b1111a1d-d967-4ff5-b333-\
92b073feb21e"]
}, Closed]],

Cell[CellGroupData[{

Cell["CellNeighbors", "Subsection",
 CellChangeTimes->{{3.459266741571025*^9, 
  3.4592667433552027`*^9}},ExpressionUUID->"6d55501e-8bf6-43a6-9fc9-\
f35e669a117f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CellNeighbors", "[", 
     RowBox[{
      RowBox[{"tis_", "?", "TissueQ"}], ",", " ", 
      RowBox[{"p_", "?", "IntegerQ"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"rv", ",", " ", "n"}], "}"}], ",", " ", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"NTissueCells", "[", "tis", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"p", ">", "n"}], " ", "\[Or]", " ", 
          RowBox[{"p", "<", "1"}]}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Error: CellNeighbors: Requested Cell Number \>\"", ",", " ", 
            "p", ",", " ", "\"\< does not exist. \>\""}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "$Failed", "]"}], ";"}]}], " ", 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"rv", "=", 
        RowBox[{"Complement", "[", 
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{"ConnectionList", "[", "tis", "]"}], ",", " ", 
              RowBox[{
               RowBox[{"MemberQ", "[", 
                RowBox[{"#", ",", " ", "p"}], "]"}], "&"}]}], "]"}], "]"}], 
           "]"}], ",", " ", 
          RowBox[{"{", "p", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "rv", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
    ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CellNeighbors", "[", 
     RowBox[{
      RowBox[{"tis_", "?", "TorusQ"}], ",", " ", 
      RowBox[{"p_", "?", "IntegerQ"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"rv", ",", " ", "n"}], "}"}], ",", " ", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"NTissueCells", "[", 
         RowBox[{"TorusTissue", "[", "tis", "]"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"p", ">", "n"}], " ", "\[Or]", " ", 
          RowBox[{"p", "<", "1"}]}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Error: CellNeighbors: Requested Cell Number \>\"", ",", " ", 
            "p", ",", " ", "\"\< does not exist. \>\""}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "$Failed", "]"}], ";"}]}], " ", 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"rv", "=", 
        RowBox[{"Complement", "[", 
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{"ConnectionList", "[", "tis", "]"}], ",", " ", 
              RowBox[{
               RowBox[{"MemberQ", "[", 
                RowBox[{"#", ",", " ", "p"}], "]"}], "&"}]}], "]"}], "]"}], 
           "]"}], ",", " ", 
          RowBox[{"{", "p", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "rv", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
    ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CellNeighbors", "[", 
    RowBox[{"tis_", "?", "TissueOrTorusQ"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", ",", " ", "clist", ",", " ", "nbrs"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"NTissueCells", "[", "tis", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"clist", " ", "=", " ", 
       RowBox[{"ConnectionList", "[", "tis", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nbrs", "[", "p_", "]"}], ":=", " ", "\[IndentingNewLine]", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"Union", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Select", "[", 
            RowBox[{"clist", ",", " ", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{"#", ",", " ", "p"}], "]"}], "&"}]}], "]"}], "]"}], 
          "]"}], ",", " ", 
         RowBox[{"{", "p", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"nbrs", "/@", 
        RowBox[{"Range", "[", "n", "]"}]}], " ", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CellNeighbors", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Expecting CellNeigbors[tissue, n] or CellNeighbors[Torus, n]\>\"",
        "]"}], ";", " ", 
      RowBox[{"Return", "[", "$Failed", "]"}]}], ")"}]}], ";"}], 
  " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.459266744490664*^9, 3.4592667635857058`*^9}, {
  3.459266879499819*^9, 3.459266892848914*^9}, {3.4592669541701193`*^9, 
  3.459267149342711*^9}, {3.45926718792563*^9, 3.459267294137829*^9}, {
  3.45927578452962*^9, 3.459275889090436*^9}, {3.4592759566154127`*^9, 
  3.459275982482559*^9}, {3.459603404745213*^9, 3.459603431784614*^9}, {
  3.459603464344679*^9, 
  3.459603469411268*^9}},ExpressionUUID->"8979613c-751f-4bd4-be19-\
04ce79c89730"]
}, Closed]],

Cell[CellGroupData[{

Cell["Edge(s)Between", "Subsection",
 CellChangeTimes->{{3.4592664921381397`*^9, 3.4592664936868*^9}, {
  3.459268440358038*^9, 3.459268442397024*^9}, {3.459277409818213*^9, 
  3.459277410150714*^9}},ExpressionUUID->"dde607c9-7fed-4b41-8171-\
4ad4c81988f0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"EdgeBetween", "[", 
    RowBox[{
     RowBox[{"Q_", "?", "TissueQ"}], ",", " ", 
     RowBox[{"p_", "?", "IntegerQ"}], ",", " ", 
     RowBox[{"q_", "?", "IntegerQ"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"c", ",", "nc", ",", "\[IndentingNewLine]", "edgeNumber"}], 
      "}"}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "=", 
       RowBox[{"TissueCells", "[", "Q", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"nc", "=", 
       RowBox[{"Length", "[", "c", "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"p", "\[Equal]", "q"}], ",", "  ", 
        RowBox[{"Return", "[", 
         RowBox[{"{", "}"}], "]"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
      
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"p", ">", "nc"}], " ", "\[Or]", " ", 
         RowBox[{"q", ">", "nc"}], " ", "\[Or]", " ", 
         RowBox[{"p", "<", "1"}], " ", "\[Or]", " ", 
         RowBox[{"q", "<", "1"}]}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Error: EdgeBetween: invalid connection: \>\"", ",", " ", 
           RowBox[{"{", 
            RowBox[{"p", ",", "q"}], "}"}], ",", "\"\< there are only \>\"", 
           ",", " ", "nc", ",", "\"\< cells.\>\""}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "$Failed", "]"}], ";"}]}], " ", 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"edgeNumber", " ", "=", " ", 
       RowBox[{"Intersection", "[", 
        RowBox[{
         RowBox[{"c", "[", 
          RowBox[{"[", "p", "]"}], "]"}], ",", " ", 
         RowBox[{"c", "[", 
          RowBox[{"[", "q", "]"}], "]"}]}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "edgeNumber", "]"}], ">", "0"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"edgeNumber", "=", 
          RowBox[{"edgeNumber", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
         
         RowBox[{"Return", "[", "edgeNumber", "]"}]}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", "}"}], "]"}], ";"}]}], " ", "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EdgeBetween", "[", 
   RowBox[{
    RowBox[{"Q_", "?", "TorusQ"}], ",", " ", 
    RowBox[{"p_", "?", "IntegerQ"}], ",", " ", 
    RowBox[{"q_", "?", "IntegerQ"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "c", ",", " ", "nc", ",", " ", "edgeNumber", ",", " ", "pos", ",", " ", 
      "InCell", ",", " ", "trules", ",", " ", "toroidalconnections", ",", " ",
       "icc"}], "}"}], ",", " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"c", "=", 
      RowBox[{"TissueCells", "[", 
       RowBox[{"TorusTissue", "[", "Q", "]"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"nc", "=", 
      RowBox[{"Length", "[", "c", "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"p", "\[Equal]", "q"}], ",", "  ", 
       RowBox[{"Return", "[", 
        RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"p", ">", "nc"}], " ", "\[Or]", " ", 
        RowBox[{"q", ">", "nc"}], " ", "\[Or]", " ", 
        RowBox[{"p", "<", "1"}], " ", "\[Or]", " ", 
        RowBox[{"q", "<", "1"}]}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Error: EdgeBetween: invalid connection: \>\"", ",", " ", 
          RowBox[{"{", 
           RowBox[{"p", ",", "q"}], "}"}], ",", "\"\< there are only \>\"", 
          ",", " ", "nc", ",", "\"\< cells.\>\""}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "$Failed", "]"}], ";"}]}], " ", 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"edgeNumber", " ", "=", " ", 
      RowBox[{"Intersection", "[", 
       RowBox[{
        RowBox[{"c", "[", 
         RowBox[{"[", "p", "]"}], "]"}], ",", " ", 
        RowBox[{"c", "[", 
         RowBox[{"[", "q", "]"}], "]"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "edgeNumber", "]"}], ">", "0"}], ",", " ", 
       RowBox[{
        RowBox[{"edgeNumber", "=", 
         RowBox[{"edgeNumber", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", 
        RowBox[{"Return", "[", "edgeNumber", "]"}]}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"InCell", "[", 
       RowBox[{"{", 
        RowBox[{"a_", ",", "b_"}], "}"}], "]"}], ":=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"c", ",", "a"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"c", ",", "b"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"trules", "=", 
      RowBox[{"TorusRules", "[", "Q", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"trules", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"List", "@@", "#"}], "&"}], "/@", "trules"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"toroidalconnections", "=", 
      RowBox[{"Sort", "[", 
       RowBox[{"Join", "[", 
        RowBox[{"trules", ",", " ", 
         RowBox[{"Reverse", "/@", "trules"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"icc", "=", 
      RowBox[{"InCell", "/@", "toroidalconnections"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"pos", "=", 
      RowBox[{"Position", "[", 
       RowBox[{"icc", ",", " ", 
        RowBox[{"{", 
         RowBox[{"p", ",", "q"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "pos", "]"}], "<", "1"}], ",", " ", 
       RowBox[{"Return", "[", 
        RowBox[{"{", "}"}], "]"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"pos", " ", "=", " ", 
      RowBox[{"pos", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"Min", "[", 
       RowBox[{"toroidalconnections", "[", 
        RowBox[{"[", "pos", "]"}], "]"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EdgeBetween", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", "\"\<Expecting EdgeBetween[tissue, i, j]\>\"", "]"}], ";",
       " ", "$Failed"}], ")"}]}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EdgesBetween", "[", 
    RowBox[{"Q_", "?", "TissueQ"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"c", ",", " ", "edge", ",", "  ", "clist", ",", " ", "edges"}], 
      "}"}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "=", 
       RowBox[{"TissueCells", "[", "Q", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"clist", " ", "=", " ", 
       RowBox[{"ConnectionList", "[", "Q", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"edge", "[", 
        RowBox[{"{", 
         RowBox[{"p_", ",", " ", "q_"}], "}"}], "]"}], ":=", " ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "e", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"e", " ", "=", " ", 
           RowBox[{"Intersection", "[", 
            RowBox[{
             RowBox[{"c", "[", 
              RowBox[{"[", "p", "]"}], "]"}], ",", " ", 
             RowBox[{"c", "[", 
              RowBox[{"[", "q", "]"}], "]"}]}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "e", "]"}], ">", "0"}], ",", " ", 
            RowBox[{"Return", "[", 
             RowBox[{"First", "[", "e", "]"}], "]"}]}], "]"}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "0", "]"}], ";"}]}], "  ", 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"edges", " ", "=", " ", 
       RowBox[{"edge", "/@", "clist"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"edges", " ", "=", " ", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Rule", ",", " ", 
         RowBox[{"{", 
          RowBox[{"clist", ",", " ", "edges"}], "}"}]}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "edges", "]"}], ">", "0"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"edges", " ", "=", " ", 
         RowBox[{"SparseArray", "[", "edges", "]"}]}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "edges", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EdgesBetween", "[", 
   RowBox[{"Q_", "?", "TorusQ"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"c", ",", " ", "clist", ",", "   ", "edge", ",", " ", "edges"}], 
     "}"}], ",", " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"c", "=", 
      RowBox[{"TissueCells", "[", 
       RowBox[{"TorusTissue", "[", "Q", "]"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"clist", "=", 
      RowBox[{"ConnectionList", "[", "Q", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"edge", "[", 
       RowBox[{"{", 
        RowBox[{"p_", ",", " ", "q_"}], "}"}], "]"}], ":=", " ", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "edgeNumber", ",", " ", "InCell", ",", " ", "trules", ",", " ", 
          "toroidalconnections", ",", " ", "pos", ",", " ", "icc"}], "}"}], 
        ",", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"edgeNumber", " ", "=", " ", 
          RowBox[{"Intersection", "[", 
           RowBox[{
            RowBox[{"c", "[", 
             RowBox[{"[", "p", "]"}], "]"}], ",", " ", 
            RowBox[{"c", "[", 
             RowBox[{"[", "q", "]"}], "]"}]}], "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "edgeNumber", "]"}], ">", "0"}], ",", " ", 
           
           RowBox[{
            RowBox[{"edgeNumber", "=", 
             RowBox[{"edgeNumber", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", 
            RowBox[{"Return", "[", "edgeNumber", "]"}]}]}], "]"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"InCell", "[", 
           RowBox[{"{", 
            RowBox[{"a_", ",", "b_"}], "}"}], "]"}], ":=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{"c", ",", "a"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", 
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{"c", ",", "b"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"trules", "=", 
          RowBox[{"TorusRules", "[", "Q", "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"trules", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"List", "@@", "#"}], "&"}], "/@", "trules"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"toroidalconnections", "=", 
          RowBox[{"Sort", "[", 
           RowBox[{"Join", "[", 
            RowBox[{"trules", ",", " ", 
             RowBox[{"Reverse", "/@", "trules"}]}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"icc", "=", 
          RowBox[{"InCell", "/@", "toroidalconnections"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"pos", "=", 
          RowBox[{"Position", "[", 
           RowBox[{"icc", ",", " ", 
            RowBox[{"{", 
             RowBox[{"p", ",", "q"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "pos", "]"}], "<", "1"}], ",", " ", 
           RowBox[{"Return", "[", 
            RowBox[{"{", "}"}], "]"}]}], "]"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"pos", " ", "=", " ", 
          RowBox[{"pos", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"Min", "[", 
           RowBox[{"toroidalconnections", "[", 
            RowBox[{"[", "pos", "]"}], "]"}], "]"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"edges", " ", "=", " ", 
      RowBox[{"edge", "/@", "clist"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"edges", " ", "=", " ", 
      RowBox[{"MapThread", "[", 
       RowBox[{"Rule", ",", " ", 
        RowBox[{"{", 
         RowBox[{"clist", ",", " ", "edges"}], "}"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"edges", " ", "=", " ", 
      RowBox[{"SparseArray", "[", "edges", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "edges", "]"}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.45926649459715*^9, 3.459266561342119*^9}, {
   3.459266601300477*^9, 3.459266615781579*^9}, {3.4592679345560007`*^9, 
   3.4592679503390207`*^9}, {3.459268023219339*^9, 3.459268198068075*^9}, {
   3.459268285215213*^9, 3.459268325912876*^9}, {3.459268404189183*^9, 
   3.459268409010048*^9}, {3.459268445573902*^9, 3.4592686714120913`*^9}, {
   3.4592763010633297`*^9, 3.459276301425654*^9}, {3.459276337654463*^9, 
   3.459276410516718*^9}, {3.459276616364043*^9, 3.459276802327723*^9}, {
   3.459276842328889*^9, 3.4592768895481653`*^9}, {3.4592774348895073`*^9, 
   3.459277630560286*^9}, {3.459539779787023*^9, 3.459539785415524*^9}, 
   3.459540323590014*^9, {3.547739173153809*^9, 3.547739188924881*^9}, {
   3.705860506472547*^9, 3.705860559392603*^9}, {3.705860596335338*^9, 
   3.7058605978638372`*^9}, {3.7058608189075737`*^9, 
   3.70586085337601*^9}},ExpressionUUID->"2ef5d7d2-7f98-4894-ac4e-\
e48ed2951827"]
}, Closed]],

Cell[CellGroupData[{

Cell["RemoveShortEdges", "Subsection",
 CellChangeTimes->{{3.489594300249095*^9, 
  3.489594302408661*^9}},ExpressionUUID->"8fac0ea2-0070-4b05-885c-\
0add9a3f47ae"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RemoveShortEdges", "[", 
    RowBox[{"tis_Tissue", ",", " ", 
     RowBox[{"threshold_:", "0.01"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dbg", "=", "False"}], ",", " ", "dPrint", ",", " ", "el", ",",
        " ", "mean", ",", " ", "tooshort", ",", " ", "g", ",", " ", "ne"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"dPrint", "[", "x___", "]"}], ":=", " ", 
       RowBox[{"If", "[", 
        RowBox[{"dbg", ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<RemoveShortEdges: \>\"", ",", " ", "x"}], "]"}]}], 
        "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"g", "=", "tis"}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"el", " ", "=", " ", 
       RowBox[{"EdgeLengths", "[", "g", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"mean", " ", "=", " ", 
       RowBox[{"Mean", "[", "el", "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"ne", "=", 
       RowBox[{"NTissueEdges", "[", "g", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"tooshort", " ", "=", " ", 
       RowBox[{"Pick", "[", 
        RowBox[{
         RowBox[{"Range", "[", "ne", "]"}], ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "<", 
             RowBox[{"threshold", "*", "mean"}]}], ")"}], "&"}], "/@", 
          "el"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "tooshort", "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"dPrint", "[", "tooshort", "]"}], ";", " ", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"g", "=", 
          RowBox[{"MergeVertices", "[", 
           RowBox[{"g", ",", " ", 
            RowBox[{"First", "[", "tooshort", "]"}]}], "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"el", " ", "=", " ", 
          RowBox[{"EdgeLengths", "[", "g", "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"mean", " ", "=", " ", 
          RowBox[{"Mean", "[", "el", "]"}]}], ";", " ", "\[IndentingNewLine]", 
         RowBox[{"ne", "=", 
          RowBox[{"NTissueEdges", "[", "g", "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"tooshort", " ", "=", " ", 
          RowBox[{"Pick", "[", 
           RowBox[{
            RowBox[{"Range", "[", "ne", "]"}], ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#", "<", 
                RowBox[{"threshold", "*", "mean"}]}], ")"}], "&"}], "/@", 
             "el"}]}], "]"}]}], ";"}]}], " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "g", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RemoveShortEdges", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", "\"\<Expecting RemoveShortEdges[tissue, threshold]\>\"", 
       "]"}], ";", " ", 
      RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.489594306303278*^9, 3.489594454972434*^9}, {
  3.48959450207288*^9, 3.4895946625967627`*^9}, {3.4895947484214983`*^9, 
  3.489594749060275*^9}},ExpressionUUID->"9c0a8fb1-1f14-4542-bde8-\
a45a943605bb"]
}, Closed]],

Cell[CellGroupData[{

Cell["CellEdgePairs", "Subsection",
 CellChangeTimes->{
  3.544734628967003*^9},ExpressionUUID->"adaf52c7-6263-48df-aa2f-\
24221ecfec7a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CellEdgePairs", "[", 
   RowBox[{"tissue_", "?", "TissueQ"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", " ", 
     RowBox[{"c", ",", " ", "ntq"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ntq", "=", 
      RowBox[{"Range", "[", 
       RowBox[{"NTissueCells", "[", "tissue", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"TissueCells", "[", "tissue", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"Join", "@@", 
      RowBox[{"Transpose", "/@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{"#", ",", 
              RowBox[{"{", 
               RowBox[{"Length", "[", 
                RowBox[{"c", "[", 
                 RowBox[{"[", "#", "]"}], "]"}], "]"}], "}"}]}], "]"}], ",", 
            RowBox[{"c", "[", 
             RowBox[{"[", "#", "]"}], "]"}]}], "}"}], "&"}], "/@", "ntq"}], 
        ")"}]}]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.544734641560625*^9, 
  3.5447347444923*^9}},ExpressionUUID->"1bf82b6a-4034-4a58-b2f4-4f3ce42e3607"]
}, Closed]],

Cell[CellGroupData[{

Cell["VerticesUsed,EdgesUsed", "Subsection",
 CellChangeTimes->{{3.54704491833179*^9, 3.547044926139607*^9}, {
  3.5623526444151573`*^9, 
  3.5623526486168127`*^9}},ExpressionUUID->"bfa3d359-ba34-4669-9918-\
a3d6c6d13761"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"EdgesUsed", "[", 
    RowBox[{"tissue_", "?", "TissueQ"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "e", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "=", 
       RowBox[{"TissueCells", "[", "tissue", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"e", "=", 
       RowBox[{"Union", "[", 
        RowBox[{"Flatten", "[", "c", "]"}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EdgesUsed", "[", 
     RowBox[{"DT_", "?", "DTissueQ"}], "]"}], ":=", " ", 
    RowBox[{"EdgesUsed", "[", 
     RowBox[{"DTissue2Tissue", "[", "DT", "]"}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VerticesUsed", "[", 
    RowBox[{"tissue_", "?", "ISTissue"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"e", ",", "eu"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"e", "=", 
       RowBox[{"TissueEdges", "[", "tissue", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"eu", "=", 
       RowBox[{"EdgesUsed", "[", "tissue", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Union", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"e", "[", 
         RowBox[{"[", "eu", "]"}], "]"}], "]"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.547044928124901*^9, 3.547044965788392*^9}, {
  3.547045016643972*^9, 3.547045076366055*^9}, {3.547045154789619*^9, 
  3.54704520468102*^9}, {3.547045265106812*^9, 3.547045300323627*^9}, {
  3.547045404810999*^9, 
  3.547045409174635*^9}},ExpressionUUID->"30bf69bc-3c26-4365-b91f-\
613a2429fd55"]
}, Closed]],

Cell[CellGroupData[{

Cell["IntersectingEdges", "Subsection",
 CellChangeTimes->{{3.5476563365058393`*^9, 
  3.547656342800954*^9}},ExpressionUUID->"11a63e40-e000-4a8f-9fe0-\
145df01864a2"],

Cell["\<\
Returns a list of the edge numbers in T that share end points with with edge \
[[num]]\
\>", "Text",
 CellChangeTimes->{{3.547656666145591*^9, 
  3.547656683041225*^9}},ExpressionUUID->"f7509f54-a7ae-4cc0-88bf-\
23b7248fa686"],

Cell[BoxData[
 RowBox[{
  RowBox[{"IntersectingEdges", "[", 
   RowBox[{
    RowBox[{"T_", "?", "ISTissue"}], ",", " ", "num_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"notused", ",", "e", ",", "ne", ",", "edge"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"e", " ", "=", " ", 
      RowBox[{"TissueEdges", "[", "T", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"ne", "=", 
      RowBox[{"Length", "[", "e", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"notused", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{
        RowBox[{"Range", "[", "ne", "]"}], ",", " ", 
        RowBox[{"EdgesUsed", "[", "T", "]"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"edge", "=", 
      RowBox[{"e", "[", 
       RowBox[{"[", "num", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Complement", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Pick", "[", 
        RowBox[{
         RowBox[{"Range", "[", "ne", "]"}], ",", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Intersects", "[", 
             RowBox[{"edge", ",", "#"}], "]"}], "&"}], ",", "e"}], "]"}]}], 
        "]"}], ",", "\[IndentingNewLine]", "notused", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", "num", "}"}]}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.547656344626889*^9, 3.5476563466929398`*^9}, {
  3.5476564029179*^9, 3.547656440426959*^9}, {3.5476564757074747`*^9, 
  3.547656542261503*^9}, {3.547656597212393*^9, 
  3.547656646193779*^9}},ExpressionUUID->"520142bb-168d-4dfe-a50c-\
dbe3479b0b5d"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
AboveLine / BelowLine, CellsAboveLine, CellsBelowLine,
GetTissueAboveLine, GetTissueBelowLine\
\>", "Subsection",
 CellChangeTimes->{{3.562342217301733*^9, 3.562342228157649*^9}, {
  3.562353714776423*^9, 
  3.562353769437278*^9}},ExpressionUUID->"e5283fa9-13eb-46ce-84df-\
63315de47e5d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BelowLine", "[", 
    RowBox[{"pt_", ",", "pt1_", ",", "pt2_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", ",", "y"}], "}"}], ",", 
     RowBox[{
      RowBox[{"m", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"pt2", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"pt1", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"pt2", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "-", 
          RowBox[{"pt1", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"y", "=", 
       RowBox[{
        RowBox[{"pt1", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "+", 
        RowBox[{"m", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"pt", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "-", 
           RowBox[{"pt1", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{
        RowBox[{"pt", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "<", "y"}], "]"}]}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AboveLine", "[", "x___", "]"}], "=", 
    RowBox[{"Not", "[", 
     RowBox[{"BelowLine", "[", "x", "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CellsAboveLine", "[", 
    RowBox[{
     RowBox[{"T_", "?", "TissueQ"}], ",", " ", "p1_", ",", " ", "p2_"}], 
    "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c", ",", " ", "cells", ",", "n"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "=", 
       RowBox[{"Centeroid", "[", "T", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"cells", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"AboveLine", "[", 
          RowBox[{"#", ",", "p1", ",", " ", "p2"}], "]"}], "&"}], "/@", 
        "c"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "c", "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"Pick", "[", 
       RowBox[{
        RowBox[{"Range", "[", "n", "]"}], ",", "cells"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CellsBelowLine", "[", 
    RowBox[{
     RowBox[{"T_", "?", "TissueQ"}], ",", " ", "p1_", ",", " ", "p2_"}], 
    "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c", ",", " ", "cells", ",", "n"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "=", 
       RowBox[{"Centeroid", "[", "T", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"cells", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"BelowLine", "[", 
          RowBox[{"#", ",", "p1", ",", "p2"}], "]"}], "&"}], "/@", "c"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "c", "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"Pick", "[", 
       RowBox[{
        RowBox[{"Range", "[", "n", "]"}], ",", "cells"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CellsAboveLine", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Expecting CellsAboveLine[Tissue, point1, point2]\>\"", "]"}], ";",
       " ", 
      RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CellsBelowLine", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Expecting CellsBelowLine[Tissue, point1, point2]\>\"", "]"}], ";",
       " ", 
      RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetTissueAboveLine", "[", 
    RowBox[{
     RowBox[{"T_", "?", "TissueQ"}], ",", " ", "p1_", ",", " ", "p2_"}], 
    "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c", ",", "v", ",", "e", ",", "cn"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v", ",", "e", ",", "c"}], "}"}], "=", 
       RowBox[{"T", "/.", 
        RowBox[{"{", 
         RowBox[{"Tissue", "\[Rule]", " ", "List"}], "}"}]}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"cn", "=", 
       RowBox[{"CellsAboveLine", "[", 
        RowBox[{"T", ",", " ", "p1", ",", "p2"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"Tissue", "[", 
       RowBox[{"v", ",", "e", ",", 
        RowBox[{"c", "[", 
         RowBox[{"[", "cn", "]"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetTissueAboveLine", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Expecting GetTissueAboveLine[Tissue, point1, point2]\>\"", "]"}], 
      ";", " ", 
      RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetTissueBelowLine", "[", 
    RowBox[{
     RowBox[{"T_", "?", "TissueQ"}], ",", " ", "p1_", ",", " ", "p2_"}], 
    "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c", ",", "v", ",", "e", ",", " ", "cn"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v", ",", "e", ",", "c"}], "}"}], "=", 
       RowBox[{"T", "/.", 
        RowBox[{"{", 
         RowBox[{"Tissue", "\[Rule]", " ", "List"}], "}"}]}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"cn", "=", 
       RowBox[{"CellsBelowLine", "[", 
        RowBox[{"T", ",", " ", "p1", ",", "p2"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"Tissue", "[", 
       RowBox[{"v", ",", "e", ",", 
        RowBox[{"c", "[", 
         RowBox[{"[", "cn", "]"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetTissueBelowLine", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Expecting GetTissueBelowLine[Tissue, point1, point2]\>\"", "]"}], 
      ";", " ", 
      RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.562342237371091*^9, 3.562342243195065*^9}, {
  3.5623423068363113`*^9, 3.562342525309676*^9}, {3.562342673979251*^9, 
  3.562342682472361*^9}, {3.5623427148630257`*^9, 3.56234271533994*^9}, {
  3.562342786870919*^9, 3.562342927553096*^9}, {3.562343042159389*^9, 
  3.562343088333412*^9}, {3.5623537247873096`*^9, 
  3.5623537369888163`*^9}},ExpressionUUID->"9b2eb6a4-b132-4a03-ae03-\
eb4a1f74a099"]
}, Closed]],

Cell[CellGroupData[{

Cell["CellsInsidePolygon, GetTissueInsidePolygon", "Subsection",
 CellChangeTimes->{{3.56235394633179*^9, 
  3.562353962428928*^9}},ExpressionUUID->"3ff00376-5127-4ee6-a808-\
3c6432feac7a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CellsInsidePolygon", "[", 
     RowBox[{
      RowBox[{"T_", "?", "TissueQ"}], ",", 
      RowBox[{"{", 
       RowBox[{"vertices__", "?", "PointQ"}], "}"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"polygon", ",", " ", "centers", ",", " ", "inside", ",", "n"}],
        "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"polygon", "=", 
        RowBox[{"{", "vertices", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"centers", " ", "=", " ", 
        RowBox[{"Centeroid", "[", "T", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "centers", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"if", " ", "dim"}], "=", 
         RowBox[{
          RowBox[{"3", " ", "do", " ", "z"}], "-", 
          RowBox[{"projection", " ", "only"}]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"centers", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ">", "2"}], ",", " ", 
         RowBox[{"centers", " ", "=", " ", 
          RowBox[{"Most", "/@", "centers"}]}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"inside", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Inside", "[", 
           RowBox[{"polygon", ",", " ", "#"}], "]"}], "&"}], "/@", 
         "centers"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Pick", "[", 
        RowBox[{
         RowBox[{"Range", "[", "n", "]"}], ",", " ", "inside"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CellsInsidePolygon", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Expecting CellsInsidePolygon[tissue, {v1,v2,...}]\>\"", "]"}], 
      ";", " ", 
      RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetTissueInsidePolygon", "[", 
     RowBox[{
      RowBox[{"T_", "?", "TissueQ"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"vertices__", "?", "PointQ"}], "}"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "polygon", ",", " ", "cip", ",", " ", "v", ",", "e", ",", "c", ",", 
        " ", "c1"}], "}"}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"polygon", "=", 
        RowBox[{"{", "vertices", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"cip", " ", "=", " ", 
        RowBox[{"CellsInsidePolygon", "[", 
         RowBox[{"T", ",", " ", "polygon"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v", ",", "e", ",", "c"}], "}"}], "=", 
        RowBox[{"T", "/.", 
         RowBox[{"{", 
          RowBox[{"Tissue", "\[Rule]", " ", "List"}], "}"}]}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"Tissue", "[", 
        RowBox[{"v", ",", "e", ",", 
         RowBox[{"c", "[", 
          RowBox[{"[", "cip", "]"}], "]"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetTissueInsidePolygon", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Expecting GetTissueInsidePolygon[Tissue, {v1,v2,..}]\>\"", "]"}], 
      ";", " ", 
      RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.562353949861755*^9, 3.562353999468527*^9}, {
   3.562354043519458*^9, 3.562354214235235*^9}, {3.5623542499616423`*^9, 
   3.5623543637156887`*^9}, {3.562354492458734*^9, 3.562354626059588*^9}, 
   3.562354664637816*^9, {3.562354768683311*^9, 3.562354777276865*^9}, {
   3.562354822005658*^9, 
   3.5623548225295887`*^9}},ExpressionUUID->"1698fbf4-a9b1-47bf-945d-\
31d570da8975"]
}, Closed]],

Cell[CellGroupData[{

Cell["FlatTissue", "Subsection",
 CellChangeTimes->{{3.562598204582766*^9, 
  3.5625982057183657`*^9}},ExpressionUUID->"5a66ae08-fdaa-4104-9927-\
c0c6037d6eee"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Tissue2FlatTissue", "[", 
    RowBox[{"T_", "?", "TissueQ"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v", ",", "cvn"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"v", "=", 
       RowBox[{"TissueVertices", "[", "T", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"cvn", "=", 
       RowBox[{"CellVertexNumbers", "[", "T", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"FlatTissue", "[", 
       RowBox[{"v", ",", "cvn"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tissue2FlatTissue", "[", "x___", "]"}], ":=", 
   RowBox[{"(", " ", 
    RowBox[{
     RowBox[{
     "Print", "[", "\"\<Expecting[Tissue2FlatTissue[Tissue]]\>\"", "]"}], ";",
      " ", 
     RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.562598209610448*^9, 
  3.562598288901775*^9}},ExpressionUUID->"4023a508-6b7f-4aab-b347-\
fb22690b6ada"],

Cell["\<\
CVN2Edges takes a list of cells, where each cell is specified as a sequence \
of vertex numbers, into a sequence of edge numbers.\
\>", "Text",
 CellChangeTimes->{{3.562598328069949*^9, 3.562598348949666*^9}, {
  3.562598379133484*^9, 
  3.562598433462014*^9}},ExpressionUUID->"5c02a600-76c9-4685-b7bc-\
18f5932c2b7a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CVN2Edges", "[", "cvn_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "makepairs", ",", "CellEdgePairs", ",", "edges", ",", 
      "EdgePairToEdgeNumber", ",", "CellEdgePair2CellEdgeNumber", ",", "c"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"makepairs", "[", 
       RowBox[{"{", "ijk__", "}"}], "]"}], ":=", 
      RowBox[{"Sort", "/@", 
       RowBox[{"Partition", "[", 
        RowBox[{
         RowBox[{"{", "ijk", "}"}], ",", "2", ",", "1", ",", "1"}], "]"}]}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"CellEdgePairs", "=", 
      RowBox[{"makepairs", "/@", "cvn"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"edges", "=", 
      RowBox[{"Union", "[", 
       RowBox[{"Join", "@@", "CellEdgePairs"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"EdgePairToEdgeNumber", "[", 
       RowBox[{"{", 
        RowBox[{"i_", ",", "j_"}], "}"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{"edges", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "j"}], "}"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CellEdgePair2CellEdgeNumber", "[", "ceplist_", "]"}], ":=", 
      RowBox[{"EdgePairToEdgeNumber", "/@", "ceplist"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"CellEdgePair2CellEdgeNumber", "/@", "CellEdgePairs"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"edges", ",", " ", "c"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.562598320495307*^9, 3.562598320496153*^9}, {
  3.562598372383095*^9, 3.562598376395328*^9}, {3.5625984371354227`*^9, 
  3.56259844016572*^9}},ExpressionUUID->"e8a2c2e1-adc4-42d2-bf51-\
4bf1bada2a06"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FlatTissue2Tissue", "[", "F_FlatTissue", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"v", ",", "e", ",", "c", ",", " ", "cvn"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"v", ",", "cvn"}], "}"}], "=", 
      RowBox[{"F", "/.", 
       RowBox[{"{", 
        RowBox[{"FlatTissue", "\[Rule]", " ", "List"}], "}"}]}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"e", ",", "c"}], "}"}], "=", 
      RowBox[{"CVN2Edges", "[", "cvn", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"Tissue", "[", 
      RowBox[{"v", ",", "e", ",", "c"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.56259829338171*^9, 3.562598306854356*^9}, {
  3.562598445692754*^9, 
  3.5625984757306633`*^9}},ExpressionUUID->"27701e86-eed9-4112-94bc-\
476ac1ce6404"]
}, Closed]],

Cell[CellGroupData[{

Cell["TranslateTissue", "Subsection",
 CellChangeTimes->{{3.5630326637055387`*^9, 
  3.563032665287925*^9}},ExpressionUUID->"a3c68114-e79c-4aaa-8c7b-\
78aa940fe8c9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TranslateTissue", "[", 
    RowBox[{"T_Tissue", ",", 
     RowBox[{"vector_", "?", "ListQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "v", ",", "e", ",", "c", ",", "dim", ",", " ", "DX", ",", "DY", ",", 
       "DZ", ",", "vnew"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v", ",", "e", ",", "c"}], "}"}], "=", 
       RowBox[{"T", "/.", 
        RowBox[{"{", 
         RowBox[{"Tissue", "\[Rule]", " ", "List"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dim", " ", "=", " ", 
       RowBox[{"Length", "[", 
        RowBox[{"v", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "vector", "]"}], ">", "0"}], ",", " ", 
        RowBox[{"DX", "=", 
         RowBox[{"vector", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
        RowBox[{"DX", "=", "0"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "vector", "]"}], ">", "1"}], ",", " ", 
        RowBox[{"DY", "=", 
         RowBox[{"vector", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
        RowBox[{"DY", "=", "0"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "vector", "]"}], ">", "2"}], ",", " ", 
        RowBox[{"DZ", "=", 
         RowBox[{"vector", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ",", " ", 
        RowBox[{"DZ", "=", "0"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Switch", "[", 
       RowBox[{"dim", ",", "\[IndentingNewLine]", "2", ",", 
        RowBox[{"vnew", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"DX", ",", "DY"}], "}"}], "+", "#"}], ")"}], "&"}], "/@",
           "v"}]}], ",", "\[IndentingNewLine]", "3", ",", " ", 
        RowBox[{"vnew", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"DX", ",", "DY", ",", "DZ"}], "}"}], "+", "#"}], ")"}], 
           "&"}], "/@", "v"}]}], ",", "\[IndentingNewLine]", "_", ",", " ", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<TranslateTissue: Invalid dimension = \>\"", ",", " ", "dim"}], 
          "]"}], ";", " ", 
         RowBox[{"Abort", "[", "]"}], ";"}]}], " ", "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Tissue", "[", 
       RowBox[{"vnew", ",", "e", ",", "c"}], "]"}]}]}], "\[IndentingNewLine]",
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TranslateTissue", "[", "x___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
     "Print", "[", "\"\<Expecting TranslateTissue[Tissue, vector]\>\"", "]"}],
      ";", " ", 
     RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5630326660361147`*^9, 3.563032948285624*^9}, {
  3.563033068402289*^9, 
  3.563033090557053*^9}},ExpressionUUID->"8aa1c2a8-e2cb-45ab-872c-\
566526f25185"]
}, Closed]],

Cell[CellGroupData[{

Cell["TranslateToOrigin", "Subsection",
 CellChangeTimes->{{3.564512647978636*^9, 
  3.5645126552010603`*^9}},ExpressionUUID->"218ee287-0092-42e8-8d5d-\
cb219c9fabce"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TranslateToOrigin", "[", 
    RowBox[{"T_", "?", "TissueQ"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v", ",", "C"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"v", "=", 
       RowBox[{"TissueVertices", "[", "T", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"C", "=", 
       RowBox[{"Mean", "[", "v", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"TranslateTissue", "[", 
       RowBox[{"T", ",", 
        RowBox[{"-", "C"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TranslateToOrigin", "[", "x___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
    "Print", "[", "\"\<Expecting TranslateToOrigin[Tissue]\>\"", "]"}], ";", 
    " ", 
    RowBox[{"Abort", "[", "]"}]}], ")"}]}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.564512655998145*^9, 
  3.5645127861190777`*^9}},ExpressionUUID->"db3aa5af-e399-4f93-960f-\
a6f538ec010d"]
}, Closed]],

Cell[CellGroupData[{

Cell["RotateTissue", "Subsection",
 CellChangeTimes->{{3.563033099758542*^9, 
  3.563033101800631*^9}},ExpressionUUID->"31105188-0e54-42cb-85d5-\
115ebb13d389"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RotateTissue", "[", 
    RowBox[{"T_Tissue", ",", " ", "degrees_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "v", ",", "e", ",", "c", ",", "dim", ",", " ", "radians", ",", " ", "R",
        ",", " ", "vnew"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v", ",", "e", ",", "c"}], "}"}], "=", 
       RowBox[{"T", "/.", 
        RowBox[{"{", 
         RowBox[{"Tissue", "\[Rule]", " ", "List"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dim", " ", "=", " ", 
       RowBox[{"Length", "[", 
        RowBox[{"v", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"radians", " ", "=", " ", 
       RowBox[{"degrees", " ", "*", " ", 
        RowBox[{"Pi", "/", "180.0"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Switch", "[", 
       RowBox[{"dim", ",", " ", "\[IndentingNewLine]", "2", ",", " ", 
        RowBox[{"R", "=", 
         RowBox[{"RotationMatrix", "[", "radians", "]"}]}], ",", 
        "\[IndentingNewLine]", "3", ",", " ", 
        RowBox[{"R", "=", 
         RowBox[{"RotationMatrix", "[", 
          RowBox[{"radians", ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", "_", ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<RotateTissue: Invalid dimension = \>\"", ",", " ", "dim"}], 
          "]"}], ";", " ", 
         RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"vnew", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"R", ".", "#"}], "&"}], ",", " ", "v"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Tissue", "[", 
       RowBox[{"vnew", ",", " ", "e", ",", "c"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RotateTissue", "[", "x___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
    "Print", "[", "\"\<Expecting RotateTissue[Tissue, AngleInDegrees]\>\"", 
     "]"}], ";", " ", 
    RowBox[{"Abort", "[", "]"}]}], ")"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5630331101227827`*^9, 
  3.563033258288122*^9}},ExpressionUUID->"ee5870dc-56e7-42a8-986a-\
c0dd4677a3da"]
}, Closed]],

Cell[CellGroupData[{

Cell["ReflectTissue", "Subsection",
 CellChangeTimes->{{3.564340568915316*^9, 
  3.56434057074763*^9}},ExpressionUUID->"4b63ea81-7af3-43da-82af-\
4430618c2847"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ReflectTissue", "[", 
    RowBox[{"T_Tissue", ",", " ", "\"\<y\>\""}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v", ",", "e", ",", "c", ",", " ", "dim", ",", " ", "mult"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v", ",", "e", ",", "c"}], "}"}], "=", 
       RowBox[{"T", "/.", 
        RowBox[{"{", 
         RowBox[{"Tissue", "\[Rule]", " ", "List"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dim", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"v", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"Switch", "[", 
       RowBox[{"dim", ",", " ", "\[IndentingNewLine]", "2", ",", " ", 
        RowBox[{"mult", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ",", " ", 
        "\[IndentingNewLine]", "3", ",", " ", 
        RowBox[{"mult", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}]}], ",", 
        "\[IndentingNewLine]", "_", ",", " ", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<ReflectTissue: invalid dimension \>\"", ",", " ", "dim"}], 
          "]"}], ";", " ", "\[IndentingNewLine]", 
         RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{"v", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"mult", "*", "#"}], "&"}], "/@", "v"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Tissue", "[", 
       RowBox[{"v", ",", "e", ",", "c"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReflectTissue", "[", 
    RowBox[{"T_Tissue", ",", " ", "\"\<x\>\""}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v", ",", "e", ",", "c", ",", " ", "dim", ",", " ", "mult"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v", ",", "e", ",", "c"}], "}"}], "=", 
       RowBox[{"T", "/.", 
        RowBox[{"{", 
         RowBox[{"Tissue", "\[Rule]", " ", "List"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dim", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"v", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"Switch", "[", 
       RowBox[{"dim", ",", " ", "\[IndentingNewLine]", "2", ",", " ", 
        RowBox[{"mult", "=", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"-", "1"}]}], "}"}]}], ",", " ", "\[IndentingNewLine]", 
        "3", ",", " ", 
        RowBox[{"mult", "=", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ",", 
        "\[IndentingNewLine]", "_", ",", " ", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<ReflectTissue: invalid dimension \>\"", ",", " ", "dim"}], 
          "]"}], ";", " ", "\[IndentingNewLine]", 
         RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{"v", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"mult", "*", "#"}], "&"}], "/@", "v"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Tissue", "[", 
       RowBox[{"v", ",", "e", ",", "c"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ReflectTissue", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Expecting ReflectTissue[Tissue, axis] where axis is \\\"x\\\" or \
\\\"y\\\"\>\"", "]"}], ";", " ", 
      RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5643405720153418`*^9, 3.564340747578568*^9}, {
  3.5643408132890797`*^9, 
  3.5643408166379423`*^9}},ExpressionUUID->"ac19b43f-70e2-4271-a39a-\
98b5291900aa"]
}, Closed]],

Cell[CellGroupData[{

Cell["BoundaryCell", "Subsection",
 CellChangeTimes->{{3.564262150500928*^9, 
  3.564262151899166*^9}},ExpressionUUID->"8c20f627-d103-4175-9e83-\
f176e76b0ead"],

Cell["Create a cell formed by the outer boundary of a tissue", "Text",
 CellChangeTimes->{{3.564262155709023*^9, 
  3.5642621819571447`*^9}},ExpressionUUID->"733b0b24-77c5-4ea5-bd1e-\
449383c3f05d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BoundaryCell", "[", 
    RowBox[{"T_", "?", "TissueQ"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "v", ",", "e", ",", "c", ",", "be", ",", "sce", ",", " ", "coords"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v", ",", "e", ",", "c"}], "}"}], "=", 
       RowBox[{"T", "/.", 
        RowBox[{"{", 
         RowBox[{"Tissue", "\[Rule]", " ", "List"}], "}"}]}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"be", "=", 
       RowBox[{"EdgesOnBoundary", "[", "T", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sce", " ", "=", " ", 
       RowBox[{"SortCellEdges", "[", 
        RowBox[{"be", ",", "e"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"coords", " ", "=", " ", 
       RowBox[{"v", "[", 
        RowBox[{"[", 
         RowBox[{"\"\<Vertices\>\"", "/.", "sce"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "\[IndentingNewLine]", 
       RowBox[{"Prepend", "[", 
        RowBox[{"sce", ",", " ", 
         RowBox[{"\"\<Coordinates\>\"", "\[Rule]", " ", "coords"}]}], "]"}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BoundaryCell", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Print", "[", "\"\<Expecting BoundaryCell[Tissue]\>\"", "]"}], 
      ";", " ", 
      RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.564262152613777*^9, 3.564262323279408*^9}, {
  3.5642623928419857`*^9, 3.564262402232799*^9}, {3.5642626688475533`*^9, 
  3.564262699761339*^9}},ExpressionUUID->"2fb91383-2608-42f4-bfde-\
37bf8b09c263"]
}, Closed]],

Cell[CellGroupData[{

Cell["NeighborQ", "Subsection",
 CellChangeTimes->{{3.576261104076777*^9, 
  3.576261109292769*^9}},ExpressionUUID->"aa5c8dc0-4a61-45ef-a9ea-\
55b4d0559105"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NeighborQ", "[", 
   RowBox[{
    RowBox[{"T_", "?", "TissueQ"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"n1_", ",", " ", "n2_"}], "}"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "cl", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cl", "=", 
      RowBox[{"ConnectionList", "[", "T", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"cl", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"cl", ",", " ", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"#", ",", "n1"}], "]"}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Or", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"#", ",", "n2"}], "]"}], "&"}], "/@", "cl"}], ")"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.576261120302698*^9, 3.576261203118354*^9}, {
  3.576261257910459*^9, 3.576261264309928*^9}, {3.576261316065085*^9, 
  3.576261320021241*^9}},ExpressionUUID->"55f9d74b-65d2-4c09-99d0-\
5f830674db62"]
}, Closed]],

Cell[CellGroupData[{

Cell["MergeCells", "Subsection",
 CellChangeTimes->{{3.576260913478643*^9, 
  3.576260914926136*^9}},ExpressionUUID->"59a1709c-9c2a-47ea-b00f-\
9715b52fc650"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MergeCells", "[", 
   RowBox[{
    RowBox[{"T_", "?", "TissueQ"}], ",", 
    RowBox[{"n_", "?", "ListQ"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "v", ",", "e", ",", "c", ",", "bl", ",", "T1", ",", "ncells", ",", " ", 
      "nlist"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"v", ",", "e", ",", "c"}], "}"}], "=", 
      RowBox[{"T", "/.", 
       RowBox[{"{", 
        RowBox[{"Tissue", "\[Rule]", " ", "List"}], "}"}]}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"T1", "=", 
      RowBox[{"Tissue", "[", 
       RowBox[{"v", ",", "e", ",", 
        RowBox[{"c", "[", 
         RowBox[{"[", "n", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"bl", "=", 
      RowBox[{"\"\<Edges\>\"", "/.", 
       RowBox[{"BoundaryCell", "[", "T1", "]"}]}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"ncells", "=", 
      RowBox[{"Length", "[", "c", "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"nlist", "=", 
      RowBox[{"List", "/@", "n"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"AbortIf", "[", 
        RowBox[{
         RowBox[{"ncells", "<", "#"}], ",", 
         RowBox[{
         "\"\<MergeCells: Possible Program Error: Attempt to delete cell \
\>\"", "<>", 
          RowBox[{"ToString", "[", "#", "]"}], "<>", 
          "\"\< from tissue with total of \>\"", "<>", 
          RowBox[{"ToString", "[", "ncells", "]"}], "<>", 
          "\"\< cells\>\""}]}], "]"}], "&"}], "/@", "nlist"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Tissue", "[", 
      RowBox[{"v", ",", "e", ",", 
       RowBox[{"Append", "[", 
        RowBox[{
         RowBox[{"Delete", "[", 
          RowBox[{"c", ",", "nlist"}], "]"}], ",", " ", "bl"}], "]"}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.576260916809511*^9, 3.5762609525574408`*^9}, {
  3.576261097132169*^9, 3.576261100115987*^9}, {3.576261680140359*^9, 
  3.576261735238799*^9}, {3.5762617745357027`*^9, 3.576261873244535*^9}, {
  3.5785736016189547`*^9, 3.578573605855426*^9}, {3.57857363695539*^9, 
  3.578573796581773*^9}},ExpressionUUID->"837557e5-7801-4fc4-ac23-\
66f5a3447b87"]
}, Closed]],

Cell[CellGroupData[{

Cell["SharedWall", "Subsection",
 CellChangeTimes->{{3.5642625982901993`*^9, 
  3.564262600833757*^9}},ExpressionUUID->"6297f372-4483-4905-935c-\
cfab846ed5b2"],

Cell["\<\
Determine information about the wall between cells p and q in tissue T\
\>", "Text",
 CellChangeTimes->{{3.564262640369974*^9, 
  3.5642626629452963`*^9}},ExpressionUUID->"2585dc93-3c99-491a-b12d-\
b0caf7a94da8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SharedWall", "[", 
    RowBox[{
     RowBox[{"T_", "?", "TissueQ"}], ",", " ", "p_Integer", ",", " ", 
     "q_Integer"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "v", ",", "e", ",", "c", ",", "nc", ",", " ", "cell1", ",", " ", 
       "cell2", ",", " ", "common", ",", " ", "edge", ",", "pairs", ",", " ", 
       "hasBV", ",", "VoB", ",", "VoE", ",", " ", "Vall", ",", " ", "cvnp", 
       ",", "cvnq", ",", " ", "overlap", ",", "overlaplist", ",", "done", ",",
        "i", ",", " ", "edges", ",", " ", "vertices"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v", ",", "e", ",", "c"}], "}"}], "=", 
       RowBox[{"T", "/.", 
        RowBox[{"{", 
         RowBox[{"Tissue", "\[Rule]", " ", "List"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nc", " ", "=", " ", 
       RowBox[{"Length", "[", "c", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AbortIf", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"p", ">", "nc"}], ")"}], " ", "\[Or]", " ", 
         RowBox[{"(", 
          RowBox[{"q", " ", ">", " ", "nc"}], ")"}], " ", "\[Or]", 
         RowBox[{"(", 
          RowBox[{"p", "<", "0"}], ")"}], " ", "\[Or]", " ", 
         RowBox[{"(", 
          RowBox[{"q", "<", "0"}], ")"}]}], ",", " ", 
        "\"\<SharedWall: Invalid cell number.\>\""}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"cell1", " ", "=", " ", 
       RowBox[{"c", "[", 
        RowBox[{"[", "p", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cell2", " ", "=", " ", 
       RowBox[{"c", "[", 
        RowBox[{"[", "q", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"common", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "cell1", "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"edge", " ", "=", " ", 
          RowBox[{"First", "[", "cell1", "]"}]}], ";", "\[IndentingNewLine]", 
         
         RowBox[{"cell1", "=", 
          RowBox[{"Rest", "[", "cell1", "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"cell2", ",", "edge"}], "]"}], ",", " ", 
           RowBox[{"common", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"common", ",", "edge"}], "]"}]}]}], "]"}], ";"}]}], " ", 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"pairs", " ", "=", " ", 
       RowBox[{"e", "[", 
        RowBox[{"[", "common", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "overlap", " ", "returns", " ", "true", " ", "if", " ", "all", " ", 
        "exists", " ", "intersection"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"overlap", "[", 
        RowBox[{"l1_", ",", "l2_"}], "]"}], ":=", "  ", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"Intersection", "[", 
          RowBox[{"l1", ",", "l2"}], "]"}], "]"}], ">", "0"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
         "overlaplist", " ", "returns", " ", "true", " ", "if", " ", "l"}], 
         "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"l1", ",", "l2", ",", "l3", ",", "..."}], "}"}], " ", 
          "and", " ", "there", " ", "is", " ", "an", " ", "overlap", 
          "\[IndentingNewLine]", "between", " ", "every", " ", "pair", " ", 
          "of", " ", "adjacent", " ", "sublists", " ", 
          RowBox[{"(", 
           RowBox[{"l1", ",", "l2"}], ")"}]}]}], ",", " ", 
        RowBox[{"(", 
         RowBox[{"l2", ",", "l3"}], ")"}], ",", "..."}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"overlaplist", "[", "l_", "]"}], ":=", 
       RowBox[{"And", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"overlap", "@@", "#"}], "&"}], "/@", 
          RowBox[{"Partition", "[", 
           RowBox[{"l", ",", "2", ",", "1"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"done", "=", "False"}], ";", 
      RowBox[{"i", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"Not", "[", "done", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"overlaplist", "[", "pairs", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Break", "[", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"pairs", " ", "=", " ", 
             RowBox[{"RotateRight", "[", 
              RowBox[{"pairs", ",", "1"}], "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"i", "=", 
          RowBox[{"i", "+", "1"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", ">", 
            RowBox[{"Length", "[", "pairs", "]"}]}], ",", 
           RowBox[{
            RowBox[{
            "Print", "[", "\"\<Error: SharedWall:unable to sort segments\>\"",
              "]"}], ";", "  ", 
            RowBox[{"Break", "[", "]"}]}]}], "]"}], ";"}]}], " ", 
       "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"edges", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"e", ",", "#"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "&"}], "/@", "pairs"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"vertices", "=", 
       RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "firstpair", ",", "secondpair", ",", "pairlist", ",", "v1", ",", 
          "v2"}], "}"}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"pairlist", "=", "pairs"}], ";", "\[IndentingNewLine]", 
         RowBox[{"firstpair", "=", 
          RowBox[{"pairlist", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}], "=", "firstpair"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "pairlist", "]"}], ">", "1"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"secondpair", "=", 
             RowBox[{"pairlist", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{"secondpair", ",", "v1"}], "]"}], ",", 
              RowBox[{"vertices", "=", 
               RowBox[{"{", 
                RowBox[{"v2", ",", "v1"}], "}"}]}], ",", 
              RowBox[{"vertices", "=", 
               RowBox[{"{", 
                RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"pairlist", "=", 
             RowBox[{"Rest", "[", "pairlist", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"While", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "pairlist", "]"}], ">", "0"}], ",", 
              RowBox[{
               RowBox[{"firstpair", "=", 
                RowBox[{"pairlist", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ";", 
               RowBox[{"pairlist", "=", 
                RowBox[{"Rest", "[", "pairlist", "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"v1", ",", "v2"}], "}"}], "=", "firstpair"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"MemberQ", "[", 
                  RowBox[{"vertices", ",", "v1"}], "]"}], ",", 
                 RowBox[{"AppendTo", "[", 
                  RowBox[{"vertices", ",", "v2"}], "]"}], ",", 
                 RowBox[{"AppendTo", "[", 
                  RowBox[{"vertices", ",", "v1"}], "]"}]}], "]"}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"vertices", "=", "firstpair"}]}], "\[IndentingNewLine]", 
          "]"}], ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<Edges\>\"", "\[Rule]", " ", "edges"}], ",", " ", 
        RowBox[{"\"\<Vertices\>\"", "\[Rule]", " ", "vertices"}], ",", " ", 
        RowBox[{"\"\<Coordinates\>\"", "\[Rule]", " ", 
         RowBox[{"v", "[", 
          RowBox[{"[", "vertices", "]"}], "]"}]}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SharedWall", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Expecting SharedWall[Tissue, cellnumber1, cellnumber2]\>\"", 
       "]"}], ";", " ", 
      RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQA2IQPfm90yyvvleOAW/V54DoJt1nS0H0DmamNSC6r8Ji
A4jm8JA+CaKvHPO/DqLbp3+7AaKzxLvug2jvvcqPQLRRs9QzEB10Re0LiDbJ
dPwDomcyXQXTXDdlWLxB4mJbhEF0ySZvKRDNdVJRE0Sr7tfRB9HacZwOIHqa
/IUMEH22eXEpiOaZn90O1r+nqAdEm69MmwWim440LwTRAdIvVoHoo32r14No
o2e2O0C0z2q7AyD63pnTR0D065ClJ0B03kr3OyD61Z9Jd0H0U16rOB8gfVv0
VhaIvpcqnw+ir00/VgyiY9zL60H0nnCDBhD9+P7lCw3TXzneubL8Goie63H1
EYgueC/+BEQDAP0gtpU=
  
  "],ExpressionUUID->"29a067c6-1330-4bcc-a36b-fc13dc2090c3"]
}, Closed]],

Cell[CellGroupData[{

Cell["L1Cells, L2Cells", "Subsection",
 CellChangeTimes->{{3.5749763924820642`*^9, 3.574976397112732*^9}, {
  3.5749771555492268`*^9, 
  3.574977156955418*^9}},ExpressionUUID->"61b6607d-5559-4f7e-962e-\
4f1140be6ea0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"L1Cells", "[", 
     RowBox[{"T_Tissue", ",", " ", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "bottom", ",", " ", "bc", ",", " ", "centroids", ",", " ", "OK", ",", 
        " ", "L1", ",", " ", "RMIN", ",", " ", "allcenters", ",", " ", 
        "BOTTOM", ",", " ", "CBOT", ",", " ", "xCBOT", ",", " ", "xr", ",", 
        " ", "xl"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"bottom", "=", 
        RowBox[{
         RowBox[{"\"\<Bottom\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<Bottom\>\"", "\[Rule]", " ", "Automatic"}], "}"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"RMIN", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<MinimumRadius\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<MinimumRadius\>\"", "\[Rule]", " ", "0"}], "}"}]}]}], 
       ";", " ", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ToString", "[", "bottom", "]"}], "\[Equal]", " ", 
          "\"\<Automatic\>\""}], ",", " ", 
         RowBox[{"bottom", " ", "=", " ", "0"}]}], " ", 
        RowBox[{"(*", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"Mean", "[", 
           RowBox[{"areafunction", "[", "T", "]"}], "]"}], "]"}], "*)"}], 
        "]"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"bc", "=", 
        RowBox[{"CellsOnBoundary", "[", "T", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"allcenters", "=", 
        RowBox[{"centroids", "=", 
         RowBox[{"Centroid", "[", "T", "]"}]}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"bottom", ">", 
          RowBox[{"-", "Infinity"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"BOTTOM", "=", 
           RowBox[{"CellsOnBottom", "[", "T", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"CBOT", "=", 
           RowBox[{"centroids", "[", 
            RowBox[{"[", "BOTTOM", "]"}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"xCBOT", "=", 
           RowBox[{"First", "/@", "CBOT"}]}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"join", " ", "left"}], " ", "&"}], " ", "right", " ", 
            "bottom", " ", "corners"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"xr", "=", 
           RowBox[{
            RowBox[{"BOTTOM", "[", 
             RowBox[{"[", 
              RowBox[{"Ordering", "[", 
               RowBox[{"xCBOT", ",", 
                RowBox[{"-", "1"}]}], "]"}], "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"xl", "=", 
           RowBox[{
            RowBox[{"BOTTOM", "[", 
             RowBox[{"[", 
              RowBox[{"Ordering", "[", 
               RowBox[{"xCBOT", ",", "1"}], "]"}], "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"L1", "=", " ", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Complement", "[", 
              RowBox[{"bc", ",", " ", "BOTTOM"}], "]"}], " ", ",", " ", 
             RowBox[{"{", 
              RowBox[{"xl", ",", "xr"}], "}"}]}], "]"}]}], ";"}], " ", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"centroids", " ", "=", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"centroids", "[", 
               RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "bc"}]}], ";", 
           " ", "\[IndentingNewLine]", 
           RowBox[{"OK", " ", "=", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ">", "bottom"}], ")"}], 
              "&"}], "/@", "centroids"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Pick", "[", 
            RowBox[{"bc", ",", " ", "OK"}], "]"}]}], "*)"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"L1", "=", "bc"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "weed", " ", "out", " ", "a", " ", "central", " ", "\"\<hole\>\""}], 
         " ", "-", " ", 
         RowBox[{
         "only", " ", "works", " ", "if", " ", "the", " ", "hole", " ", "is", 
          " ", "in", " ", "the", " ", "center"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"RMIN", ">", "0"}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"allcenters", "=", 
           RowBox[{"Norm", "/@", "allcenters"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"allcenters", " ", "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"allcenters", "[", 
              RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "L1"}]}], ";", " ",
           "\[IndentingNewLine]", 
          RowBox[{"OK", " ", "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#", ">", "RMIN"}], ")"}], "&"}], "/@", 
            "allcenters"}]}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"L1", "=", 
           RowBox[{"Pick", "[", 
            RowBox[{"L1", ",", " ", "OK"}], "]"}]}], ";"}]}], " ", 
        "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "L1", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"L1Cells", "[", 
     RowBox[{"DT_DTissue", ",", " ", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"T", ",", " ", "cells", ",", "rules"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"T", "=", 
        RowBox[{"DTissue2Tissue", "[", "DT", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"cells", "=", 
        RowBox[{"L1Cells", "[", 
         RowBox[{"T", ",", "opt"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"rules", " ", "=", " ", 
        RowBox[{"StaticToDynamicNumberRules", "[", "DT", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"cells", "/.", "rules"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"L1Cells", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"AbortIf", "[", 
     RowBox[{
     "True", ",", " ", 
      "\"\<Error: Expecting L1Cells[Tissue] or L1Cells[DTissue]\>\""}], 
     "]"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5749763986349287`*^9, 3.574976466622137*^9}, {
   3.57497651399469*^9, 3.574976820549155*^9}, {3.574976865901581*^9, 
   3.574976978113865*^9}, {3.5749778798601522`*^9, 3.574977916145258*^9}, {
   3.575990723854685*^9, 3.575990766989283*^9}, {3.575990909167412*^9, 
   3.575991124643566*^9}, {3.578003631915516*^9, 3.578003728133102*^9}, 
   3.578003768303998*^9, {3.578003843451578*^9, 3.5780039795880823`*^9}, {
   3.578004011752214*^9, 3.578004091781201*^9}, {3.5780041543651333`*^9, 
   3.5780041970118303`*^9}, 
   3.7057114675544767`*^9},ExpressionUUID->"2343032d-ab50-4ac2-93ec-\
0807ee10c0b7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"L2Cells", "[", 
     RowBox[{"T_Tissue", ",", " ", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "L1", ",", "L1CellEdges", ",", " ", "bc", ",", " ", "c", ",", " ", 
        "L2", ",", " ", "e", ",", " ", "v", ",", " ", "LRest", ",", "n", ",", 
        " ", "cellnumber", ",", " ", "celledges", ",", "ISL2", ",", 
        RowBox[{"dbg", "=", "False"}], ",", " ", "dPrint"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"dPrint", "[", "u___", "]"}], ":=", " ", 
        RowBox[{"If", "[", 
         RowBox[{"dbg", ",", " ", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<L2Cells: \>\"", ",", " ", "u"}], "]"}]}], "]"}]}], 
       ";", " ", "\[IndentingNewLine]", 
       RowBox[{"L1", "=", 
        RowBox[{"L1Cells", "[", 
         RowBox[{"T", ",", "opt"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
       
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"bc", "=", 
          RowBox[{"CellsOnBoundary", "[", "T", "]"}]}], ";"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v", ",", "e", ",", "c"}], "}"}], "=", 
        RowBox[{"T", "/.", 
         RowBox[{"{", 
          RowBox[{"Tissue", "\[Rule]", " ", "List"}], "}"}]}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "c", "]"}]}], ";", " ", "\[IndentingNewLine]", 
       
       RowBox[{"LRest", "=", 
        RowBox[{"Range", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"LRest", "=", 
          RowBox[{"Complement", "[", 
           RowBox[{"LRest", ",", "bc"}], "]"}]}], ";"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"LRest", "=", 
        RowBox[{"Complement", "[", 
         RowBox[{"LRest", ",", " ", "L1"}], "]"}]}], ";", "  ", 
       "\[IndentingNewLine]", 
       RowBox[{"L2", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"L1CellEdges", "=", 
        RowBox[{"c", "[", 
         RowBox[{"[", "L1", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<L1: \>\"", ",", " ", "L1"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<L1CellEdges: \>\"", ",", " ", "L1CellEdges"}], "]"}], 
       ";", " ", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<LRest: \>\"", ",", " ", "LRest"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "LRest", "]"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"cellnumber", "=", 
           RowBox[{"First", "[", "LRest", "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"LRest", "=", 
           RowBox[{"Rest", "[", "LRest", "]"}]}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"celledges", "=", 
           RowBox[{"c", "[", 
            RowBox[{"[", "cellnumber", "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ISL2", "=", 
           RowBox[{"Or", "@@", 
            RowBox[{"(", " ", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"Intersection", "[", 
                  RowBox[{"celledges", ",", " ", "#"}], "]"}], "]"}], ">", 
                "0"}], "&"}], "/@", "L1CellEdges"}], ")"}]}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{
           "\"\<Checking cell \>\"", ",", " ", "cellnumber", ",", " ", 
            "\"\< ISL2=\>\"", ",", " ", "ISL2"}], "]"}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", " ", "[", " ", 
           RowBox[{"ISL2", ",", " ", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"L2", ",", " ", "cellnumber"}], "]"}]}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "L2"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"L2Cells", "[", 
     RowBox[{"DT_DTissue", ",", " ", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"T", ",", " ", "cells", ",", "rules"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"T", "=", 
        RowBox[{"DTissue2Tissue", "[", "DT", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"cells", "=", 
        RowBox[{"L2Cells", "[", 
         RowBox[{"T", ",", "opt"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"rules", " ", "=", " ", 
        RowBox[{"StaticToDynamicNumberRules", "[", "DT", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"cells", "/.", "rules"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"L2Cells", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"AbortIf", "[", 
     RowBox[{
     "True", ",", " ", 
      "\"\<Error: Expecting L2Cells[Tissue] or L1Cells[DTissue]\>\""}], 
     "]"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5749771616312943`*^9, 3.574977527829071*^9}, {
  3.574977618691278*^9, 3.5749776426359787`*^9}, {3.5749777253081207`*^9, 
  3.5749778043641768`*^9}, {3.5749778510124474`*^9, 3.574977851412215*^9}, {
  3.574977919604129*^9, 3.5749779426443987`*^9}, {3.578585296661901*^9, 
  3.578585371610324*^9}, {3.578585418108238*^9, 3.578585485620607*^9}, {
  3.5785855159838037`*^9, 3.578585522064392*^9}, {3.578585566289527*^9, 
  3.5785855866099377`*^9}, {3.5785856807767897`*^9, 
  3.5785856815191708`*^9}},ExpressionUUID->"ee81fee4-47be-4663-b9db-\
6206466d73aa"]
}, Closed]],

Cell[CellGroupData[{

Cell["Polygonalize", "Subsection",
 CellChangeTimes->{{3.591293595191454*^9, 
  3.591293598414455*^9}},ExpressionUUID->"4fed3a8b-1ac1-44cd-baf4-\
69b3fa5349b3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Polygonalize", "[", 
   RowBox[{"T_", ",", 
    RowBox[{"threshold_:", " ", ".5"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "c", ",", "v", ",", "e", ",", "cvn", ",", "nv", ",", "p", ",", "p3", ",",
       "RepeatedVertices", ",", "vp", ",", "n", ",", "r", ",", "PolyCell", 
      ",", "newcells", ",", "F", ",", "Tnew", ",", "BC", ",", "IC", ",", 
      "AIC", ",", "ABC", ",", "toosmall", ",", " ", 
      RowBox[{"dbg", "=", "False"}], ",", " ", "dPrint", ",", " ", "degen"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"dPrint", "[", "u___", "]"}], ":=", " ", 
      RowBox[{"If", "[", 
       RowBox[{"dbg", ",", " ", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Polygonzlize:\>\"", ",", " ", "u"}], "]"}]}], "]"}]}], 
     ";", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"v", ",", "e", ",", "c"}], "}"}], "=", 
      RowBox[{"T", "/.", 
       RowBox[{"{", 
        RowBox[{"Tissue", "\[Rule]", "List"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
     "dPrint", "[", 
      "\"\<extracting Cell Vertex Numbers (may take a while) ... \>\"", "]"}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"cvn", "=", 
      RowBox[{"CellVertexNumbers", "[", "T", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nv", "=", 
      RowBox[{"Length", "[", "v", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"nv", ",", "\"\< vertices found in original tissue.\>\""}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "find", " ", "all", " ", "the", " ", "vertices", " ", "in", " ", "at", 
       " ", "least", " ", "3", " ", "cells"}], "*)"}], 
     RowBox[{"p", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"Position", "[", 
           RowBox[{"cvn", ",", "j"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "nv"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"p3", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"p", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}], ">", "2"}], "&"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "numbers", " ", "of", " ", "the", " ", "Repeated", " ", "Vertices"}], 
      "*)"}], 
     RowBox[{"RepeatedVertices", "=", 
      RowBox[{"First", "/@", "p3"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "RepeatedVertices", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"n", ",", "\"\< corner vertices found.\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"vertex", " ", "conversion", " ", "rules"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", "\"\<Determining conversion rules ...\>\"", "]"}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"r", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{"Rule", ",", 
        RowBox[{"{", 
         RowBox[{"RepeatedVertices", ",", 
          RowBox[{"Range", "[", "n", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "vertex", " ", "coordinates", " ", "of", " ", "the", " ", "repeated", 
       " ", "vertices"}], "*)"}], 
     RowBox[{
     "dPrint", "[", "\"\<Extracting new vertex coordinates ...\>\"", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"vp", "=", 
      RowBox[{"v", "[", 
       RowBox[{"[", "RepeatedVertices", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Cell", " ", "as", " ", "least", " ", "of", " ", "vertices"}], 
      "*)"}], 
     RowBox[{
      RowBox[{"PolyCell", "[", "cellVertexNumbers_", "]"}], ":=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Select", "[", 
         RowBox[{"cellVertexNumbers", ",", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"RepeatedVertices", ",", "#"}], "]"}], "&"}]}], "]"}], 
        ")"}], "/.", "r"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
     "dPrint", "[", 
      "\"\<Determining Polygonal cell vertices in new coordinates.\>\"", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"newcells", "=", 
      RowBox[{"PolyCell", "/@", "cvn"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", "\"\<Generating Flat Tissue.\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"F", "=", 
      RowBox[{"FlatTissue", "[", 
       RowBox[{"vp", ",", "newcells"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", "\"\<Converting to Tissue.\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Tnew", "=", 
      RowBox[{"FlatTissue2Tissue", "[", "F", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"BC", "=", 
      RowBox[{"CellsOnBoundary", "[", "Tnew", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"IC", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", "newcells", "]"}], "]"}], ",", "BC"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"AIC", "=", 
      RowBox[{"Mean", "[", 
       RowBox[{"areafunction", "[", 
        RowBox[{"Tnew", ",", "IC"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<Deleting cells smaller than \>\"", ",", 
       RowBox[{"threshold", "*", "AIC"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ABC", "=", 
      RowBox[{"areafunction", "[", 
       RowBox[{"Tnew", ",", "BC"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"toosmall", "=", 
      RowBox[{"Pick", "[", 
       RowBox[{"BC", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"#", "<", 
            RowBox[{"threshold", "*", "AIC"}]}], ")"}], "&"}], "/@", 
         "ABC"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"v", ",", "e", ",", "c"}], "}"}], "=", 
      RowBox[{"Tnew", "/.", 
       RowBox[{"{", 
        RowBox[{"Tissue", "\[Rule]", "List"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"Delete", "[", 
       RowBox[{"c", ",", 
        RowBox[{"List", "/@", "toosmall"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", "\"\<Removing degenerate cells\>\"", "]"}], ";", 
     " ", "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"c", ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "#", "]"}], ">", "2"}], "&"}]}], "]"}]}], 
     ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Tnew", "=", 
      RowBox[{"Tissue", "[", 
       RowBox[{"v", ",", "e", ",", "c"}], "]"}]}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.59129360762549*^9, 3.591293673884676*^9}, {
   3.591293803333794*^9, 3.591293803654614*^9}, {3.591294057581665*^9, 
   3.591294117796077*^9}, {3.5912941741032124`*^9, 3.591294289799774*^9}, {
   3.5912943611512327`*^9, 3.591294399835979*^9}, 3.591294441240449*^9, {
   3.591294488301347*^9, 3.59129449903319*^9}, {3.705711481664785*^9, 
   3.7057114966424637`*^9}},ExpressionUUID->"24b71b86-1795-4173-a309-\
6b57ae4cc20e"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Cellzilla Backward Compatibility - Voronoi", "Section",
 CellChangeTimes->{{3.454155657662218*^9, 
  3.454155667534977*^9}},ExpressionUUID->"91016e88-1716-4dd5-b313-\
7e8fda0ec911"],

Cell[CellGroupData[{

Cell["DelaunayEdges", "Subsection",
 CellChangeTimes->{{3.454157282942689*^9, 
  3.454157284491184*^9}},ExpressionUUID->"730f4c6a-6811-460a-8ae3-\
ef6c0d4b476a"],

Cell["Return list of {x,y} coordinates for each delaunay edge", "Text",
 CellChangeTimes->{{3.454157287610488*^9, 
  3.4541573002708387`*^9}},ExpressionUUID->"ddbcf2dd-3ba2-48dd-9c96-\
7faaa7aca326"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DelaunayEdges", "[", 
    RowBox[{"{", 
     RowBox[{"vertices__", "?", "numPairQ"}], "}"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "dt", ",", "xy", ",", " ", "pairup", ",", " ", "edges", ",", " ", 
       "edgeCoords"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"xy", "=", 
       RowBox[{"{", "vertices", "}"}]}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"pairup", "[", 
          RowBox[{"{", 
           RowBox[{"v1_", ",", " ", 
            RowBox[{"{", "vlist__", "}"}]}], "}"}], "]"}], ":=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"v1", ",", "#"}], "}"}], "&"}], "/@", 
          RowBox[{"{", "vlist", "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"dt", "=", " ", 
         RowBox[{"DelaunayTriangulation", "[", "xy", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"edges", " ", "=", " ", 
         RowBox[{"Union", "[", 
          RowBox[{"Sort", "/@", 
           RowBox[{"Join", "@@", 
            RowBox[{"(", 
             RowBox[{"pairup", "/@", "dt"}], ")"}]}]}], "]"}]}], ";"}], 
       "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"edges", "=", 
       RowBox[{"DelaunayPairs", "[", "xy", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"edgeCoords", " ", "[", 
        RowBox[{"{", 
         RowBox[{"i_", ",", " ", "j_"}], "}"}], "]"}], ":=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"xy", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
         RowBox[{"xy", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"edges", " ", "=", " ", 
       RowBox[{"edgeCoords", "/@", "edges"}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DelaunayEdges", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", "\"\<Expecting DelaunayEdges[{{x,y},{x,y},...}]\>\"", 
       "]"}], ";", " ", "$Failed"}], ")"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.454155844962015*^9, 3.454155890801845*^9}, {
  3.4541559208824673`*^9, 3.45415597237429*^9}, {3.454156006287833*^9, 
  3.4541560068080587`*^9}, {3.454156040695635*^9, 3.454156168466215*^9}, {
  3.4541562071176043`*^9, 3.4541562819938993`*^9}, {3.454156339327979*^9, 
  3.4541563795738907`*^9}, {3.45415642517422*^9, 3.454156442486279*^9}, {
  3.454156536699622*^9, 3.4541566414267282`*^9}, {3.454157246884843*^9, 
  3.4541572507063723`*^9}, {3.454163536579403*^9, 
  3.4541635648593893`*^9}},ExpressionUUID->"95cc6fce-8563-45d9-ba64-\
4ef837f57f26"]
}, Closed]],

Cell[CellGroupData[{

Cell["DelaunayPairs", "Subsection",
 CellChangeTimes->{{3.454163438150442*^9, 
  3.454163439913869*^9}},ExpressionUUID->"da3029e4-ef78-4dee-9bee-\
16e46b934d6c"],

Cell["\<\
Returns unique links in Delaunay Triangulation as a list of integer pairs \
{i,j} into the vertex list\
\>", "Text",
 CellChangeTimes->{{3.454163586056591*^9, 
  3.4541636027368317`*^9}},ExpressionUUID->"c31b2b0c-fdc0-42cf-ae77-\
f8dcfd3a59ed"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DelaunayPairs", "[", 
    RowBox[{"{", 
     RowBox[{"vertices__", "?", "numPairQ"}], "}"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"dt", ",", "xy", ",", " ", "pairup", ",", " ", "pairs"}], "}"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"xy", "=", 
       RowBox[{"{", "vertices", "}"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pairup", "[", 
        RowBox[{"{", 
         RowBox[{"v1_", ",", " ", 
          RowBox[{"{", "vlist__", "}"}]}], "}"}], "]"}], ":=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"v1", ",", "#"}], "}"}], "&"}], "/@", 
        RowBox[{"{", "vlist", "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"dt", "=", " ", 
       RowBox[{"DelaunayTriangulation", "[", "xy", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"pairs", " ", "=", " ", 
       RowBox[{"Union", "[", 
        RowBox[{"Sort", "/@", 
         RowBox[{"Join", "@@", 
          RowBox[{"(", 
           RowBox[{"pairup", "/@", "dt"}], ")"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "pairs", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DelaunayPairs", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Print", "[", "\"\<Expecting \!\(\*
StyleBox[\"DelaunayPairs\",
FontWeight->\"Plain\"]\)[{{x,y},{x,y},...}]\>\"", "]"}], ";", " ", 
      "$Failed"}], ")"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.454155844962015*^9, 3.454155890801845*^9}, {
  3.4541559208824673`*^9, 3.45415597237429*^9}, {3.454156006287833*^9, 
  3.4541560068080587`*^9}, {3.454156040695635*^9, 3.454156168466215*^9}, {
  3.4541562071176043`*^9, 3.4541562819938993`*^9}, {3.454156339327979*^9, 
  3.4541563795738907`*^9}, {3.45415642517422*^9, 3.454156442486279*^9}, {
  3.454156536699622*^9, 3.4541566414267282`*^9}, {3.454157246884843*^9, 
  3.4541572507063723`*^9}, {3.454163448573806*^9, 3.4541634613387403`*^9}, {
  3.4541634993819*^9, 
  3.4541635134555597`*^9}},ExpressionUUID->"cadad009-1421-4dd3-8e67-\
657c74e76fc3"]
}, Closed]],

Cell[CellGroupData[{

Cell["DelaunayMean", "Subsection",
 CellChangeTimes->{{3.454157270513586*^9, 
  3.454157274253675*^9}},ExpressionUUID->"5144da57-5e6d-4317-bbca-\
71d84390c0a6"],

Cell["returns average length of Delaunay Edge", "Text",
 CellChangeTimes->{{3.45415730484205*^9, 
  3.454157315266974*^9}},ExpressionUUID->"63644301-9d63-42c1-b01a-\
a2ea49f2c43d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DelaunayMean", "[", 
    RowBox[{"{", 
     RowBox[{"vertices__", "?", "numPairQ"}], "}"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"xy", ",", "  ", "edges", ",", "  ", "dmean"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"edges", " ", "=", " ", 
       RowBox[{"DelaunayEdges", "[", 
        RowBox[{"{", "vertices", "}"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"edges", ",", " ", "$Failed"}], "]"}], ",", " ", 
        RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"dmean", " ", "=", " ", 
       RowBox[{"Mean", "[", 
        RowBox[{"Norm", "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Subtract", "@@", "#"}], "&"}], "/@", "edges"}], ")"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "dmean", "]"}], ";"}]}], " ", 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DelaunayMean", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", "\"\<Expecting DelaunayMean[{{x,y},{x,y},...}]\>\"", 
       "]"}], ";", " ", "$Failed"}], ")"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.454155844962015*^9, 3.454155890801845*^9}, {
  3.4541559208824673`*^9, 3.45415597237429*^9}, {3.454156006287833*^9, 
  3.4541560068080587`*^9}, {3.454156040695635*^9, 3.454156168466215*^9}, {
  3.4541562071176043`*^9, 3.4541562819938993`*^9}, {3.454156339327979*^9, 
  3.4541563795738907`*^9}, {3.45415642517422*^9, 3.454156442486279*^9}, {
  3.454156864728709*^9, 3.454156879977046*^9}, {3.4541569122864733`*^9, 
  3.454156959868524*^9}, {3.454157029748217*^9, 
  3.454157242499939*^9}},ExpressionUUID->"d99d67d1-e046-40eb-8054-\
60b3cc400b5d"]
}, Closed]],

Cell[CellGroupData[{

Cell["ConvexHullVertices", "Subsection",
 CellChangeTimes->{{3.4541578013393793`*^9, 
  3.45415780437251*^9}},ExpressionUUID->"94ae1bb8-075f-440c-b3fe-\
443dcef81bc9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ConvexHullVertices", "[", "points_", "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "ch", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ch", "=", 
      RowBox[{"ConvexHull", "[", "points", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ch", "=", 
      RowBox[{"points", "[", 
       RowBox[{"[", "ch", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4541578069095984`*^9, 3.454157831125615*^9}, {
  3.4541578701707697`*^9, 
  3.454157889863834*^9}},ExpressionUUID->"00e9ca7b-dd3a-4958-b957-\
791b8985d3c4"]
}, Closed]],

Cell[CellGroupData[{

Cell["GenerateBoundaryLayer", "Subsection",
 CellChangeTimes->{
  3.4541576879173813`*^9},ExpressionUUID->"da674bfc-aee1-4dd6-b318-\
6b67798cb050"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GenerateBoundaryLayer", "[", 
   RowBox[{"pointsInput_", ",", " ", 
    RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "chull", ",", " ", "diameter", ",", " ", "dbg", ",", " ", "dPrint", ",", 
      " ", "points"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dbg", " ", "=", " ", 
      RowBox[{
       RowBox[{"\"\<Debug\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<Debug\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";", 
     " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dPrint", "[", "x___", "]"}], ":=", " ", 
      RowBox[{"If", "[", 
       RowBox[{"dbg", ",", " ", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<GenerateBoundaryLayer: \>\"", ",", " ", "x"}], "]"}]}], 
       "]"}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"chull", "=", 
      RowBox[{"ConvexHullVertices", "[", "pointsInput", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"chull", " ", "=", " ", 
      RowBox[{"Append", "[", 
       RowBox[{"chull", ",", " ", 
        RowBox[{"First", "[", "chull", "]"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"diameter", " ", "=", " ", 
      RowBox[{"DelaunayMean", "[", "pointsInput", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<diameter: \>\"", ",", " ", "diameter"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "block", " ", "extracted", " ", "from", " ", "mPower", " ", "1.0"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "hull", ",", " ", "hullminus", ",", " ", "hullplus", ",", "  ", 
         "pminus", ",", " ", "pplus", ",", " ", "p", ",", " ", "vplus", ",", 
         " ", "vminus", ",", " ", "pnew", ",", " ", "v", ",", " ", 
         "endpoints", ",", "p1", ",", " ", "p2", ",", " ", "additionalpoints",
          ",", " ", "d", ",", " ", "n", ",", " ", "rn", ",", " ", "rpt", ",", 
         " ", "rpts"}], "}"}], ",", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"hullminus", "=", 
         RowBox[{"Most", "[", "chull", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"hull", "=", 
         RowBox[{"Rest", "[", "chull", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"hullplus", "=", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"Drop", "[", 
            RowBox[{"chull", ",", "2"}], "]"}], ",", 
           RowBox[{"chull", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "generate", " ", "points", " ", "directly", " ", "out", " ", "from", 
          " ", "convex", " ", "hull"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"points", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "hullminus", "]"}], ">", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"pminus", "=", 
            RowBox[{"First", "[", "hullminus", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"hullminus", "=", 
            RowBox[{"Rest", "[", "hullminus", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"pplus", "=", 
            RowBox[{"First", "[", "hullplus", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"hullplus", "=", 
            RowBox[{"Rest", "[", "hullplus", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"p", "=", 
            RowBox[{"First", "[", "hull", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"hull", "=", 
            RowBox[{"Rest", "[", "hull", "]"}]}], ";", "\[IndentingNewLine]", 
           
           RowBox[{"vplus", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p", "-", "pminus"}], ")"}], "/", 
             RowBox[{"Norm", "[", 
              RowBox[{"p", "-", "pminus"}], "]"}]}]}], ";", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"vminus", " ", "=", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p", "-", "pplus"}], ")"}], "/", 
             RowBox[{"Norm", "[", 
              RowBox[{"p", "-", "pplus"}], "]"}]}]}], ";", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"v", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"vplus", "+", "vminus"}], ")"}], "/", 
             RowBox[{"Norm", "[", 
              RowBox[{"vplus", "+", "vminus"}], "]"}]}]}], ";", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"pnew", "=", 
            RowBox[{"p", "+", 
             RowBox[{"diameter", "*", "v"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"points", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"points", ",", "pnew"}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "end", " ", "of", " ", "While", " ", "Length", " ", "hullminus"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"dPrint", "[", 
         RowBox[{"\"\<points: \>\"", ",", " ", "points"}], "]"}], ";", " ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"endpoints", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"points", ",", 
           RowBox[{"First", "[", "points", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"p2", "=", 
         RowBox[{"First", "[", "endpoints", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"endpoints", "=", 
         RowBox[{"Rest", "[", "endpoints", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"additionalpoints", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "endpoints", "]"}], ">", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"p1", "=", "p2"}], ";", "\[IndentingNewLine]", 
           RowBox[{"p2", "=", 
            RowBox[{"First", "[", "endpoints", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"endpoints", "=", 
            RowBox[{"Rest", "[", "endpoints", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"d", "=", 
            RowBox[{"distance", "[", 
             RowBox[{"p1", ",", "p2"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"d", ">", "diameter"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"v", "=", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"p1", "-", "p2"}], ")"}], "/", 
                RowBox[{"Norm", "[", 
                 RowBox[{"p1", "-", "p2"}], "]"}]}]}], ";", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"n", "=", 
               RowBox[{"Round", "[", 
                RowBox[{
                 RowBox[{"d", "/", "diameter"}], "+", "1"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"pnew", "=", 
               RowBox[{
                RowBox[{"Range", "[", 
                 RowBox[{"n", "-", "1"}], "]"}], "*", 
                RowBox[{"(", 
                 RowBox[{"d", "/", "n"}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"pnew", "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"p2", "+", 
                   RowBox[{"v", "*", "#"}]}], ")"}], "&"}], "/@", "pnew"}]}], 
              ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{
               "add", " ", "in", " ", "a", " ", "minute", " ", 
                "randomization"}], " ", "*)"}], "\[IndentingNewLine]", 
              RowBox[{"rn", ":=", " ", 
               RowBox[{"0.01", "*", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "diameter"}], ",", " ", "diameter"}], "}"}], 
                 "]"}]}]}], ";", " ", "\[IndentingNewLine]", 
              RowBox[{"rpt", ":=", " ", 
               RowBox[{"{", 
                RowBox[{"rn", ",", " ", "rn"}], "}"}]}], ";", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"rpts", " ", "=", " ", 
               RowBox[{"Table", "[", 
                RowBox[{"rpt", ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"Length", "[", "pnew", "]"}], "}"}]}], "]"}]}], ";",
               " ", "\[IndentingNewLine]", 
              RowBox[{"pnew", " ", "=", " ", 
               RowBox[{"pnew", " ", "+", " ", "rpts"}]}], ";", " ", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"additionalpoints", "=", 
               RowBox[{"Join", "[", 
                RowBox[{"additionalpoints", ",", "pnew"}], "]"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], " ", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"end", " ", "If", " ", "d"}], ">", " ", "diameter"}], 
          "*)"}], "\[IndentingNewLine]", "]"}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"end", " ", "While", " ", "Length", " ", "endpoints"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"points", " ", "=", " ", 
         RowBox[{"Join", "[", 
          RowBox[{"points", ",", " ", "additionalpoints"}], "]"}]}], ";", " ",
         "\[IndentingNewLine]", 
        RowBox[{"dPrint", "[", 
         RowBox[{"\"\<points: \>\"", ",", " ", "points"}], "]"}], ";"}]}], 
      " ", "\[IndentingNewLine]", "]"}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "end", " ", "of", " ", "block", " ", "from", " ", "mPower", " ", 
       "1.0"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"sort", " ", "points"}], ",", " ", 
       RowBox[{"since", " ", "its", " ", "convex"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"cen", ",", " ", "angles", ",", " ", "vecs"}], "}"}], ",", 
       " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cen", " ", "=", " ", 
         RowBox[{"Centroid", "[", "points", "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"vecs", " ", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "-", "cen"}], ")"}], "&"}], "/@", "points"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"angles", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"ArcTan", "@@", "#"}], "&"}], "/@", "vecs"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"points", " ", "=", " ", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"angles", ",", " ", "points"}], "}"}], "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"points", " ", "=", " ", 
         RowBox[{"Sort", "[", "points", "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"points", " ", "=", " ", 
         RowBox[{
          RowBox[{"Transpose", "[", "points", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";"}]}], " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "points", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.454157695942279*^9, 3.454157710920817*^9}, {
   3.454157745801487*^9, 3.454157746642449*^9}, {3.4541579656476393`*^9, 
   3.454157974499345*^9}, {3.454158009375739*^9, 3.454158074049157*^9}, {
   3.45415811870894*^9, 3.454158268621224*^9}, {3.454158376338583*^9, 
   3.4541584757113857`*^9}, {3.4541586011775293`*^9, 3.454158674556253*^9}, {
   3.454158804708268*^9, 3.454158850663669*^9}, {3.454158887841062*^9, 
   3.45415895368899*^9}, {3.4541589900140038`*^9, 3.454159062486146*^9}, {
   3.454159233191461*^9, 3.4541592364575663`*^9}, {3.4541592672613153`*^9, 
   3.4541592986572437`*^9}, {3.454159408187344*^9, 3.454159417342955*^9}, {
   3.45415946282614*^9, 3.45415946690546*^9}, {3.4541595216739273`*^9, 
   3.45415957794103*^9}, 3.454159616653863*^9, {3.454159699438901*^9, 
   3.454159820565773*^9}, {3.454159878560088*^9, 3.4541599182614813`*^9}, {
   3.454159955163432*^9, 3.454160026471143*^9}, {3.4541611707653313`*^9, 
   3.454161314078342*^9}},ExpressionUUID->"b33a8226-ed4e-4736-879e-\
c25af10e2faf"]
}, Closed]],

Cell[CellGroupData[{

Cell["BoundedCellVoronoi", "Subsection",
 CellChangeTimes->{{3.4541619233458357`*^9, 
  3.454161961756798*^9}},ExpressionUUID->"4b22bad4-47ab-45be-9554-\
0258f42a7fc8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BoundedCellVoronoi", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"centers__", "?", "numPairQ"}], "}"}], ",", " ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "bl", ",", " ", "xy", ",", " ", "pts", ",", " ", "boundary", ",", " ", 
       "bv", ",", " ", "n", ",", "dPrint", ",", "dbg", ",", " ", "v", ",", 
       "c", ",", " ", "vall", ",", " ", "tiss"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dbg", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<Debug\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Debug\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dPrint", "[", "x___", "]"}], ":=", " ", 
       RowBox[{"If", "[", 
        RowBox[{"dbg", " ", ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<BoundedCellVoronoi: \>\"", ",", " ", "x"}], "]"}]}], 
        "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"xy", "=", 
       RowBox[{"{", "centers", "}"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "xy", "]"}]}], ";", " ", "\[IndentingNewLine]", 
      
      RowBox[{"bl", " ", "=", " ", 
       RowBox[{"GenerateBoundaryLayer", "[", "xy", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"pts", " ", "=", " ", 
       RowBox[{"Join", "[", 
        RowBox[{"xy", ",", " ", "bl"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"boundary", "=", 
       RowBox[{"bl", "[", 
        RowBox[{"[", 
         RowBox[{"ConvexHull", "[", "bl", "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bv", " ", "=", " ", 
       RowBox[{"BoundedDiagram", "[", 
        RowBox[{"boundary", ",", " ", "pts"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v", ",", " ", "c"}], "}"}], "=", "bv"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"Last", "/@", 
        RowBox[{"Take", "[", 
         RowBox[{"c", ",", " ", "n"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<c: \>\"", ",", " ", "c"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"vall", " ", "=", " ", 
       RowBox[{"Union", "[", 
        RowBox[{"Flatten", "[", "c", "]"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<vall: \>\"", ",", " ", "vall"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vall", "=", 
       RowBox[{"v", "[", 
        RowBox[{"[", "vall", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
      
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<vall (2):\>\"", ",", " ", "vall"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "c"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<c (2): \>\"", ",", " ", "c"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"tiss", "=", 
       RowBox[{"CellsByVertexToTissue", "[", 
        RowBox[{"vall", ",", "c"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
      "tiss"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BoundedCellVoronoi", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Expecting BoundedCellVoronoi[{point, point, ...}]\>\"", "]"}], 
      ";", " ", "$Failed"}], ")"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4541619898594522`*^9, 3.454162167129344*^9}, {
  3.4541622135680428`*^9, 3.454162288969857*^9}, {3.454162320442429*^9, 
  3.454162355449473*^9}, {3.454162388577458*^9, 3.4541623921367407`*^9}, {
  3.45416243026392*^9, 3.454162666390966*^9}, {3.454162773680273*^9, 
  3.454162815186584*^9}},ExpressionUUID->"d9146ec4-738f-4bf4-b672-\
ba1874e9f20b"]
}, Closed]],

Cell[CellGroupData[{

Cell["PrunedDelaunayPairs, Edges", "Subsection",
 CellChangeTimes->{{3.454163177605174*^9, 3.4541631807027473`*^9}, {
  3.454163798986459*^9, 
  3.454163828284581*^9}},ExpressionUUID->"f5c95de6-53d6-4acf-83fe-\
e5933522db59"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PrunedDelaunayPairs", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"points__", "?", "numPairQ"}], "}"}], ",", " ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"dt", ",", " ", "cl", ",", " ", "w", ",", " ", "udt"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dt", " ", "=", " ", 
       RowBox[{"DelaunayPairs", "[", 
        RowBox[{"{", "points", "}"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"w", "=", 
       RowBox[{"BoundedCellVoronoi", "[", 
        RowBox[{"{", "points", "}"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"cl", " ", "=", " ", 
       RowBox[{"ConnectionList", "[", "w", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"udt", " ", "=", " ", 
       RowBox[{"Intersection", "[", 
        RowBox[{"cl", ",", " ", "dt"}], "]"}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PrunedDelaunayEdges", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"points__", "?", "numPairQ"}], "}"}], ",", " ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "dt", ",", " ", "xy", ",", " ", "edgeCoords", ",", " ", "edges"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"xy", "=", 
       RowBox[{"{", "points", "}"}]}], ";", " ", "\[IndentingNewLine]", " ", 
      RowBox[{"dt", "=", " ", 
       RowBox[{"PrunedDelaunayPairs", "[", "xy", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"edgeCoords", " ", "[", 
        RowBox[{"{", 
         RowBox[{"i_", ",", " ", "j_"}], "}"}], "]"}], ":=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"xy", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
         RowBox[{"xy", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"edges", " ", "=", " ", 
       RowBox[{"edgeCoords", "/@", "dt"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "edges", "]"}], ";"}]}], " ", 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.45416318182638*^9, 3.454163184332891*^9}, {
  3.454163228465291*^9, 3.45416323425464*^9}, {3.4541633383672123`*^9, 
  3.45416337595417*^9}, {3.454163408050661*^9, 3.454163415997333*^9}, {
  3.454163614746736*^9, 3.4541636156722*^9}, {3.4541636757707653`*^9, 
  3.454163759030711*^9}, {3.454163803340316*^9, 
  3.454163954346251*^9}},ExpressionUUID->"4b1f5f9e-3b51-477b-b660-\
e3691c524af0"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Built-in-templates", "Section",
 CellChangeTimes->{{3.450721737567151*^9, 
  3.450721743815724*^9}},ExpressionUUID->"fcda713a-3c9d-4cde-8efb-\
4a5e47a0c697"],

Cell[CellGroupData[{

Cell["RandomizeTemplate", "Subsubsection",
 CellChangeTimes->{{3.4510553967984056`*^9, 
  3.451055399750371*^9}},ExpressionUUID->"7514c90b-863c-4e8c-837f-\
e6eaeeb231d3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RandomizeTemplate", "[", 
     RowBox[{
      RowBox[{"q_", "?", "TissueQ"}], ",", " ", 
      RowBox[{"rand_:", "0"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "qq", ",", " ", "e", ",", " ", "v", ",", " ", "nv", ",", "c", ",", " ",
         "el", ",", " ", "r", ",", " ", "rn", ",", " ", "lengths", ",", " ", 
        "directions", ",", " ", "offsets"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"rand", ">", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"c", "=", 
           RowBox[{"TissueCells", "[", "q", "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"v", "=", 
           RowBox[{"TissueVertices", "[", "q", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"nv", "=", 
           RowBox[{"Length", "[", "v", "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"e", "=", 
           RowBox[{"TissueEdges", "[", "q", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"el", "=", 
           RowBox[{"Mean", "[", 
            RowBox[{"EdgeLengths", "[", "q", "]"}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"r", "=", "rand"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"rand", ">", ".25"}], ",", " ", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"r", "=", ".25"}], ";", " ", "\[IndentingNewLine]", 
             RowBox[{
             "Print", "[", 
              "\"\<Warning: RandomizeTemplate: randomization truncated to \
25%.\>\"", "]"}]}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"r", "=", 
           RowBox[{"r", "*", "el"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"lengths", " ", "=", " ", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"RandomReal", "[", 
              RowBox[{"{", 
               RowBox[{"0", ",", "r"}], "}"}], "]"}], ",", " ", 
             RowBox[{"{", "nv", "}"}]}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"directions", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Cos", "[", "#", "]"}], ",", " ", 
               RowBox[{"Sin", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"RandomReal", "[", 
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"2", "Pi"}]}], "}"}], "]"}], ",", " ", 
              RowBox[{"{", "nv", "}"}]}], "]"}]}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"offsets", " ", "=", " ", 
           RowBox[{"lengths", "*", "directions"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"v", "=", 
           RowBox[{"v", "+", "offsets"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"qq", "=", 
           RowBox[{"Tissue", "[", 
            RowBox[{"v", ",", "e", ",", "c"}], "]"}]}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"qq", "=", "q"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "qq", "]"}]}]}], "]"}]}], ";"}], " "}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.451055400952376*^9, 3.45105549744699*^9}, {
  3.451055548800918*^9, 3.451055675196246*^9}, {3.45105570622528*^9, 
  3.451055894425478*^9}, {3.451055941617241*^9, 
  3.451056015110361*^9}},ExpressionUUID->"e61e7226-f26e-415f-972a-\
15305abf12e6"]
}, Closed]],

Cell[CellGroupData[{

Cell["TemplateHoneycombCover", "Subsubsection",ExpressionUUID->"dc4b68be-52f2-4d7c-affd-f3a53ce85b69"],

Cell["\<\
TemplateHoneycombCover produces a honeycomb cover over a rectangular regions. \
It completely covers the region [0,xmax] x [0,ymax] with hexagons of side 1. \
\
\>", "Text",
 CellChangeTimes->{{3.450731626785256*^9, 3.450731663197179*^9}, 
   3.450732367090151*^9},ExpressionUUID->"05aaa16f-3c84-4aea-a701-\
4a85b994416a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TemplateHoneycombCover", "[", 
   RowBox[{"xmax_", ",", " ", "ymax_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "oddxcenters", ",", " ", "evenxcenters", ",", " ", "centers", ",", " ", 
      "y", ",", " ", "even", ",", " ", "thesecenters", ",", " ", "unithex", 
      ",", "hexat", ",", " ", "v", ",", " ", "vcells", ",", " ", 
      "vertexNumber", ",", " ", "CellsByVertexNumber", ",", " ", 
      "cellbyvertex", ",", " ", "cellsByEdgePair", ",", " ", "edges", ",", 
      " ", "cellsByEdgeNumber", ",", " ", "edgeNumber"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"unithex", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", "#", "]"}], ",", 
          RowBox[{"Sin", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
       RowBox[{"Most", "[", 
        RowBox[{"Range", "[", 
         RowBox[{"0", ",", 
          RowBox[{"2", " ", "Pi"}], ",", 
          RowBox[{"Pi", "/", "3"}]}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"hexat", "[", 
       RowBox[{"{", 
        RowBox[{"xc_", ",", " ", "yc_"}], "}"}], "]"}], ":=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"xc", ",", "yc"}], "}"}], "+", "#"}], "&"}], "/@", 
       "unithex"}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     
     RowBox[{"(*", " ", 
      RowBox[{"calculate", " ", "centers", " ", "of", " ", "hexagons"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"oddxcenters", " ", "=", " ", 
      RowBox[{"Range", "[", 
       RowBox[{"0", ",", " ", "xmax", ",", " ", "3"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"evenxcenters", "=", 
      RowBox[{"Range", "[", 
       RowBox[{
        RowBox[{"3", "/", "2"}], ",", " ", "xmax", ",", " ", "3"}], "]"}]}], 
     ";", " ", "\[IndentingNewLine]", 
     RowBox[{"y", "=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sqrt", "[", "3", "]"}]}], "/", "4"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"even", "=", "False"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"centers", "=", 
      RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"y", "\[LessEqual]", " ", 
        RowBox[{"ymax", "+", 
         RowBox[{
          RowBox[{"Sqrt", "[", "3", "]"}], "/", "4"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{"even", ",", " ", "\[IndentingNewLine]", 
          RowBox[{"thesecenters", "=", "evenxcenters"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"thesecenters", "=", "oddxcenters"}]}], "]"}], ";", " ", 
        RowBox[{"thesecenters", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"#", ",", "y"}], "}"}], "&"}], "/@", "thesecenters"}]}], 
        ";", " ", "\[IndentingNewLine]", 
        RowBox[{"even", "=", 
         RowBox[{"Not", "[", "even", "]"}]}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"y", "=", 
         RowBox[{"y", "+", 
          RowBox[{
           RowBox[{"Sqrt", "[", "3", "]"}], "/", "2"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"centers", " ", "=", " ", 
         RowBox[{"Join", "[", 
          RowBox[{"centers", ",", " ", "thesecenters"}], "]"}]}], ";"}]}], 
      " ", "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "define", " ", "v", " ", "as", " ", "the", " ", "unique", " ", 
       "vertices"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"vcells", "=", 
      RowBox[{"hexat", "/@", "centers"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"v", "=", 
      RowBox[{"Union", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"vcells", ",", "1"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "determine", " ", "cells", " ", "by", " ", "vertex", " ", "numbers"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"CellsByVertexToTissue", "[", 
       RowBox[{"v", ",", " ", "vcells"}], "]"}], "]"}], ";"}]}], " ", 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwdzVsoQwEcx/FZydo0twceTGFlC6V1SlGYWDmKzXIbCrm8sEnYhrRoZTO5
zCiNUOSybGpWVpx52gwhbxgpQnlxCQ97cH7n4d+nf33rl9qqqWpns1isFPog
oVMIDvffpKIyVRpcMRtEMEQ4xTCu+ioHOsgYCYwfJgqgLjpCBRvbKtWwn5Rr
oOWA1w/dA90DcLe2eQgmbCuGYZbdZoIXr1wL1N5cz8K+kMsKFwKCE2jkBE/h
XsXZMxTfhl5gmKBSj2hlx4YM6L5+ksBvj4yAgd+eXlgSKRxkuuRiA+zY0DNO
icNzTKdMXGL+0stNOHHp24F8Z2YSRTvybkuHefV2MZw9r5HAJvlWLuQ47vNh
LPlXBK0f00oYxc2rg+Nf852w+o2rhjN20xBcbHCNwZqpsBGyW+RmSPkLLdDL
Kl6G3MmFVSjkPziYzn/nZHbJtQc46vEy2qXrPB9teZBi/OzyaR9pfyqz9fAf
vUsP+A==
  "],ExpressionUUID->"cca98535-a136-4043-83d7-e3529129f1b9"]
}, Closed]],

Cell[CellGroupData[{

Cell["TemplateRectangular", "Subsubsection",
 CellChangeTimes->{{3.455291786413171*^9, 
  3.455291789044973*^9}},ExpressionUUID->"14b343f4-74a6-471b-b7cb-\
a4e81a03c5b9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TemplateRectangular", "[", 
    RowBox[{"nx_", ",", " ", "ny_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "dbg", ",", " ", "dPrint", ",", " ", "x", ",", "y", ",", " ", "v", ",", 
       " ", "i", ",", " ", "j", ",", " ", "bl", ",", " ", "br", ",", " ", 
       "tr", ",", " ", "tl", ",", " ", "cvc", ",", " ", "cells", ",", " ", 
       "tiss"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"dPrint", "[", "x___", "]"}], ":=", " ", 
       RowBox[{"If", "[", 
        RowBox[{"dbg", ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<TemplateRectangular: \>\"", ",", " ", "x"}], "]"}]}], 
        "]"}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "j"}], "}"}], ",", "  ", 
           RowBox[{"{", 
            RowBox[{"j", ",", " ", "0", ",", " ", "ny"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "0", ",", " ", "nx"}], "}"}]}], "]"}], ",",
          " ", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<v: \>\"", ",", " ", "v"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"i", "=", "1"}], ";", " ", 
      RowBox[{"cells", "=", 
       RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"y", "=", "0"}], ",", " ", 
        RowBox[{"y", "<", " ", "ny"}], ",", 
        RowBox[{"y", "++"}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{"For", " ", "[", 
         RowBox[{
          RowBox[{"x", "=", "0"}], ",", " ", 
          RowBox[{"x", "<", " ", "nx"}], ",", 
          RowBox[{"x", "++"}], ",", " ", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"bl", "=", 
            RowBox[{"1", "+", " ", 
             RowBox[{"y", "*", 
              RowBox[{"(", 
               RowBox[{"nx", "+", "1"}], ")"}]}], "+", "x"}]}], ";", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"br", "=", 
            RowBox[{"bl", " ", "+", " ", "1"}]}], ";", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"tr", " ", "=", " ", 
            RowBox[{"br", "+", "nx", "+", "1"}]}], ";", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"tl", " ", "=", " ", 
            RowBox[{"tr", "-", "1"}]}], ";", " ", "\[IndentingNewLine]", 
           RowBox[{"cvc", " ", "=", " ", 
            RowBox[{"v", "[", 
             RowBox[{"[", 
              RowBox[{"{", 
               RowBox[{"bl", ",", "br", ",", " ", "tr", ",", " ", "tl"}], 
               "}"}], "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
           RowBox[{"dPrint", "[", 
            RowBox[{
            "\"\<cell: {x,y}=\>\"", ",", "i", ",", "\"\<:\>\"", ",", " ", 
             RowBox[{"{", 
              RowBox[{"x", ",", "y"}], "}"}], ",", " ", "\"\<, bottom:\>\"", 
             ",", " ", "bl", ",", " ", "\"\<,\>\"", ",", " ", "br", ",", " ", 
             "\"\< top: \>\"", ",", " ", "tr", ",", " ", "\"\<,\>\"", ",", 
             " ", "tl"}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"i", "++"}], ";", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"cells", ",", " ", "cvc"}], "]"}], ";"}]}], " ", 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{"tiss", "=", 
       RowBox[{"CellsByVertexToTissue", "[", 
        RowBox[{"v", ",", " ", "cells"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "tiss", "]"}], ";"}]}], " ", 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TemplateRectangular", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x0_", ",", "xmax_", ",", " ", "dx_"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"y0_", ",", " ", "ymax_", ",", " ", "dy_"}], "}"}]}], "]"}], ":=",
    " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "nx", ",", " ", "ny", ",", " ", "tiss", ",", " ", "X", ",", " ", "Y", 
       ",", " ", "V", ",", " ", "v", ",", " ", "c", ",", " ", "e"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"generate", " ", "the", " ", "tissue", " ", 
       RowBox[{"on", " ", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"nx", "+", "1"}]}], "]"}], " ", "\[Times]", " ", 
       RowBox[{"[", 
        RowBox[{"0", ",", 
         RowBox[{"ny", "+", "1"}]}], "]"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nx", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"xmax", "-", "x0"}], ")"}], "/", "dx"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ny", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"ymax", "-", "y0"}], ")"}], "/", "dy"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tiss", "=", 
       RowBox[{"TemplateRectangular", "[", 
        RowBox[{"nx", ",", " ", "ny"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"transform", " ", 
        RowBox[{"to", " ", "[", 
         RowBox[{"x0", ",", " ", "xmax"}], "]"}], " ", "\[Times]", " ", 
        RowBox[{"[", 
         RowBox[{"y0", ",", " ", "ymax"}], "]"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"X", "[", "x_", "]"}], ":=", " ", 
       RowBox[{"x0", " ", "+", " ", 
        RowBox[{"x", "*", 
         FractionBox[
          RowBox[{"xmax", "-", "x0"}], "nx"]}]}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Y", "[", "y_", "]"}], ":=", " ", 
       RowBox[{"y0", " ", "+", " ", 
        RowBox[{"y", " ", "*", " ", 
         FractionBox[
          RowBox[{"ymax", "-", "y0"}], "ny"]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"V", "[", 
        RowBox[{"{", 
         RowBox[{"x_", ",", " ", "y_"}], "}"}], "]"}], ":=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"X", "[", "x", "]"}], ",", " ", 
         RowBox[{"Y", "[", "y", "]"}]}], "}"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{"TissueVertices", "[", "tiss", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"e", "=", 
       RowBox[{"TissueEdges", "[", "tiss", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"TissueCells", "[", "tiss", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{"V", "/@", "v"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tiss", "=", 
       RowBox[{"Tissue", "[", 
        RowBox[{"v", ",", "e", ",", "c"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "tiss", "]"}], ";"}]}], " ", 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TemplateRectangular", "[", "x___", "]"}], ":=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
     "Print", "[", 
      "\"\<Expecting TemplateRectangular[nx,ny] or \
TemplateRectangular[{xmin,xmax,dx}, {ymin,ymax,dy}]\>\"", "]"}], ";", " ", 
     RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.455291790285849*^9, 3.45529179356479*^9}, {
   3.4552918462106943`*^9, 3.4552919812602253`*^9}, {3.455292035359953*^9, 
   3.455292043742305*^9}, {3.4552921041164618`*^9, 3.45529213258694*^9}, 
   3.4552922149056807`*^9, {3.455292250155917*^9, 3.455292250687244*^9}, {
   3.455292541844987*^9, 3.455292579792801*^9}, {3.455292638901931*^9, 
   3.455292683459103*^9}, {3.455292843213698*^9, 3.455292991805677*^9}, {
   3.455293181830884*^9, 3.455293184421023*^9}, {3.455293215105204*^9, 
   3.4552932374866943`*^9}, {3.4552933088444633`*^9, 
   3.4552933441087103`*^9}, {3.455293520401507*^9, 3.4552936296006193`*^9}, {
   3.45529366435933*^9, 3.455293721820314*^9}, {3.455293822441152*^9, 
   3.455293843395625*^9}, {3.455293884906637*^9, 3.4552938950678062`*^9}, {
   3.4552939525227947`*^9, 3.455294031372138*^9}, {3.455294083964446*^9, 
   3.45529409262385*^9}, {3.4552941751438637`*^9, 3.4552942509703074`*^9}, {
   3.4552942831792307`*^9, 3.4552944076389*^9}, {3.455296375416298*^9, 
   3.455296378004765*^9}, {3.562596979556397*^9, 
   3.56259702016477*^9}},ExpressionUUID->"72703f2f-62c7-43ff-b619-\
95907726d2ad"]
}, Closed]],

Cell[CellGroupData[{

Cell["TemplateRectangularCover", "Subsubsection",
 CellChangeTimes->{{3.4507326446708097`*^9, 
  3.450732674382468*^9}},ExpressionUUID->"70a0ffa0-3d82-4f22-838c-\
92fd1d95d050"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TemplateRectangularCover", "[", 
   RowBox[{
   "xmax_", ",", " ", "ymax_", ",", " ", "\[CapitalDelta]x_", ",", " ", 
    "\[CapitalDelta]y_", ",", " ", 
    RowBox[{"offset_:", 
     RowBox[{"(", 
      RowBox[{"1", "/", "2"}], ")"}]}], ",", " ", 
    RowBox[{"dbg_:", "False"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "n", ",", " ", "oddxcenters", ",", " ", "evenxcenters", ",", " ", 
      "centers", ",", " ", "y", ",", " ", "even", ",", " ", "data", ",", " ", 
      "corners", ",", " ", "rectangleAt", ",", " ", "rline", ",", " ", "v", 
      ",", " ", "vcells", ",", " ", "q", ",", " ", "outsiders", ",", " ", 
      "dPrint"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"dPrint", "[", "x___", "]"}], ":=", " ", 
      RowBox[{"If", "[", 
       RowBox[{"dbg", ",", " ", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<TemplateRectangularCover: \>\"", ",", " ", "x"}], 
         "]"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"t1", "=", 
      RowBox[{"TimeUsed", "[", "]"}]}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"corners", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[CapitalDelta]x"}], "/", "2"}], ",", " ", 
          RowBox[{"\[CapitalDelta]y", "/", "2"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[CapitalDelta]x", "/", "2"}], ",", " ", 
          RowBox[{"\[CapitalDelta]y", "/", "2"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[CapitalDelta]x", "/", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"-", "\[CapitalDelta]y"}], "/", "2"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[CapitalDelta]x"}], "/", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"-", "\[CapitalDelta]y"}], "/", "2"}]}], "}"}]}], "}"}]}], 
     ";", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rectangleAt", "[", 
       RowBox[{"{", 
        RowBox[{"xc_", ",", " ", "yc_"}], "}"}], "]"}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"xc", ",", " ", "yc"}], "}"}], "+", "#"}], ")"}], "&"}], "/@",
        "corners"}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"determine", " ", "centers", " ", "of", " ", "rectangles"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"n", "=", 
      RowBox[{"xmax", "/", "\[CapitalDelta]x"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"oddxcenters", "=", 
      RowBox[{"Range", "[", 
       RowBox[{
        RowBox[{"-", "\[CapitalDelta]x"}], ",", " ", 
        RowBox[{"xmax", "+", 
         RowBox[{"\[CapitalDelta]x", "/", "2"}]}], ",", " ", 
        "\[CapitalDelta]x"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "oddxcenters", "]"}], "<", "n"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"oddxcenters", ",", " ", "\[CapitalDelta]x"}], "]"}]}], "]"}],
      ";", " ", "\[IndentingNewLine]", " ", 
     RowBox[{"evenxcenters", " ", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", " ", 
          RowBox[{"\[CapitalDelta]x", "*", "offset"}], ")"}], "+", "#"}], 
        "&"}], "/@", "oddxcenters"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"centers", "=", 
      RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"y", "=", "0"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"even", "=", "False"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"y", "\[LessEqual]", 
        RowBox[{"ymax", "+", "\[CapitalDelta]y"}]}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{"even", ",", " ", 
          RowBox[{"data", " ", "=", " ", "evenxcenters"}], ",", " ", 
          RowBox[{"data", " ", "=", " ", "oddxcenters"}]}], "]"}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"data", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"#", ",", " ", "y"}], "}"}], "&"}], "/@", "data"}]}], ";",
         " ", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"centers", ",", " ", "data"}], "]"}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"y", " ", "=", " ", 
         RowBox[{"y", "+", " ", "\[CapitalDelta]y"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"even", "=", 
         RowBox[{"Not", "[", "even", "]"}]}]}]}], "\[IndentingNewLine]", 
      "]"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<centers: \>\"", ",", " ", 
       RowBox[{
        RowBox[{"TimeUsed", "[", "]"}], "-", "t1"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"t2", "=", 
      RowBox[{"TimeUsed", "[", "]"}]}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "*", " ", "NOTE", " ", "THERE", " ", "WILL", " ", "BE", " ", "SOME", 
       " ", "VERTICES", " ", "THAT", " ", "ARE", " ", "IN", " ", "SOME", " ", 
       "CELLS", " ", "THAT", " ", "ARE", " ", "NOT", " ", "ON", " ", 
       RowBox[{
        RowBox[{"CORNERS", "!!"}], "!"}]}], " ", "**)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"*", " ", "NEED", " ", "TO", " ", "FIX", " ", 
       RowBox[{
        RowBox[{"THIS", "!!"}], "!"}]}], " ", "**)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"determine", " ", "corners", " ", "of", " ", "rectangles"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rline", "[", "x_", "]"}], ":=", " ", 
      RowBox[{"rectangleAt", "/@", "x"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"v", "=", 
      RowBox[{"Map", "[", 
       RowBox[{"rline", ",", " ", "centers"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "list", " ", "of", " ", "cells", " ", "as", " ", "vertex", " ", 
       "coordinates"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"vcells", " ", "=", " ", 
      RowBox[{"Join", "@@", "v"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"list", " ", "of", " ", "unique", " ", "vertices"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"v", "=", 
      RowBox[{"Union", "[", 
       RowBox[{"Join", "@@", "vcells"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "...", " ", "continue", " ", "as", " ", "with", " ", "hexagons"}], 
       "  ", "..."}], " ", "*)"}], " ", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "determine", " ", "cells", " ", "by", " ", "vertex", " ", "numbers"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<v: \>\"", ",", " ", 
       RowBox[{
        RowBox[{"TimeUsed", "[", "]"}], "-", "t2"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"t3", "=", 
      RowBox[{"TimeUsed", "[", "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"q", "=", 
      RowBox[{"CellsByVertexToTissue", "[", 
       RowBox[{"v", ",", " ", "vcells"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<q: \>\"", ",", " ", 
       RowBox[{
        RowBox[{"TimeUsed", "[", "]"}], "-", "t3"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"t4", "=", 
      RowBox[{"TimeUsed", "[", "]"}]}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "remove", " ", "any", " ", "cells", " ", "that", " ", "manage", " ", 
       "to", " ", "lie", " ", "completely", " ", "outside", " ", "the", " ", 
       "desired", " ", "cover"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"outsiders", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"OutsideBox", "[", 
         RowBox[{
          RowBox[{"CellVertexCoordinates", "[", 
           RowBox[{"q", ",", " ", "#"}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"xmax", ",", " ", "0"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"xmax", ",", " ", "ymax"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"0", ",", " ", "ymax"}], "}"}]}], "}"}]}], "]"}], "&"}], 
       "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"NTissueCells", "[", "q", "]"}], "]"}]}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"outsiders", " ", "=", " ", 
      RowBox[{"Pick", "[", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"NTissueCells", "[", "q", "]"}], "]"}], ",", " ", 
        "outsiders"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<Finding Outsiders: \>\"", ",", " ", 
       RowBox[{
        RowBox[{"TimeUsed", "[", "]"}], "-", "t4"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<There are \>\"", " ", ",", 
       RowBox[{"Length", "[", "outsiders", "]"}], ",", " ", 
       "\"\< outsiders.\>\""}], "]"}], ";", " ", "\[IndentingNewLine]", " ", 
     RowBox[{"t5", "=", 
      RowBox[{"TimeUsed", "[", "]"}]}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "outsiders", "]"}], ">", "0"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"q", "=", 
        RowBox[{"RemoveCell", "[", 
         RowBox[{"q", ",", " ", "outsiders"}], "]"}]}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Fix", " ", "vertices", " ", "that", " ", "were", " ", "skipped", " ", 
       "because", " ", "of", " ", "edge", " ", "offset"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<Removing Outsiders: \>\"", ",", " ", 
       RowBox[{
        RowBox[{"TimeUsed", "[", "]"}], "-", "t5"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<There are \>\"", ",", " ", 
       RowBox[{"Length", "[", 
        RowBox[{"EntangledVertices", "[", "q", "]"}], "]"}], ",", " ", 
       "\"\< entanglements.\>\""}], "]"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"t6", "=", 
      RowBox[{"TimeUsed", "[", "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"q", "=", " ", 
      RowBox[{"DisentangleVertices", "[", "q", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<Disentangling: \>\"", ",", " ", 
       RowBox[{
        RowBox[{"TimeUsed", "[", "]"}], "-", "t6"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<Total time: \>\"", ",", " ", 
       RowBox[{
        RowBox[{"TimeUsed", "[", "]"}], "-", "t1"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "q", "]"}], ";"}]}], " ", "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.45073265349247*^9, 3.4507331152143383`*^9}, {
   3.4507331542274017`*^9, 3.450733154515211*^9}, {3.4507332261924257`*^9, 
   3.450733228475827*^9}, {3.45073326901717*^9, 3.450733269223196*^9}, {
   3.4507333626701117`*^9, 3.450733377086608*^9}, {3.450733414641836*^9, 
   3.450733415918062*^9}, {3.450733452463361*^9, 3.4507336013303967`*^9}, {
   3.4507336390885344`*^9, 3.4507336888262653`*^9}, {3.450733794259016*^9, 
   3.450733832413302*^9}, {3.4507339392861633`*^9, 3.450733964697488*^9}, {
   3.4507340024636374`*^9, 3.450734011451892*^9}, {3.4507340662376204`*^9, 
   3.4507341667509003`*^9}, 3.4508005479655933`*^9, {3.450800610723776*^9, 
   3.450800669116848*^9}, {3.450800719589484*^9, 3.450800720078958*^9}, 
   3.450800759037532*^9, {3.450800895545493*^9, 3.450800897559308*^9}, {
   3.4508010248249826`*^9, 3.450801038348909*^9}, {3.450801240945962*^9, 
   3.45080128399084*^9}, {3.450801318860571*^9, 3.450801351737569*^9}, {
   3.450801720298037*^9, 3.450801720979909*^9}, {3.450808001964967*^9, 
   3.450808016983221*^9}, {3.450808545200884*^9, 3.450808576528998*^9}, {
   3.450808677745844*^9, 3.4508088438447866`*^9}, {3.450808962138603*^9, 
   3.450808962332165*^9}, {3.451056256021097*^9, 3.451056282992589*^9}, {
   3.451066685879903*^9, 3.451066735787574*^9}, {3.455277644941146*^9, 
   3.455277844364696*^9}, {3.455277954437007*^9, 3.455277954646675*^9}, {
   3.455278008486886*^9, 3.455278063773759*^9}, {3.4552781735079193`*^9, 
   3.45527817510526*^9}, {3.4552911283392143`*^9, 
   3.455291141213368*^9}},ExpressionUUID->"b469215b-f790-411d-94d5-\
b6108f16c8e0"]
}, Closed]],

Cell[CellGroupData[{

Cell["CellsByVertexToTissue", "Subsubsection",
 CellChangeTimes->{{3.450800690254973*^9, 
  3.450800749947357*^9}},ExpressionUUID->"28de4ef7-9567-4f3b-a868-\
7d1aff352fb4"],

Cell["\<\
v: list of cell vertex coordinates
vcells: list of cells by vertex coordinates, as in 
\t{{{x1,y1}, {x2, y2}, ...}, {{p1, q1}, {p2,q2}, ...} ,...}
\twhere each of the x1, y1, ... are in v (precisely)\
\>", "Text",
 CellChangeTimes->{{3.45080082691599*^9, 
  3.4508008903761463`*^9}},ExpressionUUID->"1b3e832b-ee07-431e-b219-\
f94e227dcfb8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CellsByVertexToTissue", "[", 
    RowBox[{"v_", ",", " ", "vcells_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "vertexNumber", ",", " ", "cellbyvertex", ",", " ", 
       "CellsByVertexNumber", ",", " ", "cellsByEdgePair", ",", " ", "edges", 
       ",", " ", "edgeNumber", ",", " ", "cellsByEdgeNumber"}], "}"}], ",", 
     " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"vertexNumber", "[", 
        RowBox[{"{", 
         RowBox[{"xc_", ",", " ", "yc_"}], "}"}], "]"}], ":=", " ", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"v", ",", " ", 
          RowBox[{"{", 
           RowBox[{"xc", ",", " ", "yc"}], "}"}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", " ", "1"}], "]"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"cellbyvertex", "[", 
        RowBox[{"{", 
         RowBox[{"xy__", "?", "numPairQ"}], "}"}], "]"}], ":=", " ", 
       RowBox[{"vertexNumber", "/@", 
        RowBox[{"{", "xy", "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"CellsByVertexNumber", "=", 
       RowBox[{"cellbyvertex", "/@", "vcells"}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "determine", " ", "cells", " ", "by", " ", "edge", " ", "number"}], 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"cellsByEdgePair", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Partition", "[", 
           RowBox[{"#", ",", "2", ",", "1", ",", "1"}], "]"}], "&"}], ",", 
         " ", "CellsByVertexNumber"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"edges", " ", "=", " ", 
       RowBox[{"Join", "@@", "cellsByEdgePair"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"edges", " ", "=", " ", 
       RowBox[{"Sort", "/@", "edges"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"edges", " ", "=", " ", 
       RowBox[{"Union", "[", "edges", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"cellsByEdgePair", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Sort", "/@", "#"}], "&"}], ",", " ", "cellsByEdgePair"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"edgeNumber", "[", 
        RowBox[{"{", 
         RowBox[{"i_", ",", " ", "j_"}], "}"}], "]"}], ":=", " ", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"edges", ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", "j"}], "}"}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"cellsByEdgeNumber", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"edgeNumber", "/@", "#"}], "&"}], ",", " ", 
         "cellsByEdgePair"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<v\>\"", "\[Rule]", " ", "v"}], ",", " ", 
          RowBox[{"\"\<vcells\>\"", "\[Rule]", " ", "vcells"}], ",", " ", 
          RowBox[{"\"\<cells\>\"", "\[Rule]", " ", "CellsByVertexNumber"}], 
          ",", " ", 
          RowBox[{"\"\<edges\>\"", "\[Rule]", " ", "edges"}], ",", " ", 
          RowBox[{"\"\<cellsByEdgePair\>\"", "\[Rule]", "cellsByEdgePair"}], 
          ",", " ", "\[IndentingNewLine]", 
          RowBox[{
          "\"\<cellsByEdgeNumber\>\"", "\[Rule]", " ", 
           "cellsByEdgeNumber"}]}], "}"}], ";"}], "\[IndentingNewLine]", 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Tissue", "[", 
       RowBox[{"v", ",", " ", "edges", ",", " ", "cellsByEdgeNumber"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{" "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.450800764586722*^9, 3.450800820421723*^9}, {
   3.470524202919029*^9, 3.470524208669433*^9}, 
   3.4705242458949623`*^9},ExpressionUUID->"2c3d8470-ff01-4e8b-a6cd-\
d22df6cab8f6"]
}, Closed]],

Cell[CellGroupData[{

Cell["CellVerticesToTissue", "Subsubsection",
 CellChangeTimes->{{3.470524249528988*^9, 
  3.470524267119886*^9}},ExpressionUUID->"e9878e9a-127e-4537-afc6-\
deb2e7ede980"],

Cell["\<\
vcells is the same as in CellsByVertexToTissue; but here the list of vertices \
does not have to be specified.\
\>", "Text",
 CellChangeTimes->{{3.47052431900947*^9, 
  3.470524333556794*^9}},ExpressionUUID->"4959d18b-2e1e-4860-9fd6-\
3f707a9941a7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CellVerticesToTissue", "[", "vcells_", "]"}], ":=", " ", 
    RowBox[{"CellsByVertexToTissue", "[", 
     RowBox[{
      RowBox[{"Union", "[", 
       RowBox[{"Join", "@@", "vcells"}], "]"}], ",", " ", "vcells"}], "]"}]}],
    ";"}], " ", "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.470524268646551*^9, 
  3.470524310968018*^9}},ExpressionUUID->"395d5945-decd-4a99-9561-\
2a7fdfa68919"]
}, Closed]],

Cell[CellGroupData[{

Cell["TemplateCircularHoneycomb", "Subsubsection",
 CellChangeTimes->{{3.545839269883339*^9, 
  3.545839273786881*^9}},ExpressionUUID->"4ddd7bfb-6dee-437e-b9e3-\
1c85c836ca6a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TemplateCircularHoneycomb", "[", 
   RowBox[{"layers_", ",", " ", "area_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"q", ",", " ", "mult", ",", 
      RowBox[{"hexarea", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"3.0", " ", 
          RowBox[{"Sqrt", "[", "3", "]"}]}], ")"}], "/", "2"}]}], ",", " ", 
      "v", ",", " ", "e", ",", " ", "c"}], "}"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"q", "=", 
      RowBox[{"TemplateCircularHoneycombCover", "[", "layers", "]"}]}], ";", 
     " ", "\[IndentingNewLine]", 
     RowBox[{"mult", " ", "=", " ", 
      RowBox[{"1.0", "*", " ", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"area", "/", "hexarea"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"v", "=", 
      RowBox[{"mult", "*", 
       RowBox[{"TissueVertices", "[", "q", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"e", "=", 
      RowBox[{"TissueEdges", "[", "q", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"TissueCells", "[", "q", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Tissue", "[", 
      RowBox[{"v", ",", "e", ",", "c"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.545839282195827*^9, 3.545839286462283*^9}, {
  3.54583936067945*^9, 3.5458394044370327`*^9}, {3.54583946440602*^9, 
  3.5458395522600307`*^9}},ExpressionUUID->"5f2b9345-2780-4c5f-b9b9-\
66e0ee5e5290"]
}, Closed]],

Cell[CellGroupData[{

Cell["TemplateCircularHoneycombCover", "Subsubsection",
 CellChangeTimes->{{3.45173975239011*^9, 
  3.4517397534948597`*^9}},ExpressionUUID->"fbb1e16b-81b4-40d6-9f8d-\
6427678f3402"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TemplateCircularHoneycombCover", "[", 
   RowBox[{"radius_", ",", " ", 
    RowBox[{"mode_:", "-", "1"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "oddxcenters", ",", " ", "evenxcenters", ",", " ", "centers", ",", " ", 
      "y", ",", " ", "even", ",", " ", "thesecenters", ",", " ", "unithex", 
      ",", "hexat", ",", " ", "v", ",", " ", "vcells", ",", " ", 
      "vertexNumber", ",", " ", "CellsByVertexNumber", ",", " ", 
      "cellbyvertex", ",", " ", "cellsByEdgePair", ",", " ", "edges", ",", 
      " ", "cellsByEdgeNumber", ",", " ", "edgeNumber", ",", " ", "r", ",", 
      " ", "topcenters", ",", " ", "bottomcenters", ",", " ", "tissue", ",", 
      " ", "semicircle", ",", " ", "allthesecenters"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"IntegerQ", "[", "mode", "]"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"semicircle", " ", "=", " ", 
         RowBox[{"(", 
          RowBox[{"mode", "\[GreaterEqual]", " ", "0"}], ")"}]}], ";"}], 
       "\[IndentingNewLine]", ",", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<Error: TemplateCircularHoneycombCover: expecting an integer > \
for mode (-1: circle; or # rows to add to bottom)\>\"", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"semicircle", "=", "False"}], ";"}]}], " ", 
      "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"unithex", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", "#", "]"}], ",", 
          RowBox[{"Sin", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
       RowBox[{"Most", "[", 
        RowBox[{"Range", "[", 
         RowBox[{"0", ",", 
          RowBox[{"2", " ", "Pi"}], ",", 
          RowBox[{"Pi", "/", "3"}]}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"hexat", "[", 
       RowBox[{"{", 
        RowBox[{"xc_", ",", " ", "yc_"}], "}"}], "]"}], ":=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"xc", ",", "yc"}], "}"}], "+", "#"}], "&"}], "/@", 
       "unithex"}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     
     RowBox[{"(*", " ", 
      RowBox[{"calculate", " ", "centers", " ", "of", " ", "hexagons"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"evenxcenters", " ", "=", " ", 
      RowBox[{"Range", "[", 
       RowBox[{"0", ",", " ", 
        RowBox[{"radius", "+", 
         RowBox[{"3", "/", "2"}]}], ",", " ", "3"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"evenxcenters", " ", "=", " ", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{"evenxcenters", ",", " ", 
         RowBox[{"-", "evenxcenters"}]}], "]"}], "//", "Union"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"oddxcenters", " ", "=", " ", 
      RowBox[{"Range", "[", 
       RowBox[{
        RowBox[{"3", "/", "2"}], ",", " ", 
        RowBox[{"radius", " ", "+", "  ", 
         RowBox[{"3", "/", "2"}]}], ",", " ", "3"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"oddxcenters", " ", "=", " ", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{"oddxcenters", ",", " ", 
         RowBox[{"-", "oddxcenters"}]}], "]"}], "//", "Union"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"y", "=", "0"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"even", "=", "True"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"centers", "=", 
      RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"i", "=", "0"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"y", "\[LessEqual]", 
        RowBox[{"radius", "+", 
         RowBox[{
          RowBox[{"Sqrt", "[", "3", "]"}], "/", "2"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{"even", ",", " ", "\[IndentingNewLine]", 
          RowBox[{"thesecenters", "=", "evenxcenters"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"thesecenters", "=", "oddxcenters"}]}], "]"}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"allthesecenters", "=", "thesecenters"}], ";", " ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"thesecenters", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"thesecenters", ",", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"#", "^", "2"}], " ", "<", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"radius", "+", "1"}], ")"}], "^", "2"}], " ", "-", 
               " ", 
               RowBox[{"y", "^", "2"}]}]}], ")"}], "&"}]}], "]"}]}], ";", " ",
         "\[IndentingNewLine]", 
        RowBox[{"topcenters", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"#", ",", "y"}], "}"}], "&"}], "/@", "thesecenters"}]}], 
        ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"if", " ", "a", " ", "circle"}], ",", " ", 
          RowBox[{"odd", " ", "the", " ", "bottom", " ", "half"}]}], " ", 
         "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"i", ">", "0"}], " ", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", " ", 
            RowBox[{
             RowBox[{"!", "semicircle"}], ",", " ", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"bottomcenters", "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"#", ",", 
                   RowBox[{"-", "y"}]}], "}"}], "&"}], "/@", 
                "thesecenters"}]}], ";"}], " ", ",", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{"if", " ", "a", " ", "semicircle"}], ",", " ", 
               RowBox[{
                RowBox[{"don", "'"}], "t", " ", "add", " ", "bottom", " ", 
                "half", " ", "of", " ", "circle"}]}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
              "but", " ", "do", " ", "add", " ", "a", " ", "flat", " ", 
               "line", " ", "if", " ", "requested"}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{"#", " ", "of", " ", "lines"}], " ", "=", " ", 
               "mode"}], " ", "*)"}], "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"i", "\[LessEqual]", "mode"}], ",", " ", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"bottomcenters", " ", "=", " ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#", ",", " ", 
                    RowBox[{"-", "y"}]}], "}"}], "&"}], "/@", 
                   "allthesecenters"}]}], ";"}], " ", ",", 
                "\[IndentingNewLine]", " ", 
                RowBox[{"bottomcenters", "=", 
                 RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "]"}], 
              ";"}]}], " ", "\[IndentingNewLine]", "]"}], ";"}], 
          "\[IndentingNewLine]", ",", " ", "\[IndentingNewLine]", 
          RowBox[{"bottomcenters", "=", 
           RowBox[{"{", "}"}]}]}], " ", "\[IndentingNewLine]", "]"}], ";", 
        " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"even", "=", 
         RowBox[{"Not", "[", "even", "]"}]}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"y", "=", 
         RowBox[{"y", "+", 
          RowBox[{
           RowBox[{"Sqrt", "[", "3", "]"}], "/", "2"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"i", "=", 
         RowBox[{"i", "+", "1"}]}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"centers", " ", "=", " ", 
         RowBox[{"Join", "[", 
          RowBox[{
          "centers", ",", " ", "topcenters", ",", " ", "bottomcenters"}], 
          "]"}]}], ";"}]}], " ", "\[IndentingNewLine]", "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "define", " ", "v", " ", "as", " ", "the", " ", "unique", " ", 
       "vertices"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"vcells", "=", 
      RowBox[{"hexat", "/@", "centers"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"v", "=", 
      RowBox[{"Union", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"vcells", ",", "1"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "determine", " ", "cells", " ", "by", " ", "vertex", " ", "numbers"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"tissue", " ", "=", " ", 
      RowBox[{"CellsByVertexToTissue", "[", 
       RowBox[{"v", ",", " ", "vcells"}], "]"}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "tissue", "]"}], ";"}]}], " ", 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.450726634545923*^9, 3.45072667482143*^9}, {
   3.450726724016922*^9, 3.450726733475203*^9}, {3.450726790541634*^9, 
   3.450726800477865*^9}, {3.4507268976401453`*^9, 3.450727120032772*^9}, {
   3.450727282481001*^9, 3.450727290509089*^9}, {3.4507273363664*^9, 
   3.45072734742074*^9}, {3.450727387010703*^9, 3.450727394552011*^9}, {
   3.450727500675314*^9, 3.450727520340919*^9}, {3.450727574620418*^9, 
   3.450727581527033*^9}, {3.450728008930736*^9, 3.45072803031354*^9}, {
   3.450728238384606*^9, 3.450728254933003*^9}, {3.450728717975218*^9, 
   3.450728764023593*^9}, {3.4507288551508427`*^9, 3.450728866209833*^9}, {
   3.4507293635302467`*^9, 3.450729425125643*^9}, {3.4507294740659513`*^9, 
   3.4507294758015623`*^9}, {3.450729639880073*^9, 3.450729704728977*^9}, {
   3.450729798508491*^9, 3.450729822025457*^9}, {3.450730689365119*^9, 
   3.4507307806851187`*^9}, {3.450730828885892*^9, 3.450730898712594*^9}, {
   3.45073094129106*^9, 3.4507309749585*^9}, {3.450731015759041*^9, 
   3.450731164529489*^9}, {3.450731201813724*^9, 3.450731324717228*^9}, {
   3.450731376340983*^9, 3.450731484300362*^9}, {3.450731549511182*^9, 
   3.450731567892497*^9}, {3.450731602511842*^9, 3.450731617993133*^9}, {
   3.4507317620625887`*^9, 3.4507317887359667`*^9}, {3.450731878970476*^9, 
   3.450731902899293*^9}, {3.450732285071537*^9, 3.450732285834779*^9}, {
   3.450732637164259*^9, 3.450732637993444*^9}, {3.450801086013299*^9, 
   3.450801097416011*^9}, {3.451739759586928*^9, 3.4517398251962843`*^9}, {
   3.451739891646082*^9, 3.451740033270824*^9}, {3.4517400730398607`*^9, 
   3.451740341035243*^9}, {3.451740405813182*^9, 3.4517404086039143`*^9}, {
   3.4517404588037233`*^9, 3.451740463965728*^9}, {3.4517405708205023`*^9, 
   3.451740575818263*^9}, {3.451740614062882*^9, 3.4517406574550533`*^9}, 
   3.4517406881202803`*^9, {3.4517407243350687`*^9, 3.45174074100298*^9}, {
   3.451741150069165*^9, 3.4517413499060926`*^9}, {3.45174142694818*^9, 
   3.4517415445194273`*^9}, {3.451741575859867*^9, 3.451741655128325*^9}, {
   3.451741765208112*^9, 3.451741771008222*^9}, {3.451741805048237*^9, 
   3.451741859682234*^9}, {3.451741892152772*^9, 3.451742042520287*^9}, {
   3.451743403728812*^9, 3.451743413132779*^9}, {3.451743474185905*^9, 
   3.451743547949295*^9}, {3.451743579264192*^9, 3.4517435911966953`*^9}, {
   3.4517437498211727`*^9, 3.451743861159268*^9}, {3.45174397568561*^9, 
   3.451743992477132*^9}, {3.451744037455339*^9, 3.451744047254888*^9}, {
   3.451744172639358*^9, 3.4517442262610903`*^9}, {3.451744274733033*^9, 
   3.4517444236050177`*^9}, {3.451744549327869*^9, 3.451744956394273*^9}, {
   3.4517451581757517`*^9, 3.451745158653267*^9}, {3.4517453062027483`*^9, 
   3.451745323447061*^9}, {3.451745605754882*^9, 3.451745670179656*^9}, {
   3.451767040094859*^9, 3.451767043870932*^9}, {3.545839250791801*^9, 
   3.545839265395262*^9}},ExpressionUUID->"f9c4773a-dede-420a-9f82-\
55ac7f43616a"]
}, Closed]],

Cell[CellGroupData[{

Cell["TemplateRing", "Subsubsection",
 CellChangeTimes->{{3.5348518582542048`*^9, 
  3.534851863535664*^9}},ExpressionUUID->"568b8864-6c87-404f-a8e7-\
8244a8944661"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TemplateRing", "[", 
   RowBox[{"n_", ",", " ", "R_", ",", " ", "A_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"r", ",", " ", "Amax", ",", " ", "v", ",", "c", ",", "e"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Amax", " ", "=", " ", 
      RowBox[{"Pi", "*", 
       RowBox[{
        RowBox[{"R", "^", "2"}], "/", "n"}]}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"A", " ", ">", "Amax"}], ",", " ", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Error: incompatible input {n,R,A}=\>\"", ",", " ", 
          RowBox[{"{", 
           RowBox[{"n", ",", "R", ",", "A"}], "}"}], ",", " ", 
          "\"\<\\nTo fit this many cells the area must be at most \>\"", ",", 
          " ", "Amax"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Abort", "[", "]"}], ";"}]}], " ", "\[IndentingNewLine]", 
      "]"}], ";", "  ", "\[IndentingNewLine]", 
     RowBox[{"r", "=", 
      SqrtBox[
       RowBox[{
        RowBox[{"R", "^", "2"}], " ", "-", " ", 
        RowBox[{"n", "*", 
         RowBox[{"A", "/", 
          RowBox[{"(", "Pi", ")"}]}]}]}]]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"v", " ", "=", " ", 
      RowBox[{"Join", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"r", "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"(", 
               RowBox[{"k", "*", "2.0", "*", 
                RowBox[{"Pi", "/", "n"}]}], ")"}], "]"}]}], ",", " ", 
            RowBox[{"r", "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"k", "*", "2.0", "*", 
               RowBox[{"Pi", "/", "n"}]}], "]"}]}]}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"k", ",", "0", ",", 
            RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"R", "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"(", 
               RowBox[{"k", "*", "2.0", "*", 
                RowBox[{"Pi", "/", "n"}]}], ")"}], "]"}]}], ",", " ", 
            RowBox[{"R", "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"k", "*", "2.0", "*", 
               RowBox[{"Pi", "/", "n"}]}], "]"}]}]}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"k", ",", "0", ",", 
            RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"e", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", "n"}], "]"}], ",", "2", ",", "1", ",", "1"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{
            RowBox[{"n", "+", "1"}], ",", " ", 
            RowBox[{"n", "+", "n"}]}], "]"}], ",", " ", "2", ",", " ", "1", 
          ",", " ", "1"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"k", ",", 
            RowBox[{"k", "+", "n"}]}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"k", ",", " ", "1", ",", " ", "n"}], "}"}]}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"c", "=", " ", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"k", ",", " ", 
            RowBox[{
             RowBox[{"2", "n"}], "+", "1", "+", "k"}], ",", " ", 
            RowBox[{"n", "+", "k"}], ",", " ", 
            RowBox[{
             RowBox[{"2", "n"}], "+", "k"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", " ", "1", ",", 
            RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"n", ",", " ", 
          RowBox[{
           RowBox[{"2", "n"}], "+", "1"}], ",", " ", 
          RowBox[{"2", "n"}], ",", " ", 
          RowBox[{"3", "n"}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Tissue", "[", 
       RowBox[{"v", ",", "e", ",", "c"}], "]"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"Tissue", "[", 
       RowBox[{"v", ",", "e", ",", "c"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5348518648189383`*^9, 3.5348519047621737`*^9}, {
  3.5348521147631273`*^9, 3.534852405807967*^9}, {3.534852459319961*^9, 
  3.534852553598192*^9}, {3.534852719490394*^9, 3.534853080870531*^9}, {
  3.534853113992648*^9, 3.5348531509540377`*^9}, {3.534853214167938*^9, 
  3.534853232922536*^9}, {3.534853869810341*^9, 3.534853954717311*^9}, {
  3.5348539926850557`*^9, 3.534854003390319*^9}, {3.53485408083963*^9, 
  3.5348541146271143`*^9}, {3.534854285775065*^9, 3.534854290595673*^9}, {
  3.534854329170684*^9, 3.534854396894319*^9}, {3.534854761079492*^9, 
  3.534854761304264*^9}},ExpressionUUID->"3ea55550-f0c7-4401-a147-\
a35bd2f5373c"]
}, Closed]],

Cell[CellGroupData[{

Cell["TemplateRandom", "Subsubsection",
 CellChangeTimes->{{3.451842804891487*^9, 3.4518428166867943`*^9}, {
  3.451846729400948*^9, 
  3.451846731270175*^9}},ExpressionUUID->"f1f18d75-2b03-41e5-a930-\
fc22df59a155"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TemplateRandom", "[", 
    RowBox[{
     RowBox[{"npoints_", "?", "IntegerQ"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"xy__", "?", "numPairQ"}], "}"}], ",", " ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "rx", ",", " ", "ry", ",", " ", "xmax", ",", " ", "ymax", ",", " ", 
       "xmin", ",", " ", "ymin", ",", " ", "i", ",", " ", "points", ",", 
       "point", ",", " ", "itotal", ",", " ", "bvd", ",", " ", 
       RowBox[{"trace", "=", "True"}], ",", " ", "tPrint", ",", "  ", "v", 
       ",", " ", "val", ",", " ", "cells", ",", " ", "e", ",", " ", "c", ",", 
       " ", "cellEdges", ",", " ", "boundary", ",", " ", "q"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"trace", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<Debug\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Debug\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";", 
      " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tPrint", "[", "x___", "]"}], ":=", " ", 
       RowBox[{"If", "[", 
        RowBox[{"trace", ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<TemplateRandom: \>\"", ",", " ", "x"}], "]"}]}], 
        "]"}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"boundary", "=", 
       RowBox[{"{", "xy", "}"}]}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"generate", " ", "random", " ", "centers"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"xmin", " ", "=", " ", 
       RowBox[{"Min", "[", 
        RowBox[{"First", "/@", "boundary"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"xmax", " ", "=", " ", 
       RowBox[{"Max", "[", 
        RowBox[{"First", "/@", "boundary"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"ymin", "=", 
       RowBox[{"Min", "[", 
        RowBox[{"Last", "/@", "boundary"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"ymax", " ", "=", " ", 
       RowBox[{"Max", "[", 
        RowBox[{"Last", "/@", "boundary"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"rx", ":=", " ", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{"xmin", ",", " ", "xmax"}], "}"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"ry", ":=", " ", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{"ymin", ",", " ", "ymax"}], "}"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"i", "=", 
       RowBox[{"itotal", "=", "0"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"points", "=", 
       RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"i", "<", "npoints"}], " ", "\[And]", " ", 
         RowBox[{"itotal", "<", 
          RowBox[{"10", "^", "5"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"itotal", "++"}], ";", " ", "\[IndentingNewLine]", 
         RowBox[{"point", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{"rx", ",", " ", "ry"}], "}"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Inside", "[", 
            RowBox[{"boundary", ",", " ", "point"}], "]"}], ",", " ", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"i", "++"}], ";", " ", "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"points", ",", " ", "point"}], "]"}], ";"}]}], " ", 
          "\[IndentingNewLine]", "]"}], ";"}]}], " ", "\[IndentingNewLine]", 
       "]"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"tPrint", "[", 
       RowBox[{"i", ",", " ", "\"\< points generated \>\"", ",", " ", 
        RowBox[{"100.0", "*", 
         RowBox[{"i", "/", "itotal"}]}], ",", "\"\<% success rate.\>\""}], 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"tPrint", "[", 
         RowBox[{"\"\<boundary: \>\"", ",", " ", "boundary"}], "]"}], ";", 
        " ", "\[IndentingNewLine]", 
        RowBox[{"tPrint", "[", 
         RowBox[{"\"\<points: \>\"", ",", " ", "points"}], "]"}], ";"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"generate", " ", "Bounded", " ", "Voronoi"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"tPrint", "[", "\"\<Generating Bounded Voronoi .. \>\"", "]"}], 
      ";", " ", "\[IndentingNewLine]", 
      RowBox[{"bvd", " ", "=", " ", 
       RowBox[{"BoundedDiagram", "[", 
        RowBox[{"boundary", ",", " ", "points"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v", ",", " ", "val"}], "}"}], " ", "=", " ", "bvd"}], ";", 
      " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"tPrint", "[", 
       RowBox[{
        RowBox[{"Length", "[", "v", "]"}], ",", " ", "\"\< vertices\>\""}], 
       "]"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"tPrint", "[", 
       RowBox[{
        RowBox[{"Length", "[", "val", "]"}], ",", " ", "\"\< cells\>\""}], 
       "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "list", " ", "of", " ", "cells", " ", "as", " ", "vertex", " ", 
        "numbers"}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"cells", " ", "=", 
       RowBox[{"Last", "/@", " ", "val"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "list", " ", "of", " ", "cells", " ", "edges", " ", "as", " ", 
        "vertex", " ", "pair", " ", "numbers"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"cellEdges", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Partition", "[", 
          RowBox[{"#", ",", " ", "2", ",", " ", "1", ",", " ", "1"}], "]"}], 
         "&"}], "/@", "cells"}]}], ";", " ", "\[IndentingNewLine]", " ", 
      RowBox[{"cellEdges", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Sort", "/@", "#"}], "&"}], ",", " ", "cellEdges"}], 
        "]"}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"e", " ", "=", " ", 
       RowBox[{"Union", "[", 
        RowBox[{"Join", "@@", "cellEdges"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"edgeNumber", ",", " ", "edgeNumbers"}], "}"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"edgeNumber", "[", 
           RowBox[{"{", 
            RowBox[{"i_", ",", " ", "j_"}], "}"}], "]"}], ":=", " ", 
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{"e", ",", " ", 
             RowBox[{"{", 
              RowBox[{"i", ",", "j"}], "}"}]}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", " ", "1"}], "]"}], "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"edgeNumbers", "[", 
           RowBox[{"{", "ijpair__", "}"}], "]"}], ":=", " ", 
          RowBox[{"edgeNumber", "/@", 
           RowBox[{"{", "ijpair", "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
         
         RowBox[{"c", "=", 
          RowBox[{"edgeNumbers", "/@", "cellEdges"}]}], ";"}]}], " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"q", "=", 
       RowBox[{"Tissue", "[", 
        RowBox[{"v", ",", " ", "e", ",", " ", "c"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "q", "]"}], ";"}]}], " ", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TemplateRandom", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Error: expecting TemplateRandom[numPoints, \
convex_bounds_as_list_of_points\>\"", "]"}], ";", " ", "$Failed"}], ")"}]}], 
   ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQA2IQbb/9tvK97S8d4+Y8VAXRV5bXG4Fol6UvbED0t/ZC
ZxB9SiY7AEQ3vJUKA9ExX70zQfSUzJBcEG3BcDEfRM/wSq8G0SWmtS0getXF
2k4QLWz+ajWIPrln9QYQXbnOYg+IPsRqfABE7/gafgREn5kieBJE7/y37wKI
3iB44SqIFojnvQais7y874Dd59sNph8UxD4A0T6zLJ+A6F//Zn4A0RLLJRTu
A+kbT511QHRa5Cw9EL3qkrApiM6dG2gFosvUNCJBdEFwdxSI1uqrLgbRrJxd
YFprpeUnEB12bf9XEC3T84fzAZAWmWTADaJTnpy9+hBI39PIuwaiH33eefTp
wZeOQrbPT4BoAAHP07Y=
  
  "],ExpressionUUID->"b20e47d7-9fc1-4c90-b892-d1e56c0efb9b"]
}, Closed]],

Cell[CellGroupData[{

Cell["TemplateRandomSquareGrid", "Subsubsection",
 CellChangeTimes->{{3.451842804891487*^9, 3.4518428166867943`*^9}, {
  3.451846715967848*^9, 3.451846727281172*^9}, {3.451849475717699*^9, 
  3.451849478859729*^9}},ExpressionUUID->"07613b9c-be34-443a-b552-\
b01ccc2f611b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TemplateRandomSquareGrid", "[", 
    RowBox[{
     RowBox[{"npoints_", "?", "IntegerQ"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"xmin_", ",", " ", "ymin_"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"xmax_", ",", " ", "ymax_"}], "}"}], ",", " ", 
     RowBox[{"limit_:", "0.8"}], ",", " ", 
     RowBox[{"offset_:", "0.5"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "rx", ",", " ", "ry", ",", " ", "i", ",", "j", ",", "  ", "points", ",",
        "point", ",", " ", "itotal", ",", " ", "bvd", ",", " ", 
       RowBox[{"trace", "=", "False"}], ",", " ", "tPrint", ",", "  ", "v", 
       ",", " ", "val", ",", " ", "cells", ",", " ", "e", ",", " ", "c", ",", 
       " ", "cellEdges", ",", " ", "boundary", ",", " ", "q", ",", " ", 
       "ngrids", ",", " ", "\[CapitalDelta]x", ",", " ", "\[CapitalDelta]y", 
       ",", " ", "x1", ",", " ", "x2", ",", " ", "y1", ",", " ", "y2", ",", 
       " ", "limitation", ",", " ", "off"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"AbortIf", "[", 
       RowBox[{
        RowBox[{"xmin", "\[GreaterEqual]", " ", "xmax"}], ",", " ", 
        RowBox[{
         RowBox[{"\"\<Error: TemplateRandomSquareGrid: xmin = \>\"", "<>", 
          RowBox[{"ToString", "[", "xmin", "]"}]}], 
         RowBox[{"\"\< \[GreaterEqual] xmax = \>\"", "<>", 
          RowBox[{"ToString", "[", "xmax", "]"}]}]}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"AbortIf", "[", 
       RowBox[{
        RowBox[{"ymin", "\[GreaterEqual]", " ", "ymax"}], ",", " ", 
        RowBox[{
         RowBox[{"\"\<Error: TemplateRandomSquareGrid: ymin = \>\"", "<>", 
          RowBox[{"ToString", "[", "ymin", "]"}]}], 
         RowBox[{"\"\< \[GreaterEqual] ymax = \>\"", "<>", 
          RowBox[{"ToString", "[", "ymax", "]"}]}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tPrint", "[", "x___", "]"}], ":=", " ", 
       RowBox[{"If", "[", 
        RowBox[{"trace", ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<TemplateRandomSquareGrid: \>\"", ",", " ", "x"}], 
          "]"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"boundary", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"xmin", ",", " ", "ymin"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"xmax", ",", " ", "ymin"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"xmax", ",", " ", "ymax"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"xmin", ",", " ", "ymax"}], "}"}]}], "}"}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"generate", " ", "random", " ", "centers"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"rx", ":=", " ", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{"xmin", ",", " ", "xmax"}], "}"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"ry", ":=", " ", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{"ymin", ",", " ", "ymax"}], "}"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ngrids", " ", "=", " ", 
       RowBox[{"Round", "[", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"1.0", "*", "npoints"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ngrids", "^", "2"}], " ", "<", " ", "npoints"}], ",", " ", 
        RowBox[{"ngrids", " ", "=", " ", 
         RowBox[{"ngrids", " ", "+", " ", "1"}]}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"\[CapitalDelta]x", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"xmax", "-", "xmin"}], ")"}], "*", 
        RowBox[{"1.0", "/", "ngrids"}]}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"\[CapitalDelta]y", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"ymax", "-", "ymin"}], ")"}], "*", 
        RowBox[{"1.0", "/", "ngrids"}]}]}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"limitation", " ", "=", " ", 
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{"Max", "[", 
          RowBox[{"limit", ",", " ", "0.0"}], "]"}], ",", " ", ".8"}], 
        "]"}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"off", " ", "=", " ", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"Min", "[", 
          RowBox[{"offset", ",", " ", ".9"}], "]"}], ",", " ", 
         RowBox[{"-", ".9"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"points", "=", 
       RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", " ", 
        RowBox[{"i", "\[LessEqual]", " ", "ngrids"}], ",", " ", 
        RowBox[{"i", "++"}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"x1", " ", "=", " ", 
          RowBox[{"xmin", " ", "+", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"i", "-", 
              RowBox[{"1", "/", "2"}], " ", "-", 
              RowBox[{"limitation", "/", "2"}]}], ")"}], "*", 
            "\[CapitalDelta]x"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"x2", " ", "=", " ", 
          RowBox[{"xmin", " ", "+", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"i", "-", 
              RowBox[{"1", "/", "2"}], " ", "+", " ", 
              RowBox[{"limitation", "/", "2"}]}], ")"}], "*", 
            "\[CapitalDelta]x"}]}]}], ";", " ", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", "1"}], ",", " ", 
           RowBox[{"j", "\[LessEqual]", " ", "ngrids"}], ",", " ", 
           RowBox[{"j", "++"}], ",", " ", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"y1", " ", "=", " ", 
             RowBox[{"ymin", " ", "+", " ", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"j", "-", 
                 RowBox[{"1", "/", "2"}], " ", "-", 
                 RowBox[{"limitation", "/", "2"}]}], ")"}], "*", 
               "\[CapitalDelta]y"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"y2", " ", "=", " ", 
             RowBox[{"ymin", " ", "+", " ", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"j", "-", 
                 RowBox[{"1", "/", "2"}], " ", "+", " ", 
                 RowBox[{"limitation", "/", "2"}]}], ")"}], "*", 
               "\[CapitalDelta]y"}]}]}], ";", " ", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"Block", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"X1", ",", "X2"}], "}"}], ",", " ", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"EvenQ", "[", "j", "]"}], ",", " ", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"X1", "=", 
                   RowBox[{"x1", "+", 
                    RowBox[{"off", "*", "\[CapitalDelta]x"}]}]}], ";", " ", 
                  "\[IndentingNewLine]", 
                  RowBox[{"X2", "=", 
                   RowBox[{"x2", "+", 
                    RowBox[{"off", "*", "\[CapitalDelta]x"}]}]}], ";"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"X1", "=", "x1"}], ";", "\[IndentingNewLine]", 
                  RowBox[{"X2", "=", "x2"}], ";"}]}], "\[IndentingNewLine]", 
                "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"Block", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"px", ",", " ", "py"}], "}"}], ",", " ", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"px", ",", " ", "py"}], "}"}], " ", "=", " ", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RandomReal", "[", 
                    RowBox[{"{", 
                    RowBox[{"X1", ",", "X2"}], "}"}], "]"}], ",", " ", 
                    RowBox[{"RandomReal", "[", 
                    RowBox[{"{", 
                    RowBox[{"y1", ",", " ", "y2"}], "}"}], "]"}]}], "}"}]}], 
                  ";", " ", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"px", ">", "xmax"}], ",", " ", 
                    RowBox[{"px", " ", "=", " ", 
                    RowBox[{"px", " ", "-", 
                    RowBox[{"(", 
                    RowBox[{"xmax", "-", "xmin"}], ")"}]}]}]}], "]"}], ";", 
                  " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{"point", "=", 
                   RowBox[{"{", 
                    RowBox[{"px", ",", " ", "py"}], "}"}]}], ";"}]}], " ", 
                "\[IndentingNewLine]", "]"}], ";"}]}], " ", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "keep", " ", "all", " ", "points", " ", "on", " ", "odd", " ", 
               "rods"}], ";", " ", 
              RowBox[{
               RowBox[{"keep", " ", "only", " ", "first", " ", "n"}], "-", 
               RowBox[{
               "1", " ", "points", " ", "on", " ", "even", " ", "rows", " ", 
                "because"}]}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"i", "<", "ngrids"}], " ", "\[Or]", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"i", "\[Equal]", "ngrids"}], " ", "\[And]", " ", 
                 RowBox[{"OddQ", "[", "j", "]"}]}], ")"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"points", ",", " ", "point"}], "]"}]}], 
             "\[IndentingNewLine]", "]"}], ";"}]}], " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"$POINTS", "=", "points"}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"tPrint", "[", 
         RowBox[{"\"\<boundary: \>\"", ",", " ", "boundary"}], "]"}], ";", 
        " ", "\[IndentingNewLine]", 
        RowBox[{"tPrint", "[", 
         RowBox[{"\"\<points: \>\"", ",", " ", "points"}], "]"}], ";"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"generate", " ", "Bounded", " ", "Voronoi"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"tPrint", "[", 
       RowBox[{"\"\<points: \>\"", ",", " ", "points"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"tPrint", "[", 
       RowBox[{"\"\<boundary: \>\"", ",", " ", "boundary"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"tPrint", "[", "\"\<Generating Bounded Voronoi .. \>\"", "]"}], 
      ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"failed", ",", " ", "err"}], "}"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"failed", "=", "False"}], ";", " ", "\[IndentingNewLine]", 
         RowBox[{"err", ":=", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{
             "\"\<TemplateRandomSquareGrid: Error evaluating Bounded Voronoi, \
xmin=\>\"", ",", " ", "xmin", ",", " ", "\"\< xmax = \>\"", ",", " ", "xmax", 
              ",", " ", "\"\< ymin = \>\"", ",", " ", "ymin", ",", " ", 
              "\"\< ymax = \>\"", ",", " ", "ymax"}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"failed", "=", " ", "True"}], ";"}], ")"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Try", " ", "to", " ", "catch", " ", "the", " ", 
           RowBox[{"error", ":", " ", 
            RowBox[{"BoundedDiagram", "::", 
             RowBox[{"nobd", ":", " ", 
              RowBox[{"Bounded", " ", "diagram", " ", "failed"}]}]}]}]}], " ",
           "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"bvd", " ", "=", 
          RowBox[{"Check", "[", " ", 
           RowBox[{
            RowBox[{"BoundedDiagram", "[", 
             RowBox[{"boundary", ",", " ", "points"}], "]"}], ",", " ", 
            "err"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"failed", ",", " ", 
           RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";"}]}], " ", 
       "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v", ",", " ", "val"}], "}"}], " ", "=", " ", "bvd"}], ";", 
      " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"tPrint", "[", 
       RowBox[{
        RowBox[{"Length", "[", "v", "]"}], ",", " ", "\"\< vertices\>\""}], 
       "]"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"tPrint", "[", 
       RowBox[{
        RowBox[{"Length", "[", "val", "]"}], ",", " ", "\"\< cells\>\""}], 
       "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "list", " ", "of", " ", "cells", " ", "as", " ", "vertex", " ", 
        "numbers"}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"cells", " ", "=", 
       RowBox[{"Last", "/@", " ", "val"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "list", " ", "of", " ", "cells", " ", "edges", " ", "as", " ", 
        "vertex", " ", "pair", " ", "numbers"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"cellEdges", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Partition", "[", 
          RowBox[{"#", ",", " ", "2", ",", " ", "1", ",", " ", "1"}], "]"}], 
         "&"}], "/@", "cells"}]}], ";", " ", "\[IndentingNewLine]", " ", 
      RowBox[{"cellEdges", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Sort", "/@", "#"}], "&"}], ",", " ", "cellEdges"}], 
        "]"}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"e", " ", "=", " ", 
       RowBox[{"Union", "[", 
        RowBox[{"Join", "@@", "cellEdges"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"edgeNumber", ",", " ", "edgeNumbers"}], "}"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"edgeNumber", "[", 
           RowBox[{"{", 
            RowBox[{"i_", ",", " ", "j_"}], "}"}], "]"}], ":=", " ", 
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{"e", ",", " ", 
             RowBox[{"{", 
              RowBox[{"i", ",", "j"}], "}"}]}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", " ", "1"}], "]"}], "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"edgeNumbers", "[", 
           RowBox[{"{", "ijpair__", "}"}], "]"}], ":=", " ", 
          RowBox[{"edgeNumber", "/@", 
           RowBox[{"{", "ijpair", "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
         
         RowBox[{"c", "=", 
          RowBox[{"edgeNumbers", "/@", "cellEdges"}]}], ";"}]}], " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"q", "=", 
       RowBox[{"Tissue", "[", 
        RowBox[{"v", ",", " ", "e", ",", " ", "c"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "q", "]"}], ";"}]}], " ", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TemplateRandomSquareGrid", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Error: expecting TemplateRandomSquareGrid[numPoints, {xmin, \
xmax}, {ymin, ymax}]\>\"", "]"}], ";", " ", "$Failed"}], ")"}]}], ";"}], 
  " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwd0X0sFHAcBvCbly1G6LQkGyHDVCLCyM5recshdSZKuHEup7B0jMlL14WL
07w1G/NOw5IM52VZO8PcOS/lvZGXVUM7W0jd8/vj2eev57vv9pyPSgyKUaJQ
KG6KQNfueZOl7i1aRNXqBShryLSBHnWbznA/P8kdjhqwAmHWT/1QGC73jYPC
uBA2dKBIEmGZD5MLk+0ycmCzJIMHqde2W6C4r6Udpr1z6IPDqraD8KP8zic4
JtQRw55j0SRs15mchtqRmjMw3sd3gfznzyeucO6tQL8KxzV4cFy+A/Ua9IyW
Fc6tu1vBWEbFJdgspdpB9lu6E0w1M2dATjA/DFoWcp9AVbWXRMsmxz0YOjMg
h5eXBVorCt/YdhOzUr5RoUYJwwxOREgsYYRyqhWMi+Jaw11tJwbp1eyw4Pdb
M0nQj26dCmvsc4jvR1zSoav3biY0zmYVwM7EshJoFPCsHIYbeTfBtX+8Nmh+
JOyAF58WdUFdcdAHeOamcy80FHgRww1dBqBVot047DA9J4XMv10yuCVbXIQ/
xPkrxNzkX9Bp4/4htG40UV7FnhU0NWjc3eoIW0fG/eGjSGEwvOrqdxtSQmgP
YCA9hqgmeRgLVabTiSEGFlI40xoog9ls7hfolZvyFeq+tjE071fsf/0GMaju
bClnaIu2KTIjFh8qVcKEvK4q+KdfVA8tZcxGeEW9thPOLoiIPrx4H97IFm3J
WdcXyh6nRUA3unokdOqZiIYnRdlMOHj4PAFy6ofZMEBdvxhmcS0qYfrkRjUc
LtGqJXctonphzRF1CFqFaYjhWFbpGGRq9k3BU67yWXiw178AWSEqy1D98+m0
AoV3/RhcSJ3m8eGp/UqiaZKKAM4PU4m6cw6jhQob9fhT0GMjZhZWznmuw+1k
+okihebVCVpQKVoU9/vFNi3Ac55o37YogFKvsAr4Ko9TDUMN8zvgf+sZYDU=

  "],ExpressionUUID->"33bbbf33-bed0-4928-967f-c6f375f81ffc"]
}, Closed]],

Cell[CellGroupData[{

Cell["RandomSquareGridCenters", "Subsubsection",
 CellChangeTimes->{{3.4519382834467163`*^9, 
  3.451938286604012*^9}},ExpressionUUID->"d66cee73-3349-40c8-ac39-\
3e1934ae6dbb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RandomSquareGridCenters", "[", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"xmin_", ",", " ", "ymin_"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"xmax_", ",", " ", "ymax_"}], "}"}], ",", " ", "nx_", ",", " ",
       "ny_", ",", " ", 
      RowBox[{"limit_:", "0.4"}], ",", " ", 
      RowBox[{"offset_:", "0.5"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "rx", ",", " ", "ry", ",", " ", "i", ",", "j", ",", "  ", "points", 
        ",", "point", ",", " ", "itotal", ",", " ", "bvd", ",", " ", 
        RowBox[{"trace", "=", "True"}], ",", " ", "tPrint", ",", "  ", "v", 
        ",", " ", "val", ",", " ", "cells", ",", " ", "e", ",", " ", "c", ",",
         " ", "cellEdges", ",", " ", "boundary", ",", " ", "q", ",", " ", 
        "ngrids", ",", "  ", "x1", ",", " ", "x2", ",", " ", "y1", ",", " ", 
        "y2", ",", " ", "limitation", ",", " ", "off", ",", " ", 
        "\[CapitalDelta]x", ",", " ", "\[CapitalDelta]y"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"tPrint", "[", "x___", "]"}], ":=", " ", 
        RowBox[{"If", "[", 
         RowBox[{"trace", ",", " ", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<TemplateRandomSquareGrid: \>\"", ",", " ", "x"}], 
           "]"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"boundary", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"xmin", ",", " ", "ymin"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"xmax", ",", " ", "ymin"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"xmax", ",", " ", "ymax"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"xmin", ",", " ", "ymax"}], "}"}]}], "}"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"generate", " ", "random", " ", "centers"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"rx", ":=", " ", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{"xmin", ",", " ", "xmax"}], "}"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"ry", ":=", " ", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{"ymin", ",", " ", "ymax"}], "}"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"\[CapitalDelta]x", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"xmax", "-", "xmin"}], ")"}], "*", 
         RowBox[{"1.0", "/", " ", "nx"}]}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"\[CapitalDelta]y", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"ymax", "-", "ymin"}], ")"}], "*", 
         RowBox[{"1.0", "/", "ny"}]}]}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"limitation", " ", "=", " ", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{"limit", ",", " ", "0.0"}], "]"}], ",", " ", ".4"}], 
         "]"}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"off", " ", "=", " ", 
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"Min", "[", 
           RowBox[{"offset", ",", " ", ".9"}], "]"}], ",", " ", 
          RowBox[{"-", ".9"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"points", "=", 
        RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", " ", 
         RowBox[{"i", "\[LessEqual]", " ", "nx"}], ",", " ", 
         RowBox[{"i", "++"}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"x1", " ", "=", " ", 
           RowBox[{"xmin", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"i", "-", "1", "+", "limitation"}], ")"}], "*", 
             "\[CapitalDelta]x"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"x2", " ", "=", "  ", 
           RowBox[{"x1", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "limitation"}], ")"}], "*", 
             "\[CapitalDelta]x"}]}]}], ";", " ", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", " ", 
            RowBox[{"j", "\[LessEqual]", " ", "ny"}], ",", " ", 
            RowBox[{"j", "++"}], ",", " ", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"y1", "=", 
              RowBox[{"ymin", " ", "+", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"j", "-", "1", " ", "+", "limitation"}], ")"}], "*", 
                "\[CapitalDelta]y"}]}]}], ";", " ", "\[IndentingNewLine]", 
             RowBox[{"y2", "=", " ", 
              RowBox[{"y1", "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "limitation"}], ")"}], " ", 
                "\[CapitalDelta]y"}]}]}], ";", " ", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"Block", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"X1", ",", "X2"}], "}"}], ",", " ", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"EvenQ", "[", "j", "]"}], ",", " ", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"X1", "=", 
                    RowBox[{"x1", "+", 
                    RowBox[{"off", "*", "\[CapitalDelta]x"}]}]}], ";", " ", 
                   "\[IndentingNewLine]", 
                   RowBox[{"X2", "=", 
                    RowBox[{"x2", "+", 
                    RowBox[{"off", "*", "\[CapitalDelta]x"}]}]}], ";"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"X1", "=", "x1"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"X2", "=", "x2"}], ";"}]}], "\[IndentingNewLine]", 
                 "]"}], ";", " ", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"Block", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"px", ",", " ", "py"}], "}"}], ",", " ", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"px", ",", " ", "py"}], "}"}], " ", "=", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RandomReal", "[", 
                    RowBox[{"{", 
                    RowBox[{"X1", ",", "X2"}], "}"}], "]"}], ",", " ", 
                    RowBox[{"RandomReal", "[", 
                    RowBox[{"{", 
                    RowBox[{"y1", ",", " ", "y2"}], "}"}], "]"}]}], "}"}]}], 
                   ";", " ", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"px", ">", "xmax"}], ",", " ", 
                    RowBox[{"px", " ", "=", " ", 
                    RowBox[{"px", " ", "-", 
                    RowBox[{"(", 
                    RowBox[{"xmax", "-", "xmin"}], ")"}]}]}]}], "]"}], ";", 
                   " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                   RowBox[{"point", "=", 
                    RowBox[{"{", 
                    RowBox[{"px", ",", " ", "py"}], "}"}]}], ";"}]}], " ", 
                 "\[IndentingNewLine]", "]"}], ";"}]}], " ", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"points", ",", " ", "point"}], "]"}], ";"}]}], " ", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "points", "]"}], ";"}]}], "\[IndentingNewLine]",
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwd0V1IU3EABfBL5sNASVmQmOB0JTZmjmzlhjKGoTRnbrqMxZpl6JhjTkmH
uolDFDGxBEfMWT0I4tcKDe0uttIiHyYZblxHVuYMKxcVGswHLWvn/3D4PR04
cNKqTGXVhyiKyooGSugP3E90WKq9v3ESMqPtZ+CFka08uNvdUAAXUwwKaPuZ
XAE1kWI9tOtVRphL+U3QIdNZYKOwrRNO+Nt6IPv890no805OwZbHuV74KjZn
HrojV17DN/ZEH3x28GIZTiUur8CEyvggrJUVfyT7SnqJofprISh3ijbh3sHg
NkwaTeKsR333pYAPa9TO03AiwBZC4wOlGJozMtWwvrz3KuTdsdyCsazbRN64
6DesCM5FYPZ6/5FQ1Hs5NNHW9JkN4wbUGfCt1s+D2hgzH+qrLAK4kyBWk97w
tgF+LQ02QLlSYIbD5zqJMwv5Vigp2mmH6R2GPvjE5BiAnEutg1DDKRqHm/96
HsHMP/ZpmNV8dxYe9ZU9hccu5nlgan8hUZOaPwf5JuESnD5xPAB1f2cZGGbW
1uAPX3eI2NX4C4q/Xd+HgjFuzAb+dEpZMJ12iaBrYakE1lXay+FZifwypFTS
G1ChrCay/Ddr4OEVK1GVcioAgy4FAzuMllVY2NX0Hg49XLXGucPSPkerDe7V
JrshVyfzwOd0+CVkFusY+B+KZqWn
  
  "],ExpressionUUID->"0c3fe9d2-113c-4f78-a138-0581ff311ae7"]
}, Closed]],

Cell[CellGroupData[{

Cell["VoronoiToTissue", "Subsubsection",
 CellChangeTimes->{{3.451853068286262*^9, 
  3.451853070734295*^9}},ExpressionUUID->"afef08c5-5935-4f7c-93e6-\
772e717267c0"],

Cell["\<\
Given a set of points representing \"Centers\" generate the voronoi diagram, \
truncated by the specified boundary polygon.\
\>", "Text",
 CellChangeTimes->{{3.451857291357546*^9, 
  3.451857320362235*^9}},ExpressionUUID->"4162e9d8-17e5-421d-9201-\
17ecc725882c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"VoronoiToTissue", "[", 
    RowBox[{"points_", ",", " ", "boundary_", ",", " ", 
     RowBox[{"trace_:", "False"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "bvd", ",", " ", "v", ",", " ", "val", ",", " ", "tPrint", ",", " ", 
       "cells", ",", " ", "cellEdges", ",", " ", "e", ",", " ", "c", ",", " ",
        "q"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"tPrint", "[", "x___", "]"}], ":=", " ", 
       RowBox[{"If", "[", 
        RowBox[{"trace", ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<VoronoiToTissue: \>\"", ",", " ", "x"}], "]"}]}], 
        "]"}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"bvd", " ", "=", " ", 
       RowBox[{"BoundedDiagram", "[", 
        RowBox[{"boundary", ",", " ", "points"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v", ",", " ", "val"}], "}"}], " ", "=", " ", "bvd"}], ";", 
      " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"tPrint", "[", 
       RowBox[{
        RowBox[{"Length", "[", "v", "]"}], ",", " ", "\"\< vertices\>\""}], 
       "]"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"tPrint", "[", 
       RowBox[{
        RowBox[{"Length", "[", "val", "]"}], ",", " ", "\"\< cells\>\""}], 
       "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "list", " ", "of", " ", "cells", " ", "as", " ", "vertex", " ", 
        "numbers"}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"cells", " ", "=", 
       RowBox[{"Last", "/@", " ", "val"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "list", " ", "of", " ", "cells", " ", "edges", " ", "as", " ", 
        "vertex", " ", "pair", " ", "numbers"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"cellEdges", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Partition", "[", 
          RowBox[{"#", ",", " ", "2", ",", " ", "1", ",", " ", "1"}], "]"}], 
         "&"}], "/@", "cells"}]}], ";", " ", "\[IndentingNewLine]", " ", 
      RowBox[{"cellEdges", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Sort", "/@", "#"}], "&"}], ",", " ", "cellEdges"}], 
        "]"}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"e", " ", "=", " ", 
       RowBox[{"Union", "[", 
        RowBox[{"Join", "@@", "cellEdges"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"edgeNumber", ",", " ", "edgeNumbers"}], "}"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"edgeNumber", "[", 
           RowBox[{"{", 
            RowBox[{"i_", ",", " ", "j_"}], "}"}], "]"}], ":=", " ", 
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{"e", ",", " ", 
             RowBox[{"{", 
              RowBox[{"i", ",", "j"}], "}"}]}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", " ", "1"}], "]"}], "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"edgeNumbers", "[", 
           RowBox[{"{", "ijpair__", "}"}], "]"}], ":=", " ", 
          RowBox[{"edgeNumber", "/@", 
           RowBox[{"{", "ijpair", "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
         
         RowBox[{"c", "=", 
          RowBox[{"edgeNumbers", "/@", "cellEdges"}]}], ";"}]}], " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"q", "=", 
       RowBox[{"Tissue", "[", 
        RowBox[{"v", ",", " ", "e", ",", " ", "c"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "q", "]"}], ";"}]}], " ", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", " ", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"VoronoiToTissue", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Error: Expecting VoronoiToTissue[points, boundary]\>\"", "]"}], 
      ";", " ", "$Failed"}], ")"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.451853081920923*^9, 3.451853191114225*^9}, {
  3.451857239182178*^9, 3.451857280106535*^9}, {3.455316934761458*^9, 
  3.455316936930142*^9}},ExpressionUUID->"53cf5681-dd33-4a7d-8f0f-\
c8b4d2d8a4f7"]
}, Closed]],

Cell[CellGroupData[{

Cell["TemplateRandomCircularGrid", "Subsubsection",
 CellChangeTimes->{{3.451850324058774*^9, 
  3.451850328206889*^9}},ExpressionUUID->"fbf21c32-39be-40ba-b8cd-\
48a816fec2b2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TemplateRandomCircularGrid", "[", 
     RowBox[{
      RowBox[{"npoints_", "?", "IntegerQ"}], ",", " ", 
      RowBox[{"radius_", "?", "NumericQ"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n", ",", " ", 
        RowBox[{"dbg", "=", "False"}], ",", " ", "dPrint", ",", " ", "layers",
         ",", "layer", ",", "  ", "point", ",", " ", "points", ",", " ", 
        "cellsInLayer", ",", " ", "\[Delta]\[Theta]", ",", " ", "\[Theta]0", 
        ",", " ", "\[Theta]centers", ",", " ", "thetas", ",", " ", "offset", 
        ",", " ", "r", ",", " ", "\[Delta]r", ",", " ", "rvals", ",", " ", 
        "pointsInLayer", ",", " ", "q"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"dPrint", "[", "x___", "]"}], ":=", " ", 
        RowBox[{"If", "[", 
         RowBox[{"dbg", ",", " ", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<TemplateRandomCircularGrid: \>\"", ",", " ", "x"}], 
           "]"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "find", " ", "smallest", " ", "square", " ", "integer", " ", "that", 
         " ", "is", " ", "larger", " ", "or", " ", "equal", " ", "to", " ", 
         "npoints"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"npoints", "<", "1"}], ",", " ", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<Error: TemplateRandomCircularGrid: Must have at least 1 \
point.\>\"", "]"}], ";", " ", 
          RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "determine", " ", "number", " ", "of", " ", "layers", " ", "and", " ",
          "layer", " ", "thickness"}], " ", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"layers", "=", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"npoints", "*", "1.0"}], "]"}], "//", "Round"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"layers", "^", "2"}], "<", "npoints"}], ",", " ", 
         RowBox[{"layers", "++"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"n", "=", 
        RowBox[{"layers", "^", "2"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Delta]r", "=", 
        RowBox[{"radius", "/", "layers"}]}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<n: \>\"", ",", " ", "n"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<layers: \>\"", ",", " ", "layers"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<\[Delta]r: \>\"", ",", " ", "\[Delta]r"}], "]"}], ";", 
       " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "determine", " ", "centers", " ", "in", " ", "each", " ", "layer"}], 
        " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"points", "=", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], "}"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"cellsInLayer", "=", "1"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"offset", " ", "=", " ", "0.1"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Theta]0", "=", "0"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"layer", "=", "2"}], ",", " ", 
         RowBox[{"layer", "\[LessEqual]", " ", "layers"}], ",", " ", 
         RowBox[{"layer", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"cellsInLayer", "=", 
           RowBox[{"cellsInLayer", "+", "2"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"\[Delta]\[Theta]", "=", 
           RowBox[{"360.0", "/", "cellsInLayer"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"\[Theta]0", "=", 
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", " ", "180.0"}], "}"}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{
           "\"\<layer: \>\"", ",", " ", "layer", ",", " ", "\"\< has \>\"", 
            ",", " ", "cellsInLayer", ",", " ", "\"\< cells with \>\"", ",", 
            " ", "\[Delta]\[Theta]", ",", " ", "\"\< deg. spacing.\>\""}], 
           "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"\[Theta]centers", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"\[Theta]0", "+", 
                 RowBox[{"\[Delta]\[Theta]", "*", "#"}]}], ")"}], ",", " ", 
               "360.0"}], "]"}], "&"}], "/@", 
            RowBox[{"Range", "[", "cellsInLayer", "]"}]}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"thetas", " ", "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"RandomReal", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"#", "-", 
                   RowBox[{"offset", "*", "\[Delta]\[Theta]"}]}], ",", " ", 
                  RowBox[{"#", "+", 
                   RowBox[{"offset", "*", "\[Delta]\[Theta]"}]}]}], "}"}], 
                "]"}], ",", " ", "360.0"}], "]"}], "&"}], "/@", 
            "\[Theta]centers"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"thetas", " ", "=", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[Pi]", "/", "180."}], ")"}], "*", "thetas"}]}], ";", 
          " ", "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<thetas: \>\"", ",", " ", "thetas"}], "]"}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"r", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"layer", "-", "0.5"}], ")"}], "*", "\[Delta]r"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"rvals", " ", "=", " ", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"RandomReal", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"r", "-", 
                 RowBox[{"offset", "*", "\[Delta]r"}]}], ",", " ", 
                RowBox[{"r", "+", 
                 RowBox[{"offset", "*", "\[Delta]r"}]}]}], "}"}], "]"}], ",", 
             " ", 
             RowBox[{"{", "cellsInLayer", "}"}]}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<rvals: \>\"", ",", " ", "rvals"}], "]"}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"pointsInLayer", " ", "=", " ", 
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{"rvals", ",", " ", "thetas"}], "}"}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"pointsInLayer", " ", "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"(", " ", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ")"}], "*", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Cos", "[", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", " ", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], ")"}], 
             "&"}], "/@", "pointsInLayer"}]}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<pointsInLayer: \>\"", ",", " ", "pointsInLayer"}], 
           "]"}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"points", " ", "=", " ", 
           RowBox[{"Join", "[", 
            RowBox[{"points", ",", " ", "pointsInLayer"}], "]"}]}], ";"}]}], 
        " ", "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "using", " ", "the", " ", "convex", " ", "hull", " ", "here", " ", 
         "makes", " ", "the", " ", "outmost", " ", "layer", " ", "only", " ", 
         "half", " ", "the", " ", "required", " ", "thickness"}], " ", "*)"}],
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"ListPlot", "[", 
         RowBox[{"points", ",", " ", 
          RowBox[{"AspectRatio", "\[Rule]", " ", "1"}]}], "]"}], "]"}], ";", 
       " ", "\[IndentingNewLine]", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", "ch", "}"}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ch", "=", 
           RowBox[{"ConvexHull", "[", "points", "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"ch", " ", "=", " ", 
           RowBox[{"points", "[", 
            RowBox[{"[", "ch", "]"}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"q", "=", " ", 
           RowBox[{"VoronoiToTissue", "[", 
            RowBox[{"points", ",", " ", "ch", ",", " ", "dbg"}], "]"}]}], 
          ";"}]}], " ", "\[IndentingNewLine]", "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "now", " ", "move", " ", "all", " ", "the", " ", "edges", " ", 
         "vertices", " ", "out", " ", "to", " ", "the", " ", "requisite", " ",
          "boundary"}], " ", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "v", ",", "c", ",", "e", ",", " ", "vb", ",", " ", "vbxy", ",", " ",
            "pushout", ",", " ", "replacements"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"v", "=", " ", 
           RowBox[{"TissueVertices", "[", "q", "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"e", "=", 
           RowBox[{"TissueEdges", "[", "q", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"c", "=", 
           RowBox[{"TissueCells", "[", "q", "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"vb", " ", "=", " ", 
           RowBox[{"VerticesOnBoundary", "[", "q", "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"vbxy", "=", " ", 
           RowBox[{"v", "[", 
            RowBox[{"[", "vb", "]"}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"pushout", "[", 
            RowBox[{"{", 
             RowBox[{"x_", ",", "y_"}], "}"}], "]"}], ":=", " ", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"theta", ",", " ", "new"}], "}"}], ",", " ", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"theta", " ", "=", " ", 
               RowBox[{"ArcTan", "[", 
                RowBox[{"x", ",", "y"}], "]"}]}], ";", "\[IndentingNewLine]", 
              
              RowBox[{"new", "=", 
               RowBox[{"radius", "*", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Cos", "[", "theta", "]"}], ",", " ", 
                  RowBox[{"Sin", "[", "theta", "]"}]}], "}"}]}]}], ";", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"Return", "[", "new", "]"}], ";"}]}], " ", 
            "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"vbxy", " ", "=", " ", 
           RowBox[{"pushout", "/@", "vbxy"}]}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"replacements", "=", 
           RowBox[{"MapThread", "[", 
            RowBox[{"Rule", ",", " ", 
             RowBox[{"{", 
              RowBox[{"vb", ",", " ", "vbxy"}], "}"}]}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"v", "=", 
           RowBox[{"ReplacePart", "[", 
            RowBox[{"v", ",", " ", "replacements"}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"q", "=", 
           RowBox[{"Tissue", "[", 
            RowBox[{"v", ",", "e", ",", "c"}], "]"}]}], ";"}]}], " ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", " ", 
       "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "q", "]"}], ";"}]}], " ", "\[IndentingNewLine]",
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "]"}]}], ";"}], " ", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TemplateRandomCircularGrid", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Error: Expecting TemplateRandomCircularGrid[numPoints, \
radius]\>\"", "]"}], ";", " ", "$Failed"}], ")"}]}], ";"}], 
  " "}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4518503350443373`*^9, 3.451850375886148*^9}, {
   3.451850489369494*^9, 3.451850518986652*^9}, {3.4518505517787657`*^9, 
   3.451850677410577*^9}, {3.451850729826096*^9, 3.451850730742296*^9}, {
   3.451850828071938*^9, 3.451850892480487*^9}, {3.451850924108432*^9, 
   3.451850959058948*^9}, {3.451850992793013*^9, 3.451851072873652*^9}, {
   3.4518511658929243`*^9, 3.4518511922380247`*^9}, {3.451851251082005*^9, 
   3.451851432928193*^9}, {3.451851475119019*^9, 3.451851874567832*^9}, {
   3.451851910268614*^9, 3.4518519188047533`*^9}, {3.451851956138322*^9, 
   3.451851991420319*^9}, {3.451852038521409*^9, 3.4518525410544357`*^9}, {
   3.451852586275548*^9, 3.45185258663558*^9}, {3.451852633542368*^9, 
   3.451852687626931*^9}, {3.451852742026222*^9, 3.451852754041553*^9}, {
   3.451852805925824*^9, 3.4518529735092297`*^9}, {3.451853008485999*^9, 
   3.45185301634755*^9}, {3.451853399566296*^9, 3.4518534003543997`*^9}, {
   3.451853443236042*^9, 3.451853446303896*^9}, {3.4518536281720047`*^9, 
   3.451853815747114*^9}, {3.451853853249537*^9, 3.451853860635961*^9}, {
   3.451854001571158*^9, 3.4518541128417463`*^9}, {3.451854143128758*^9, 
   3.4518541438542013`*^9}, {3.45185427283745*^9, 3.451854273551922*^9}, {
   3.451854356424563*^9, 3.4518543698805428`*^9}, {3.451854417557109*^9, 
   3.451854418204878*^9}, {3.451854622200246*^9, 3.451854631530766*^9}, {
   3.451854916407578*^9, 3.451854957508012*^9}, {3.45185498824205*^9, 
   3.4518551638529787`*^9}, {3.4518567787783623`*^9, 3.4518570793775873`*^9}, 
   3.4518574964462547`*^9},ExpressionUUID->"6b5f7fbe-1b67-47c8-8051-\
37f265f69e18"]
}, Closed]],

Cell[CellGroupData[{

Cell["TemplateRandomSemiCircularGrid", "Subsubsection",
 CellChangeTimes->{{3.451857632812793*^9, 
  3.451857637247555*^9}},ExpressionUUID->"f5ced8d1-a32b-4e31-98dc-\
a12519abc95c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TemplateRandomSemicircularGrid", "[", 
     RowBox[{
      RowBox[{"nrcpoints_", "?", "IntegerQ"}], ",", " ", 
      RowBox[{"radius_", "?", "NumericQ"}], ",", " ", 
      RowBox[{"nbot_", "?", "IntegerQ"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n", ",", " ", 
        RowBox[{"dbg", "=", "False"}], ",", " ", "dPrint", ",", " ", "layers",
         ",", "layer", ",", "  ", "point", ",", " ", "points", ",", " ", 
        "cellsInLayer", ",", " ", "\[Delta]\[Theta]", ",", " ", "\[Theta]0", 
        ",", " ", "\[Theta]centers", ",", " ", "thetas", ",", " ", "offset", 
        ",", " ", "r", ",", " ", "\[Delta]r", ",", " ", "rvals", ",", " ", 
        "pointsInLayer", ",", " ", "q", ",", " ", "npoints", ",", " ", 
        "toplayer", ",", " ", "bottom", ",", " ", "nbottom"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"dPrint", "[", "x___", "]"}], ":=", " ", 
        RowBox[{"If", "[", 
         RowBox[{"dbg", ",", " ", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<TemplateRandomCircularGrid: \>\"", ",", " ", "x"}], 
           "]"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "find", " ", "smallest", " ", "square", " ", "integer", " ", "that", 
         " ", "is", " ", "larger", " ", "or", " ", "equal", " ", "to", " ", 
         "npoints"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"npoints", " ", "=", "nrcpoints"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"npoints", "<", "1"}], ",", " ", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<Error: TemplateRandomCircularGrid: Must have at least 1 \
point.\>\"", "]"}], ";", " ", 
          RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "determine", " ", "number", " ", "of", " ", "layers", " ", "and", " ",
          "layer", " ", "thickness"}], " ", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"layers", "=", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"npoints", "*", "1.0"}], "]"}], "//", "Round"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"layers", "^", "2"}], "<", "npoints"}], ",", " ", 
         RowBox[{"layers", "++"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"n", "=", 
        RowBox[{"layers", "^", "2"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Delta]r", "=", 
        RowBox[{"radius", "/", "layers"}]}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<n: \>\"", ",", " ", "n"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<layers: \>\"", ",", " ", "layers"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<\[Delta]r: \>\"", ",", " ", "\[Delta]r"}], "]"}], ";", 
       " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "determine", " ", "centers", " ", "in", " ", "each", " ", "layer"}], 
        " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"points", "=", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], "}"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"cellsInLayer", "=", "1"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"offset", " ", "=", " ", "0.1"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Theta]0", "=", "0"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"layer", "=", "2"}], ",", " ", 
         RowBox[{"layer", "\[LessEqual]", " ", "layers"}], ",", " ", 
         RowBox[{"layer", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"cellsInLayer", "=", 
           RowBox[{"cellsInLayer", "+", "2"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"\[Delta]\[Theta]", "=", 
           RowBox[{"180.0", "/", "cellsInLayer"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"\[Theta]0", "=", 
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", " ", "180.0"}], "}"}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{
           "\"\<layer: \>\"", ",", " ", "layer", ",", " ", "\"\< has \>\"", 
            ",", " ", "cellsInLayer", ",", " ", "\"\< cells with \>\"", ",", 
            " ", "\[Delta]\[Theta]", ",", " ", "\"\< deg. spacing.\>\""}], 
           "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"\[Theta]centers", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"\[Theta]0", "+", 
                 RowBox[{"\[Delta]\[Theta]", "*", "#"}]}], ")"}], ",", " ", 
               "180.0"}], "]"}], "&"}], "/@", 
            RowBox[{"Range", "[", "cellsInLayer", "]"}]}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"thetas", " ", "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"RandomReal", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"#", "-", 
                   RowBox[{"offset", "*", "\[Delta]\[Theta]"}]}], ",", " ", 
                  RowBox[{"#", "+", 
                   RowBox[{"offset", "*", "\[Delta]\[Theta]"}]}]}], "}"}], 
                "]"}], ",", " ", "360.0"}], "]"}], "&"}], "/@", 
            "\[Theta]centers"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"thetas", " ", "=", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[Pi]", "/", "180."}], ")"}], "*", "thetas"}]}], ";", 
          " ", "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<thetas: \>\"", ",", " ", "thetas"}], "]"}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"r", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"layer", "-", "0.5"}], ")"}], "*", "\[Delta]r"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"layer", "\[Equal]", "layers"}], ",", " ", 
            RowBox[{"r", " ", "=", " ", 
             RowBox[{"r", "+", 
              RowBox[{"\[Delta]r", "/", "2"}]}]}]}], "]"}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"rvals", " ", "=", " ", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"RandomReal", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"r", "-", 
                 RowBox[{"offset", "*", "\[Delta]r"}]}], ",", " ", 
                RowBox[{"r", "+", 
                 RowBox[{"offset", "*", "\[Delta]r"}]}]}], "}"}], "]"}], ",", 
             " ", 
             RowBox[{"{", "cellsInLayer", "}"}]}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<rvals: \>\"", ",", " ", "rvals"}], "]"}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"pointsInLayer", " ", "=", " ", 
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{"rvals", ",", " ", "thetas"}], "}"}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"pointsInLayer", " ", "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"(", " ", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ")"}], "*", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Cos", "[", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", " ", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], ")"}], 
             "&"}], "/@", "pointsInLayer"}]}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<pointsInLayer: \>\"", ",", " ", "pointsInLayer"}], 
           "]"}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"points", " ", "=", " ", 
           RowBox[{"Join", "[", 
            RowBox[{"points", ",", " ", "pointsInLayer"}], "]"}]}], ";"}]}], 
        " ", "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "using", " ", "the", " ", "convex", " ", "hull", " ", "here", " ", 
         "makes", " ", "the", " ", "outmost", " ", "layer", " ", "only", " ", 
         "half", " ", "the", " ", "required", " ", "thickness"}], " ", "*)"}],
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"nbottom", "=", "nbot"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"nbottom", "<", "1"}], ",", " ", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<Error: TemplateRandomSemicircularGrid must have at least 1 \
bottom row. Input value reset to 1. \>\"", "]"}], ";", " ", 
          RowBox[{"nbottom", "=", "1"}]}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"bottom", "=", " ", 
        RowBox[{"RandomSquareGridCenters", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "radius"}], ",", " ", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{"nbottom", "+", ".5"}], ")"}]}], "*", "\[Delta]r", "*", 
             RowBox[{"Pi", "/", "2"}]}]}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"radius", ",", " ", 
            RowBox[{
             RowBox[{"-", "0.5"}], "*", "\[Delta]r"}]}], "}"}], ",", " ", 
          RowBox[{"2", "*", 
           RowBox[{"(", 
            RowBox[{"layers", "-", "1"}], ")"}]}], ",", " ", "nbottom"}], 
         "]"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"Global`$BOTTOM", "=", "bottom"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"points", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{"points", ",", " ", "bottom"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"ListPlot", "[", 
         RowBox[{"points", ",", " ", 
          RowBox[{"AspectRatio", "\[Rule]", " ", "1"}]}], "]"}], "]"}], ";", 
       " ", "\[IndentingNewLine]", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", "ch", "}"}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ch", "=", 
           RowBox[{"ConvexHull", "[", "points", "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"ch", " ", "=", " ", 
           RowBox[{"points", "[", 
            RowBox[{"[", "ch", "]"}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"q", "=", " ", 
           RowBox[{"VoronoiToTissue", "[", 
            RowBox[{"points", ",", " ", "ch", ",", " ", "dbg"}], "]"}]}], 
          ";"}]}], " ", "\[IndentingNewLine]", "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<post-voronoi tissue: \>\"", ",", " ", 
         RowBox[{"ShowTissue", "[", 
          RowBox[{"q", ",", " ", 
           RowBox[{"ImageSize", "\[Rule]", " ", "200"}]}], "]"}]}], "]"}], 
       ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "now", " ", "move", " ", "all", " ", "the", " ", "edges", " ", 
         "vertices", "  ", "in", " ", "the", " ", "top", " ", "layer", " ", 
         "out", " ", "to", " ", "the", " ", "requisite", " ", "boundary"}], 
        " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "v", ",", "c", ",", "e", ",", " ", "vb", ",", " ", "vbxy", ",", " ",
            "pushout", ",", " ", "replacements", ",", " ", "toplayerv"}], 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"v", "=", " ", 
           RowBox[{"TissueVertices", "[", "q", "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"e", "=", 
           RowBox[{"TissueEdges", "[", "q", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"c", "=", 
           RowBox[{"TissueCells", "[", "q", "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"all", " ", "vertices", " ", "on", " ", "boundary"}], " ", 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"vb", " ", "=", " ", 
           RowBox[{"VerticesOnBoundary", "[", "q", "]"}]}], ";", "  ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"got", " ", "coordinates"}], " ", "*)"}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<vb:\>\"", ",", " ", "vb"}], "]"}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"vbxy", "=", " ", 
           RowBox[{"v", "[", 
            RowBox[{"[", "vb", "]"}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"modify", " ", "the", " ", "coordinates"}], " ", "*)"}], 
          " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"pushout", "[", 
            RowBox[{"{", 
             RowBox[{"x_", ",", "y_"}], "}"}], "]"}], ":=", " ", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "theta", ",", " ", "new", ",", " ", "oldr", ",", " ", "newr"}], 
              "}"}], ",", " ", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"x", "\[Equal]", "y", "\[Equal]", "0"}], ",", " ", 
                RowBox[{"Return", "[", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y"}], "}"}], "]"}]}], "]"}], ";", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"y", ">", "0"}], ",", " ", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"oldr", " ", "=", " ", 
                  RowBox[{"Norm", "[", 
                   RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}]}], ";", " ", 
                 "\[IndentingNewLine]", 
                 RowBox[{"newr", "=", 
                  RowBox[{"oldr", " ", "+", " ", 
                   RowBox[{"\[Delta]r", "/", "2"}]}]}], ";", " ", 
                 "\[IndentingNewLine]", 
                 RowBox[{"theta", " ", "=", " ", 
                  RowBox[{"ArcTan", "[", 
                   RowBox[{"x", ",", "y"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"new", "=", 
                  RowBox[{"newr", "*", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "theta", "]"}], ",", " ", 
                    RowBox[{"Sin", "[", "theta", "]"}]}], "}"}]}]}], ";"}], 
                ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"new", "=", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}]}], ";", " ", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"y", "<", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"nbottom", "-", ".5"}], ")"}]}], "*", "\[Delta]r",
                     "*", 
                    RowBox[{"Pi", "/", "2"}]}]}], ",", " ", 
                   RowBox[{"new", " ", "=", " ", 
                    RowBox[{"new", " ", "+", " ", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{
                    RowBox[{"-", "\[Delta]r"}], "/", "2"}]}], "}"}]}]}]}], 
                  "]"}], ";", " ", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"x", ">", 
                    RowBox[{"radius", " ", "-", "\[Delta]r"}]}], ",", " ", 
                   RowBox[{"new", " ", "=", " ", 
                    RowBox[{"new", " ", "+", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Delta]r", "/", "2"}], ",", " ", "0"}], 
                    "}"}]}]}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"x", "<", 
                    RowBox[{
                    RowBox[{"-", "radius"}], "+", "\[Delta]r"}]}], ",", " ", 
                   RowBox[{"new", " ", "=", " ", 
                    RowBox[{"new", " ", "+", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "\[Delta]r"}], "/", "2"}], ",", " ", "0"}], 
                    "}"}]}]}]}], "]"}], ";"}]}], " ", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", "]"}], ";", "  ", "\[IndentingNewLine]", 
              RowBox[{"Return", "[", "new", "]"}], ";"}]}], " ", 
            "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", " ", 
          RowBox[{"vbxy", " ", "=", " ", 
           RowBox[{"pushout", "/@", "vbxy"}]}], ";", "  ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"replacements", "=", 
           RowBox[{"MapThread", "[", 
            RowBox[{"Rule", ",", " ", 
             RowBox[{"{", 
              RowBox[{"vb", ",", " ", "vbxy"}], "}"}]}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"v", "=", 
           RowBox[{"ReplacePart", "[", 
            RowBox[{"v", ",", " ", "replacements"}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"q", "=", 
           RowBox[{"Tissue", "[", 
            RowBox[{"v", ",", "e", ",", "c"}], "]"}]}], ";"}]}], " ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", " ", 
       "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "q", "]"}], ";"}]}], " ", "\[IndentingNewLine]",
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "]"}]}], ";"}], " ", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TemplateRandomCircularGrid", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Error: Expecting TemplateRandomCircularGrid[numPoints, radius, \
bottom]\>\"", "]"}], ";", " ", "$Failed"}], ")"}]}], ";"}], 
  " "}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4518503350443373`*^9, 3.451850375886148*^9}, {
   3.451850489369494*^9, 3.451850518986652*^9}, {3.4518505517787657`*^9, 
   3.451850677410577*^9}, {3.451850729826096*^9, 3.451850730742296*^9}, {
   3.451850828071938*^9, 3.451850892480487*^9}, {3.451850924108432*^9, 
   3.451850959058948*^9}, {3.451850992793013*^9, 3.451851072873652*^9}, {
   3.4518511658929243`*^9, 3.4518511922380247`*^9}, {3.451851251082005*^9, 
   3.451851432928193*^9}, {3.451851475119019*^9, 3.451851874567832*^9}, {
   3.451851910268614*^9, 3.4518519188047533`*^9}, {3.451851956138322*^9, 
   3.451851991420319*^9}, {3.451852038521409*^9, 3.4518525410544357`*^9}, {
   3.451852586275548*^9, 3.45185258663558*^9}, {3.451852633542368*^9, 
   3.451852687626931*^9}, {3.451852742026222*^9, 3.451852754041553*^9}, {
   3.451852805925824*^9, 3.4518529735092297`*^9}, {3.451853008485999*^9, 
   3.45185301634755*^9}, {3.451853399566296*^9, 3.4518534003543997`*^9}, {
   3.451853443236042*^9, 3.451853446303896*^9}, {3.4518536281720047`*^9, 
   3.451853815747114*^9}, {3.451853853249537*^9, 3.451853860635961*^9}, {
   3.451854001571158*^9, 3.4518541128417463`*^9}, {3.451854143128758*^9, 
   3.4518541438542013`*^9}, {3.45185427283745*^9, 3.451854273551922*^9}, {
   3.451854356424563*^9, 3.4518543698805428`*^9}, {3.451854417557109*^9, 
   3.451854418204878*^9}, {3.451854622200246*^9, 3.451854631530766*^9}, {
   3.451854916407578*^9, 3.451854957508012*^9}, {3.45185498824205*^9, 
   3.4518551638529787`*^9}, {3.4518567787783623`*^9, 3.4518570793775873`*^9}, 
   3.4518574964462547`*^9, {3.451935705796012*^9, 3.45193570802481*^9}, {
   3.4519357481917963`*^9, 3.451935761854971*^9}, {3.451935798645678*^9, 
   3.451935816600857*^9}, {3.451935937900139*^9, 3.4519359385713043`*^9}, {
   3.451935978572722*^9, 3.451936061779284*^9}, {3.451936137729686*^9, 
   3.451936151651106*^9}, {3.451936227849041*^9, 3.45193625152838*^9}, {
   3.451936319841717*^9, 3.4519363542197104`*^9}, {3.451936467949526*^9, 
   3.4519364806818123`*^9}, {3.451936705598345*^9, 3.451936755310925*^9}, {
   3.451936806495735*^9, 3.451936831710478*^9}, {3.451936895995173*^9, 
   3.451936935290906*^9}, 3.451937003256613*^9, {3.451937034249815*^9, 
   3.4519370445135508`*^9}, {3.451937082915366*^9, 3.451937293811372*^9}, {
   3.451937421066637*^9, 3.451937482195867*^9}, {3.451937630597663*^9, 
   3.451937646597372*^9}, {3.4519377162743273`*^9, 3.4519377170606003`*^9}, {
   3.451937924269293*^9, 3.451937925088978*^9}, {3.451938994096836*^9, 
   3.451939088603074*^9}, {3.451939141650292*^9, 3.451939179229653*^9}, {
   3.45193921207509*^9, 3.451939213850861*^9}, {3.451939251680337*^9, 
   3.451939251932919*^9}, {3.451939483180107*^9, 3.4519394866285667`*^9}, {
   3.451939685952847*^9, 3.4519396872179728`*^9}, {3.451939732560873*^9, 
   3.451939798381035*^9}, {3.45193987545466*^9, 3.451939899623415*^9}, {
   3.451939977075699*^9, 3.451940009602037*^9}, {3.4519400436007767`*^9, 
   3.4519401286764812`*^9}, {3.451940180532563*^9, 3.451940232014563*^9}, {
   3.451940272182742*^9, 3.4519402904426603`*^9}, {3.451940329625743*^9, 
   3.451940420892071*^9}, {3.451940503851256*^9, 3.451940528101903*^9}, {
   3.4519405877931547`*^9, 3.4519405879467793`*^9}, {3.4592726832267857`*^9, 
   3.459272765810944*^9}, {3.459272848055875*^9, 3.4592728503823566`*^9}, {
   3.459272898207945*^9, 
   3.459272907281439*^9}},ExpressionUUID->"198ed561-7c16-4ac0-b40d-\
b57a39195792"]
}, Closed]],

Cell[CellGroupData[{

Cell["TemplatePolygon", "Subsubsection",
 CellChangeTimes->{{3.4895282879600687`*^9, 
  3.489528289943963*^9}},ExpressionUUID->"fc8605b4-94e2-4d75-b391-\
619e3d49f324"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TemplatePolygon", "[", 
    RowBox[{"sides_Integer", ",", " ", 
     RowBox[{"StartAngle_:", "0"}], ",", " ", 
     RowBox[{"aspect_:", "1"}], ",", " ", 
     RowBox[{"rnd_:", "-", "1"}], ",", " ", 
     RowBox[{"rot_:", "0"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v", ",", " ", "nv", ",", " ", "e", ",", " ", "c"}], "}"}], ",",
      " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"v", "=", 
       RowBox[{"regularPolygon", "[", 
        RowBox[{
        "sides", ",", " ", "StartAngle", ",", " ", "aspect", ",", " ", "rnd", 
         ",", " ", "rot"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"nv", "=", 
       RowBox[{"Length", "[", "v", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"e", "=", 
       RowBox[{"Partition", "[", 
        RowBox[{
         RowBox[{"Range", "[", "nv", "]"}], ",", " ", "2", ",", "1", ",", 
         "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{"Range", "[", "nv", "]"}], "}"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"Tissue", "[", 
        RowBox[{"v", ",", "e", ",", "c"}], "]"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4895282910382643`*^9, 3.489528421984017*^9}, {
   3.4895284625733767`*^9, 3.489528522675475*^9}, {3.4895285995016127`*^9, 
   3.489528601876871*^9}, 
   3.705710952402235*^9},ExpressionUUID->"a4734c3c-2567-4088-ae6b-\
cde7cf41025a"]
}, Closed]],

Cell[CellGroupData[{

Cell["TemplateRandomOvalish", "Subsubsection",
 CellChangeTimes->{{3.51221611113198*^9, 
  3.5122161181322823`*^9}},ExpressionUUID->"0027d5a5-dd2d-4ed4-b441-\
15dd7a003642"],

Cell["\<\
n = number of cells (randomly placed; 
{a, b} = effective semi axes of circumscribing ellipse\
\>", "Text",
 CellChangeTimes->{{3.512216153149434*^9, 
  3.512216177877961*^9}},ExpressionUUID->"5f5a823d-dc77-4876-8c7f-\
5510e118b7a7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TemplateRandomOvalish", "[", 
   RowBox[{"n_", ",", " ", 
    RowBox[{"{", 
     RowBox[{"a_", ",", " ", "b_"}], "}"}], ",", " ", 
    RowBox[{"dbg_:", "False"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "rx", ",", "ry", ",", "point", ",", "points", ",", "i", ",", "OK", ",", 
      " ", "ch", ",", " ", "q", ",", " ", "dPrint"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"dPrint", "[", "x___", "]"}], ":=", " ", 
      RowBox[{"If", "[", 
       RowBox[{"dbg", ",", " ", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<TemplateRandomOvalish: \>\"", ",", " ", "x"}], "]"}]}], 
       "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"rx", ":=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "a"}], ",", " ", "a"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ry", ":=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "b"}], ",", " ", "b"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"OK", "[", 
       RowBox[{"{", 
        RowBox[{"x_", ",", "y_"}], "}"}], "]"}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x", "/", "a"}], ")"}], "^", "2"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"y", "/", "b"}], ")"}], "^", "2"}]}], "<", "1"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"points", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"i", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"i", "<", "n"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"point", "=", 
         RowBox[{"{", 
          RowBox[{"rx", ",", "ry"}], "}"}]}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"dPrint", "[", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "point", ",", " ", 
           RowBox[{"OK", "[", "point", "]"}]}], "}"}], "]"}], ";", " ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"OK", "[", "point", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"points", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"points", ",", "point"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"i", "++"}]}]}], "]"}], ";"}]}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", "points", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ch", "=", 
      RowBox[{"ComputationalGeometry`ConvexHull", "[", "points", "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", "ch", "]"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"ch", " ", "=", " ", 
      RowBox[{"points", "[", 
       RowBox[{"[", "ch", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"q", "=", 
      RowBox[{"VoronoiToTissue", "[", 
       RowBox[{"points", ",", " ", "ch"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "project", " ", "points", " ", "out", " ", "to", " ", "ellipse"}], "  ",
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "vb", ",", "v", ",", " ", "costheta", ",", " ", "sintheta", ",", " ", 
         "vnext", ",", "vnew", ",", " ", "inext", ",", " ", "e", ",", " ", 
         "c"}], "}"}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"vb", " ", "=", " ", 
         RowBox[{"VerticesOnBoundary", "[", "q", "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"v", "=", 
         RowBox[{"TissueVertices", "[", "q", "]"}]}], ";", " ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"project", "[", 
          RowBox[{"{", 
           RowBox[{"x_", ",", " ", "y_"}], "}"}], "]"}], ":=", " ", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "r", ",", " ", "R", ",", " ", "c", ",", " ", "s", ",", " ", 
             "xnew", ",", " ", "ynew"}], "}"}], ",", " ", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"r", " ", "=", " ", 
             RowBox[{"Sqrt", "[", 
              RowBox[{
               RowBox[{"x", "^", "2"}], " ", "+", " ", 
               RowBox[{"y", "^", "2"}]}], "]"}]}], ";", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"c", " ", "=", " ", 
             RowBox[{"x", "/", "r"}]}], ";", " ", "\[IndentingNewLine]", 
            RowBox[{"s", " ", "=", " ", 
             RowBox[{"y", "/", "r"}]}], ";", " ", "\[IndentingNewLine]", 
            RowBox[{"R", " ", "=", " ", 
             RowBox[{"1", "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"c", "/", "a"}], ")"}], "^", "2"}], " ", "+", " ", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"s", "/", "b"}], ")"}], "^", "2"}]}], ")"}]}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"R", "=", 
             RowBox[{"Sqrt", "[", "R", "]"}]}], ";", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"xnew", " ", "=", " ", 
             RowBox[{"R", "*", 
              RowBox[{"x", "/", "r"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"ynew", " ", "=", " ", 
             RowBox[{"R", " ", "*", " ", 
              RowBox[{"y", " ", "/", "r"}]}]}], ";", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"Return", "[", 
             RowBox[{"{", 
              RowBox[{"xnew", ",", " ", "ynew"}], "}"}], "]"}], ";"}]}], " ", 
          "\[IndentingNewLine]", "]"}]}], ";", " ", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "vb", "]"}], ">", "0"}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"inext", " ", "=", " ", 
            RowBox[{"First", "[", "vb", "]"}]}], ";", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"vb", "=", " ", 
            RowBox[{"Rest", "[", "vb", "]"}]}], ";", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"vnext", " ", "=", " ", 
            RowBox[{"v", "[", 
             RowBox[{"[", "inext", "]"}], "]"}]}], ";", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"vnew", " ", "=", " ", 
            RowBox[{"project", "[", "vnext", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"v", " ", "=", " ", 
            RowBox[{"ReplacePart", "[", 
             RowBox[{"v", ",", " ", 
              RowBox[{"inext", " ", "\[Rule]", " ", "vnew"}]}], "]"}]}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"e", " ", "=", " ", 
         RowBox[{"TissueEdges", "[", "q", "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"c", " ", "=", " ", 
         RowBox[{"TissueCells", "[", "q", "]"}]}], ";", " ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"q", " ", "=", " ", 
         RowBox[{"Tissue", "[", 
          RowBox[{"v", ",", "e", ",", "c"}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "q", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5122161451938877`*^9, 3.512216149354312*^9}, {
  3.5122161845798883`*^9, 3.512216305809991*^9}, {3.51221639662506*^9, 
  3.5122164286661863`*^9}, {3.512216465042918*^9, 3.5122164714488*^9}, {
  3.512216505235623*^9, 3.5122165485432568`*^9}, {3.512216603368001*^9, 
  3.512216677638466*^9}, {3.512338478004879*^9, 3.5123384936682367`*^9}, {
  3.512338565403378*^9, 3.5123387254029408`*^9}, {3.512338763753661*^9, 
  3.512338860311425*^9}, {3.512338892882864*^9, 3.512338918888629*^9}, {
  3.51233896483748*^9, 3.512339040978231*^9}, {3.5123391236379013`*^9, 
  3.512339178936997*^9}, {3.512339963308902*^9, 3.512340021455104*^9}, {
  3.512340077521223*^9, 3.512340079401058*^9}, {3.512340124516789*^9, 
  3.5123401416593924`*^9}, {3.512340346879739*^9, 3.5123403509363003`*^9}, {
  3.512340411982033*^9, 
  3.5123404227528152`*^9}},ExpressionUUID->"37311814-67b5-4c4b-ae37-\
063db15bfeab"]
}, Closed]],

Cell[CellGroupData[{

Cell["TemplateParabolic", "Subsection",
 CellChangeTimes->{{3.572223307768257*^9, 3.5722233275024014`*^9}, {
  3.572463277405796*^9, 
  3.572463279988946*^9}},ExpressionUUID->"a9cc3b50-96ec-48be-9cc9-\
4835872af7d3"],

Cell[CellGroupData[{

Cell["height = width/2", "Subsubsection",
 CellChangeTimes->{{3.5779769510126343`*^9, 3.577976953278034*^9}, {
  3.577977026202351*^9, 
  3.5779770302196913`*^9}},ExpressionUUID->"0c526928-2746-470f-82c4-\
d275440b9248"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TemplateParabolic", "[", 
    RowBox[{"height_", ",", "nRows_", ",", " ", 
     RowBox[{"rnd_:", "0"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "W", ",", "H", ",", "delta", ",", "i", ",", "g", ",", "gnext", ",", 
       "parab", ",", "NMdist", ",", "pts", ",", 
       RowBox[{"k", "=", "0"}], ",", "x", ",", "y", ",", "off", ",", "t", ",",
        "q", ",", "q1", ",", "n", ",", "n1", ",", "bv", ",", "v", ",", "e", 
       ",", "c", ",", "ymin", ",", "xbv", ",", "vnew", ",", "vbvnew", ",", 
       "vbv", ",", "bottomlayer", ",", "dPrint", ",", "rng", ",", "mxrnd", 
       ",", "RemoveExtraBottomVertices", ",", " ", "gcurves", ",", " ", 
       "dummyCells"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"dPrint", "[", "u___", "]"}], ":=", 
       RowBox[{"If", "[", 
        RowBox[{"debug", ",", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Meristem Template: \>\"", ",", "u"}], "]"}]}], "]"}]}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "Equation", " ", "of", " ", "parabola", " ", "of", " ", "width", " ", 
         "W"}], ",", 
        RowBox[{"Height", " ", "H"}]}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"parab", "[", 
        RowBox[{"W_", ",", "H_", ",", "x_"}], "]"}], ":=", 
       RowBox[{"H", "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"2", " ", 
             RowBox[{"x", "/", "W"}]}], ")"}], "^", "2"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "Newton", " ", "Method", " ", "Solver", " ", "for", " ", "x"}], "-", 
        RowBox[{
        "coordinate", " ", "of", " ", "distance", " ", "t", " ", "as", " ", 
         "measured", " ", "from", " ", "center", " ", "along", " ", 
         "parabola"}]}], "*)"}], 
      RowBox[{"(*", 
       RowBox[{
       "assumes", " ", "convergence", " ", "in", " ", "3", " ", 
        "iterations"}], "*)"}], 
      RowBox[{
       RowBox[{"NMdist", "[", 
        RowBox[{"t_", ",", "Width_"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"f", ",", "gn", ",", "x0", ",", "j", ",", "xnext"}], "}"}], 
         ",", 
         RowBox[{
          RowBox[{
           RowBox[{"f", "[", "x_", "]"}], ":=", " ", 
           RowBox[{
            RowBox[{
             FractionBox["1", "8"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"4", " ", "x", " ", 
                SqrtBox[
                 RowBox[{"1", "+", 
                  FractionBox[
                   RowBox[{"16", " ", 
                    SuperscriptBox["x", "2"]}], 
                   SuperscriptBox["Width", "2"]]}]]}], "+", 
               RowBox[{"Width", "*", 
                RowBox[{"ArcSinh", "[", 
                 FractionBox[
                  RowBox[{"4", " ", "x"}], "Width"], "]"}]}]}], ")"}]}], "-", 
            "t"}]}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"gn", "[", "x_", "]"}], ":=", 
           RowBox[{"x", "-", 
            RowBox[{
             RowBox[{"f", "[", "x", "]"}], "/", 
             RowBox[{
              RowBox[{"f", "'"}], "[", "x", "]"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"x0", "=", "t"}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "0"}], ",", 
            RowBox[{"j", "\[LessEqual]", "2"}], ",", 
            RowBox[{"j", "++"}], ",", 
            RowBox[{
             RowBox[{"x0", "=", 
              RowBox[{"gn", "[", "x0", "]"}]}], ";"}]}], "]"}], ";", 
          "\[IndentingNewLine]", "x0"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "delta", " ", "is", " ", "the", " ", "approximate", " ", "cell", " ", 
        "diameter"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"delta", "=", 
       RowBox[{"1.0", "*", 
        RowBox[{"height", "/", "nRows"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<delta=\>\"", ",", "delta"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"mxrnd", " ", "=", " ", 
       RowBox[{"Max", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Min", "[", 
          RowBox[{"rnd", ",", " ", "0.25"}], "]"}]}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"rng", ":=", " ", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"mxrnd", "*", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "delta"}], ",", " ", "delta"}], "}"}]}], "]"}]}], ";",
       " ", "\[IndentingNewLine]", 
      RowBox[{"rng", ":=", " ", 
       RowBox[{"RandomVariate", "[", 
        RowBox[{"NormalDistribution", "[", 
         RowBox[{"0", ",", 
          RowBox[{"mxrnd", "*", "delta"}]}], "]"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "generate", " ", "parabolas", " ", "spaced", " ", "by", " ", "delta"}],
        "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"g", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pts", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", "nRows"}], ",", 
        RowBox[{"i", "++"}], ",", 
        RowBox[{
         RowBox[{"H", "=", 
          RowBox[{"i", "*", "delta"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"W", "=", 
          RowBox[{"2", " ", "H"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"gnext", "=", 
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"parab", "[", 
             RowBox[{"W", ",", "H", ",", "x"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"-", "H"}], ",", "H"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"g", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"g", ",", "gnext"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"x", "=", "0"}], ";", "\[IndentingNewLine]", 
         RowBox[{"k", "=", "0"}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "generate", " ", "evenly", " ", "spaced", " ", "points", " ", 
           "along", " ", "each", " ", "parabola"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{"x", "<", "W"}], ",", 
           RowBox[{
            RowBox[{"off", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"EvenQ", "[", "i", "]"}], ",", "0", ",", "0.5"}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"t", "=", 
             RowBox[{
              RowBox[{"1.0", "*", "k", "*", "delta"}], "+", 
              RowBox[{"off", "*", "delta"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"x", "=", 
             RowBox[{"NMdist", "[", 
              RowBox[{"t", ",", "W"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"y", "=", 
             RowBox[{"parab", "[", 
              RowBox[{"W", ",", "H", ",", "x"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"k", "++"}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"y", ">", "0"}], ",", 
              RowBox[{
               RowBox[{"pts", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"pts", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"x", "+", "rng"}], ",", 
                    RowBox[{"y", "+", "rng"}]}], "}"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"OddQ", "[", "i", "]"}], "\[Or]", 
                  RowBox[{"(", 
                   RowBox[{"x", ">", "0"}], ")"}]}], ",", 
                 RowBox[{"pts", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"pts", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "x"}], ",", "y"}], "}"}]}], "]"}]}]}], "]"}],
                ";"}]}], "]"}], ";"}]}], "]"}], ";"}]}], "]"}], ";", 
      RowBox[{"dPrint", "[", 
       RowBox[{"gcurves", "=", " ", 
        RowBox[{"Show", "[", 
         RowBox[{"g", ",", 
          RowBox[{"Graphics", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"PointSize", "[", ".02", "]"}], ",", 
             RowBox[{"Point", "[", "pts", "]"}]}], "}"}], "]"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "300"}], ",", 
          RowBox[{"AspectRatio", "\[Rule]", " ", ".5"}]}], "]"}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "add", " ", "a", " ", "layer", " ", "of", " ", "dummy", " ", "cells", 
        " ", "on", " ", "the", " ", "bottom", " ", "of", " ", "the", " ", 
        "meristem"}], "*)"}], 
      RowBox[{"pts", "=", 
       RowBox[{"Union", "[", "pts", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "pts", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dummyCells", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "delta"}], "*", ".5"}], "+", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "delta"}], "/", "10"}], ",", 
               RowBox[{"delta", "/", "10"}]}], "}"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{"-", "H"}], ",", "H", ",", "delta"}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<dummyCells for Voronoi Bounding: \>\"", ",", " ", 
        RowBox[{"Show", "[", 
         RowBox[{"gcurves", ",", " ", 
          RowBox[{"Graphics", "[", 
           RowBox[{"{", 
            RowBox[{"Red", ",", " ", 
             RowBox[{"Point", "[", "dummyCells", "]"}]}], "}"}], "]"}]}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"pts", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"pts", ",", "dummyCells"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n1", "=", 
       RowBox[{"Length", "[", "pts", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"{", 
        RowBox[{"n", ",", "n1"}], "}"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"generate", " ", "Voronoi", " ", "of", " ", "points"}], "*)"}], 
      RowBox[{"q", "=", 
       RowBox[{"BoundedCellVoronoi", "[", "pts", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<bounded: \>\"", ",", 
        RowBox[{"ShowTissue", "[", 
         RowBox[{"q", ",", 
          RowBox[{"\"\<CellNumbers\>\"", "\[Rule]", "True"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"smoothe", " ", "out", " ", "the", " ", "bumpi"}], "-", 
        RowBox[{"ness", " ", "from", " ", "the", " ", "Voronoi"}]}], "*)"}], 
      RowBox[{"q", "=", 
       RowBox[{"SmootheCells", "[", "q", "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<smoothed: \>\"", ",", 
        RowBox[{"ShowTissue", "[", 
         RowBox[{"q", ",", 
          RowBox[{"\"\<CellNumbers\>\"", "\[Rule]", "True"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "remove", " ", "the", " ", "dummy", " ", "layer", " ", "on", " ", 
         "the", " ", "bottom"}], "-", 
        RowBox[{
        "Voronoi", " ", "might", " ", "have", " ", "changed", " ", 
         "indices"}]}], "*)"}], 
      RowBox[{"bottomlayer", "=", 
       RowBox[{"Pick", "[", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"NTissueCells", "[", "q", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "<", "0"}], ")"}], "&"}], "/@", 
          
          RowBox[{"Centroid", "[", "q", "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q", "=", 
       RowBox[{"RemoveCell", "[", 
        RowBox[{"q", ",", "bottomlayer"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<pruned: \>\"", ",", 
        RowBox[{"ShowTissue", "[", 
         RowBox[{"q", ",", 
          RowBox[{"\"\<CellNumbers\>\"", "\[Rule]", "True"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "300"}], ",", 
          RowBox[{"Frame", "\[Rule]", "True"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Project", " ", "vertices", " ", "on", " ", "bottom", " ", "to", " ", 
        "a", " ", "straight", " ", "line"}], "*)"}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"bv", "=", 
         RowBox[{"VerticesOnBottom", "[", "q", "]"}]}], ";"}], "*)"}], 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v", ",", "e", ",", "c"}], "}"}], "=", 
       RowBox[{"q", "/.", 
        RowBox[{"{", 
         RowBox[{"Tissue", "\[Rule]", "List"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bv", "=", 
       RowBox[{"Pick", "[", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"NTissueVertices", "[", "q", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "<", 
             RowBox[{"delta", "*", "0.5"}]}], ")"}], "&"}], "/@", "v"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ymin", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"Last", "/@", 
         RowBox[{"v", "[", 
          RowBox[{"[", "bv", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vbv", "=", 
       RowBox[{"v", "[", 
        RowBox[{"[", "bv", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xbv", "=", 
       RowBox[{"First", "/@", "vbv"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vbvnew", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"#", ",", "ymin"}], "}"}], "&"}], "/@", "xbv"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vnew", "=", 
       RowBox[{"ReplacePart", "[", 
        RowBox[{"v", ",", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Rule", ",", 
           RowBox[{"{", 
            RowBox[{"bv", ",", "vbvnew"}], "}"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q", "=", 
       RowBox[{"Tissue", "[", 
        RowBox[{"vnew", ",", "e", ",", "c"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<projected: \>\"", ",", 
        RowBox[{"ShowTissue", "[", 
         RowBox[{"q", ",", 
          RowBox[{"\"\<CellNumbers\>\"", "\[Rule]", "True"}], ",", 
          RowBox[{"\"\<VertexNumbers\>\"", "\[Rule]", " ", "True"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "300"}], ",", 
          RowBox[{"Frame", "\[Rule]", "True"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"smoothe", " ", "bottom", " ", "layer"}], ",", " ", 
        RowBox[{"but", " ", "not", " ", "the", " ", "corners"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "cvn", ",", "flags", ",", "bc", ",", " ", "xcoords", ",", " ", 
          "leftmost", ",", " ", "rightmost", ",", " ", "endcells"}], "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "pick", " ", "boundar", " ", "cells", " ", "bc", " ", "that", " ", 
          "include", " ", "the", " ", "boundary", " ", "vertices", " ", "bv", 
          " ", "determined", " ", "above"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"cvn", "=", 
          RowBox[{"CellVertexNumbers", "[", "q", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"flags", "=", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"Intersection", "[", 
               RowBox[{"bv", ",", "#"}], "]"}], "]"}], ">", "0"}], "&"}], "/@",
            "cvn"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"bc", "=", 
          RowBox[{"Pick", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"NTissueCells", "[", "q", "]"}], "]"}], ",", "flags"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"determine", " ", "left"}], " ", "&"}], " ", "right", 
            " ", "most", " ", "cells", " ", "based", " ", "on", " ", "x"}], 
           "-", 
           RowBox[{"coordinate", " ", "of", " ", "centroid"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"xcoords", "=", 
          RowBox[{"First", "/@", 
           RowBox[{"Centroid", "[", 
            RowBox[{"q", ",", "bc"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"leftmost", "=", 
          RowBox[{
           RowBox[{"Ordering", "[", "xcoords", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"leftmost", " ", "=", " ", 
          RowBox[{"bc", "[", 
           RowBox[{"[", "leftmost", "]"}], "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"rightmost", "=", 
          RowBox[{
           RowBox[{"Ordering", "[", "xcoords", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"rightmost", "=", 
          RowBox[{"bc", "[", 
           RowBox[{"[", "rightmost", "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"endcells", "=", 
          RowBox[{"{", 
           RowBox[{"leftmost", ",", "rightmost"}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"exclude", " ", "left"}], " ", "&"}], " ", "right"}], 
           "-", 
           RowBox[{"most", " ", "cells", " ", "from", " ", "smoothing"}]}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"bc", "=", 
          RowBox[{"Complement", "[", 
           RowBox[{"bc", ",", "endcells"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "exclude", " ", "cells", " ", "with", " ", "only", " ", "a", " ", 
           "single", " ", "vertex", " ", "on", " ", "boundary", " ", "from", 
           " ", "smoothing"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"bc", "=", 
          RowBox[{"Select", "[", 
           RowBox[{"bc", ",", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{
               RowBox[{"CellsOnBoundary", "[", "q", "]"}], ",", "#"}], "]"}], 
             "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"q1", "=", 
          RowBox[{"SmootheCells", "[", 
           RowBox[{"q", ",", "bc"}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Now", " ", "check", " ", "for", " ", "extra", " ", "vertices", " ",
            "in", " ", "bottom", " ", "corrner", " ", 
           RowBox[{"cells", ".", " ", "There"}], " ", "is", " ", "unlikely", 
           " ", "to", " ", "be", " ", "more", " ", "than", " ", "one", " ", 
           "per", " ", "cell"}], " ", "*)"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"leftmost", " ", "cell"}], " ", "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         
         RowBox[{
          RowBox[{"RemoveExtraBottomVertices", "[", "CellIndex_", "]"}], ":=",
           " ", 
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "int", ",", "xvals", ",", "left", ",", "right", ",", 
              "extraVertices", ",", "edges", ",", "edgepairs"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"int", "=", 
              RowBox[{"Intersection", "[", 
               RowBox[{
                RowBox[{"cvn", "[", 
                 RowBox[{"[", "CellIndex", "]"}], "]"}], ",", "bv"}], "]"}]}],
              ";", "\[IndentingNewLine]", 
             RowBox[{"xvals", "=", 
              RowBox[{"First", "/@", 
               RowBox[{"v", "[", 
                RowBox[{"[", "int", "]"}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"left", "=", 
              RowBox[{"int", "[", 
               RowBox[{"[", 
                RowBox[{"Ordering", "[", 
                 RowBox[{"xvals", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
             RowBox[{"right", "=", 
              RowBox[{"int", "[", 
               RowBox[{"[", 
                RowBox[{"Ordering", "[", 
                 RowBox[{"xvals", ",", 
                  RowBox[{"-", "1"}]}], "]"}], "]"}], "]"}]}], ";", 
             RowBox[{"extraVertices", "=", 
              RowBox[{"Complement", "[", 
               RowBox[{"int", ",", 
                RowBox[{"Flatten", "[", 
                 RowBox[{"{", 
                  RowBox[{"left", ",", "right"}], "}"}], "]"}]}], "]"}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"edges", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"e", ",", "#"}], "]"}], "&"}], "/@", 
               "extraVertices"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"edgepairs", "=", 
              RowBox[{"First", "/@", 
               RowBox[{"Transpose", "/@", "edges"}]}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"While", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "edgepairs", "]"}], ">", "0"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"edges", "=", 
                 RowBox[{"First", "[", "edgepairs", "]"}]}], ";", " ", 
                RowBox[{"edgepairs", "=", 
                 RowBox[{"Rest", "[", "edgepairs", "]"}]}], ";", " ", 
                "\[IndentingNewLine]", 
                RowBox[{"q", "=", "q1"}], ";", "\[IndentingNewLine]", 
                RowBox[{"dPrint", "[", 
                 RowBox[{"\"\<Merging edges \>\"", ",", " ", 
                  RowBox[{"{", "edges", "}"}]}], "]"}], ";", " ", 
                "\[IndentingNewLine]", 
                RowBox[{"q1", "=", 
                 RowBox[{"MergeEdges", "[", 
                  RowBox[{"q", ",", " ", 
                   RowBox[{"Sequence", "@@", "edges"}]}], "]"}]}], ";"}]}], 
              " ", "\[IndentingNewLine]", "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}]}], ";", " ", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"RemoveExtraBottomVertices", "[", "leftmost", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"RemoveExtraBottomVertices", "[", "rightmost", "]"}], 
         ";"}]}], " ", "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<projected/smoothed bottom: \>\"", ",", 
        RowBox[{"ShowTissue", "[", 
         RowBox[{"q1", ",", 
          RowBox[{"\"\<CellNumbers\>\"", "\[Rule]", "True"}], ",", 
          RowBox[{"\"\<VertexNumbers\>\"", "\[Rule]", " ", "True"}], ",", " ", 
          RowBox[{"ImageSize", "\[Rule]", "300"}], ",", 
          RowBox[{"Frame", "\[Rule]", "True"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"q", "=", "q1"}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"SmootheL1L2Interface", "[", 
        RowBox[{"q", ",", "delta", ",", "height"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<L1/L2 Interface smoothed out: \>\"", ",", " ", 
        RowBox[{"ShowTissue", "[", 
         RowBox[{"q1", ",", 
          RowBox[{"\"\<CellNumbers\>\"", "\[Rule]", "True"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", " ", "300"}]}], "]"}]}], "]"}], ";",
       " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "squish", " ", "bottom", " ", "cells", " ", "down", " ", "to", " ", 
        "average"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "averageArea", ",", " ", "areas", ",", " ", "cvc", ",", " ", "cvcy", 
          ",", " ", "takeys", ",", " ", "bot", ",", "abot", ",", " ", 
          "atotbot", ",", " ", "overallwidth", ",", " ", "xmax", ",", " ", 
          "xmin", ",", " ", "ysquish"}], "}"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q", "=", "q1"}], ";", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"takeys", "[", "vertexlist_", "]"}], ":=", " ", 
          RowBox[{
           RowBox[{"Transpose", "[", "vertexlist", "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
         
         RowBox[{"areas", " ", "=", " ", 
          RowBox[{"areafunction", "[", "q", "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"averageArea", "=", 
          RowBox[{"areas", "//", "Mean"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"dPrint", "[", 
          RowBox[{"\"\<averageArea: \>\"", ",", " ", "averageArea"}], "]"}], 
         ";", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"v", ",", "e", ",", "c"}], "}"}], "=", 
          RowBox[{"q", "/.", 
           RowBox[{"{", 
            RowBox[{"Tissue", "\[Rule]", "List"}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"xmax", " ", "=", " ", 
          RowBox[{"Max", "[", 
           RowBox[{"First", "/@", "v"}], "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"xmin", " ", "=", " ", 
          RowBox[{"Min", "[", 
           RowBox[{"First", "/@", "v"}], "]"}]}], ";", "\[IndentingNewLine]", 
         
         RowBox[{"overallwidth", "=", 
          RowBox[{"xmax", "-", "xmin"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"dPrint", "[", 
          RowBox[{"\"\<overallwidth: \>\"", ",", " ", 
           RowBox[{"6", "overallwidth"}]}], "]"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"cvc", " ", "=", " ", 
          RowBox[{"CellVertexCoordinates", "[", "q", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"cvcy", " ", "=", " ", 
          RowBox[{"Min", "/@", 
           RowBox[{"takeys", "/@", "cvc"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"dPrint", "[", 
          RowBox[{"\"\<cvcy: \>\"", ",", " ", "cvcy"}], "]"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"bot", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "<", 
              RowBox[{"0.5", "*", "delta"}]}], ")"}], "&"}], "/@", "cvcy"}]}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"bot", "=", 
          RowBox[{"Pick", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "c", "]"}], "]"}], ",", " ", "bot"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"dPrint", "[", 
          RowBox[{"\"\<bot: \>\"", ",", " ", "bot"}], "]"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"abot", " ", "=", " ", 
          RowBox[{
           RowBox[{"areas", "[", 
            RowBox[{"[", "bot", "]"}], "]"}], "//", "Mean"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"dPrint", "[", 
          RowBox[{"\"\<abot: \>\"", ",", " ", "abot"}], "]"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"atotbot", "=", 
          RowBox[{"Plus", "@@", 
           RowBox[{"areas", "[", 
            RowBox[{"[", "bot", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         
         RowBox[{"dPrint", "[", 
          RowBox[{"\"\<atotbot: \>\"", ",", " ", "atotbot"}], "]"}], ";", " ",
          "\[IndentingNewLine]", 
         RowBox[{"ysquish", " ", "=", " ", 
          RowBox[{"Max", "[", 
           RowBox[{"0.0", ",", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"atotbot", "-", 
               RowBox[{
                RowBox[{"Length", "[", "bot", "]"}], "*", "averageArea"}]}], 
              ")"}], "/", "overallwidth"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"dPrint", "[", 
          RowBox[{"\"\<ysquish: \>\"", ",", " ", "ysquish"}], "]"}], ";", " ",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"squish", " ", "cells"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"bv", "=", 
          RowBox[{"Pick", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "v", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "<", 
                RowBox[{"delta", "*", "0.5"}]}], ")"}], "&"}], "/@", "v"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"vbv", "=", 
          RowBox[{"v", "[", 
           RowBox[{"[", "bv", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"xbv", "=", 
          RowBox[{"First", "/@", "vbv"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"vbvnew", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"#", ",", 
              RowBox[{"ymin", "+", "ysquish"}]}], "}"}], "&"}], "/@", 
           "xbv"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"vnew", "=", 
          RowBox[{"ReplacePart", "[", 
           RowBox[{"v", ",", 
            RowBox[{"MapThread", "[", 
             RowBox[{"Rule", ",", 
              RowBox[{"{", 
               RowBox[{"bv", ",", "vbvnew"}], "}"}]}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"q1", "=", 
          RowBox[{"Tissue", "[", 
           RowBox[{"vnew", ",", "e", ",", "c"}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "q1", "]"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.572223318223566*^9, 3.572223323910605*^9}, {
   3.5722233550823307`*^9, 3.572223370239102*^9}, {3.572223439426126*^9, 
   3.5722235183619432`*^9}, {3.572223551816581*^9, 3.572223555478018*^9}, {
   3.572260127289784*^9, 3.572260172053306*^9}, 3.572260387798181*^9, {
   3.572260441336034*^9, 3.5722604437074347`*^9}, {3.572260608062705*^9, 
   3.572260640431219*^9}, {3.572265336453043*^9, 3.572265398718544*^9}, {
   3.572265937771056*^9, 3.572266182217387*^9}, {3.572266242754945*^9, 
   3.572266242989728*^9}, {3.5722679880051823`*^9, 3.5722685876073017`*^9}, {
   3.5724632816941843`*^9, 3.5724632844614353`*^9}, {3.572474191644382*^9, 
   3.5724742195948677`*^9}, {3.572474346356968*^9, 3.572474351914701*^9}, {
   3.5724744720040693`*^9, 3.572474484181566*^9}, {3.572475173185433*^9, 
   3.5724751762888403`*^9}, 3.572475224329919*^9, {3.572475358566326*^9, 
   3.5724754024606743`*^9}, {3.5724756411547403`*^9, 3.57247566075198*^9}, {
   3.572828011739249*^9, 3.572828062646058*^9}, {3.5728281345831823`*^9, 
   3.5728281909029083`*^9}, {3.577888622207015*^9, 3.577888824224633*^9}, {
   3.5778888798455067`*^9, 3.5778891858208838`*^9}, {3.577889250350544*^9, 
   3.577889350350865*^9}, {3.577889414156962*^9, 3.5778894455249233`*^9}, {
   3.577889479503337*^9, 3.5778894937104063`*^9}, {3.577889559962862*^9, 
   3.577889620532439*^9}, {3.577889658762083*^9, 3.577889692612575*^9}, {
   3.577890144006454*^9, 3.577890159691352*^9}, {3.577890379102243*^9, 
   3.577890380971785*^9}, {3.577890413454837*^9, 3.5778904250224257`*^9}, {
   3.577890525575232*^9, 3.577890533992868*^9}, {3.57789413983256*^9, 
   3.577894192621388*^9}, {3.577985948479496*^9, 3.57798594905797*^9}, {
   3.5780800739466057`*^9, 3.578080075747612*^9}, 
   3.7057115019508142`*^9},ExpressionUUID->"9fce2b78-4f3a-47d1-ab49-\
0bf3b33ba63a"]
}, Closed]],

Cell[CellGroupData[{

Cell["general form", "Subsubsection",
 CellChangeTimes->{{3.57797703916856*^9, 
  3.577977040392562*^9}},ExpressionUUID->"e45910d5-76ce-45c6-b0f2-\
f6e218a7377c"],

Cell["\<\
mu = average diameter of L1 cell
sigma = standard deviation of diameter of L1 cell
If sigma/mu is too large, the algorithm will fail, and the function may have \
to be run multiple times to get to work\
\>", "Text",
 CellChangeTimes->{{3.578080111623481*^9, 
  3.5780801676473103`*^9}},ExpressionUUID->"ba04ddf3-a1de-4633-b160-\
6ff10c9dc112"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CheckEdges", "[", 
   RowBox[{"T_", ",", " ", 
    RowBox[{"msg_:", "\"\<\>\""}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"v", ",", "e", ",", "c", ",", "lengths"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"v", ",", "e", ",", "c"}], "}"}], "=", 
      RowBox[{"T", "/.", 
       RowBox[{"{", 
        RowBox[{"Tissue", "\[Rule]", " ", "List"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"lengths", "=", 
      RowBox[{"Length", "/@", "e"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"lengths", "=", 
      RowBox[{"Union", "[", "lengths", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"AbortIf", "[", 
      RowBox[{
       RowBox[{"lengths", "\[NotEqual]", " ", 
        RowBox[{"{", "2", "}"}]}], ",", 
       RowBox[{
       "msg", "<>", 
        "\"\<Possible Program Error: Invalid List of edge pairs: \>\"", "<>", 
        
        RowBox[{"ToString", "[", 
         RowBox[{"InputForm", "[", "e", "]"}], "]"}], "<>", "\"\< : \>\""}]}],
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5785756257627697`*^9, 3.578575691992551*^9}, {
  3.578575724801016*^9, 
  3.578575929318513*^9}},ExpressionUUID->"b7ed00e7-16dd-4782-a72d-\
d662ffd4b911"],

Cell["\<\
The Points and PrintPoints optoins are mostly for debugging to bypass (and \
reproduce) specific randomization\
\>", "Text",
 CellChangeTimes->{{3.578580203950036*^9, 
  3.578580233326165*^9}},ExpressionUUID->"2593a1fd-47d6-47c6-9fa4-\
aea0d454af6d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TemplateParabolic", "[", 
    RowBox[{
    "height_", ",", " ", "width_", ",", " ", "mu_", ",", " ", "sigma_", ",", 
     " ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "W", ",", "H", ",", "delta", ",", "i", ",", "g", ",", "gnext", ",", 
       "parab", ",", "NMdist", ",", "pts", ",", 
       RowBox[{"k", "=", "0"}], ",", "x", ",", "y", ",", "off", ",", "t", ",",
        "q", ",", "q1", ",", "n", ",", "n1", ",", "bv", ",", "v", ",", "e", 
       ",", "c", ",", "ymin", ",", "xbv", ",", "vnew", ",", "vbvnew", ",", 
       "vbv", ",", "bottomlayer", ",", "dPrint", ",", " ", "gcurves", ",", 
       " ", "nextpoint", ",", " ", "nRows", ",", " ", "told", ",", " ", 
       "dummyCells", ",", " ", 
       RowBox[{"doEdgeChecks", "=", "False"}], ",", " ", "DoEdgeCheck", ",", 
       " ", "debug", ",", " ", "Points", ",", " ", "PPoints"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"debug", "=", 
       RowBox[{
        RowBox[{"\"\<Debug\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Debug\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{"Points", "=", 
       RowBox[{
        RowBox[{"\"\<Points\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Points\>\"", "\[Rule]", " ", 
          RowBox[{"{", "}"}]}], "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"PPoints", "=", 
       RowBox[{
        RowBox[{"\"\<PrintPoints\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<PrintPoints\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], 
      ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DoEdgeCheck", "[", 
        RowBox[{"T_", ",", "u_"}], "]"}], ":=", 
       RowBox[{"If", "[", 
        RowBox[{"doEdgeChecks", ",", " ", 
         RowBox[{"CheckEdges", "[", 
          RowBox[{"T", ",", "u"}], "]"}]}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dPrint", "[", "u___", "]"}], ":=", 
       RowBox[{"If", "[", 
        RowBox[{"debug", ",", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Meristem Template: \>\"", ",", "u"}], "]"}]}], "]"}]}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "Equation", " ", "of", " ", "parabola", " ", "of", " ", "width", " ", 
         "W"}], ",", 
        RowBox[{"Height", " ", "H"}]}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"parab", "[", 
        RowBox[{"W_", ",", "H_", ",", "x_"}], "]"}], ":=", 
       RowBox[{"H", "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"2", " ", 
             RowBox[{"x", "/", "W"}]}], ")"}], "^", "2"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "Newton", " ", "Method", " ", "Solver", " ", "for", " ", "x"}], "-", 
        RowBox[{
        "coordinate", " ", "of", " ", "distance", " ", "t", " ", "as", " ", 
         "measured", " ", "from", " ", "center", " ", "along", " ", 
         "parabola"}]}], "*)"}], 
      RowBox[{"(*", 
       RowBox[{
       "assumes", " ", "convergence", " ", "in", " ", "3", " ", 
        "iterations"}], "*)"}], 
      RowBox[{
       RowBox[{"NMdist", "[", 
        RowBox[{"t_", ",", "W_", ",", "H_"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"f", ",", "gn", ",", "x0", ",", "j", ",", "xnext"}], "}"}], 
         ",", 
         RowBox[{
          RowBox[{
           RowBox[{"f", "[", "x_", "]"}], ":=", " ", 
           RowBox[{
            RowBox[{
             FractionBox["1", 
              RowBox[{"(", 
               RowBox[{"16", "H"}], ")"}]], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"8", "H", " ", "x", " ", 
                SqrtBox[
                 RowBox[{"1", "+", 
                  FractionBox[
                   RowBox[{"64", 
                    SuperscriptBox["H", "2"], " ", 
                    SuperscriptBox["x", "2"]}], 
                   SuperscriptBox["W", "4"]]}]]}], "+", 
               RowBox[{
                SuperscriptBox["W", "2"], "*", 
                RowBox[{"ArcSinh", "[", 
                 FractionBox[
                  RowBox[{"8", "H", " ", "x"}], 
                  SuperscriptBox["W", "2"]], "]"}]}]}], ")"}]}], "-", "t"}]}],
           ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"gn", "[", "x_", "]"}], ":=", 
           RowBox[{"x", "-", 
            RowBox[{
             RowBox[{"f", "[", "x", "]"}], "/", 
             RowBox[{
              RowBox[{"f", "'"}], "[", "x", "]"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"x0", "=", "t"}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "0"}], ",", 
            RowBox[{"j", "\[LessEqual]", "2"}], ",", 
            RowBox[{"j", "++"}], ",", 
            RowBox[{
             RowBox[{"x0", "=", 
              RowBox[{"gn", "[", "x0", "]"}]}], ";"}]}], "]"}], ";", 
          "\[IndentingNewLine]", "x0"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"delta", " ", "=", " ", "mu"}], ";", " ", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{
       "\"\<mu=\>\"", ",", "mu", ",", " ", 
        "\"\< average cell diameter.\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{
       "\"\<sigma=\>\"", ",", "sigma", ",", " ", 
        "\"\< cell diameter std. dev.\>\""}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "generate", " ", "parabolas", " ", "spaced", " ", "by", " ", "delta"}],
        "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"g", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "Points", "]"}], ">", "0"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"pts", "=", "Points"}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"pts", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"nRows", " ", "=", " ", 
          RowBox[{"height", "/", "mu"}]}], ";", " ", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "0"}], ",", "\[IndentingNewLine]", 
           RowBox[{"i", "<", "nRows"}], ",", "\[IndentingNewLine]", 
           RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"H", "=", 
             RowBox[{"height", "-", 
              RowBox[{"i", "*", "delta"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"W", "=", 
             RowBox[{"2", " ", "H"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"W", "=", 
             RowBox[{"width", " ", "-", " ", 
              RowBox[{"2", 
               RowBox[{"(", "i", ")"}], "*", "delta"}]}]}], ";", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"dPrint", "[", 
               RowBox[{
               "\"\<i=\>\"", ",", " ", "i", ",", " ", "\"\< W=\>\"", ",", " ",
                 "W", ",", "\"\< H=\>\"", ",", " ", "H"}], "]"}], ";"}], " ", 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{"gnext", "=", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"parab", "[", 
                RowBox[{"W", ",", "H", ",", "x"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", 
                 RowBox[{
                  RowBox[{"-", "W"}], "/", "2"}], ",", 
                 RowBox[{"W", "/", "2"}]}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"g", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"g", ",", "gnext"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"x", "=", "0"}], ";", "\[IndentingNewLine]", 
            RowBox[{"k", "=", "0"}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
             "generate", " ", "evenly", " ", "spaced", " ", "points", " ", 
              "along", " ", "each", " ", "parabola"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"told", "=", 
             RowBox[{
              RowBox[{"-", "W"}], "-", 
              RowBox[{"2", "*", "delta"}]}]}], ";", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"While", "[", 
             RowBox[{
              RowBox[{"x", "<", "W"}], ",", 
              RowBox[{
               RowBox[{"off", "=", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"EvenQ", "[", "i", "]"}], ",", "0", ",", "0.5"}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"t", "=", 
                RowBox[{"told", "+", 
                 RowBox[{"RandomVariate", "[", 
                  RowBox[{"NormalDistribution", "[", 
                   RowBox[{"mu", ",", "sigma"}], "]"}], "]"}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"told", "=", "t"}], ";", " ", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"x", "=", 
                RowBox[{"NMdist", "[", 
                 RowBox[{"t", ",", "W", ",", "H"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"y", "=", 
                RowBox[{"parab", "[", 
                 RowBox[{"W", ",", "H", ",", "x"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"k", "++"}], ";", "\[IndentingNewLine]", 
               RowBox[{"nextpoint", "=", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "y"}], "}"}]}], ";", "\[IndentingNewLine]",
                "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"y", ">", "0"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", 
                  RowBox[{
                   RowBox[{"dPrint", "[", 
                    RowBox[{
                    "\"\<t: \>\"", ",", " ", "t", ",", " ", 
                    "\"\<nextpoint: \>\"", ",", " ", "nextpoint"}], "]"}], 
                   ";"}], " ", "*)"}], "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"pts", "=", 
                   RowBox[{"Append", "[", 
                    RowBox[{"pts", ",", "nextpoint"}], "]"}]}], ";"}]}], 
                "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"OddQ", "[", "i", "]"}], "\[Or]", 
                    RowBox[{"(", 
                    RowBox[{"x", ">", "0"}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"dPrint", "[", 
                    RowBox[{"\"\<rightpoint: \>\"", ",", " ", "rightpoint"}], 
                    "]"}], ";", " ", 
                    RowBox[{"pts", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"pts", ",", "leftpoint"}], "]"}]}]}]}], "]"}], 
                  ";"}], " ", "*)"}], "\[IndentingNewLine]", "]"}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"dPrint", "[", 
          RowBox[{"gcurves", "=", " ", 
           RowBox[{"Show", "[", 
            RowBox[{"g", ",", 
             RowBox[{"Graphics", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"PointSize", "[", ".02", "]"}], ",", 
                RowBox[{"Point", "[", "pts", "]"}]}], "}"}], "]"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "width"}], "/", "2"}], "-", 
                   RowBox[{"delta", "/", "2"}]}], ",", " ", 
                  RowBox[{
                   RowBox[{"width", "/", "2"}], "+", 
                   RowBox[{"delta", "/", "2"}]}]}], "}"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "delta"}], "/", "2"}], ",", " ", 
                  RowBox[{"height", "+", 
                   RowBox[{"delta", "/", "2"}]}]}], "}"}]}], "}"}]}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "300"}], ",", 
             RowBox[{"AspectRatio", "\[Rule]", " ", 
              RowBox[{"height", "/", "width"}]}]}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "add", " ", "a", " ", "layer", " ", "of", " ", "dummy", " ", 
           "cells", " ", "on", " ", "the", " ", "bottom", " ", "of", " ", 
           "the", " ", "meristem"}], "*)"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"pts", "=", 
          RowBox[{"Union", "[", "pts", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"n", "=", 
          RowBox[{"Length", "[", "pts", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"dummyCells", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "delta"}], "*", ".5"}], "+", 
               RowBox[{"RandomReal", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "delta"}], "/", "10"}], ",", 
                  RowBox[{"delta", "/", "10"}]}], "}"}], "]"}]}]}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"-", "H"}], ",", "H", ",", "delta"}], "}"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"dPrint", "[", 
          RowBox[{"\"\<dummyCells for Voronoi Bounding: \>\"", ",", " ", 
           RowBox[{"Show", "[", 
            RowBox[{"Graphics", "[", 
             RowBox[{"Point", "[", "dummyCells", "]"}], "]"}], "]"}]}], "]"}],
          ";", " ", "\[IndentingNewLine]", 
         RowBox[{"pts", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"pts", ",", "dummyCells"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"n1", "=", 
          RowBox[{"Length", "[", "pts", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"dPrint", "[", 
          RowBox[{"{", 
           RowBox[{"n", ",", "n1"}], "}"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"generate", " ", "Voronoi", " ", "of", " ", "points"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"PPoints", ",", " ", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Points: \>\"", ",", "pts"}], "]"}]}], "]"}], ";"}]}],
        " ", "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"q", "=", 
       RowBox[{"BoundedCellVoronoi", "[", "pts", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<bounded: \>\"", ",", 
        RowBox[{"ShowTissue", "[", 
         RowBox[{"q", ",", 
          RowBox[{"\"\<CellNumbers\>\"", "\[Rule]", "True"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"DoEdgeCheck", "[", 
       RowBox[{"q", ",", " ", "\"\<Voronoi: \>\""}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"smoothe", " ", "voronoi", " ", "layer"}], ",", " ", 
        RowBox[{"but", " ", "not", " ", "the", " ", "corners"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"leftmost", ",", " ", "rightmost", ",", " ", "bc"}], "}"}], 
        ",", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"leftmost", ",", " ", "rightmost", ",", "bc"}], "}"}], "=",
           " ", 
          RowBox[{"BottomCellsExcludingCorners", "[", 
           RowBox[{"q", ",", "delta"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"dPrint", "[", 
          RowBox[{
          "\"\<leftmost: \>\"", ",", " ", "leftmost", ",", " ", 
           "\"\< rightmost: \>\"", ",", " ", "rightmost", ",", " ", 
           "\"\< bc: \>\"", ",", " ", "bc"}], "]"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"q", "=", 
          RowBox[{"SmootheCells", "[", 
           RowBox[{"q", ",", "bc"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"DoEdgeCheck", "[", 
          RowBox[{"q", ",", " ", "\"\<SmootheCells (after Voronoi): \>\""}], 
          "]"}], ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}],
       ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<smoothed: \>\"", ",", 
        RowBox[{"ShowTissue", "[", 
         RowBox[{"q", ",", 
          RowBox[{"\"\<CellNumbers\>\"", "\[Rule]", "True"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"q", "=", 
       RowBox[{"SmootheL1OuterEdge", "[", 
        RowBox[{"q", ",", "delta", ",", "height", ",", " ", "width"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"DoEdgeCheck", "[", 
       RowBox[{"q", ",", " ", "\"\<SmootheL1OuterEdge: \>\""}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<L1 Outer smoothed: \>\"", ",", 
        RowBox[{"ShowTissue", "[", 
         RowBox[{"q", ",", 
          RowBox[{"\"\<CellNumbers\>\"", "\[Rule]", "True"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "remove", " ", "the", " ", "dummy", " ", "layer", " ", "on", " ", 
         "the", " ", "bottom"}], "-", 
        RowBox[{
        "Voronoi", " ", "might", " ", "have", " ", "changed", " ", 
         "indices"}]}], "*)"}], 
      RowBox[{"bottomlayer", "=", 
       RowBox[{"Pick", "[", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"NTissueCells", "[", "q", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "<", 
             RowBox[{
              RowBox[{"-", "delta"}], "/", "4."}]}], ")"}], "&"}], "/@", 
          RowBox[{"Centroid", "[", "q", "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", " ", 
      RowBox[{"q", "=", 
       RowBox[{"RemoveCell", "[", 
        RowBox[{"q", ",", "bottomlayer"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"DoEdgeCheck", "[", 
       RowBox[{"q", ",", " ", "\"\<Remove Cells on Bottom Layer: \>\""}], 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<pruned: \>\"", ",", 
        RowBox[{"ShowTissue", "[", 
         RowBox[{"q", ",", 
          RowBox[{"\"\<CellNumbers\>\"", "\[Rule]", "True"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "300"}], ",", 
          RowBox[{"Frame", "\[Rule]", "True"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"smoothe", " ", "bottom", " ", "layer"}], ",", " ", 
        RowBox[{"but", " ", "not", " ", "the", " ", "corners"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"bc", ",", " ", "leftmost", ",", " ", "rightmost"}], "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"leftmost", ",", " ", "rightmost", ",", "bc"}], "}"}], "=",
           " ", 
          RowBox[{"BottomCellsExcludingCorners", "[", 
           RowBox[{"q", ",", " ", "delta"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"dPrint", "[", 
          RowBox[{
          "\"\<leftmost: \>\"", ",", " ", "leftmost", ",", " ", 
           "\"\< rightmost: \>\"", ",", " ", "rightmost", ",", " ", 
           "\"\< bc: \>\"", ",", " ", "bc"}], "]"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"q1", "=", 
          RowBox[{"SmootheCells", "[", 
           RowBox[{"q", ",", "bc"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"q", "=", "q1"}], ";", "\[IndentingNewLine]", 
         RowBox[{"DoEdgeCheck", "[", 
          RowBox[{"q", ",", " ", "\"\<SmoothCells (bottom bottom): \>\""}], 
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"dPrint", "[", 
          RowBox[{"\"\<Smoothed (bottom excl. corners: \>\"", ",", " ", 
           RowBox[{"ShowTissue", "[", "q", "]"}]}], "]"}], ";", " ", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Now", " ", "check", " ", "for", " ", "extra", " ", "vertices", " ",
            "in", " ", "bottom", " ", "corrner", " ", 
           RowBox[{"cells", ".", " ", "There"}], " ", "is", " ", "unlikely", 
           " ", "to", " ", "be", " ", "more", " ", "than", " ", "one", " ", 
           "per", " ", "cell"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"dPrint", "[", 
          RowBox[{"\"\<Before fixing left: \>\"", ",", " ", 
           RowBox[{"ShowTissue", "[", 
            RowBox[{"q", ",", " ", 
             RowBox[{"\"\<EdgeNumbers\>\"", "\[Rule]", " ", "True"}], ",", 
             " ", 
             RowBox[{"\"\<VertexNumbers\>\"", "\[Rule]", " ", "True"}], ",", 
             " ", 
             RowBox[{"ImageSize", "\[Rule]", " ", "800"}], ",", " ", 
             RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", " ", 
             RowBox[{"AxesOrigin", "\[Rule]", " ", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], ",", " ", 
             RowBox[{"Axes", "\[Rule]", " ", "True"}]}], "]"}]}], "]"}], ";", 
         " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"dPrint", "[", 
          RowBox[{
          "\"\<leftmost: \>\"", ",", " ", "leftmost", ",", " ", 
           "\"\< rightmost: \>\"", ",", " ", "rightmost"}], "]"}], ";", " ", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"q1", "=", 
          RowBox[{"RemoveExtraBottomVertices", "[", 
           RowBox[{"q", ",", "  ", "leftmost"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"q", "=", "q1"}], ";", "\[IndentingNewLine]", 
         RowBox[{"DoEdgeCheck", "[", 
          RowBox[{
          "q", ",", " ", "\"\<Remove extra bottom vertices (left): \>\""}], 
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"dPrint", "[", 
          RowBox[{"\"\<Before fixing Right: \>\"", ",", " ", 
           RowBox[{"ShowTissue", "[", 
            RowBox[{"q", ",", " ", 
             RowBox[{"\"\<EdgeNumbers\>\"", "\[Rule]", " ", "True"}], ",", 
             " ", 
             RowBox[{"\"\<VertexNumbers\>\"", "\[Rule]", " ", "True"}], ",", 
             " ", 
             RowBox[{"ImageSize", "\[Rule]", " ", "800"}], ",", " ", 
             RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", " ", 
             RowBox[{"AxesOrigin", "\[Rule]", " ", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], ",", " ", 
             RowBox[{"Axes", "\[Rule]", " ", "True"}]}], "]"}]}], "]"}], ";", 
         " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"q1", "=", 
          RowBox[{"RemoveExtraBottomVertices", "[", 
           RowBox[{"q", ",", " ", "rightmost"}], "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"q", "=", "q1"}], ";", " ", "\[IndentingNewLine]", 
         RowBox[{"DoEdgeCheck", "[", 
          RowBox[{
          "q", ",", " ", "\"\<Remove extra bottom vertices (right): \>\""}], 
          "]"}], ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<smoothed bottom: \>\"", ",", 
        RowBox[{"ShowTissue", "[", 
         RowBox[{"q", ",", 
          RowBox[{"\"\<CellNumbers\>\"", "\[Rule]", "True"}], ",", 
          RowBox[{"\"\<VertexNumbers\>\"", "\[Rule]", " ", "True"}], ",", " ", 
          RowBox[{"ImageSize", "\[Rule]", "300"}], ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", " ", 
          RowBox[{"Axis", "\[Rule]", " ", "True"}], ",", " ", 
          RowBox[{"AxesOrigin", "\[Rule]", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], ",", " ", 
          RowBox[{"ImageSize", "\[Rule]", " ", "300"}]}], "]"}]}], "]"}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", "\"\<PROJECTING BOTTOM VERTICES \>\"", "]"}], 
      ";", " ", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<q: \>\"", ",", " ", 
        RowBox[{"Short", "[", 
         RowBox[{"q", ",", "5"}], "]"}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Project", " ", "vertices", " ", "on", " ", "bottom", " ", "to", " ", 
        "a", " ", "straight", " ", "line"}], "*)"}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"bv", "=", 
         RowBox[{"VerticesOnBottom", "[", "q", "]"}]}], ";"}], "*)"}], 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v", ",", "e", ",", "c"}], "}"}], "=", 
       RowBox[{"q", "/.", 
        RowBox[{"{", 
         RowBox[{"Tissue", "\[Rule]", "List"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"bv", " ", "=", " ", 
       RowBox[{"VerticesOnBottom", "[", "q", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"dPrint", "[", 
         RowBox[{
         "\"\<BV Assigned (faster algorithm): \>\"", ",", " ", "bv", ",", " ", 
          RowBox[{"Show", "[", 
           RowBox[{
            RowBox[{"ShowTissue", "[", "q", "]"}], ",", " ", 
            RowBox[{"Graphics", "[", 
             RowBox[{"{", 
              RowBox[{"Red", ",", " ", 
               RowBox[{"PointSize", "[", ".01", "]"}], ",", " ", 
               RowBox[{"Point", "[", 
                RowBox[{"v", "[", 
                 RowBox[{"[", "bv", "]"}], "]"}], "]"}]}], "}"}], "]"}], ",", 
            " ", 
            RowBox[{"ImageSize", "\[Rule]", " ", "300"}]}], "]"}]}], "]"}], 
        ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"ymin", "=", 
       RowBox[{"Min", "[", 
        RowBox[{"Last", "/@", 
         RowBox[{"v", "[", 
          RowBox[{"[", "bv", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vbv", "=", 
       RowBox[{"v", "[", 
        RowBox[{"[", "bv", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xbv", "=", 
       RowBox[{"First", "/@", "vbv"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vbvnew", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"#", ",", "ymin"}], "}"}], "&"}], "/@", "xbv"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vnew", "=", 
       RowBox[{"ReplacePart", "[", 
        RowBox[{"v", ",", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Rule", ",", 
           RowBox[{"{", 
            RowBox[{"bv", ",", "vbvnew"}], "}"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q", "=", 
       RowBox[{"Tissue", "[", 
        RowBox[{"vnew", ",", "e", ",", "c"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<projected: \>\"", ",", 
        RowBox[{"ShowTissue", "[", 
         RowBox[{"q", ",", 
          RowBox[{"\"\<CellNumbers\>\"", "\[Rule]", "True"}], ",", 
          RowBox[{"\"\<VertexNumbers\>\"", "\[Rule]", " ", "True"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "500"}], ",", 
          RowBox[{"Frame", "\[Rule]", "True"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"SmootheL1L2Interface", "[", 
        RowBox[{"q", ",", "delta", ",", "height", ",", " ", "width"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"q", "=", " ", "q1"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<L1/L2 Interface smoothed out: \>\"", ",", " ", 
        RowBox[{"ShowTissue", "[", 
         RowBox[{"q1", ",", 
          RowBox[{"\"\<CellNumbers\>\"", "\[Rule]", "True"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", " ", "500"}]}], "]"}]}], "]"}], ";",
       " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"SmootheL2L3Interface", "[", 
        RowBox[{"q", ",", "delta", ",", "height", ",", " ", "width"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<L2/L3 Interface smoothed out: \>\"", ",", " ", 
        RowBox[{"ShowTissue", "[", 
         RowBox[{"q1", ",", 
          RowBox[{"\"\<CellNumbers\>\"", "\[Rule]", "True"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", " ", "500"}]}], "]"}]}], "]"}], ";",
       " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"q", "=", " ", "q1"}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"DoEdgeCheck", "[", 
       RowBox[{"q", ",", " ", "\"\<Smoothe L1/L2 interface: \>\""}], "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"q1", " ", "=", " ", 
       RowBox[{"DivideNSigmas", "[", 
        RowBox[{"q", ",", " ", "1.0"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{
       "\"\<Cells with area larger than mu + 1 sigma divided by Errera's \
Rule: \>\"", ",", " ", 
        RowBox[{"ShowTissue", "[", 
         RowBox[{"q1", ",", 
          RowBox[{"\"\<CellNumbers\>\"", "\[Rule]", "True"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", " ", "500"}]}], "]"}]}], "]"}], ";",
       " ", "\[IndentingNewLine]", 
      RowBox[{"q", "=", "q1"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"DoEdgeCheck", "[", 
       RowBox[{"q", ",", " ", "\"\<Divide large cells: \>\""}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"FlattenTopWalls", "[", "q1", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{
       "\"\<Extra Vertices on Outer Wall Removed From Cells: \>\"", ",", " ", 
        
        RowBox[{"ShowTissue", "[", 
         RowBox[{"q1", ",", 
          RowBox[{"\"\<CellNumbers\>\"", "\[Rule]", "True"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", " ", "500"}]}], "]"}]}], "]"}], ";",
       " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"DoEdgeCheck", "[", 
       RowBox[{"q1", ",", " ", "\"\<Flatten top walls: \>\""}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "q1", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.577891285420518*^9, 3.577891286811891*^9}, {
   3.5778914376655188`*^9, 3.5778914578759813`*^9}, {3.5778915821992283`*^9, 
   3.577891588196732*^9}, {3.577892012533671*^9, 3.5778921955015993`*^9}, {
   3.577892288995298*^9, 3.577892289293046*^9}, {3.57789233930828*^9, 
   3.577892340240217*^9}, {3.577892407187314*^9, 3.577892420183732*^9}, {
   3.5778925777204638`*^9, 3.5778925852993383`*^9}, {3.5778927043288107`*^9, 
   3.577892706915827*^9}, {3.577892845769229*^9, 3.577892848652132*^9}, {
   3.577893149429266*^9, 3.5778932061511593`*^9}, {3.577893648897249*^9, 
   3.577893650906703*^9}, {3.577893752054113*^9, 3.577893780841443*^9}, {
   3.577893951138441*^9, 3.577893951878826*^9}, {3.577893998369519*^9, 
   3.577894001628661*^9}, {3.5778942391932487`*^9, 3.577894325530662*^9}, 
   3.577894360173399*^9, {3.577894400043173*^9, 3.577894506574092*^9}, 
   3.577894675582347*^9, {3.577894853772262*^9, 3.577894938161149*^9}, {
   3.5778950021165037`*^9, 3.577895017461638*^9}, {3.577895110486846*^9, 
   3.577895114161579*^9}, {3.577895170368072*^9, 3.5778951737128773`*^9}, {
   3.57789520559941*^9, 3.5778952136804743`*^9}, {3.577895244868801*^9, 
   3.5778952667046022`*^9}, {3.5778953340917664`*^9, 3.577895443929069*^9}, 
   3.5778955127735243`*^9, {3.577895543691773*^9, 3.577895746195034*^9}, {
   3.577895799177289*^9, 3.577895902087154*^9}, {3.577895991718495*^9, 
   3.577896012705117*^9}, 3.577896058115631*^9, {3.577896282172421*^9, 
   3.5778963322889967`*^9}, {3.5778964671305943`*^9, 3.577896604532981*^9}, {
   3.5778966815709057`*^9, 3.5778967250125103`*^9}, {3.5778967683149023`*^9, 
   3.577896839958355*^9}, {3.5778969917634983`*^9, 3.577897003461594*^9}, {
   3.5778972171945343`*^9, 3.577897222394053*^9}, {3.577897445614479*^9, 
   3.5778975900545073`*^9}, {3.577897639699678*^9, 3.577897657773777*^9}, {
   3.5778978537217817`*^9, 3.57789787647928*^9}, {3.57790692069388*^9, 
   3.577906939208437*^9}, {3.577907070218914*^9, 3.57790707435598*^9}, {
   3.577907161489993*^9, 3.5779071667047157`*^9}, {3.5779072672413816`*^9, 
   3.577907272041234*^9}, {3.577907305390646*^9, 3.5779074132265167`*^9}, {
   3.577907474385325*^9, 3.5779076076805563`*^9}, {3.577907640611713*^9, 
   3.577907664574421*^9}, {3.5779077866640873`*^9, 3.577907806526031*^9}, {
   3.577907846846344*^9, 3.577907849630863*^9}, 3.5779079011227083`*^9, {
   3.577908002116856*^9, 3.577908103382321*^9}, {3.577908241514241*^9, 
   3.577908246320881*^9}, {3.57790850077597*^9, 3.57790850267842*^9}, {
   3.5779086284456167`*^9, 3.577908681716848*^9}, {3.577908728014759*^9, 
   3.577908741432168*^9}, {3.577908885911324*^9, 3.577908914401338*^9}, {
   3.5779089866074877`*^9, 3.577909024898069*^9}, {3.577909115356708*^9, 
   3.5779091490917263`*^9}, {3.5779092022461853`*^9, 
   3.5779092144858847`*^9}, {3.577909248562477*^9, 3.577909262146167*^9}, {
   3.5779093481380043`*^9, 3.5779093680108128`*^9}, 3.57790939912276*^9, {
   3.577909559934698*^9, 3.577909560582033*^9}, 3.5779096304269743`*^9, {
   3.577909675528802*^9, 3.5779097033184147`*^9}, {3.577909744767724*^9, 
   3.577909760063991*^9}, {3.5779098150161343`*^9, 3.577909815264778*^9}, {
   3.577910225870616*^9, 3.5779102315195103`*^9}, {3.577910355867935*^9, 
   3.577910361488278*^9}, {3.577910459299973*^9, 3.577910471902014*^9}, 
   3.577911224919107*^9, 3.577911731142782*^9, {3.5779771250773153`*^9, 
   3.5779771256119127`*^9}, 3.577977177264583*^9, {3.577977384432845*^9, 
   3.5779774239087133`*^9}, {3.577977494646373*^9, 3.577977511299692*^9}, {
   3.577977567525661*^9, 3.577977576936658*^9}, {3.5779776774458027`*^9, 
   3.5779776979875402`*^9}, {3.577977733115749*^9, 3.577977733958311*^9}, {
   3.577977788256661*^9, 3.577977804356398*^9}, {3.577977849961113*^9, 
   3.577977883452509*^9}, {3.577977921346376*^9, 3.5779779236749277`*^9}, {
   3.577977967795352*^9, 3.5779780150924473`*^9}, {3.5779832038947487`*^9, 
   3.577983248754663*^9}, {3.5779832879651537`*^9, 3.577983334644771*^9}, {
   3.577983523911227*^9, 3.577983524952495*^9}, {3.5779838762863817`*^9, 
   3.5779838940230083`*^9}, {3.577983980473721*^9, 3.577983984230961*^9}, {
   3.577984463076288*^9, 3.577984542127592*^9}, {3.577984596032797*^9, 
   3.577984608161717*^9}, {3.577984639481358*^9, 3.57798465108748*^9}, {
   3.577984707548538*^9, 3.577984729184527*^9}, {3.577985690238728*^9, 
   3.577985729029554*^9}, 3.577985843793745*^9, {3.57798595828362*^9, 
   3.577985968957069*^9}, {3.577986459018962*^9, 3.577986459573501*^9}, {
   3.5779866730503683`*^9, 3.577986673871344*^9}, {3.578077062553146*^9, 
   3.578077115189871*^9}, {3.578077159354865*^9, 3.578077259344182*^9}, {
   3.578077293529698*^9, 3.578077351966961*^9}, {3.578077403948052*^9, 
   3.578077419381233*^9}, {3.578077472724924*^9, 3.5780774770786247`*^9}, {
   3.57807752300007*^9, 3.578077527923738*^9}, {3.578077632935327*^9, 
   3.57807768738159*^9}, {3.578077718692088*^9, 3.578077775826479*^9}, {
   3.578077825553831*^9, 3.5780778674241123`*^9}, {3.578077898625947*^9, 
   3.578078061543298*^9}, {3.578078137207608*^9, 3.578078140216174*^9}, {
   3.578078236921319*^9, 3.5780782416517963`*^9}, {3.578078786840263*^9, 
   3.578078798874351*^9}, {3.5780789583130503`*^9, 3.578079033302885*^9}, {
   3.578079069061832*^9, 3.578079091409727*^9}, {3.578079129691321*^9, 
   3.578079193766343*^9}, {3.578079298047964*^9, 3.578079308164276*^9}, {
   3.578079363643052*^9, 3.578079364413019*^9}, {3.578079397006398*^9, 
   3.578079446517436*^9}, {3.578079544601177*^9, 3.57807954730049*^9}, {
   3.578079885416622*^9, 3.578079886142799*^9}, {3.578079971022093*^9, 
   3.578079974899316*^9}, {3.5780800068988953`*^9, 3.578080051553349*^9}, {
   3.578161659051825*^9, 3.578161713854505*^9}, {3.578517044382174*^9, 
   3.578517051158342*^9}, {3.578518851718717*^9, 3.578518869336835*^9}, {
   3.5785189383089647`*^9, 3.578518956835268*^9}, {3.57851907476091*^9, 
   3.578519076428315*^9}, {3.578575581566124*^9, 3.57857562329666*^9}, {
   3.578575958998046*^9, 3.578576280106889*^9}, {3.578576500508316*^9, 
   3.578576501213258*^9}, {3.578576932400652*^9, 3.578576988255458*^9}, {
   3.578577018652986*^9, 3.578577103064052*^9}, {3.578577265714439*^9, 
   3.578577297368923*^9}, {3.57857732782939*^9, 3.578577335902872*^9}, {
   3.578577727773183*^9, 3.5785777288650503`*^9}, {3.578579831035809*^9, 
   3.5785798318290453`*^9}, {3.5785799741700907`*^9, 3.578579974931711*^9}, {
   3.578580007143732*^9, 3.57858000777675*^9}, {3.578580192081851*^9, 
   3.57858019250631*^9}, {3.578580564998019*^9, 3.578580572663232*^9}, {
   3.578580704837985*^9, 3.578580705180521*^9}, {3.57858760225212*^9, 
   3.578587639419909*^9}, {3.578587695401993*^9, 
   3.578587695635034*^9}},ExpressionUUID->"31d9b82c-5a47-4078-a247-\
f20e619fe68b"]
}, Closed]],

Cell[CellGroupData[{

Cell["RemoveExtraBottomVertices", "Subsubsection",
 CellChangeTimes->{{3.5779115131455173`*^9, 
  3.577911517471815*^9}},ExpressionUUID->"969cf9b9-1c07-435f-b1b7-\
c4c21cab7ed1"],

Cell["\<\
given Tissue q and cell number CellIndex, returns a new tissue with all the \
bottom edges merged into a single edge. This may perform some flattening as a \
result.
Bottom = y coordinate < 0
left, right defined by min, max of x-coordinate on bottom.
This will only work for cells where the bottom should be very near and just \
below the x-axis\
\>", "Text",
 CellChangeTimes->{{3.577911528505526*^9, 
  3.577911635688719*^9}},ExpressionUUID->"5ca90b60-4dd3-40ae-8408-\
4c37b1531749"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RemoveExtraBottomVertices", "[", 
   RowBox[{"q_", ",", "  ", "CellIndex_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "xvals", ",", "left", ",", "right", ",", "extraVertices", ",", "edges", 
      ",", "edgepairs", ",", " ", "qnew", ",", " ", "qnew1", ",", "e", ",", 
      "en", ",", " ", "cv", ",", " ", "cvb", ",", " ", "edgeOnBottom", ",", 
      " ", "enb", ",", " ", "dPrint", ",", " ", 
      RowBox[{"dbg", "=", "False"}], ",", "v", ",", "c", ",", "bv", ",", " ", 
      "cvn"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"dPrint", "[", "u___", "]"}], ":=", 
      RowBox[{"If", "[", 
       RowBox[{"dbg", ",", " ", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<RemoveExtraBottomVertices (\>\"", ",", "CellIndex", ",", 
          "\"\<):\>\"", ",", " ", "u"}], "]"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"v", ",", "e", ",", "c"}], "}"}], "=", 
      RowBox[{"q", "/.", 
       RowBox[{"{", 
        RowBox[{"Tissue", "\[Rule]", "List"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"cvn", " ", "=", " ", 
      RowBox[{"CellVertexNumbers", "[", "q", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"bv", "=", 
        RowBox[{"Pick", "[", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"NTissueVertices", "[", "q", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "<", "0"}], ")"}], "&"}], "/@",
            "v"}]}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"bv", " ", "=", " ", 
      RowBox[{"VerticesOnBottom", "[", "q", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<fixing Cell: \>\"", ",", " ", "CellIndex"}], "]"}], ";", 
     " ", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<Bottom Vertices: \>\"", ",", " ", "bv"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"cv", " ", "=", " ", 
      RowBox[{"cvn", "[", 
       RowBox[{"[", "CellIndex", "]"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"cvb", " ", "=", " ", 
      RowBox[{"Intersection", "[", 
       RowBox[{"cv", ",", " ", "bv"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{
      "\"\<cell vertices: \>\"", ",", " ", "cv", ",", " ", 
       "\"\< on bottom: \>\"", ",", " ", "cvb"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"en", "=", 
      RowBox[{
       RowBox[{"TissueCells", "[", "q", "]"}], "[", 
       RowBox[{"[", "CellIndex", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<cell edges: \>\"", ",", " ", "en"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"edgeOnBottom", "[", "k_", "]"}], ":=", 
      RowBox[{"And", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"bv", ",", " ", 
          RowBox[{"e", "[", 
           RowBox[{"[", 
            RowBox[{"k", ",", "1"}], "]"}], "]"}]}], "]"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"MemberQ", "[", 
         RowBox[{"bv", ",", " ", 
          RowBox[{"e", "[", 
           RowBox[{"[", 
            RowBox[{"k", ",", " ", "2"}], "]"}], "]"}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"enb", " ", "=", " ", 
      RowBox[{"Select", "[", 
       RowBox[{"en", ",", " ", 
        RowBox[{
         RowBox[{"edgeOnBottom", "[", "#", "]"}], "&"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<edges On Bottom: \>\"", ",", " ", "enb"}], "]"}], ";", " ",
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"xvals", "=", 
      RowBox[{"First", "/@", 
       RowBox[{"v", "[", 
        RowBox[{"[", "cvb", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<xvals: \>\"", ",", " ", "xvals"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"left", "=", 
      RowBox[{"cvb", "[", 
       RowBox[{"[", 
        RowBox[{"Ordering", "[", 
         RowBox[{"xvals", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<left: \>\"", ",", " ", "left"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"right", "=", 
      RowBox[{"cvb", "[", 
       RowBox[{"[", 
        RowBox[{"Ordering", "[", 
         RowBox[{"xvals", ",", 
          RowBox[{"-", "1"}]}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<right: \>\"", ",", " ", "right"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"extraVertices", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{"cvb", ",", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"left", ",", "right"}], "}"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<extraVertices: \>\"", ",", " ", "extraVertices"}], "]"}], 
     ";", " ", "\[IndentingNewLine]", 
     RowBox[{"edges", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"e", ",", "#"}], "]"}], "&"}], "/@", "extraVertices"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<edges: \>\"", ",", " ", "edges"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"edgepairs", "=", 
      RowBox[{"First", "/@", 
       RowBox[{"Transpose", "/@", "edges"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<edgepairs: \>\"", ",", " ", "edgepairs"}], "]"}], ";", " ",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"qnew1", "=", "q"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "edgepairs", "]"}], ">", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"edges", "=", 
         RowBox[{"First", "[", "edgepairs", "]"}]}], ";", " ", 
        RowBox[{"edgepairs", "=", 
         RowBox[{"Rest", "[", "edgepairs", "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"qnew", "=", "qnew1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"dPrint", "[", 
         RowBox[{"\"\<Merging edges \>\"", ",", " ", 
          RowBox[{"{", "edges", "}"}]}], "]"}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"edges", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"edges", ",", " ", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"en", ",", " ", "#"}], "]"}], "&"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dPrint", "[", 
         RowBox[{"\"\<Merging edges (2)\>\"", ",", " ", 
          RowBox[{"{", "edges", "}"}]}], "]"}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"qnew1", "=", 
         RowBox[{"MergeEdges", "[", 
          RowBox[{"qnew", ",", " ", 
           RowBox[{"Sequence", "@@", "edges"}]}], "]"}]}], ";"}]}], " ", 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<RETURNING: \>\"", ",", " ", 
       RowBox[{"ShowTissue", "[", "qnew1", "]"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", "qnew1"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.577909423371768*^9, 3.577909425980823*^9}, {
  3.5779098249282618`*^9, 3.577909825594046*^9}, {3.577909883430591*^9, 
  3.577909884002462*^9}, {3.577910209882771*^9, 3.577910219602418*^9}, {
  3.577910278060193*^9, 3.5779102790174513`*^9}, {3.577977259348933*^9, 
  3.577977268430564*^9}, {3.577977336672455*^9, 3.577977337383114*^9}, {
  3.577983100312607*^9, 3.57798311472023*^9}, {3.578517987306723*^9, 
  3.5785179878176003`*^9}, {3.578518057693503*^9, 
  3.578518058470417*^9}},ExpressionUUID->"1219eb9c-14b0-4358-966c-\
a8120c7b72c2"]
}, Closed]],

Cell[CellGroupData[{

Cell["BottomCellsExcludingCorners", "Subsubsection",
 CellChangeTimes->{{3.5779113198104753`*^9, 
  3.5779113238736353`*^9}},ExpressionUUID->"ec1c607d-2a3b-4667-be10-\
3320ef295543"],

Cell["\<\
{left, right, BC}
BC = list of cells on bottom except right and left
left and right are right and left cell numbres
Bottom is defined as \[OpenCurlyDoubleQuote]has a vertex with y < delta/2\
\[CloseCurlyDoubleQuote]
leftmost and rightmost use x-coordinate of centroid. 
This only works for tissues where the bottom is very near and just crosses \
the x-axis. \
\>", "Text",
 CellChangeTimes->{{3.5779113267221203`*^9, 3.577911375570045*^9}, {
  3.577911479380228*^9, 3.57791149144121*^9}, {3.577911640338891*^9, 
  3.57791166225637*^9}},ExpressionUUID->"94d09b7e-3136-49d9-a27b-\
40ccab031791"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BottomCellsExcludingCorners", "[", 
   RowBox[{"q_", ",", " ", "delta_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "flags", ",", "bc", ",", "xcoords", ",", "leftmost", ",", "rightmost", 
      ",", "endcells", ",", "v", ",", "e", ",", "c", ",", "bv", ",", "cvn"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cvn", "=", 
      RowBox[{"CellVertexNumbers", "[", "q", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"v", ",", "e", ",", "c"}], "}"}], "=", 
      RowBox[{"q", "/.", 
       RowBox[{"{", 
        RowBox[{"Tissue", "\[Rule]", "List"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"bv", "=", 
        RowBox[{"Pick", "[", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"NTissueVertices", "[", "q", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "<", 
              RowBox[{"delta", "*", "0.5"}]}], ")"}], "&"}], "/@", "v"}]}], 
         "]"}]}], ";"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"bv", "=", 
      RowBox[{"VerticesOnBottom", "[", "q", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"flags", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"Intersection", "[", 
           RowBox[{"bv", ",", "#"}], "]"}], "]"}], ">", "0"}], "&"}], "/@", 
       "cvn"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"bc", "=", 
      RowBox[{"Pick", "[", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"NTissueCells", "[", "q", "]"}], "]"}], ",", "flags"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"AbortIf", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "bc", "]"}], "<", "1"}], ",", " ", 
       RowBox[{
       "\"\<BottomCellsExcludingCorners: No bottom vertices: delta = \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"InputForm", "[", "delta", "]"}], "]"}]}]}], "]"}], ";", " ",
      "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"determine", " ", "left"}], " ", "&"}], " ", "right", " ", 
        "most", " ", "cells", " ", "based", " ", "on", " ", "x"}], "-", 
       RowBox[{"coordinate", " ", "of", " ", "centroid"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"xcoords", "=", 
      RowBox[{"First", "/@", 
       RowBox[{"Centroid", "[", 
        RowBox[{"q", ",", "bc"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"leftmost", "=", 
      RowBox[{
       RowBox[{"Ordering", "[", "xcoords", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"leftmost", " ", "=", " ", 
      RowBox[{"bc", "[", 
       RowBox[{"[", "leftmost", "]"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"rightmost", "=", 
      RowBox[{
       RowBox[{"Ordering", "[", "xcoords", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rightmost", "=", 
      RowBox[{"bc", "[", 
       RowBox[{"[", "rightmost", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"endcells", "=", 
      RowBox[{"{", 
       RowBox[{"leftmost", ",", "rightmost"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"exclude", " ", "left"}], " ", "&"}], " ", "right"}], "-", 
       RowBox[{"most", " ", "cells", " ", "from", " ", "smoothing"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"bc", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{"bc", ",", "endcells"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "exclude", " ", "cells", " ", "with", " ", "only", " ", "a", " ", 
       "single", " ", "vertex", " ", "on", " ", "boundary", " ", "from", " ", 
       "smoothing"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"leftmost", ",", " ", "rightmost", ",", " ", 
       RowBox[{"Select", "[", 
        RowBox[{"bc", ",", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"CellsOnBoundary", "[", "q", "]"}], ",", "#"}], "]"}], 
          "&"}]}], "]"}]}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.577909650201264*^9, 3.577909655949093*^9}, {
  3.577910376880254*^9, 3.5779103879908*^9}, {3.577911396501211*^9, 
  3.5779114494436617`*^9}, {3.5779830261401663`*^9, 
  3.5779830573208523`*^9}},ExpressionUUID->"bf1d0847-7e37-4645-9d12-\
217a3cc8b96a"]
}, Closed]],

Cell[CellGroupData[{

Cell["SmootheL1OuterEdge", "Subsubsection",
 CellChangeTimes->{{3.577983667718915*^9, 
  3.577983679175559*^9}},ExpressionUUID->"fa4c338d-7e3f-4f89-ad19-\
d00ba9a6f556"],

Cell["\<\
This smoothes out the rough contour left by the Vornoni bounding box on the \
outer cell wall by projecting vertices to the appropriate parabola.

Should also remove outer corners in this function\
\>", "Text",
 CellChangeTimes->{{3.578083836757416*^9, 
  3.5780838900526133`*^9}},ExpressionUUID->"8491f30c-d522-4b36-8d36-\
de58adbbe9cf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmootheL1OuterEdge", "[", 
   RowBox[{"q_", ",", "delta_", ",", "height_", ",", " ", 
    RowBox[{"width_:", "-", "1"}], ",", " ", 
    RowBox[{"dbg_:", "False"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "v", ",", "e", ",", "c", ",", "W", ",", "f", ",", "g", ",", "H", ",", 
      "newvxy", ",", "X", ",", "Y", ",", "vmap", ",", "vnew", ",", "Tnew", 
      ",", "dPrint", ",", " ", "vtop"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"dPrint", "[", "u___", "]"}], ":=", 
      RowBox[{"If", "[", 
       RowBox[{"dbg", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<SmootheL1OuterEdge: \>\"", ",", "u"}], "]"}]}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"H", "=", 
      RowBox[{"height", "+", 
       RowBox[{"0.5", "delta"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"width", ">", "0"}], ",", " ", 
       RowBox[{"W", "=", 
        RowBox[{"width", "+", 
         RowBox[{"2", "*", "delta"}]}]}], ",", " ", 
       RowBox[{"W", "=", 
        RowBox[{"2", " ", "H"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"f", "[", "x_", "]"}], ":=", 
      RowBox[{"H", "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"2", " ", 
            RowBox[{"x", "/", "W"}]}], ")"}], "^", "2"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"g", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x_", ",", "y_"}], "}"}], ",", "X"}], "]"}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x", "-", "X"}], ")"}], "^", "2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"y", "-", 
          RowBox[{"f", "[", "X", "]"}]}], ")"}], "^", "2"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"v", ",", "e", ",", "c"}], "}"}], "=", 
      RowBox[{"q", "/.", 
       RowBox[{"{", 
        RowBox[{"Tissue", "\[Rule]", "List"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"vtop", "=", 
        RowBox[{"Complement", "[", 
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{
            RowBox[{"VerticesOnTop", "[", "q", "]"}], ",", " ", 
            RowBox[{"VerticesOnLeft", "[", "q", "]"}], ",", " ", 
            RowBox[{"VerticesOnRight", "[", "q", "]"}]}], "]"}], ",", " ", 
          RowBox[{"VerticesOnBottom", "[", "q", "]"}]}], "]"}]}], ";"}], 
      "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "The", " ", "following", " ", "could", " ", "give", " ", "a", " ", 
       "false", " ", "positive", " ", "top", " ", 
       RowBox[{"cell", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "Since", " ", "VerticesOnBottom", " ", "uses", " ", "outward", " ", 
        "normal"}], ",", " ", 
       RowBox[{"if", " ", "a", " ", "true", " ", "bottom"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "vertex", " ", "fails", " ", "the", " ", "bottom", " ", "test"}], ",", 
       " ", 
       RowBox[{"e", ".", "g", "."}], ",", " ", 
       RowBox[{
       "it", " ", "is", " ", "shared", " ", "by", " ", "two", " ", 
        "cells"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "and", " ", "is", " ", "below", " ", "the", " ", "centroid", " ", "of", 
       " ", "one", " ", "but", " ", "not", " ", "the", " ", "other", " ", 
       "then", " ", "it", " ", "will"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"not", " ", "be", " ", "marked", " ", "as", " ", "bottom"}], 
       ",", " ", 
       RowBox[{
       "and", " ", "hence", " ", "will", " ", "not", " ", "excluded"}]}], " ",
       "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"as", " ", "a", " ", "bottom", " ", "cell"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "This", " ", "is", " ", "the", " ", "reason", " ", "for", " ", "the", 
       " ", "select"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"vtop", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{
        RowBox[{"VerticesOnBoundary", "[", "q", "]"}], ",", " ", 
        RowBox[{"VerticesOnBottom", "[", "q", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"vtop", " ", "=", " ", 
      RowBox[{"Select", "[", 
       RowBox[{"vtop", ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "#", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ">", 
          RowBox[{"0.5", "/", "delta"}]}], "&"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<vtop Vertices: \>\"", ",", " ", "vtop"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<vtop Vertex Coordinates: \>\"", ",", " ", 
       RowBox[{"v", "[", 
        RowBox[{"[", "vtop", "]"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"newvxy", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"FindMinimum", "[", 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"#", ",", "X"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"X", ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", " ", 
          RowBox[{"AccuracyGoal", "\[Rule]", " ", "3"}], ",", " ", 
          RowBox[{"PrecisionGoal", "\[Rule]", " ", "3"}]}], "]"}], "&"}], "/@", 
       RowBox[{"v", "[", 
        RowBox[{"[", "vtop", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"newvxy", "=", 
      RowBox[{"Last", "/@", "newvxy"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"newvxy", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"X", ",", 
           RowBox[{"f", "[", "X", "]"}]}], "}"}], "/.", "#"}], "&"}], "/@", 
       "newvxy"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vmap", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Rule", "[", 
          RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{"vtop", ",", "newvxy"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<mapping: \>\"", ",", " ", "vmap"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"vnew", "=", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{"v", ",", "vmap"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Tnew", "=", 
      RowBox[{"Tissue", "[", 
       RowBox[{"vnew", ",", "e", ",", "c"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"ShowTissue", "[", 
         RowBox[{"q", ",", 
          RowBox[{"\"\<CellNumbers\>\"", "\[Rule]", "True"}], ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"\"\<VertexNumbers\>\"", "\[Rule]", "True"}], ",", 
          RowBox[{"\"\<EdgeNumbers\>\"", "\[Rule]", "True"}]}], "]"}], ",", 
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"f", "[", "x", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{
             RowBox[{"-", "W"}], "/", "2"}], ",", 
            RowBox[{"W", "/", "2"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"Graphics", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"PointSize", "[", ".02", "]"}], ",", "Pink", ",", 
           RowBox[{"Point", "[", 
            RowBox[{"v", "[", 
             RowBox[{"[", "vtop", "]"}], "]"}], "]"}]}], "}"}], "]"}], ",", 
        RowBox[{"Graphics", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"PointSize", "[", ".02", "]"}], ",", "Green", ",", 
           RowBox[{"Point", "[", "newvxy", "]"}]}], "}"}], "]"}], ",", " ", 
        RowBox[{"ImageSize", "\[Rule]", " ", "500"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "Tnew", "]"}], ";"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.577983691777287*^9, 3.577983839172744*^9}, {
  3.577984194331286*^9, 3.5779842365468187`*^9}, {3.577984294914719*^9, 
  3.5779842970878963`*^9}, {3.5779843479814243`*^9, 3.577984348511248*^9}, {
  3.57798654389025*^9, 3.57798662410557*^9}, {3.577986656678173*^9, 
  3.577986657217663*^9}, {3.577986762835183*^9, 3.577986799623846*^9}, {
  3.577986854824813*^9, 3.577986855521347*^9}, {3.578517244141876*^9, 
  3.57851724457985*^9}, {3.578517503088779*^9, 3.578517503839959*^9}, {
  3.578581657437805*^9, 3.578581670760447*^9}, {3.578582987255814*^9, 
  3.5785830919407797`*^9}, {3.57858464397392*^9, 
  3.578584729835284*^9}},ExpressionUUID->"7e052f7c-f648-410a-a3aa-\
86c4b7d2d85e"]
}, Closed]],

Cell[CellGroupData[{

Cell["SmootheL1L2Interface, SmootheL2L3Interface", "Subsubsection",
 CellChangeTimes->{{3.57282798361456*^9, 3.572827994716796*^9}, {
  3.578587447157125*^9, 
  3.578587451244184*^9}},ExpressionUUID->"cb2ff323-593b-4c98-97a6-\
348a65580f41"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmootheL1L2Interface", "[", 
   RowBox[{"q_", ",", "delta_", ",", "height_", ",", " ", 
    RowBox[{"width_:", "-", "1"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "v", ",", "e", ",", "c", ",", "L1L2vertices", ",", "W", ",", "f", ",", 
      "g", ",", "H", ",", "newvxy", ",", "X", ",", "Y", ",", "vmap", ",", 
      "vnew", ",", "Tnew", ",", 
      RowBox[{"dbg", "=", "False"}], ",", "dPrint"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"dPrint", "[", "u___", "]"}], ":=", 
      RowBox[{"If", "[", 
       RowBox[{"dbg", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<SmootheL1L2Interface: \>\"", ",", "u"}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"H", "=", 
      RowBox[{"height", "-", 
       RowBox[{"0.5", " ", "delta"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"width", ">", "0"}], ",", " ", 
       RowBox[{"W", "=", "width"}], ",", " ", 
       RowBox[{"W", "=", 
        RowBox[{"2", " ", "H"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"f", "[", "x_", "]"}], ":=", 
      RowBox[{"H", "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"2", " ", 
            RowBox[{"x", "/", "W"}]}], ")"}], "^", "2"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"g", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x_", ",", "y_"}], "}"}], ",", "X"}], "]"}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x", "-", "X"}], ")"}], "^", "2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"y", "-", 
          RowBox[{"f", "[", "X", "]"}]}], ")"}], "^", "2"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"v", ",", "e", ",", "c"}], "}"}], "=", 
      RowBox[{"q", "/.", 
       RowBox[{"{", 
        RowBox[{"Tissue", "\[Rule]", "List"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"L1L2vertices", "=", 
      RowBox[{"FindL1L2Vertices", "[", 
       RowBox[{"q", ",", "delta"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<L1/L2 Vertices: \>\"", ",", " ", "L1L2vertices"}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<L1/L2 Vertex Coordinates: \>\"", ",", " ", 
       RowBox[{"v", "[", 
        RowBox[{"[", "L1L2vertices", "]"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"newvxy", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"FindMinimum", "[", 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"#", ",", "X"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"X", ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", " ", 
          RowBox[{"AccuracyGoal", "\[Rule]", " ", "3"}], ",", " ", 
          RowBox[{"PrecisionGoal", "\[Rule]", " ", "3"}]}], "]"}], "&"}], "/@", 
       RowBox[{"v", "[", 
        RowBox[{"[", "L1L2vertices", "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"newvxy", "=", 
      RowBox[{"Last", "/@", "newvxy"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"newvxy", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"X", ",", 
           RowBox[{"f", "[", "X", "]"}]}], "}"}], "/.", "#"}], "&"}], "/@", 
       "newvxy"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vmap", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Rule", "[", 
          RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{"L1L2vertices", ",", "newvxy"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<mapping: \>\"", ",", " ", "vmap"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"vnew", "=", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{"v", ",", "vmap"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Tnew", "=", 
      RowBox[{"Tissue", "[", 
       RowBox[{"vnew", ",", "e", ",", "c"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"ShowTissue", "[", 
         RowBox[{"q", ",", 
          RowBox[{"\"\<CellNumbers\>\"", "\[Rule]", "True"}], ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"\"\<VertexNumbers\>\"", "\[Rule]", "True"}], ",", 
          RowBox[{"\"\<EdgeNumbers\>\"", "\[Rule]", "True"}]}], "]"}], ",", 
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"f", "[", "x", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{
             RowBox[{"-", "W"}], "/", "2"}], ",", 
            RowBox[{"W", "/", "2"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"Graphics", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"PointSize", "[", ".02", "]"}], ",", "Pink", ",", 
           RowBox[{"Point", "[", 
            RowBox[{"v", "[", 
             RowBox[{"[", "L1L2vertices", "]"}], "]"}], "]"}]}], "}"}], "]"}],
         ",", 
        RowBox[{"Graphics", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"PointSize", "[", ".02", "]"}], ",", "Green", ",", 
           RowBox[{"Point", "[", "newvxy", "]"}]}], "}"}], "]"}], ",", " ", 
        RowBox[{"ImageSize", "\[Rule]", " ", "500"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "Tnew", "]"}], ";"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.572827987515023*^9, 3.5728279875186253`*^9}, {
   3.572828430319903*^9, 3.572828437626672*^9}, {3.572828557026876*^9, 
   3.572828562961053*^9}, {3.572828795142194*^9, 3.5728288991830997`*^9}, {
   3.577893380173604*^9, 3.577893380940147*^9}, {3.5778935269186497`*^9, 
   3.577893577925406*^9}, {3.577893661400282*^9, 3.577893687886897*^9}, {
   3.577893832324847*^9, 3.5778938512361403`*^9}, {3.5778938897472973`*^9, 
   3.5778938905867147`*^9}, {3.5779786122426853`*^9, 3.577978613227017*^9}, {
   3.577978685575457*^9, 3.577978689723055*^9}, 3.577978721115367*^9, {
   3.577986839433401*^9, 3.5779868404888763`*^9}, {3.578587327187024*^9, 
   3.578587359931638*^9}, {3.578587478067935*^9, 3.578587478646613*^9}, {
   3.578588013960491*^9, 
   3.578588014193261*^9}},ExpressionUUID->"a4d37693-c172-4b80-9d54-\
830e535c7ae9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SmootheL2L3Interface", "[", 
   RowBox[{"q_", ",", "delta_", ",", "height_", ",", " ", 
    RowBox[{"width_:", "-", "1"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "v", ",", "e", ",", "c", ",", "L1L2vertices", ",", "W", ",", "f", ",", 
      "g", ",", "H", ",", "newvxy", ",", "X", ",", "Y", ",", "vmap", ",", 
      "vnew", ",", "Tnew", ",", 
      RowBox[{"dbg", "=", "False"}], ",", "dPrint"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"dPrint", "[", "u___", "]"}], ":=", 
      RowBox[{"If", "[", 
       RowBox[{"dbg", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<SmootheL2L3Interface: \>\"", ",", "u"}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"H", "=", 
      RowBox[{"height", "-", 
       RowBox[{"1.5", " ", "delta"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"width", ">", "0"}], ",", " ", 
       RowBox[{"W", "=", 
        RowBox[{"width", "-", 
         RowBox[{"3.0", "*", "delta"}]}]}], ",", " ", 
       RowBox[{"W", "=", 
        RowBox[{"2", " ", "H"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"f", "[", "x_", "]"}], ":=", 
      RowBox[{"H", "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"2", " ", 
            RowBox[{"x", "/", "W"}]}], ")"}], "^", "2"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"g", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x_", ",", "y_"}], "}"}], ",", "X"}], "]"}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x", "-", "X"}], ")"}], "^", "2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"y", "-", 
          RowBox[{"f", "[", "X", "]"}]}], ")"}], "^", "2"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"v", ",", "e", ",", "c"}], "}"}], "=", 
      RowBox[{"q", "/.", 
       RowBox[{"{", 
        RowBox[{"Tissue", "\[Rule]", "List"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"L1L2vertices", "=", 
      RowBox[{"FindL2L3Vertices", "[", 
       RowBox[{"q", ",", "delta"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<L2/L3 Vertices: \>\"", ",", " ", "L1L2vertices"}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<L2/L3 Vertex Coordinates: \>\"", ",", " ", 
       RowBox[{"v", "[", 
        RowBox[{"[", "L1L2vertices", "]"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"newvxy", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"FindMinimum", "[", 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"#", ",", "X"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"X", ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", " ", 
          RowBox[{"AccuracyGoal", "\[Rule]", " ", "3"}], ",", " ", 
          RowBox[{"PrecisionGoal", "\[Rule]", " ", "3"}]}], "]"}], "&"}], "/@", 
       RowBox[{"v", "[", 
        RowBox[{"[", "L1L2vertices", "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"newvxy", "=", 
      RowBox[{"Last", "/@", "newvxy"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"newvxy", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"X", ",", 
           RowBox[{"f", "[", "X", "]"}]}], "}"}], "/.", "#"}], "&"}], "/@", 
       "newvxy"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vmap", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Rule", "[", 
          RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{"L1L2vertices", ",", "newvxy"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<mapping: \>\"", ",", " ", "vmap"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"vnew", "=", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{"v", ",", "vmap"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Tnew", "=", 
      RowBox[{"Tissue", "[", 
       RowBox[{"vnew", ",", "e", ",", "c"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"ShowTissue", "[", 
         RowBox[{"q", ",", 
          RowBox[{"\"\<CellNumbers\>\"", "\[Rule]", "True"}], ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"\"\<VertexNumbers\>\"", "\[Rule]", "True"}], ",", 
          RowBox[{"\"\<EdgeNumbers\>\"", "\[Rule]", "True"}]}], "]"}], ",", 
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"f", "[", "x", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{
             RowBox[{"-", "W"}], "/", "2"}], ",", 
            RowBox[{"W", "/", "2"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"Graphics", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"PointSize", "[", ".02", "]"}], ",", "Pink", ",", 
           RowBox[{"Point", "[", 
            RowBox[{"v", "[", 
             RowBox[{"[", "L1L2vertices", "]"}], "]"}], "]"}]}], "}"}], "]"}],
         ",", 
        RowBox[{"Graphics", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"PointSize", "[", ".02", "]"}], ",", "Green", ",", 
           RowBox[{"Point", "[", "newvxy", "]"}]}], "}"}], "]"}], ",", " ", 
        RowBox[{"ImageSize", "\[Rule]", " ", "500"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "Tnew", "]"}], ";"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.572827987515023*^9, 3.5728279875186253`*^9}, {
   3.572828430319903*^9, 3.572828437626672*^9}, {3.572828557026876*^9, 
   3.572828562961053*^9}, {3.572828795142194*^9, 3.5728288991830997`*^9}, {
   3.577893380173604*^9, 3.577893380940147*^9}, {3.5778935269186497`*^9, 
   3.577893577925406*^9}, {3.577893661400282*^9, 3.577893687886897*^9}, {
   3.577893832324847*^9, 3.5778938512361403`*^9}, {3.5778938897472973`*^9, 
   3.5778938905867147`*^9}, {3.5779786122426853`*^9, 3.577978613227017*^9}, {
   3.577978685575457*^9, 3.577978689723055*^9}, 3.577978721115367*^9, {
   3.577986839433401*^9, 3.5779868404888763`*^9}, {3.578586927902149*^9, 
   3.578586935397347*^9}, {3.578587000928542*^9, 3.578587034409343*^9}, {
   3.5785872241195707`*^9, 3.5785872248922873`*^9}, {3.578587384425994*^9, 
   3.578587427102606*^9}},ExpressionUUID->"9d9d3667-66f1-43f0-a973-\
1ab3c6dbcc73"]
}, Closed]],

Cell[CellGroupData[{

Cell["FlattenTopWalls", "Subsubsection",
 CellChangeTimes->{{3.578161535296015*^9, 
  3.578161537487145*^9}},ExpressionUUID->"b91f99d5-ef5d-4842-afbb-\
bbd2e8c37846"],

Cell["\<\
removes extra vertices on top wall (of L1 layer, excluding end cells) so that \
there is only one external wall per cell\
\>", "Text",
 CellChangeTimes->{{3.578161617406823*^9, 
  3.578161642109836*^9}},ExpressionUUID->"bac055d1-35f3-4486-bd33-\
59ab03a885a2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FlattenTopWalls", "[", "q_Tissue", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"v", ",", "e", ",", "c", ",", "L1", ",", "centroids", ",", 
      RowBox[{"dbg", "=", "False"}], ",", "dPrint", ",", "leftmost", ",", 
      "rightmost", ",", "boundaryCellNumber", ",", "eob", ",", "eobi", ",", 
      "sortedCellEdges", ",", "sortedBoundaryVertices", ",", "ep1", ",", 
      "ep2", ",", "newEdge", ",", "enew", ",", "cnew", ",", "ne", ",", 
      "oldcell", ",", "oldcellpositions", ",", "mappings", ",", "newcell", 
      ",", " ", "T", ",", "bottommost"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"dPrint", "[", "x___", "]"}], ":=", 
      RowBox[{"If", "[", 
       RowBox[{"dbg", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<FlattenTopWalls:\>\"", ",", "x"}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"v", ",", "e", ",", "c"}], "}"}], "=", 
      RowBox[{"q", "/.", 
       RowBox[{"{", 
        RowBox[{"Tissue", "\[Rule]", "List"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"L1", "=", 
      RowBox[{"L1Cells", "[", "q", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"centroids", "=", 
      RowBox[{
       RowBox[{"Centroid", "[", "q", "]"}], "[", 
       RowBox[{"[", "L1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "find", " ", "two", " ", "bottomost", " ", "centroids", " ", "rather", 
       " ", "than", " ", "leftmost", " ", "and", " ", "rightmost", " ", "as", 
       " ", "these", " ", "will", " ", "really", " ", "be", " ", "the", " ", 
       "end", " ", "of", " ", "the", " ", "arc"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"bottommost", "=", 
      RowBox[{"L1", "[", 
       RowBox[{"[", 
        RowBox[{"Ordering", "[", 
         RowBox[{
          RowBox[{"Last", "/@", "centroids"}], ",", "2"}], "]"}], "]"}], 
       "]"}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"rightmost", "=", 
        RowBox[{"L1", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"Ordering", "[", 
            RowBox[{"centroids", ",", 
             RowBox[{"-", "1"}]}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"leftmost", "=", 
        RowBox[{"L1", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"Ordering", "[", 
            RowBox[{"centroids", ",", "1"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"leftmost", ",", "rightmost"}], "}"}], "=", "bottommost"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Centroid", "[", 
          RowBox[{"q", ",", "leftmost"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ">", 
        RowBox[{
         RowBox[{"Centroid", "[", 
          RowBox[{"q", ",", "rightmost"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", "temp", "}"}], ",", " ", 
         RowBox[{
          RowBox[{"temp", "=", "leftmost"}], ";", " ", 
          RowBox[{"leftmost", "=", "rightmost"}], ";", " ", 
          RowBox[{"rightmost", "=", "temp"}], ";"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<leftmost, rightmost: \>\"", ",", " ", 
       RowBox[{"{", 
        RowBox[{"leftmost", ",", "rightmost"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"L1", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{"L1", ",", 
        RowBox[{"{", 
         RowBox[{"leftmost", ",", "rightmost"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<L1 {excluding end cells): \>\"", ",", "L1"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"eob", "=", 
      RowBox[{"EdgesOnBoundary", "[", "q", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ne", "=", 
      RowBox[{"Length", "[", "e", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"cnew", "=", "c"}], ";", "\[IndentingNewLine]", 
     RowBox[{"enew", "=", "e"}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "L1", "]"}], ">", "0"}], ",", 
       RowBox[{
        RowBox[{"boundaryCellNumber", "=", 
         RowBox[{"First", "[", "L1", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"L1", "=", 
         RowBox[{"Rest", "[", "L1", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"eobi", "=", 
         RowBox[{"Intersection", "[", 
          RowBox[{
           RowBox[{"c", "[", 
            RowBox[{"[", "boundaryCellNumber", "]"}], "]"}], ",", "eob"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"sortedCellEdges", "=", 
         RowBox[{"SortCellEdges", "[", 
          RowBox[{"eobi", ",", "e"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"sortedBoundaryVertices", "=", 
         RowBox[{"\"\<Vertices\>\"", "/.", "sortedCellEdges"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ep1", "=", 
         RowBox[{"First", "[", "sortedBoundaryVertices", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ep2", "=", 
         RowBox[{"Last", "[", "sortedBoundaryVertices", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"newEdge", "=", 
         RowBox[{"{", 
          RowBox[{"ep1", ",", "ep2"}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dPrint", "[", 
         RowBox[{
         "\"\<Cell \>\"", ",", "boundaryCellNumber", ",", 
          "\"\< has boundary edges \>\"", ",", "eobi", ",", 
          "\"\< vertices: \>\"", ",", "sortedBoundaryVertices", ",", 
          "\"\< newEdge: \>\"", ",", "newEdge"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"enew", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"enew", ",", "newEdge"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ne", "=", 
         RowBox[{"ne", "+", "1"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"oldcell", "=", 
         RowBox[{"c", "[", 
          RowBox[{"[", "boundaryCellNumber", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"oldcellpositions", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{"oldcell", ",", "#"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "&"}], "/@", "eobi"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"mappings", "=", 
         RowBox[{"PadRight", "[", 
          RowBox[{
           RowBox[{"{", "ne", "}"}], ",", 
           RowBox[{"Length", "[", "oldcellpositions", "]"}], ",", "Null"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mappings", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#1", "\[Rule]", "#2"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"oldcellpositions", ",", "mappings"}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"newcell", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"ReplacePart", "[", 
            RowBox[{"oldcell", ",", "mappings"}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{"Null", "\[Rule]", 
             RowBox[{"{", "}"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dPrint", "[", 
         RowBox[{
         "\"\<oldcell: \>\"", ",", "oldcell", ",", "\"\< positions: \>\"", 
          ",", "oldcellpositions", ",", "\"\< mappings: \>\"", ",", 
          "mappings", ",", "\"\< newcell: \>\"", ",", "newcell"}], "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"cnew", "=", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"cnew", ",", 
           RowBox[{"boundaryCellNumber", "\[Rule]", "newcell"}]}], "]"}]}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"T", "=", 
      RowBox[{"Tissue", "[", 
       RowBox[{"v", ",", "enew", ",", "cnew"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Remove", " ", "Unused", " ", "Edges", " ", "From", " ", "the", " ", 
       "Tissue", " ", "Data", " ", "Structure"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"T", "=", 
      RowBox[{"UndangleEdges", "[", "T", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Remove", " ", "Unused", " ", "Verices"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"T", "=", 
      RowBox[{"UndangleVertices", "[", "T", "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5781615395013437`*^9, 3.578161539502054*^9}, {
  3.578161938260376*^9, 3.578161996662784*^9}, {3.578518091405292*^9, 
  3.578518101927925*^9}, {3.5785181695020723`*^9, 3.5785182072681017`*^9}, {
  3.5785182608950453`*^9, 3.5785182858749857`*^9}, {3.5785183479068747`*^9, 
  3.578518356550037*^9}, {3.578518409159042*^9, 3.578518526006353*^9}, {
  3.578518641539054*^9, 3.57851867738867*^9}, {3.578518736300704*^9, 
  3.578518736983877*^9}},ExpressionUUID->"8905f512-0e28-47c2-be78-\
f946ce08b54d"]
}, Closed]],

Cell[CellGroupData[{

Cell["FindL2L3Vertices", "Subsubsection",
 CellChangeTimes->{{3.5785858871588917`*^9, 
  3.578585891182807*^9}},ExpressionUUID->"b4bd828b-4d5f-4508-bd65-\
a04f9cdfb1b6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FindL2L3Vertices", "[", 
    RowBox[{"q_", ",", " ", "delta_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "v", ",", "e", ",", "c", ",", "nc", ",", "vob", ",", "cvn", ",", 
       "l1cells", ",", "l2cells", ",", "l1vn", ",", "l2vn", ",", "l2l3", ",", 
       
       RowBox[{"dbg", "=", "False"}], ",", " ", "dPrint"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"dPrint", "[", "u___", "]"}], ":=", " ", 
       RowBox[{"If", "[", 
        RowBox[{"dbg", ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<FindL2L3Vertices: \>\"", ",", " ", "u"}], "]"}]}], 
        "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v", ",", "e", ",", "c"}], "}"}], "=", 
       RowBox[{"q", "/.", 
        RowBox[{"{", 
         RowBox[{"Tissue", "\[Rule]", "List"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"cvn", "=", 
       RowBox[{"CellVertexNumbers", "[", "q", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nc", "=", 
       RowBox[{"Length", "[", "c", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"all", " ", "boundary", " ", "vertices"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"vob", "=", 
       RowBox[{"VerticesOnBoundary", "[", "q", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"l1cells", "=", 
       RowBox[{"L1Cells", "[", "q", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<l1cells=\>\"", ",", " ", "l1cells"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"l1vn", "=", 
       RowBox[{"Union", "@@", 
        RowBox[{"CellVertexNumbers", "[", 
         RowBox[{"q", ",", "l1cells"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<l1vn=\>\"", ",", " ", "l1vn"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"l2cells", "=", 
       RowBox[{"L2Cells", "[", "q", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<l2cells=\>\"", ",", " ", "l2cells"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"l2vn", "=", 
       RowBox[{"Union", "@@", 
        RowBox[{"CellVertexNumbers", "[", 
         RowBox[{"q", ",", " ", "l2cells"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<l2vn: \>\"", ",", " ", "l2vn"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"l2l3", " ", "=", 
       RowBox[{"Complement", "[", " ", 
        RowBox[{
         RowBox[{"Complement", "[", 
          RowBox[{"l2vn", ",", "l1vn"}], "]"}], ",", "vob"}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FindL2L3Vertices", "[", "x___", "]"}], ":=", " ", 
  "\"\<Huh?\>\""}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5785858960821323`*^9, 3.578585937732627*^9}, {
  3.578585978681951*^9, 3.578586088471918*^9}, {3.578586217368918*^9, 
  3.578586278571888*^9}, {3.578586316150825*^9, 3.578586335731881*^9}, {
  3.5785864080853024`*^9, 3.5785864269896717`*^9}, {3.578586461700324*^9, 
  3.5785866933750067`*^9}, {3.5785867924016037`*^9, 3.5785867977493343`*^9}, {
  3.578586837997019*^9, 3.578586853482278*^9}, {3.578586890859598*^9, 
  3.578586895839302*^9}, {3.57858694330145*^9, 
  3.578586975047243*^9}},ExpressionUUID->"2292553a-32e0-45ea-a25f-\
9523e8d30c68"]
}, Closed]],

Cell[CellGroupData[{

Cell["FindL1L2Vertices", "Subsubsection",
 CellChangeTimes->{{3.572828479842366*^9, 
  3.5728284836411123`*^9}},ExpressionUUID->"068f8672-f7b7-4d42-8787-\
1d3fa016a688"],

Cell["\<\
delta = typical cell diameter

Returns a list of the vertex numbers of vertices on the interface between the \
L1 and L2 layers of the parabolic template (e.g., generated by \
TemplateParabolic)\
\>", "Text",
 CellChangeTimes->{{3.57282993833585*^9, 
  3.572829972648266*^9}},ExpressionUUID->"3efba510-8f7e-4720-a4cf-\
1d78a477ca00"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FindL1L2Vertices", "[", 
   RowBox[{"q_", ",", "delta_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "L1L2vertices", ",", "l1cells", ",", "l1vertices", ",", "bv", ",", "cvn",
       ",", "vob", ",", "nc", ",", "v", ",", "c", ",", "e"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"v", ",", "e", ",", "c"}], "}"}], "=", 
      RowBox[{"q", "/.", 
       RowBox[{"{", 
        RowBox[{"Tissue", "\[Rule]", "List"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"cvn", "=", 
      RowBox[{"CellVertexNumbers", "[", "q", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nc", "=", 
      RowBox[{"Length", "[", "c", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"bottom", " ", "vertices"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"bv", "=", 
      RowBox[{"Pick", "[", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"NTissueVertices", "[", "q", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "<", 
            RowBox[{"delta", "*", "0.5"}]}], ")"}], "&"}], "/@", "v"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"all", " ", "boundary", " ", "vertices"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"vob", "=", 
      RowBox[{"VerticesOnBoundary", "[", "q", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"L1", " ", "outer", " ", "surface", " ", "vertices"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"l1vertices", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"vob", ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "#", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ">", 
          RowBox[{"delta", "/", "2"}]}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"l1cells", "=", 
      RowBox[{"Pick", "[", 
       RowBox[{
        RowBox[{"Range", "[", "nc", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Intersection", "[", 
             RowBox[{"l1vertices", ",", "#"}], "]"}], "]"}], ">", "0"}], 
          "&"}], "/@", "cvn"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"L1L2vertices", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{
        RowBox[{"Complement", "[", 
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{"Join", "@@", 
            RowBox[{"cvn", "[", 
             RowBox[{"[", "l1cells", "]"}], "]"}]}], "]"}], ",", 
          "l1vertices"}], "]"}], ",", "bv"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "L1L2vertices", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5728284866959352`*^9, 3.572828605470334*^9}, {
   3.572828690536271*^9, 3.572828699163539*^9}, 
   3.5728288038550673`*^9},ExpressionUUID->"f4d42a54-31e3-4baf-a904-\
d10acafdba25"]
}, Closed]],

Cell[CellGroupData[{

Cell["FindL1L2edges", "Subsubsection",
 CellChangeTimes->{{3.5728289734076347`*^9, 
  3.5728289801994877`*^9}},ExpressionUUID->"2a7cfe3b-be39-4371-bf32-\
ede4ed43bbee"],

Cell["\<\
for a \[OpenCurlyDoubleQuote]meristem\[CloseCurlyDoubleQuote] template picks \
out all the edges that lie between L1 and L2
delta = defines the \[OpenCurlyDoubleQuote]bottom\[CloseCurlyDoubleQuote]; \
vertices with smaller y values are considered \[OpenCurlyDoubleQuote]on the \
bottom\[CloseCurlyDoubleQuote] - the parabolic template starts for y=0 so \
this selects all vertices between 0 and delta/2. The program asumes that \
delta is \[OpenCurlyDoubleQuote]typical\[CloseCurlyDoubleQuote] cell diameter.\
\>", "Text",
 CellChangeTimes->{{3.5728298186170063`*^9, 
  3.572829928904406*^9}},ExpressionUUID->"d41ae845-0876-4a97-8b20-\
fbdde9762515"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FindL1L2Edges", "[", 
   RowBox[{"q_", ",", "delta_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "L1L2V", ",", "v", ",", "e", ",", "c", ",", "ne", ",", " ", "mostofthem",
       ",", " ", "others", ",", "vnums", ",", "onbot"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "onbot", " ", "is", " ", "true", " ", "if", " ", "one", " ", "vertex", 
       " ", "has", " ", "y"}], "<", 
      RowBox[{
       RowBox[{"delta", "/", "2"}], " ", "and", " ", "the", " ", "other", " ",
        "has", " ", "y"}], " ", ">", " ", 
      RowBox[{"delta", "/", "2"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"onbot", "[", 
       RowBox[{"{", 
        RowBox[{"i_", ",", "j_"}], "}"}], "]"}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "-", 
          RowBox[{"delta", "*", ".5"}]}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"[", 
            RowBox[{"j", ",", "2"}], "]"}], "]"}], "-", 
          RowBox[{"delta", "*", ".5"}]}], ")"}]}], "<", "0"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"L1L2V", "=", 
      RowBox[{"FindL1L2Vertices", "[", 
       RowBox[{"q", ",", "delta"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"v", ",", "e", ",", "c"}], "}"}], "=", 
      RowBox[{"q", "/.", 
       RowBox[{"{", 
        RowBox[{"Tissue", "\[Rule]", " ", "List"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ne", "=", 
      RowBox[{"Length", "[", "e", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "This", " ", "picks", " ", "out", " ", "the", " ", "edges", " ", "that",
        " ", 
       RowBox[{"don", "'"}], "t", " ", "touch", " ", "the", " ", "bottom"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"mostofthem", "=", 
      RowBox[{"Pick", "[", 
       RowBox[{
        RowBox[{"Range", "[", "ne", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Intersection", "[", 
             RowBox[{"L1L2V", ",", "#"}], "]"}], "]"}], "\[Equal]", "2"}], 
          "&"}], "/@", "e"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "also", " ", "figure", " ", "out", " ", "edges", " ", "that", " ", 
       "connect", " ", "with", " ", "bottom", " ", "edge"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"others", "=", 
      RowBox[{"Pick", "[", 
       RowBox[{
        RowBox[{"Range", "[", "ne", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Intersection", "[", 
             RowBox[{"L1L2V", ",", "#"}], "]"}], "]"}], "\[Equal]", "1"}], 
          "&"}], "/@", "e"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vnums", "=", 
      RowBox[{"e", "[", 
       RowBox[{"[", "others", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"others", " ", "=", " ", 
      RowBox[{"Pick", "[", 
       RowBox[{"others", ",", 
        RowBox[{"onbot", "/@", "vnums"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"return", " ", "all", " ", "of", " ", "them"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Join", "[", 
      RowBox[{"mostofthem", ",", " ", "others"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.57282898149125*^9, 3.5728290895553703`*^9}, {
   3.572829121657648*^9, 3.572829201526148*^9}, {3.572829298347432*^9, 
   3.572829324790476*^9}, 3.5728293657515507`*^9, {3.572829542099443*^9, 
   3.572829699232018*^9}, {3.57282979208099*^9, 
   3.572829796594585*^9}},ExpressionUUID->"789890b6-b888-45b7-b2b6-\
af85274a1141"]
}, Closed]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Periodic Boundary Conditions", "Section",
 CellChangeTimes->{{3.4565808541053762`*^9, 
  3.456580861763761*^9}},ExpressionUUID->"e0a0ef6f-fb1a-4278-8f31-\
c32f288c6853"],

Cell[CellGroupData[{

Cell["Rectangularize", "Subsubsection",
 CellChangeTimes->{{3.456851225180582*^9, 
  3.456851227403041*^9}},ExpressionUUID->"286af56f-66f1-4397-bbd1-\
983b2848da24"],

Cell["\<\
This algorithm dies when any of the edges of the original tissue already fall \
on the rectangular bounding box. \
\>", "Text",
 CellChangeTimes->{{3.4568605756462727`*^9, 
  3.4568605919773397`*^9}},ExpressionUUID->"d284af47-d5e6-40da-9f77-\
0a659ca6b4cf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Rectangularize", "[", 
     RowBox[{
      RowBox[{"tis_", "?", "TissueQ"}], ",", " ", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "v", ",", "e", ",", "c", ",", " ", "bv", ",", " ", "corners", ",", " ",
         "method", ",", " ", "debug", ",", " ", "dPrint", ",", " ", "xmin", 
        ",", "ymin", ",", " ", "xmax", ",", " ", "ymax", ",", " ", 
        "projections", ",", " ", "i", ",", " ", "xy", ",", " ", "tnew", ",", 
        " ", "meanarea", ",", " ", "quiet", ",", " ", "verbose", ",", " ", 
        "Sorted", ",", " ", "tissue"}], "}"}], ",", " ", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Sorted", "[", 
         RowBox[{"{", 
          RowBox[{"x_", ",", "y_"}], "}"}], "]"}], ":=", " ", 
        RowBox[{"x", "\[LessEqual]", " ", "y"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "force", " ", "all", " ", "cells", " ", "to", " ", "be", " ", 
         "\"\<sorted\>\""}], " ", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"v", "=", 
        RowBox[{"TissueVertices", "[", "tis", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"c", "=", 
        RowBox[{"TissueCells", "[", "tis", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"e", "=", 
        RowBox[{"TissueEdges", "[", "tis", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"c", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\"\<Edges\>\"", "/.", 
            RowBox[{"SortCellEdges", "[", 
             RowBox[{"#", ",", " ", "e"}], "]"}]}], ")"}], "&"}], "/@", 
         "c"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"tissue", "=", 
        RowBox[{"Tissue", "[", 
         RowBox[{"v", ",", "e", ",", "c"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"quiet", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<Quiet\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"Options", "[", "Rectangularize", "]"}]}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"verbose", "[", "x___", "]"}], ":=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", "quiet"}], ",", " ", 
          RowBox[{"Print", "[", "x", "]"}]}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"verbose", "[", "\"\<Projecting vertices ..\>\"", "]"}], ";", 
       " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"v", "=", 
        RowBox[{"TissueVertices", "[", "tissue", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"bv", "=", 
        RowBox[{"VerticesOnBoundary", "[", "tissue", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"meanarea", " ", "=", " ", 
        RowBox[{"Mean", "[", 
         RowBox[{"areafunction", "[", "tissue", "]"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"identify", " ", "options"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"debug", "=", 
        RowBox[{
         RowBox[{"\"\<Debug\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"Options", "[", "Rectangularize", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dPrint", "[", "x___", "]"}], ":=", " ", 
        RowBox[{"If", "[", 
         RowBox[{"debug", ",", " ", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<Rectangularize: \>\"", ",", " ", "x"}], "]"}]}], 
         "]"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"corners", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<Corners\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"Options", "[", "Rectangularize", "]"}]}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"method", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<Method\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"Options", "[", "Rectangularize", "]"}]}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<{boundary,method}:\>\"", ",", " ", 
         RowBox[{"{", 
          RowBox[{"corners", ",", " ", "method"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "figure", " ", "out", " ", "where", " ", "the", " ", "new", " ", 
         "corners", " ", "are"}], " ", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"corners", "=", 
        RowBox[{"GetCorners", "[", 
         RowBox[{"tissue", ",", " ", "corners"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"corners", ",", " ", "$Failed"}], "]"}], ",", " ", 
         RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"xmin", ",", "ymin"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"xmax", ",", "ymax"}], "}"}]}], "}"}], "=", "corners"}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "find", " ", "out", " ", "where", " ", "the", " ", "projected", " ", 
         "points", " ", "are", " ", "and", " ", "project", " ", "them"}], " ",
         "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"projections", "=", 
        RowBox[{"ProjectVerticesToBoundary", "[", 
         RowBox[{
         "tissue", ",", " ", "method", ",", " ", "corners", ",", " ", 
          "debug"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"projections", ",", " ", "$Failed"}], "]"}], ",", " ", 
         RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "bv", "]"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"xy", "=", 
           RowBox[{"First", "[", "projections", "]"}]}], ";", " ", 
          RowBox[{"projections", "=", 
           RowBox[{"Rest", "[", "projections", "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"i", "=", 
           RowBox[{"First", "[", "bv", "]"}]}], ";", " ", 
          RowBox[{"bv", "=", 
           RowBox[{"Rest", "[", "bv", "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"v", "=", 
           RowBox[{"ReplacePart", "[", 
            RowBox[{"v", ",", " ", 
             RowBox[{"i", "\[Rule]", " ", "xy"}]}], "]"}]}], ";"}]}], " ", 
        "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"c", "=", 
        RowBox[{"TissueCells", "[", "tissue", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"e", "=", 
        RowBox[{"Sort", "/@", 
         RowBox[{"TissueEdges", "[", "tissue", "]"}]}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<Sorted: \>\"", ",", " ", 
         RowBox[{"And", "@@", 
          RowBox[{"(", 
           RowBox[{"Sorted", "/@", "e"}], ")"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"tnew", "=", 
        RowBox[{"Tissue", "[", 
         RowBox[{"v", ",", "e", ",", "c"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"ShowTissue", "[", 
         RowBox[{"tnew", ",", " ", 
          RowBox[{"ImageSize", "\[Rule]", " ", "175"}]}], "]"}], "]"}], ";", 
       " ", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<Sorted: \>\"", ",", " ", 
         RowBox[{"And", "@@", 
          RowBox[{"(", 
           RowBox[{"Sorted", "/@", 
            RowBox[{"TissueEdges", "[", "tnew", "]"}]}], ")"}]}]}], "]"}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"And", "@@", 
           RowBox[{"(", 
            RowBox[{"Sorted", "/@", 
             RowBox[{"TissueEdges", "[", "tnew", "]"}]}], ")"}]}], "]"}], 
         ";"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "the", " ", "corners", " ", "were", " ", "not", " ", "included", " ", 
         "in", " ", "the", " ", "above", " ", "projection"}], " ", "*)"}], 
       "\[IndentingNewLine]", " ", 
       RowBox[{"verbose", "[", "\"\<Adding corners ..\>\"", "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"tnew", " ", "=", " ", 
        RowBox[{"AddCorners", "[", 
         RowBox[{"tnew", ",", " ", "corners"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"tnew", ",", " ", "$Failed"}], "]"}], ",", " ", 
         RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<Sorted: \>\"", ",", " ", 
         RowBox[{"And", "@@", 
          RowBox[{"(", 
           RowBox[{"Sorted", "/@", 
            RowBox[{"TissueEdges", "[", "tnew", "]"}]}], ")"}]}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"ShowTissue", "[", 
         RowBox[{"tnew", ",", " ", 
          RowBox[{"\"\<Vertices\>\"", "\[Rule]", " ", "Red"}], ",", " ", 
          RowBox[{"ImageSize", "\[Rule]", " ", "175"}]}], "]"}], "]"}], ";", 
       " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"remove", " ", "the", " ", "inline", " ", "vertices"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"verbose", "[", "\"\<Merging edges ..\>\"", "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"ilv", " ", "=", " ", 
          RowBox[{"InLineVertices", "[", "tnew", "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"dPrint", "[", 
          RowBox[{"\"\<ilv: \>\"", ",", " ", "ilv"}], "]"}], ";"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", "\"\<Removing inline vertices ..\>\"", "]"}], 
       ";", " ", "\[IndentingNewLine]", 
       RowBox[{"tnew", "=", 
        RowBox[{"RemoveInLineVertices", "[", "tnew", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"ShowTissue", "[", 
         RowBox[{"tnew", ",", " ", 
          RowBox[{"ImageSize", "\[Rule]", " ", "175"}], ",", " ", 
          RowBox[{"\"\<Vertices\>\"", "\[Rule]", " ", "True"}]}], "]"}], 
        "]"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<Sorted: \>\"", ",", " ", 
         RowBox[{"And", "@@", 
          RowBox[{"(", 
           RowBox[{"Sorted", "/@", 
            RowBox[{"TissueEdges", "[", "tnew", "]"}]}], ")"}]}]}], "]"}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"fix", " ", "the", " ", 
         RowBox[{"masses", ":", " ", 
          RowBox[{
          "extended", " ", "cells", " ", "will", " ", "be", " ", "too", " ", 
           "big"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"verbose", "[", "\"\<Regularizing mass ..\>\"", "]"}], ";", 
       " ", "\[IndentingNewLine]", 
       RowBox[{"tnew", " ", "=", "  ", 
        RowBox[{"RegularizeMass", "[", 
         RowBox[{"tnew", ",", " ", "meanarea", ",", " ", "opt"}], "]"}]}], 
       ";", " ", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"tnew", ",", " ", "$Failed"}], "]"}], ",", " ", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<Error Exit: Rectangularize\>\"", "]"}], 
          ";", " ", 
          RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<Sorted: \>\"", ",", " ", 
         RowBox[{"And", "@@", 
          RowBox[{"(", 
           RowBox[{"Sorted", "/@", 
            RowBox[{"TissueEdges", "[", "tnew", "]"}]}], ")"}]}]}], "]"}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "tnew", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Rectangularize", "[", "x___", "]"}], ":=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
     "Print", "[", "\"\<Error: Expecting Rectangularize[tissue, options]\>\"",
       "]"}], ";", " ", "$Failed"}], ")"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.456580863112956*^9, 3.456580921342597*^9}, {
   3.4565809574860373`*^9, 3.45658098941184*^9}, {3.456581055687553*^9, 
   3.45658118280619*^9}, {3.456581232675253*^9, 3.456581248868999*^9}, {
   3.4565813765683517`*^9, 3.45658138811385*^9}, {3.45658142498158*^9, 
   3.456581427717578*^9}, {3.4565815134063597`*^9, 3.4565815146538258`*^9}, {
   3.4565817934721737`*^9, 3.45658179639653*^9}, {3.456581891322425*^9, 
   3.456581904993322*^9}, {3.456581944691557*^9, 3.456581945882251*^9}, {
   3.45658219780624*^9, 3.4565821995504313`*^9}, {3.456582261281398*^9, 
   3.4565822772466288`*^9}, {3.456582820786538*^9, 3.456582833504611*^9}, {
   3.456582911589541*^9, 3.456582955404066*^9}, {3.4565830630285463`*^9, 
   3.456583063948086*^9}, {3.4565832187263937`*^9, 3.456583219725787*^9}, {
   3.4565844354105997`*^9, 3.456584459568613*^9}, {3.4565846552231083`*^9, 
   3.456584776340508*^9}, {3.456584907577578*^9, 3.45658495257342*^9}, {
   3.456585019304203*^9, 3.456585122608123*^9}, {3.456586142380539*^9, 
   3.4565861448726683`*^9}, 3.456586271737289*^9, {3.4565920453160048`*^9, 
   3.456592046331543*^9}, {3.456592731301134*^9, 3.456592744759419*^9}, {
   3.4565927814783688`*^9, 3.456592883034026*^9}, {3.456692504000637*^9, 
   3.456692538480955*^9}, {3.456692644268014*^9, 3.456692655496326*^9}, {
   3.456693351337315*^9, 3.456693352499322*^9}, {3.4566991008166933`*^9, 
   3.4566991015759087`*^9}, {3.456699693624309*^9, 3.456699698062181*^9}, {
   3.456699741842845*^9, 3.456699909122981*^9}, {3.456849617496757*^9, 
   3.456849619266839*^9}, {3.456851239389773*^9, 3.456851240456168*^9}, {
   3.456855350464376*^9, 3.4568553510712748`*^9}, {3.4568554087047853`*^9, 
   3.4568554098398447`*^9}, {3.456856220669881*^9, 3.456856322777493*^9}, {
   3.456856369619231*^9, 3.4568563773633347`*^9}, {3.456856429784095*^9, 
   3.456856442991334*^9}, {3.456856713976927*^9, 3.4568567477896976`*^9}, 
   3.4568567780635147`*^9, {3.456856869980755*^9, 3.456856907949758*^9}, {
   3.456857135574278*^9, 3.4568571373632917`*^9}, {3.457101905956032*^9, 
   3.457101925053028*^9}, {3.45710395668151*^9, 3.45710400514785*^9}, {
   3.457106131827908*^9, 3.4571062394067173`*^9}, {3.457106284543796*^9, 
   3.4571062938785667`*^9}, {3.457106328891078*^9, 3.457106340432603*^9}, {
   3.4572747660509357`*^9, 3.457274814937698*^9}, {3.457460101147954*^9, 
   3.457460148519272*^9}, {3.4574602526212254`*^9, 3.457460301343637*^9}, {
   3.4574616040940228`*^9, 3.4574616489656267`*^9}, {3.459005687908367*^9, 
   3.459005709501593*^9}, {3.4590060612046022`*^9, 3.459006070350692*^9}, {
   3.459006947981385*^9, 3.459006956887547*^9}, {3.4590069972987843`*^9, 
   3.459006998643114*^9}, 
   3.705711510165889*^9},ExpressionUUID->"92efc1fb-8a07-48fd-a043-\
e0ba965d00bf"]
}, Closed]],

Cell[CellGroupData[{

Cell["RegularizeMass", "Subsubsection",
 CellChangeTimes->{{3.45669928917822*^9, 
  3.4566992914444723`*^9}},ExpressionUUID->"b8dea2e4-f020-4f1c-80a9-\
3347e91fc918"],

Cell["\<\
tries to reduce the mass of the extended cells to a more normal size: any \
cell whose mass exceeds the initial average area by 1 sigma and is at least \
big enough so that area/2 > initial-mean-area-2 sigma is split. However, the \
split is not even: the cell is split along a line perpendicular to its major \
axis. 
\
\>", "Text",
 CellChangeTimes->{{3.456772271776342*^9, 3.456772396419422*^9}, {
   3.456857466753557*^9, 3.456857492431184*^9}, {3.45685756075067*^9, 
   3.456857561069269*^9}, 
   3.7057127390980587`*^9},ExpressionUUID->"d733f8ce-fa31-49cc-bc3d-\
7394b84fa3e5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RegularizeMass", "[", 
     RowBox[{
      RowBox[{"tissue_", "?", "TissueQ"}], ",", " ", "area_", ",", " ", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dbg", "=", "False"}], ",", " ", "dPrint", ",", " ", "bc", 
        ",", " ", "bcarea", ",", " ", "bcareas", ",", " ", "sigma", ",", " ", 
        "ic", ",", "icareas", ",", "icarea", ",", "  ", "icsigma", ",", "  ", 
        "c", ",", " ", "nc", ",", "  ", "tosplit", ",", " ", "cvc", ",", " ", 
        "axes", ",", " ", "tnew", ",", " ", "j", ",", " ", "vector", ",", " ",
         "Splittables", ",", " ", "nvstart", ",", " ", "vfinal", ",", 
        "nvfinal", ",", "  ", "rand", ",", " ", "dist", ",", " ", "bv", ",", 
        " ", "v2randomize"}], "}"}], ",", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dbg", "=", 
        RowBox[{
         RowBox[{"\"\<Debug\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<Debug\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";", 
       " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dPrint", "[", "x___", "]"}], ":=", " ", 
        RowBox[{"If", "[", 
         RowBox[{"dbg", ",", " ", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<RegularizeMass: \>\"", ",", " ", "x"}], "]"}]}], 
         "]"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"c", "=", 
        RowBox[{"TissueCells", "[", "tissue", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"save", " ", "this", " ", "for", " ", "later"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"nvstart", "=", 
        RowBox[{"NTissueVertices", "[", "tissue", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"dist", " ", "=", " ", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"Mean", "[", 
          RowBox[{"areafunction", "[", "tissue", "]"}], "]"}], "]"}]}], ";", 
       " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"nc", " ", "=", " ", 
        RowBox[{"Length", "[", "c", "]"}]}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<area: \>\"", ",", " ", "area"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"bc", " ", "=", " ", 
        RowBox[{"CellsOnBoundary", "[", "tissue", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"ic", " ", "=", " ", 
        RowBox[{"Complement", "[", 
         RowBox[{
          RowBox[{"Range", "[", "nc", "]"}], ",", " ", "bc"}], "]"}]}], ";", 
       " ", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "ic", "]"}], "<", "2"}], " ", "\[Or]", " ", 
          
          RowBox[{
           RowBox[{"Length", "[", "bc", "]"}], "<", "2"}]}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Warning: RegularizeMass: interior cells: \>\"", ",", " ", 
            RowBox[{"Length", "[", "ic", "]"}], ",", " ", 
            "\"\< Exterior cells: \>\"", ",", " ", 
            RowBox[{"Length", "[", "bc", "]"}], ",", " ", 
            "\"\< There must be at least 2 in each set. No regularization \
performed.\>\""}], "]"}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "tissue", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"bcareas", " ", "=", " ", 
        RowBox[{"areafunction", "[", 
         RowBox[{"tissue", ",", " ", "bc"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"bcarea", "=", 
        RowBox[{"Mean", "[", "bcareas", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"sigma", "=", 
        RowBox[{"StandardDeviation", "[", "bcareas", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"icareas", " ", "=", " ", 
        RowBox[{"areafunction", "[", 
         RowBox[{"tissue", ",", " ", "ic"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"icarea", " ", "=", " ", 
        RowBox[{"Mean", "[", "icareas", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"icsigma", " ", "=", " ", 
        RowBox[{"StandardDeviation", "[", "icareas", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{
        "\"\<bcarea: \>\"", ",", " ", "bcarea", ",", " ", "\"\< sigma: \>\"", 
         ",", " ", "sigma"}], "]"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{
        "\"\<icarea: \>\"", " ", ",", "icarea", ",", " ", "\"\< sigma: \>\"", 
         ",", " ", "icsigma"}], "]"}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"onesigs", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", ">", 
              RowBox[{"icarea", "+", "icsigma"}]}], ")"}], "&"}], "/@", 
           "bcareas"}]}], ";", " ", "\[IndentingNewLine]", 
         RowBox[{"twosigs", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", ">", 
              RowBox[{"icarea", "+", 
               RowBox[{"2", "*", "icsigma"}]}]}], ")"}], "&"}], "/@", 
           "bcareas"}]}], ";", " ", "\[IndentingNewLine]", 
         RowBox[{"tosplit", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", ">", " ", 
              RowBox[{"2", "*", 
               RowBox[{"(", 
                RowBox[{"icarea", " ", "-", " ", 
                 RowBox[{"2", "*", "icsigma"}]}], ")"}]}]}], ")"}], "&"}], "/@",
            "bcareas"}]}], ";", " ", "\[IndentingNewLine]", 
         RowBox[{"tosplit", " ", "=", " ", 
          RowBox[{"MapThread", "[", 
           RowBox[{"And", ",", " ", 
            RowBox[{"{", 
             RowBox[{"tosplit", ",", " ", "onesigs"}], "}"}]}], "]"}]}], 
         ";"}], " ", "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Splittable", "[", "cellArea_", "]"}], ":=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"cellArea", ">", 
           RowBox[{"icarea", "+", "icsigma"}]}], ")"}], " ", "\[And]", 
         RowBox[{"(", 
          RowBox[{"cellArea", ">", " ", 
           RowBox[{"2", "*", 
            RowBox[{"(", 
             RowBox[{"icarea", " ", "-", " ", 
              RowBox[{"2", "*", "icsigma"}]}], ")"}]}]}], ")"}]}]}], ";", " ",
        "\[IndentingNewLine]", 
       RowBox[{"tosplit", " ", "=", " ", 
        RowBox[{"Splittable", "/@", "bcareas"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"onesigs", "=", 
          RowBox[{"Pick", "[", 
           RowBox[{"bc", ",", "onesigs"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"twosigs", "=", 
          RowBox[{"Pick", "[", 
           RowBox[{"bc", ",", " ", "twosigs"}], "]"}]}], ";"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"tosplit", "=", 
        RowBox[{"Pick", "[", 
         RowBox[{"bc", ",", " ", "tosplit"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"dPrint", "[", 
          RowBox[{
          "\"\<Boundary cells > mean + 1 sigma: \>\"", ",", " ", "onesigs"}], 
          "]"}], ";", " ", "\[IndentingNewLine]", 
         RowBox[{"dPrint", "[", 
          RowBox[{
          "\"\<Boundary cells > mean + 2 sigma: \>\"", ",", " ", "twosigs"}], 
          "]"}], ";"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{
        "\"\<Boundary cells mass/2 > mean - 2sigma: \>\"", ",", " ", 
         "tosplit"}], "]"}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"cvc", "=", 
          RowBox[{
           RowBox[{"CellVertexCoordinates", "[", "tissue", "]"}], "[", 
           RowBox[{"[", "tosplit", "]"}], "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"dPrint", "[", 
          RowBox[{"\"\<cvc: \>\"", ",", " ", "cvc"}], "]"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"axes", " ", "=", " ", 
          RowBox[{"PrimaryAxes", "/@", "cvc"}]}], ";"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "get", " ", "Primary", " ", "axis", " ", "Vector", " ", "of", " ", 
         "each", " ", "cell"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"axes", "  ", "=", " ", 
        RowBox[{"PrimaryAxesVectors", "[", 
         RowBox[{"tissue", ",", " ", "tosplit"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"axes", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
            RowBox[{"Reverse", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
         "axes"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<axes: \>\"", ",", " ", 
         RowBox[{"Short", "[", 
          RowBox[{"axes", ",", " ", "10"}], "]"}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"axes", " ", "=", " ", 
        RowBox[{"Last", "/@", "axes"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<axes: \>\"", ",", " ", 
         RowBox[{"Short", "[", 
          RowBox[{"axes", ",", " ", "10"}], "]"}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"tnew", " ", "=", " ", "tissue"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "tosplit", "]"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"j", "=", 
           RowBox[{"First", "[", "tosplit", "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"vector", " ", "=", " ", 
           RowBox[{"First", "[", "axes", "]"}]}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"tosplit", "=", 
           RowBox[{"Rest", "[", "tosplit", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"axes", " ", "=", " ", 
           RowBox[{"Rest", "[", "axes", "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{
           "\"\<dividing cell \>\"", ",", " ", "j", ",", " ", 
            "\"\< along \>\"", ",", " ", "vector", " ", ",", " ", 
            "\"\< ..\>\""}], "]"}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"tnew", " ", "=", " ", 
           RowBox[{"DivideCell", "[", 
            RowBox[{"tnew", ",", " ", "j", ",", " ", "vector", ",", " ", 
             RowBox[{"\"\<Debug\>\"", "\[Rule]", " ", "dbg"}]}], "]"}]}], ";",
           " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"SameQ", "[", 
             RowBox[{"tnew", ",", " ", "$Failed"}], "]"}], ",", " ", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "Print", "[", "\"\<Error Exit: RegularizeMass\>\"", "]"}], ";", 
             " ", 
             RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"TissueQ", "[", "tnew", "]"}], ",", " ", 
            RowBox[{"dPrint", "[", 
             RowBox[{"ShowTissue", "[", 
              RowBox[{"tnew", ",", 
               RowBox[{"\"\<CellNumbers\>\"", "\[Rule]", " ", "True"}], ",", 
               " ", 
               RowBox[{"ImageSize", "\[Rule]", " ", "200"}]}], "]"}], "]"}]}],
            "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"check", " ", "daughter", " ", "cell", " ", "masses"}], 
           " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "daughters", ",", " ", "areas", ",", " ", "more2split", ",", " ",
               "it", ",", " ", "newaxes"}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"daughters", " ", "=", " ", 
              RowBox[{"{", 
               RowBox[{"j", ",", "  ", 
                RowBox[{"NTissueCells", "[", "tnew", "]"}]}], "}"}]}], ";", 
             " ", "\[IndentingNewLine]", 
             RowBox[{"areas", " ", "=", " ", 
              RowBox[{"areafunction", "[", 
               RowBox[{"tnew", ",", " ", "daughters"}], "]"}]}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"more2split", " ", "=", " ", 
              RowBox[{"Pick", "[", 
               RowBox[{"daughters", ",", " ", 
                RowBox[{"Splittable", "/@", "areas"}]}], "]"}]}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"it", "=", "1"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "more2split", "]"}], ">", "0"}], " ", 
               ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"dPrint", "[", 
                 RowBox[{"\"\<more2split: \>\"", ",", " ", "more2split"}], 
                 "]"}], ";", " ", "\[IndentingNewLine]", 
                RowBox[{"newaxes", "  ", "=", " ", 
                 RowBox[{"PrimaryAxesVectors", "[", 
                  RowBox[{"tnew", ",", " ", "more2split"}], "]"}]}], ";", " ",
                 "\[IndentingNewLine]", 
                RowBox[{"newaxes", " ", "=", 
                 RowBox[{"Last", "/@", 
                  RowBox[{"(", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
                    RowBox[{"Reverse", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
                    "newaxes"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"dPrint", "[", 
                 RowBox[{"\"\<newaxes\>\"", ",", " ", "newaxes"}], "]"}], ";",
                 "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"tosplit", " ", "=", " ", 
                 RowBox[{"Join", "[", 
                  RowBox[{"tosplit", ",", " ", "more2split"}], "]"}]}], ";", 
                "  ", "\[IndentingNewLine]", 
                RowBox[{"axes", " ", "=", " ", 
                 RowBox[{"Join", "[", 
                  RowBox[{"axes", ",", " ", "newaxes"}], "]"}]}], ";"}]}], 
              " ", "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], 
             ";"}]}], " ", "\[IndentingNewLine]", "]"}], ";"}]}], " ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Now", " ", "randomize", " ", "new", " ", "internal", " ", 
         "vertices"}], " ", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"vfinal", " ", "=", " ", 
        RowBox[{"TissueVertices", "[", "tnew", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"nvfinal", "=", 
        RowBox[{"Length", "[", "vfinal", "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"bv", "=", 
        RowBox[{"VerticesOnBoundary", "[", "tnew", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"v2randomize", "=", 
        RowBox[{"Complement", "[", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{
            RowBox[{"nvstart", "+", "1"}], ",", " ", "nvfinal"}], "]"}], ",", 
          " ", "bv"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"rand", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<Randomness\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"Options", "[", "Rectangularize", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<v2randomize: \>\"", ",", " ", "v2randomize"}], "]"}], 
       ";", " ", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<rand = \>\"", ",", " ", "rand"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "vnext", " ", ",", " ", "ev", ",", " ", "e", ",", " ", "maxrand", 
           ",", " ", "vold", ",", " ", "vnew"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"e", "=", 
           RowBox[{"TissueEdges", "[", "tnew", "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"c", "=", 
           RowBox[{"TissueCells", "[", "tnew", "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "v2randomize", "]"}], ">", "0"}], ",", 
            " ", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"vnext", " ", "=", " ", 
              RowBox[{"First", "[", "v2randomize", "]"}]}], ";", " ", 
             RowBox[{"v2randomize", "=", 
              RowBox[{"Rest", "[", "v2randomize", "]"}]}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
              "edge", " ", "numbers", " ", "that", " ", "contain", " ", 
               "vnext"}], " ", "*)"}], "\[IndentingNewLine]", 
             RowBox[{"ev", " ", "=", 
              RowBox[{"First", "/@", " ", 
               RowBox[{"Position", "[", 
                RowBox[{"e", ",", " ", "vnext"}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{"edge", " ", "vertex", " ", "pairs"}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"ev", " ", "=", " ", 
              RowBox[{"e", "[", 
               RowBox[{"[", "ev", "]"}], "]"}]}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{"edge", " ", "lengths"}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"ev", " ", "=", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"vfinal", "[", 
                 RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "ev"}]}], ";", 
             " ", "\[IndentingNewLine]", 
             RowBox[{"ev", " ", "=", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"distance", "@@", "#"}], "&"}], "/@", "ev"}]}], ";", 
             " ", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{"min", " ", "length"}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"dist", " ", "=", " ", 
              RowBox[{"Min", "[", "ev", "]"}]}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"maxrand", " ", "=", " ", 
              RowBox[{"rand", " ", "*", " ", "dist"}]}], ";", " ", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"dPrint", "[", 
              RowBox[{
              "\"\<vnext: \>\"", ",", " ", "vnext", ",", " ", "\"\< ev: \>\"",
                ",", " ", "ev", ",", " ", "\"\< maxrand: \>\"", ",", " ", 
               "maxrand"}], "]"}], ";", "  ", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"vold", " ", "=", " ", 
              RowBox[{"vfinal", "[", 
               RowBox[{"[", "vnext", "]"}], "]"}]}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"vnew", " ", "=", " ", 
              RowBox[{"vold", " ", "+", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"RandomReal", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "maxrand"}], ",", " ", "maxrand"}], "}"}], 
                  "]"}], ",", " ", 
                 RowBox[{"RandomReal", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "maxrand"}], ",", " ", "maxrand"}], "}"}], 
                  "]"}]}], "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
             RowBox[{"dPrint", "[", 
              RowBox[{
              "\"\<vold: \>\"", ",", " ", "vold", ",", " ", "\"\< vnew: \>\"",
                ",", " ", "vnew"}], "]"}], ";", " ", "\[IndentingNewLine]", 
             RowBox[{"vfinal", "=", 
              RowBox[{"ReplacePart", "[", 
               RowBox[{"vfinal", ",", " ", 
                RowBox[{"vnext", " ", "\[Rule]", " ", "vnew"}]}], "]"}]}], 
             ";"}]}], " ", "\[IndentingNewLine]", "]"}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"tnew", " ", "=", " ", 
           RowBox[{"Tissue", "[", 
            RowBox[{"vfinal", ",", " ", "e", ",", " ", "c"}], "]"}]}], 
          ";"}]}], " ", "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "tnew", "]"}], ";"}]}], " ", 
     "\[IndentingNewLine]", "]"}]}], ";"}], " "}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.456592894206128*^9, 3.456592915135421*^9}, {
   3.456699299460355*^9, 3.456699371855679*^9}, {3.456699654429171*^9, 
   3.456699672743547*^9}, {3.456699965915896*^9, 3.456700004631366*^9}, {
   3.456700040339581*^9, 3.4567001404780893`*^9}, {3.456700499678192*^9, 
   3.4567006191223917`*^9}, {3.456700667182795*^9, 3.456700807004911*^9}, {
   3.456700842018008*^9, 3.4567008545446053`*^9}, {3.456700949747222*^9, 
   3.456701046559947*^9}, {3.456701288308*^9, 3.456701316431858*^9}, {
   3.456749351143458*^9, 3.4567493800534286`*^9}, {3.4567505410303926`*^9, 
   3.4567506389710493`*^9}, {3.4567509648126802`*^9, 3.456750973413096*^9}, {
   3.45677258760681*^9, 3.456772700017413*^9}, {3.456772750208486*^9, 
   3.45677278543709*^9}, {3.456772903368319*^9, 3.456772906284821*^9}, {
   3.4567730019767313`*^9, 3.456773014498437*^9}, {3.4567730584822206`*^9, 
   3.456773101158554*^9}, {3.456773464710155*^9, 3.4567734860784473`*^9}, {
   3.456850703716511*^9, 3.456850706638303*^9}, {3.456850820532296*^9, 
   3.456850825963213*^9}, {3.456851172517912*^9, 3.456851173297749*^9}, {
   3.456851310478594*^9, 3.4568513304217997`*^9}, {3.456855356870261*^9, 
   3.456855383600746*^9}, {3.4568563501488657`*^9, 3.456856356987534*^9}, {
   3.456856420163396*^9, 3.4568564231070127`*^9}, {3.4568573018081837`*^9, 
   3.456857372622751*^9}, {3.456857550351577*^9, 3.456857665107935*^9}, {
   3.45685795399128*^9, 3.456858025006691*^9}, {3.45685812864923*^9, 
   3.4568581485996027`*^9}, {3.4568582019301157`*^9, 3.456858202947419*^9}, {
   3.456858272955336*^9, 3.456858460438352*^9}, {3.4568586897728357`*^9, 
   3.456858770217091*^9}, 3.456858816633049*^9, {3.456858860488429*^9, 
   3.456859168814816*^9}, {3.456859210838952*^9, 3.456859217802157*^9}, {
   3.4568592773334*^9, 3.456859355702997*^9}, {3.456859623294318*^9, 
   3.4568596441943283`*^9}, {3.456859725554881*^9, 3.456859954511574*^9}, {
   3.457103365215378*^9, 3.4571033697442827`*^9}, {3.457103436361725*^9, 
   3.457103437079118*^9}, {3.457103901205254*^9, 3.457103922274811*^9}, {
   3.457104011127615*^9, 3.4571040172968493`*^9}, {3.4571050384923277`*^9, 
   3.457105047685614*^9}, {3.457114037403504*^9, 3.4571140378600388`*^9}, 
   3.457274675236332*^9, {3.4572748284196672`*^9, 3.45727501395207*^9}, {
   3.457275088514675*^9, 3.4572751513172827`*^9}, {3.457275209111321*^9, 
   3.457275239900176*^9}, {3.4572753372462273`*^9, 3.45727542037636*^9}, {
   3.4572755155996513`*^9, 3.457275753141515*^9}, {3.4572757905858088`*^9, 
   3.457275968481865*^9}, {3.457276017634014*^9, 3.457276191525957*^9}, {
   3.457276300233859*^9, 3.4572763121615562`*^9}, {3.459007238556239*^9, 
   3.4590073087778378`*^9}, {3.459007578209592*^9, 3.45900769162717*^9}, {
   3.705711513688375*^9, 
   3.70571152662887*^9}},ExpressionUUID->"c4107f26-9477-487d-aba5-\
3c5ec8d61611"]
}, Closed]],

Cell[CellGroupData[{

Cell["RemoveInLineVertices", "Subsubsection",
 CellChangeTimes->{{3.4566926808338757`*^9, 
  3.456692684287856*^9}},ExpressionUUID->"124ef091-a3db-4038-8479-\
81f301869888"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "this", " ", "form", " ", "is", " ", "less", " ", "elegant", " ", "and", 
    " ", "less", " ", "efficient"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"RemoveInLineVertices", "[", 
      RowBox[{"tissue_", "?", "TissueQ"}], "]"}], ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "tnew", ",", "  ", "vnum", ",", " ", "e1", ",", " ", "e2", ",", " ", 
         "ilv", ",", "  ", "dPrint", ",", " ", "i", ",", 
         RowBox[{"imax", " ", "=", " ", "1000"}], ",", "  ", 
         RowBox[{"dbg", "=", "False"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"dPrint", "[", "x___", "]"}], ":=", 
         RowBox[{"If", "[", 
          RowBox[{"dbg", ",", " ", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<RemoveInLineVertices: \>\"", ",", " ", "x"}], 
            "]"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"i", "=", "1"}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"tnew", " ", "=", " ", "tissue"}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"ilv", " ", "=", " ", 
         RowBox[{"InLineVertices", "[", "tnew", "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"dPrint", "[", 
         RowBox[{
          RowBox[{"Length", "[", "ilv", "]"}], ",", " ", 
          "\"\< vertices to remove.\>\""}], "]"}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "ilv", "]"}], ">", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"vnum", ",", " ", 
              RowBox[{"{", 
               RowBox[{"e1", ",", " ", "e2"}], "}"}]}], "}"}], "=", " ", 
            RowBox[{"First", "[", "ilv", "]"}]}], ";", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"dPrint", "[", 
            RowBox[{
            "\"\<vnum = \>\"", ",", " ", "vnum", ",", " ", 
             "\"\< {e1, e2}: \>\"", ",", " ", 
             RowBox[{"{", 
              RowBox[{"e1", ",", " ", "e2"}], "}"}]}], "]"}], ";", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"tnew", " ", "=", " ", 
            RowBox[{"MergeEdges", "[", 
             RowBox[{"tnew", ",", " ", "e1", ",", " ", "e2", ",", " ", 
              RowBox[{"\"\<Undangle\>\"", "\[Rule]", " ", "False"}]}], 
             "]"}]}], ";", " ", "\[IndentingNewLine]", 
           RowBox[{"tnew", " ", "=", " ", 
            RowBox[{"UndangleEdges", "[", "tnew", "]"}]}], ";", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"tnew", "=", 
            RowBox[{"UndangleVertices", "[", "tnew", "]"}]}], ";", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"dbg", ",", " ", 
             RowBox[{"Print", "[", 
              RowBox[{"ShowTissue", "[", 
               RowBox[{"tnew", ",", " ", 
                RowBox[{"Frame", "\[Rule]", " ", "False"}], ",", "  ", 
                RowBox[{"\"\<CellNumbers\>\"", "\[Rule]", " ", "True"}], ",", 
                
                RowBox[{"\"\<VertexNumbers\>\"", "\[Rule]", " ", "True"}], 
                ",", 
                RowBox[{"\"\<EdgeNumbers\>\"", "\[Rule]", " ", "True"}], ",", 
                "  ", 
                RowBox[{"\"\<Vertices\>\"", "\[Rule]", " ", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"PointSize", "[", ".05", "]"}], ",", " ", 
                   "LightBlue"}], "}"}]}], ",", " ", 
                RowBox[{"ImageSize", "\[Rule]", " ", "250"}]}], "]"}], 
              "]"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"ilv", " ", "=", " ", 
            RowBox[{"InLineVertices", "[", "tnew", "]"}]}], ";", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"i", "++"}], ";", " ", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", ">", "imax"}], ",", " ", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
              "Print", "[", 
               "\"\<Warning: RemoveInLineVertices: exceeded imax. Infinite \
loop suspected.\>\"", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"Return", "[", "tnew", "]"}]}]}], "]"}], ";"}]}], " ", 
         "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"tnew", " ", "=", " ", 
         RowBox[{"UndangleEdges", "[", "tnew", "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"tnew", "=", 
         RowBox[{"UndangleVertices", "[", "tnew", "]"}]}], ";", " ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "tnew", "]"}], ";"}]}], " ", 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "This", " ", "form", " ", "does", " ", "not", " ", "work", " ", "if", " ",
      "there", " ", "are", " ", "multiple", " ", 
     RowBox[{"ilv", "'"}], "s", " ", "in", " ", "a", " ", "single", " ", 
     "edge"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RemoveInLineVertices", "[", 
      RowBox[{
       RowBox[{"tissue_", "?", "TissueQ"}], ",", " ", "ilv_"}], "]"}], ":=", 
     " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "tnew", ",", " ", "v", ",", " ", "e", ",", " ", "c", ",", " ", 
         "toRemove", ",", " ", "vnum", ",", " ", "e1", ",", " ", "e2"}], 
        "}"}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"v", "=", 
         RowBox[{"TissueVertices", "[", "tissue", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"e", "=", 
         RowBox[{"TissueEdges", "[", "tissue", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"c", "=", 
         RowBox[{"TissueCells", "[", "tissue", "]"}]}], ";", " ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"toRemove", "=", "ilv"}], ";", "\[IndentingNewLine]", 
        RowBox[{"tnew", "=", "tissue"}], ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "toRemove", "]"}], ">", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"vnum", ",", " ", 
              RowBox[{"{", 
               RowBox[{"e1", ",", " ", "e2"}], "}"}]}], "}"}], "=", " ", 
            RowBox[{"First", "[", "toRemove", "]"}]}], ";", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"toRemove", "=", 
            RowBox[{"Rest", "[", "toRemove", "]"}]}], ";", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"tnew", " ", "=", " ", 
            RowBox[{"MergeEdges", "[", 
             RowBox[{"tnew", ",", " ", "e1", ",", " ", "e2", ",", " ", 
              RowBox[{"\"\<Undangle\>\"", "\[Rule]", " ", "False"}]}], 
             "]"}]}], ";"}]}], " ", "\[IndentingNewLine]", "]"}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"tnew", " ", "=", " ", 
         RowBox[{"UndangleEdges", "[", "tnew", "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"tnew", "=", 
         RowBox[{"UndangleVertices", "[", "tnew", "]"}]}], ";", " ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "tnew", "]"}], ";"}]}], " ", 
      "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4566926583760433`*^9, 3.4566927328470488`*^9}, {
  3.456693325199211*^9, 3.456693328101433*^9}, {3.456698382470024*^9, 
  3.456698509842635*^9}, {3.4566987135485353`*^9, 3.456698766516241*^9}, {
  3.456698861177224*^9, 3.4566988861818943`*^9}, {3.456698922461609*^9, 
  3.456698938416483*^9}, {3.456698973576213*^9, 3.4566990040622663`*^9}, {
  3.459005724337899*^9, 3.4590059264176617`*^9}, {3.459005974936459*^9, 
  3.4590059798153*^9}, {3.459006090828372*^9, 3.459006091929304*^9}, {
  3.459006124619732*^9, 3.459006197377428*^9}, {3.4590065779326963`*^9, 
  3.4590066454764147`*^9}, {3.459006709413571*^9, 3.4590067099083147`*^9}, {
  3.45900675681883*^9, 3.459006774289241*^9}, {3.459006963131703*^9, 
  3.459006993520678*^9}, {3.459007390446681*^9, 
  3.4590074892126904`*^9}},ExpressionUUID->"ceb2f66b-e109-4439-8314-\
ddd0ed67e2ec"]
}, Closed]],

Cell[CellGroupData[{

Cell["AddCorners", "Subsubsection",
 CellChangeTimes->{{3.456585272924364*^9, 
  3.456585275171946*^9}},ExpressionUUID->"9c92381e-273f-4793-9f19-\
27ee0ae303fd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AddCorners", "[", 
     RowBox[{
      RowBox[{"tissue_", "?", "TissueQ"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"xmin_", ",", "ymin_"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"xmax_", ",", "ymax_"}], "}"}]}], "}"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"vec", ",", "bv", ",", "bvxy", ",", 
        RowBox[{"debug", "=", "False"}], ",", "dPrint", ",", "eps", ",", 
        "onBottom", ",", "onTop", ",", "onLeft", ",", "onRight", ",", 
        "OnBottom", ",", "OnTop", ",", "OnLeft", ",", "OnRight", ",", " ", 
        "cvn", ",", " ", "TopRight", ",", " ", "TopLeft", ",", " ", 
        "BottomRight", ",", " ", "BottomLeft", ",", " ", "cob", ",", " ", 
        "bl", ",", " ", "br", ",", " ", "tl", ",", " ", "tr", ",", " ", "q", 
        ",", " ", "v", ",", " ", "e", ",", " ", "c", ",", " ", "needbl", ",", 
        " ", "needbr", ",", " ", "needtl", ",", " ", "needtr"}], "}"}], ",", 
      RowBox[{
       RowBox[{"eps", "=", 
        RowBox[{
         RowBox[{"(", "0.001", ")"}], "*", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"Mean", "[", 
           RowBox[{"areafunction", "[", "tissue", "]"}], "]"}], "]"}]}]}], 
       ";", 
       RowBox[{
        RowBox[{"dPrint", "[", "x___", "]"}], ":=", 
        RowBox[{"If", "[", 
         RowBox[{"debug", ",", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<AddCorners: \>\"", ",", "x"}], "]"}]}], "]"}]}], ";", 
       
       RowBox[{"v", "=", 
        RowBox[{"TissueVertices", "[", "tissue", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"e", "=", 
        RowBox[{"TissueEdges", "[", "tissue", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"c", "=", 
        RowBox[{"TissueCells", "[", "tissue", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"bv", "=", 
        RowBox[{"VerticesOnBoundary", "[", "tissue", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"bvxy", "=", 
        RowBox[{"v", "[", 
         RowBox[{"[", "bv", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "functions", " ", "to", " ", "determine", " ", "if", " ", "point", 
         " ", "is", " ", "on", " ", "particular", " ", "edge"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"OnBottom", "[", 
         RowBox[{"{", 
          RowBox[{"x_", ",", "y_"}], "}"}], "]"}], ":=", 
        RowBox[{"y", "\[LessEqual]", 
         RowBox[{"ymin", "+", "eps"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"OnTop", "[", 
         RowBox[{"{", 
          RowBox[{"x_", ",", "y_"}], "}"}], "]"}], ":=", 
        RowBox[{"y", "\[GreaterEqual]", 
         RowBox[{"ymax", "-", "eps"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"OnLeft", "[", 
         RowBox[{"{", 
          RowBox[{"x_", ",", "y_"}], "}"}], "]"}], ":=", 
        RowBox[{"x", "\[LessEqual]", 
         RowBox[{"xmin", "+", "eps"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"OnRight", "[", 
         RowBox[{"{", 
          RowBox[{"x_", ",", "y_"}], "}"}], "]"}], ":=", 
        RowBox[{"x", "\[GreaterEqual]", 
         RowBox[{"xmax", "-", "eps"}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "classify", " ", "the", " ", "points", " ", "on", " ", "the", " ", 
         "boundary"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"onBottom", "=", 
        RowBox[{"Pick", "[", 
         RowBox[{"bv", ",", 
          RowBox[{"OnBottom", "/@", "bvxy"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"onTop", "=", 
        RowBox[{"Pick", "[", 
         RowBox[{"bv", ",", 
          RowBox[{"OnTop", "/@", "bvxy"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"onLeft", "=", 
        RowBox[{"Pick", "[", 
         RowBox[{"bv", ",", 
          RowBox[{"OnLeft", "/@", "bvxy"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"onRight", "=", 
        RowBox[{"Pick", "[", 
         RowBox[{"bv", ",", 
          RowBox[{"OnRight", "/@", "bvxy"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<onBottom:\>\"", ",", "onBottom"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<onTop: \>\"", ",", "onTop"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<onLeft:\>\"", " ", ",", " ", "onLeft"}], "]"}], ";", " ",
        "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<onRight:\>\"", ",", " ", "onRight"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "identify", " ", "the", " ", "edge", " ", "on", " ", "each", " ", 
          "\"\<corner\>\"", " ", "that", " ", "has", " ", "one", " ", "point",
           " ", "on", " ", "one", " ", "tissue"}], "-", 
         RowBox[{
         "edge", " ", "and", " ", "one", " ", "point", " ", "on", " ", 
          "another", " ", "tissue"}], "-", "edge"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"cob", " ", "=", " ", 
        RowBox[{"EdgesOnBoundary", "[", "tissue", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"cvn", " ", "=", " ", 
        RowBox[{"e", "[", 
         RowBox[{"[", "cob", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"BottomLeft", "[", "evn_", "]"}], ":=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"Intersection", "[", 
            RowBox[{"evn", ",", " ", "onBottom"}], "]"}], "]"}], ">", "0"}], 
         " ", "\[And]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"Intersection", "[", 
            RowBox[{"evn", ",", " ", "onLeft"}], "]"}], "]"}], ">", "0"}]}]}],
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"BottomRight", "[", "evn_", "]"}], ":=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"Intersection", "[", 
            RowBox[{"evn", ",", " ", "onBottom"}], "]"}], "]"}], ">", "0"}], 
         " ", "\[And]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"Intersection", "[", 
            RowBox[{"evn", ",", " ", "onRight"}], "]"}], "]"}], ">", 
          "0"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"TopRight", "[", "evn_", "]"}], ":=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"Intersection", "[", 
            RowBox[{"evn", ",", " ", "onTop"}], "]"}], "]"}], ">", "0"}], " ",
          "\[And]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"Intersection", "[", 
            RowBox[{"evn", ",", " ", "onRight"}], "]"}], "]"}], ">", 
          "0"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"TopLeft", "[", "evn_", "]"}], ":=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"Intersection", "[", 
            RowBox[{"evn", ",", " ", "onTop"}], "]"}], "]"}], ">", "0"}], " ",
          "\[And]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"Intersection", "[", 
            RowBox[{"evn", ",", " ", "onLeft"}], "]"}], "]"}], ">", "0"}]}]}],
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"bl", "=", 
        RowBox[{"Pick", "[", 
         RowBox[{"cob", ",", " ", 
          RowBox[{"BottomLeft", "/@", "cvn"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"br", " ", "=", " ", 
        RowBox[{"Pick", "[", 
         RowBox[{"cob", ",", " ", 
          RowBox[{"BottomRight", "/@", "cvn"}]}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"tl", "=", 
        RowBox[{"Pick", "[", 
         RowBox[{"cob", ",", " ", 
          RowBox[{"TopLeft", "/@", "cvn"}]}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"tr", " ", "=", " ", 
        RowBox[{"Pick", "[", 
         RowBox[{"cob", ",", " ", 
          RowBox[{"TopRight", "/@", "cvn"}]}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<{bl,br, tl, tr}:\>\"", ",", " ", 
         RowBox[{"{", 
          RowBox[{"bl", ",", " ", "br", ",", " ", "tl", ",", " ", "tr"}], 
          "}"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", "flag", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"if", " ", "length"}], " ", "=", " ", "1"}], ",", " ", 
           RowBox[{
            RowBox[{"need", " ", "a", " ", "corner"}], ";", " ", 
            RowBox[{
             RowBox[{"if", " ", "length"}], "=", 
             RowBox[{
             "2", " ", "corner", " ", "is", " ", "already", " ", "there"}]}], 
            ";", " ", 
            RowBox[{
             RowBox[{"if", " ", "length"}], " ", ">", 
             RowBox[{"2", " ", "or"}], " ", "<", "1"}]}], ",", " ", "error"}],
           " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "needbl", ",", " ", "needbr", ",", " ", "needtl", ",", " ", 
             "needtr"}], "}"}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Length", "[", "#", "]"}], "\[Equal]", "1"}], ")"}], 
             "&"}], "/@", 
            RowBox[{"{", 
             RowBox[{"bl", ",", " ", "br", ",", " ", "tl", ",", " ", "tr"}], 
             "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"flag", "=", "False"}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "#1", "]"}], ">", "2"}], ",", " ", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{
                 "\"\<Error: AddCorners: Incorrect number of \>\"", ",", " ", 
                  "#2", ",", "\"\< edges = \>\"", ",", " ", 
                  RowBox[{"Length", "[", "#1", "]"}], ",", " ", 
                  "\"\<; should be either one or two.\>\""}], "]"}], ";", 
                RowBox[{"flag", "=", "True"}], ";"}]}], "]"}], "&"}], ",", 
            " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"bl", ",", "br", ",", " ", "tl", ",", " ", "tr"}], 
               "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{
               "\"\<Bottom-Left\>\"", ",", "\"\<Bottom-Right\>\"", ",", " ", 
                "\"\<Top-Left\>\"", ",", " ", "\"\<Top-Right\>\""}], "}"}]}], 
             " ", "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"flag", ",", " ", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"ShowTissue", "[", 
               RowBox[{"tissue", ",", 
                RowBox[{"\"\<CellNumbers\>\"", "\[Rule]", " ", "True"}], ",", 
                " ", 
                RowBox[{"\"\<VertexNumbers\>\"", "\[Rule]", " ", "True"}], 
                ",", " ", 
                RowBox[{"\"\<EdgeNumbers\>\"", "\[Rule]", " ", "True"}], ",", 
                "  ", 
                RowBox[{"ImageSize", "\[Rule]", " ", "250"}], ",", " ", 
                RowBox[{
                "PlotLabel", "\[Rule]", " ", "\"\<Tissue at Error\>\""}]}], 
               "]"}], "]"}], ";", " ", "\[IndentingNewLine]", 
             RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";"}]}], " ",
         "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<{need bl br tl tr}:\>\"", ",", " ", 
         RowBox[{"{", 
          RowBox[{
          "needbl", ",", " ", "needbr", ",", " ", "needtl", ",", " ", 
           "needtr"}], "}"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"bl", ",", " ", "br", ",", " ", "tl", ",", " ", "tr"}], 
         "}"}], "=", 
        RowBox[{"First", "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"PadRight", "[", 
             RowBox[{"#", " ", ",", "1", ",", " ", "$Failed"}], "]"}], "&"}], 
           "/@", 
           RowBox[{"{", 
            RowBox[{"bl", ",", "br", ",", "tl", ",", " ", "tr"}], "}"}]}], 
          ")"}]}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<{bl,br, tl, tr}:\>\"", ",", " ", 
         RowBox[{"{", 
          RowBox[{"bl", ",", " ", "br", ",", " ", "tl", ",", " ", "tr"}], 
          "}"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"q", "=", "tissue"}], ";", "\[IndentingNewLine]", " ", 
       RowBox[{"If", "[", 
        RowBox[{"needbl", ",", " ", 
         RowBox[{"q", "=", 
          RowBox[{"DivideEdge", "[", 
           RowBox[{"q", ",", " ", "bl", ",", " ", 
            RowBox[{"{", 
             RowBox[{"xmin", ",", "ymin"}], "}"}]}], "]"}]}]}], "]"}], ";", 
       " ", "\[IndentingNewLine]", " ", 
       RowBox[{"If", "[", 
        RowBox[{"needbr", ",", " ", 
         RowBox[{"q", "=", 
          RowBox[{"DivideEdge", "[", 
           RowBox[{"q", ",", " ", "br", ",", " ", 
            RowBox[{"{", 
             RowBox[{"xmax", ",", " ", "ymin"}], "}"}]}], "]"}]}]}], "]"}], 
       ";", " ", "\[IndentingNewLine]", " ", 
       RowBox[{"If", "[", 
        RowBox[{"needtl", ",", " ", 
         RowBox[{"q", "=", 
          RowBox[{"DivideEdge", "[", 
           RowBox[{"q", ",", " ", "tl", ",", " ", 
            RowBox[{"{", 
             RowBox[{"xmin", ",", " ", "ymax"}], "}"}]}], "]"}]}]}], "]"}], 
       ";", " ", "\[IndentingNewLine]", " ", 
       RowBox[{"If", "[", 
        RowBox[{"needtr", ",", " ", 
         RowBox[{"q", "=", 
          RowBox[{"DivideEdge", "[", 
           RowBox[{"q", ",", " ", "tr", ",", " ", 
            RowBox[{"{", 
             RowBox[{"xmax", ",", " ", "ymax"}], "}"}]}], "]"}]}]}], "]"}], 
       ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "q", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], " ", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AddCorners", "[", "x___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Print", "[", "\"\<Error: AddCorners.\>\"", "]"}], ";", 
     "$Failed"}], ")"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.456584956050269*^9, 3.456585006756312*^9}, {
   3.456585461279738*^9, 3.456585634672524*^9}, {3.456585671713751*^9, 
   3.4565857725735903`*^9}, {3.456585810568243*^9, 3.456586129183186*^9}, {
   3.456586250531434*^9, 3.456586253480329*^9}, {3.456586362799615*^9, 
   3.456586569036652*^9}, {3.456586616885748*^9, 3.4565867414818*^9}, {
   3.456590066390869*^9, 3.456590293434911*^9}, {3.456590324167457*^9, 
   3.456590334594718*^9}, {3.456590401021566*^9, 3.456590476850676*^9}, 
   3.456590522275547*^9, {3.4565919736686153`*^9, 3.456592038303628*^9}, 
   3.456592129072459*^9, {3.456592268646027*^9, 3.4565922741421547`*^9}, {
   3.45659249768513*^9, 3.456592556270589*^9}, {3.4565925947413816`*^9, 
   3.456592595330249*^9}, {3.4565926321405983`*^9, 3.4565926775077744`*^9}, {
   3.456592855387589*^9, 3.456592856439942*^9}, {3.4571018923570223`*^9, 
   3.457101893047297*^9}, {3.457101971838812*^9, 3.457102009973082*^9}, {
   3.457102044700918*^9, 3.457102126731954*^9}, {3.457102177134943*^9, 
   3.457102220764982*^9}, {3.4571022568233423`*^9, 3.4571022763665113`*^9}, {
   3.457102317739695*^9, 3.457102388087345*^9}, {3.457102460782956*^9, 
   3.457102461955562*^9}, {3.457102494642935*^9, 3.457102506588109*^9}, {
   3.457102606910605*^9, 3.457102615766342*^9}, {3.457102657101692*^9, 
   3.4571028676594057`*^9}, {3.45710293984724*^9, 3.4571029410295067`*^9}, 
   3.7057115311284027`*^9},ExpressionUUID->"35460dd9-131a-42e2-affc-\
2de4a85e2cb2"]
}, Closed]],

Cell[CellGroupData[{

Cell["ProjectVerticesToBoundary", "Subsubsection",
 CellChangeTimes->{{3.45658440046087*^9, 
  3.45658440789907*^9}},ExpressionUUID->"db9812bf-4fb9-4b9d-a092-\
8a75be5a5c50"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ProjectVerticesToBoundary", "[", 
    RowBox[{"tissue_", ",", "\"\<Perpendicular\>\"", ",", "  ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"xmin_", ",", "ymin_"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"xmax_", ",", " ", "ymax_"}], "}"}]}], "}"}], ",", " ", 
     "debug_"}], "]"}], ":=", " ", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "v", ",", "bv", ",", " ", "bvxy", ",", "  ", "dPrint", ",", " ", "top", 
       ",", " ", "bottom", ",", " ", "left", ",", " ", "right", ",", " ", 
       "topi", ",", "bottomi", ",", " ", "lefti", ",", " ", "righti", ",", 
       " ", "perps", ",", " ", "minDist", ",", " ", "projections"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"dPrint", "[", "x___", "]"}], ":=", " ", 
       RowBox[{"If", "[", 
        RowBox[{"debug", ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<ProjectVerticesToBoundary: \>\"", ",", " ", "x"}], 
          "]"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{"TissueVertices", "[", "tissue", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bv", "=", 
       RowBox[{"VerticesOnBoundary", "[", "tissue", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"debug", ",", "  ", 
        RowBox[{"Global`$BV", "=", "bv"}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"bvxy", "=", 
       RowBox[{"v", "[", 
        RowBox[{"[", "bv", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"debug", ",", " ", 
        RowBox[{"Global`$BVXY1", "=", "bvxy"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"bottom", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"xmin", ",", "ymin"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"xmax", ",", "ymin"}], "}"}]}], "}"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"top", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"xmin", ",", "ymax"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"xmax", ",", " ", "ymax"}], "}"}]}], "}"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"left", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"xmin", ",", "ymin"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"xmin", ",", " ", "ymax"}], "}"}]}], "}"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"right", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"xmax", ",", " ", "ymin"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"xmax", ",", " ", "ymax"}], "}"}]}], "}"}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"bottomi", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"DropPerpendicular", "[", 
          RowBox[{"#", ",", " ", "bottom"}], "]"}], "&"}], "/@", "bvxy"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"topi", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"DropPerpendicular", "[", 
          RowBox[{"#", ",", "top"}], "]"}], "&"}], "/@", "bvxy"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"lefti", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"DropPerpendicular", "[", 
          RowBox[{"#", ",", "left"}], "]"}], "&"}], "/@", "bvxy"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"righti", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"DropPerpendicular", "[", 
          RowBox[{"#", ",", " ", "right"}], "]"}], "&"}], "/@", "bvxy"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"perps", "=", 
       RowBox[{"{", 
        RowBox[{
        "bottomi", ",", " ", "topi", ",", " ", "lefti", ",", " ", "righti"}], 
        "}"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"perps", "=", 
       RowBox[{"Transpose", "[", "perps", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"debug", ",", 
        RowBox[{"Global`$PERPS", "=", "perps"}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<bvxy: \>\"", ",", 
        RowBox[{"Short", "[", " ", 
         RowBox[{"bvxy", ",", " ", "5"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"dPrint", "[", 
         RowBox[{"\"\<int points: \>\"", ",", " ", "perps"}], "]"}], ";"}], 
       "  ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"minDist", "[", 
        RowBox[{
         RowBox[{"pt_", "?", "NumericPointQ"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"pts__", "?", "NumericPointQ"}], "}"}]}], "]"}], ":=", " ", 
       
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"distances", ",", " ", "projection"}], "}"}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"distances", " ", "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"1.0", "*", 
              RowBox[{"distance", "[", 
               RowBox[{"pt", ",", "#"}], "]"}]}], "&"}], "/@", 
            RowBox[{"{", "pts", "}"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"distances", "=", 
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{"distances", ",", " ", 
              RowBox[{"{", "pts", "}"}]}], "}"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"projection", "=", 
           RowBox[{"distances", "=", 
            RowBox[{
             RowBox[{"Sort", "[", "distances", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "projection", "]"}], ";"}]}], " ", 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"projections", " ", "=", " ", 
       RowBox[{"MapThread", "[", 
        RowBox[{"minDist", ",", " ", 
         RowBox[{"{", 
          RowBox[{"bvxy", ",", " ", "perps"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<projections: \>\"", ",", 
        RowBox[{"Short", "[", " ", 
         RowBox[{"projections", ",", " ", "5"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"debug", ",", " ", 
        RowBox[{"Global`$Projections", "=", "projections"}]}], "]"}], ";", 
      " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "projections", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ProjectVerticesToBoundary", "[", 
     RowBox[{"tissue_", ",", "method_", ",", "  ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"xmin_", ",", "ymin_"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"xmax_", ",", " ", "ymax_"}], "}"}]}], "}"}], ",", " ", 
      "debug_"}], "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Error: ProjectVerticesToBoundary: Unkown Method: \>\"", ",", " ", 
        "method"}], "]"}], ";", " ", 
      RowBox[{"Return", "[", "$Failed", "]"}]}], ")"}]}], ";"}], 
  " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4565828396198807`*^9, 3.456582877421517*^9}, {
   3.456582944586935*^9, 3.456583110024516*^9}, {3.456583206947248*^9, 
   3.456583263485653*^9}, {3.456583305715917*^9, 3.4565834872204847`*^9}, {
   3.4565835413808928`*^9, 3.456583547065695*^9}, {3.4565835870695477`*^9, 
   3.456583625566154*^9}, {3.456583656096492*^9, 3.456583905076948*^9}, {
   3.456584038519109*^9, 3.456584137245083*^9}, {3.45658416894059*^9, 
   3.456584172107049*^9}, {3.45658420419847*^9, 3.456584375389172*^9}, {
   3.456692593944356*^9, 3.456692595892879*^9}, {3.4568600025408993`*^9, 
   3.456860016050624*^9}, {3.4574579381346188`*^9, 3.457457989788488*^9}, 
   3.457458228309807*^9, {3.4574583212318068`*^9, 3.4574583307121563`*^9}, {
   3.457458489719832*^9, 3.457458496921451*^9}, {3.457458575172667*^9, 
   3.45745858908875*^9}, {3.45745895827768*^9, 3.457458959656254*^9}, {
   3.457459137361081*^9, 3.4574591385158987`*^9}, {3.457459657101489*^9, 
   3.457459662520647*^9}, {3.45746001715024*^9, 
   3.4574600746627903`*^9}},ExpressionUUID->"44bae9ac-8968-4286-acbd-\
eb47e4e293b5"]
}, Closed]],

Cell[CellGroupData[{

Cell["GetCorners", "Subsubsection",
 CellChangeTimes->{{3.4565844133063707`*^9, 
  3.456584414930215*^9}},ExpressionUUID->"d8cf068a-c373-4437-bc73-\
838164e509d1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetCorners", "[", 
     RowBox[{
      RowBox[{"tissue_", "?", "TissueQ"}], ",", " ", "\"\<Automatic\>\""}], 
     "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "v", ",", "  ", "xmin", ",", " ", "ymin", ",", " ", "xmax", ",", " ", 
        "ymax"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"v", "=", 
        RowBox[{"TissueVertices", "[", "tissue", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"xmin", " ", "=", " ", 
        RowBox[{"Min", "[", 
         RowBox[{"First", "/@", "v"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"xmax", " ", "=", " ", 
        RowBox[{"Max", "[", 
         RowBox[{"First", "/@", "v"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ymin", " ", "=", " ", 
        RowBox[{"Min", "[", 
         RowBox[{"Last", "/@", "v"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"ymax", " ", "=", " ", 
        RowBox[{"Max", "[", 
         RowBox[{"Last", "/@", "v"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"xmin", ",", "ymin"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"xmax", ",", "ymax"}], "}"}]}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetCorners", "[", 
     RowBox[{
      RowBox[{"tissue_", "?", "TissueQ"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"xmin_", ",", " ", "ymin_"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"xmax_", ",", " ", "ymax_"}], "}"}]}], "}"}]}], "]"}], ":=", 
    " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"axmin", ",", "aymin", ",", "axmax", ",", "aymax"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"axmin", ",", "aymin"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"axmax", ",", " ", "aymax"}], "}"}]}], "}"}], "=", " ", 
        RowBox[{"GetCorners", "[", 
         RowBox[{"tissue", ",", " ", "\"\<Automatic\>\""}], "]"}]}], ";", " ",
        "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"xmin", ">", " ", "axmin"}], " ", "\[Or]", " ", 
          RowBox[{"xmax", " ", "<", " ", "axmax"}], " ", "\[Or]", " ", 
          RowBox[{"ymin", " ", ">", " ", "aymin"}], " ", "\[Or]", " ", 
          RowBox[{"ymax", " ", "<", " ", "aymax"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<Error: GetCorners: specified corners must be exterior to \
tissue. Input values will be ignored.\>\"", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"axmin", ",", " ", "aymin"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"axmax", ",", " ", "aymax"}], "}"}]}], "}"}], "]"}]}]}],
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"xmin", ",", "ymin"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"xmax", ",", " ", "ymax"}], "}"}]}], "}"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetCorners", "[", 
     RowBox[{
      RowBox[{"tissue_", "?", "TissueQ"}], ",", " ", "x___"}], "]"}], ":=", 
    " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Error: GetCorners: Corners type not implemented: \>\"", ",", " ", 
        "x", ",", " ", 
        "\"\< Expecting \\\"Automatic\\\" or {{xmin,ymin}, \
{xmax,ymax}}\>\""}], "]"}], ";", " ", "$Failed"}], ")"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetCorners", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", "\"\<Error: Expecting corners[tissue, corners]\>\"", 
       "]"}], ";", " ", "$Failed"}], ")"}]}], ";"}], 
  " "}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.456581263249791*^9, 3.45658137303336*^9}, {
  3.456581496863492*^9, 3.456581597195101*^9}, {3.456581648700424*^9, 
  3.456581741280323*^9}, {3.456581802598568*^9, 3.456581808206328*^9}, {
  3.4565818425094423`*^9, 3.456581876574936*^9}, {3.456581912767377*^9, 
  3.456581934065577*^9}, {3.456581987128347*^9, 3.456582181192597*^9}, {
  3.4565828070036182`*^9, 
  3.4565828142767353`*^9}},ExpressionUUID->"e712d07f-a8ad-4384-bd41-\
3062e7b9692c"]
}, Closed]],

Cell[CellGroupData[{

Cell["ToTorus", "Subsubsection",
 CellChangeTimes->{{3.457118515716181*^9, 
  3.4571185171424026`*^9}},ExpressionUUID->"0a97c730-b7a0-4d01-9e29-\
9f0ad1bd774c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ToTorus", "[", 
     RowBox[{
      RowBox[{"tissue_", "?", "TissueQ"}], ",", " ", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "tnew", ",", "v", ",", "e", ",", "c", ",", " ", "debug", ",", 
        "inputtolerance", ",", " ", "tolerance", ",", " ", "dPrint", ",", 
        "xs", ",", " ", "ys", ",", "  ", "bottom", ",", " ", "top", ",", " ", 
        "left", ",", " ", "right", ",", " ", "tv", ",", " ", "bv", ",", " ", 
        "lv", ",", " ", "rv", ",", " ", "vertexNumbers", ",", " ", "nv", ",", 
        " ", "el", ",", " ", "er", ",", " ", "et", ",", " ", "eb", ",", " ", 
        "eob", ",", " ", "whichedges", ",", " ", "corners", ",", " ", "newvr",
         ",", " ", "newvl", ",", " ", "newvt", ",", " ", "newvb", ",", " ", 
        "nnewvl", ",", " ", "nnewvr", ",", " ", "nnewvt", ",", " ", "nnewvb", 
        ",", " ", "nnewvlj", ",", " ", "nnewvrj", ",", " ", "nnewvtj", ",", 
        " ", "nnewvbj", ",", " ", "VertexOnEdge", ",", " ", 
        "VerticesOnWhichEdge", ",", " ", "VertexEdgePairs", ",", " ", 
        "EdgeMatches"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"debug", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<Debug\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"Options", "[", "ToTorus", "]"}]}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"inputtolerance", "=", 
        RowBox[{
         RowBox[{"\"\<Tolerance\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"Options", "[", "ToTorus", "]"}]}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dPrint", "[", "x___", "]"}], ":=", " ", 
        RowBox[{"If", "[", 
         RowBox[{"debug", ",", " ", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<ToTorus: \>\"", ",", " ", "x"}], "]"}]}], "]"}]}], 
       ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"v", "=", 
        RowBox[{"TissueVertices", "[", "tissue", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"c", "=", 
        RowBox[{"TissueCells", "[", "tissue", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"e", "=", 
        RowBox[{"TissueEdges", "[", "tissue", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"eob", " ", "=", " ", 
        RowBox[{"EdgesOnBoundary", "[", "tissue", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
       RowBox[{"nv", " ", "=", " ", 
        RowBox[{"Length", "[", "v", "]"}]}], ";", " ", "\[IndentingNewLine]", 
       
       RowBox[{"vertexNumbers", "=", 
        RowBox[{"Range", "[", "nv", "]"}]}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"tolerance", " ", "=", " ", 
        RowBox[{"inputtolerance", " ", "*", " ", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"Mean", "[", 
           RowBox[{"areafunction", "[", "tissue", "]"}], "]"}], "]"}]}]}], 
       ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<Tolerance:\>\"", ",", " ", "tolerance"}], "]"}], ";", 
       " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"determine", " ", "the", " ", "edges"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"xs", ",", " ", "ys"}], "}"}], "=", " ", 
        RowBox[{"Transpose", "[", "v", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"bottom", " ", "=", " ", 
        RowBox[{"Min", "[", "ys", "]"}]}], ";", " ", 
       RowBox[{"top", " ", "=", " ", 
        RowBox[{"Max", "[", "ys", "]"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"left", " ", "=", " ", 
        RowBox[{"Min", "[", "xs", "]"}]}], ";", " ", 
       RowBox[{"right", " ", "=", " ", 
        RowBox[{"Max", "[", "ys", "]"}]}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "determine", " ", "the", " ", "vertices", " ", "on", " ", "the", " ", 
         "edges"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"tv", " ", "=", 
        RowBox[{"Pick", "[", 
         RowBox[{"vertexNumbers", ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"#", "-", "top"}], "]"}], "<", "tolerance"}], ")"}], 
            "&"}], "/@", "ys"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"bv", " ", "=", 
        RowBox[{"Pick", "[", 
         RowBox[{"vertexNumbers", ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"#", "-", "bottom"}], "]"}], "<", "tolerance"}], ")"}],
             "&"}], "/@", "ys"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
       
       RowBox[{"lv", "=", " ", 
        RowBox[{"Pick", "[", 
         RowBox[{"vertexNumbers", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"#", "-", "left"}], "]"}], "<", "tolerance"}], ")"}], 
            "&"}], "/@", "xs"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"rv", " ", "=", 
        RowBox[{"Pick", "[", 
         RowBox[{"vertexNumbers", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"#", "-", "right"}], "]"}], "<", "tolerance"}], ")"}], 
            "&"}], "/@", "xs"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "determine", " ", "the", " ", "edge", " ", "numbers", " ", "of", " ", 
         "the", " ", "edges"}], " ", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"whichedges", "[", "ver_", "]"}], ":=", "  ", 
        RowBox[{"Select", "[", 
         RowBox[{"eob", ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"ver", ",", " ", 
              RowBox[{"First", "[", 
               RowBox[{"e", "[", 
                RowBox[{"[", "#", "]"}], "]"}], "]"}]}], "]"}], " ", "\[And]",
             " ", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"ver", ",", " ", 
              RowBox[{"Last", "[", 
               RowBox[{"e", "[", 
                RowBox[{"[", "#", "]"}], "]"}], "]"}]}], "]"}]}], "&"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"et", " ", "=", 
        RowBox[{"whichedges", "[", "tv", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"eb", " ", "=", " ", 
        RowBox[{"whichedges", "[", "bv", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"el", "=", " ", 
        RowBox[{"whichedges", "[", "lv", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"er", " ", "=", " ", 
        RowBox[{"whichedges", "[", "rv", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"now", " ", "remove", " ", "the", " ", "corners"}], " ", "-",
          " ", 
         RowBox[{
         "this", " ", "must", " ", "be", " ", "done", " ", "AFTER", " ", 
          "the", " ", "edges", " ", "are", " ", "identified"}]}], " ", "*)"}],
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"corners", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Intersection", "[", 
           RowBox[{"tv", ",", "lv"}], "]"}], ",", " ", 
          RowBox[{"Intersection", "[", 
           RowBox[{"tv", ",", "rv"}], "]"}], ",", " ", 
          RowBox[{"Intersection", "[", 
           RowBox[{"bv", ",", "lv"}], "]"}], ",", " ", 
          RowBox[{"Intersection", "[", 
           RowBox[{"bv", ",", "rv"}], "]"}]}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<corners: \>\"", ",", " ", "corners"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"tv", "=", 
        RowBox[{"Complement", "[", 
         RowBox[{"tv", ",", " ", "corners"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"bv", "=", 
        RowBox[{"Complement", "[", 
         RowBox[{"bv", ",", " ", "corners"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"lv", "=", 
        RowBox[{"Complement", "[", 
         RowBox[{"lv", ",", " ", "corners"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"rv", "=", 
        RowBox[{"Complement", "[", 
         RowBox[{"rv", ",", " ", "corners"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{
        "\"\<top:    \>\"", ",", " ", "tv", ",", " ", "\"\<, edges: \>\"", 
         ",", " ", "et"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{
        "\"\<bottom: \>\"", ",", " ", "bv", ",", "  ", "\"\<, edges: \>\"", 
         ",", " ", "eb"}], "]"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{
        "\"\<left:   \>\"", ",", " ", "lv", ",", " ", "\"\<, Edges: \>\"", 
         ",", " ", "el"}], "]"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{
        "\"\<right:  \>\"", ",", "rv", ",", " ", "\"\<, Edges: \>\"", ",", 
         " ", "er"}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"add", " ", "new", " ", "vertices"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"newvt", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"v", "[", 
             RowBox[{"[", 
              RowBox[{"#", ",", " ", "1"}], "]"}], "]"}], ",", " ", "top"}], 
           "}"}], "&"}], "/@", "bv"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"nnewvt", " ", "=", " ", 
        RowBox[{"Length", "[", "newvt", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"nnewvtj", "=", 
        RowBox[{"Range", "[", 
         RowBox[{
          RowBox[{"nv", "+", "1"}], ",", " ", 
          RowBox[{"nv", " ", "+", " ", "nnewvt"}]}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"nv", " ", "=", " ", 
        RowBox[{"nv", "+", "nnewvt"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"newvb", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"v", "[", 
             RowBox[{"[", 
              RowBox[{"#", ",", " ", "1"}], "]"}], "]"}], ",", " ", 
            "bottom"}], "}"}], "&"}], "/@", "tv"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"nnewvb", " ", "=", " ", 
        RowBox[{"Length", "[", "newvb", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"nnewvbj", "=", 
        RowBox[{"Range", "[", 
         RowBox[{
          RowBox[{"nv", "+", "1"}], ",", " ", 
          RowBox[{"nv", "+", "nnewvb"}]}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"nv", " ", "=", " ", 
        RowBox[{"nv", " ", "+", " ", "nnewvb"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"newvl", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"left", ",", " ", 
            RowBox[{"v", "[", 
             RowBox[{"[", 
              RowBox[{"#", ",", " ", "2"}], "]"}], "]"}]}], "}"}], "&"}], "/@",
          "rv"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"nnewvl", " ", "=", " ", 
        RowBox[{"Length", "[", "newvl", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"nnewvlj", "=", 
        RowBox[{"Range", "[", 
         RowBox[{
          RowBox[{"nv", "+", "1"}], ",", " ", 
          RowBox[{"nv", "+", "nnewvl"}]}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"nv", " ", "=", " ", 
        RowBox[{"nv", "+", "nnewvl"}]}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"newvr", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"right", ",", " ", 
            RowBox[{"v", "[", 
             RowBox[{"[", 
              RowBox[{"#", ",", " ", "2"}], "]"}], "]"}]}], "}"}], "&"}], "/@",
          "lv"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"nnewvr", " ", "=", " ", 
        RowBox[{"Length", "[", "newvr", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"nnewvrj", " ", "=", " ", 
        RowBox[{"Range", "[", 
         RowBox[{
          RowBox[{"nv", "+", "1"}], ",", " ", 
          RowBox[{"nv", "+", "nnewvr"}]}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"nv", " ", "=", " ", 
        RowBox[{"nv", "+", "nnewvr"}]}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<new top v indices:    \>\"", ",", " ", "nnewvtj"}], 
        "]"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<new bottom v indices: \>\"", ",", " ", "nnewvbj"}], 
        "]"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<new left v indices:   \>\"", " ", ",", " ", "nnewvlj"}], 
        "]"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<nnew right v indices:  \>\"", ",", " ", "nnewvrj"}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<new nv: \>\"", ",", " ", "nv"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"v", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
         "v", ",", " ", "newvt", ",", " ", "newvb", ",", " ", "newvl", ",", 
          " ", "newvr"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "figure", " ", "out", " ", "which", " ", "outer", " ", "edge", " ", 
         "each", " ", "new", " ", "vertex", " ", "lies", " ", "on"}], " ", 
        "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"VertexOnEdge", "[", 
         RowBox[{"vnum_", ",", " ", "enum_"}], "]"}], ":=", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"PointOnLineSegment", "[", 
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"[", 
            RowBox[{"e", "[", 
             RowBox[{"[", "enum", "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{"v", "[", 
           RowBox[{"[", "vnum", "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"VerticesOnWhichEdge", "[", 
         RowBox[{"vnums_", ",", " ", "enums_"}], "]"}], ":=", " ", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "vonedge", ",", " ", "nver", ",", " ", "vertex", ",", " ", "k", 
            ",", "savebug", ",", " ", 
            RowBox[{"dbg", "=", "False"}], ",", " ", "edges"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"savebug", "=", "debug"}], ";", " ", "\[IndentingNewLine]", 
           RowBox[{"debug", "=", "dbg"}], ";", " ", "\[IndentingNewLine]", 
           RowBox[{"nver", " ", "=", 
            RowBox[{"Length", "[", "vnums", "]"}]}], ";", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"edges", "=", 
            RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"k", "=", "1"}], ",", 
             RowBox[{"k", "\[LessEqual]", " ", "nver"}], ",", " ", 
             RowBox[{"k", "++"}], " ", ",", " ", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"vertex", " ", "=", " ", 
               RowBox[{"vnums", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}], ";", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"vonedge", " ", "=", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"VertexOnEdge", "[", 
                  RowBox[{"vertex", ",", " ", "#"}], "]"}], "&"}], "/@", 
                "enums"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"dPrint", "[", 
               RowBox[{
               "\"\<k: \>\"", ",", " ", "k", ",", " ", "\"\< vertex: \>\"", 
                ",", " ", "vertex", ",", " ", "\"\< enums: \>\"", ",", " ", 
                "enums", ",", " ", "\"\< vonedge: \>\"", ",", " ", 
                "vonedge"}], "]"}], ";", " ", "\[IndentingNewLine]", 
              RowBox[{"vonedge", " ", "=", " ", 
               RowBox[{"Pick", "[", 
                RowBox[{"enums", ",", " ", "vonedge"}], "]"}]}], ";", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "vonedge", "]"}], ">", "1"}], ",", 
                " ", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{
                  "\"\<Error: ToTorus: VerticesOnEdge: Vertex \>\"", ",", " ",
                    "vertex", ",", "\"\< is on multple edges: \>\"", ",", " ",
                    "vonedge"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
               ";", " ", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "vonedge", "]"}], "<", "1"}], ",", 
                " ", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{
                  "\"\<Error: ToTorus: VerticesOnEdge: Vertex \>\"", ",", " ",
                    "vertex", ",", " ", "\"\< is not on any edge.\>\""}], 
                  "]"}], ";", " ", "\[IndentingNewLine]", 
                 RowBox[{"vonedge", "=", 
                  RowBox[{"{", "$Failed", "}"}]}], ";"}]}], " ", 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"vonedge", "=", 
               RowBox[{"First", "[", "vonedge", "]"}]}], ";", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"edges", ",", " ", "vonedge"}], "]"}], ";", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"dPrint", "[", 
               RowBox[{
               "\"\<vertex: \>\"", ",", " ", "vertex", ",", " ", 
                "\"\< edge: \>\"", ",", " ", "vonedge"}], "]"}], ";"}]}], " ",
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"debug", "=", "savebug"}], ";", " ", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{"vnums", ",", " ", "edges"}], "}"}], "]"}], "]"}], 
           ";"}]}], " ", "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "get", " ", "a", " ", "list", " ", "of", " ", "the", " ", "outer", 
         " ", "new", " ", "vertices", " ", "and", " ", "their", " ", 
         "corresponding", " ", "edges"}], " ", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"VertexEdgePairs", "=", 
        RowBox[{"Join", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"VerticesOnWhichEdge", "[", 
           RowBox[{"nnewvtj", ",", " ", "et"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"VerticesOnWhichEdge", "[", 
           RowBox[{"nnewvbj", ",", " ", "eb"}], "]"}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"VerticesOnWhichEdge", "[", 
           RowBox[{"nnewvlj", ",", " ", "el"}], "]"}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"VerticesOnWhichEdge", "[", 
           RowBox[{"nnewvrj", ",", " ", "er"}], "]"}]}], " ", 
         "\[IndentingNewLine]", "]"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<VertexEdgePairs: \>\"", ",", " ", "VertexEdgePairs"}], 
        "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "divide", " ", "the", " ", "tissue", " ", "at", " ", "the", " ", 
         "identified", " ", "locations"}], " ", "*)"}], "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"tnew", " ", "=", " ", "tissue"}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"vertex", ",", " ", "edge", ",", " ", "vep"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"vep", " ", "=", " ", "VertexEdgePairs"}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "vep", "]"}], ">", "0"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"vertex", ",", " ", "edge"}], "}"}], "=", 
              RowBox[{"First", "[", "vep", "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"dPrint", "[", 
              RowBox[{
              "\"\<inserting vertex \>\"", ",", " ", "vertex", ",", " ", 
               "\"\< in edge \>\"", ",", " ", "edge", ",", " ", 
               "\"\< ..\>\""}], "]"}], ";", "  ", "\[IndentingNewLine]", 
             RowBox[{"vep", "=", 
              RowBox[{"Rest", "[", "vep", "]"}]}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"vertex", "=", 
              RowBox[{"v", "[", 
               RowBox[{"[", "vertex", "]"}], "]"}]}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"tnew", " ", "=", " ", 
              RowBox[{"DivideEdge", "[", 
               RowBox[{"tnew", ",", " ", "edge", ",", " ", "vertex"}], 
               "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"eob", "=", 
        RowBox[{"EdgesOnBoundary", "[", "tnew", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<eob: \>\"", ",", " ", "eob"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"deterermine", " ", "the", " ", "toroidal", " ", "matching"}],
         " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "eobv", ",", "eobvxy", ",", "  ", "edges", ",", " ", "vert", ",", 
           " ", "topedges", ",", " ", "bottomedges", ",", " ", "leftedges", 
           ",", " ", "rightedges", ",", " ", "matches", ",", " ", "ETopQ", 
           ",", " ", "EBottomQ", ",", " ", "ERightQ", ",", " ", "ELeftQ", ",",
            " ", "ELeft", ",", " ", "ERight", ",", " ", "ETop", ",", " ", 
           "EBottom", ",", " ", "GetLeftx", ",", " ", "GetBottomy", ",", " ", 
           "ETopx", ",", " ", "EBottomx", ",", " ", "ELefty", ",", " ", 
           "ERighty", ",", " ", "SortBy"}], "}"}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"matches", "[", 
            RowBox[{"x_", ",", " ", "y_"}], "]"}], ":=", " ", 
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{"x", "-", "y"}], "]"}], "<", "tolerance"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"matches", "[", 
            RowBox[{"x_", ",", " ", "y_", ",", " ", "z_"}], "]"}], ":=", " ", 
           
           RowBox[{"And", "[", 
            RowBox[{
             RowBox[{"matches", "[", 
              RowBox[{"x", ",", "y"}], "]"}], ",", " ", 
             RowBox[{"matches", "[", 
              RowBox[{"y", ",", "z"}], "]"}]}], "]"}]}], ";", "  ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"edges", " ", "=", " ", 
           RowBox[{"TissueEdges", "[", "tnew", "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"vert", " ", "=", " ", 
           RowBox[{"TissueVertices", "[", "tnew", "]"}]}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"eobv", " ", "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"edges", "[", 
              RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "eob"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"eobvxy", " ", "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"vert", "[", 
              RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "eobv"}]}], ";", 
          " ", "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<eobv: \>\"", ",", " ", "eobv"}], "]"}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<eobvxy: \>\"", ",", " ", "eobvxy"}], "]"}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ETopQ", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x1_", ",", " ", "y1_"}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"x2_", ",", " ", "y2_"}], "}"}]}], "}"}], "]"}], ":=", 
           " ", 
           RowBox[{"matches", "[", 
            RowBox[{"y1", ",", " ", "y2", ",", " ", "top"}], "]"}]}], ";", 
          " ", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"EBottomQ", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x1_", ",", " ", "y1_"}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"x2_", ",", " ", "y2_"}], "}"}]}], "}"}], "]"}], ":=", 
           " ", 
           RowBox[{"matches", "[", 
            RowBox[{"y1", ",", " ", "y2", ",", " ", "bottom"}], "]"}]}], ";", 
          " ", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ELeftQ", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x1_", ",", " ", "y1_"}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"x2_", ",", " ", "y2_"}], "}"}]}], "}"}], "]"}], ":=", 
           " ", 
           RowBox[{"matches", "[", 
            RowBox[{"x1", ",", " ", "x2", ",", " ", "left"}], "]"}]}], ";", 
          " ", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ERightQ", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x1_", ",", " ", "y1_"}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"x2_", ",", " ", "y2_"}], "}"}]}], "}"}], "]"}], ":=", 
           " ", 
           RowBox[{"matches", "[", 
            RowBox[{"x1", ",", " ", "x2", ",", " ", "right"}], "]"}]}], ";", 
          " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"ETop", " ", "=", 
           RowBox[{"Pick", "[", 
            RowBox[{"eob", ",", "  ", 
             RowBox[{"ETopQ", "/@", "eobvxy"}]}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"EBottom", " ", "=", 
           RowBox[{"Pick", "[", 
            RowBox[{"eob", ",", "  ", 
             RowBox[{"EBottomQ", "/@", "eobvxy"}]}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"ELeft", " ", "=", 
           RowBox[{"Pick", "[", 
            RowBox[{"eob", ",", "  ", 
             RowBox[{"ELeftQ", "/@", "eobvxy"}]}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"ERight", " ", "=", 
           RowBox[{"Pick", "[", 
            RowBox[{"eob", ",", "  ", 
             RowBox[{"ERightQ", "/@", "eobvxy"}]}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"GetLeftx", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x1_", ",", " ", "y1_"}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"x2_", ",", " ", "y2_"}], "}"}]}], "}"}], "]"}], ":=", 
           
           RowBox[{"First", "[", " ", 
            RowBox[{"Sort", "[", 
             RowBox[{"{", 
              RowBox[{"x1", ",", " ", "x2"}], "}"}], "]"}], "]"}]}], ";", " ",
           "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"GetBottomy", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x1_", ",", " ", "y1_"}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"x2_", ",", " ", "y2_"}], "}"}]}], "}"}], "]"}], ":=", 
           " ", 
           RowBox[{"First", "[", 
            RowBox[{"Sort", "[", 
             RowBox[{"{", 
              RowBox[{"y1", ",", " ", "y2"}], "}"}], "]"}], "]"}]}], ";", " ",
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"ETopx", " ", "=", 
           RowBox[{"GetLeftx", "/@", 
            RowBox[{"Pick", "[", 
             RowBox[{"eobvxy", ",", "  ", 
              RowBox[{"ETopQ", "/@", "eobvxy"}]}], "]"}]}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"EBottomx", " ", "=", 
           RowBox[{"GetLeftx", "/@", 
            RowBox[{"Pick", "[", 
             RowBox[{"eobvxy", ",", "  ", 
              RowBox[{"EBottomQ", "/@", "eobvxy"}]}], "]"}]}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"ELefty", " ", "=", 
           RowBox[{"GetBottomy", "/@", 
            RowBox[{"Pick", "[", 
             RowBox[{"eobvxy", ",", "  ", 
              RowBox[{"ELeftQ", "/@", "eobvxy"}]}], "]"}]}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"ERighty", " ", "=", 
           RowBox[{"GetBottomy", "/@", 
            RowBox[{"Pick", "[", 
             RowBox[{"eobvxy", ",", "  ", 
              RowBox[{"ERightQ", "/@", "eobvxy"}]}], "]"}]}]}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "ETop", "]"}], "\[NotEqual]", " ", 
             RowBox[{"Length", "[", "EBottom", "]"}]}], ",", " ", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<Program Error: ToTorus: Number of Top Edges = \>\"", ",", 
               " ", "ETop", ",", " ", 
               "\"\< is different from the number of Bottom Edges= \>\"", ",",
                " ", "EBottom"}], "]"}], ";", " ", 
             RowBox[{"Return", "[", "$Failed", "]"}], ";"}]}], " ", "]"}], 
          ";", " ", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "ELeft", "]"}], "\[NotEqual]", " ", 
             RowBox[{"Length", "[", "ERight", "]"}]}], ",", " ", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<Program Error: ToTorus: Number of Left Edges = \>\"", ",", 
               " ", "ELeft", ",", " ", 
               "\"\< is different from the number of Right Edges= \>\"", ",", 
               " ", "ERight"}], "]"}], ";", " ", 
             RowBox[{"Return", "[", "$Failed", "]"}], ";"}]}], " ", "]"}], 
          ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<ETop:    \>\"", ",", " ", "ETop"}], "]"}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<EBottom: \>\"", ",", " ", "EBottom"}], "]"}], ";", 
          " ", "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<ERight:  \>\"", " ", ",", "ERight"}], "]"}], ";", " ",
           "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<ELeft:   \>\"", ",", " ", "ELeft"}], "]"}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<ETopx:    \>\"", ",", " ", "ETopx"}], "]"}], ";", " ",
           "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<EBottomx: \>\"", ",", " ", "EBottomx"}], "]"}], ";", 
          " ", "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<ERighty:  \>\"", " ", ",", "ERighty"}], "]"}], ";", 
          " ", "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<ELefty:   \>\"", ",", " ", "ELefty"}], "]"}], ";", 
          " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"SortBy", "[", 
            RowBox[{"list_", ",", " ", "keys_"}], "]"}], ":=", 
           RowBox[{"Last", "[", " ", 
            RowBox[{"Transpose", "[", 
             RowBox[{"Sort", "[", 
              RowBox[{"Transpose", "[", 
               RowBox[{"{", 
                RowBox[{"keys", ",", " ", "list"}], "}"}], "]"}], "]"}], 
             "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"ETop", " ", "=", " ", 
           RowBox[{"SortBy", "[", 
            RowBox[{"ETop", ",", " ", "ETopx"}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"EBottom", " ", "=", " ", 
           RowBox[{"SortBy", "[", 
            RowBox[{"EBottom", ",", " ", "EBottomx"}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"ELeft", "=", " ", 
           RowBox[{"SortBy", "[", 
            RowBox[{"ELeft", ",", " ", "ELefty"}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"ERight", " ", "=", " ", 
           RowBox[{"SortBy", "[", 
            RowBox[{"ERight", ",", " ", "ERighty"}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<ETop:    \>\"", ",", " ", "ETop"}], "]"}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<EBottom: \>\"", ",", " ", "EBottom"}], "]"}], ";", 
          " ", "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<ERight:  \>\"", " ", ",", "ERight"}], "]"}], ";", " ",
           "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<ELeft:   \>\"", ",", " ", "ELeft"}], "]"}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"EdgeMatches", " ", "=", 
           RowBox[{"Sort", "[", 
            RowBox[{"Join", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"MapThread", "[", 
               RowBox[{"Rule", ",", " ", 
                RowBox[{"{", 
                 RowBox[{"ETop", ",", " ", "EBottom"}], "}"}]}], "]"}], ",", 
              " ", "\[IndentingNewLine]", 
              RowBox[{"MapThread", "[", 
               RowBox[{"Rule", ",", " ", 
                RowBox[{"{", 
                 RowBox[{"EBottom", ",", " ", "ETop"}], "}"}]}], "]"}], ",", 
              " ", "\[IndentingNewLine]", 
              RowBox[{"MapThread", "[", 
               RowBox[{"Rule", ",", " ", 
                RowBox[{"{", 
                 RowBox[{"ELeft", ",", " ", "ERight"}], "}"}]}], "]"}], ",", 
              " ", "\[IndentingNewLine]", 
              RowBox[{"MapThread", "[", 
               RowBox[{"Rule", ",", " ", 
                RowBox[{"{", 
                 RowBox[{"ERight", ",", " ", "ELeft"}], "}"}]}], "]"}]}], 
             "\[IndentingNewLine]", "]"}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"Pick", " ", "out", " ", "matches", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"larger", " ", "edge", " ", "#"}], ")"}], "--"}]}], 
            ">", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Smaller", " ", "Edge", " ", "#"}], ")"}], " ", 
             "only"}]}], " ", "*)"}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"EdgeMatches", "=", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Rule", "@@", "#"}], "&"}], "/@", 
            RowBox[{"Union", "[", 
             RowBox[{
              RowBox[{"Reverse", "/@", 
               RowBox[{"Sort", "/@", "EdgeMatches"}]}], "/.", 
              RowBox[{"{", 
               RowBox[{"Rule", "\[Rule]", " ", "List"}], "}"}]}], "]"}]}]}], 
          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<EdgeMatches: \>\"", ",", " ", "EdgeMatches"}], "]"}], 
          ";"}]}], " ", "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], 
       ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"end", " ", "Block"}], " ", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"Torus", "[", 
         RowBox[{"tnew", ",", " ", "EdgeMatches"}], "]"}], "]"}], ";"}]}], 
     " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Return", "[", 
        RowBox[{"Tissue", "[", 
         RowBox[{"v", ",", "e", ",", "c"}], "]"}], "]"}], ";"}], 
      "\[IndentingNewLine]", "*)"}], " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.45711851820998*^9, 3.457118519655459*^9}, {
   3.4571185683530283`*^9, 3.45711861628649*^9}, {3.4571186583809977`*^9, 
   3.457118663498966*^9}, {3.457118720895322*^9, 3.457118760864256*^9}, {
   3.457118796697557*^9, 3.4571188666595488`*^9}, {3.457118909171542*^9, 
   3.457119221784596*^9}, {3.4571193708792753`*^9, 3.4571194731011877`*^9}, {
   3.457119509087968*^9, 3.457119525341456*^9}, {3.457119558874133*^9, 
   3.4571195768202677`*^9}, {3.457119616278282*^9, 3.457119637317952*^9}, {
   3.45711967192467*^9, 3.4571198921015263`*^9}, {3.457119977440379*^9, 
   3.457120126796328*^9}, {3.457120159792742*^9, 3.4571201647280293`*^9}, {
   3.45712021992896*^9, 3.4571202558335114`*^9}, {3.457133067168998*^9, 
   3.457133098496695*^9}, {3.457133131624282*^9, 3.4571331380139313`*^9}, {
   3.457133276376514*^9, 3.457133400666263*^9}, {3.4571334582073107`*^9, 
   3.4571335484919863`*^9}, {3.4571335989159813`*^9, 
   3.4571337278702507`*^9}, {3.4571340766336308`*^9, 3.457134461594309*^9}, {
   3.457134522785801*^9, 3.457134562224986*^9}, {3.457274571571508*^9, 
   3.4572745865223103`*^9}, {3.4572771551828117`*^9, 3.457277155408557*^9}, {
   3.4572773021969767`*^9, 3.4572773765076923`*^9}, {3.457277434319399*^9, 
   3.457277533042375*^9}, {3.4572783784118137`*^9, 3.457278706717348*^9}, {
   3.457278741511053*^9, 3.457278745791773*^9}, {3.4572788190772676`*^9, 
   3.457279029610268*^9}, {3.4572790668171597`*^9, 3.457279287455387*^9}, {
   3.457279330585781*^9, 3.4572794922541122`*^9}, {3.4572795507641582`*^9, 
   3.457279626679452*^9}, {3.4572797281279163`*^9, 3.457279740518236*^9}, {
   3.4572798088301077`*^9, 3.45728005319576*^9}, {3.457280112634933*^9, 
   3.457280113679632*^9}, {3.4572827233462763`*^9, 3.457282784821019*^9}, {
   3.457355270800613*^9, 3.457355293445321*^9}, {3.4573553745794*^9, 
   3.457355376071505*^9}, {3.457355428085677*^9, 3.457355438440143*^9}, {
   3.457355494596867*^9, 3.457355686796821*^9}, {3.457355725527062*^9, 
   3.4573562423074923`*^9}, {3.457356306617185*^9, 3.457356336583726*^9}, {
   3.4573587550952787`*^9, 3.457358757915085*^9}, {3.457358799371031*^9, 
   3.45735881203757*^9}, {3.457358869896901*^9, 3.457359033171382*^9}, {
   3.4573590674211597`*^9, 3.45735945901577*^9}, {3.457359524111272*^9, 
   3.4573596490050917`*^9}, {3.45735971447866*^9, 3.457360061805794*^9}, {
   3.4573601092811937`*^9, 3.457360259004722*^9}, {3.45736034047888*^9, 
   3.457360344311007*^9}, {3.457360435394676*^9, 3.457360578657502*^9}, {
   3.4573606171070747`*^9, 3.457360670496311*^9}, {3.457360702184108*^9, 
   3.457360779195115*^9}, {3.457360901787546*^9, 3.4573610197203093`*^9}, 
   3.4573876319397163`*^9, 
   3.705711535144026*^9},ExpressionUUID->"cf8a03aa-73e6-4940-9292-\
776c4fab9660"]
}, Closed]],

Cell[CellGroupData[{

Cell["TorusQ, TorusCheck", "Subsubsection",
 CellChangeTimes->{{3.457361029756978*^9, 3.457361031804817*^9}, {
  3.45738739300596*^9, 
  3.457387394346943*^9}},ExpressionUUID->"1944393f-658a-4c42-9005-\
5839ced54ac3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TorusQ", "[", 
    RowBox[{"Torus", "[", 
     RowBox[{
      RowBox[{"x_", "?", "TissueQ"}], ",", " ", "y_"}], "]"}], "]"}], ":=", 
   " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"isrule", ",", " ", "ok"}], "}"}], ",", " ", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"isrule", "[", "z_Rule", "]"}], ":=", " ", "True"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"isrule", "[", "z___", "]"}], ":=", " ", "False"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"ListQ", "[", "y", "]"}]}], ",", " ", 
        RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"ok", " ", "=", " ", 
       RowBox[{"isrule", "/@", "y"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"And", "@@", "ok"}], "]"}], ";"}]}], " ", 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TorusQ", "[", "x___", "]"}], ":=", " ", "False"}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TorusCheck", "[", 
    RowBox[{"Torus", "[", 
     RowBox[{"tissue_", ",", " ", "rules_"}], "]"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tissuecheck", ",", " ", "isrule", ",", " ", "ok"}], "}"}], ",",
      " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tissuecheck", " ", "=", " ", 
       RowBox[{"TissueCheck", "[", "tissue", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", "tissuecheck"}], ",", " ", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<TorusCheck: First argument of Torus[..] is not a valid Tissue \
object.\>\"", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"isrule", "[", "z_Rule", "]"}], ":=", " ", "True"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"isrule", "[", "z___", "]"}], ":=", " ", "False"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"ListQ", "[", "rules", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<TorusCheck: Second argument is not a list of rules.\>\"", 
          "]"}], ";", " ", "\[IndentingNewLine]", " ", 
         RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"ok", " ", "=", " ", 
       RowBox[{"isrule", "/@", "rules"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"ok", " ", "=", " ", 
       RowBox[{"And", "@@", "ok"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"ok", ",", " ", 
        RowBox[{"Print", "[", 
         RowBox[{
          RowBox[{"Length", "[", "rules", "]"}], ",", " ", 
          "\"\< edge matching rules. \>\""}], "]"}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", "ok"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<TorusCheck: Second argument is not a list of rules.\>\"", 
          "]"}], ";", " ", "\[IndentingNewLine]", " ", 
         RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "tissuecheck", "]"}], ";"}]}], " ", 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TorusCheck", "[", "x___", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Error: Expecting TorusCheck[Torus[Tissue[], rules]\>\"", "]"}], 
      ";", " ", "$Failed"}], ")"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4573610605702467`*^9, 3.457361090642227*^9}, {
  3.457361147984109*^9, 3.4573612305178413`*^9}, {3.4573612808727503`*^9, 
  3.457361384226746*^9}, {3.4573614241735563`*^9, 3.457361426130581*^9}, {
  3.457361459028275*^9, 3.457361857086113*^9}, {3.45736189689904*^9, 
  3.457361901180902*^9}},ExpressionUUID->"330dcbd1-099f-4627-a1ea-\
bb5d4b98a49e"]
}, Closed]],

Cell[CellGroupData[{

Cell["TorusTissue, TorusRules", "Subsubsection",
 CellChangeTimes->{{3.4573872188623333`*^9, 
  3.457387222910043*^9}},ExpressionUUID->"217dbc99-57f5-4f44-ac04-\
3185b4ea3ce7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TorusTissue", "[", 
    RowBox[{"Torus", "[", 
     RowBox[{"tissue_", ",", " ", "rules_"}], "]"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "ok", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ok", " ", "=", " ", 
       RowBox[{"TorusQ", "[", 
        RowBox[{"Torus", "[", 
         RowBox[{"tissue", ",", " ", "rules"}], "]"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "[", "ok", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", "\"\<Error: TorusTissue: Invalid Torus object. \>\"", 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"TorusCheck", "[", 
          RowBox[{"Torus", "[", 
           RowBox[{"tissue", ",", " ", "rules"}], "]"}], "]"}], ";", 
         "\[IndentingNewLine]", " ", 
         RowBox[{"Return", "[", "$Failed", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "tissue", "]"}], ";"}]}], " ", 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TorusTissue", "[", "x___", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", "\"\<Error: expecting TorusTissue[Torus[..]].\>\"", "]"}],
       ";", " ", "$Failed"}], ")"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TorusRules", "[", 
    RowBox[{"Torus", "[", 
     RowBox[{"tissue_", ",", " ", "rules_"}], "]"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "ok", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ok", " ", "=", " ", 
       RowBox[{"TorusQ", "[", 
        RowBox[{"Torus", "[", 
         RowBox[{"tissue", ",", " ", "rules"}], "]"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "[", "ok", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", "\"\<Error: TorusRules: Invalid Torus object. \>\"", 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"TorusCheck", "[", 
          RowBox[{"Torus", "[", 
           RowBox[{"tissue", ",", " ", "rules"}], "]"}], "]"}], ";", 
         "\[IndentingNewLine]", " ", 
         RowBox[{"Return", "[", "$Failed", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "rules", "]"}], ";"}]}], " ", 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TorusRules", "[", "x___", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", "\"\<Error: expecting TorusRules[Torus[..]].\>\"", "]"}], 
      ";", " ", "$Failed"}], ")"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.457387223917143*^9, 3.4573872751706448`*^9}, {
  3.457387308975816*^9, 3.4573875145763903`*^9}, {3.4573875720794687`*^9, 
  3.4573875822487783`*^9}},ExpressionUUID->"e29c421e-3c15-42b2-aebf-\
c89a5f9ab307"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Dynamic Tissue Functions", "Section",
 CellChangeTimes->{{3.546081488198844*^9, 3.546081490381351*^9}, {
  3.546083748240696*^9, 
  3.546083749015892*^9}},ExpressionUUID->"81e1a38d-b08a-4fac-9163-\
6589e85abe32"],

Cell["\<\
A DTissue is similar to a Tissue except that the cells are numbered by a rule \
list, so that when cells are removed or added they can maintain a continuous \
cell cell number and not have to rely on positional information\
\>", "Text",
 CellChangeTimes->{{3.546083785794633*^9, 
  3.546083824887841*^9}},ExpressionUUID->"7306b442-a205-47c2-967f-\
e2da0aaea95c"],

Cell[CellGroupData[{

Cell["DTissueQ,ISTissue", "Subsection",
 CellChangeTimes->{{3.546083756608485*^9, 3.546083758623363*^9}, {
  3.547045364108976*^9, 
  3.547045365835373*^9}},ExpressionUUID->"c9588416-6c65-4a1c-9e07-\
fcefd62c47f6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DTissueQ", "[", 
    RowBox[{"DTissue", "[", 
     RowBox[{
      RowBox[{"v_", "?", "ListQ"}], ",", 
      RowBox[{"e_", "?", "ListQ"}], ",", 
      RowBox[{"c_", "?", "ListQ"}]}], "]"}], "]"}], ":=", " ", 
   RowBox[{"RuleQ", "[", "c", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DTissueQ", "[", "x___", "]"}], ":=", " ", "False"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ISTissue", "[", "x___", "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"TissueQ", "[", "x", "]"}], "\[Or]", 
    RowBox[{"DTissueQ", "[", "x", "]"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5460825649205437`*^9, 3.546082616919875*^9}, {
  3.547045367692584*^9, 
  3.5470453953235073`*^9}},ExpressionUUID->"dccc3453-ec2b-4cc5-98d9-\
c9ad88c65b41"]
}, Closed]],

Cell[CellGroupData[{

Cell["Tissue2DTissue", "Subsection",
 CellChangeTimes->{{3.546083762600842*^9, 
  3.5460837650717087`*^9}},ExpressionUUID->"912bf287-b5cd-44e8-8180-\
97d4363dd56c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Tissue2DTissue", "[", 
    RowBox[{
     RowBox[{"tissue_", "?", "TissueQ"}], ",", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "numbers", ",", "v", ",", "e", ",", "c", ",", "nc", ",", "maxnumber"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"numbers", " ", "=", 
       RowBox[{
        RowBox[{"\"\<Numbers\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Numbers\>\"", "\[Rule]", " ", 
          RowBox[{"{", "}"}]}], "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{"TissueVertices", "[", "tissue", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"TissueCells", "[", "tissue", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"e", "=", 
       RowBox[{"TissueEdges", "[", "tissue", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"nc", "=", 
       RowBox[{"Length", "[", "c", "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"numbers", "\[Equal]", 
         RowBox[{"{", "}"}]}], ",", " ", 
        RowBox[{"numbers", "=", 
         RowBox[{"Range", "[", "nc", "]"}]}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"maxnumber", "=", 
       RowBox[{"Max", "[", "numbers", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "numbers", "]"}], "<", "nc"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"maxnumber", "++"}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"numbers", ",", " ", "maxnumber"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Rule", ",", 
         RowBox[{"{", 
          RowBox[{"numbers", ",", "c"}], "}"}]}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"DTissue", "[", 
       RowBox[{"v", ",", "e", ",", "c"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tissue2DTissue", "[", "x___", "]"}], ":=", " ", 
  "$Failed"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.54608262881435*^9, 3.546082671983053*^9}, {
  3.546082820960746*^9, 3.54608303920944*^9}, {3.546083226061059*^9, 
  3.546083236192356*^9}},ExpressionUUID->"487d307e-aa35-4dc7-8761-\
a646ebd69e52"]
}, Closed]],

Cell[CellGroupData[{

Cell["DTissue2Tissue", "Subsection",
 CellChangeTimes->{{3.546083771848068*^9, 
  3.5460837741756077`*^9}},ExpressionUUID->"2971922f-6f1f-47d3-8c8b-\
7643e923d2b9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DTissue2Tissue", "[", 
    RowBox[{"DTissue", "[", 
     RowBox[{"v_", ",", "e_", ",", "c_"}], "]"}], "]"}], ":=", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"DTissueQ", "[", 
      RowBox[{"DTissue", "[", 
       RowBox[{"v", ",", "e", ",", "c"}], "]"}], "]"}], ",", 
     RowBox[{"Tissue", "[", 
      RowBox[{"v", ",", "e", ",", 
       RowBox[{"Last", "/@", "c"}]}], "]"}], ",", "$Failed"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DTissue2Tissue", "[", 
     RowBox[{
      RowBox[{"DTissue", "[", 
       RowBox[{"v_", ",", "e_", ",", "c_"}], "]"}], ",", " ", "sim_", ",", 
      "time_", ",", 
      RowBox[{"x_:", "Global`x"}], ",", 
      RowBox[{"y_:", "Global`y"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"vnew", ",", "NV", ",", "vused", ",", "vflags", ",", "vold"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NV", " ", "=", " ", 
        RowBox[{"Length", "[", "v", "]"}]}], ";", " ", "\[IndentingNewLine]", 
       
       RowBox[{"vused", "=", 
        RowBox[{"VerticesUsed", "[", 
         RowBox[{"DTissue", "[", 
          RowBox[{"v", ",", "e", ",", "c"}], "]"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"vflags", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"vused", ",", "#"}], "]"}], "&"}], "/@", 
         RowBox[{"Range", "[", "NV", "]"}]}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"vold", " ", "=", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"x", "[", "#", "]"}], "[", "time", "]"}], ",", 
              RowBox[{
               RowBox[{"y", "[", "#", "]"}], "[", "time", "]"}]}], "}"}], 
            "&"}], "/@", 
           RowBox[{"Range", "[", "NV", "]"}]}], ")"}], "/.", 
         RowBox[{"Flatten", "[", "sim", "]"}]}]}], ";", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"vnew", " ", "=", " ", 
        RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{"#1", ",", " ", "#2", ",", 
             RowBox[{"{", 
              RowBox[{"\[Infinity]", ",", "\[Infinity]"}], "}"}]}], "]"}], 
           "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"vflags", ",", "vold"}], "}"}]}], "\[IndentingNewLine]", 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Tissue", "[", 
        RowBox[{"vnew", ",", "e", ",", 
         RowBox[{"Last", "/@", "c"}]}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DTissue2Tissue", "[", "x___", "]"}], ":=", " ", "$Failed"}], 
   ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.546082280788275*^9, 3.546082429695743*^9}, {
  3.546082680646585*^9, 3.54608281075209*^9}, {3.546111060496684*^9, 
  3.546111118043584*^9}, {3.5461111573139477`*^9, 3.5461111695814157`*^9}, {
  3.54611120189855*^9, 3.546111282293605*^9}, {3.546111588562544*^9, 
  3.546111589443584*^9}, {3.546111658121417*^9, 3.5461116626692643`*^9}, {
  3.54611174020289*^9, 3.5461117570206137`*^9}, {3.547052973901469*^9, 
  3.547052991575747*^9}, {3.547053381778501*^9, 3.547053589678685*^9}, {
  3.547053658152973*^9, 3.547053783664053*^9}, {3.547053856841299*^9, 
  3.547053859572516*^9}},ExpressionUUID->"6374c587-9971-46ad-a5d9-\
42077aeb1fbf"]
}, Closed]],

Cell[CellGroupData[{

Cell["DeleteCell", "Subsection",
 CellChangeTimes->{{3.5460838892404013`*^9, 
  3.54608389087969*^9}},ExpressionUUID->"38567d7c-dcbb-4cbe-87cb-\
50a563e69d7c"],

Cell["\<\
This removes a cell from a dynamic tissue
But does not remove unused edges and vertices. This keeps the old edge/vertex \
indices the same. 
\
\>", "Text",
 CellChangeTimes->{{3.547043449940116*^9, 3.5470435134269543`*^9}, {
  3.547044222605076*^9, 
  3.547044244811154*^9}},ExpressionUUID->"a07cc77f-e2c7-4c56-bf02-\
4cd7f5999919"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DeleteCell", "[", 
     RowBox[{
      RowBox[{"dtissue_", "?", "DTissueQ"}], ",", " ", "n_"}], "]"}], ":=", 
    " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "v", ",", "e", ",", "c", ",", "T", ",", "cells", ",", "indices", ",", 
        " ", "found"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"v", "=", 
        RowBox[{"TissueVertices", "[", "dtissue", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"e", "=", 
        RowBox[{"TissueEdges", "[", "dtissue", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"c", "=", 
        RowBox[{"TissueCells", "[", "dtissue", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"indices", "=", 
        RowBox[{"First", "/@", "c"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"found", " ", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{"indices", ",", "n"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"found", "\[Equal]", 
          RowBox[{"{", "}"}]}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Warning: attempt to delete non-existent cell \>\"", ",", "n", 
            ",", " ", "\"\< failed.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "dtissue", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"found", "=", 
        RowBox[{"found", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"indices", " ", "=", " ", 
        RowBox[{"Drop", "[", 
         RowBox[{"indices", ",", 
          RowBox[{"{", "found", "}"}]}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"cells", " ", "=", " ", 
        RowBox[{"Drop", "[", 
         RowBox[{
          RowBox[{"Last", "/@", "c"}], ",", " ", 
          RowBox[{"{", "found", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"c", " ", "=", " ", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", 
          RowBox[{"{", 
           RowBox[{"indices", ",", "cells"}], "}"}]}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"DTissue", "[", 
         RowBox[{"v", ",", "e", ",", "c"}], "]"}], "]"}], ";"}]}], " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}], 
  " "}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5460838975394917`*^9, 3.546083947020176*^9}, {
  3.546084025165688*^9, 3.546084093839059*^9}, {3.5460841573673067`*^9, 
  3.546084275466772*^9}, {3.54608430857753*^9, 3.54608434821282*^9}, {
  3.546084379753141*^9, 3.546084458943759*^9}, {3.5460854073247023`*^9, 
  3.546085421508142*^9}, {3.546085796266562*^9, 3.546085824130125*^9}, {
  3.546086219180757*^9, 3.54608622303353*^9}, {3.546086300894093*^9, 
  3.5460863528050823`*^9}, {3.547043555610477*^9, 3.547043581884078*^9}, {
  3.5470436359115973`*^9, 3.547043644655407*^9}, {3.5470440589030743`*^9, 
  3.547044067464135*^9}, {3.5470441128756323`*^9, 3.547044156518456*^9}, {
  3.547044196379923*^9, 3.547044216603682*^9}, {3.548518673258849*^9, 
  3.548518674370758*^9}},ExpressionUUID->"474db993-bfc5-44ff-ad22-\
97b60e15805c"]
}, Closed]],

Cell[CellGroupData[{

Cell["CellAreaEquations", "Subsection",
 CellChangeTimes->{{3.54608739711767*^9, 
  3.546087399299046*^9}},ExpressionUUID->"64462048-e7e6-4526-ae3a-\
d6a69de3bc37"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CellAreaEquations", "[", 
     RowBox[{
      RowBox[{"tissue_", "?", "TissueQ"}], ",", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "x", ",", "y", ",", "area", ",", " ", "xy", ",", " ", "dbg", ",", " ", 
        "dPrint"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"dbg", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<debug\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<debug\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";", 
       " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dPrint", "[", "u___", "]"}], ":=", " ", 
        RowBox[{"If", "[", 
         RowBox[{"dbg", ",", " ", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<CellAreaEquations (1): \>\"", ",", " ", "u"}], 
           "]"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", "\"\<Begin\>\"", "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"xy", "=", 
        RowBox[{
         RowBox[{"\"\<xy\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<xy\>\"", "\[Rule]", " ", "True"}], "}"}]}]}], ";", " ",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"x", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<x\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<x\>\"", "\[Rule]", " ", "Global`x"}], "}"}]}]}], ";", 
       " ", "\[IndentingNewLine]", 
       RowBox[{"y", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<y\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<y\>\"", "\[Rule]", " ", "Global`y"}], "}"}]}]}], ";", 
       " ", "\[IndentingNewLine]", 
       RowBox[{"area", "=", 
        RowBox[{
         RowBox[{"\"\<CellVariable\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<CellVariable\>\"", "\[Rule]", " ", "Global`cell"}], 
          "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ToString", "[", "area", "]"}], "\[Equal]", 
          "\"\<False\>\""}], ",", " ", 
         RowBox[{"Return", "[", 
          RowBox[{"{", "}"}], "]"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"AbortIf", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ToString", "[", "xy", "]"}], "\[Equal]", "\"\<False\>\""}],
          ",", " ", 
         RowBox[{"\"\<\\\"CellVariable\\\"\[Rule]\>\"", "<>", 
          RowBox[{"ToString", "[", "area", "]"}], "<>", 
          "\"\< but \\\"xy\\\"\[Rule]False; vertex coordinates must be \
recorded if the area is to be calculated.\>\""}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<x:\>\"", ",", " ", "x"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<y:\>\"", ",", " ", "y"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<area:\>\"", ",", " ", "area"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<{opt}:\>\"", ",", 
         RowBox[{"{", "opt", "}"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
       
       RowBox[{"CellAreaEquations", "[", 
        RowBox[{"tissue", ",", "x", ",", "y", ",", "area", ",", "opt"}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CellAreaEquations", "[", 
    RowBox[{
     RowBox[{"tissue_", "?", "TissueQ"}], ",", "x_", ",", "y_", ",", " ", 
     "area_", ",", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "vertices", ",", " ", "f", ",", "cellnumbers", ",", "nc", ",", "eqlhs", 
       ",", " ", "eqrhs", ",", " ", "equations", ",", " ", "dbg", ",", " ", 
       "dPrint"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dbg", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<debug\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<debug\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dPrint", "[", "u___", "]"}], ":=", " ", 
       RowBox[{"If", "[", 
        RowBox[{"dbg", ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<CellAreaEquations (2): \>\"", ",", " ", "u"}], "]"}]}],
         "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", "\"\<Begin\>\"", "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"vertices", " ", "=", " ", 
       RowBox[{"CellVertexNumbers", "[", "tissue", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<vertices:\>\"", ",", " ", "vertices"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"nc", " ", "=", " ", 
       RowBox[{"Length", "[", "vertices", "]"}]}], ";", "  ", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "area", " ", "function", " ", "for", " ", "a", " ", "single", " ", 
        "cell"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"f", "[", "vlist_", "]"}], ":=", " ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "coords", "}"}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"coords", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"x", "[", "#", "]"}], "[", "Global`t", "]"}], ",", 
               RowBox[{
                RowBox[{"y", "[", "#", "]"}], "[", "Global`t", "]"}]}], "}"}],
              "&"}], "/@", "vlist"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"areafunction", "[", "coords", "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"cellnumbers", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<Numbers\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Numbers\>\"", "\[Rule]", " ", 
          RowBox[{"{", "}"}]}], "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<cellnumbers:\>\"", ",", " ", "cellnumbers"}], "]"}], ";", 
      " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"cellnumbers", "\[Equal]", 
         RowBox[{"{", "}"}]}], ",", " ", 
        RowBox[{"cellnumbers", " ", "=", " ", 
         RowBox[{"Range", "[", "nc", "]"}]}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "cellnumbers", "]"}], "<", "nc"}], ",", " ", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Error: \>\"", ",", " ", 
           RowBox[{"Length", "[", "cellnumbers", "]"}], ",", " ", 
           "\"\< cell numbers provided for \>\"", ",", " ", "nc", ",", 
           "\"\< cells.\>\""}], "]"}], ";", " ", 
         RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"eqlhs", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"area", "[", "#", "]"}], "[", "Global`t", "]"}], "&"}], "/@",
         "cellnumbers"}]}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"eqrhs", " ", "=", " ", 
       RowBox[{"f", "/@", "vertices"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"equations", " ", "=", " ", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Equal", ",", 
         RowBox[{"{", 
          RowBox[{"eqlhs", ",", "eqrhs"}], "}"}]}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CellAreaEquations", "[", 
    RowBox[{
     RowBox[{"tissue_", "?", "DTissueQ"}], ",", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "cellnumbers", ",", " ", "T", ",", " ", "dbg", ",", " ", "dPrint"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dbg", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<debug\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<debug\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dPrint", "[", "u___", "]"}], ":=", " ", 
       RowBox[{"If", "[", 
        RowBox[{"dbg", ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<CellAreaEquations (3): \>\"", ",", " ", "u"}], "]"}]}],
         "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", "\"\<Begin\>\"", "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"T", "=", 
       RowBox[{"DTissue2Tissue", "[", "tissue", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"cellnumbers", " ", "=", " ", 
       RowBox[{"First", "/@", 
        RowBox[{"TissueCells", "[", "tissue", "]"}]}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<cellnumbers:\>\"", ",", " ", "cellnumbers"}], "]"}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{"CellAreaEquations", "[", 
       RowBox[{"T", ",", 
        RowBox[{"\"\<Numbers\>\"", "\[Rule]", " ", "cellnumbers"}], ",", " ", 
        "opt"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CellAreaEquations", "[", 
   RowBox[{
    RowBox[{"tissue_", "?", "DTissueQ"}], ",", " ", "x_", ",", "y_", ",", 
    "area_", ",", 
    RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "cellnumbers", ",", " ", "T", ",", " ", "dbg", ",", " ", "dPrint"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dbg", " ", "=", " ", 
      RowBox[{
       RowBox[{"\"\<debug\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<debug\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";", 
     " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dPrint", "[", "u___", "]"}], ":=", " ", 
      RowBox[{"If", "[", 
       RowBox[{"dbg", ",", " ", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<CellAreaEquations (4): \>\"", ",", " ", "u"}], "]"}]}], 
       "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", "\"\<Begin\>\"", "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"T", "=", 
      RowBox[{"DTissue2Tissue", "[", "tissue", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"cellnumbers", " ", "=", " ", 
      RowBox[{"First", "/@", 
       RowBox[{"TissueCells", "[", "tissue", "]"}]}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"CellAreaEquations", "[", 
      RowBox[{"T", ",", "x", ",", "y", ",", "area", ",", 
       RowBox[{"\"\<Numbers\>\"", "\[Rule]", " ", "cellnumbers"}], ",", " ", 
       "opt"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.546087413189657*^9, 3.5460874675878487`*^9}, {
   3.546087599125532*^9, 3.5460881209459143`*^9}, 3.546088180128736*^9, 
   3.546088211267352*^9, {3.546088274056192*^9, 3.546088278212468*^9}, 
   3.546088807972484*^9, {3.546088841754723*^9, 3.546088972169478*^9}, {
   3.5460890128203497`*^9, 3.5460890260044613`*^9}, 3.546089281550166*^9, {
   3.5460893240909243`*^9, 3.546089442263562*^9}, {3.54713171003438*^9, 
   3.547131713711877*^9}, {3.5760054638008347`*^9, 3.57600561512017*^9}, 
   3.576006048367857*^9, {3.576614273132934*^9, 3.57661427510177*^9}, {
   3.576619968313513*^9, 3.576619971020747*^9}, {3.705711541576069*^9, 
   3.705711547181988*^9}, {3.705964245340951*^9, 3.7059642946365957`*^9}, {
   3.705964325972542*^9, 3.705964476426003*^9}, {3.705964541671258*^9, 
   3.705964597692943*^9}, {3.70596470454947*^9, 3.7059647554684353`*^9}, {
   3.705964801198125*^9, 3.705964809413772*^9}, {3.705964857236268*^9, 
   3.705964933440997*^9}, {3.705964969388509*^9, 3.705965016596264*^9}, {
   3.705965048632956*^9, 
   3.705965064454455*^9}},ExpressionUUID->"96233783-a1b2-4022-b100-\
4c696309b907"]
}, Closed]],

Cell[CellGroupData[{

Cell["FastPolyArea", "Subsection",
 CellChangeTimes->{{3.546703608285181*^9, 
  3.546703615572501*^9}},ExpressionUUID->"10a73768-8445-4928-9b43-\
be93c6386b95"],

Cell["\<\
calculate area of a sector of a polygon between two angles. with sum of \
triangle areas (1/2)*base*height: \
\>", "Text",
 CellChangeTimes->{{3.546708703201157*^9, 3.5467087146171618`*^9}, {
  3.5657576850236053`*^9, 
  3.565757714830934*^9}},ExpressionUUID->"4ee2e740-16aa-4a29-8cc7-\
7117f6afeaca"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FastPolyArea", "[", 
    RowBox[{"r_", ",", "angle1_", ",", "angle2_", ",", " ", 
     RowBox[{"nint_:", "50"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "angles", ",", " ", "dtheta", ",", "rs", ",", "left", ",", "right", ",",
        "sindtheta"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dtheta", " ", "=", " ", 
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"angle2", "-", "angle1"}], "]"}], "/", "nint"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"sindtheta", " ", "=", " ", 
       RowBox[{"Sin", "[", "dtheta", "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"angles", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"angle1", "+", 
          RowBox[{"i", "*", "dtheta"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", "nint"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"rs", " ", "=", " ", 
       RowBox[{"r", "/@", "angles"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Most", "[", "rs", "]"}], ".", 
         RowBox[{"Rest", "[", "rs", "]"}]}], ")"}], "*", "0.5", "*", 
       "sindtheta"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.546703620200322*^9, 3.546703775649757*^9}, {
  3.5467038806664753`*^9, 3.546703980974257*^9}, {3.5467040243428993`*^9, 
  3.546704024991284*^9}, {3.546704648950371*^9, 3.5467046493907747`*^9}, {
  3.546705641831337*^9, 3.546705772316853*^9}, {3.5467058482822866`*^9, 
  3.546705852353796*^9}},ExpressionUUID->"6c82f3fb-1caa-48b4-bb40-\
dab598d187a4"],

Cell["Replace area with trapezoidal rule integration", "Text",
 CellChangeTimes->{{3.546708687993866*^9, 
  3.546708698176998*^9}},ExpressionUUID->"f153ec80-7b70-4677-a343-\
848c1744315b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FastTrapPolyArea", "[", 
   RowBox[{"r_", ",", "angle1_", ",", "angle2_", ",", 
    RowBox[{"nint_:", "50"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "dtheta", ",", "angles", ",", "rs", ",", "first", ",", " ", "last"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dtheta", " ", "=", " ", 
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{"angle2", "-", "angle1"}], "]"}], "/", "nint"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"angles", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"angle1", "+", 
         RowBox[{"i", "*", "dtheta"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "nint"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rs", " ", "=", " ", 
      RowBox[{"r", "/@", "angles"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rs", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "^", "2"}], "&"}], "/@", "rs"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"first", " ", "=", " ", 
      RowBox[{"First", "[", "rs", "]"}]}], ";", " ", 
     RowBox[{"last", " ", "=", " ", 
      RowBox[{"Last", "[", "rs", "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"first", " ", "+", " ", "last"}], ")"}], " ", "+", " ", 
        RowBox[{"(", 
         RowBox[{"Plus", "@@", "rs"}], ")"}]}], ")"}], "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"angle2", "-", "angle1"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"2.0", "*", "nint"}], ")"}]}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.546708021896196*^9, 3.546708084054721*^9}, {
  3.5467081369136333`*^9, 3.546708140471718*^9}, {3.546708172616221*^9, 
  3.5467082789373198`*^9}, {3.546708323386384*^9, 3.5467083307154284`*^9}, {
  3.546708363374147*^9, 3.5467083635138187`*^9}, {3.546708449640389*^9, 
  3.546708477658535*^9}},ExpressionUUID->"33d6e7bf-6314-45ba-9079-\
464f9fb8e458"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FastTrapPartialArea", "[", 
   RowBox[{"r_", ",", "angle1_", ",", "angle2_", ",", 
    RowBox[{"nint_:", "50"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "sector", ",", "triangle", ",", "DTR", ",", "r1", ",", "r2", ",", "r3", 
      ",", "a1", ",", "a2", ",", "sign"}], "}"}], ",", 
    RowBox[{
     RowBox[{"a1", "=", 
      RowBox[{"Min", "[", 
       RowBox[{"angle1", ",", "angle2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a2", "=", 
      RowBox[{"Max", "[", 
       RowBox[{"angle1", ",", "angle2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sector", "=", 
      RowBox[{"FastTrapPolyArea", "[", 
       RowBox[{"r", ",", "angle1", ",", "angle2", ",", "nint"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"r1", "=", 
      RowBox[{"r", "[", "angle1", "]"}]}], ";", 
     RowBox[{"r2", "=", 
      RowBox[{"r", "[", "angle2", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"triangle", "=", 
      RowBox[{"Hero2", "[", 
       RowBox[{"r1", ",", "r2", ",", 
        RowBox[{"(", 
         RowBox[{"angle2", "-", "angle1"}], ")"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sign", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"angle1", "-", "angle2"}], "]"}], "<", "Pi"}], ",", 
        RowBox[{"-", "1"}], ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sector", "+", 
      RowBox[{"sign", "*", "triangle"}]}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.565794537870386*^9, 3.5657945603599052`*^9}, {
   3.565794664355193*^9, 3.565794669973608*^9}, 
   3.565796585678691*^9},ExpressionUUID->"3b365ef5-89bc-4246-b0ef-\
33ff55138009"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FastPolyPartialArea", "[", 
   RowBox[{"r_", ",", "angle1_", ",", "angle2_", ",", 
    RowBox[{"nint_:", " ", "50"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "sector", ",", "triangle", ",", "r1", ",", "r2", ",", "a1", ",", "a2", 
      ",", "sign"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a1", "=", 
      RowBox[{"Min", "[", 
       RowBox[{"angle1", ",", "angle2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a2", "=", 
      RowBox[{"Max", "[", 
       RowBox[{"angle1", ",", "angle2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sector", "=", 
      RowBox[{"FastPolyArea", "[", 
       RowBox[{"r", ",", "angle1", ",", "angle2", ",", "nint"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"r1", "=", 
      RowBox[{"r", "[", "angle1", "]"}]}], ";", 
     RowBox[{"r2", "=", 
      RowBox[{"r", "[", "angle2", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"triangle", "=", 
      RowBox[{"Hero2", "[", 
       RowBox[{"r1", ",", "r2", ",", 
        RowBox[{"(", 
         RowBox[{"angle2", "-", "angle1"}], ")"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sign", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"angle1", "-", "angle2"}], "]"}], "<", "Pi"}], ",", 
        RowBox[{"-", "1"}], ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sector", "+", 
      RowBox[{"sign", "*", "triangle"}]}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5657967227086763`*^9, 
  3.5657967834359083`*^9}},ExpressionUUID->"9c5cfe9a-d52e-4bce-8145-\
6c2afd991001"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PartialArea", "[", 
   RowBox[{"r_", ",", "theta1_", ",", "theta2_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"pts", ",", "dt"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"theta1", "\[Equal]", "theta2"}], ",", " ", 
       RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"dt", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"theta2", "-", "theta1"}], ")"}], "/", "n"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pts", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"r", "[", "#", "]"}], " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Cos", "[", "#", "]"}], ",", 
           RowBox[{"Sin", "[", "#", "]"}]}], "}"}]}], "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"theta1", ",", 
         RowBox[{"theta2", "-", "dt"}], ",", "dt"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "pts", "]"}], "<", "3"}], ",", 
       RowBox[{"Return", "[", "0.", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"areafunction", "[", "pts", "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.565757939867495*^9, 3.565757946841041*^9}, {
   3.565758924110673*^9, 3.565758933376189*^9}, {3.565760585379319*^9, 
   3.565760634420924*^9}, {3.565760700020741*^9, 3.565760745355918*^9}, 
   3.565760797540271*^9, {3.705712866164426*^9, 
   3.705712868771782*^9}},ExpressionUUID->"1e09983b-90d2-4ebf-9389-\
f754529e7f99"],

Cell["Similar function, but angles and r are  in degrees", "Text",
 CellChangeTimes->{{3.566139095937133*^9, 
  3.566139131536688*^9}},ExpressionUUID->"a164cad1-cfd7-43ae-a18a-\
7b0c7a448191"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FastPolyDegAreaSector", "[", 
     RowBox[{"r_", ",", "angle1_", ",", "angle2_", ",", 
      RowBox[{"nint_:", " ", "50"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "angles", ",", "dtheta", ",", "rs", ",", "left", ",", "right", ",", 
        "sindtheta", ",", "DTR"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DTR", "=", 
        RowBox[{"Pi", "/", "180.0"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dtheta", "=", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"angle2", "-", "angle1"}], "]"}], "/", "nint"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sindtheta", "=", 
        RowBox[{"Sin", "[", 
         RowBox[{"dtheta", "*", "DTR"}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"angles", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"angle1", "+", 
           RowBox[{"i", "*", "dtheta"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", "nint"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rs", "=", 
        RowBox[{"r", "/@", "angles"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Most", "[", "rs", "]"}], ".", 
          RowBox[{"Rest", "[", "rs", "]"}]}], ")"}], "*", "0.5", "*", 
        "sindtheta"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"FastPolyDegArea", "[", 
   RowBox[{"r_", ",", "angle1_", ",", "angle2_", ",", 
    RowBox[{"nint_:", " ", "50"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "sector", ",", "triangle", ",", "DTR", ",", "r1", ",", "r2", ",", "r3", 
      ",", "a1", ",", "a2", ",", "sign"}], "}"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"a1", "=", 
      RowBox[{"Min", "[", 
       RowBox[{"angle1", ",", "angle2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a2", "=", 
      RowBox[{"Max", "[", 
       RowBox[{"angle1", ",", "angle2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sector", "=", 
      RowBox[{"FastPolyDegAreaSector", "[", 
       RowBox[{"r", ",", "angle1", ",", "angle2", ",", "nint"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"DTR", "=", 
      RowBox[{"Pi", "/", "180.0"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"r1", "=", 
      RowBox[{"r", "[", "angle1", "]"}]}], ";", 
     RowBox[{"r2", "=", 
      RowBox[{"r", "[", "angle2", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"triangle", "=", 
      RowBox[{"Hero2", "[", 
       RowBox[{"r1", ",", "r2", ",", 
        RowBox[{"DTR", "*", 
         RowBox[{"(", 
          RowBox[{"angle2", "-", "angle1"}], ")"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sign", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"angle1", "-", "angle2"}], "]"}], "<", "180"}], ",", 
        RowBox[{"-", "1"}], ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sector", "+", 
      RowBox[{"sign", "*", "triangle"}]}]}]}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5661391105124807`*^9, 
  3.566139147994272*^9}},ExpressionUUID->"59c8c247-6604-4359-8c1a-\
cb3bee8a1992"]
}, Closed]],

Cell[CellGroupData[{

Cell["Errera", "Subsection",
 CellChangeTimes->{{3.566139161264782*^9, 
  3.566139162264474*^9}},ExpressionUUID->"cb0db941-c833-4ffd-a6f8-\
007402962455"],

Cell["\<\
HalfAngleArea[r, theta, A] uses a secant method to find the angle phi such \
that the line from theta to phi splits the area of the polygon described by r \
in half. 
r[theta] = Interpolation function in degrees  (periodic in 360)
A = Area of the cell

Errera[r, npts] finds the angle pair (and point point) for the shortest path \
to divide the cell in half using a global search of npts points. For example \
Errera[r,100] will find the half-angle pairs predicted by HalfAngleArea at \
100 points and then return the location of the shortest one.

Errera[vertices, npts] performs the same function but  takes vertices rather \
than interpolation function as input; \
\>", "Text",
 CellChangeTimes->{{3.5661391877540417`*^9, 3.566139235600325*^9}, {
  3.566141597408633*^9, 
  3.5661416006398277`*^9}},ExpressionUUID->"649214d0-f0cc-4acd-8b2d-\
d1dad9ae1326"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"HalfAreaAngle", "[", 
    RowBox[{"r_", ",", "theta1_", ",", "A_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "f", ",", "x1", ",", "x2", ",", "y1", ",", "y2", ",", "i", ",", "x3", 
       ",", "y3", ",", "yprime", ",", "imin"}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", "\[Theta]_", "]"}], ":=", 
       RowBox[{
        RowBox[{"FastPolyDegArea", "[", 
         RowBox[{"r", ",", "theta1", ",", 
          RowBox[{"theta1", "+", "\[Theta]"}], ",", "500"}], "]"}], "-", 
        RowBox[{"A", "/", "2"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"x1", "=", "90"}], ";", 
      RowBox[{"x2", "=", "180"}], ";", "\[IndentingNewLine]", 
      RowBox[{"y1", "=", 
       RowBox[{"f", "[", "x1", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"y2", "=", 
       RowBox[{"f", "[", "x2", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"i", "\[LessEqual]", "5"}], ")"}], "\[And]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{"x1", "-", "x2"}], "]"}], ">", ".1"}], ")"}]}], ")"}], 
        ",", 
        RowBox[{"i", "++"}], ",", 
        RowBox[{
         RowBox[{"yprime", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"y2", "-", "y1"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"x2", "-", "x1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
         
         RowBox[{"x3", "=", 
          RowBox[{"x2", "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"f", "[", "x2", "]"}], "/", "yprime"}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"y3", "=", 
          RowBox[{"f", "[", "x3", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"x1", "=", "x2"}], ";", 
         RowBox[{"x2", "=", "x3"}], ";", 
         RowBox[{"y1", "=", "y2"}], ";", 
         RowBox[{"y2", "=", "y3"}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"theta1", "+", "x2"}], "]"}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Errera", "[", 
    RowBox[{"r_InterpolatingFunction", ",", "npts_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "anglepairs", ",", "A", ",", "point", ",", "DTR", ",", "points", ",", 
       "distances", ",", "imin"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DTR", "=", 
       RowBox[{"Pi", "/", "180."}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"A", "=", 
       RowBox[{"FastPolyDegArea", "[", 
        RowBox[{"r", ",", "0", ",", "360", ",", "500"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"anglepairs", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"#", ",", 
           RowBox[{"HalfAreaAngle", "[", 
            RowBox[{"r", ",", "#", ",", "A"}], "]"}]}], "}"}], "&"}], "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"0.", ",", "360.", ",", 
          RowBox[{"360.", "/", "npts"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"point", "[", "theta_", "]"}], ":=", 
       RowBox[{
        RowBox[{"r", "[", "theta", "]"}], "*", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"theta", "*", "DTR"}], "]"}], ",", 
          RowBox[{"Sin", "[", 
           RowBox[{"theta", "*", "DTR"}], "]"}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"points", "[", "angles_", "]"}], ":=", 
       RowBox[{"point", "/@", "angles"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"distances", "=", 
       RowBox[{"points", "/@", "anglepairs"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"distances", "=", 
       RowBox[{"Norm", "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Subtract", "@@", "#"}], "&"}], "/@", "distances"}], 
         ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"imin", "=", 
       RowBox[{
        RowBox[{"Ordering", "[", 
         RowBox[{"distances", ",", "1"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"anglepairs", "[", 
         RowBox[{"[", "imin", "]"}], "]"}], ",", 
        RowBox[{"points", "[", 
         RowBox[{"anglepairs", "[", 
          RowBox[{"[", "imin", "]"}], "]"}], "]"}]}], "}"}]}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Errera", "[", 
   RowBox[{
    RowBox[{"vertices_", "?", "ListQ"}], ",", "npts_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "center", ",", "xyz", ",", "angles", ",", "rdeg", ",", "data", ",", 
      "rrad", ",", " ", "result", ",", " ", "point1", ",", "point2", ",", 
      RowBox[{"dbg", "=", "False"}], ",", " ", "dPrint"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"dPrint", "[", "x___", "]"}], ":=", " ", 
      RowBox[{"If", "[", 
       RowBox[{"dbg", ",", " ", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Errera: \>\"", ",", " ", "x"}], "]"}]}], "]"}]}], ";", 
     " ", "\[IndentingNewLine]", 
     RowBox[{"center", "=", 
      RowBox[{"Centroid", "[", "vertices", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"xyz", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"#", "-", "center"}], ")"}], "&"}], "/@", "vertices"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"rrad", "=", 
      RowBox[{"RadialPolygon", "[", 
       RowBox[{"xyz", ",", "npts"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"theta", "*", 
           RowBox[{"180.0", "/", "Pi"}]}], ",", 
          RowBox[{"rrad", "[", "theta", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"theta", ",", "0", ",", 
          RowBox[{"2", " ", "Pi"}], ",", 
          RowBox[{"2.0", "*", 
           RowBox[{"Pi", "/", "npts"}]}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rdeg", "=", 
      RowBox[{"Interpolation", "[", 
       RowBox[{"data", ",", 
        RowBox[{"InterpolationOrder", "\[Rule]", "1"}], ",", 
        RowBox[{"PeriodicInterpolation", "\[Rule]", "True"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"angles", ",", " ", 
        RowBox[{"{", 
         RowBox[{"point1", ",", "point2"}], "}"}]}], "}"}], "=", 
      RowBox[{"Errera", "[", 
       RowBox[{"rdeg", ",", "npts"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"angles", " ", "=", " ", 
      RowBox[{"Sort", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Mod", "[", 
          RowBox[{"#", ",", "360"}], "]"}], "&"}], "/@", "angles"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{"{", 
       RowBox[{"angles", ",", 
        RowBox[{"center", "+", "point1"}], ",", 
        RowBox[{"center", "+", "point2"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<vertices: \>\"", ",", " ", "xyz"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<result: \>\"", ",", " ", "result"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"Graphics", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"Append", "[", 
           RowBox[{"xyz", ",", 
            RowBox[{"First", "[", "xyz", "]"}]}], "]"}], "]"}], ",", " ", 
         RowBox[{"PointSize", "[", ".02", "]"}], ",", "Dashed", ",", " ", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{"point1", ",", "point2"}], "}"}], "]"}], ",", "  ", 
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"point1", ",", "point2"}], "}"}], "]"}]}], "}"}], "]"}], 
      "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "result", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\n"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.566139175831271*^9, 3.566139175831944*^9}, {
   3.566139251229533*^9, 3.566139268630981*^9}, {3.5661393139079037`*^9, 
   3.566139343638578*^9}, {3.566141617840149*^9, 3.566141676320842*^9}, {
   3.5661418140538263`*^9, 3.566141866591196*^9}, 3.566141902743599*^9, {
   3.5661420423624773`*^9, 3.566142091056238*^9}, {3.56614212900893*^9, 
   3.566142212504088*^9}, {3.56614254105831*^9, 3.566142543201109*^9}, {
   3.566143200929431*^9, 3.566143205525629*^9}, {3.566143311322667*^9, 
   3.566143312197007*^9}},ExpressionUUID->"2a9759db-22bd-4d4e-91c0-\
da16fd18065b"]
}, Closed]],

Cell[CellGroupData[{

Cell["AreaPotential", "Subsection",
 CellChangeTimes->{{3.546358378143757*^9, 
  3.546358396824191*^9}},ExpressionUUID->"b0c20073-81b0-4163-97a9-\
0a076aa90831"],

Cell["\<\
r is the output of radialpolygon, periodic, in radians
theta1, theta2 are in radians\
\>", "Text",
 CellChangeTimes->{{3.565455801365507*^9, 
  3.565455815596964*^9}},ExpressionUUID->"4c7984c1-3add-40dc-960f-\
37382340a81a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AreaPotentialMatrix", "[", 
    RowBox[{"points_", ",", "dtheta_", ",", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "A", ",", "r", ",", "n", ",", " ", "theta1", ",", "theta2", ",", 
       "delta", ",", "v", ",", "V", ",", "i", ",", "j", ",", "m"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{
        RowBox[{"\"\<Intervals\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Intervals\>\"", "\[Rule]", " ", "100"}], "}"}]}]}], ";",
       " ", "\[IndentingNewLine]", 
      RowBox[{"r", "=", 
       RowBox[{"RadialPolygon", "[", 
        RowBox[{"points", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"A", "=", 
         RowBox[{"NIntegrate", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"r", "[", "t", "]"}], "*", 
            RowBox[{
             RowBox[{"r", "[", "t", "]"}], "/", "2.0"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", 
             RowBox[{"2", "Pi"}]}], "}"}], ",", 
           RowBox[{"Method", "\[Rule]", "\"\<TrapezoidalRule\>\""}]}], 
          "]"}]}], ";"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"A", "=", 
       RowBox[{"FastPolyArea", "[", 
        RowBox[{"r", ",", "0", ",", 
         RowBox[{"2", "Pi"}], ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"delta", " ", "=", " ", 
       RowBox[{"dtheta", " ", "*", 
        RowBox[{"Pi", "/", "180"}]}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"m", "=", 
       RowBox[{"Round", "[", 
        RowBox[{"360.0", "/", "dtheta"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"V", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", "m"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"j", ",", "0", ",", "m"}], "}"}]}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "0"}], ",", 
        RowBox[{"i", "\[LessEqual]", " ", "m"}], ",", " ", 
        RowBox[{"i", "++"}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"theta1", " ", "=", " ", 
          RowBox[{"i", "*", "delta"}]}], ";", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"V", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"i", "+", "1"}], ",", 
             RowBox[{"i", "+", "1"}]}], "]"}], "]"}], "=", "Infinity"}], ";", 
         " ", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", 
            RowBox[{"i", "+", "1"}]}], ",", 
           RowBox[{"j", "\[LessEqual]", " ", "m"}], ",", 
           RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"theta2", "=", 
             RowBox[{"j", "*", "delta"}]}], ";", " ", "\[IndentingNewLine]", 
            RowBox[{"v", " ", "=", " ", 
             RowBox[{"AreaPotentialFunction", "[", 
              RowBox[{"r", ",", "A", ",", "theta1", ",", "theta2"}], "]"}]}], 
            ";", " ", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"V", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"i", "+", "1"}], ",", 
                RowBox[{"j", "+", "1"}]}], "]"}], "]"}], "=", "v"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"V", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"j", "+", "1"}], ",", 
                RowBox[{"i", "+", "1"}]}], "]"}], "]"}], "=", "v"}], ";"}]}], 
          " ", "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "V"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AreaPotentialFunction", "[", 
   RowBox[{"r_", ",", "A_", ",", "theta1_", ",", "theta2_"}], "]"}], ":=", 
  " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "r1", ",", "r2", ",", "Astart", ",", "Aend", ",", "triangle", ",", "A1", 
      ",", "A2", ",", "min", ",", "max", ",", "n1", ",", " ", "angle1", ",", 
      " ", "angle2", ",", " ", 
      RowBox[{"teeny", "=", ".001"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"theta1", "\[Equal]", " ", "theta2"}], ",", " ", 
       RowBox[{"Return", "[", "1", "]"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"angle1", ",", " ", "angle2"}], "}"}], "=", 
      RowBox[{"Sort", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Mod", "[", 
          RowBox[{"#", ",", 
           RowBox[{"2", "Pi"}]}], "]"}], "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{"theta1", ",", " ", "theta2"}], "}"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"angle1", "-", "angle2"}], "]"}], "<", "teeny"}], ",", " ", 
       RowBox[{"Return", "[", "1", "]"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"A1", " ", "=", " ", 
      RowBox[{"FastPolyPartialArea", "[", 
       RowBox[{"r", ",", " ", "angle1", ",", " ", "angle2", ",", " ", "50"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"A2", " ", "=", " ", 
        RowBox[{
         RowBox[{"FastPolyArea", "[", 
          RowBox[{"r", ",", " ", "0", ",", " ", 
           RowBox[{"2", "Pi"}], ",", "50"}], "]"}], "-", "A1"}]}], ";"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"A2", "=", 
      RowBox[{"A", "-", "A1"}]}], ";", "\[IndentingNewLine]", " ", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"A1", "-", "A2"}], ")"}], "/", "A"}], ")"}], "^", "2"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.546358398720045*^9, 3.546358399595931*^9}, {
   3.546358935065279*^9, 3.546358967847088*^9}, {3.546359006952034*^9, 
   3.546359112357044*^9}, {3.5463591610058126`*^9, 3.546359193575918*^9}, {
   3.546359807953319*^9, 3.546359809927868*^9}, {3.546359840082201*^9, 
   3.5463598545665083`*^9}, {3.5463599201832*^9, 3.546359952244686*^9}, {
   3.5463600468746*^9, 3.546360125789062*^9}, {3.546360168420691*^9, 
   3.5463602006726093`*^9}, {3.546360259504703*^9, 3.546360259698992*^9}, {
   3.546360390417643*^9, 3.546360563719433*^9}, {3.5463605941552258`*^9, 
   3.546360617802114*^9}, {3.54636066646841*^9, 3.546360885501539*^9}, {
   3.54636093519683*^9, 3.5463610636910954`*^9}, {3.5463611336754704`*^9, 
   3.5463611516665077`*^9}, {3.54636119248277*^9, 3.546361202919723*^9}, 
   3.546361276911243*^9, {3.546361453856933*^9, 3.546361670812071*^9}, {
   3.54636172470891*^9, 3.546361801817923*^9}, {3.546361850135247*^9, 
   3.54636186656707*^9}, {3.54636190080095*^9, 3.5463620011462812`*^9}, {
   3.546362216552519*^9, 3.5463622186162024`*^9}, {3.546377104963726*^9, 
   3.546377110962578*^9}, {3.546378298638974*^9, 3.546378298910227*^9}, {
   3.54637854010145*^9, 3.546378664864526*^9}, {3.546378797556243*^9, 
   3.546378806828203*^9}, {3.5463790327840843`*^9, 3.546379037365349*^9}, {
   3.546379658527121*^9, 3.54637968878778*^9}, {3.546385527365951*^9, 
   3.546385535380604*^9}, {3.5463858009922657`*^9, 3.5463858222406816`*^9}, {
   3.5467041083875847`*^9, 3.546704179425025*^9}, {3.546704379307827*^9, 
   3.546704430586793*^9}, {3.5467044863520947`*^9, 3.5467045851934433`*^9}, {
   3.546708587913971*^9, 3.546708637908934*^9}, {3.5467086687200212`*^9, 
   3.54670867947825*^9}, {3.565455789079124*^9, 3.565455792573288*^9}, {
   3.56545582760602*^9, 3.56545588369946*^9}, {3.565456123116776*^9, 
   3.565456127963291*^9}, {3.565457116163951*^9, 3.565457194816189*^9}, {
   3.565457306834548*^9, 3.565457337018099*^9}, {3.565457961735406*^9, 
   3.565457968073493*^9}, {3.565458241933275*^9, 3.565458263291893*^9}, {
   3.565458495425817*^9, 3.5654584999967337`*^9}, {3.5657590242048283`*^9, 
   3.56575902535907*^9}, {3.565760144644418*^9, 3.565760164956451*^9}, {
   3.565760332684219*^9, 3.5657603395002127`*^9}, {3.565760382061646*^9, 
   3.565760426196003*^9}, {3.565760488539525*^9, 3.565760545979806*^9}, 
   3.5657607834531393`*^9, {3.565794718030129*^9, 3.565794719315515*^9}, {
   3.5657968472406588`*^9, 3.565796849735322*^9}, {3.565796902773056*^9, 
   3.565796910532927*^9}, {3.565797022004725*^9, 3.5657970229322557`*^9}, {
   3.565797081937248*^9, 3.565797085652763*^9}, {3.565797255130666*^9, 
   3.565797270023364*^9}},ExpressionUUID->"94bcfc1c-8cda-4602-892c-\
ea861e54fae2"]
}, Closed]],

Cell[CellGroupData[{

Cell["LengthPotential", "Subsection",
 CellChangeTimes->{{3.546386419678583*^9, 
  3.5463864225827436`*^9}},ExpressionUUID->"aa80631d-7c5d-4075-8a45-\
9a67d9eed01f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$LENGTH\[UnderBracket]ALT\[UnderBracket]MULT", "=", "1.0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LengthPotentialFunction", "[", 
   RowBox[{"r_", ",", "dmin_", ",", " ", "theta1_", ",", " ", "theta2_"}], 
   "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "r1", ",", " ", "r2", ",", "x1", ",", "y1", ",", "x2", ",", "y2", ",", 
      "d", ",", "v1", ",", "v2", ",", "v3", ",", "cosa", ",", "sina", ",", 
      "h", ",", "V", ",", 
      RowBox[{"teeny", "=", ".0001"}], ",", " ", "altitude", ",", " ", "a", 
      ",", " ", 
      RowBox[{"dbg", "=", "False"}], ",", " ", "dPrint"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"dPrint", "[", "x___", "]"}], ":=", " ", 
      RowBox[{"If", "[", 
       RowBox[{"dbg", ",", " ", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<LengthPotentialFunction: \>\"", ",", " ", "x"}], 
         "]"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"r1", "=", 
      RowBox[{"r", "[", "theta1", "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"r2", "=", 
      RowBox[{"r", "[", "theta2", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"x1", "=", 
      RowBox[{"r1", "*", 
       RowBox[{"Cos", "[", "theta1", "]"}]}]}], ";", " ", 
     RowBox[{"x2", "=", 
      RowBox[{"r2", "*", 
       RowBox[{"Cos", "[", "theta2", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"y1", "=", 
      RowBox[{"r1", "*", 
       RowBox[{"Sin", "[", "theta1", "]"}]}]}], ";", " ", 
     RowBox[{"y2", "=", 
      RowBox[{"r2", "*", 
       RowBox[{"Sin", "[", "theta2", "]"}]}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"v1", "=", 
      RowBox[{"{", 
       RowBox[{"x1", ",", "y1"}], "}"}]}], ";", 
     RowBox[{"v2", "=", 
      RowBox[{"{", 
       RowBox[{"x2", ",", "y2"}], "}"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"v3", " ", "=", 
      RowBox[{"v2", "-", "v1"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"d", "=", 
      RowBox[{"v3", ".", "v3"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d", "=", 
      RowBox[{"Abs", "[", "d", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"d", ">", 
        RowBox[{"teeny", "*", "dmin"}]}], ",", " ", 
       RowBox[{"d", "=", 
        RowBox[{"Sqrt", "[", "d", "]"}]}], ",", " ", 
       RowBox[{"d", "=", "0"}]}], "]"}], ";", "  ", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"Norm", "[", "v3", "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"altitude", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<a,r1,r2:\>\"", ",", " ", 
       RowBox[{"{", 
        RowBox[{"a", ",", "r1", ",", "r2"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"a", ">", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{"altitude", " ", "=", " ", 
        RowBox[{"AltitudeTriangle", "[", 
         RowBox[{"a", ",", " ", "r1", ",", " ", "r2"}], "]"}]}]}], "]"}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{
      "\"\<altitude,d,dmin: \>\"", ",", " ", "altitude", ",", " ", 
       "\"\<,\>\"", ",", " ", "d", ",", "\"\<,\>\"", ",", "dmin"}], "]"}], 
     ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"cosa", " ", "=", " ", 
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"Normalize", "[", "v1", "]"}], ".", 
          RowBox[{"Normalize", "[", "v3", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sina", " ", "=", " ", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"Abs", "[", 
          RowBox[{"1.0", "-", 
           RowBox[{"cosa", "*", "cosa"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"h", "=", 
        RowBox[{"r1", "*", "sina"}]}], " ", ";"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"V", "=", " ", 
      RowBox[{
       RowBox[{"+", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"d", "-", "dmin"}], " ", ")"}], "^", "2"}], "+", 
          RowBox[{"$LENGTH\[UnderBracket]ALT\[UnderBracket]MULT", "*", 
           RowBox[{"altitude", "^", "2"}]}]}], ")"}]}], "/", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d", "+", "dmin"}], ")"}], "^", "2"}]}]}], " ", ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "V", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5463864286366377`*^9, 3.546386557956811*^9}, {
   3.5463866210689583`*^9, 3.546386623219616*^9}, {3.546386943389009*^9, 
   3.5463871157608147`*^9}, {3.546387195954639*^9, 3.546387212813836*^9}, {
   3.546387249307056*^9, 3.5463872640536337`*^9}, {3.546387307579507*^9, 
   3.5463874181017447`*^9}, {3.546387574380928*^9, 3.5463876018316298`*^9}, {
   3.5463876584791613`*^9, 3.5463876594522676`*^9}, {3.546387832824544*^9, 
   3.546387888178072*^9}, {3.546388178769161*^9, 3.5463881810376596`*^9}, {
   3.546388229768572*^9, 3.546388246967586*^9}, {3.5463882778685713`*^9, 
   3.546388281293634*^9}, {3.546388333665161*^9, 3.54638834219969*^9}, 
   3.546388497783866*^9, {3.546388830018701*^9, 3.546388859238154*^9}, {
   3.546389794910928*^9, 3.546389849775898*^9}, {3.546389961494282*^9, 
   3.546389968375136*^9}, {3.546390324921878*^9, 3.546390339175558*^9}, {
   3.546390380969819*^9, 3.546390394799152*^9}, {3.5463907792648163`*^9, 
   3.546390798732011*^9}, {3.546390855100915*^9, 3.546390861375723*^9}, {
   3.5463909109146852`*^9, 3.546390952082123*^9}, {3.546391342890683*^9, 
   3.5463913459631968`*^9}, {3.5466394681505737`*^9, 
   3.5466394725249243`*^9}, {3.546641499809404*^9, 3.546641500987527*^9}, {
   3.546641579225171*^9, 3.546641582976275*^9}, {3.5466416133049088`*^9, 
   3.5466416322743387`*^9}, {3.5466417084918337`*^9, 3.5466417490996313`*^9}, 
   3.546641801550378*^9, {3.5475695953627977`*^9, 3.547569596830915*^9}, {
   3.547569855156896*^9, 3.547569918688642*^9}, {3.5475711097327013`*^9, 
   3.547571109954688*^9}, {3.547571162298527*^9, 3.5475711627162027`*^9}, {
   3.547571227986927*^9, 3.547571235353078*^9}, {3.547571386043582*^9, 
   3.5475713863370247`*^9}, {3.547571434829723*^9, 3.5475714995722723`*^9}, {
   3.5475715500126143`*^9, 3.54757156388881*^9}, {3.547571654052436*^9, 
   3.547571669455451*^9}, {3.547572122969808*^9, 3.547572153477578*^9}, {
   3.5475722987163982`*^9, 3.5475723425617313`*^9}, {3.5475725307733603`*^9, 
   3.547572549494522*^9}, {3.5475731252932158`*^9, 3.547573126521963*^9}, {
   3.547573215841055*^9, 3.547573252497408*^9}, {3.547573414758292*^9, 
   3.5475735825339327`*^9}, {3.547573629174431*^9, 3.547573643757915*^9}, {
   3.5475739123146257`*^9, 3.5475740777983828`*^9}, {3.547574120262781*^9, 
   3.547574167222938*^9}, {3.547574197910944*^9, 3.547574216664825*^9}, {
   3.54757425352871*^9, 3.547574287124639*^9}, 3.547574347451193*^9, {
   3.547574400501149*^9, 3.547574422326939*^9}, {3.547574453534829*^9, 
   3.5475744568196774`*^9}, {3.547574498033647*^9, 3.547574505331662*^9}, {
   3.547574535815803*^9, 3.547574536170444*^9}, {3.5475762185315638`*^9, 
   3.547576238927746*^9}, {3.5475762762505903`*^9, 3.547576287303639*^9}, {
   3.547576422316214*^9, 3.547576445093532*^9}, {3.565459604210355*^9, 
   3.565459681705366*^9}, {3.565459732532023*^9, 3.565459751176421*^9}, {
   3.565459788643641*^9, 3.565459808425336*^9}, {3.565459868692137*^9, 
   3.565459871161572*^9}, {3.5654599632830563`*^9, 3.5654599695753813`*^9}, {
   3.565460414333549*^9, 3.5654604387091627`*^9}, {3.565461231400807*^9, 
   3.565461266124531*^9}, {3.565461299076807*^9, 3.565461313519536*^9}, {
   3.565461352542036*^9, 3.5654613734937572`*^9}, {3.565461520015315*^9, 
   3.565461535284753*^9}, {3.565461583420223*^9, 3.565461618899003*^9}, {
   3.565461656955158*^9, 3.565461680730949*^9}, {3.565461728805801*^9, 
   3.565461747471621*^9}, {3.5654617907904587`*^9, 3.56546179608387*^9}, {
   3.565461904363389*^9, 3.565461909657716*^9}, {3.5654619608031673`*^9, 
   3.5654619714333897`*^9}, {3.5654620760950127`*^9, 3.565462077198678*^9}, {
   3.565462127479333*^9, 3.565462183337668*^9}, {3.5654622244421873`*^9, 
   3.5654622498826942`*^9}, {3.565462286262706*^9, 3.565462349378271*^9}, {
   3.5654624468130007`*^9, 3.565462466621174*^9}, {3.565462759502195*^9, 
   3.565462790702437*^9}, {3.5654628618711357`*^9, 3.565462872374518*^9}, {
   3.565482357556233*^9, 3.565482499923778*^9}, {3.565482842194084*^9, 
   3.5654828429235773`*^9}, {3.5654840643966923`*^9, 
   3.5654840844078817`*^9}, {3.5666472708611298`*^9, 
   3.566647302747747*^9}},ExpressionUUID->"0daffb8f-6556-4f7b-8809-\
534795af7340"]
}, Closed]],

Cell[CellGroupData[{

Cell["DirectionPotential", "Subsection",
 CellChangeTimes->{{3.546640574521908*^9, 
  3.546640577600766*^9}},ExpressionUUID->"9e280456-d504-43f7-aa57-\
1ba6e12a8a26"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$DIRECTION\[UnderBracket]ALT\[UnderBracket]MULT", "=", "1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$DIRECTION\[UnderBracket]EXPONENT", "=", "2"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DirectionPotentialFunction", "[", 
   RowBox[{"r_", ",", " ", "thetaa1_", ",", " ", "thetaa2_", ",", "v_"}], 
   "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "r1", ",", "r2", ",", "x1", ",", "x2", ",", "y1", ",", "y2", ",", "v1", 
      ",", "v2", ",", "v3", ",", "v4", ",", "val", ",", "lv3", ",", "theta1", 
      ",", "theta2", ",", "n", ",", " ", 
      RowBox[{"teeny", "=", 
       RowBox[{".001", "*", 
        RowBox[{"Pi", "/", "180."}]}]}], ",", "V", ",", "altitude"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"theta1", "=", 
      RowBox[{"Mod", "[", 
       RowBox[{"thetaa1", ",", 
        RowBox[{"2", " ", "Pi"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"theta2", "=", 
      RowBox[{"Mod", "[", 
       RowBox[{"thetaa2", ",", 
        RowBox[{"2", " ", "Pi"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"r1", ",", "r2"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"r", "[", "theta1", "]"}], ",", 
        RowBox[{"r", "[", "theta2", "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"x1", "=", 
      RowBox[{"r1", "*", 
       RowBox[{"Cos", "[", "theta1", "]"}]}]}], ";", 
     RowBox[{"x2", "=", 
      RowBox[{"r2", "*", 
       RowBox[{"Cos", "[", "theta2", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"y1", "=", 
      RowBox[{"r1", "*", 
       RowBox[{"Sin", "[", "theta1", "]"}]}]}], ";", 
     RowBox[{"y2", "=", 
      RowBox[{"r2", "*", 
       RowBox[{"Sin", "[", "theta2", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"v1", "=", 
      RowBox[{"{", 
       RowBox[{"x1", ",", "y1"}], "}"}]}], ";", 
     RowBox[{"v2", "=", 
      RowBox[{"{", 
       RowBox[{"x2", ",", "y2"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"v3", "=", 
      RowBox[{"v2", "-", "v1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"lv3", "=", 
      RowBox[{"Norm", "[", "v3", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"v3", "=", 
      RowBox[{"Normalize", "[", "v3", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"v4", "=", 
      RowBox[{"Normalize", "[", "v", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"val", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v2", ".", "v4"}], "-", 
           RowBox[{"v1", ".", "v4"}]}], ")"}], "^", "2"}]}], ";"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"{", 
         RowBox[{"lv3", ",", "val", ",", "lv3", ",", 
          RowBox[{"val", "/", 
           RowBox[{"(", 
            RowBox[{"lv3", "*", "lv3"}], ")"}]}]}], "}"}], "]"}], ";"}], 
      "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"n", "=", "$DIRECTION\[UnderBracket]EXPONENT"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"V", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"lv3", "<", "teeny"}], ",", "0.0", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"v3", ".", "v4"}], ")"}], "^", "n"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"altitude", "=", 
        RowBox[{"AltitudeTriangle1", "[", 
         RowBox[{"r1", ",", "r2", ",", 
          RowBox[{"theta2", "-", "theta1"}]}], "]"}]}], ";"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"altitude", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"lv3", ">", "0"}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"altitude", "=", 
         RowBox[{"AltitudeTriangle", "[", 
          RowBox[{"lv3", ",", "r1", ",", " ", "r2"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"altitude", "=", 
         RowBox[{"altitude", "/", 
          RowBox[{"(", 
           RowBox[{".5", " ", 
            RowBox[{"(", 
             RowBox[{"r1", "+", "r2"}], ")"}]}], ")"}]}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"V", "+", 
      RowBox[{
      "$DIRECTION\[UnderBracket]ALT\[UnderBracket]MULT", "*", 
       "altitude"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.546640580538027*^9, 3.546640644667687*^9}, {
   3.546640677162903*^9, 3.546640795306221*^9}, 3.546640851097608*^9, {
   3.565710158973713*^9, 3.565710179901126*^9}, {3.5657116351702833`*^9, 
   3.5657116369659033`*^9}, {3.566647314137076*^9, 3.566647340781262*^9}, {
   3.605955012348647*^9, 3.605955068714439*^9}, {3.605955189457293*^9, 
   3.605955189960738*^9}, {3.605955282016255*^9, 3.60595529878454*^9}, {
   3.6059555055227222`*^9, 3.605955518274815*^9}, {3.605955560247602*^9, 
   3.605955579525209*^9}, 3.6059556187934837`*^9, {3.605955668271921*^9, 
   3.605955729808702*^9}, 3.605955785410589*^9, {3.6114454632922688`*^9, 
   3.611445518616005*^9}},ExpressionUUID->"dbd8d8d5-df85-42e9-8c3e-\
761fcc8fe0b8"]
}, Closed]],

Cell[CellGroupData[{

Cell["DivisionPotential", "Subsection",
 CellChangeTimes->{{3.546642249426489*^9, 
  3.546642251761935*^9}},ExpressionUUID->"792607f4-712c-4069-815b-\
a72b00a7b475"],

Cell["\<\
{w1,w2,w3} = {area, Length, direction} relative weights; they do not have to \
be normalized as this will be done internally
VGrowth = Principal Growth Direction
VCell = Principal Cell Direction
{theta1, theta2} = angles in RADIANS from the positive x-axis with the origin \
at the cell centroid
r = Output of RadialPolygon (r is a function of angle in radians)
A = Area of Cell\
\>", "Text",
 CellChangeTimes->{{3.5466423598593817`*^9, 3.546642464258271*^9}, {
  3.546642510989593*^9, 3.546642526290307*^9}, {3.547669806160593*^9, 
  3.547669821805772*^9}, {3.565463118035961*^9, 3.565463124882553*^9}, {
  3.565463164676219*^9, 
  3.565463165490237*^9}},ExpressionUUID->"0e7e60fd-f7d9-4dda-a960-\
d18eaa588fed"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DivisionPotential", "[", 
   RowBox[{"r_", ",", "A_", ",", "dmin_", ",", " ", 
    RowBox[{"weights_", "?", "ListQ"}], ",", 
    RowBox[{"VGrowth_", "?", "ListQ"}], ",", " ", 
    RowBox[{"VCell_", "?", "ListQ"}], ",", 
    RowBox[{"{", 
     RowBox[{"theta1_", ",", "theta2_"}], "}"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "w", ",", "v", ",", " ", "VA", ",", " ", "VL", ",", " ", "VD", ",", "VX",
       ",", "q1", ",", "q2", ",", "VTotal", ",", "u", ",", "w1", ",", "w2", 
      ",", "w3", ",", "w4", ",", "vg", ",", "vc", ",", " ", 
      RowBox[{"dbg", "=", "False"}], ",", " ", "dPrint"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"dPrint", "[", "x___", "]"}], ":=", " ", 
      RowBox[{"If", "[", 
       RowBox[{"dbg", ",", " ", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<DivisionPotential: \>\"", ",", " ", "x"}], "]"}]}], 
       "]"}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"w1", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "weights", "]"}], ">", "0"}], ",", 
        RowBox[{"weights", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "1.0"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"w2", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "weights", "]"}], ">", "1"}], ",", 
        RowBox[{"weights", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", "0.0"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"w3", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "weights", "]"}], ">", "2"}], ",", 
        RowBox[{"weights", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", "0.0"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"w4", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "weights", "]"}], ">", "3"}], ",", 
        RowBox[{"weights", "[", 
         RowBox[{"[", "4", "]"}], "]"}], ",", "0.0"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<weights: \>\"", ",", " ", 
       RowBox[{"{", 
        RowBox[{"w1", ",", "w2", ",", "w3", ",", "w4"}], "}"}]}], "]"}], ";", 
     " ", "\[IndentingNewLine]", 
     RowBox[{"w", "=", 
      RowBox[{"Normalize", "[", 
       RowBox[{"Abs", "/@", 
        RowBox[{"{", 
         RowBox[{"w1", ",", "w2", ",", "w3", ",", "w4"}], "}"}]}], "]"}]}], 
     ";", " ", "\[IndentingNewLine]", 
     RowBox[{"vg", "=", 
      RowBox[{"Normalize", "[", "VGrowth", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"vc", " ", "=", " ", 
      RowBox[{"Normalize", "[", "VCell", "]"}]}], ";", "  ", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"q1", "=", 
        RowBox[{"theta1", "*", 
         RowBox[{"Pi", "/", "180"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"q2", "=", 
        RowBox[{"theta2", "*", 
         RowBox[{"Pi", "/", "180"}]}]}], ";"}], "*)"}], " ", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"q1", ",", "q2"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{"theta1", ",", "theta2"}], "}"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"w1", ">", "0"}], ",", " ", 
       RowBox[{"VA", "=", 
        RowBox[{"AreaPotentialFunction", "[", 
         RowBox[{"r", ",", "A", ",", "q1", ",", "q2"}], "]"}]}], ",", " ", 
       RowBox[{"VA", "=", "0"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", "VA", "]"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"w2", ">", "0"}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{"VL", "=", 
        RowBox[{"LengthPotentialFunction", "[", 
         RowBox[{"r", ",", "dmin", ",", " ", "q1", ",", "q2"}], "]"}]}], ",", 
       " ", "\[IndentingNewLine]", 
       RowBox[{"VL", "=", " ", "0"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"w3", ">", "0"}], ",", " ", 
       RowBox[{"VD", "=", 
        RowBox[{"DirectionPotentialFunction", "[", 
         RowBox[{"r", ",", "q1", ",", "q2", ",", "vg"}], "]"}]}], ",", " ", 
       RowBox[{"VD", "=", "0"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"w4", ">", "0"}], ",", " ", 
       RowBox[{"VX", "=", 
        RowBox[{"DirectionPotentialFunction", "[", 
         RowBox[{"r", ",", "q1", ",", "q2", ",", "vc"}], "]"}]}], ",", " ", 
       RowBox[{"VX", "=", "0"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<w=\>\"", ",", "w", ",", " ", "\"\< w2>0:\>\"", ",", 
       RowBox[{"w2", ">", "0"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"{", 
       RowBox[{"VA", ",", " ", "VL", ",", "VD", ",", " ", "VX"}], "}"}], 
      "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"VTotal", "=", 
      RowBox[{"w", ".", 
       RowBox[{"{", 
        RowBox[{"VA", ",", "VL", ",", "VD", ",", " ", "VX"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "VTotal", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQ/eTM7Jfrcl45XpPd/RVEP5qWz7YeSLv8EucE0RqP
23hB9ILjjhogWkLDSxdEi7RZ6YHoC8e1uc/nvnL0cDcTB9FVz9hWF+e9cjTy
WbsNRAfMNk8sB9JTCyyTQfS3+HflFUA6x7uxFkQvUDvfugRI72L/Nw1EB6Tw
zAPRt05LLwXRvEftVoHo98cYNoFoharH+w4WvXJMY1m5H0RXfN4/7yyQ3jXN
fD6Irv7uKDdvwivHCc/+KYFopt2alSCaTdABTDMV9/wE0XoGa8C0muNL9vlA
Omx3EDeIXvr9hwCILrvtJQSia3bEioFoNZ08cRDt2tBxWHXiK8f7uR+PgOj1
y1bcBNEiu/eBaQBGkLAG
  
  "],ExpressionUUID->"926fbf3b-7fab-4708-a74b-cc9a4b71fe97"]
}, Closed]],

Cell[CellGroupData[{

Cell["GlobalSearchMinimizationOfDivisionPotential", "Subsection",
 CellChangeTimes->{{3.547583773328713*^9, 
  3.5475837855516233`*^9}},ExpressionUUID->"d1b8d071-c6cf-4fcc-9e96-\
71f74d0cb036"],

Cell["\<\
This performs a global serach for the minimin Cell Division Potential
R = output RadialPolygon (radius vs angle in RADIANS)
A = cell AREA
d = Minimum Diameter through centroid (or other number you wish to use to \
represent this; the length potential will be drawn towards this value)
w = Weight Vector; does not have to be nornalized; {wArea, wLength, \
wDirection};
dangle = delta in angular search in DEGREES.  (default = 3.6 DEG i.e., 1/100 \
of the perimeter (for a circle)).
angleDiffMin = in DEGREES = angles closer together than this value will be \
deemed unacceptable. (default = 135 DEG). 

A small value of dangle will lead to slow calculations;  A large value will \
lead to less accurate calculations. The calculation time is inversely \
proportional to the square of dangle. 

Here are some approximate times for a {1,1,1} calculation (i7 2.6 GHz), \
Square cell, angleDiffMin = 90:
  dangle = 10 degrees : 0.5 seconds
  dangle = 6 :  1.75 seconds
  dangle = 5:  1.15 seconds
  dangle = 3.6: 2.13 seconds
  dangle = 3.0: 3.1 seconds
  dangle = 2.0 degrees: 12.6 seconds
  
  \
\>", "Text",
 CellChangeTimes->{{3.547583822984127*^9, 3.547584051800621*^9}, {
  3.547584131484488*^9, 3.54758421319602*^9}, {3.547584272963789*^9, 
  3.547584303767898*^9}, {3.547584472240934*^9, 3.547584474008666*^9}, {
  3.5475845277363243`*^9, 3.5475845576960363`*^9}, {3.547584959457128*^9, 
  3.547585027080344*^9}, {3.5475851076566257`*^9, 3.5475851507607517`*^9}, {
  3.547644895710554*^9, 
  3.5476449158137617`*^9}},ExpressionUUID->"d7e11b65-36bc-43b7-b16b-\
70bf9200ffef"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$DEBUGMINIMIZATION", "=", "False"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GlobalSearchMinimizationOfDivisionPotential", "[", 
   RowBox[{
   "R_", ",", "A_", ",", "d_", ",", "w_", ",", "v1_", ",", "v2_", ",", " ", 
    RowBox[{"dangle_:", "3.6"}], ",", 
    RowBox[{"angleDiffMin_:", " ", "135"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "x", ",", "y", ",", "f", ",", "F", ",", "xmin", ",", "ymin", ",", "val", 
      ",", "angle1", ",", "angle2", ",", "vnew", ",", "delta", ",", 
      RowBox[{"dbg", "=", "$DEBUGMINIMIZATION"}], ",", " ", "dPrint", ",", 
      " ", "fdata", ",", " ", "fdatarow"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"dPrint", "[", "u___", "]"}], ":=", " ", 
      RowBox[{"If", "[", 
       RowBox[{"dbg", ",", " ", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<GlobalSearchMinimizationOfDivisionPotential: \>\"", ",", " ", 
          "u"}], "]"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
      RowBox[{"DivisionPotential", "[", 
       RowBox[{"R", ",", "A", ",", "d", ",", "w", ",", "v1", ",", "v2", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"F", "[", 
       RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
      RowBox[{"f", "[", 
       RowBox[{
        RowBox[{"x", "*", 
         RowBox[{"Pi", "/", "180.0"}]}], ",", 
        RowBox[{"y", "*", 
         RowBox[{"Pi", "/", "180"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"val", "=", "Infinity"}], ";", "\[IndentingNewLine]", 
     RowBox[{"fdata", "=", 
      RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"angle1", "=", "0"}], ",", 
       RowBox[{"angle1", "<", "360"}], ",", 
       RowBox[{"angle1", "=", 
        RowBox[{"angle1", "+", "dangle"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"angle2", "=", 
           RowBox[{"angle1", "+", "dangle"}]}], ",", 
          RowBox[{"angle2", "<", "360"}], ",", 
          RowBox[{"angle2", "=", 
           RowBox[{"angle2", "+", "dangle"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"fdatarow", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"delta", " ", "=", " ", 
            RowBox[{"Abs", "[", 
             RowBox[{"angle1", "-", "angle2"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Min", "[", 
               RowBox[{"delta", ",", 
                RowBox[{"360.0", "-", "delta"}]}], "]"}], "<", 
              "angleDiffMin"}], " ", ",", 
             RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"vnew", "=", 
            RowBox[{"F", "[", 
             RowBox[{"angle1", ",", "angle2"}], "]"}]}], ";", 
           "\[IndentingNewLine]", " ", 
           RowBox[{"dPrint", "[", 
            RowBox[{"{", 
             RowBox[{"angle1", ",", " ", "angle2", ",", " ", "vnew"}], "}"}], 
            "]"}], ";", " ", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"vnew", "<", "val"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"val", "=", "vnew"}], ";", 
              RowBox[{"xmin", "=", "angle1"}], ";", 
              RowBox[{"ymin", "=", "angle2"}], ";", "\[IndentingNewLine]", 
              RowBox[{"dPrint", "[", 
               RowBox[{
               "\"\<===========>>>>New Minimum: \>\"", ",", " ", "vnew", ",", 
                "\"\< at \>\"", ",", " ", 
                RowBox[{"{", 
                 RowBox[{"xmin", ",", " ", "ymin"}], "}"}]}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", "\"\<**** About to return: \>\"", "]"}], ";", " ",
      "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", "fdata", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"{", 
       RowBox[{"val", ",", " ", "xmin", ",", " ", "ymin"}], "}"}], "]"}], ";",
      " ", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"val", ",", "xmin", ",", "ymin"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.547583792276724*^9, 3.547583816447501*^9}, {
   3.547585097816742*^9, 3.547585099742422*^9}, {3.547644907450624*^9, 
   3.547644908602756*^9}, 3.5476452013702517`*^9, {3.547645239436574*^9, 
   3.547645335820443*^9}, {3.547646535613019*^9, 3.547646595473287*^9}, {
   3.547669931904758*^9, 3.547669945536433*^9}, 3.547728215508774*^9, {
   3.549826484160177*^9, 3.549826491529695*^9}, {3.549826533513852*^9, 
   3.549826535060665*^9}, {3.565482039193697*^9, 3.5654820749630957`*^9}, {
   3.5654822155443296`*^9, 3.565482217677129*^9}, {3.565482981470146*^9, 
   3.5654829821605186`*^9}, {3.5654833713750563`*^9, 3.565483372050432*^9}, {
   3.565483406021185*^9, 3.565483406690625*^9}, {3.565483894999366*^9, 
   3.565483895717786*^9}, {3.565483972942086*^9, 3.565483973783382*^9}, {
   3.606068943135709*^9, 3.606068969967805*^9}, {3.606069019652017*^9, 
   3.6060692179667683`*^9}, {3.606069318773541*^9, 3.6060694765440073`*^9}, {
   3.6060695628547363`*^9, 
   3.6060695784567413`*^9}},ExpressionUUID->"cbfe4499-f6bb-4d91-a71a-\
f48318b65735"]
}, Closed]],

Cell[CellGroupData[{

Cell["OptimizeDivisionPotential", "Subsection",
 CellChangeTimes->{{3.546643032947011*^9, 3.546643037211677*^9}, {
  3.546643184107592*^9, 3.546643185195105*^9}, {3.546643761774096*^9, 
  3.546643763637158*^9}},ExpressionUUID->"9d05ff73-24f7-4f9c-874d-\
25c6dc82839e"],

Cell["\<\
points = Cell Vertex Coordinates
{w1,w2,w3} = preferred weight
{vx,vy} = preferred direction vector

NMinimize sees to converge to a plateau that is nowhere near the minimum \
value - or even a local minimum - for some cell shape configurations. So it \
is not a useful function. Verifeid with all available options in Version 8.\
\>", "Text",
 CellChangeTimes->{{3.5466437663245068`*^9, 3.546643792467287*^9}, {
  3.546643843318027*^9, 3.546643861524726*^9}, {3.547585233859437*^9, 
  3.5475852915603724`*^9}},ExpressionUUID->"e89b950c-8e63-4ea2-bd5b-\
1610fcc4bcf7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$DEBUGOPTIMIZATION", "=", "False"}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OptimizeDivisionPotential", "[", 
     RowBox[{"points_", ",", " ", 
      RowBox[{"w_", "?", "ListQ"}], ",", 
      RowBox[{"vgrowth_", "?", "ListQ"}], ",", 
      RowBox[{"vcell_", "?", "ListQ"}], ",", "anglespreadmin_"}], "]"}], ":=",
     " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "result", ",", "angles", ",", "r", ",", "A", ",", "A1", ",", "A2", ",",
         " ", "p1", ",", "p2", ",", "C", ",", "dmin", ",", "tab"}], "}"}], 
      ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{"$DEBUGOPTIMIZATION", ",", " ", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<OptimizeDivisionPotential (1):  w=\>\"", ",", "w", ",", " ", 
            "\"\< vg=\>\"", ",", "vgrowth", ",", " ", "\"\< vc= \>\"", ",", 
            " ", "vcell"}], "]"}], ";"}]}], " ", "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"r", " ", "=", " ", 
        RowBox[{"RadialPolygon", "[", 
         RowBox[{"points", ",", "100"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"A", " ", "=", " ", 
        RowBox[{"areafunction", "[", "points", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Find", " ", "minimum", " ", "pseudo"}], "-", 
         RowBox[{"diameter", " ", "from", " ", "100", " ", "points"}]}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"dmin", "=", 
        RowBox[{"Min", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"r", "[", "u", "]"}], "+", 
            RowBox[{"r", "[", 
             RowBox[{"u", "+", "Pi"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"u", ",", "0", ",", "Pi", ",", 
             RowBox[{"Pi", "/", "100.0"}]}], "}"}]}], "]"}], "]"}]}], ";", 
       " ", "\[IndentingNewLine]", 
       RowBox[{"OptimizeDivisionPotential", "[", 
        RowBox[{"r", ",", " ", "A", ",", " ", "dmin", ",", " ", 
         RowBox[{"Centroid", "[", "points", "]"}], ",", " ", "w", ",", 
         "vgrowth", ",", "vcell", ",", "anglespreadmin"}], "]"}]}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OptimizeDivisionPotential", "[", 
     RowBox[{
     "r_InterpolatingFunction", ",", " ", "A_", ",", "dmin_", ",", " ", 
      "Center_", ",", " ", 
      RowBox[{"w_", "?", "ListQ"}], ",", 
      RowBox[{"vgrowth_", "?", "ListQ"}], ",", 
      RowBox[{"vcell_", "?", "ListQ"}], ",", "anglespreadmin_", ",", 
      RowBox[{"npts_:", "50"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "result", ",", "angles", ",", "A1", ",", "A2", ",", " ", "p1", ",", 
        "p2", ",", "C", ",", "tab"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{"$DEBUGOPTIMIZATION", ",", " ", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<OptimizeDivisionPotential (2):\>\"", ",", " ", "\"\< vg=\>\"",
             ",", "vgrowth", ",", " ", "\"\< vc= \>\"", ",", " ", "vcell"}], 
           "]"}], ";"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"result", "=", 
        RowBox[{"GlobalSearchMinimizationOfDivisionPotential", "[", 
         RowBox[{
         "r", ",", "A", ",", "dmin", ",", "w", ",", "vgrowth", ",", " ", 
          "vcell", ",", 
          RowBox[{"360.", "/", "npts"}], ",", "anglespreadmin"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"angles", " ", "=", " ", 
        RowBox[{"Rest", "[", "result", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"A1", ",", " ", "A2"}], "}"}], " ", "=", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Pi", "/", "180.0"}], ")"}], "*", "angles"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"p1", " ", "=", " ", 
        RowBox[{"Center", "+", " ", 
         RowBox[{
          RowBox[{"r", "[", "A1", "]"}], "*", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Cos", "[", "A1", "]"}], ",", " ", 
            RowBox[{"Sin", "[", "A1", "]"}]}], "}"}]}]}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"p2", " ", "=", " ", 
        RowBox[{"Center", "+", 
         RowBox[{
          RowBox[{"r", "[", "A2", "]"}], "*", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Cos", "[", "A2", "]"}], ",", " ", 
            RowBox[{"Sin", "[", "A2", "]"}]}], "}"}]}]}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"angles", ",", " ", "p1", ",", " ", "p2"}], "}"}], "]"}], 
       ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OptimizeDivisionPotential", "[", 
   RowBox[{
   "r_Function", ",", " ", "A_", ",", "dmin_", ",", " ", "Center_", ",", " ", 
    
    RowBox[{"w_", "?", "ListQ"}], ",", 
    RowBox[{"vgrowth_", "?", "ListQ"}], ",", 
    RowBox[{"vcell_", "?", "ListQ"}], ",", "anglespreadmin_"}], "]"}], ":=", 
  " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "result", ",", "angles", ",", "A1", ",", "A2", ",", " ", "p1", ",", "p2",
       ",", "C", ",", "tab"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{"$DEBUGOPTIMIZATION", ",", " ", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<OptimizeDivisionPotential (3):  \>\"", ",", "\"\< vg=\>\"", ",",
           "vgrowth", ",", " ", "\"\< vc= \>\"", ",", " ", "vcell"}], "]"}], 
        ";"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{"GlobalSearchMinimizationOfDivisionPotential", "[", 
       RowBox[{
       "r", ",", "A", ",", "dmin", ",", "w", ",", "vgrowth", ",", " ", 
        "vcell", ",", "3.6", ",", "anglespreadmin"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"angles", " ", "=", " ", 
      RowBox[{"Rest", "[", "result", "]"}]}], ";", " ", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"A1", ",", " ", "A2"}], "}"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Pi", "/", "180.0"}], ")"}], "*", "angles"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"p1", " ", "=", " ", 
      RowBox[{"Center", "+", " ", 
       RowBox[{
        RowBox[{"r", "[", "A1", "]"}], "*", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", "A1", "]"}], ",", " ", 
          RowBox[{"Sin", "[", "A1", "]"}]}], "}"}]}]}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"p2", " ", "=", " ", 
      RowBox[{"Center", "+", 
       RowBox[{
        RowBox[{"r", "[", "A2", "]"}], "*", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", "A2", "]"}], ",", " ", 
          RowBox[{"Sin", "[", "A2", "]"}]}], "}"}]}]}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{"angles", ",", " ", "p1", ",", " ", "p2"}], "}"}], "]"}], 
     ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]}], "Input",\

 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwdxWtIU2EABuDDkkqJtBC7DOaGoaIOKxlMF+URy0FJLm2uydYQRRvTk5dw
7LAoQ0mckKMMS9JqeCGcFhii0+EkDS8DgywEu7EV+zSi/BMk2Pd+Px4eRblw
qVLCcVwKhQeLfp4fsRE+fOSiEW9IBTO2n2hnBxyhLtyf8qMb17apevHWruNP
8YUa3wvsLZGM4vixX85F+qnSrhacV5zhxudS54Zw8tvqV/j6+F12cnmDd5m+
Kt03im1NN8Zw0ef3bOfy9gTW9jgnccLfFnNTLeHXNKUW/Kd91mSnZxTnm7HM
lVqFufkg+8Dl325sey27j4ezwjqRHnoWvII91twKTFo7ruFjm4K+m26IuNlc
X6wJRylEC14/me330Ot3ht/gvKkzm1ividvC2WflmTP0O2Id+2XMkk4rEH6g
TGLEnvW0Kryw3SjgGKtPxF8M79jNrs5bWPNI3oyrdf86cLCCuHHA3vYQGxO9
7L4kWfDJPcJbo1UfsUPpC+Hp5w8iOKRXSnvpJMcrx+oPogFbfWtmHD7qV6k7
CV9YFsjB5HbN7j2fCO8qvBqP800rCvzVEmHHGQbScbRFrcQ3lf7cvfTDh/bz
OOr76QJ80LHC5nYeJyb0bPD92m/s//kNPUY=
  
  "],ExpressionUUID->"f7be68a5-f398-4769-8829-fd701a7916e6"]
}, Closed]],

Cell[CellGroupData[{

Cell["PrincipalCellDirection", "Subsection",
 CellChangeTimes->{{3.546645091172388*^9, 3.5466450942292347`*^9}, {
  3.546645487469068*^9, 3.546645488421197*^9}, {3.547669021334979*^9, 
  3.547669023005548*^9}},ExpressionUUID->"e71879d3-a0a9-47c1-9775-\
7b36a3a65d39"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PrincipalCellDirection", "[", 
     RowBox[{
      RowBox[{"T_", "?", "DTissueQ"}], ",", "cellnumber_", ",", " ", 
      "solution_", ",", "time_", ",", "xvar_", ",", "yvar_"}], "]"}], ":=", 
    " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "vertexNumbers", ",", "vertexNumbersT", ",", "coordinates", ",", "CM", 
        ",", "evals", ",", "evec", ",", "tissue", ",", "C"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vertexNumbers", "=", 
        RowBox[{"CellVertexNumbers", "[", 
         RowBox[{"T", ",", "cellnumber"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"vertexNumbersT", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"xvar", "[", "#", "]"}], "[", "Global`t", "]"}], ",", 
            RowBox[{
             RowBox[{"yvar", "[", "#", "]"}], "[", "Global`t", "]"}]}], "}"}],
           "&"}], "/@", "vertexNumbers"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"coordinates", " ", "=", 
        RowBox[{"Flatten", "[", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"vertexNumbersT", "/.", "solution"}], ")"}], "/.", 
          RowBox[{"{", 
           RowBox[{"Global`t", "\[Rule]", "time"}], "}"}]}], "]"}]}], ";", 
       " ", "\[IndentingNewLine]", 
       RowBox[{"coordinates", " ", "=", " ", 
        RowBox[{"Partition", "[", 
         RowBox[{"coordinates", ",", " ", "2"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"CM", "=", 
        RowBox[{"Covariance", "[", "coordinates", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"evec", "=", 
        RowBox[{
         RowBox[{"Eigenvectors", "[", "CM", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "evec", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PrincipalCellDirection", "[", "x___", "]"}], ":=", " ", 
   RowBox[{"(", 
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<Expecting PrincipalCellDirection[Tissue,cell,solution,t,x,y]; x = \
\>\"", ",", 
      RowBox[{"Short", "/@", 
       RowBox[{"{", "x", "}"}]}]}], "]"}], ")"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5466451125182543`*^9, 3.546645359891376*^9}, {
   3.546645442356771*^9, 3.546645485561565*^9}, 3.54664553475179*^9, {
   3.546645588539837*^9, 3.546645653856765*^9}, {3.54664569248586*^9, 
   3.546645820806849*^9}, {3.5466995917690907`*^9, 3.546699677876164*^9}, 
   3.546700293046962*^9, {3.546808968429428*^9, 3.546808969590356*^9}, {
   3.5468090479138203`*^9, 3.5468090596736507`*^9}, {3.546809108171253*^9, 
   3.546809159486308*^9}, {3.5468093600481997`*^9, 3.546809437426466*^9}, {
   3.546809525874384*^9, 3.546809599845455*^9}, {3.546809654567205*^9, 
   3.546809661534107*^9}, {3.546809734430669*^9, 3.546809759145919*^9}, {
   3.547668907781095*^9, 3.547669030757958*^9}, {3.5476693239193707`*^9, 
   3.5476693263726254`*^9}, {3.566400206401585*^9, 3.566400228086725*^9}, 
   3.566401208420547*^9},ExpressionUUID->"ab4df51e-3a06-42f2-8e11-\
3121895d8366"]
}, Closed]],

Cell[CellGroupData[{

Cell["PrincipalGrowthDirection", "Subsection",
 CellChangeTimes->{{3.5476686710858173`*^9, 3.547668680982936*^9}, {
  3.547669032910804*^9, 
  3.54766903447753*^9}},ExpressionUUID->"19becc08-df33-4ed7-80da-\
8aedc2daedf7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PrincipalGrowthDirection", "[", 
     RowBox[{
      RowBox[{"T_", "?", "DTissueQ"}], ",", "cellnumber_", ",", " ", 
      "solution_", ",", "time_", ",", "xvar_", ",", "yvar_"}], "]"}], ":=", 
    " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "vertexNumbers", ",", "vertexNumbersT", ",", "velocities", ",", "CM", 
        ",", "evals", ",", "evec", ",", "tissue", ",", "C"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vertexNumbers", "=", 
        RowBox[{"CellVertexNumbers", "[", 
         RowBox[{"T", ",", "cellnumber"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"vertexNumbersT", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"xvar", "[", "#", "]"}], "[", "Global`t", "]"}], ",", 
            RowBox[{
             RowBox[{"yvar", "[", "#", "]"}], "[", "Global`t", "]"}]}], "}"}],
           "&"}], "/@", "vertexNumbers"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"velocities", "=", 
        RowBox[{
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{"#", ",", "Global`t"}], "]"}], "&"}], "/@", 
            RowBox[{"Flatten", "[", 
             RowBox[{"vertexNumbersT", "/.", "solution"}], "]"}]}], ",", 
           "2"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{"Global`t", "\[Rule]", "time"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"CM", "=", 
        RowBox[{"Covariance", "[", "velocities", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"evec", "=", 
        RowBox[{
         RowBox[{"Eigenvectors", "[", "CM", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PrincipalGrowthDirection", "[", "x___", "]"}], ":=", " ", 
   RowBox[{"(", 
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<Expecting PrincipalGrowthDirection[Tissue,cell,solution,t,x,y]; x = \
\>\"", ",", 
      RowBox[{"Short", "/@", 
       RowBox[{"{", "x", "}"}]}]}], "]"}], ")"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5466451125182543`*^9, 3.546645359891376*^9}, {
   3.546645442356771*^9, 3.546645485561565*^9}, 3.54664553475179*^9, {
   3.546645588539837*^9, 3.546645653856765*^9}, {3.54664569248586*^9, 
   3.546645820806849*^9}, {3.5466995917690907`*^9, 3.546699677876164*^9}, 
   3.546700293046962*^9, {3.546808968429428*^9, 3.546808969590356*^9}, {
   3.5468090479138203`*^9, 3.5468090596736507`*^9}, {3.546809108171253*^9, 
   3.546809159486308*^9}, {3.5468093600481997`*^9, 3.546809437426466*^9}, {
   3.546809525874384*^9, 3.546809599845455*^9}, {3.546809654567205*^9, 
   3.546809661534107*^9}, {3.546809734430669*^9, 3.546809759145919*^9}, {
   3.547668692786962*^9, 3.547668698953451*^9}, {3.547669036389814*^9, 
   3.5476690439699574`*^9}},ExpressionUUID->"fb746f9a-4ded-4e62-9043-\
707c70140d46"]
}, Closed]],

Cell[CellGroupData[{

Cell["CellEigenRatio", "Subsection",
 CellChangeTimes->{{3.577215253462358*^9, 
  3.577215262756957*^9}},ExpressionUUID->"7a3cd68c-a2ba-47b6-91ba-\
569da62ffc45"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CellEigenRatio", "[", 
     RowBox[{
      RowBox[{"T_", "?", "TissueQ"}], ",", "i_"}], "]"}], ":=", " ", 
    RowBox[{"EigenRatio", "[", 
     RowBox[{"CellVertexCoordinates", "[", 
      RowBox[{"T", ",", "i"}], "]"}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CellEigenRatio", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"AbortIf", "[", 
     RowBox[{
     "True", ",", " ", 
      "\"\<Error: Expecting CellEigenRatio[Tissue, index]\>\""}], "]"}]}], 
   ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EigenRatio", "[", 
    RowBox[{"listOfVertices_", "?", "ListQ"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Cov", ",", " ", "e1", ",", " ", "e2", ",", " ", "ratio"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"AbortIf", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{"And", "[", 
          RowBox[{"ListQ", "/@", "listOfVertices"}], "]"}], "]"}], ",", 
        RowBox[{
        "\"\<Error: EigenRatio: Invalid input (element not a list): \>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"InputForm", "[", "x", "]"}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AbortIf", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"Union", "[", 
           RowBox[{"Length", "/@", "listOfVertices"}], "]"}], "]"}], 
         "\[NotEqual]", " ", "1"}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{
        "\"\<Error: EigenRatio: Invalid input (inconsistent dimensions)\>\"", 
         "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"InputForm", "[", "x", "]"}], "]"}]}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Cov", "=", 
       RowBox[{"Covariance", "[", "listOfVertices", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"e1", ",", "e2"}], "}"}], "=", 
       RowBox[{"Eigenvalues", "[", "Cov", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"e1", "\[NotEqual]", " ", "0"}], ",", " ", 
        RowBox[{"Return", "[", 
         RowBox[{"e1", "/", "e2"}], "]"}], ",", " ", 
        RowBox[{"Return", "[", "Infinity", "]"}]}], "]"}], ";"}]}], " ", 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EigenRatio", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"AbortIf", "[", 
     RowBox[{"True", ",", " ", 
      RowBox[{"\"\<Unexpected Input to EigenRatio: \>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{"InputForm", "[", "x", "]"}], "]"}]}]}], "]"}]}], ";"}], 
  " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.577215263793998*^9, 3.5772156249075403`*^9}, {
  3.577215691725478*^9, 
  3.577215739246966*^9}},ExpressionUUID->"a06a7627-237f-4596-9ab9-\
b92343e78ea6"]
}, Closed]],

Cell[CellGroupData[{

Cell["(SVD)PrincipalDirectionFormula", "Subsection",
 CellChangeTimes->{{3.577491646337921*^9, 3.577491683009625*^9}, {
  3.5776373253794613`*^9, 
  3.5776373262351227`*^9}},ExpressionUUID->"c00b6c15-6a25-430b-bbc9-\
e6aa7cf23fea"],

Cell["\<\
gives a normalized formula for the principal direction
The Eigenvector Based Version tends to lead to a stiff system in NDSolve\
\>", "Text",
 CellChangeTimes->{{3.577493679396346*^9, 3.57749368849853*^9}, {
  3.577494521111843*^9, 3.577494522038452*^9}, {3.577637330868325*^9, 
  3.577637349817514*^9}},ExpressionUUID->"ab0941c0-6a6f-4958-b00c-\
51ab6a6add43"],

Cell[CellGroupData[{

Cell["Eigenvector Based Version", "Subsubsection",
 CellChangeTimes->{{3.577637314987368*^9, 
  3.577637322498189*^9}},ExpressionUUID->"5440c067-3dc1-4c43-8fd8-\
2058a085a725"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PrincipalDirectionFormula", "[", 
     RowBox[{"T_Tissue", ",", " ", "x___"}], "]"}], ":=", " ", 
    RowBox[{"AbortIf", "[", 
     RowBox[{
     "True", ",", " ", 
      "\"\<Expecting a DTissue as the first argument to \
PrincipalDirectionFormula\>\""}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PrincipalDirectionFormula", "[", 
     RowBox[{
      RowBox[{"T_", "?", "DTissueQ"}], ",", " ", "center_", ",", " ", "PD_", 
      ",", " ", "x_", ",", " ", "y_"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "PDBASE", ",", " ", "PDX", ",", " ", "PDY", ",", " ", "PDUNITX", ",", 
        " ", "PDUNITY", ",", " ", "PDNORM", ",", " ", "PDEV1", ",", " ", 
        "PDEV2", ",", " ", "PDMAXEV", ",", " ", "PDA", ",", " ", "PDB", ",", 
        " ", "PDD"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"PDBASE", " ", "=", " ", 
        RowBox[{"ToString", "[", "PD", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"PDX", " ", "=", 
        RowBox[{"ToExpression", "[", 
         RowBox[{"PDBASE", "<>", "\"\<X\>\""}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"PDY", " ", "=", 
        RowBox[{"ToExpression", "[", 
         RowBox[{"PDBASE", "<>", "\"\<Y\>\""}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"PDNORM", "=", 
        RowBox[{"ToExpression", "[", 
         RowBox[{"PDBASE", "<>", "\"\<NORM\>\""}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"PDUNITX", " ", "=", 
        RowBox[{"ToExpression", "[", 
         RowBox[{"PDBASE", "<>", "\"\<UNITX\>\""}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"PDUNITY", " ", "=", 
        RowBox[{"ToExpression", "[", 
         RowBox[{"PDBASE", "<>", "\"\<UNITY\>\""}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"PDEV1", " ", "=", 
        RowBox[{"ToExpression", "[", 
         RowBox[{"PDBASE", "<>", "\"\<EV1\>\""}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"PDEV2", " ", "=", 
        RowBox[{"ToExpression", "[", 
         RowBox[{"PDBASE", "<>", "\"\<EV2\>\""}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"PDMAXEV", " ", "=", 
        RowBox[{"ToExpression", "[", 
         RowBox[{"PDBASE", "<>", "\"\<MAXEV\>\""}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"PDA", " ", "=", 
        RowBox[{"ToExpression", "[", 
         RowBox[{"PDBASE", "<>", "\"\<A\>\""}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"PDB", " ", "=", 
        RowBox[{"ToExpression", "[", 
         RowBox[{"PDBASE", "<>", "\"\<B\>\""}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"PDD", " ", "=", 
        RowBox[{"ToExpression", "[", 
         RowBox[{"PDBASE", "<>", "\"\<D\>\""}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"PrincipalDirectionFormula", "[", 
        RowBox[{
        "T", ",", " ", "center", ",", " ", "PDX", ",", " ", "PDY", ",", " ", 
         "PDNORM", ",", " ", "PDUNITX", ",", " ", "PDUNITY", ",", " ", 
         "PDEV1", ",", " ", "PDEV2", ",", " ", "PDMAXEV", ",", " ", "PDA", 
         ",", " ", "PDB", ",", " ", "PDD", ",", " ", "x", ",", " ", "y"}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PrincipalDirectionFormula", "[", 
   RowBox[{
    RowBox[{"T_", "?", "DTissueQ"}], ",", " ", "center_", ",", " ", "PDX_", 
    ",", " ", "PDY_", ",", "PDNORM_", ",", " ", "PDUNITX_", ",", " ", 
    "PDUNITY_", ",", " ", "PDEV1_", ",", " ", "PDEV2_", ",", " ", "PDMAXEV_", 
    ",", "PDA_", ",", " ", "PDB_", ",", " ", "PDD_", ",", " ", "x_", ",", " ",
     "y_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "n", ",", "nc", ",", "cvn", ",", " ", "cellnumbers", ",", " ", "xyvals", 
      ",", " ", "cell", ",", " ", "M", ",", " ", "cosfunc", ",", "sinfunc", 
      ",", "i", ",", "j", ",", "  ", "funcs", ",", " ", "a", ",", "  ", "b", 
      ",", " ", "d", ",", " ", "discr", ",", " ", "ev1", ",", " ", "ev2", ",",
       " ", "ev", ",", " ", 
      RowBox[{"epsilon", "=", "0.01"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{"NTissueVertices", "[", "T", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"nc", "=", 
      RowBox[{"NTissueCells", "[", "T", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"cvn", "=", 
      RowBox[{"CellVertexNumbers", "[", "T", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"cellnumbers", "=", 
      RowBox[{"First", "/@", 
       RowBox[{"TissueCells", "[", "T", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"funcs", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", " ", 
       RowBox[{"i", "\[LessEqual]", " ", "nc"}], ",", " ", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cell", " ", "=", " ", 
         RowBox[{"cvn", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"xyvals", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"x", "[", "#", "]"}], "[", "Global`t", "]"}], "-", 
              RowBox[{
               RowBox[{"center", "[", 
                RowBox[{"i", ",", "1"}], "]"}], "[", "Global`t", "]"}]}], ",",
              " ", 
             RowBox[{
              RowBox[{
               RowBox[{"y", "[", "#", "]"}], "[", "Global`t", "]"}], "-", 
              RowBox[{
               RowBox[{"center", "[", 
                RowBox[{"i", ",", "2"}], "]"}], "[", "Global`t", "]"}]}]}], 
            "}"}], " ", "&"}], "/@", "cell"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"M", "=", 
         RowBox[{
          RowBox[{"Transpose", "[", "xyvals", "]"}], ".", "xyvals"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"a", "=", 
         RowBox[{"M", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"b", "=", 
         RowBox[{"M", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"matrix", " ", "is", " ", "symmetric"}], ",", " ", 
          RowBox[{"b", "=", "c"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"d", "=", 
         RowBox[{"M", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"discr", "=", 
         RowBox[{
          RowBox[{"a", "^", "2"}], "+", 
          RowBox[{"d", "^", "2"}], "+", 
          RowBox[{"b", "^", "2"}], "-", 
          RowBox[{"2", "*", "a", "*", "d"}]}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"ev1", " ", "=", " ", 
         RowBox[{".5", "*", 
          RowBox[{"(", 
           RowBox[{"a", "+", "d", "+", 
            RowBox[{"Sqrt", "[", "discr", "]"}]}], ")"}]}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"ev2", " ", "=", " ", 
         RowBox[{".5", "*", 
          RowBox[{"(", 
           RowBox[{"a", "+", "d", "-", 
            RowBox[{"Sqrt", "[", "discr", "]"}]}], ")"}]}]}], ";", " ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"j", "=", 
         RowBox[{"cellnumbers", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "this", " ", "is", " ", "the", " ", "wrong", " ", "matrix"}], ",", 
          " ", 
          RowBox[{
          "need", " ", "to", " ", "do", " ", "SVD", " ", "before", " ", 
           "taking", " ", "cosine", " ", "or", " ", "sine"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"funcs", ",", " ", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"PDA", "[", "j", "]"}], "[", "Global`t", "]"}], 
             "\[Equal]", "a"}], ",", " ", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"PDB", "[", "j", "]"}], "[", "Global`t", "]"}], 
             "\[Equal]", "b"}], ",", " ", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"PDD", "[", "j", "]"}], "[", "Global`t", "]"}], 
             "\[Equal]", "d"}], ",", " ", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"PDEV1", "[", "j", "]"}], "[", "Global`t", "]"}], 
             "\[Equal]", "ev1"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"PDEV2", "[", "j", "]"}], "[", "Global`t", "]"}], 
             "\[Equal]", " ", "ev2"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"PDMAXEV", "[", "j", "]"}], "[", "Global`t", "]"}], 
             "\[Equal]", 
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"PDEV1", "[", "j", "]"}], "[", "Global`t", "]"}], ",",
                " ", 
               RowBox[{
                RowBox[{"PDEV2", "[", "j", "]"}], "[", "Global`t", "]"}]}], 
              "]"}]}], ",", " ", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"B", "-", 
               RowBox[{
               "epsilon", " ", "is", " ", "a", " ", "check", " ", "for", " ", 
                "b"}]}], ">", 
              RowBox[{
              "0", " ", "with", " ", "numerical", " ", "inaccuracies"}]}], 
             " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"PDX", " ", "is", " ", "1", " ", "if", " ", "b"}], ">", 
              
              RowBox[{"0", " ", "OR", " ", "if", " ", "b"}], "<", 
              RowBox[{"0", " ", "and", " ", "a"}], ">", "d"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"PDX", "[", "j", "]"}], "[", "Global`t", "]"}], 
             "\[Equal]", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{".5", 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"Sign", "[", 
                  RowBox[{
                   RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"PDB", "[", "j", "]"}], "[", "Global`t", "]"}], 
                    "]"}], "-", "epsilon"}], "]"}]}], ")"}]}], " ", "+", " ", 
              "\[IndentingNewLine]", 
              RowBox[{".5", 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"Sign", "[", 
                  RowBox[{
                   RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"PDB", "[", "j", "]"}], "[", "Global`t", "]"}], 
                    "]"}], "-", "epsilon"}], "]"}]}], ")"}], ".5", 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"Sign", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"PDA", "[", "j", "]"}], "[", "Global`t", "]"}], 
                   "-", 
                   RowBox[{
                    RowBox[{"PDD", "[", "j", "]"}], "[", "Global`t", "]"}]}], 
                  "]"}]}], ")"}]}]}]}], ",", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "/", "2"}], ")"}], 
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  RowBox[{"Sign", 
                   RowBox[{"(", 
                    RowBox[{"a", "-", "d"}], ")"}]}]}], ")"}]}], " ", "=", 
               " ", 
               RowBox[{
                RowBox[{"0", " ", "if", " ", "A"}], ">", "D"}]}], ",", " ", 
              RowBox[{
               RowBox[{"and", " ", "1", " ", "if", " ", "A"}], "<", " ", 
               "D"}]}], " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "/", "2"}], ")"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"1", "+", 
                 RowBox[{"Sign", "[", "b", "]"}]}], " ", "=", " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"1", "/", "0"}], " ", "if", " ", "B"}], " ", ">", 
                 RowBox[{"0", " ", "and", " ", "0", " ", "otherwise"}]}]}], 
               " "}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "/", "2"}], ")"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"1", "-", 
                 RowBox[{"Sign", "[", "b", "]"}]}], " ", "=", " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"1", "/", "0"}], " ", "if", " ", "B"}], " ", "<", 
                 RowBox[{"0", " ", "and", " ", "0", " ", "otherwise"}]}]}], 
               " "}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "The", " ", "epsilon", " ", "is", " ", "added", " ", "to", " ", 
              "PDB", " ", "in", " ", "the", " ", "denominator", " ", "to", 
              " ", "prevent", " ", 
              RowBox[{"1", "/", "0"}], " ", "calculations"}], " ", "*)"}], 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"PDY", "[", "j", "]"}], "[", "Global`t", "]"}], 
             "\[Equal]", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{".5", 
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   RowBox[{"Sign", "[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"PDB", "[", "j", "]"}], "[", "Global`t", "]"}], 
                    "]"}], "-", "epsilon"}], "]"}]}], ")"}]}], ")"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"PDMAXEV", "[", "j", "]"}], "[", "Global`t", 
                    "]"}], "-", 
                   RowBox[{
                    RowBox[{"PDA", "[", "j", "]"}], "[", "Global`t", "]"}]}], 
                  ")"}], 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"Sign", "[", 
                    RowBox[{
                    RowBox[{"PDB", "[", "j", "]"}], "[", "Global`t", "]"}], 
                    "]"}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"PDB", "[", "j", "]"}], "[", "Global`t", "]"}], 
                    "]"}], "+", "epsilon"}], ")"}]}]}], ")"}]}], "+", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{".5", 
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"Sign", "[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"PDB", "[", "j", "]"}], "[", "Global`t", "]"}], 
                    "]"}], "-", "epsilon"}], "]"}]}], ")"}]}], ")"}], 
               RowBox[{"(", 
                RowBox[{".5", "*", 
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"Sign", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"PDA", "[", "j", "]"}], "[", "Global`t", "]"}], 
                    "-", 
                    RowBox[{
                    RowBox[{"PDD", "[", "j", "]"}], "[", "Global`t", "]"}]}], 
                    "]"}]}], ")"}]}], ")"}]}]}]}], ",", "\[IndentingNewLine]",
             "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"PDNORM", "[", "j", "]"}], "[", "Global`t", "]"}], 
             "\[Equal]", 
             RowBox[{"Sqrt", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"PDX", "[", "j", "]"}], "[", "Global`t", "]"}], "^", 
                "2"}], " ", "+", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"PDY", "[", "j", "]"}], "[", "Global`t", "]"}], "^", 
                "2"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"PDUNITX", "[", "j", "]"}], "[", "Global`t", "]"}], 
             "\[Equal]", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"PDX", "[", "j", "]"}], "[", "Global`t", "]"}], "/", 
              RowBox[{
               RowBox[{"PDNORM", "[", "j", "]"}], "[", "Global`t", "]"}]}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"PDUNITY", "[", "j", "]"}], "[", "Global`t", "]"}], 
             "\[Equal]", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"PDY", "[", "j", "]"}], "[", "Global`t", "]"}], "/", 
              RowBox[{
               RowBox[{"PDNORM", "[", "j", "]"}], "[", "Global`t", 
               "]"}]}]}]}], "\[IndentingNewLine]", "}"}]}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"funcs", "=", 
      RowBox[{"Flatten", "[", "funcs", "]"}]}], ";", "\[IndentingNewLine]", 
     "funcs"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.57749168479742*^9, 3.5774919172522717`*^9}, {
   3.577492001795762*^9, 3.5774920236914177`*^9}, {3.577492084322353*^9, 
   3.5774922976034403`*^9}, {3.5774923330088263`*^9, 
   3.5774923837006483`*^9}, {3.5774924173713083`*^9, 
   3.5774924690044203`*^9}, {3.577492798734791*^9, 3.57749279915793*^9}, {
   3.5774935192946653`*^9, 3.5774935873215923`*^9}, {3.577493695742361*^9, 
   3.577493731672373*^9}, {3.577493784106235*^9, 3.57749391033886*^9}, {
   3.5774939603392344`*^9, 3.577493963410318*^9}, {3.577494117074731*^9, 
   3.577494427872436*^9}, {3.577494471695067*^9, 3.577494482545116*^9}, 
   3.577530297418185*^9, 3.577530338009348*^9, 3.577530465408146*^9, {
   3.577531769758589*^9, 3.5775317877598467`*^9}, {3.577532597226063*^9, 
   3.577532631098678*^9}, {3.577534471855522*^9, 3.577534474315529*^9}, {
   3.577534516069572*^9, 3.5775345964839478`*^9}, {3.5775346347890587`*^9, 
   3.577534904920394*^9}, {3.577534936685288*^9, 3.5775350572011967`*^9}, {
   3.5775350900282097`*^9, 3.577535221131118*^9}, {3.577535309857424*^9, 
   3.577535313152378*^9}, {3.577535396476841*^9, 3.5775354204536753`*^9}, {
   3.577535455925679*^9, 3.577535457627246*^9}, {3.5775355006884003`*^9, 
   3.5775355432484694`*^9}, {3.577535577536252*^9, 3.57753560443816*^9}, {
   3.5775356921531897`*^9, 3.577535753359459*^9}, {3.57753580037886*^9, 
   3.577535938511794*^9}, 3.577536013121806*^9, {3.577536069642213*^9, 
   3.5775360906180267`*^9}, {3.577536476439993*^9, 3.577536495999852*^9}, {
   3.57753656287208*^9, 3.577536567386483*^9}, {3.57753659912288*^9, 
   3.5775366045633287`*^9}, {3.5775368997267227`*^9, 3.577536993756483*^9}, {
   3.577537195652219*^9, 3.577537331653219*^9}, {3.577537462588427*^9, 
   3.577537464001861*^9}, {3.577537567704164*^9, 3.577537569432118*^9}, {
   3.577537739807448*^9, 3.5775379212268887`*^9}, {3.577538262648592*^9, 
   3.577538266320711*^9}, {3.577538870026362*^9, 3.577538879739635*^9}, {
   3.5775391754318237`*^9, 3.577539203922192*^9}, {3.577539979684546*^9, 
   3.577539985083276*^9}, {3.577540040971209*^9, 3.5775400485365047`*^9}, {
   3.577540083468935*^9, 3.577540138841896*^9}, {3.577540266775332*^9, 
   3.577540268679283*^9}, {3.577541132617097*^9, 3.5775411631255817`*^9}, {
   3.57754511535832*^9, 3.577545115957748*^9}, {3.5775728840945883`*^9, 
   3.577572936586699*^9}},ExpressionUUID->"3b76cb1f-7b05-4df8-be1f-\
f3529c1f35e6"]
}, Closed]],

Cell[CellGroupData[{

Cell["SVD Based Version", "Subsubsection",
 CellChangeTimes->{{3.5776373067548027`*^9, 
  3.577637308937961*^9}},ExpressionUUID->"de80dc89-0b88-42aa-9db8-\
bf18685f96a0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SVDPrincipalDirectionFormula", "[", "T_Tissue", "]"}], ":=", " ", 
    RowBox[{"AbortIf", "[", 
     RowBox[{
     "True", ",", " ", 
      "\"\<Expecting SVDPrincipalDirection[DTissue,...], not Tissue\>\""}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"SVDPrincipalDirectionFormula", "[", 
      RowBox[{
       RowBox[{"T_", "?", "DTissueQ"}], ",", " ", "center_", ",", " ", "PD_", 
       ",", " ", "x_", ",", " ", "y_"}], "]"}], ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "PDBASE", ",", " ", "PDX", ",", " ", "PDY", ",", " ", "PD2X", ",", 
         "PD2Y", ",", " ", "PDUNITX", ",", " ", "PDUNITY", ",", " ", "PD2N", 
         ",", "PDU2X", ",", "PDU2Y", ",", " ", "PDNORM"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"PDBASE", " ", "=", " ", 
         RowBox[{"ToString", "[", "PD", "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"PDX", " ", "=", 
         RowBox[{"ToExpression", "[", 
          RowBox[{"PDBASE", "<>", "\"\<X\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"PDY", " ", "=", 
         RowBox[{"ToExpression", "[", 
          RowBox[{"PDBASE", "<>", "\"\<Y\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"PD2X", " ", "=", 
         RowBox[{"ToExpression", "[", 
          RowBox[{"PDBASE", "<>", "\"\<2X\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"PD2Y", " ", "=", 
         RowBox[{"ToExpression", "[", 
          RowBox[{"PDBASE", "<>", "\"\<2Y\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"PD2N", "=", 
         RowBox[{"ToExpression", "[", 
          RowBox[{"PDBASE", "<>", "\"\<N\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"PDU2X", " ", "=", 
         RowBox[{"ToExpression", "[", 
          RowBox[{"PDBASE", "<>", "\"\<U2X\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"PDU2Y", " ", "=", 
         RowBox[{"ToExpression", "[", 
          RowBox[{"PDBASE", "<>", "\"\<U2Y\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"PDNORM", "=", 
         RowBox[{"ToExpression", "[", 
          RowBox[{"PDBASE", "<>", "\"\<NORM\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"PDUNITX", " ", "=", 
         RowBox[{"ToExpression", "[", 
          RowBox[{"PDBASE", "<>", "\"\<UNITX\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"PDUNITY", " ", "=", 
         RowBox[{"ToExpression", "[", 
          RowBox[{"PDBASE", "<>", "\"\<UNITY\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"SVDPrincipalDirectionFormula", "[", 
         RowBox[{
         "T", ",", " ", "center", ",", " ", "PDX", ",", " ", "PDY", ",", 
          "PD2X", ",", "PD2Y", ",", "PD2N", ",", " ", "PDNORM", ",", " ", 
          "PDUNITX", ",", " ", "PDUNITY", ",", "  ", "x", ",", " ", "y"}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SVDPrincipalDirectionFormula", "[", 
   RowBox[{
    RowBox[{"T_", "?", "DTissueQ"}], ",", " ", "center_", ",", " ", "PD_", 
    ",", "  ", "x_", ",", " ", "y_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "n", ",", "nc", ",", "cvn", ",", " ", "cellnumbers", ",", " ", "xyvals", 
      ",", " ", "cell", ",", " ", "M", ",", " ", "i", ",", "j", ",", "  ", 
      "funcs", ",", " ", "a", ",", "  ", "b", ",", " ", "d", ",", " ", 
      "discr", ",", " ", "ev1", ",", " ", "ev2", ",", " ", "ev", ",", " ", 
      "S2T", ",", " ", "C2T", ",", " ", 
      RowBox[{"\[Epsilon]", "=", "0.001"}], ",", " ", "\[IndentingNewLine]", 
      "PDBASE", ",", " ", "PDX", ",", " ", "PDY", ",", " ", "PD2X", ",", " ", 
      "PD2Y", ",", "PDUNIT2X", ",", "PDUNIT2Y", ",", " ", "PD2NORM", ",", " ",
       "PDUNITX", ",", " ", "PDUNITY", ",", " ", "PDNORM"}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"PDBASE", " ", "=", " ", 
      RowBox[{"ToString", "[", "PD", "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"PDX", " ", "=", 
      RowBox[{"ToExpression", "[", 
       RowBox[{"PDBASE", "<>", "\"\<X\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"PDY", " ", "=", 
      RowBox[{"ToExpression", "[", 
       RowBox[{"PDBASE", "<>", "\"\<Y\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"PD2X", " ", "=", 
      RowBox[{"ToExpression", "[", 
       RowBox[{"PDBASE", "<>", "\"\<2X\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"PD2Y", " ", "=", 
      RowBox[{"ToExpression", "[", 
       RowBox[{"PDBASE", "<>", "\"\<2Y\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"PD2NORM", "=", 
      RowBox[{"ToExpression", "[", 
       RowBox[{"PDBASE", "<>", "\"\<2NORM\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"PDUNIT2X", " ", "=", 
      RowBox[{"ToExpression", "[", 
       RowBox[{"PDBASE", "<>", "\"\<UNIT2X\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"PDUNIT2Y", " ", "=", 
      RowBox[{"ToExpression", "[", 
       RowBox[{"PDBASE", "<>", "\"\<UNIT2Y\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"PDNORM", "=", 
      RowBox[{"ToExpression", "[", 
       RowBox[{"PDBASE", "<>", "\"\<NORM\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"PDUNITX", " ", "=", 
      RowBox[{"ToExpression", "[", 
       RowBox[{"PDBASE", "<>", "\"\<UNITX\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"PDUNITY", " ", "=", 
      RowBox[{"ToExpression", "[", 
       RowBox[{"PDBASE", "<>", "\"\<UNITY\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"n", "=", 
      RowBox[{"NTissueVertices", "[", "T", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"nc", "=", 
      RowBox[{"NTissueCells", "[", "T", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"cvn", "=", 
      RowBox[{"CellVertexNumbers", "[", "T", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"cellnumbers", "=", 
      RowBox[{"First", "/@", 
       RowBox[{"TissueCells", "[", "T", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"funcs", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", " ", 
       RowBox[{"i", "\[LessEqual]", " ", "nc"}], ",", " ", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cell", " ", "=", " ", 
         RowBox[{"cvn", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"xyvals", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"x", "[", "#", "]"}], "[", "Global`t", "]"}], "-", 
              RowBox[{
               RowBox[{"center", "[", 
                RowBox[{"i", ",", "1"}], "]"}], "[", "Global`t", "]"}]}], ",",
              " ", 
             RowBox[{
              RowBox[{
               RowBox[{"y", "[", "#", "]"}], "[", "Global`t", "]"}], "-", 
              RowBox[{
               RowBox[{"center", "[", 
                RowBox[{"i", ",", "2"}], "]"}], "[", "Global`t", "]"}]}]}], 
            "}"}], " ", "&"}], "/@", "cell"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"M", "=", 
         RowBox[{
          RowBox[{"Transpose", "[", "xyvals", "]"}], ".", "xyvals"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"a", "=", 
         RowBox[{"M", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"b", "=", 
         RowBox[{"M", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"matrix", " ", "is", " ", "symmetric"}], ",", " ", 
          RowBox[{"b", "=", "c"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"d", "=", 
         RowBox[{"M", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"j", "=", 
         RowBox[{"cellnumbers", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"C2T", "=", 
         RowBox[{"(", 
          RowBox[{"a", "-", "d"}], ")"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"S2T", "=", 
         RowBox[{"2", "b"}]}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"funcs", ",", " ", 
          RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"PD2X", "[", "j", "]"}], "[", "Global`t", "]"}], 
             "\[Equal]", "C2T"}], ",", " ", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"PD2Y", "[", "j", "]"}], "[", "Global`t", "]"}], 
             "\[Equal]", "S2T"}], ",", " ", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "convert", " ", "to", " ", "have", " ", "of", " ", "two"}], "-",
               "theta"}], " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"PD2NORM", "[", "j", "]"}], "[", "Global`t", "]"}], 
             "\[Equal]", 
             RowBox[{"Sqrt", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"PD2X", "[", "j", "]"}], "[", "Global`t", "]"}], "^",
                 "2"}], " ", "+", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"PD2Y", "[", "j", "]"}], "[", "Global`t", "]"}], "^",
                 "2"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"PDUNIT2X", "[", "j", "]"}], "[", "Global`t", "]"}], 
             "\[Equal]", 
             RowBox[{
              RowBox[{
               RowBox[{"PD2X", "[", "j", "]"}], "[", "Global`t", "]"}], "/", 
              RowBox[{
               RowBox[{"PD2NORM", "[", "j", "]"}], "[", "Global`t", "]"}]}]}],
             ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"PDUNIT2Y", "[", "j", "]"}], "[", "Global`t", "]"}], 
             "\[Equal]", 
             RowBox[{
              RowBox[{
               RowBox[{"PD2Y", "[", "j", "]"}], "[", "Global`t", "]"}], "/", 
              RowBox[{
               RowBox[{"PD2NORM", "[", "j", "]"}], "[", "Global`t", "]"}]}]}],
             ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "If", " ", "2", "\[Theta]", " ", "is", " ", "in", " ", "1", 
               RowBox[{"st", "/", "2"}], "nd", " ", "quadrant"}], ",", " ", 
              RowBox[{
              "andswer", " ", "is", " ", "in", " ", "1", "st", " ", 
               "quadrant"}], ",", " ", 
              RowBox[{"use", " ", "+", " ", 
               RowBox[{
               "roots", " ", "for", " ", "both", " ", "sine", " ", "and", " ",
                 "cosine"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "If", " ", "2", "\[Theta]", " ", "is", " ", "in", " ", "3", 
               RowBox[{"rd", "/", "4"}], "th", " ", "quadrant"}], ",", " ", 
              RowBox[{"answer", " ", "is", " ", "in", " ", "2", 
               RowBox[{"nd", "/", 
                RowBox[{"quadrant", ".", " ", "This"}]}], " ", "means", 
               "\[IndentingNewLine]", "positive", " ", "sine", " ", "and", 
               " ", "negative", " ", 
               RowBox[{"cosine", ".", " ", "Negative"}], " ", "cosine", " ", 
               "only", " ", "occurs", " ", "when", " ", "STC", " ", "is", " ",
                "negative"}]}], " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"The", " ", 
               RowBox[{"Sign", "[", "PD2Y", "]"}], " ", "causes", " ", "an", 
               " ", "NDSolve", " ", "stiffness", " ", "when", " ", "PD2Y", 
               " ", "passes", " ", "through", " ", "zero"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
               "adding", " ", "the", " ", "epsilong", " ", "curves", " ", 
                "the", " ", "functions", " ", "so", " ", "the", " ", "slope", 
                " ", "is", " ", "non"}], "-", "infinite"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"PDX", "[", "j", "]"}], "[", "Global`t", "]"}], 
             "\[Equal]", " ", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{"Sign", "[", 
                RowBox[{
                 RowBox[{"PD2Y", "[", "j", "]"}], "[", "Global`t", "]"}], 
                "]"}], "*"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"PD2Y", "[", "j", "]"}], "[", "Global`t", "]"}], "/", 
                RowBox[{"(", 
                 RowBox[{"\[Epsilon]", "+", 
                  RowBox[{"Abs", "[", 
                   RowBox[{
                    RowBox[{"PD2Y", "[", "j", "]"}], "[", "Global`t", "]"}], 
                   "]"}]}], ")"}]}], ")"}], "*", "\[IndentingNewLine]", 
              RowBox[{"Sqrt", "[", 
               RowBox[{"\[Epsilon]", "+", "1.0", "+", 
                RowBox[{
                 RowBox[{
                  RowBox[{"PDUNIT2X", "[", "j", "]"}], "[", "Global`t", "]"}],
                  "/", "2.0"}]}], "]"}]}]}], ",", " ", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"PDY", "[", "j", "]"}], "[", "Global`t", "]"}], 
             "\[Equal]", " ", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"\[Epsilon]", "+", "1.0", "-", 
               RowBox[{
                RowBox[{
                 RowBox[{"PDUNIT2X", "[", "j", "]"}], "[", "Global`t", "]"}], 
                "/", "2.0"}]}], "]"}]}]}], " ", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", "}"}]}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", "  ", 
     "\[IndentingNewLine]", 
     RowBox[{"funcs", "=", 
      RowBox[{"Flatten", "[", "funcs", "]"}]}], ";", "\[IndentingNewLine]", 
     "funcs"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.57749168479742*^9, 3.5774919172522717`*^9}, {
   3.577492001795762*^9, 3.5774920236914177`*^9}, {3.577492084322353*^9, 
   3.5774922976034403`*^9}, {3.5774923330088263`*^9, 
   3.5774923837006483`*^9}, {3.5774924173713083`*^9, 
   3.5774924690044203`*^9}, {3.577492798734791*^9, 3.57749279915793*^9}, {
   3.5774935192946653`*^9, 3.5774935873215923`*^9}, {3.577493695742361*^9, 
   3.577493731672373*^9}, {3.577493784106235*^9, 3.57749391033886*^9}, {
   3.5774939603392344`*^9, 3.577493963410318*^9}, {3.577494117074731*^9, 
   3.577494427872436*^9}, {3.577494471695067*^9, 3.577494482545116*^9}, 
   3.577530297418185*^9, 3.577530338009348*^9, 3.577530465408146*^9, {
   3.577531769758589*^9, 3.5775317877598467`*^9}, {3.577532597226063*^9, 
   3.577532631098678*^9}, {3.577534471855522*^9, 3.577534474315529*^9}, {
   3.577534516069572*^9, 3.5775345964839478`*^9}, {3.5775346347890587`*^9, 
   3.577534904920394*^9}, {3.577534936685288*^9, 3.5775350572011967`*^9}, {
   3.5775350900282097`*^9, 3.577535221131118*^9}, {3.577535309857424*^9, 
   3.577535313152378*^9}, {3.577535396476841*^9, 3.5775354204536753`*^9}, {
   3.577535455925679*^9, 3.577535457627246*^9}, {3.5775355006884003`*^9, 
   3.5775355432484694`*^9}, {3.577535577536252*^9, 3.57753560443816*^9}, {
   3.5775356921531897`*^9, 3.577535753359459*^9}, {3.57753580037886*^9, 
   3.577535938511794*^9}, 3.577536013121806*^9, {3.577536069642213*^9, 
   3.5775360906180267`*^9}, {3.577536476439993*^9, 3.577536495999852*^9}, {
   3.57753656287208*^9, 3.577536567386483*^9}, {3.57753659912288*^9, 
   3.5775366045633287`*^9}, {3.5775368997267227`*^9, 3.577536993756483*^9}, {
   3.577537195652219*^9, 3.577537331653219*^9}, {3.577537462588427*^9, 
   3.577537464001861*^9}, {3.577537567704164*^9, 3.577537569432118*^9}, {
   3.577537739807448*^9, 3.5775379212268887`*^9}, {3.577538262648592*^9, 
   3.577538266320711*^9}, {3.577538870026362*^9, 3.577538879739635*^9}, {
   3.5775391754318237`*^9, 3.577539203922192*^9}, {3.577539979684546*^9, 
   3.577539985083276*^9}, {3.577540040971209*^9, 3.5775400485365047`*^9}, {
   3.577540083468935*^9, 3.577540138841896*^9}, {3.577540266775332*^9, 
   3.577540268679283*^9}, {3.577541132617097*^9, 3.5775411631255817`*^9}, {
   3.57754511535832*^9, 3.577545115957748*^9}, {3.5775728840945883`*^9, 
   3.577572936586699*^9}, {3.577635896711626*^9, 3.577635934569642*^9}, {
   3.577636116772015*^9, 3.577636143254177*^9}, {3.5776362227602882`*^9, 
   3.577636262020649*^9}, {3.577636853295951*^9, 3.57763698077382*^9}, {
   3.5776372705131607`*^9, 3.5776372957668657`*^9}, {3.577648840941607*^9, 
   3.577648951581294*^9}, {3.577649103501926*^9, 3.577649108590019*^9}, {
   3.577649206369684*^9, 3.577649254701746*^9}, {3.577649315180155*^9, 
   3.57764936983489*^9}, {3.5776494658576927`*^9, 3.577649520659009*^9}, {
   3.5776495547875338`*^9, 3.577649574347699*^9}, {3.577649613278047*^9, 
   3.577649626908753*^9}, {3.577649670400896*^9, 3.577649693146802*^9}, {
   3.57765010922593*^9, 3.57765015880407*^9}, {3.577650209833425*^9, 
   3.577650322055238*^9}, {3.577651114694442*^9, 3.5776511716709213`*^9}, {
   3.577657817515119*^9, 3.577657822341896*^9}, {3.577657853666072*^9, 
   3.577657857454302*^9}, {3.577658194045224*^9, 3.57765821785993*^9}, {
   3.577659059196604*^9, 3.577659065944762*^9}, {3.577661346184396*^9, 
   3.577661358207428*^9}, {3.577734858160308*^9, 3.577735058680151*^9}, {
   3.577735098583222*^9, 3.577735371681964*^9}, {3.577735535812706*^9, 
   3.577735554057993*^9}, {3.577735764123611*^9, 3.57773576676595*^9}, {
   3.577735824111394*^9, 3.577735836253447*^9}, {3.577735986564694*^9, 
   3.577735987007267*^9}, {3.5777376559392548`*^9, 3.577737705382143*^9}, {
   3.577738129847947*^9, 3.577738152159885*^9}, {3.577738250347177*^9, 
   3.577738263740046*^9}, {3.577738529372766*^9, 3.577738544296997*^9}, {
   3.577738576347872*^9, 3.577738587322888*^9}, {3.577739646836012*^9, 
   3.577739733765698*^9}, {3.577739796554799*^9, 3.577739806842144*^9}, {
   3.577740264310178*^9, 3.577740294607563*^9}, {3.5777404223873043`*^9, 
   3.5777404311683826`*^9}, {3.577740485302966*^9, 
   3.577740544345302*^9}},ExpressionUUID->"278a8bf4-67a1-43e7-be9f-\
6944e0dc7626"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["DetermineL2AnticlinalPlane", "Subsection",
 CellChangeTimes->{{3.5772113673766727`*^9, 
  3.5772113734951057`*^9}},ExpressionUUID->"c6ecf24e-5f81-479b-8a4c-\
184797e70f46"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DetermineL2AnticlinalPlane", "[", 
   RowBox[{"T_", ",", " ", "i_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "cn", ",", " ", "l1", ",", " ", "v", ",", " ", "e", ",", " ", "c", ",", 
      " ", "cvn", ",", " ", "cvni", ",", " ", "cvnn", ",", "icvn", ",", " ", 
      "ipairs", ",", " ", "vpairs", ",", " ", "ipair", ",", " ", "v1", ",", 
      " ", "v2", ",", " ", "p1", ",", " ", "p2", ",", " ", "dx", ",", " ", 
      "dy", ",", " ", "cvc", ",", " ", "theta1", ",", " ", "theta2", ",", " ",
       "cen", ",", " ", 
      RowBox[{"dbg", "=", "False"}], ",", " ", "dPrint"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"dPrint", "[", "u___", "]"}], ":=", " ", 
      RowBox[{"If", "[", 
       RowBox[{"dbg", ",", " ", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<DetermineL2AnticlinalPlane: \>\"", ",", " ", "u"}], 
         "]"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"cn", "=", 
      RowBox[{"CellNeighbors", "[", 
       RowBox[{"T", ",", "i"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"l1", "=", 
      RowBox[{"L1Cells", "[", "T", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "l1", " ", "cells", " ", "that", " ", "abut", " ", "i", " ", "on", " ", 
       "L2"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"cn", " ", "=", " ", 
      RowBox[{"Intersection", "[", 
       RowBox[{"l1", ",", " ", "cn"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"v", ",", "e", ",", " ", "c"}], "}"}], " ", "=", " ", 
      RowBox[{"T", "/.", 
       RowBox[{"{", 
        RowBox[{"Tissue", "\[Rule]", " ", "List"}], "}"}]}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<cn = \>\"", ",", " ", "cn"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"cvn", " ", "=", " ", 
      RowBox[{"CellVertexNumbers", "[", "T", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"vertex", " ", "numbers", " ", "of", " ", "cell", " ", "i"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"cvni", "=", 
      RowBox[{"cvn", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"cvc", " ", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"v", "[", 
         RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "cvni"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<cvc: \>\"", ",", " ", "cvc"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"cen", " ", "=", " ", 
      RowBox[{"Centroid", "[", "cvc", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "vertex", " ", "numbers", " ", "of", " ", "cells", " ", "Abuting", " ", 
       "cell", " ", "i", " ", "in", " ", "L1"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"cvnn", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{"cvn", "[", 
        RowBox[{"[", "cn", "]"}], "]"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"common", " ", "vertex", " ", "numnbers"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"icvn", " ", "=", " ", 
      RowBox[{"Intersection", "[", 
       RowBox[{"cvni", ",", " ", "cvnn"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"AbortIf", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "icvn", "]"}], "<", "2"}], ",", " ", 
       RowBox[{
       "\"\<DetermineL2AnticlinalPlane: does not appear to be an L2 cell, i = \
\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"InputForm", "[", "i", "]"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<icvn: \>\"", ",", " ", "icvn"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"ipairs", " ", "=", " ", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"Permutations", "[", 
         RowBox[{"icvn", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}], ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"First", "[", "#", "]"}], "<", 
          RowBox[{"Last", "[", "#", "]"}]}], "&"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"vpairs", " ", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"distance", "@@", "#"}], "&"}], "/@", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "ipairs"}], ")"}]}]}],
      ";", "  ", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<ipairs: \>\"", ",", " ", "ipairs"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<vpairs: \>\"", ",", " ", "vpairs"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"ipair", " ", "=", " ", 
      RowBox[{"Ordering", "[", 
       RowBox[{"vpairs", ",", 
        RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ListQ", "[", "ipair", "]"}], " ", "\[And]", 
        RowBox[{
         RowBox[{"Length", "[", "ipair", "]"}], ">", "0"}]}], ",", " ", 
       RowBox[{"ipair", "=", 
        RowBox[{"First", "[", "ipair", "]"}]}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"AbortIf", "[", 
      RowBox[{
       RowBox[{"ListQ", "[", "ipair", "]"}], ",", " ", 
       RowBox[{
       "\"\<DetermineL2AnticlinalPlane: fewer than two vertices of cell are \
shared with L1. This does not appear to be an L2 cell: \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"InputForm", "[", "i", "]"}], "]"}]}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<ipair: \>\"", ",", " ", "ipair"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"ipair", "=", 
      RowBox[{"ipairs", "[", 
       RowBox[{"[", "ipair", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<ipair: \>\"", ",", " ", "ipair"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"v1", "=", 
      RowBox[{"v", "[", 
       RowBox[{"[", 
        RowBox[{"ipair", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"v2", " ", "=", " ", 
      RowBox[{"v", "[", 
       RowBox[{"[", 
        RowBox[{"ipair", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], ";", "  ", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{
      "\"\<v1=\>\"", ",", " ", "v1", ",", " ", "\"\<v2 = \>\"", ",", " ", 
       "v2"}], "]"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"dx", ",", " ", "dy"}], "}"}], "=", 
      RowBox[{"v2", "-", "v1"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<{dx,dy}=\>\"", ",", " ", 
       RowBox[{"{", 
        RowBox[{"dx", ",", " ", "dy"}], "}"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p1", ",", " ", "p2"}], "}"}], " ", "=", 
      RowBox[{"PolygonIntersection", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "dy"}], ",", " ", "dx"}], "}"}], ",", "cvc"}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"p1", "=", 
      RowBox[{"p1", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", " ", 
     RowBox[{"p2", "=", 
      RowBox[{"p2", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"theta1", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"180.0", "/", "Pi"}], ")"}], "*", 
       RowBox[{"ArcTan", "@@", 
        RowBox[{"(", 
         RowBox[{"p1", "+", "cen"}], ")"}]}]}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"theta2", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"180.0", "/", "Pi"}], ")"}], "*", 
       RowBox[{"ArcTan", "@@", 
        RowBox[{"(", 
         RowBox[{"p2", "+", "cen"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"theta1", ",", " ", "theta2"}], "}"}], ",", " ", "p1", ",", 
        "p2"}], "}"}], "]"}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5772113750212393`*^9, 3.577211512068173*^9}, {
   3.577211565285845*^9, 3.5772115905651627`*^9}, {3.577211684782502*^9, 
   3.577211685996477*^9}, {3.577211763677456*^9, 3.577211833063032*^9}, {
   3.577213229774827*^9, 3.5772132626729403`*^9}, {3.5772133065028343`*^9, 
   3.5772134115943213`*^9}, {3.57721393400252*^9, 3.5772140372248583`*^9}, {
   3.577214080483965*^9, 3.5772147033899927`*^9}, 3.5772147345786467`*^9, {
   3.577214773706036*^9, 
   3.577214867591292*^9}},ExpressionUUID->"c33ce7ff-3445-4888-9730-\
a0fff3d0d273"]
}, Closed]],

Cell[CellGroupData[{

Cell["DetermineAnticlinalPlane", "Subsection",
 CellChangeTimes->{{3.5722257545431147`*^9, 
  3.572225760631781*^9}},ExpressionUUID->"f2ebb64d-291e-4bf2-a2e2-\
60432f76b4c7"],

Cell["\<\
Sorts out outer vertices and finds normal to line from first to last.
3.0.41 - revise to intersect midpoint of L1 rather than be normal to L1 \
because normal may not actually intersect edge.\
\>", "Text",
 CellChangeTimes->{{3.57731784469125*^9, 3.5773178851560507`*^9}, {
  3.577995532134403*^9, 3.577995551924814*^9}, {3.5784004423025103`*^9, 
  3.578400443333283*^9}, {3.578400798092107*^9, 
  3.578400840370576*^9}},ExpressionUUID->"54aafc9e-eb77-425b-ae69-\
ec1fdcaddd23"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DetermineAnticlinalPlane", "[", 
   RowBox[{"T_", ",", " ", "i_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "v", ",", "e", ",", "c", ",", "outeredge", ",", "vouter", ",", " ", 
      "cvc", ",", "cen", ",", "v1", ",", "v2", ",", "dx", ",", "dy", ",", 
      "p1", ",", "p2", ",", "theta1", ",", "theta2", ",", 
      RowBox[{"dbg", "=", "False"}], ",", " ", "dPrint"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"dPrint", "[", "u___", "]"}], ":=", " ", 
      RowBox[{"If", "[", 
       RowBox[{"dbg", ",", " ", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<DetermineAnticlinalPlane: \>\"", ",", " ", "u"}], 
         "]"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"v", ",", "e", ",", "c"}], "}"}], " ", "=", " ", 
      RowBox[{"T", "/.", 
       RowBox[{"{", 
        RowBox[{"Tissue", "\[Rule]", " ", "List"}], "}"}]}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"cvc", " ", "=", " ", 
      RowBox[{"CellVertexCoordinates", "[", 
       RowBox[{"T", ",", "i"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"outeredge", " ", "=", " ", 
      RowBox[{"Complement", "[", 
       RowBox[{
        RowBox[{"c", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"Flatten", "[", 
         RowBox[{"c", "[", 
          RowBox[{"[", 
           RowBox[{"CellNeighbors", "[", 
            RowBox[{"T", ",", "i"}], "]"}], "]"}], "]"}], "]"}]}], "]"}]}], 
     ";", " ", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<outeredge: \>\"", ",", " ", "outeredge"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"vouter", " ", "=", " ", 
      RowBox[{"\"\<Vertices\>\"", "/.", 
       RowBox[{"SortCellEdges", "[", 
        RowBox[{"outeredge", ",", " ", "e"}], "]"}]}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<vouter: \>\"", ",", " ", "vouter"}], "]"}], ";", "  ", 
     "\[IndentingNewLine]", 
     RowBox[{"v1", " ", "=", " ", 
      RowBox[{"First", "[", "vouter", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"v2", "=", 
      RowBox[{"Last", "[", "vouter", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<{v1,v2}: \>\"", ",", " ", 
       RowBox[{"{", 
        RowBox[{"v1", ",", " ", "v2"}], "}"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"v1", "=", 
      RowBox[{"v", "[", 
       RowBox[{"[", "v1", "]"}], "]"}]}], ";", " ", 
     RowBox[{"v2", "=", 
      RowBox[{"v", "[", 
       RowBox[{"[", "v2", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"cen", " ", "=", " ", 
      RowBox[{"Centroid", "[", "cvc", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "find", " ", "intersection", " ", "between", " ", "normal", " ", 
       "through", " ", "center", " ", "and", " ", "edge"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"dx", ",", " ", "dy"}], "}"}], "=", 
      RowBox[{"v2", "-", "v1"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p1", ",", " ", "p2"}], "}"}], " ", "=", 
      RowBox[{"PolygonIntersection", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "dy"}], ",", " ", "dx"}], "}"}], ",", "cvc"}], "]"}]}],
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "find", " ", "intersection", " ", "between", " ", "midpoint", " ", 
       "through", " ", "edge"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"dx", ",", " ", "dy"}], "}"}], "=", 
      RowBox[{
       RowBox[{"0.5", 
        RowBox[{"(", 
         RowBox[{"v2", "+", "v1"}], ")"}]}], "-", "cen"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p1", ",", " ", "p2"}], "}"}], " ", "=", 
      RowBox[{"PolygonIntersection", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"dx", ",", " ", "dy"}], "}"}], ",", "cvc"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"p1", "=", 
      RowBox[{"p1", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", " ", 
     RowBox[{"p2", "=", 
      RowBox[{"p2", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"theta1", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"180.0", "/", "Pi"}], ")"}], "*", 
       RowBox[{"ArcTan", "@@", 
        RowBox[{"(", 
         RowBox[{"p1", "+", "cen"}], ")"}]}]}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"theta2", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"180.0", "/", "Pi"}], ")"}], "*", 
       RowBox[{"ArcTan", "@@", 
        RowBox[{"(", 
         RowBox[{"p2", "+", "cen"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"theta1", ",", " ", "theta2"}], "}"}], ",", " ", "p1", ",", 
        "p2"}], "}"}], "]"}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.572225762785253*^9, 3.572225899140892*^9}, 
   3.5722259316616783`*^9, {3.572226044114182*^9, 3.57222610169617*^9}, {
   3.577215844509263*^9, 3.577215845050418*^9}, {3.577994009238885*^9, 
   3.577994029998356*^9}, {3.5779940751393642`*^9, 3.577994093298161*^9}, {
   3.5779953224474173`*^9, 3.577995453527051*^9}, {3.577995486460853*^9, 
   3.577995524182889*^9}, {3.5784006697459373`*^9, 3.578400794902397*^9}, 
   3.5784008482760153`*^9},ExpressionUUID->"60f3ad8e-da78-407b-b697-\
05977282e713"]
}, Closed]],

Cell[CellGroupData[{

Cell["DetermineCellDivisionPoints", "Subsection",
 CellChangeTimes->{{3.546701690473915*^9, 
  3.546701716866929*^9}},ExpressionUUID->"2fe73c14-cd7d-4237-88f3-\
f14946768bab"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DetermineCellDivisionPoints", "[", 
   RowBox[{"sim_", ",", 
    RowBox[{"DT_", "?", "DTissueQ"}], ",", "L1Anticlinal_", ",", 
    "L2Anticlinal_", ",", " ", "L2AnticlinalRatio_", ",", " ", "upwards_", 
    ",", " ", 
    RowBox[{"w_", "?", "ListQ"}], ",", 
    RowBox[{"x_:", " ", "Global`x"}], ",", 
    RowBox[{"y_:", " ", "Global`y"}], ",", "method_", ",", " ", 
    RowBox[{"minAngleSpread_:", "135"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "divided", ",", "span", ",", "done", ",", "s", ",", "T", ",", 
      "actualCellNumber", ",", "CDT", ",", "CT", ",", 
      "dividedCellEdgeNumbers", ",", "positionalcellindex", ",", "CVC", ",", 
      "PGD", ",", "dPrint", ",", 
      RowBox[{"dbg", "=", "False"}], ",", "weight", ",", "angles", ",", " ", 
      "results", ",", " ", "PCD", ",", "cellMinimumYCoordinate", ",", " ", 
      "BC", ",", "doneByL1L2", ",", "v", ",", "ymin", ",", "meanradius", ",", 
      "evr"}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"dPrint", "[", "u___", "]"}], ":=", 
      RowBox[{"If", "[", 
       RowBox[{"dbg", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<DetermineCellDivision: \>\"", ",", "u"}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"done", "=", 
      RowBox[{"\"\<Finished\>\"", "/.", "sim"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"s", "=", 
      RowBox[{"\"\<Solution\>\"", "/.", "sim"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"span", "=", 
      RowBox[{"\"\<TimeSpan\>\"", "/.", "sim"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"divided", "=", 
      RowBox[{"\"\<Divide\>\"", "/.", "sim"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"CDT", "=", 
      RowBox[{"TissueCells", "[", "DT", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"done", ",", 
       RowBox[{"Return", "[", 
        RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"T", "=", 
      RowBox[{"DTissue2Tissue", "[", 
       RowBox[{"DT", ",", "s", ",", 
        RowBox[{"span", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"CT", "=", 
      RowBox[{"TissueCells", "[", "T", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"v", "=", 
      RowBox[{"TissueVertices", "[", "T", "]"}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"ymin", "=", 
      RowBox[{"Min", "[", 
       RowBox[{
        RowBox[{"Transpose", "[", "v", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"meanradius", "=", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"Mean", "[", 
         RowBox[{"areafunction", "[", "T", "]"}], "]"}], "/", "Pi"}], "]"}]}],
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"results", "=", 
      RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"BC", " ", "=", " ", 
      RowBox[{"CellsOnBoundary", "[", "T", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"L1Anticlinal", " ", ",", "  ", 
       RowBox[{"l1cells", "=", 
        RowBox[{"L1Cells", "[", "DT", "]"}]}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"L2Anticlinal", ",", " ", 
       RowBox[{"l2cells", "=", 
        RowBox[{"L2Cells", "[", "DT", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", " ", 
      RowBox[{
      "\"\<L1Anticlinal: \>\"", ",", " ", "L1Anticlinal", ",", " ", 
       "\"\< l1cells \>\"", ",", " ", "l1cells"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{
      "\"\<L2Anticlinal: \>\"", ",", " ", "L2Anticlinal", ",", " ", 
       "\"\< l2cells: \>\"", ",", " ", "l2cells"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "divided", "]"}], ">", "0"}], ",", 
       RowBox[{
        RowBox[{"actualCellNumber", "=", 
         RowBox[{"First", "[", "divided", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dPrint", "[", 
         RowBox[{"\"\<actualCellNumber = \>\"", ",", "actualCellNumber"}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"divided", "=", 
         RowBox[{"Rest", "[", "divided", "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"dividedCellEdgeNumbers", "=", 
         RowBox[{"actualCellNumber", "/.", "CDT"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dPrint", "[", 
         RowBox[{
         "\"\<dividedCellEdgeNumbers = \>\"", ",", "dividedCellEdgeNumbers"}],
          "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"positionalcellindex", "=", 
         RowBox[{"Position", "[", 
          RowBox[{"CT", ",", "dividedCellEdgeNumbers"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"ListQ", "[", "positionalcellindex", "]"}], ",", 
          RowBox[{"positionalcellindex", "=", 
           RowBox[{"First", "[", "positionalcellindex", "]"}]}]}], "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"dPrint", "[", 
         RowBox[{"\"\<positionalcellindex=\>\"", ",", "positionalcellindex"}],
          "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"CVC", "=", 
         RowBox[{"CellVertexCoordinates", "[", 
          RowBox[{"T", ",", "positionalcellindex"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dPrint", "[", 
         RowBox[{"\"\<CVC = \>\"", ",", "CVC"}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"check", " ", "for", " ", "anticlinal", " ", "division"}], 
         " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"doneByL1L2", "=", "False"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"dPrint", "[", 
         RowBox[{"\"\<L1Anticlinal: \>\"", ",", " ", "L1Anticlinal"}], "]"}], 
        ";", " ", "\[IndentingNewLine]", 
        RowBox[{"dPrint", "[", 
         RowBox[{"\"\<L2Anticlinal: \>\"", ",", " ", "L2Anticlinal"}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"dPrint", "[", 
         RowBox[{"\"\<Boundary Cells: \>\"", ",", " ", "BC"}], "]"}], ";", 
        " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"doneByL1L2", "=", "False"}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"L2Anticlinal", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{"l2cells", ",", " ", "positionalcellindex"}], "]"}], 
             ",", " ", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{"Test", " ", "for", " ", "Elongation"}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"evr", "=", 
                  RowBox[{"EigenRatio", "[", "CVC", "]"}]}], ")"}], ">", 
                "L2AnticlinalRatio"}], ",", " ", "\[IndentingNewLine]", 
               RowBox[{"Print", "[", 
                RowBox[{
                "\"\<L2 Anticlinal division overriden: Cell \>\"", ",", " ", 
                 "positionalcellindex", " ", ",", " ", 
                 "\"\< ratio of eigenvalues = \>\"", ",", "evr", " ", ",", 
                 " ", "\"\< exceeds \>\"", ",", " ", "L2AnticlinalRatio"}], 
                "]"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{
                 "\"\<L2 Anticlinal division: Cell \>\"", ",", " ", 
                  "positionalcellindex"}], "]"}], ";", " ", 
                "\[IndentingNewLine]", 
                RowBox[{"angles", " ", "=", " ", 
                 RowBox[{"DetermineL2AnticlinalPlane", "[", 
                  RowBox[{"T", ",", " ", "positionalcellindex"}], "]"}]}], 
                ";", " ", "\[IndentingNewLine]", 
                RowBox[{"doneByL1L2", "=", "True"}], ";"}]}], " ", 
              "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
           ";"}]}], " ", "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], 
        ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "[", "doneByL1L2", "]"}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{"L1Anticlinal", ",", " ", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
              "anticlinal", " ", "if", " ", "on", " ", "the", " ", 
               "boundary"}], " ", "*)"}], "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"MemberQ", "[", 
                RowBox[{"l1cells", ",", "positionalcellindex"}], "]"}], ",", 
               " ", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"angles", " ", "=", " ", 
                 RowBox[{"DetermineAnticlinalPlane", "[", 
                  RowBox[{"T", ",", " ", "positionalcellindex"}], "]"}]}], 
                ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"Print", "[", 
                 RowBox[{
                 "\"\<L1 Anticlinal division:Cell \>\"", ",", " ", 
                  "positionalcellindex"}], "]"}], ";", " ", 
                "\[IndentingNewLine]", 
                RowBox[{"doneByL1L2", "=", "True"}]}]}], "]"}]}], 
            "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}]}], " ",
          "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "[", "doneByL1L2", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Switch", "[", 
           RowBox[{
           "method", ",", "\[IndentingNewLine]", "1", ",", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
             "Want", " ", "to", " ", "be", " ", "perpendicular", " ", "to", 
              " ", 
              RowBox[{"Princ", ".", " ", "Growth"}], " ", "Direction"}], " ", 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"PGD", "=", 
              RowBox[{"PrincipalGrowthDirection", "[", 
               RowBox[{"DT", ",", "actualCellNumber", ",", "s", ",", 
                RowBox[{"span", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", "x", ",", "y"}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"dPrint", "[", 
              RowBox[{"\"\<PGD = \>\"", ",", "PGD"}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
              "Same", " ", "Thing", " ", "for", " ", "Principal", " ", "Cell",
                " ", "Direction"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
             RowBox[{"PCD", " ", "=", 
              RowBox[{"PrincipalCellDirection", "[", 
               RowBox[{
               "DT", ",", " ", "actualCellNumber", ",", " ", "s", ",", " ", 
                RowBox[{"span", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", " ", "x", ",", " ", 
                "y"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
             RowBox[{"dPrint", "[", 
              RowBox[{"\"\<PCD = \>\"", ",", "PCD"}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"weight", "=", 
              RowBox[{"Take", "[", 
               RowBox[{
                RowBox[{"PadRight", "[", 
                 RowBox[{
                  RowBox[{"Flatten", "[", 
                   RowBox[{"{", "w", "}"}], "]"}], ",", "4"}], "]"}], ",", 
                "4"}], "]"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<Cell Division Weight Vector: \>\"", ",", " ", "weight"}], 
              "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"dPrint", "[", 
              RowBox[{"\"\<weight = \>\"", ",", "weight"}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"angles", "=", 
              RowBox[{"OptimizeDivisionPotential", "[", 
               RowBox[{
               "CVC", ",", "weight", ",", "PGD", ",", "PCD", ",", " ", 
                "minAngleSpread"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"dPrint", "[", 
              RowBox[{"\"\<angles = \>\"", ",", "angles"}], "]"}], ";"}], 
            "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "2", ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "Print", "[", "\"\<Cell Division Errera's Method\>\"", "]"}], 
             ";", " ", "\[IndentingNewLine]", 
             RowBox[{"angles", "=", 
              RowBox[{"Errera", "[", 
               RowBox[{"CVC", ",", "120"}], "]"}]}]}], "\[IndentingNewLine]", 
            ",", "\[IndentingNewLine]", "_", ",", " ", "\[IndentingNewLine]", 
            
            RowBox[{"AbortIf", "[", 
             RowBox[{"True", ",", " ", 
              RowBox[{
              "\"\<Error: DetermineCellDivisionPoints: Invalid Method = \>\"",
                "<>", 
               RowBox[{"ToString", "[", "method", "]"}]}]}], "]"}]}], 
           "\[IndentingNewLine]", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"AppendTo", "[", 
         RowBox[{"results", ",", " ", "angles"}], "]"}], ";"}]}], " ", 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{
      "\"\<DetermineCellDivisionPoints: results: \>\"", ",", " ", "results"}],
       "]"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "results", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.546701702722623*^9, 3.546701702723884*^9}, {
   3.546701735879292*^9, 3.546701803521522*^9}, {3.5467018581096773`*^9, 
   3.546701870783842*^9}, {3.5468089089521427`*^9, 3.5468089095818863`*^9}, {
   3.546809254343378*^9, 3.546809302293745*^9}, {3.546884269967491*^9, 
   3.546884270765483*^9}, {3.547055774948009*^9, 3.547055775374831*^9}, {
   3.5472182823183603`*^9, 3.5472182831160507`*^9}, {3.547577406936336*^9, 
   3.547577407574072*^9}, {3.547586285698185*^9, 3.547586286737997*^9}, {
   3.5476467456521463`*^9, 3.5476468010441923`*^9}, {3.547647110851626*^9, 
   3.547647130964202*^9}, {3.547670082934771*^9, 3.5476701472109423`*^9}, {
   3.547670253244053*^9, 3.5476703181048603`*^9}, {3.566139646032611*^9, 
   3.566139649408369*^9}, {3.5661403492818537`*^9, 3.566140512895158*^9}, {
   3.5661409053978558`*^9, 3.566140939396625*^9}, {3.566141720201551*^9, 
   3.566141742936068*^9}, {3.56614272233602*^9, 3.566142735232162*^9}, 
   3.566143334930785*^9, {3.566401405844385*^9, 3.566401406436657*^9}, {
   3.566401981769808*^9, 3.566401987640565*^9}, {3.5664020651245527`*^9, 
   3.566402065629032*^9}, {3.572224158604327*^9, 3.572224160321797*^9}, {
   3.5722241958479548`*^9, 3.572224196059883*^9}, {3.5722242769741383`*^9, 
   3.572224293222649*^9}, {3.572224368642016*^9, 3.572224511279842*^9}, {
   3.572224715961426*^9, 3.5722247286333933`*^9}, {3.572224966363188*^9, 
   3.572225118548316*^9}, {3.5722251574901648`*^9, 3.572225206545545*^9}, {
   3.572225323255808*^9, 3.572225366183444*^9}, {3.57222540576301*^9, 
   3.572225415764586*^9}, {3.572225545377761*^9, 3.5722255956207733`*^9}, {
   3.5722256514563513`*^9, 3.572225738738104*^9}, {3.572226036561247*^9, 
   3.5722260378078003`*^9}, {3.572226111805172*^9, 3.572226158866789*^9}, {
   3.5722273654502068`*^9, 3.572227375604471*^9}, 3.572228239129249*^9, {
   3.5722617905801487`*^9, 3.572261793011384*^9}, {3.572261845802403*^9, 
   3.5722620553663473`*^9}, {3.5730482121144743`*^9, 3.573048212511997*^9}, {
   3.573048453882454*^9, 3.573048459105124*^9}, {3.5730485256101923`*^9, 
   3.5730485708721867`*^9}, {3.573048814604892*^9, 3.573048817945416*^9}, {
   3.5730490287192507`*^9, 3.573049029229836*^9}, {3.575638461000914*^9, 
   3.575638495163756*^9}, {3.575638526659705*^9, 3.575638574596055*^9}, {
   3.5756386594529552`*^9, 3.575638748737505*^9}, {3.577209710769815*^9, 
   3.577209733547903*^9}, {3.577210275074366*^9, 3.5772107732455273`*^9}, {
   3.5772108365703993`*^9, 3.577210837098042*^9}, {3.577211462681819*^9, 
   3.5772114649431057`*^9}, {3.577212181441366*^9, 3.577212184934064*^9}, {
   3.577212453511415*^9, 3.577212498040504*^9}, {3.577212582473146*^9, 
   3.5772125952392387`*^9}, {3.577212683837373*^9, 3.577212702673883*^9}, {
   3.577215862317279*^9, 3.5772160256653013`*^9}, {3.577216137321581*^9, 
   3.577216164267333*^9}, {3.577216247779586*^9, 3.577216248944923*^9}, {
   3.5773175205044823`*^9, 3.577317545960288*^9}, {3.577317744486167*^9, 
   3.577317752918474*^9}, {3.7057129095948687`*^9, 
   3.705712912794094*^9}},ExpressionUUID->"8f1bd3e4-1f61-4f82-93f8-\
1ead0f473461"]
}, Closed]],

Cell[CellGroupData[{

Cell["DivideNSigmas", "Subsection",
 CellChangeTimes->{{3.577985570264881*^9, 
  3.577985572816255*^9}},ExpressionUUID->"a5f395f8-2736-4a5c-ada4-\
88770d86231e"],

Cell["\<\
Returns a tissue will all the cells that have area larger than mu+nsig*sigma \
divided by Errera\[CloseCurlyQuote]s rule where
mu and sigma are mean and standard deviation of the cell area of the input \
tissue\
\>", "Text",
 CellChangeTimes->{{3.577985581530629*^9, 
  3.577985628104047*^9}},ExpressionUUID->"ebe2fa27-98bc-467b-b2fb-\
49fdc10002bb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DivideNSigmas", "[", 
   RowBox[{"q_Tissue", ",", "nsig_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "cvc", ",", "q1", ",", "q2", ",", "areas", ",", "sigma", ",", "nsigs", 
      ",", "mu", ",", "n", ",", "angles", ",", "p1", ",", "p2", ",", 
      RowBox[{"dbg", "=", "False"}], ",", "dPrint"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"dPrint", "[", "u___", "]"}], ":=", " ", 
      RowBox[{"If", "[", 
       RowBox[{"dbg", ",", " ", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<DivideNSigmas: \>\"", ",", " ", "u"}], "]"}]}], "]"}]}],
      ";", " ", "\[IndentingNewLine]", 
     RowBox[{"cvc", "=", 
      RowBox[{"CellVertexCoordinates", "[", "q", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"q1", "=", "q"}], ";", "\[IndentingNewLine]", 
     RowBox[{"areas", "=", 
      RowBox[{"areafunction", "[", "q", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mu", "=", 
      RowBox[{"Mean", "[", "areas", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sigma", "=", 
      RowBox[{"StandardDeviation", "[", "areas", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{
      "\"\<mu=\>\"", ",", "mu", ",", "\"\< sigma=\>\"", ",", "sigma"}], "]"}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<areas=\>\"", ",", " ", "areas"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"nsigs", "=", 
      RowBox[{"Pick", "[", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", "areas", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"#", ">", 
            RowBox[{"(", 
             RowBox[{"mu", "+", 
              RowBox[{"nsig", "*", "sigma"}]}], ")"}]}], ")"}], "&"}], "/@", 
         "areas"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<nsigs: \>\"", ",", " ", "nsigs"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "nsigs", "]"}], ">", "0"}], ",", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"First", "[", "nsigs", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"nsigs", "=", 
         RowBox[{"Rest", "[", "nsigs", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"angles", ",", "p1", ",", "p2"}], "}"}], "=", 
         RowBox[{"Cellzilla2D`Private`Errera", "[", 
          RowBox[{
           RowBox[{"cvc", "[", 
            RowBox[{"[", "n", "]"}], "]"}], ",", "25"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"DivideCell", "[", 
          RowBox[{"q1", ",", "n", ",", 
           RowBox[{"{", 
            RowBox[{"p1", ",", "p2"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dPrint", "[", 
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"ShowTissue", "[", 
            RowBox[{"q1", ",", " ", 
             RowBox[{"\"\<CellNumbers\>\"", "\[Rule]", " ", "True"}]}], "]"}],
            ",", 
           RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "q1"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5779855681696663`*^9, 3.577985568170739*^9}, {
  3.577985635394888*^9, 3.5779856658241*^9}, {3.57798728569083*^9, 
  3.5779873083380747`*^9}, {3.57798740908535*^9, 3.5779874234269533`*^9}, {
  3.577987472539876*^9, 3.57798749086627*^9}, {3.577987677688875*^9, 
  3.577987679906678*^9}, {3.705712923676681*^9, 
  3.705712924939642*^9}},ExpressionUUID->"641ce843-828f-44ba-84c6-\
d506ac704796"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Networks", "Section",
 CellChangeTimes->{{3.452331917876368*^9, 
  3.452331919042946*^9}},ExpressionUUID->"6e9006e5-9e5c-4efc-8d67-\
7782681fee70"],

Cell[CellGroupData[{

Cell["CelleratorNetwork", "Subsection",
 CellChangeTimes->{{3.452379020107431*^9, 
  3.452379022288187*^9}},ExpressionUUID->"8f5be396-0935-41a8-9cc1-\
7e0bd534f431"],

Cell["\<\

2.2.8 change input format to [tissue, options]
2.1.a.20 add options \"Edge\",\"Area\", replace arguments \"Debug\" and \
\"Verbose\" with options.
2.1.a.15 change diffusing species element from {species, D} to either \
{species, D} or 
{species, D, function} in which case the permeability is D*function[i,j] \
where i and j are cell numbers.

2.1.\[Alpha].13 revise to use external functions EdgeBEtween and \
CellNeighbors
2.1.\[Alpha].11 revise to allow tissue or torus object

blah blah blah ...

intracellular = normal cellerator reactoin network for a single cell
diffusingSpecies = {{species, D}, {species, D}, ...} 
D's are Coefficients fo Penetrability in [length]/[time] units

v12: add preconditioning: convert to lowLevel first so that indexify will work\
\>", "Text",
 CellChangeTimes->{{3.452331921917706*^9, 3.452331924913558*^9}, {
  3.452358342262354*^9, 3.452358371840437*^9}, {3.453146216444384*^9, 
  3.453146241526321*^9}, {3.4531472510501137`*^9, 3.453147271443185*^9}, {
  3.457449813075713*^9, 3.457449825323773*^9}, {3.459269420128006*^9, 
  3.459269435831661*^9}, {3.459628362285417*^9, 3.4596284051484632`*^9}, {
  3.4889107905669403`*^9, 3.4889108193676662`*^9}, {3.5460189000058193`*^9, 
  3.546018924554942*^9}},ExpressionUUID->"3c6c1338-1826-446b-9c56-\
f0df708867f4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CelleratorNetwork", "[", 
     RowBox[{"inputTissue_", ",", " ", "\[IndentingNewLine]", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "\[IndentingNewLine]", "]"}], ":=",
     " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "r", ",", " ", "k", ",", " ", "n", ",", " ", "in", ",", " ", "out", 
        ",", "  ", "diff", ",", " ", "reactions", ",", " ", "i", ",", " ", 
        "j", ",", " ", "vPrint", ",", " ", "nInside", ",", " ", "nDiff", ",", 
        " ", "nTotal", ",", " ", "ok", ",", " ", "istissue", ",", " ", 
        "istorus", ",", " ", "c", ",", " ", "icc", ",", "  ", "tissue", ",", 
        " ", "intracellular", ",", " ", "dPrint", ",", " ", "edgeVariable", 
        ",", " ", "areaVariable", ",", " ", "debug", ",", " ", "verbose", ",",
         " ", "diffusingSpecies", ",", " ", "pumps", ",", " ", 
        "boundaryConditions", ",", "static", ",", "areas", ",", 
        "edgeLengths"}], "}"}], ",", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"debug", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<Debug\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<Debug\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"verbose", "=", 
        RowBox[{
         RowBox[{"\"\<Verbose\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<Verbose\>\"", "\[Rule]", " ", "True"}], "}"}]}]}], ";",
        " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"diffusingSpecies", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<Diffusion\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<Diffusion\>\"", "\[Rule]", " ", 
           RowBox[{"{", "}"}]}], "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"intracellular", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<Reactions\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<Reactions\>\"", "\[Rule]", " ", 
           RowBox[{"{", "}"}]}], "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"pumps", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<Pumps\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<Pumps\>\"", "\[Rule]", " ", 
           RowBox[{"{", "}"}]}], "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"pumps", "\[NotEqual]", " ", 
          RowBox[{"{", "}"}]}], ",", " ", 
         RowBox[{
         "Print", "[", 
          "\"\<Warning: \\\"Pumps\\\" Option is not yet implemented and will \
be ignored.\>\"", "]"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"boundaryConditions", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<BoundaryConditions\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<BoundaryConditions\>\"", "\[Rule]", " ", 
           RowBox[{"{", "}"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"boundaryConditions", "\[NotEqual]", " ", 
          RowBox[{"{", "}"}]}], ",", " ", 
         RowBox[{
         "Print", "[", 
          "\"\<Warning: \\\"BoundaryConditions\\\" Option is not yet \
implemented and will be ignored.\>\"", "]"}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"edgeVariable", "=", 
        RowBox[{
         RowBox[{"\"\<EdgeVariable\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<EdgeVariable\>\"", "\[Rule]", "None"}], "}"}]}]}], ";",
        " ", "\[IndentingNewLine]", 
       RowBox[{"areaVariable", "=", 
        RowBox[{
         RowBox[{"\"\<CellVariable\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<CellVariable\>\"", "\[Rule]", " ", "None"}], "}"}]}]}],
        ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"static", "=", 
        RowBox[{"Or", "[", 
         RowBox[{
          RowBox[{"edgeVariable", "===", "None"}], ",", 
          RowBox[{"areaVariable", "===", "None"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"edgeVariable", "=", 
        RowBox[{"edgeVariable", "/.", 
         RowBox[{"{", 
          RowBox[{"None", "\[Rule]", " ", "Global`edge"}], "}"}]}]}], ";", 
       " ", "\[IndentingNewLine]", 
       RowBox[{"areaVariable", "=", 
        RowBox[{"areaVariable", "/.", 
         RowBox[{"{", 
          RowBox[{"None", "\[Rule]", " ", "Global`area"}], "}"}]}]}], ";", 
       " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dPrint", "[", "x___", "]"}], ":=", " ", 
        RowBox[{"If", "[", 
         RowBox[{"debug", ",", " ", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<CelleratorNetwork: \>\"", ",", " ", "x"}], "]"}]}], 
         "]"}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"istissue", "=", 
        RowBox[{"TissueQ", "[", "inputTissue", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"istorus", "=", 
        RowBox[{"TorusQ", "[", "inputTissue", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"ok", "=", 
        RowBox[{"istissue", " ", "\[Or]", " ", "istorus"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", "ok"}], ",", " ", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<Error: Expecting CelleratorNetwork[tissue, options].\>\"", 
           "]"}], ";", " ", 
          RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"istissue", ",", " ", 
         RowBox[{"tissue", " ", "=", " ", "inputTissue"}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"istorus", ",", " ", 
         RowBox[{"tissue", " ", "=", " ", 
          RowBox[{"TorusTissue", "[", "inputTissue", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"c", "=", 
        RowBox[{"TissueCells", "[", "tissue", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{
        "\"\<Tissue: \>\"", ",", " ", "istissue", ",", " ", 
         "\"\< Torus: \>\"", ",", " ", "istorus"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"vPrint", "[", "x___", "]"}], ":=", " ", 
        RowBox[{"If", "[", 
         RowBox[{"verbose", ",", " ", 
          RowBox[{"Print", "[", "x", "]"}]}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"generate", " ", "intracellular", " ", "reactions"}], " ", 
        "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"r", "=", 
        RowBox[{"lowLevelReactions", "[", "intracellular", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<r (1): \>\"", ",", " ", "r"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"r", "=", 
        RowBox[{"indexify", "[", 
         RowBox[{"r", ",", " ", "i"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<r (2): \>\"", ",", " ", "r"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"n", "=", 
        RowBox[{"NTissueCells", "[", "tissue", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"vPrint", "[", 
        RowBox[{"n", ",", " ", "\"\< Cells.\>\""}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"vPrint", "[", 
        RowBox[{
         RowBox[{"Length", "[", "r", "]"}], ",", " ", 
         "\"\< internal reactions in each cell.\>\""}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"in", " ", "=", " ", 
        RowBox[{"Join", "@@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"r", "/.", 
            RowBox[{"{", 
             RowBox[{"i", "\[Rule]", " ", "k"}], "}"}]}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"k", ",", " ", "1", ",", " ", "n"}], "}"}]}], "]"}]}]}], 
       ";", " ", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<in: \>\"", ",", " ", "in"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"nInside", "=", 
        RowBox[{"Length", "[", "in", "]"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"vPrint", "[", 
        RowBox[{"nInside", ",", " ", "\"\< intracellular reactions.\>\""}], 
        "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"edgeLengths", " ", "=", " ", 
        RowBox[{"EdgeLengths", "[", "tissue", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"areas", " ", "=", " ", 
        RowBox[{"areafunction", "[", "tissue", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"generate", " ", "diffusion", " ", "reactions"}], " ", "*)"}],
        "\[IndentingNewLine]", 
       RowBox[{"diff", "=", 
        RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "diffusingSpecies", "]"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", "   ", 
             RowBox[{
             "diffusionReaction", ",", " ", "diffusionReactions", ",", 
              "allneighbors", ",", "  ", "neighbors", ",", " ", "edgeBetween",
               ",", " ", "l", ",", "   ", "beta", ",", " ", "Y", ",", " ", 
              "difSpec", ",", " ", "temp", ",", " ", "allEdgesBetween", ",", 
              " ", "diffData", ",", " ", "func", ",", " ", "One", ",", 
              "newEdge"}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"One", "[", 
               RowBox[{"p_", ",", "q_"}], "]"}], ":=", " ", "1"}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"allneighbors", " ", "=", " ", 
              RowBox[{"CellNeighbors", "[", "inputTissue", "]"}]}], ";", "  ",
              "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"neighbors", "[", "p_", "]"}], ":=", " ", 
              RowBox[{"allneighbors", "[", 
               RowBox[{"[", "p", "]"}], "]"}]}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"allEdgesBetween", "=", 
              RowBox[{"EdgesBetween", "[", "inputTissue", "]"}]}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"dPrint", "[", 
              RowBox[{"\"\<allEdgesBetween: \>\"", ",", " ", 
               RowBox[{"Short", "[", 
                RowBox[{"MatrixForm", "[", "allEdgesBetween", "]"}], "]"}]}], 
              "]"}], ";", " ", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"edgeBetween", "[", 
               RowBox[{"p_", ",", " ", "q_"}], "]"}], ":=", " ", 
              RowBox[{"allEdgesBetween", "[", 
               RowBox[{"[", 
                RowBox[{"p", ",", "q"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"l", "[", 
               RowBox[{"p_", ",", "q_"}], "]"}], ":=", " ", 
              RowBox[{
               RowBox[{"edgeVariable", "[", 
                RowBox[{"edgeBetween", "[", 
                 RowBox[{"p", ",", "q"}], "]"}], "]"}], "[", "Global`t", 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"diffusionReaction", "[", 
               RowBox[{"X_", ",", "func_", ",", "  ", 
                RowBox[{"{", 
                 RowBox[{"p_", ",", " ", "q_"}], "}"}]}], "]"}], ":=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"X", "[", "p", "]"}], "\[RightArrowLeftArrow]", 
                 "Global`\[EmptySet]"}], ",", " ", 
                FractionBox[
                 RowBox[{" ", 
                  RowBox[{
                   RowBox[{"l", "[", 
                    RowBox[{"p", ",", "q"}], "]"}], " ", 
                   RowBox[{"func", "[", 
                    RowBox[{"p", ",", "q"}], "]"}]}]}], 
                 RowBox[{
                  RowBox[{"areaVariable", "[", "p", "]"}], "[", "Global`t", 
                  "]"}]], ",", " ", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"l", "[", 
                    RowBox[{"p", ",", "q"}], "]"}], " ", 
                   RowBox[{"func", "[", 
                    RowBox[{"p", ",", "q"}], "]"}]}], 
                  RowBox[{
                   RowBox[{"areaVariable", "[", "p", "]"}], "[", "Global`t", 
                   "]"}]], 
                 RowBox[{
                  RowBox[{"X", "[", "q", "]"}], "[", "Global`t", "]"}]}]}], 
               "}"}]}], ";", "  ", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"diffusionReactions", "[", 
               RowBox[{"X_", ",", " ", "\[Beta]_", ",", " ", "p_"}], "]"}], ":=",
               " ", 
              RowBox[{"Table", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"diffusionReaction", "[", 
                 RowBox[{"X", ",", " ", "\[Beta]", ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"p", ",", " ", "inbr"}], "}"}]}], "]"}], ",", " ", 
                
                RowBox[{"{", 
                 RowBox[{"inbr", ",", " ", 
                  RowBox[{"neighbors", "[", "p", "]"}]}], "}"}]}], "]"}]}], 
             ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"difSpec", "=", "diffusingSpecies"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"While", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "difSpec", "]"}], ">", "0"}], ",", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"dPrint", "[", 
                 RowBox[{"\"\<difSpec: \>\"", ",", " ", "difSpec"}], "]"}], 
                ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"diffData", " ", "=", " ", 
                 RowBox[{"First", "[", "difSpec", "]"}]}], ";", " ", 
                "\[IndentingNewLine]", 
                RowBox[{"difSpec", "=", 
                 RowBox[{"Rest", "[", "difSpec", "]"}]}], ";", " ", 
                "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"diffData", " ", "=", " ", 
                 RowBox[{"Flatten", "[", 
                  RowBox[{"{", "diffData", "}"}], "]"}]}], ";", " ", 
                "\[IndentingNewLine]", 
                RowBox[{"Y", "=", 
                 RowBox[{"diffData", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", 
                "\[IndentingNewLine]", 
                RowBox[{"beta", " ", "=", " ", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", "diffData", "]"}], ">", "1"}], ",",
                    " ", 
                   RowBox[{"diffData", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", " ", "0"}], "]"}]}], 
                ";", " ", "\[IndentingNewLine]", 
                RowBox[{"func", "=", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"SameQ", "[", 
                    RowBox[{
                    RowBox[{"Head", "[", "beta", "]"}], ",", " ", 
                    "Function"}], "]"}], ",", "\[IndentingNewLine]", "beta", 
                   ",", " ", 
                   RowBox[{
                    RowBox[{"Evaluate", "[", "beta", "]"}], "&"}]}], "]"}]}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{
                 "This", " ", "allows", " ", "users", " ", "to", " ", "input",
                   " ", "edges", " ", "as", " ", 
                  RowBox[{"edge", "[", 
                   RowBox[{"p", ",", "q"}], "]"}], " ", "rather", " ", "than",
                   " ", "by", " ", "edge", " ", "number"}], " ", "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"newEdge", "[", "u___", "]"}], ":=", 
                 RowBox[{"edgeVariable", "[", 
                  RowBox[{"edgeBetween", "[", "u", "]"}], "]"}]}], ";", " ", 
                "\[IndentingNewLine]", 
                RowBox[{"func", "=", 
                 RowBox[{"func", "/.", 
                  RowBox[{"{", 
                   RowBox[{"edgeVariable", "\[Rule]", " ", "newEdge"}], 
                   "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
                RowBox[{"temp", " ", "=", " ", 
                 RowBox[{"Join", "@@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"diffusionReactions", "[", 
                    RowBox[{"Y", ",", " ", "func", ",", " ", "#"}], "]"}], 
                    "&"}], "/@", 
                    RowBox[{"Range", "[", "n", "]"}]}], ")"}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"diff", " ", "=", " ", 
                 RowBox[{"Join", "[", 
                  RowBox[{"diff", ",", " ", "temp"}], "]"}]}], ";"}]}], "  ", 
              "\[IndentingNewLine]", "]"}], ";"}]}], " ", 
           "\[IndentingNewLine]", "]"}], ";"}]}], " ", "\[IndentingNewLine]", 
        "]"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"nDiff", "=", 
        RowBox[{"Length", "[", "diff", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"vPrint", "[", 
        RowBox[{"nDiff", ",", " ", "\"\< diffusion reactions.\>\""}], "]"}], 
       ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "generate", " ", "intercellular", " ", "reactions", " ", "if", " ", 
         "spectified"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"out", "  ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"*", " ", "this", " ", "is", " ", "TBD"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"reactions", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"in", ",", " ", "diff", ",", " ", "out"}], "]"}]}], ";", " ",
        "\[IndentingNewLine]", 
       RowBox[{"nTotal", " ", "=", " ", 
        RowBox[{"Length", "[", "reactions", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"vPrint", "[", 
        RowBox[{"nTotal", ",", " ", "\"\< total reactions.\>\""}], "]"}], ";",
        " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"static", ",", "\[IndentingNewLine]", 
         RowBox[{"Block", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"NewEdgeVariable", ",", " ", "NewAreaVariable"}], "}"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"NewEdgeVariable", "[", "edgeNumber_", "]"}], "[", 
              "Global`t", "]"}], ":=", 
             RowBox[{"edgeLengths", "[", 
              RowBox[{"[", "edgeNumber", "]"}], "]"}]}], ";", " ", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"NewAreaVariable", "[", "cellNumber_", "]"}], "[", 
              "Global`t", "]"}], ":=", " ", 
             RowBox[{"areas", "[", 
              RowBox[{"[", "cellNumber", "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"reactions", " ", "=", " ", 
             RowBox[{"(", 
              RowBox[{"reactions", "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"edgeVariable", "\[Rule]", " ", "NewEdgeVariable"}], 
                 ",", " ", 
                 RowBox[{
                 "areaVariable", "\[Rule]", " ", "NewAreaVariable"}]}], 
                "}"}]}], ")"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
        "\[IndentingNewLine]", "]"}], ";", 
       RowBox[{"(*", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "reactions", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CelleratorNetwork", "[", "x___", "]"}], ":=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
     "Print", "[", 
      "\"\<Error: CelleratorNetwork: Expecting \
CelleratorNetwork[tissue,options]\>\"", "]"}], ";", " ", "$Failed"}], ")"}]}],
   ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4523459144734364`*^9, 3.452345982148876*^9}, {
   3.452346371377068*^9, 3.452346374765154*^9}, {3.452348166727393*^9, 
   3.452348213087953*^9}, {3.452348258463622*^9, 3.452348296202285*^9}, {
   3.452357781221957*^9, 3.4523579726880407`*^9}, {3.452358037726783*^9, 
   3.452358149059875*^9}, {3.452358242684704*^9, 3.452358300843514*^9}, {
   3.452368946698196*^9, 3.45236909427647*^9}, {3.4523691522254057`*^9, 
   3.452369231794591*^9}, {3.452369262583568*^9, 3.452369269536006*^9}, {
   3.452369308411192*^9, 3.4523693157176*^9}, {3.4523693945160303`*^9, 
   3.452369396418222*^9}, {3.452369495099268*^9, 3.452369543217561*^9}, {
   3.452369588221891*^9, 3.4523698278704576`*^9}, {3.452369860689233*^9, 
   3.452370183829829*^9}, {3.4523702644242697`*^9, 3.452370273083805*^9}, {
   3.4523703535624647`*^9, 3.452370354767625*^9}, {3.452370721864601*^9, 
   3.452370727056484*^9}, {3.453146196377862*^9, 3.453146214503001*^9}, {
   3.453146658742486*^9, 3.453146709045065*^9}, {3.4531467394694643`*^9, 
   3.4531468566654367`*^9}, {3.45314689458948*^9, 3.453147000803959*^9}, {
   3.456320937480831*^9, 3.456321020986824*^9}, {3.457392592813527*^9, 
   3.4573928532500353`*^9}, {3.457392919574462*^9, 3.4573929320490303`*^9}, {
   3.457448468431252*^9, 3.457448685999435*^9}, {3.457448722628071*^9, 
   3.457448883837146*^9}, {3.457449000609267*^9, 3.457449014340168*^9}, {
   3.457449045430073*^9, 3.4574491503467283`*^9}, {3.457449194098276*^9, 
   3.457449332733817*^9}, {3.457449412577029*^9, 3.457449424037527*^9}, {
   3.4574495452514133`*^9, 3.457449592506361*^9}, {3.4574496939440947`*^9, 
   3.457449756977157*^9}, {3.457449807208802*^9, 3.457449808152759*^9}, {
   3.457450204059246*^9, 3.457450212729357*^9}, {3.457450258710801*^9, 
   3.457450272758388*^9}, {3.457450303127076*^9, 3.457450315333391*^9}, {
   3.457450352323669*^9, 3.457450359294289*^9}, {3.459268958943465*^9, 
   3.459268964234233*^9}, {3.459269005286787*^9, 3.459269096174932*^9}, {
   3.459269153717429*^9, 3.459269158059066*^9}, {3.459269250185506*^9, 
   3.459269285769939*^9}, {3.459269325317486*^9, 3.4592693959214287`*^9}, {
   3.45927554905398*^9, 3.459275581865406*^9}, {3.459276969839507*^9, 
   3.459277021159071*^9}, {3.459602659297049*^9, 3.459602773983492*^9}, {
   3.459627515947363*^9, 3.459627604312594*^9}, {3.459627702159096*^9, 
   3.459627816751148*^9}, {3.459627999854693*^9, 3.459628058177841*^9}, {
   3.45962813502908*^9, 3.459628163088121*^9}, {3.460734734483452*^9, 
   3.460734766076045*^9}, {3.4889098518230143`*^9, 3.488909901846985*^9}, {
   3.4889099740999117`*^9, 3.488910123180828*^9}, {3.48891015936203*^9, 
   3.4889101661628017`*^9}, {3.48891020178483*^9, 3.488910241184708*^9}, {
   3.488910272206568*^9, 3.48891046922773*^9}, {3.488910526085519*^9, 
   3.4889105973926487`*^9}, {3.48891066128658*^9, 3.4889106977188187`*^9}, {
   3.5444642335956964`*^9, 3.5444642520349293`*^9}, {3.5460061392400303`*^9, 
   3.546006220630413*^9}, {3.5460062661110477`*^9, 3.546006416100542*^9}, {
   3.546006487067898*^9, 3.5460067213060503`*^9}, {3.546006885547779*^9, 
   3.546007015982112*^9}, {3.5460070605455313`*^9, 3.546007070168429*^9}, {
   3.546007108696949*^9, 3.54600711476648*^9}, {3.54600732480931*^9, 
   3.5460073300970163`*^9}, {3.546007383462226*^9, 3.54600748671626*^9}, {
   3.5460075176752167`*^9, 3.546007578602502*^9}, {3.546007612546597*^9, 
   3.546007614751577*^9}, {3.546007788126679*^9, 3.546007791044003*^9}, {
   3.546008083989245*^9, 3.546008140004424*^9}, {3.546008577318976*^9, 
   3.546008606445889*^9}, {3.546008852783654*^9, 3.546009063201763*^9}, {
   3.546009121662343*^9, 3.5460091242043743`*^9}, {3.546009168235643*^9, 
   3.5460091760695877`*^9}, 3.54600921862348*^9, {3.546018949039723*^9, 
   3.546018967186693*^9}, {3.547061719166113*^9, 3.5470617368195667`*^9}, {
   3.547061768423688*^9, 3.547061773335404*^9}, {3.548443142854327*^9, 
   3.548443144392865*^9}, {3.561413018607869*^9, 3.561413023444148*^9}, {
   3.561413094479269*^9, 3.561413095621853*^9}, {3.574083419098069*^9, 
   3.574083437142815*^9}, {3.574083489448358*^9, 3.574083494131565*^9}, {
   3.7057129319376698`*^9, 
   3.7057129332410517`*^9}},ExpressionUUID->"3a5a47c5-b027-47bd-8fbf-\
7af2708a7df3"]
}, Closed]],

Cell[CellGroupData[{

Cell["UnwalledNetwork", "Subsection",
 CellChangeTimes->{{3.5484423914557953`*^9, 
  3.548442417847312*^9}},ExpressionUUID->"f94efeb1-f007-4828-9ae3-\
01f6da168740"],

Cell[CellGroupData[{

Cell["UnwalledNetwork", "Subsubsection",
 CellChangeTimes->{{3.5747086129278708`*^9, 
  3.574708618448065*^9}},ExpressionUUID->"6448b6d5-50d0-4add-8f65-\
ed0e8ed86ea5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UnwalledNetwork", "[", 
     RowBox[{
      RowBox[{"tissue_", "?", "DTissueQ"}], ",", " ", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "\[IndentingNewLine]", "]"}], ":=",
     " ", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "r", ",", "k", ",", "n", ",", "ne", ",", " ", "in", ",", "out", ",", 
        "diff", ",", "reactions", ",", "i", ",", "j", ",", "vPrint", ",", 
        "nInside", ",", "nDiff", ",", "nTotal", ",", "ok", ",", "istissue", 
        ",", "istorus", ",", "c", ",", "icc", ",", "dPrint", ",", 
        "edgeVariable", ",", "areaVariable", ",", "debug", ",", "wall", ",", 
        " ", "verbose", ",", "e", ",", "v", ",", "  ", "static", ",", " ", 
        "wallreactions", ",", "nwall", ",", " ", "Depth", ",", 
        "requestedDynamic", ",", "\[IndentingNewLine]", "areas", ",", 
        "edgeLengths", ",", " ", "boundaryConditions", ",", "allEdgesBetween",
         ",", " ", "neighbors", ",", " ", "allneighbors", ",", "outeredges", 
        ",", " ", "outercells", ",", "One", ",", "ZERO", ",", "subnet", ",", 
        "\[IndentingNewLine]", "pumps", ",", "pr", ",", "diffusingSpecies", 
        ",", " ", "intracellular", ",", "getTransferFunction", ",", " ", 
        "growing", ",", "GR", ",", "GE", ",", "nv", ",", "growthstuff", ",", 
        "AEQ", ",", "equations", ",", "x", ",", "y", ",", "cvn", ",", "eused",
         ",", "vused", ",", " ", "inputTissue", ",", "cellEdgeIndices", ",", 
        "cellNumbers", ",", "boundaryConditionSet", ",", " ", 
        "INTERCELLULARReactions", ",", " ", "TE", ",", " ", 
        RowBox[{"dbgPumps", "=", "False"}], ",", " ", "xy"}], 
       "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"debug", "=", 
        RowBox[{
         RowBox[{"\"\<NDebug\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<NDebug\>\"", "\[Rule]", "False"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dPrint", "[", "x___", "]"}], ":=", 
        RowBox[{"If", "[", 
         RowBox[{"debug", ",", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<UnwalledNetwork: \>\"", ",", "x"}], "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<NDebug: \>\"", ",", " ", "debug"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"One", "[", 
         RowBox[{"p_", ",", "q_", ",", "r_"}], "]"}], ":=", "1"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ZERO", "[", 
         RowBox[{"p_", ",", "q_", ",", " ", "r_"}], "]"}], ":=", " ", "0"}], 
       ";", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"getTransferFunction", "[", "stuff_", "]"}], ":=", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{
            RowBox[{"Head", "[", "stuff", "]"}], ",", " ", "Function"}], 
           "]"}], ",", "stuff", ",", 
          RowBox[{
           RowBox[{"Evaluate", "[", "stuff", "]"}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"verbose", "=", 
        RowBox[{
         RowBox[{"\"\<Verbose\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<Verbose\>\"", "\[Rule]", "True"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"edgeVariable", "=", 
        RowBox[{
         RowBox[{"\"\<EdgeVariable\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<EdgeVariable\>\"", "\[Rule]", "None"}], "}"}]}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"areaVariable", "=", 
        RowBox[{
         RowBox[{"\"\<CellVariable\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<CellVariable\>\"", "\[Rule]", "None"}], "}"}]}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"xy", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<xy\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<xy\>\"", "\[Rule]", " ", "True"}], "}"}]}]}], ";", " ",
        "\[IndentingNewLine]", 
       RowBox[{"x", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<x\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<x\>\"", "\[Rule]", " ", "Global`x"}], "}"}]}]}], ";", 
       " ", "\[IndentingNewLine]", 
       RowBox[{"y", "=", 
        RowBox[{
         RowBox[{"\"\<y\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<y\>\"", "\[Rule]", " ", "Global`y"}], "}"}]}]}], ";", 
       " ", "\[IndentingNewLine]", 
       RowBox[{"pumps", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<Pumps\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<Pumps\>\"", "\[Rule]", " ", 
           RowBox[{"{", "}"}]}], "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"diffusingSpecies", "=", 
        RowBox[{
         RowBox[{"\"\<Diffusion\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<Diffusion\>\"", "\[Rule]", " ", 
           RowBox[{"{", "}"}]}], "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"intracellular", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<Reactions\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<Reactions\>\"", "\[Rule]", " ", 
           RowBox[{"{", "}"}]}], "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"INTERCELLULARReactions", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<Intercellular\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<Intercellular\>\"", "\[Rule]", " ", 
           RowBox[{"{", "}"}]}], "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"growing", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<Growing\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<Growing\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], 
       ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Depth", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<CellDepth\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<CellDepth\>\"", "\[Rule]", " ", "Global`CellDepth"}], 
          "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"boundaryConditions", "=", 
        RowBox[{"getBC", "[", "opt", "]"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"boundaryConditionSet", "=", 
        RowBox[{
         RowBox[{"\"\<BoundaryConditionSet\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<BoundaryConditionSet\>\"", "->", " ", "False"}], 
          "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "boundaryConditions", "]"}], ">", "0"}], ",",
          " ", 
         RowBox[{"boundaryConditionSet", "=", "True"}]}], "]"}], ";", "  ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "force", " ", "use", " ", "of", " ", "dynamic", " ", "variable", " ",
           "names"}], ";", " ", 
         RowBox[{
         "replace", " ", "with", " ", "static", " ", "values", " ", "at", " ",
           "end", " ", "if", " ", "needed"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"static", "=", 
        RowBox[{"Or", "[", 
         RowBox[{
          RowBox[{"edgeVariable", "===", "None"}], ",", 
          RowBox[{"areaVariable", "===", "None"}], ",", " ", 
          RowBox[{"growing", "\[Equal]", "False"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{"growing", ",", " ", 
           RowBox[{"static", "=", "False"}]}], "]"}], ";"}], "  ", "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"edgeVariable", "=", 
        RowBox[{"edgeVariable", "/.", 
         RowBox[{"{", 
          RowBox[{"None", "\[Rule]", " ", 
           RowBox[{"Symbol", "[", "\"\<Global`edge\>\"", "]"}]}], "}"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"areaVariable", "=", 
        RowBox[{"areaVariable", "/.", 
         RowBox[{"{", 
          RowBox[{"None", "\[Rule]", " ", 
           RowBox[{"Symbol", "[", "\"\<Global`cell\>\"", "]"}]}], "}"}]}]}], 
       ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"c", "=", 
        RowBox[{"TissueCells", "[", "tissue", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<c=\>\"", ",", " ", "c"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"cellNumbers", "=", 
        RowBox[{"First", "/@", "c"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"cellEdgeIndices", " ", "=", " ", 
        RowBox[{"Last", "/@", "c"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"e", "=", 
        RowBox[{"TissueEdges", "[", "tissue", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ne", " ", "=", " ", 
        RowBox[{"Length", "[", "e", "]"}]}], ";", " ", "\[IndentingNewLine]", 
       
       RowBox[{"v", "=", 
        RowBox[{"TissueVertices", "[", "tissue", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"nv", "=", 
        RowBox[{"Length", "[", "v", "]"}]}], ";", " ", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"vPrint", "[", "x___", "]"}], ":=", 
        RowBox[{"If", "[", 
         RowBox[{"verbose", ",", 
          RowBox[{"Print", "[", "x", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{
        "\"\<e=\>\"", ",", " ", "e", ",", "\"\< ne=\>\"", ",", " ", "ne"}], 
        "]"}], ";", "  ", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{
        "\"\<v=\>\"", ",", " ", "v", ",", " ", "\"\< nv=\>\"", ",", " ", 
         "nv"}], "]"}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"generate", " ", "intracellular", " ", "reactions"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<intracellular: \>\"", ",", " ", "intracellular"}], "]"}],
        ";", " ", "\[IndentingNewLine]", 
       RowBox[{"r", "=", 
        RowBox[{"lowLevelReactions", "[", "intracellular", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<r:\>\"", ",", " ", "r"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"subnet", "[", "i_", "]"}], ":=", 
        RowBox[{"indexify", "[", 
         RowBox[{"r", ",", "i", ",", " ", "opt"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<subnet[i] = \>\"", ",", " ", 
         RowBox[{"subnet", "[", "i", "]"}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "c", "]"}]}], ";", " ", "\[IndentingNewLine]", 
       
       RowBox[{"vPrint", "[", 
        RowBox[{"n", ",", "\"\< Cells.\>\""}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"vPrint", "[", 
        RowBox[{
         RowBox[{"Length", "[", "r", "]"}], ",", 
         "\"\< internal reactions in each cell.\>\""}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"in", "=", 
          RowBox[{"Join", "@@", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"r", "/.", 
              RowBox[{"{", 
               RowBox[{"i", "\[Rule]", "k"}], "}"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}]}]}], ";"}], 
        "*)"}], " ", "\[IndentingNewLine]", 
       RowBox[{"in", " ", "=", " ", 
        RowBox[{"Join", "@@", 
         RowBox[{"(", 
          RowBox[{"subnet", "/@", "cellNumbers"}], ")"}]}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"nInside", "=", 
        RowBox[{"Length", "[", "in", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"vPrint", "[", 
        RowBox[{"nInside", ",", "\"\< total intracellular reactions.\>\""}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<in = \>\"", ",", " ", "in"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"inputTissue", "=", 
        RowBox[{"DTissue2Tissue", "[", "tissue", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"edgeLengths", "=", 
        RowBox[{"EdgeLengths", "[", "inputTissue", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<edgeLengths:\>\"", ",", " ", "edgeLengths"}], "]"}], ";",
        " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "The", " ", "following", " ", "use", " ", "the", " ", "static", " ", 
         "cell", " ", "number"}], " ", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"areas", "=", 
        RowBox[{"areafunction", "[", "inputTissue", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"allEdgesBetween", "=", 
        RowBox[{"EdgesBetween", "[", "inputTissue", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"allneighbors", "=", 
        RowBox[{"CellNeighbors", "[", "inputTissue", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"neighbors", "[", "p_", "]"}], ":=", 
        RowBox[{"allneighbors", "[", 
         RowBox[{"[", "p", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<allNeighbors: \>\"", ",", "allneighbors"}], "]"}], ";", 
       " ", "\[IndentingNewLine]", 
       RowBox[{"outeredges", " ", "=", " ", 
        RowBox[{"EdgesOnBoundary", "[", "inputTissue", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"outercells", " ", "=", " ", 
        RowBox[{"CellsOnBoundary", "[", "inputTissue", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<allEdgesBetween: \>\"", ",", 
         RowBox[{"MatrixForm", "[", "allEdgesBetween", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<outeredges = \>\"", ",", " ", "outeredges"}], "]"}], ";",
        " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "generate", " ", "concentration", " ", "dependent", " ", "pump", " ", 
         "reactions"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       
       RowBox[{"pr", " ", "=", " ", 
        RowBox[{"generatePumpReactions", "[", 
         RowBox[{
         "c", ",", "  ", "pumps", ",", " ", "allEdgesBetween", ",", " ", 
          "allneighbors", ",", "outercells", ",", " ", "outeredges", ",", " ",
           "\[IndentingNewLine]", "edgeVariable", ",", " ", "areaVariable", 
          ",", "  ", 
          RowBox[{"\"\<Debug\>\"", "\[Rule]", " ", "dbgPumps"}]}], "]"}]}], 
       ";", " ", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"dbgPumps", ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<pr = \>\"", ",", " ", "pr"}], "]"}]}], "]"}], ";", " ",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"vPrint", "[", 
        RowBox[{
         RowBox[{"Length", "[", "pr", "]"}], ",", 
         "\"\< transport reactions.\>\""}], "]"}], ";", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"generate", " ", "diffusion", " ", "reactions"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"vused", "=", 
        RowBox[{"VerticesUsed", "[", "inputTissue", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"eused", "=", 
        RowBox[{"EdgesUsed", "[", "inputTissue", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"diff", " ", "=", " ", 
        RowBox[{"generateDiffusionReactions", "[", 
         RowBox[{
         "c", ",", " ", "e", ",", " ", "eused", ",", "diffusingSpecies", ",", 
          " ", "allEdgesBetween", ",", " ", "allneighbors", ",", " ", 
          "outercells", ",", "  ", "outeredges", ",", " ", "edgeVariable", 
          ",", " ", "areaVariable", ",", " ", "x", ",", " ", "y", ",", " ", 
          "edgeLengths", ",", "  ", "boundaryConditionSet", ",", 
          "\[IndentingNewLine]", "debug"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"nDiff", "=", 
        RowBox[{"Length", "[", "diff", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"nDiff", ",", "\"\< diffusion reactions.\>\""}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "generate", " ", "intercellular", " ", "reactions", " ", "if", " ", 
         "specified"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"out", " ", "=", " ", 
        RowBox[{"generateIntercellularReactions", "[", 
         RowBox[{
         "c", ",", " ", "INTERCELLULARReactions", ",", " ", "allneighbors", 
          ",", " ", "outercells", ",", "  ", "outeredges", ",", "  ", 
          "areaVariable", ",", " ", "x", ",", " ", "y", ",", "  ", 
          "boundaryConditionSet", ",", "\[IndentingNewLine]", "debug"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<out: \>\"", ",", " ", "out"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"reactions", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"in", ",", "diff", ",", " ", "pr", ",", " ", "out"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<reactions: \>\"", ",", " ", "reactions"}], "]"}], ";", 
       " ", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<static: \>\"", ",", " ", "static"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "If", " ", "static", " ", "tissue", " ", "is", " ", "requested"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "replace", " ", "variable", " ", "names", " ", "with", " ", "static", 
         " ", "values"}], " ", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"static", ",", "\[IndentingNewLine]", 
         RowBox[{"Block", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "NewEdgeVariable", ",", " ", "NewAreaVariable", ",", 
             "NewVertexVariable", ",", " ", "newx", ",", " ", "newy", ",", 
             " ", "temp"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"NewEdgeVariable", "[", "edgeNumber_", "]"}], "[", 
              "Global`t", "]"}], ":=", 
             RowBox[{"edgeLengths", "[", 
              RowBox[{"[", "edgeNumber", "]"}], "]"}]}], ";", " ", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"NewAreaVariable", "[", "cellNumber_", "]"}], "[", 
              "Global`t", "]"}], ":=", " ", 
             RowBox[{"areas", "[", 
              RowBox[{"[", "cellNumber", "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"NewAreaVariable", "[", "cellNumber_", "]"}], "'"}], 
              "[", "Global`t", "]"}], ":=", " ", "0"}], ";", " ", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"newx", "[", "i_", "]"}], "[", "Global`t", "]"}], ":=", 
             " ", 
             RowBox[{"v", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"newy", "[", "i_", "]"}], "[", "Global`t", "]"}], ":=", 
             " ", 
             RowBox[{"v", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"reactions", " ", "=", " ", 
             RowBox[{"(", 
              RowBox[{"reactions", "/.", 
               RowBox[{"{", " ", 
                RowBox[{
                 RowBox[{"edgeVariable", "\[Rule]", " ", "NewEdgeVariable"}], 
                 ",", " ", 
                 RowBox[{"areaVariable", "\[Rule]", " ", "NewAreaVariable"}], 
                 ",", " ", 
                 RowBox[{"x", "\[Rule]", " ", "newx"}], ",", " ", 
                 RowBox[{"y", "\[Rule]", " ", "newy"}]}], "}"}]}], ")"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"AEQ", "=", 
             RowBox[{"{", "}"}]}], ";"}]}], " ", "\[IndentingNewLine]", "]"}],
          ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"AEQ", "=", 
           RowBox[{"CellAreaEquations", "[", 
            RowBox[{"tissue", ",", 
             RowBox[{"\"\<debug\>\"", "\[Rule]", " ", "debug"}], ",", " ", 
             "opt"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{
            RowBox[{"Length", "[", "AEQ", "]"}], ",", " ", 
            "\"\< equations for cell area.\>\""}], "]"}], ";"}]}], " ", 
        "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"cvn", " ", "=", " ", 
        RowBox[{"CellVertexNumbers", "[", "tissue", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{
        "\"\<boundaryConditions: \>\"", ",", " ", "boundaryConditions"}], 
        "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"static", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"GR", "=", 
           RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"TE", "=", 
           RowBox[{"generateSpecialVariables", "[", 
            RowBox[{"inputTissue", ",", " ", "opt"}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<TE=\>\"", ",", " ", "TE"}], "]"}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"GE", "=", 
           RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"xy", ",", " ", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"GE", "=", 
              RowBox[{"Flatten", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"x", "[", "#", "]"}], "[", "Global`t", "]"}], 
                    "\[Equal]", " ", 
                    RowBox[{"v", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", "1"}], "]"}], "]"}]}], ",", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"y", "[", "#", "]"}], "[", "Global`t", "]"}], 
                    "\[Equal]", 
                    RowBox[{"v", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", "2"}], "]"}], "]"}]}]}], "}"}], "&"}], "/@",
                 "vused"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
          ";", " ", "\[IndentingNewLine]", 
          RowBox[{"AEQ", "=", 
           RowBox[{"CellAreaEquations", "[", 
            RowBox[{"tissue", ",", "opt"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"GE", " ", "=", " ", 
           RowBox[{"Join", "[", 
            RowBox[{"TE", ",", " ", "GE"}], "]"}]}], ";"}], " ", 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"growthstuff", "=", 
           RowBox[{"generateGrowthReactions", "[", 
            RowBox[{
            "c", ",", "cvn", ",", " ", "e", ",", "v", ",", " ", "eused", ",", 
             " ", "vused", ",", " ", "edgeVariable", ",", " ", "outeredges", 
             ",", "  ", "opt"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"GR", "=", 
           RowBox[{"\"\<reactions\>\"", "/.", "growthstuff"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"GE", "=", 
           RowBox[{"\"\<equations\>\"", "/.", "growthstuff"}]}], ";"}]}], " ",
         "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<GR: \>\"", ",", " ", 
         RowBox[{"GR", "//", "Short"}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<GE: \>\"", ",", " ", 
         RowBox[{"GE", "//", "Short"}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"vPrint", "[", 
        RowBox[{
         RowBox[{"Length", "[", "GE", "]"}], ",", 
         "\"\< algebraic equations for spring growth.\>\""}], "]"}], ";", " ",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"reactions", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{"reactions", ",", " ", "GR"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"reactions", " ", "=", " ", 
        RowBox[{"reactions", " ", "/.", "boundaryConditions"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"nTotal", "=", 
        RowBox[{"Length", "[", "reactions", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"vPrint", "[", 
        RowBox[{"nTotal", ",", "\"\< total reactions.\>\""}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"equations", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{"GE", ",", " ", "AEQ"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"equations", " ", "=", " ", 
        RowBox[{"equations", "/.", "boundaryConditions"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"reactions", " ", "=", " ", 
        RowBox[{"reactions", "/.", "boundaryConditions"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<equations: \>\"", ",", " ", "equations"}], "]"}], ";", 
       " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"reactions", ",", " ", "equations"}], "}"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UnwalledNetwork", "[", "x___", "]"}], ":=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
     "Print", "[", 
      "\"\<Error: UnwalledNetwork: Expecting UnwalledNetwork[DTissue,options]\
\>\"", "]"}], ";", " ", "$Failed"}], ")"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4523459144734364`*^9, 3.452345982148876*^9}, {
   3.452346371377068*^9, 3.452346374765154*^9}, {3.452348166727393*^9, 
   3.452348213087953*^9}, {3.452348258463622*^9, 3.452348296202285*^9}, {
   3.452357781221957*^9, 3.4523579726880407`*^9}, {3.452358037726783*^9, 
   3.452358149059875*^9}, {3.452358242684704*^9, 3.452358300843514*^9}, {
   3.452368946698196*^9, 3.45236909427647*^9}, {3.4523691522254057`*^9, 
   3.452369231794591*^9}, {3.452369262583568*^9, 3.452369269536006*^9}, {
   3.452369308411192*^9, 3.4523693157176*^9}, {3.4523693945160303`*^9, 
   3.452369396418222*^9}, {3.452369495099268*^9, 3.452369543217561*^9}, {
   3.452369588221891*^9, 3.4523698278704576`*^9}, {3.452369860689233*^9, 
   3.452370183829829*^9}, {3.4523702644242697`*^9, 3.452370273083805*^9}, {
   3.4523703535624647`*^9, 3.452370354767625*^9}, {3.452370721864601*^9, 
   3.452370727056484*^9}, {3.453146196377862*^9, 3.453146214503001*^9}, {
   3.453146658742486*^9, 3.453146709045065*^9}, {3.4531467394694643`*^9, 
   3.4531468566654367`*^9}, {3.45314689458948*^9, 3.453147000803959*^9}, {
   3.456320937480831*^9, 3.456321020986824*^9}, {3.457392592813527*^9, 
   3.4573928532500353`*^9}, {3.457392919574462*^9, 3.4573929320490303`*^9}, {
   3.457448468431252*^9, 3.457448685999435*^9}, {3.457448722628071*^9, 
   3.457448883837146*^9}, {3.457449000609267*^9, 3.457449014340168*^9}, {
   3.457449045430073*^9, 3.4574491503467283`*^9}, {3.457449194098276*^9, 
   3.457449332733817*^9}, {3.457449412577029*^9, 3.457449424037527*^9}, {
   3.4574495452514133`*^9, 3.457449592506361*^9}, {3.4574496939440947`*^9, 
   3.457449756977157*^9}, {3.457449807208802*^9, 3.457449808152759*^9}, {
   3.457450204059246*^9, 3.457450212729357*^9}, {3.457450258710801*^9, 
   3.457450272758388*^9}, {3.457450303127076*^9, 3.457450315333391*^9}, {
   3.457450352323669*^9, 3.457450359294289*^9}, {3.459268958943465*^9, 
   3.459268964234233*^9}, {3.459269005286787*^9, 3.459269096174932*^9}, {
   3.459269153717429*^9, 3.459269158059066*^9}, {3.459269250185506*^9, 
   3.459269285769939*^9}, {3.459269325317486*^9, 3.4592693959214287`*^9}, {
   3.45927554905398*^9, 3.459275581865406*^9}, {3.459276969839507*^9, 
   3.459277021159071*^9}, {3.459602659297049*^9, 3.459602773983492*^9}, {
   3.459627515947363*^9, 3.459627604312594*^9}, {3.459627702159096*^9, 
   3.459627816751148*^9}, {3.459627999854693*^9, 3.459628058177841*^9}, {
   3.45962813502908*^9, 3.459628163088121*^9}, {3.460734734483452*^9, 
   3.460734766076045*^9}, {3.4889098518230143`*^9, 3.488909901846985*^9}, {
   3.4889099740999117`*^9, 3.488910123180828*^9}, {3.48891015936203*^9, 
   3.4889101661628017`*^9}, {3.48891020178483*^9, 3.488910241184708*^9}, {
   3.488910272206568*^9, 3.48891046922773*^9}, {3.488910526085519*^9, 
   3.4889105973926487`*^9}, {3.48891066128658*^9, 3.4889106977188187`*^9}, {
   3.5444642335956964`*^9, 3.5444642520349293`*^9}, {3.5460061392400303`*^9, 
   3.546006220630413*^9}, {3.5460062661110477`*^9, 3.546006416100542*^9}, {
   3.546006487067898*^9, 3.5460067213060503`*^9}, {3.546006885547779*^9, 
   3.546007015982112*^9}, {3.5460070605455313`*^9, 3.546007070168429*^9}, {
   3.546007108696949*^9, 3.54600711476648*^9}, {3.54600732480931*^9, 
   3.5460073300970163`*^9}, {3.546007383462226*^9, 3.54600748671626*^9}, {
   3.5460075176752167`*^9, 3.546007578602502*^9}, {3.546007612546597*^9, 
   3.546007614751577*^9}, {3.546007788126679*^9, 3.546007791044003*^9}, {
   3.546008083989245*^9, 3.546008140004424*^9}, {3.546008577318976*^9, 
   3.546008606445889*^9}, {3.546008852783654*^9, 3.546009063201763*^9}, {
   3.546009121662343*^9, 3.5460091242043743`*^9}, {3.546009168235643*^9, 
   3.5460091760695877`*^9}, 3.54600921862348*^9, {3.546018949039723*^9, 
   3.546018967186693*^9}, {3.547061719166113*^9, 3.5470617368195667`*^9}, {
   3.547061768423688*^9, 3.547061773335404*^9}, {3.548442398348865*^9, 
   3.54844246087166*^9}, {3.5484430969985027`*^9, 3.5484431000906477`*^9}, {
   3.548443162791121*^9, 3.548443244485083*^9}, 3.54844335770755*^9, {
   3.548443388006485*^9, 3.5484434659677258`*^9}, {3.5484434980874233`*^9, 
   3.5484435171398706`*^9}, {3.548443552847781*^9, 3.5484435531738453`*^9}, {
   3.548443798828526*^9, 3.5484437999591*^9}, {3.5484441702709827`*^9, 
   3.548444180647131*^9}, 3.548445209583516*^9, {3.5484466440776043`*^9, 
   3.548446647479815*^9}, {3.548446723238145*^9, 3.5484467985938253`*^9}, {
   3.571318075421546*^9, 3.571318097975779*^9}, {3.571318152779236*^9, 
   3.571318163424371*^9}, {3.5713182411501293`*^9, 3.571318280287909*^9}, {
   3.571318533058311*^9, 3.571318546997242*^9}, {3.572011607675234*^9, 
   3.572011669147974*^9}, {3.57201170421062*^9, 3.572011782828513*^9}, {
   3.572011897223496*^9, 3.5720119654748983`*^9}, {3.572012014002077*^9, 
   3.572012014627801*^9}, {3.572014553486587*^9, 3.572014575706053*^9}, {
   3.5720146182483*^9, 3.5720146273730183`*^9}, {3.572016071678351*^9, 
   3.572016103551944*^9}, {3.572016153597159*^9, 3.57201619192654*^9}, {
   3.572134490978223*^9, 3.5721345050740147`*^9}, {3.572134579114092*^9, 
   3.57213460794454*^9}, {3.572134645377699*^9, 3.572134658061232*^9}, {
   3.572134688548993*^9, 3.572134721150897*^9}, 3.5723731717492*^9, {
   3.574085626790202*^9, 3.574085627645219*^9}, {3.574706647339636*^9, 
   3.57470667459685*^9}, {3.574706767037681*^9, 3.574706790000689*^9}, {
   3.574706884877829*^9, 3.5747068975407953`*^9}, {3.5747069732335653`*^9, 
   3.574706984943739*^9}, {3.574707049416997*^9, 3.574707051588923*^9}, {
   3.574708269920741*^9, 3.574708340145918*^9}, {3.574708389684767*^9, 
   3.574708409946658*^9}, {3.5747088313050613`*^9, 3.574708840129141*^9}, {
   3.574810055937352*^9, 3.574810068546822*^9}, {3.574810107957828*^9, 
   3.574810131519252*^9}, {3.5748101654217854`*^9, 3.574810192178275*^9}, {
   3.5748107429324627`*^9, 3.574810743356464*^9}, {3.574811272775585*^9, 
   3.574811304015814*^9}, {3.574811880997635*^9, 3.574811882156507*^9}, 
   3.575231799879047*^9, {3.57523469888396*^9, 3.575234700336467*^9}, {
   3.57530624028122*^9, 3.575306318218156*^9}, {3.575307955527733*^9, 
   3.575307956122384*^9}, {3.575308078574318*^9, 3.575308079098262*^9}, {
   3.5753081246412354`*^9, 3.575308125268942*^9}, {3.575308670882077*^9, 
   3.575308676231048*^9}, {3.575390299083076*^9, 3.575390318129884*^9}, {
   3.575390367257882*^9, 3.575390387574812*^9}, {3.5753904793317823`*^9, 
   3.5753904808168907`*^9}, {3.5753905395951853`*^9, 3.575390560037469*^9}, {
   3.57539059196244*^9, 3.575390597190831*^9}, {3.5755701909659348`*^9, 
   3.575570198410985*^9}, {3.575570244892626*^9, 3.5755702470506363`*^9}, {
   3.5760065667047663`*^9, 3.576006576101594*^9}, {3.5760066619524803`*^9, 
   3.57600668134418*^9}, {3.576006808115734*^9, 3.5760068196380253`*^9}, {
   3.576006909570847*^9, 3.576007082406403*^9}, {3.576007154224196*^9, 
   3.576007157899644*^9}, {3.576014362616744*^9, 3.576014394776826*^9}, {
   3.576265468091704*^9, 3.57626550717179*^9}, {3.576265537548058*^9, 
   3.576265541254188*^9}, {3.5762659305488358`*^9, 3.576265970071575*^9}, {
   3.576266063866378*^9, 3.576266080555505*^9}, {3.5762661576727343`*^9, 
   3.5762661585102873`*^9}, {3.5762662145280037`*^9, 3.576266232552223*^9}, 
   3.576794077241831*^9, {3.57679413709228*^9, 3.5767941507714167`*^9}, {
   3.576795202304957*^9, 3.576795203618185*^9}, {3.578354005526606*^9, 
   3.578354008461906*^9}, {3.5783542528419533`*^9, 3.578354292462834*^9}, {
   3.578354376877644*^9, 3.578354410501317*^9}, {3.578354531071314*^9, 
   3.578354590439556*^9}, {3.578354624001383*^9, 3.57835464211784*^9}, {
   3.578354761262236*^9, 3.5783548682189703`*^9}, {3.5783549868250093`*^9, 
   3.578355020852766*^9}, {3.578355052664139*^9, 3.578355097777567*^9}, {
   3.70571293899657*^9, 3.705712940193179*^9}, {3.705948010667049*^9, 
   3.705948022123767*^9}, {3.705963412649971*^9, 3.705963427490346*^9}, {
   3.705963759955886*^9, 3.7059637843728323`*^9}, {3.7059638531325006`*^9, 
   3.70596387696391*^9}, 3.705963934852797*^9, {3.705964221397142*^9, 
   3.705964227861773*^9}},ExpressionUUID->"82e80db0-33cc-4fed-a75f-\
eddb3dec6624"]
}, Closed]],

Cell[CellGroupData[{

Cell["generateIntercellularReactions", "Subsubsection",
 CellChangeTimes->{{3.5747086268556643`*^9, 
  3.5747086317818747`*^9}},ExpressionUUID->"39f5e3f5-f79d-42a1-9872-\
a5b6293698fa"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"generateIntercellularReactions", "[", 
    RowBox[{
    "c_", ",", " ", "intercellular_", ",", " ", "allneighbors_", ",", " ", 
     "outercells_", ",", "  ", "outeredges_", ",", "  ", "areaVariable_", ",",
      " ", "x_", ",", " ", "y_", ",", "  ", "boundaryConditionSet_", ",", 
     "debug_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"dPrint", ",", " ", "HandleReaction", ",", " ", "grn"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"dPrint", "[", "u___", "]"}], ":=", " ", 
       RowBox[{"If", "[", 
        RowBox[{"debug", ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<generateIntercellularReactions: \>\"", ",", " ", "u"}],
           "]"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<intercellular: \>\"", ",", " ", "intercellular"}], "]"}], 
      ";", " ", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<allneighbors: \>\"", ",", " ", "allneighbors"}], "]"}], 
      ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"HandleReaction", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"RightTeeArrow", "[", 
           RowBox[{"inputVar_", ",", " ", "outputVar_"}], "]"}], ",", 
          RowBox[{"xlr8r`GRN", "[", "stuff___", "]"}]}], "}"}], "]"}], ":=", 
       " ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"ilist", ",", " ", "\[IndentingNewLine]", "makereaci"}], 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"dPrint", "[", 
           RowBox[{
            RowBox[{"RightTeeArrow", "[", 
             RowBox[{"inputVar", ",", " ", "outputVar"}], "]"}], ",", 
            "\"\< is ok\>\""}], "]"}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"ilist", " ", "=", " ", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", "allneighbors", "]"}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<ilist: \>\"", ",", " ", "ilist"}], "]"}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "correct", " ", "concentrations", " ", "for", " ", "different", 
            " ", "volumes", " ", "by", " ", "changing", " ", "multiplier"}], 
           " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"makereaci", "[", "i_", "]"}], ":=", " ", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "r", ",", "arg1", ",", "argrest", ",", " ", "newstuff", ",", 
               " ", "v"}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{"{", "stuff", "}"}], "]"}], ">", "0"}], ",", " ", 
                RowBox[{"arg1", "=", 
                 RowBox[{"First", "[", 
                  RowBox[{"{", "stuff", "}"}], "]"}]}], ",", 
                RowBox[{"arg1", "=", "1.0"}]}], "]"}], ";", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{"{", "stuff", "}"}], "]"}], ">", "1"}], ",", " ", 
                RowBox[{"argrest", "=", 
                 RowBox[{"Rest", "[", 
                  RowBox[{"{", "stuff", "}"}], "]"}]}], ",", " ", 
                RowBox[{"argrest", "=", 
                 RowBox[{"{", "}"}]}]}], "]"}], ";", " ", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"v", "[", 
                RowBox[{"ifrom_", ",", " ", "ito_"}], "]"}], ":=", " ", 
               RowBox[{"arg1", "*", 
                RowBox[{
                 RowBox[{
                  RowBox[{"areaVariable", "[", "ito", "]"}], "[", "Global`t", 
                  "]"}], "/", 
                 RowBox[{
                  RowBox[{"areaVariable", "[", "ifrom", "]"}], "[", 
                  "Global`t", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"r", "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"RightTeeArrow", "[", 
                    RowBox[{
                    RowBox[{"inputVar", "[", "i", "]"}], ",", " ", 
                    RowBox[{"outputVar", "[", "#", "]"}]}], "]"}], ",", 
                   RowBox[{"xlr8r`GRN", "[", "\[IndentingNewLine]", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v", "[", 
                    RowBox[{"i", ",", "#"}], "]"}], ",", "argrest"}], "}"}], 
                    "]"}]}], "]"}]}], "}"}], "&"}], "/@", 
                RowBox[{"allneighbors", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}]}]}]}], 
            "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Join", "@@", 
           RowBox[{"(", 
            RowBox[{"makereaci", "/@", "ilist"}], ")"}]}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"HandleReaction", "[", "u___", "]"}], ":=", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<generateIntercellularReactions: Invalid Intercellular \
Reaction: \>\"", ",", " ", "u"}], "]"}], ";", 
         RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";", "  ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", "\"\<Handle Block:\>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", "hr", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"hr", "=", 
          RowBox[{"(", 
           RowBox[{"HandleReaction", "/@", "intercellular"}], ")"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"dPrint", "[", 
          RowBox[{"\"\<hr:\>\"", ",", "hr"}], "]"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"grn", " ", "=", " ", 
          RowBox[{"Join", "@@", "hr"}]}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<grn reactions: \>\"", ",", " ", "grn"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "grn"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.572011806849963*^9, 3.572011858490041*^9}, 
   3.5720118909698772`*^9, {3.572011970665037*^9, 3.572012046707035*^9}, {
   3.572012284258051*^9, 3.572012334066483*^9}, {3.572014644676434*^9, 
   3.572014676133177*^9}, {3.572014715043722*^9, 3.572014725617837*^9}, {
   3.572015020024783*^9, 3.572015264090542*^9}, {3.5720153016635942`*^9, 
   3.5720153056622458`*^9}, {3.572015349055196*^9, 3.5720153635006723`*^9}, {
   3.5720154154132833`*^9, 3.57201545507495*^9}, {3.572015486706139*^9, 
   3.5720155443388433`*^9}, {3.572015581091196*^9, 3.572015738789741*^9}, {
   3.572015779065394*^9, 3.57201588222064*^9}, {3.572015930363402*^9, 
   3.572015937754187*^9}, {3.5720159720215054`*^9, 3.57201605963861*^9}, {
   3.572016394932095*^9, 3.572016405303999*^9}, {3.572016486574095*^9, 
   3.572016706308401*^9}, {3.572016751830173*^9, 3.572016838919282*^9}, {
   3.5720168908693113`*^9, 3.572016893855496*^9}, {3.572017073277347*^9, 
   3.572017075464025*^9}, {3.572017174954143*^9, 3.572017206546493*^9}, {
   3.572017302581258*^9, 3.572017311825032*^9}, 3.7059516072556267`*^9, {
   3.705963569134733*^9, 
   3.705963653916739*^9}},ExpressionUUID->"d8e11c5d-cbbc-4d28-ac6b-\
dec3c0c2c3a8"]
}, Closed]],

Cell[CellGroupData[{

Cell["generateDiffusionReactions", "Subsubsection",
 CellChangeTimes->{{3.574708636935522*^9, 
  3.5747086409732933`*^9}},ExpressionUUID->"8a856129-9c5c-4d3c-bf5c-\
3eb598a29305"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"generateDiffusionReactions", "[", 
     RowBox[{
     "c_", ",", " ", "e_", ",", " ", "eused_", ",", " ", "diffusingSpecies_", 
      ",", " ", "\[IndentingNewLine]", "allEdgesBetween_", ",", " ", 
      "allneighbors_", ",", " ", "outercells_", ",", "  ", "outeredges_", ",",
       " ", "edgeVariable_", ",", " ", "areaVariable_", ",", " ", "x_", ",", 
      " ", "y_", ",", " ", "edgeLengths_", ",", "  ", "boundaryConditionSet_",
       ",", "\[IndentingNewLine]", "debug_"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "dPrint", ",", " ", "cellNumbers", ",", " ", "toDynamicNumberRules", 
        ",", " ", "toStaticNumberRules", ",", "cellIndices", ",", " ", 
        "neighbors", ",", "edgeBetween", ",", "l", ",", " ", "DR", ",", 
        "diffusionReactions", ",", "difSpec", ",", " ", "diffData", ",", " ", 
        "getTransferFunction", ",", "Y", ",", " ", "\[Beta]", ",", " ", 
        "\[Beta]outer", ",", " ", "temp", ",", " ", "diff", ",", " ", 
        "DRBOUNDARY", ",", "bdry", ",", " ", "outerEdgesOf", ",", 
        "outerCELLS"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"dPrint", "[", "u___", "]"}], ":=", " ", 
        RowBox[{"If", "[", 
         RowBox[{"debug", ",", " ", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<generateDiffusionReactions: \>\"", ",", " ", "u"}], 
           "]"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"getTransferFunction", "[", "stuff_", "]"}], ":=", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{
            RowBox[{"Head", "[", "stuff", "]"}], ",", " ", "Function"}], 
           "]"}], ",", "stuff", ",", 
          RowBox[{
           RowBox[{"Evaluate", "[", "stuff", "]"}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"cellNumbers", "=", 
        RowBox[{"First", "/@", "c"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"toDynamicNumberRules", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "c", "]"}], "]"}], ",", "cellNumbers"}], 
           "}"}]}], "]"}]}], ";", 
       RowBox[{"toStaticNumberRules", "=", 
        RowBox[{"Reverse", "/@", "toDynamicNumberRules"}]}], ";", 
       RowBox[{"dPrint", "[", 
        RowBox[{
        "\"\<toDynamicNumberRules: \>\"", ",", "toDynamicNumberRules"}], 
        "]"}], ";", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<toStaticNumberRules: \>\"", ",", "toStaticNumberRules"}],
         "]"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"outerCELLS", " ", "=", " ", 
        RowBox[{"outercells", "/.", "toDynamicNumberRules"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"cellIndices", "=", 
        RowBox[{"Last", "/@", "c"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"neighbors", "[", "p_", "]"}], ":=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"allneighbors", "[", 
           RowBox[{"[", 
            RowBox[{"p", "/.", "toStaticNumberRules"}], "]"}], "]"}], ")"}], "/.",
          "toDynamicNumberRules"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"outerEdgesOf", "[", "p_", "]"}], ":=", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"p", "/.", "c"}], ")"}], "\[Intersection]", "outeredges"}],
          ")"}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"edgeBetween", "[", 
         RowBox[{"p_", ",", "0"}], "]"}], ":=", "  ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p", "/.", "c"}], ")"}], "\[Intersection]", 
           "outeredges"}], ")"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"edgeBetween", "[", 
         RowBox[{"p_", ",", "q_"}], "]"}], ":=", 
        RowBox[{"allEdgesBetween", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"p", "/.", "toStaticNumberRules"}], ",", 
           RowBox[{"q", "/.", "toStaticNumberRules"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"l", "[", 
         RowBox[{"p_", ",", "q_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"edgeVariable", "[", 
          RowBox[{"edgeBetween", "[", 
           RowBox[{"p", ",", "q"}], "]"}], "]"}], "[", "Global`t", "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"DR", "[", 
         RowBox[{"X_", ",", "func_", ",", 
          RowBox[{"{", 
           RowBox[{"p_", ",", "q_"}], "}"}]}], "]"}], ":=", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"edge", "=", 
            RowBox[{"edgeBetween", "[", 
             RowBox[{"p", ",", "q"}], "]"}]}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"X", "[", "p", "]"}], "\[RightArrowLeftArrow]", 
             "Global`\[EmptySet]"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"l", "[", 
                RowBox[{"p", ",", "q"}], "]"}], " ", 
               RowBox[{"func", "[", 
                RowBox[{"p", ",", "q", ",", "edge"}], "]"}]}], ")"}], "/", 
             RowBox[{
              RowBox[{"areaVariable", "[", "p", "]"}], "[", "Global`t", 
              "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"l", "[", 
                 RowBox[{"p", ",", "q"}], "]"}], " ", 
                RowBox[{"func", "[", 
                 RowBox[{"p", ",", "q", ",", "edge"}], "]"}]}], ")"}], "/", 
              RowBox[{
               RowBox[{"areaVariable", "[", "p", "]"}], "[", "Global`t", 
               "]"}]}], " ", 
             RowBox[{
              RowBox[{"X", "[", "q", "]"}], "[", "Global`t", "]"}]}]}], 
           "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"DRBOUNDARY", "[", 
         RowBox[{"X_", ",", "func_", ",", "p_"}], "]"}], ":=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"rset", ",", "edge", ",", "lvar"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"lvar", "[", "u_", "]"}], ":=", 
            RowBox[{
             RowBox[{"edgeVariable", "[", "u", "]"}], "[", "Global`t", 
             "]"}]}], " ", ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"rset", "[", "edge_", "]"}], ":=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"X", "[", "p", "]"}], "\[RightArrowLeftArrow]", 
               "Global`\[EmptySet]"}], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"lvar", "[", "edge", "]"}], "*", " ", 
                 RowBox[{"func", "[", 
                  RowBox[{"p", ",", "0", ",", "edge"}], "]"}]}], ")"}], "/", 
               RowBox[{
                RowBox[{"areaVariable", "[", "p", "]"}], "[", "Global`t", 
                "]"}]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"lvar", "[", "edge", "]"}], "*", " ", 
                  RowBox[{"func", "[", 
                   RowBox[{"p", ",", "0", ",", "edge"}], "]"}]}], ")"}], "/", 
                
                RowBox[{
                 RowBox[{"areaVariable", "[", "p", "]"}], "[", "Global`t", 
                 "]"}]}], " ", 
               RowBox[{
                RowBox[{"X", "[", "0", "]"}], "[", "Global`t", "]"}]}]}], 
             "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Join", "[", 
            RowBox[{"rset", "/@", 
             RowBox[{"outerEdgesOf", "[", "p", "]"}]}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"diffusionReactions", "[", 
         RowBox[{"X_", ",", "\[Beta]_", ",", "p_"}], "]"}], ":=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"DR", "[", 
           RowBox[{"X", ",", "\[Beta]", ",", 
            RowBox[{"{", 
             RowBox[{"p", ",", "inbr"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"inbr", ",", 
            RowBox[{"neighbors", "[", "p", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"difSpec", "=", "diffusingSpecies"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "difSpec", "]"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"AbortIf", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ToString", "[", "areaVariable", "]"}], "\[Equal]", 
             "\"\<False\>\""}], ",", "\[IndentingNewLine]", 
            "\"\<Diffsion Requested but Cellvariable\\\"\[Rule]False\>\""}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"diff", "=", 
        RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "difSpec", "]"}], ">", "0"}], ",", 
         RowBox[{
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<difSpec: \>\"", ",", "difSpec"}], "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]",
           "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<difSpec: \>\"", ",", "difSpec"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"diffData", "=", 
           RowBox[{"First", "[", "difSpec", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"difSpec", "=", 
           RowBox[{"Rest", "[", "difSpec", "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"Y", "=", 
           RowBox[{"diffData", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{
           "\"\<diffData=\>\"", ",", "diffData", ",", " ", "\"\< Y=\>\"", ",",
             " ", "Y"}], "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "diffData", "]"}], ">", "1"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\[Beta]", "=", 
             RowBox[{"getTransferFunction", "[", 
              RowBox[{"diffData", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\[Beta]", "=", 
             RowBox[{"0", "&"}]}]}], "\[IndentingNewLine]", "]"}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "diffData", "]"}], ">", "2"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\[Beta]outer", "=", 
             RowBox[{"getTransferFunction", "[", 
              RowBox[{"diffData", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "]"}]}], ",", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"if", " ", "specified"}], ",", " ", 
              RowBox[{
              "middle", " ", "argument", " ", "should", " ", "be", " ", 
               "zero"}]}], " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"\[Beta]outer", "=", 
             RowBox[{"0", "&"}]}]}], "\[IndentingNewLine]", "]"}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<cellIndices: \>\"", ",", " ", "cellNumbers"}], "]"}], 
          ";", " ", "\[IndentingNewLine]", 
          RowBox[{"temp", "=", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"diffusionReactions", "[", 
                 RowBox[{"Y", ",", "\[Beta]", ",", " ", "#"}], "]"}], "&"}], "/@",
                "cellNumbers"}], "]"}], ",", "1"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<temp: \>\"", ",", " ", 
            RowBox[{"Short", "[", 
             RowBox[{"temp", ",", " ", "5"}], "]"}]}], "]"}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{
           "\"\<boundaryConditionSet: \>\"", ",", " ", 
            "boundaryConditionSet"}], "]"}], ";", " ", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"boundaryConditionSet", ",", " ", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"dPrint", "[", 
              RowBox[{"\"\<outerCELLS: \>\"", ",", " ", "outerCELLS"}], "]"}],
              ";", " ", "\[IndentingNewLine]", 
             RowBox[{"bdry", "=", 
              RowBox[{"Flatten", "[", 
               RowBox[{
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"DRBOUNDARY", "[", 
                    RowBox[{"Y", ",", "\[Beta]outer", ",", "#"}], "]"}], 
                    "&"}], "/@", "outerCELLS"}], ",", "1"}], "]"}], ",", 
                "1"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"bdry", "=", 
             RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "]"}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<bdry: \>\"", ",", " ", 
            RowBox[{"Short", "[", 
             RowBox[{"bdry", ",", "5"}], "]"}]}], "]"}], ";", " ", 
          "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
          RowBox[{"diff", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"diff", ",", "temp", ",", "bdry"}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
       "diff"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], " "}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.548443644673458*^9, 3.548443651611072*^9}, 
   3.548444053163106*^9, {3.548444213491941*^9, 3.548444263676901*^9}, {
   3.548444305710492*^9, 3.548444375792479*^9}, {3.548444424881928*^9, 
   3.5484444585405188`*^9}, {3.548444494902529*^9, 3.548444543751335*^9}, {
   3.548444582385573*^9, 3.548444618620694*^9}, {3.548444655274753*^9, 
   3.548444660729492*^9}, {3.5484446946041327`*^9, 3.5484447219731827`*^9}, {
   3.548444876632842*^9, 3.548444979536839*^9}, {3.548445037571582*^9, 
   3.548445082997346*^9}, {3.548445133197879*^9, 3.54844516722815*^9}, {
   3.548445496254075*^9, 3.548445597655334*^9}, {3.548445629941798*^9, 
   3.548445630985437*^9}, {3.548445723934566*^9, 3.54844582099203*^9}, {
   3.548446013310672*^9, 3.5484460141437597`*^9}, {3.54844612928144*^9, 
   3.548446211141077*^9}, {3.5484462641252947`*^9, 3.548446333244245*^9}, {
   3.548446366447878*^9, 3.548446385184602*^9}, {3.5484464214102077`*^9, 
   3.54844642479902*^9}, {3.548446475822394*^9, 3.548446559213512*^9}, {
   3.548446604793013*^9, 3.5484466185434923`*^9}, {3.5484468055013227`*^9, 
   3.548446824814369*^9}, {3.5484477377489567`*^9, 3.5484477433734293`*^9}, {
   3.548448187204265*^9, 3.548448289383164*^9}, {3.548448362732361*^9, 
   3.548448478270625*^9}, {3.548448540068132*^9, 3.548448571833857*^9}, {
   3.548528784805575*^9, 3.5485288495422564`*^9}, {3.548529005064056*^9, 
   3.548529028388261*^9}, {3.5485292162494783`*^9, 3.548529285307822*^9}, {
   3.5713182231337557`*^9, 3.571318235158209*^9}, 3.572011882308948*^9, {
   3.5762656363835907`*^9, 3.576265775939877*^9}, {3.576685288348715*^9, 
   3.576685334262463*^9}, {3.576685395077509*^9, 3.576685425771612*^9}, {
   3.576685466685059*^9, 
   3.57668548773717*^9}},ExpressionUUID->"02eeeb0e-db79-4191-9aff-\
2dafb8100626"]
}, Closed]],

Cell[CellGroupData[{

Cell["generatePumpReactions", "Subsubsection",
 CellChangeTimes->{{3.574708645990931*^9, 
  3.574708651917782*^9}},ExpressionUUID->"705d5431-06a6-492d-be8a-\
2b5b9b0273b6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"generatePumpReactions", "[", 
    RowBox[{
    "c_", ",", "  ", "pumps_", ",", " ", "allEdgesBetween_", ",", " ", 
     "allneighbors_", ",", "outercells_", ",", " ", "outeredges_", ",", " ", 
     "\[IndentingNewLine]", "edgeVariable_", ",", " ", "areaVariable_", ",", 
     " ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "dbg", ",", " ", "dPrint", ",", " ", "pumpdata", ",", "r", ",", " ", 
       "pump", ",", " ", "var", ",", " ", "fout", ",", " ", "fin", ",", " ", 
       "PR", ",", " ", "toStaticNumberRules", ",", " ", 
       "toDynamicNumberRules", ",", " ", "cellNumbers", ",", " ", "neighbors",
        ",", " ", "XPR", ",", " ", "pumpReactions", ",", " ", "rnew"}], "}"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dbg", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<Debug\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<debug\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dPrint", "[", "x___", "]"}], ":=", " ", 
       RowBox[{"If", "[", 
        RowBox[{"dbg", ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<generatePumpReactions: \>\"", ",", " ", "x"}], "]"}]}],
         "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<pumps: \>\"", ",", " ", "pumps"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<allneighbors: \>\"", ",", " ", "allneighbors"}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"cellNumbers", "=", 
       RowBox[{"First", "/@", "c"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"toDynamicNumberRules", " ", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Rule", ",", 
         RowBox[{"{", " ", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", "c", "]"}], "]"}], ",", "cellNumbers"}], 
          "}"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"toStaticNumberRules", "=", 
       RowBox[{"Reverse", "/@", "toDynamicNumberRules"}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"neighbors", "[", "p_", "]"}], ":=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"allneighbors", "[", 
          RowBox[{"[", 
           RowBox[{"p", "/.", "toStaticNumberRules"}], "]"}], "]"}], ")"}], "/.",
         "toDynamicNumberRules"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"XPR", "[", 
        RowBox[{"X_", ",", "fout_", ",", "fin_", ",", " ", 
         RowBox[{"{", 
          RowBox[{"p_", ",", "q_"}], "}"}]}], "]"}], ":=", 
       "\[IndentingNewLine]", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"edge", ",", " ", "AC", ",", " ", "E"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"edge", "=", 
           RowBox[{"allEdgesBetween", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"p", "/.", "toStaticNumberRules"}], ",", 
              RowBox[{"q", "/.", "toStaticNumberRules"}]}], "]"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"E", "=", 
           RowBox[{
            RowBox[{"edgeVariable", "[", "edge", "]"}], "[", "Global`t", 
            "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"AC", " ", "=", " ", 
           RowBox[{
            RowBox[{"areaVariable", "[", "p", "]"}], "[", "Global`t", "]"}]}],
           ";", " ", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"X", "[", "p", "]"}], "\[Implies]", " ", 
               "Global`\[EmptySet]"}], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"fout", "[", 
                  RowBox[{"p", ",", "q", ",", "edge"}], "]"}], "+", 
                 RowBox[{"fin", "[", 
                  RowBox[{"q", ",", "p", ",", "edge"}], "]"}]}], ")"}], "*", 
               RowBox[{"E", "/", "AC"}]}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Global`\[EmptySet]", "\[Implies]", 
               RowBox[{"X", "[", "p", "]"}]}], ",", " ", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"fin", "[", 
                  RowBox[{"p", ",", "q", ",", "edge"}], "]"}], "+", 
                 RowBox[{"fout", "[", 
                  RowBox[{"q", ",", "p", ",", "edge"}], "]"}]}], ")"}], "*", 
               RowBox[{"E", "/", "AC"}]}]}], "}"}]}], "}"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pumpReactions", "[", 
        RowBox[{"X_", ",", "FOUT_", ",", "FIN_", " ", ",", "p_"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"reactions", ",", "nbrs"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"nbrs", "=", 
           RowBox[{"neighbors", "[", "p", "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"reactions", "=", 
           RowBox[{"Join", "@@", 
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"XPR", "[", 
               RowBox[{"X", ",", "FOUT", ",", " ", "FIN", ",", " ", 
                RowBox[{"{", 
                 RowBox[{"p", ",", "inbr"}], "}"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"inbr", ",", "nbrs"}], "}"}]}], "]"}]}]}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pumpReactions", "[", 
        RowBox[{"X_", ",", " ", "FOUT_", ",", " ", "FIN_"}], "]"}], ":=", " ", 
       RowBox[{"Join", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"pumpReactions", "[", 
            RowBox[{"X", ",", "FOUT", ",", "FIN", ",", "#"}], "]"}], "&"}], "/@",
           "cellNumbers"}], ")"}]}]}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"r", "=", 
       RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"pumpdata", "=", "pumps"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "pumpdata", "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"pump", "=", 
          RowBox[{"First", "[", "pumpdata", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AbortIf", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"ListQ", "[", "pump", "]"}]}], ",", " ", 
           RowBox[{
           "\"\<Expecting a list for transport function: \>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"InputForm", "[", "pump", "]"}], "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AbortIf", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "pump", "]"}], "<", "1"}], ",", " ", 
           "\"\<No variable specified for transport.\>\""}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"var", " ", "=", " ", 
          RowBox[{"pump", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
         
         RowBox[{"AbortIf", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "pump", "]"}], "<", "2"}], ",", " ", 
           RowBox[{
           "\"\<Expecting a transport function in the second position for \
transported constitutent \>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"InputForm", "[", "var", "]"}], "]"}]}]}], "]"}], ";", 
         " ", "\[IndentingNewLine]", 
         RowBox[{"fout", " ", "=", " ", 
          RowBox[{"pump", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
         
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "pump", "]"}], ">", "2"}], ",", " ", 
           RowBox[{"fin", "=", 
            RowBox[{"pump", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], ",", " ", 
           RowBox[{"fin", "=", 
            RowBox[{"0", "&"}]}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"dPrint", "[", 
          RowBox[{
          "\"\<var: \>\"", ",", " ", "var", ",", " ", "\"\< fin: \>\"", ",", 
           " ", "fin", ",", " ", "\"\< fout: \>\"", ",", " ", "fout"}], "]"}],
          ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"pumpdata", "=", 
          RowBox[{"Rest", "[", "pumpdata", "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"rnew", " ", "=", " ", 
          RowBox[{"pumpReactions", "[", 
           RowBox[{"var", ",", " ", "fout", ",", " ", "fin"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"dPrint", "[", "rnew", "]"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"r", " ", "=", " ", 
          RowBox[{"Join", "[", 
           RowBox[{"r", ",", " ", "rnew"}], "]"}]}], ";"}]}], " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "r"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5484437379532633`*^9, 3.548443744113332*^9}, {
   3.548446970908306*^9, 3.5484469943743258`*^9}, {3.57201192265202*^9, 
   3.572011924018186*^9}, {3.575306634151523*^9, 3.57530666781041*^9}, {
   3.5753067040501204`*^9, 3.5753067153935966`*^9}, {3.575306755601287*^9, 
   3.575306755877446*^9}, {3.5753067863787003`*^9, 3.575306786565632*^9}, {
   3.575306892123857*^9, 3.575306950577124*^9}, {3.575307078040307*^9, 
   3.575307308490774*^9}, {3.5753073386743927`*^9, 3.5753073554652243`*^9}, {
   3.575307432523376*^9, 3.575307446752561*^9}, {3.575307481848913*^9, 
   3.575307613617872*^9}, {3.575307644656947*^9, 3.5753076870459557`*^9}, {
   3.575307742137581*^9, 3.575307743891633*^9}, {3.57530778859015*^9, 
   3.57530790284587*^9}, 3.575307936968067*^9, {3.575308167254072*^9, 
   3.5753081695868387`*^9}, 3.575308265134111*^9, {3.575388603712281*^9, 
   3.575388673902484*^9}, {3.575388711975404*^9, 3.575388722794656*^9}, {
   3.575388817730534*^9, 3.5753889012038918`*^9}, {3.57539088088787*^9, 
   3.575390895481963*^9}},ExpressionUUID->"f01fe1a6-6ac2-432d-836b-\
fcc0fef8fbd2"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["WalledNetwork ", "Subsection",
 CellChangeTimes->{{3.545070078175582*^9, 3.54507008094174*^9}, {
   3.545070138602038*^9, 3.5450701513027644`*^9}, {3.545132764621833*^9, 
   3.545132780211987*^9}, 3.546005962240262*^9, {3.548004642089381*^9, 
   3.548004643591547*^9}, {3.548442193855798*^9, 
   3.5484421974873037`*^9}},ExpressionUUID->"45f0a8e5-dedb-4e0f-bae2-\
7a6f06c6e519"],

Cell["\<\
X[i,j] is wall compartment between cell i and cell j adjacent to cell i. 
Outer edge  cell i is compartment X[i.0]
Arguments of fin, fout, fwall are Cell1, Cell2, edge#; with \
\[OpenCurlyDoubleQuote]outside\[CloseCurlyDoubleQuote] being cell#=0

Diffusion rates constants are Diffusions (e.g., cm^2/sec, etc) not \
permeabilities (fin, fout)\
\>", "Text",
 CellChangeTimes->{{3.5445687261193047`*^9, 3.544568809719297*^9}, {
  3.544883496074831*^9, 3.5448835215653267`*^9}, {3.545005937774116*^9, 
  3.545005939059078*^9}, {3.5579681184933434`*^9, 
  3.55796815207454*^9}},ExpressionUUID->"7c36ccc5-9cf7-48b1-adba-\
a021a5759f29"],

Cell[CellGroupData[{

Cell["WalledNetwork Main function", "Subsubsection",
 CellChangeTimes->{{3.5484436176797857`*^9, 
  3.5484436232953568`*^9}},ExpressionUUID->"970e6993-a09f-4c8d-920b-\
73df404fedcf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"WalledNetwork", "[", 
    RowBox[{
     RowBox[{"tissue_", "?", "DTissueQ"}], ",", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "r", ",", "k", ",", "n", ",", "ne", ",", " ", "in", ",", "out", ",", 
       "diff", ",", "reactions", ",", "i", ",", "j", ",", "vPrint", ",", 
       "nInside", ",", "nDiff", ",", "nTotal", ",", "ok", ",", "istissue", 
       ",", "istorus", ",", "c", ",", "icc", ",", "dPrint", ",", 
       "edgeVariable", ",", "areaVariable", ",", "debug", ",", "wall", ",", 
       " ", "verbose", ",", "e", ",", "v", ",", "  ", "static", ",", "aij", 
       ",", " ", "wallreactions", ",", "nwall", ",", " ", "Depth", ",", 
       "requestedDynamic", ",", "\[IndentingNewLine]", "areas", ",", 
       "edgeLengths", ",", " ", "boundaryConditions", ",", "allEdgesBetween", 
       ",", " ", "neighbors", ",", " ", "allneighbors", ",", "outeredges", 
       ",", " ", "outercells", ",", "One", ",", "ZERO", ",", "subnet", ",", 
       "\[IndentingNewLine]", "pumps", ",", "pr", ",", "diffusingSpecies", 
       ",", " ", "intracellular", ",", "getTransferFunction", ",", " ", 
       "growing", ",", "GR", ",", "GE", ",", "nv", ",", "growthstuff", ",", 
       "AEQ", ",", "equations", ",", "x", ",", "y", ",", "cvn", ",", "eused", 
       ",", "vused", ",", " ", "inputTissue", ",", "cellNumbers", ",", 
       "cellEdgeIndices"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"debug", "=", 
       RowBox[{
        RowBox[{"\"\<NDebug\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<NDebug\>\"", "\[Rule]", "False"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dPrint", "[", "x___", "]"}], ":=", 
       RowBox[{"If", "[", 
        RowBox[{"debug", ",", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<WalledNetwork: \>\"", ",", "x"}], "]"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<NDebug: \>\"", ",", " ", "debug"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"One", "[", 
        RowBox[{"p_", ",", "q_", ",", "r_"}], "]"}], ":=", "1"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ZERO", "[", 
        RowBox[{"p_", ",", "q_", ",", " ", "r_"}], "]"}], ":=", " ", "0"}], 
      ";", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"getTransferFunction", "[", "stuff_", "]"}], ":=", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{
           RowBox[{"Head", "[", "stuff", "]"}], ",", " ", "Function"}], "]"}],
          ",", "stuff", ",", 
         RowBox[{
          RowBox[{"Evaluate", "[", "stuff", "]"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"verbose", "=", 
       RowBox[{
        RowBox[{"\"\<Verbose\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Verbose\>\"", "\[Rule]", "True"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"edgeVariable", "=", 
       RowBox[{
        RowBox[{"\"\<EdgeVariable\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<EdgeVariable\>\"", "\[Rule]", "None"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"areaVariable", "=", 
       RowBox[{
        RowBox[{"\"\<CellVariable\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<CellVariable\>\"", "\[Rule]", "None"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"x", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<x\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<x\>\"", "\[Rule]", " ", "Global`x"}], "}"}]}]}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{"y", "=", 
       RowBox[{
        RowBox[{"\"\<y\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<y\>\"", "\[Rule]", " ", "Global`y"}], "}"}]}]}], ";", 
      " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"pumps", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<Pumps\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Pumps\>\"", "\[Rule]", " ", 
          RowBox[{"{", "}"}]}], "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"diffusingSpecies", "=", 
       RowBox[{
        RowBox[{"\"\<Diffusion\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Diffusion\>\"", "\[Rule]", " ", 
          RowBox[{"{", "}"}]}], "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"intracellular", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<Reactions\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Reactions\>\"", "\[Rule]", " ", 
          RowBox[{"{", "}"}]}], "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"growing", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<Growing\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Growing\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";",
       " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Depth", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<CellDepth\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<CellDepth\>\"", "\[Rule]", " ", "Global`CellDepth"}], 
         "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"aij", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<WallThickness\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<WallThickness\>\"", "\[Rule]", " ", "Global`halfwall"}],
          "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"wall", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<WallReactions\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Wall\>\"", "\[Rule]", " ", 
          RowBox[{"{", "}"}]}], "}"}]}]}], ";", "  ", "\[IndentingNewLine]", 
      RowBox[{"boundaryConditions", "=", 
       RowBox[{"getBC", "[", "opt", "]"}]}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "force", " ", "use", " ", "of", " ", "dynamic", " ", "variable", " ", 
         "names"}], ";", " ", 
        RowBox[{
        "replace", " ", "with", " ", "static", " ", "values", " ", "at", " ", 
         "end", " ", "if", " ", "needed"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"static", "=", 
       RowBox[{"Or", "[", 
        RowBox[{
         RowBox[{"edgeVariable", "===", "None"}], ",", 
         RowBox[{"areaVariable", "===", "None"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"growing", ",", " ", 
        RowBox[{"static", "=", "False"}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"edgeVariable", "=", 
       RowBox[{"edgeVariable", "/.", 
        RowBox[{"{", 
         RowBox[{"None", "\[Rule]", " ", 
          RowBox[{"Symbol", "[", "\"\<Global`edge\>\"", "]"}]}], "}"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"areaVariable", "=", 
       RowBox[{"areaVariable", "/.", 
        RowBox[{"{", 
         RowBox[{"None", "\[Rule]", " ", 
          RowBox[{"Symbol", "[", "\"\<Global`area\>\"", "]"}]}], "}"}]}]}], 
      ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"TissueCells", "[", "tissue", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<c=\>\"", ",", " ", "c"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"cellNumbers", "=", 
       RowBox[{"First", "/@", "c"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cellEdgeIndices", " ", "=", " ", 
       RowBox[{"Last", "/@", "c"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"e", "=", 
       RowBox[{"TissueEdges", "[", "tissue", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ne", " ", "=", " ", 
       RowBox[{"Length", "[", "e", "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{"TissueVertices", "[", "tissue", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"nv", "=", 
       RowBox[{"Length", "[", "v", "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vPrint", "[", "x___", "]"}], ":=", 
       RowBox[{"If", "[", 
        RowBox[{"verbose", ",", 
         RowBox[{"Print", "[", "x", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{
       "\"\<e=\>\"", ",", " ", "e", ",", "\"\< ne=\>\"", ",", " ", "ne"}], 
       "]"}], ";", "  ", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{
       "\"\<v=\>\"", ",", " ", "v", ",", " ", "\"\< nv=\>\"", ",", " ", 
        "nv"}], "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"generate", " ", "intracellular", " ", "reactions"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<intracellular: \>\"", ",", " ", "intracellular"}], "]"}], 
      ";", " ", "\[IndentingNewLine]", 
      RowBox[{"r", "=", 
       RowBox[{"lowLevelReactions", "[", "intracellular", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<r: \>\"", ",", " ", "r"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"subnet", "[", "i_", "]"}], ":=", 
       RowBox[{"indexify", "[", 
        RowBox[{"r", ",", "i", ",", " ", "opt"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<subnet[i] = \>\"", ",", " ", 
        RowBox[{"subnet", "[", "i", "]"}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "c", "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"vPrint", "[", 
       RowBox[{"n", ",", "\"\< Cells.\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vPrint", "[", 
       RowBox[{
        RowBox[{"Length", "[", "r", "]"}], ",", 
        "\"\< internal reactions in each cell.\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"in", "=", 
         RowBox[{"Join", "@@", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"r", "/.", 
             RowBox[{"{", 
              RowBox[{"i", "\[Rule]", "k"}], "}"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}]}]}], ";"}], 
       "*)"}], " ", "\[IndentingNewLine]", 
      RowBox[{"in", " ", "=", " ", 
       RowBox[{"Join", "@@", 
        RowBox[{"(", 
         RowBox[{"subnet", "/@", "cellNumbers"}], ")"}]}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"nInside", "=", 
       RowBox[{"Length", "[", "in", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vPrint", "[", 
       RowBox[{"nInside", ",", "\"\< total intracellular reactions.\>\""}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<in = \>\"", ",", " ", "in"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"wallreactions", "=", 
       RowBox[{"generateCelleratorInWallReactions", "[", 
        RowBox[{"wall", ",", "c", ",", "verbose"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nwall", "=", " ", 
       RowBox[{"Length", "[", "wallreactions", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"vPrint", "[", 
       RowBox[{"nwall", ",", "\"\< total intrawall reactions.\>\""}], "]"}], 
      ";", " ", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\< wallreactions: \>\"", ",", " ", "wallreactions"}], "]"}],
       ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"inputTissue", "=", 
       RowBox[{"DTissue2Tissue", "[", "tissue", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"edgeLengths", "=", 
       RowBox[{"EdgeLengths", "[", "inputTissue", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<edgeLengths:\>\"", ",", " ", "edgeLengths"}], "]"}], ";", 
      " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "The", " ", "following", " ", "use", " ", "the", " ", "static", " ", 
        "cell", " ", "number"}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"areas", "=", 
       RowBox[{"areafunction", "[", "inputTissue", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"allEdgesBetween", "=", 
       RowBox[{"EdgesBetween", "[", "inputTissue", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"allneighbors", "=", 
       RowBox[{"CellNeighbors", "[", "inputTissue", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"neighbors", "[", "p_", "]"}], ":=", 
       RowBox[{"allneighbors", "[", 
        RowBox[{"[", "p", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<allNeighbors: \>\"", ",", "allneighbors"}], "]"}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{"outeredges", " ", "=", " ", 
       RowBox[{"EdgesOnBoundary", "[", "inputTissue", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"outercells", " ", "=", " ", 
       RowBox[{"CellsOnBoundary", "[", "inputTissue", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<allEdgesBetween: \>\"", ",", 
        RowBox[{"MatrixForm", "[", "allEdgesBetween", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<outeredges = \>\"", ",", " ", "outeredges"}], "]"}], ";", 
      " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "generate", " ", "concentration", " ", "dependent", " ", "pump", " ", 
        "reactions"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"pr", " ", "=", " ", 
       RowBox[{"generateCelleratorWalledPumpReactions", "[", 
        RowBox[{
        "c", ",", "  ", "pumps", ",", " ", "allEdgesBetween", ",", " ", 
         "allneighbors", ",", "outercells", ",", " ", "outeredges", ",", " ", 
         "\[IndentingNewLine]", "edgeVariable", ",", " ", "areaVariable", ",",
          " ", "aij", ",", " ", 
         RowBox[{"\"\<Debug\>\"", "\[Rule]", " ", "debug"}]}], "]"}]}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{"vPrint", "[", 
       RowBox[{
        RowBox[{"Length", "[", "pr", "]"}], ",", 
        "\"\< transport reactions.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"generate", " ", "diffusion", " ", "reactions"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"vused", "=", 
       RowBox[{"VerticesUsed", "[", "inputTissue", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"eused", "=", 
       RowBox[{"EdgesUsed", "[", "inputTissue", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"diff", " ", "=", " ", 
       RowBox[{"generateCelleratorWalledDiffusionReactions", "[", 
        RowBox[{
        "c", ",", " ", "e", ",", " ", "eused", ",", "diffusingSpecies", ",", 
         " ", "allEdgesBetween", ",", " ", "allneighbors", ",", " ", 
         "outercells", ",", "  ", "outeredges", ",", " ", "edgeVariable", ",",
          " ", "areaVariable", ",", " ", "x", ",", " ", "y", ",", " ", 
         "edgeLengths", ",", " ", "aij", ",", " ", "\[IndentingNewLine]", 
         "debug"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"nDiff", "=", 
       RowBox[{"Length", "[", "diff", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vPrint", "[", 
       RowBox[{"nDiff", ",", "\"\< diffusion reactions.\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "generate", " ", "intercellular", " ", "reactions", " ", "if", " ", 
        "spectified"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      
      RowBox[{"out", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"*", "this", " ", "is", " ", "TBD"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"reactions", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
        "in", ",", "diff", ",", " ", "pr", ",", " ", "out", ",", 
         "wallreactions"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "If", " ", "static", " ", "tissue", " ", "is", " ", "requestested"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "replace", " ", "variable", " ", "names", " ", "with", " ", "static", 
        " ", "values"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<static:\>\"", ",", " ", "static"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"static", ",", "\[IndentingNewLine]", 
        RowBox[{"Block", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "NewEdgeVariable", ",", " ", "NewAreaVariable", ",", 
            "NewVertexVariable", ",", " ", "newx", ",", " ", "newy"}], "}"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"NewEdgeVariable", "[", "edgeNumber_", "]"}], "[", 
             "Global`t", "]"}], ":=", 
            RowBox[{"edgeLengths", "[", 
             RowBox[{"[", "edgeNumber", "]"}], "]"}]}], ";", " ", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"NewAreaVariable", "[", "cellNumber_", "]"}], "[", 
             "Global`t", "]"}], ":=", " ", 
            RowBox[{"areas", "[", 
             RowBox[{"[", "cellNumber", "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"newx", "[", "i_", "]"}], "[", "Global`t", "]"}], ":=", 
            " ", 
            RowBox[{"v", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"newy", "[", "i_", "]"}], "[", "Global`t", "]"}], ":=", 
            " ", 
            RowBox[{"v", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"reactions", " ", "=", " ", 
            RowBox[{"(", 
             RowBox[{"reactions", "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"edgeVariable", "\[Rule]", " ", "NewEdgeVariable"}], 
                ",", " ", 
                RowBox[{"areaVariable", "\[Rule]", " ", "NewAreaVariable"}], 
                ",", " ", 
                RowBox[{"x", "\[Rule]", " ", "newx"}], ",", " ", 
                RowBox[{"y", "\[Rule]", " ", "newy"}]}], "}"}]}], ")"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"AEQ", "=", 
            RowBox[{"{", "}"}]}], ";"}]}], " ", "\[IndentingNewLine]", "]"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AEQ", "=", 
          RowBox[{"CellAreaEquations", "[", 
           RowBox[{"tissue", ",", "opt"}], "]"}]}], ";", " ", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"vPrint", "[", 
          RowBox[{
           RowBox[{"Length", "[", "AEQ", "]"}], ",", " ", 
           "\"\< equations for cell area.\>\""}], "]"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"dPrint", "[", 
          RowBox[{"\"\<AEQ:\>\"", ",", " ", "AEQ"}], "]"}], ";"}]}], " ", 
       "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"cvn", " ", "=", " ", 
       RowBox[{"CellVertexNumbers", "[", "tissue", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"growthstuff", "=", 
       RowBox[{"generateGrowthReactions", "[", 
        RowBox[{
        "c", ",", "cvn", ",", " ", "e", ",", "v", ",", " ", "eused", ",", " ",
          "vused", ",", " ", "edgeVariable", ",", " ", "outeredges", ",", 
         "  ", "opt"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"GR", "=", 
       RowBox[{"\"\<reactions\>\"", "/.", "growthstuff"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<GR: \>\"", ",", " ", "GR"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"GE", "=", 
       RowBox[{"\"\<equations\>\"", "/.", "growthstuff"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"vPrint", "[", 
       RowBox[{
        RowBox[{"Length", "[", "GE", "]"}], ",", 
        "\"\< algebraic equations for spring growth.\>\""}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<GE: \>\"", ",", " ", "GE"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"reactions", " ", "=", " ", 
       RowBox[{"Join", "[", 
        RowBox[{"reactions", ",", " ", "GR"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<reactions (1):\>\"", ",", " ", "reactions"}], "]"}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{"reactions", " ", "=", " ", 
       RowBox[{"reactions", " ", "/.", "boundaryConditions"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<reactions (2):\>\"", ",", " ", "reactions"}], "]"}], ";", 
      " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"nTotal", "=", 
       RowBox[{"Length", "[", "reactions", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vPrint", "[", 
       RowBox[{"nTotal", ",", "\"\< total reactions.\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"equations", " ", "=", " ", 
       RowBox[{"Join", "[", 
        RowBox[{"GE", ",", " ", "AEQ"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<equations:\>\"", ",", " ", "equations"}], "]"}], ";", " ",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"reactions", ",", " ", "equations"}], "}"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"WalledNetwork", "[", "x___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
     "Print", "[", "\"\<Error: Expecting WalledNetwork[DTissue, options]\>\"",
       "]"}], ";", "$Failed"}], ")"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.544461364384781*^9, 3.544461379048807*^9}, {
   3.544461622128434*^9, 3.544461713185794*^9}, {3.5444618061619573`*^9, 
   3.544461832666404*^9}, 3.544461980144575*^9, 3.544462197038293*^9, {
   3.544462398325738*^9, 3.544462402880946*^9}, 3.5444627268321714`*^9, {
   3.5444633340003376`*^9, 3.5444633612788973`*^9}, {3.544463405661436*^9, 
   3.544463541462161*^9}, {3.5444635838006353`*^9, 3.5444636221611032`*^9}, {
   3.5444636575419655`*^9, 3.5444636806924057`*^9}, {3.544463735479702*^9, 
   3.544463735869703*^9}, {3.5444637818741837`*^9, 3.544463811467436*^9}, {
   3.5444639245747538`*^9, 3.544463969315633*^9}, {3.5444640080193005`*^9, 
   3.5444640432597623`*^9}, {3.5444642653105526`*^9, 3.544464335853876*^9}, {
   3.544466709686124*^9, 3.54446671831058*^9}, {3.5444667568732147`*^9, 
   3.54446701665775*^9}, {3.544467094246982*^9, 3.5444670946590033`*^9}, {
   3.5444671356607904`*^9, 3.544467280785755*^9}, {3.544467478065651*^9, 
   3.5444675752004724`*^9}, {3.544556662551484*^9, 3.544556683252603*^9}, {
   3.544556888659972*^9, 3.5445568961757298`*^9}, {3.544556946172043*^9, 
   3.544557023175009*^9}, {3.5445571002002563`*^9, 3.544557145620862*^9}, {
   3.5445572045478973`*^9, 3.5445572636873703`*^9}, {3.5445573901833057`*^9, 
   3.544557749931561*^9}, {3.544557789604574*^9, 3.5445577900850477`*^9}, {
   3.5445578289153223`*^9, 3.5445578684463*^9}, {3.5445579103256693`*^9, 
   3.5445579457504787`*^9}, {3.544558006561879*^9, 3.5445580301108017`*^9}, {
   3.544558061786005*^9, 3.544558170563583*^9}, {3.544558200878825*^9, 
   3.544558331205756*^9}, {3.5445584059178257`*^9, 3.5445586141732807`*^9}, {
   3.544560008984511*^9, 3.5445601364343*^9}, {3.544560168875772*^9, 
   3.5445601922670107`*^9}, {3.5445602322525*^9, 3.544560237400496*^9}, {
   3.544560295891577*^9, 3.544560297960792*^9}, {3.544560384469019*^9, 
   3.544560443492189*^9}, {3.544560504983592*^9, 3.5445608175752907`*^9}, {
   3.544561674864482*^9, 3.5445617066006327`*^9}, {3.544561793315235*^9, 
   3.544561795835928*^9}, {3.544561828573638*^9, 3.544561895314897*^9}, {
   3.5445619453622293`*^9, 3.5445619772973547`*^9}, {3.544562063355506*^9, 
   3.54456207640701*^9}, {3.5445621471571827`*^9, 3.544562157333108*^9}, {
   3.544562213027029*^9, 3.544562215902471*^9}, {3.5445624347323217`*^9, 
   3.544562446560354*^9}, {3.5445625807878437`*^9, 3.544562606376361*^9}, {
   3.544562707110507*^9, 3.544562769429941*^9}, {3.5445629023852577`*^9, 
   3.54456292669659*^9}, {3.544562970467063*^9, 3.544563049719879*^9}, {
   3.544563108479746*^9, 3.544563112071039*^9}, {3.5445631584401712`*^9, 
   3.5445632609484043`*^9}, {3.544563291905079*^9, 3.544563425686301*^9}, {
   3.544563481619228*^9, 3.54456348515198*^9}, {3.5445636048040247`*^9, 
   3.544563607127939*^9}, {3.5445636386014347`*^9, 3.544563824562912*^9}, {
   3.54456391324582*^9, 3.544563927089163*^9}, {3.544564014206442*^9, 
   3.5445640725356207`*^9}, {3.544564142806988*^9, 3.5445642751716623`*^9}, {
   3.544564332575246*^9, 3.544564362105485*^9}, {3.544565659412196*^9, 
   3.544565673286973*^9}, {3.544565748214888*^9, 3.544565752828919*^9}, 
   3.5445658191126337`*^9, {3.5445659335655107`*^9, 3.5445660497478724`*^9}, {
   3.544566130931569*^9, 3.544566176595738*^9}, {3.54456620844871*^9, 
   3.544566249428341*^9}, {3.5445665501314983`*^9, 3.5445666641156063`*^9}, {
   3.544566890110305*^9, 3.544566922097774*^9}, {3.544566977836512*^9, 
   3.544566978458446*^9}, {3.5445670402612867`*^9, 3.544567058747354*^9}, {
   3.544567183605032*^9, 3.544567186118505*^9}, {3.5445672249913883`*^9, 
   3.5445672261197844`*^9}, {3.544567846819686*^9, 3.5445679613910217`*^9}, {
   3.5445680804670973`*^9, 3.544568104825523*^9}, {3.544568155857717*^9, 
   3.544568185919394*^9}, {3.544568226216229*^9, 3.544568397121202*^9}, 
   3.544568473007715*^9, {3.544725260779018*^9, 3.544725265139018*^9}, {
   3.54472561822576*^9, 3.544725620279381*^9}, {3.5447256749033012`*^9, 
   3.544725737955171*^9}, {3.5447258447901983`*^9, 3.54472588352626*^9}, {
   3.544725981144899*^9, 3.544726078346352*^9}, {3.544726129201796*^9, 
   3.544726166041153*^9}, {3.5447262168491907`*^9, 3.544726233119029*^9}, {
   3.5447263292711277`*^9, 3.544726338320272*^9}, {3.544726393273918*^9, 
   3.544726476278211*^9}, {3.5447265376652203`*^9, 3.544726612205119*^9}, {
   3.544726713885563*^9, 3.544726750953762*^9}, {3.544726783728158*^9, 
   3.544726843113159*^9}, {3.544726893973867*^9, 3.544726919772496*^9}, {
   3.5447269713391457`*^9, 3.5447269864924107`*^9}, {3.544727044682526*^9, 
   3.5447270545305643`*^9}, {3.544727147893601*^9, 3.544727255224712*^9}, {
   3.5447273010990953`*^9, 3.544727301537346*^9}, {3.5447273576789837`*^9, 
   3.544727366547019*^9}, {3.5447275361041527`*^9, 3.544727550117279*^9}, {
   3.5447275947117357`*^9, 3.544727644068519*^9}, {3.544727762189115*^9, 
   3.5447277643336143`*^9}, {3.544727917694265*^9, 3.544728038428948*^9}, 
   3.544728087706558*^9, {3.544728188458539*^9, 3.54472819718087*^9}, {
   3.5447282344340277`*^9, 3.5447282604853*^9}, {3.544728420336747*^9, 
   3.544728430072768*^9}, {3.544728484751698*^9, 3.54472854097458*^9}, {
   3.544728626630067*^9, 3.5447286337853327`*^9}, 3.544728700352648*^9, {
   3.544728756325591*^9, 3.5447288098489647`*^9}, 3.5447288413611097`*^9, {
   3.5447288781647387`*^9, 3.544728928599058*^9}, {3.544729265496492*^9, 
   3.544729397207671*^9}, {3.544729429415614*^9, 3.544729451536663*^9}, {
   3.544729585767763*^9, 3.544729600115573*^9}, {3.544729700305743*^9, 
   3.544729703257141*^9}, {3.544729771955307*^9, 3.5447298240509157`*^9}, {
   3.544729865990101*^9, 3.544729873472275*^9}, {3.544730032207711*^9, 
   3.544730091703545*^9}, 3.544730148808568*^9, {3.5447302624284897`*^9, 
   3.544730278848667*^9}, {3.544730469747415*^9, 3.544730510700509*^9}, {
   3.5447305408856907`*^9, 3.544730546193634*^9}, {3.544730577032094*^9, 
   3.5447305927427387`*^9}, {3.544730763747908*^9, 3.544730769593321*^9}, {
   3.544730870439074*^9, 3.544730875207193*^9}, {3.5447309318355207`*^9, 
   3.544730936375523*^9}, {3.544731565347683*^9, 3.5447317271755466`*^9}, {
   3.544731801346175*^9, 3.544731818738274*^9}, {3.544731870674286*^9, 
   3.544731914683352*^9}, {3.544731986819441*^9, 3.544732326134471*^9}, {
   3.5447324149799957`*^9, 3.5447325538420773`*^9}, {3.544732595342805*^9, 
   3.5447326079771643`*^9}, {3.54473265663486*^9, 3.544732660712317*^9}, {
   3.544732817547902*^9, 3.544732884054906*^9}, {3.54473293227448*^9, 
   3.54473294224436*^9}, {3.544733073358255*^9, 3.544733108348692*^9}, {
   3.544733141716096*^9, 3.5447332700099916`*^9}, {3.5447336096615543`*^9, 
   3.544733651052928*^9}, {3.544733691736003*^9, 3.544733716099519*^9}, {
   3.5447988171240673`*^9, 3.544798841086925*^9}, {3.544798882761922*^9, 
   3.544798907503359*^9}, {3.544799154680848*^9, 3.544799257494094*^9}, {
   3.544799324298863*^9, 3.544799377648815*^9}, {3.544799412301145*^9, 
   3.544799571691469*^9}, {3.5447996156745768`*^9, 3.544799721804842*^9}, {
   3.544799759776585*^9, 3.544799822114973*^9}, {3.544799933145164*^9, 
   3.544799946996296*^9}, {3.544799978633395*^9, 3.5448000403364897`*^9}, {
   3.5448001590159197`*^9, 3.544800214377301*^9}, {3.544800288193282*^9, 
   3.544800490440977*^9}, {3.5448005461577272`*^9, 3.54480055109833*^9}, {
   3.544802070260771*^9, 3.544802076475197*^9}, {3.544802204683014*^9, 
   3.544802205336591*^9}, {3.5448023177349787`*^9, 3.544802323293634*^9}, {
   3.5448024054447393`*^9, 3.544802413771337*^9}, {3.544802448275498*^9, 
   3.544802519872225*^9}, {3.544802681941112*^9, 3.544802759644532*^9}, {
   3.5448028319563026`*^9, 3.544802977808525*^9}, {3.544803199328965*^9, 
   3.544803205914035*^9}, {3.544803935774023*^9, 3.544804032106015*^9}, {
   3.544804083084134*^9, 3.5448040962340593`*^9}, {3.544804164102154*^9, 
   3.5448042166796227`*^9}, {3.544804248614504*^9, 3.544804425794601*^9}, {
   3.5448082276714983`*^9, 3.5448082431185303`*^9}, {3.544808496243113*^9, 
   3.544808523274575*^9}, {3.544808573350655*^9, 3.544808620512082*^9}, {
   3.5448086714725647`*^9, 3.544808682470654*^9}, {3.544808733033886*^9, 
   3.54480877383665*^9}, 3.544808887215824*^9, {3.544809000868226*^9, 
   3.544809044000719*^9}, {3.5448092223816853`*^9, 3.544809303596088*^9}, {
   3.5448093747324266`*^9, 3.5448093828000107`*^9}, {3.544823812842052*^9, 
   3.544823843389748*^9}, {3.5448238836377373`*^9, 3.5448238928411703`*^9}, {
   3.544823965244624*^9, 3.544823992889365*^9}, {3.544824047837223*^9, 
   3.5448240517006693`*^9}, {3.544825034574088*^9, 3.5448250900715857`*^9}, {
   3.544825251438686*^9, 3.54482527236478*^9}, {3.544825465222299*^9, 
   3.544825588181649*^9}, {3.544825632443205*^9, 3.544825670010198*^9}, {
   3.544825753542473*^9, 3.544825870039019*^9}, {3.544826026068857*^9, 
   3.544826131709296*^9}, {3.5448263266261463`*^9, 3.544826364101572*^9}, {
   3.544826425767971*^9, 3.544826429041151*^9}, {3.544826584771298*^9, 
   3.544826681325489*^9}, {3.5448284502539167`*^9, 3.5448285532946653`*^9}, {
   3.544828584915968*^9, 3.544828591201741*^9}, {3.544828646315957*^9, 
   3.544828790366802*^9}, {3.5448288847703867`*^9, 3.5448290640211782`*^9}, {
   3.544829156563656*^9, 3.5448292943814907`*^9}, {3.544829800675335*^9, 
   3.5448299385460873`*^9}, {3.544829975820504*^9, 3.5448300876243668`*^9}, {
   3.544830258942531*^9, 3.5448303178350163`*^9}, {3.544830515428342*^9, 
   3.5448306328396053`*^9}, {3.544830753731956*^9, 3.544830787071309*^9}, {
   3.544830859209157*^9, 3.544830873031108*^9}, {3.544831817025002*^9, 
   3.5448318232322607`*^9}, {3.544832126437045*^9, 3.5448321470202227`*^9}, {
   3.5448322284831*^9, 3.544832244676903*^9}, {3.544832639621092*^9, 
   3.54483273503306*^9}, {3.544882982185899*^9, 3.544882989824316*^9}, {
   3.544883163779448*^9, 3.544883331163239*^9}, {3.544883374899366*^9, 
   3.5448834296094837`*^9}, {3.544885466998475*^9, 3.544885475462099*^9}, {
   3.544885645009406*^9, 3.544885657713894*^9}, {3.544885854620133*^9, 
   3.544885876927491*^9}, {3.544959182598674*^9, 3.544959236473694*^9}, {
   3.544966651737955*^9, 3.544966652116729*^9}, {3.5449666858496723`*^9, 
   3.544966709754876*^9}, {3.544967118093371*^9, 3.544967187821467*^9}, {
   3.54496730164196*^9, 3.544967321716268*^9}, {3.544967367872718*^9, 
   3.544967410409315*^9}, {3.5449675008693447`*^9, 3.544967507160289*^9}, {
   3.5449680285730143`*^9, 3.5449680680374327`*^9}, {3.544968108767639*^9, 
   3.5449682054318237`*^9}, {3.5449682696603518`*^9, 3.544968287203045*^9}, {
   3.544968761883308*^9, 3.5449688317377996`*^9}, {3.544968872062956*^9, 
   3.54496891167765*^9}, {3.544969361970313*^9, 3.5449693700261717`*^9}, {
   3.54499803502186*^9, 3.544998108386876*^9}, {3.544998140833598*^9, 
   3.544998302744825*^9}, {3.5449983439443693`*^9, 3.544998410569104*^9}, {
   3.544998449505397*^9, 3.544998668307025*^9}, {3.5450041915724792`*^9, 
   3.5450042420524597`*^9}, {3.5450045659436407`*^9, 3.545004988394887*^9}, {
   3.545005025021761*^9, 3.545005031628121*^9}, {3.545005078661703*^9, 
   3.545005087860943*^9}, {3.54500533965779*^9, 3.545005370113676*^9}, {
   3.5450054229708033`*^9, 3.545005461507559*^9}, {3.545005523981326*^9, 
   3.545005575035994*^9}, {3.545005609934711*^9, 3.5450056338938026`*^9}, {
   3.5450700849689703`*^9, 3.5450700881811543`*^9}, {3.5450702017256484`*^9, 
   3.545070251805513*^9}, {3.5450702940899315`*^9, 3.5450703587846317`*^9}, {
   3.545070396955815*^9, 3.545070397834865*^9}, 3.545071744788906*^9, {
   3.545071832706935*^9, 3.5450718924203506`*^9}, {3.5450720116201687`*^9, 
   3.545072027089053*^9}, {3.5450721977878165`*^9, 3.545072201893051*^9}, 
   3.545132762115596*^9, {3.545157111273613*^9, 3.5451571202919397`*^9}, 
   3.54518536773376*^9, {3.545241167262097*^9, 3.545241559694396*^9}, {
   3.54524161553512*^9, 3.545241636804878*^9}, {3.545241675463269*^9, 
   3.545241874861189*^9}, {3.545241909797742*^9, 3.5452419529541283`*^9}, {
   3.545242069552761*^9, 3.5452420703285503`*^9}, {3.545242140194744*^9, 
   3.545242143184325*^9}, {3.545242530273447*^9, 3.5452425381912327`*^9}, {
   3.545242585788083*^9, 3.545242618590304*^9}, {3.545242858055086*^9, 
   3.545242896860327*^9}, {3.545243013723702*^9, 3.5452430396208076`*^9}, {
   3.5452431992632732`*^9, 3.54524324930182*^9}, 3.545243729434333*^9, 
   3.5453916975407667`*^9, {3.5453917662810097`*^9, 3.545391949156776*^9}, {
   3.5455005316118*^9, 3.545500580357588*^9}, {3.545500629767414*^9, 
   3.545500653924796*^9}, {3.5455010963931036`*^9, 3.5455011646100054`*^9}, {
   3.545501431245256*^9, 3.5455016150807705`*^9}, {3.5455016695198846`*^9, 
   3.5455016719990263`*^9}, {3.5455017686005516`*^9, 3.545501912516783*^9}, {
   3.545502007012188*^9, 3.54550201543867*^9}, {3.545502066853611*^9, 
   3.545502426104159*^9}, {3.5455025098319473`*^9, 3.5455025103339767`*^9}, {
   3.5455026295817966`*^9, 3.5455026669539347`*^9}, {3.545502724775242*^9, 
   3.5455028498513956`*^9}, {3.5455030743552365`*^9, 
   3.5455032845942616`*^9}, {3.5455033279767427`*^9, 3.545503404136099*^9}, {
   3.545649501402816*^9, 3.5456495779605513`*^9}, {3.545649732327619*^9, 
   3.545649733680684*^9}, {3.545649939939603*^9, 3.545649941542549*^9}, {
   3.545649999265915*^9, 3.545650010955574*^9}, {3.545650324737911*^9, 
   3.5456506451744547`*^9}, {3.5456506808840714`*^9, 3.545650732726404*^9}, {
   3.5456507823061943`*^9, 3.545650823594697*^9}, {3.5456508861409407`*^9, 
   3.545650893809823*^9}, {3.545650942837595*^9, 3.5456510899873247`*^9}, {
   3.545651120303458*^9, 3.545651257431912*^9}, {3.545651296446041*^9, 
   3.545651400658573*^9}, {3.545651530291657*^9, 3.54565161672125*^9}, {
   3.545651685237431*^9, 3.545651754390254*^9}, {3.545651795062045*^9, 
   3.5456519018812103`*^9}, {3.54565193477721*^9, 3.545652106249055*^9}, {
   3.545654829265703*^9, 3.545655158240787*^9}, {3.545655190381781*^9, 
   3.545655258761519*^9}, {3.545655317406992*^9, 3.5456554710360193`*^9}, {
   3.545655535142995*^9, 3.545655541155857*^9}, {3.545655591551656*^9, 
   3.545655597095543*^9}, {3.545655676179525*^9, 3.545655679453773*^9}, {
   3.545655719723547*^9, 3.545655822686346*^9}, {3.545655877089429*^9, 
   3.545655918737398*^9}, {3.545656005543882*^9, 3.5456560873776484`*^9}, {
   3.545656169128302*^9, 3.545656201089127*^9}, {3.545656266914322*^9, 
   3.545656280429275*^9}, {3.545656326437292*^9, 3.545656345718544*^9}, {
   3.545656401310463*^9, 3.545656404673856*^9}, {3.54565660419963*^9, 
   3.545656627346064*^9}, {3.545656671708899*^9, 3.545656674802466*^9}, {
   3.545656796563324*^9, 3.545656866847234*^9}, {3.5456568973029547`*^9, 
   3.545657003861196*^9}, 3.5456570488261147`*^9, {3.5456571535377703`*^9, 
   3.545657194604124*^9}, {3.545657236915749*^9, 3.545657243739709*^9}, {
   3.545657280867181*^9, 3.545657284399103*^9}, {3.545657326286914*^9, 
   3.545657398180262*^9}, {3.5456574459657393`*^9, 3.5456574811826982`*^9}, {
   3.545657512943489*^9, 3.5456575501663923`*^9}, {3.545657640232913*^9, 
   3.545657689351959*^9}, {3.5456577234441338`*^9, 3.54565772706988*^9}, {
   3.545657867883278*^9, 3.545657909135581*^9}, {3.545658551586563*^9, 
   3.5456585724934673`*^9}, {3.545658618256735*^9, 3.545658620912218*^9}, {
   3.545659738082665*^9, 3.545659842487424*^9}, {3.545659873031658*^9, 
   3.545660018590992*^9}, {3.545660117670068*^9, 3.5456604673492203`*^9}, {
   3.5456619301797457`*^9, 3.5456619377649517`*^9}, {3.545661971088789*^9, 
   3.5456620066448517`*^9}, {3.545662081642323*^9, 3.5456620906661053`*^9}, {
   3.545662176126096*^9, 3.545662177384774*^9}, {3.545662390370165*^9, 
   3.545662426786436*^9}, {3.5456624628576527`*^9, 3.545662469844698*^9}, {
   3.545662511456739*^9, 3.545662546345636*^9}, 3.545662592961624*^9, {
   3.545662699981805*^9, 3.545662704288629*^9}, {3.545662864172303*^9, 
   3.545663066070095*^9}, {3.545663109979403*^9, 3.545663374298492*^9}, {
   3.545663431071187*^9, 3.545663436062496*^9}, 3.545663475203717*^9, {
   3.5456636065239363`*^9, 3.545663614002163*^9}, {3.545663671198966*^9, 
   3.545663693714389*^9}, 3.545663758406089*^9, {3.545663795749156*^9, 
   3.54566380333226*^9}, {3.545663835850457*^9, 3.545663860562149*^9}, {
   3.545834308273981*^9, 3.545834612038068*^9}, {3.546007198030195*^9, 
   3.5460072813854837`*^9}, {3.546016246600863*^9, 3.5460162625682707`*^9}, {
   3.54601641934857*^9, 3.546016425922179*^9}, {3.546016481747164*^9, 
   3.546016483784333*^9}, {3.546016571086508*^9, 3.546016660874221*^9}, {
   3.5460169680585546`*^9, 3.546017005938848*^9}, {3.5460175543131237`*^9, 
   3.546017616924458*^9}, {3.546017657745035*^9, 3.54601767134343*^9}, {
   3.54601790375711*^9, 3.5460179046072273`*^9}, {3.546017962603869*^9, 
   3.546017963848092*^9}, {3.546018617514853*^9, 3.54601861770081*^9}, {
   3.5460186865580883`*^9, 3.546018778327265*^9}, 3.546018879622398*^9, {
   3.5460296450653133`*^9, 3.546029653013721*^9}, {3.546029778508505*^9, 
   3.546030227930011*^9}, {3.546030393158927*^9, 3.5460303969249563`*^9}, {
   3.546030893610528*^9, 3.546031003720441*^9}, {3.546031697585454*^9, 
   3.546031716637548*^9}, {3.5460318549844837`*^9, 3.546031947131857*^9}, {
   3.5460344176494637`*^9, 3.5460344183172283`*^9}, {3.546034467018495*^9, 
   3.546034499353898*^9}, {3.54603502025158*^9, 3.54603502092487*^9}, 
   3.5460358637050543`*^9, {3.546038168269825*^9, 3.546038248485003*^9}, {
   3.54603863943123*^9, 3.546038693179248*^9}, {3.546088695249915*^9, 
   3.546088731580204*^9}, {3.5460890629719257`*^9, 3.546089215812169*^9}, {
   3.546092190330771*^9, 3.5460922425678253`*^9}, {3.546093300292901*^9, 
   3.5460933122451277`*^9}, {3.546093848833501*^9, 3.5460938534052877`*^9}, {
   3.5460942741779747`*^9, 3.546094278088238*^9}, {3.546094603193169*^9, 
   3.54609460541116*^9}, {3.5461018598410873`*^9, 3.546102009528167*^9}, {
   3.546187984794819*^9, 3.546187985799611*^9}, {3.546201776039287*^9, 
   3.546201800912155*^9}, {3.5470474461211567`*^9, 3.5470474977269983`*^9}, {
   3.547048262753722*^9, 3.547048265167637*^9}, {3.547061312410713*^9, 
   3.547061314726864*^9}, 3.547061378665544*^9, {3.5470614232720547`*^9, 
   3.547061438309074*^9}, {3.547061481341037*^9, 3.5470615306542664`*^9}, {
   3.54706156745341*^9, 3.547061606928578*^9}, {3.547061801403542*^9, 
   3.547061808046768*^9}, {3.547061840366571*^9, 3.547061872276286*^9}, {
   3.547061907021678*^9, 3.547061912412476*^9}, {3.547062013658325*^9, 
   3.5470620576281443`*^9}, {3.547062094830739*^9, 3.547062252561825*^9}, {
   3.547062285406509*^9, 3.547062294109501*^9}, {3.5470623439860363`*^9, 
   3.54706234728093*^9}, {3.5470641426300993`*^9, 3.547064143283408*^9}, {
   3.547064239038537*^9, 3.5470643886135263`*^9}, {3.5470644927977743`*^9, 
   3.547064545866729*^9}, {3.547085353923485*^9, 3.547085356695772*^9}, {
   3.5470854142338657`*^9, 3.54708541877395*^9}, {3.5470875489265013`*^9, 
   3.547087562063663*^9}, 3.547130598510806*^9, {3.547131078042326*^9, 
   3.547131087143757*^9}, {3.547131673250574*^9, 3.547131683048911*^9}, 
   3.547131789335585*^9, {3.5471318382848387`*^9, 3.5471318400637693`*^9}, {
   3.54764784055091*^9, 3.547647843798092*^9}, {3.547647937094366*^9, 
   3.547647973305051*^9}, 3.5476480142735987`*^9, {3.547648091084937*^9, 
   3.5476480980543222`*^9}, {3.548004577179453*^9, 3.548004611493518*^9}, {
   3.548442199801875*^9, 3.548442227300071*^9}, {3.548444114375485*^9, 
   3.54844412615342*^9}, {3.575234711544373*^9, 3.575234712895487*^9}, {
   3.584830117181656*^9, 3.584830117706465*^9}, {3.705712951166072*^9, 
   3.705712952364656*^9}, {3.7059476707485228`*^9, 3.705947677502981*^9}, {
   3.7060245065629663`*^9, 3.706024537681521*^9}, {3.706024668412981*^9, 
   3.706024729044085*^9}, {3.706024983050269*^9, 
   3.706024991443005*^9}},ExpressionUUID->"8057f826-1732-4f89-af8a-\
59dbb90f629b"]
}, Closed]],

Cell[CellGroupData[{

Cell["generateCelleratorWalledDiffusionReactions", "Subsubsection",
 CellChangeTimes->{{3.5460180584425983`*^9, 
  3.546018065320939*^9}},ExpressionUUID->"ede74a8d-954d-43ea-b143-\
977816ab2a85"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"generateCelleratorWalledDiffusionReactions", "[", 
     RowBox[{
     "c_", ",", " ", "e_", ",", " ", "eused_", ",", " ", "diffusingSpecies_", 
      ",", " ", "\[IndentingNewLine]", "allEdgesBetween_", ",", " ", 
      "allneighbors_", ",", " ", "outercells_", ",", "  ", "outeredges_", ",",
       " ", "edgeVariable_", ",", " ", "areaVariable_", ",", " ", "x_", ",", 
      " ", "y_", ",", " ", "edgeLengths_", ",", " ", "aij_", ",", " ", 
      "\[IndentingNewLine]", "debug_"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "diff", ",", "DR", ",", "DRW", ",", " ", "DRWW", ",", "DRWWC", ",", 
        " ", "diffusionReactions", ",", "diffusionWWReactions", ",", 
        "edgeBetween", ",", "l", ",", "beta", ",", "Y", ",", "difSpec", ",", 
        "temp", ",", "diffData", ",", "func", ",", "  ", "\[Beta]in", ",", 
        "\[Beta]out", ",", "\[Beta]wall", ",", " ", "fin", ",", " ", "fout", 
        ",", " ", "fwall", ",", "intesectingEdges", ",", " ", 
        "diffusionOEReactions", ",", " ", "neighborSharingEdge", ",", " ", 
        "drow", ",", " ", "DROW", ",", " ", "nxtra", ",", "dPrint", ",", " ", 
        "neighbors", ",", " ", "getTransferFunction", ",", "ne", ",", " ", 
        "n", ",", " ", "neused", ",", "eflags", ",", "cellNumbers", ",", 
        "toDynamicNumberRules", ",", "toStaticNumberRules", ",", 
        "cellIndices"}], "}"}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"diff", "=", 
        RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dPrint", "[", "u___", "]"}], ":=", 
        RowBox[{"If", "[", 
         RowBox[{"debug", ",", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<generateCelleratorWalledDiffusionReactions: \>\"", ",", "u"}],
            "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<c=\>\"", ",", "c"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "diffusingSpecies", "]"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ne", " ", "=", " ", 
           RowBox[{"Length", "[", "e", "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"n", " ", "=", " ", 
           RowBox[{"Length", "[", "c", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"eflags", " ", "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{"eused", ",", "#"}], "]"}], "&"}], "/@", 
            RowBox[{"Range", "[", "ne", "]"}]}]}], ";", "  ", 
          "\[IndentingNewLine]", 
          RowBox[{"neused", " ", "=", " ", 
           RowBox[{"Length", "[", "eused", "]"}]}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"cellNumbers", "=", 
           RowBox[{"First", "/@", "c"}]}], ";", 
          RowBox[{"toDynamicNumberRules", "=", 
           RowBox[{"MapThread", "[", 
            RowBox[{"Rule", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Range", "[", 
                RowBox[{"Length", "[", "c", "]"}], "]"}], ",", 
               "cellNumbers"}], "}"}]}], "]"}]}], ";", 
          RowBox[{"toStaticNumberRules", "=", 
           RowBox[{"Reverse", "/@", "toDynamicNumberRules"}]}], ";", 
          RowBox[{"dPrint", "[", 
           RowBox[{
           "\"\<toDynamicNumberRules: \>\"", ",", "toDynamicNumberRules"}], 
           "]"}], ";", 
          RowBox[{"dPrint", "[", 
           RowBox[{
           "\"\<toStaticNumberRules: \>\"", ",", "toStaticNumberRules"}], 
           "]"}], ";", "\n", "\[IndentingNewLine]", 
          RowBox[{"cellIndices", "=", 
           RowBox[{"Last", "/@", "c"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"neighbors", "[", "p_", "]"}], ":=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"allneighbors", "[", 
              RowBox[{"[", 
               RowBox[{"p", "/.", "toStaticNumberRules"}], "]"}], "]"}], 
             ")"}], "/.", "toDynamicNumberRules"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"getTransferFunction", "[", "stuff_", "]"}], ":=", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"SameQ", "[", 
              RowBox[{
               RowBox[{"Head", "[", "stuff", "]"}], ",", " ", "Function"}], 
              "]"}], ",", "stuff", ",", 
             RowBox[{
              RowBox[{"Evaluate", "[", "stuff", "]"}], "&"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"neighborSharingEdge", "[", 
            RowBox[{"cellnum_", ",", "edgenum_"}], "]"}], ":=", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", "staticindex", "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"staticindex", "=", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "allEdgesBetween", "]"}], ",", " ", 
                  "edgenum"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              
              RowBox[{
               RowBox[{"Complement", "[", 
                RowBox[{
                 RowBox[{"staticindex", "/.", "toDynamicNumberRules"}], ",", 
                 " ", 
                 RowBox[{"{", "cellnum", "}"}]}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
            "]"}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "artificial", " ", "zeroth", " ", "compartment", " ", "for", " ", 
            "\"\<outside\>\""}], " ", "*)"}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"edgeBetween", "[", 
            RowBox[{"p_", ",", "0"}], "]"}], ":=", "  ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p", "/.", "c"}], ")"}], "\[Intersection]", 
              "outeredges"}], ")"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"edgeBetween", "[", 
            RowBox[{"p_", ",", "q_"}], "]"}], ":=", 
           RowBox[{"allEdgesBetween", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"p", "/.", "toStaticNumberRules"}], ",", 
              RowBox[{"q", "/.", "toStaticNumberRules"}]}], "]"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"l", "[", 
            RowBox[{"p_", ",", "q_"}], "]"}], ":=", 
           RowBox[{
            RowBox[{"edgeVariable", "[", 
             RowBox[{"edgeBetween", "[", 
              RowBox[{"p", ",", "q"}], "]"}], "]"}], "[", "Global`t", "]"}]}],
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"X", " ", "\[RightArrowLeftArrow]", " ", 
            RowBox[{
            "\[EmptySet]", " ", "for", " ", "Cell", " ", "to", " ", 
             "Adjacent", " ", "Wall", " ", "Compartment"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"change", " ", "of", " ", "cell", " ", "concentration"}], 
           " ", "*)"}], " ", "\[IndentingNewLine]", " ", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"DR", "[", 
            RowBox[{"X_", ",", " ", "Fout_", ",", " ", "Fin_", ",", " ", 
             RowBox[{"{", 
              RowBox[{"p_", ",", "q_"}], "}"}]}], "]"}], ":=", 
           RowBox[{"Module", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "edge", ",", " ", "reaction", ",", " ", "forward", ",", " ", 
               "reverse", ",", " ", "dr"}], "}"}], ",", " ", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"edge", "=", 
               RowBox[{"edgeBetween", "[", 
                RowBox[{"p", ",", "q"}], "]"}]}], ";", "\[IndentingNewLine]", 
              
              RowBox[{"dPrint", "[", 
               RowBox[{"\"\<DBG: DR: , edge=\>\"", ",", " ", "edge"}], "]"}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"reaction", "=", 
               RowBox[{
                RowBox[{"X", "[", "p", "]"}], "\[RightArrowLeftArrow]", 
                "Global`\[EmptySet]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"forward", " ", "=", " ", 
               RowBox[{
                RowBox[{"(", " ", 
                 RowBox[{
                  RowBox[{"Fout", "[", 
                   RowBox[{"p", ",", "q", ",", "edge"}], "]"}], " ", "*", 
                  RowBox[{
                   RowBox[{"edgeVariable", "[", "edge", "]"}], "[", 
                   "Global`t", "]"}]}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"areaVariable", "[", "p", "]"}], "[", "Global`t", 
                  "]"}], ")"}]}]}], ";", " ", "\[IndentingNewLine]", 
              RowBox[{"reverse", " ", "=", " ", 
               RowBox[{
                RowBox[{"(", " ", 
                 RowBox[{
                  RowBox[{"Fin", "[", 
                   RowBox[{"p", ",", "q", ",", " ", "edge"}], "]"}], " ", "*",
                   " ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"edgeVariable", "[", "edge", "]"}], "[", 
                    "Global`t", "]"}], "/", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"areaVariable", "[", "p", "]"}], "[", "Global`t", 
                    "]"}], ")"}]}]}], ")"}], " ", 
                RowBox[{
                 RowBox[{"X", "[", 
                  RowBox[{"p", ",", "edge"}], "]"}], "[", "Global`t", 
                 "]"}]}]}], ";", " ", "\[IndentingNewLine]", 
              RowBox[{"dr", "=", 
               RowBox[{"{", 
                RowBox[{"reaction", ",", "forward", ",", " ", "reverse"}], 
                "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"dPrint", " ", "[", 
               RowBox[{"\"\<DBG: forward: \>\"", ",", " ", "forward"}], "]"}],
               ";", " ", "\[IndentingNewLine]", 
              RowBox[{"dPrint", " ", "[", 
               RowBox[{"\"\<DBG: reverse: \>\"", ",", " ", "reverse"}], "]"}],
               ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"dPrint", "[", 
               RowBox[{"\"\<DBG: dr: \>\"", ",", " ", "dr"}], "]"}], ";", " ",
               "\[IndentingNewLine]", 
              RowBox[{"Return", "[", "dr", "]"}]}]}], "\[IndentingNewLine]", 
            "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"change", " ", "of", " ", "wall", " ", "concentration"}], 
           "*)"}], " ", "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"DRW", "[", 
            RowBox[{"X_", ",", " ", "Fout_", ",", " ", "Fin_", ",", " ", 
             RowBox[{"{", 
              RowBox[{"p_", ",", "q_"}], "}"}]}], "]"}], ":=", 
           "\[IndentingNewLine]", 
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"edge", "=", 
               RowBox[{"edgeBetween", "[", 
                RowBox[{"p", ",", "q"}], "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"X", "[", 
                 RowBox[{"p", ",", " ", "edge"}], "]"}], 
                "\[RightArrowLeftArrow]", "Global`\[EmptySet]"}], ",", " ", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Fin", "[", 
                 RowBox[{"p", ",", "q", ",", " ", "edge"}], "]"}], " ", "/", 
                RowBox[{"(", "aij", ")"}]}], "  ", ",", " ", 
               "\[IndentingNewLine]", " ", 
               RowBox[{
                RowBox[{"Fout", "[", 
                 RowBox[{"p", ",", "q", ",", " ", "edge"}], "]"}], "  ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"X", "[", "p", "]"}], "[", "Global`t", "]"}], "/", 
                 "aij"}]}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Wall", " ", "to", " ", "Wall", " ", "Diffusion", " ", 
            RowBox[{"(", 
             RowBox[{"except", " ", "for", " ", "corners"}], ")"}]}], " ", 
           "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"DRWW", "[", 
            RowBox[{"X_", ",", "  ", "FWall_", ",", " ", 
             RowBox[{"{", 
              RowBox[{"cell1_", ",", " ", "cell2_"}], "}"}]}], "]"}], ":=", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", "edge", "}"}], ",", " ", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"edge", " ", "=", " ", 
               RowBox[{"edgeBetween", "[", 
                RowBox[{"cell1", ",", "cell2"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"X", "[", 
                  RowBox[{"cell1", ",", "edge"}], "]"}], 
                 "\[RightArrowLeftArrow]", "Global`\[EmptySet]"}], ",", 
                "\[IndentingNewLine]", " ", 
                RowBox[{
                 RowBox[{"FWall", "[", 
                  RowBox[{"cell1", ",", "cell2", ",", " ", "edge"}], "]"}], 
                 "/", "aij"}], ",", "  ", 
                RowBox[{
                 RowBox[{"FWall", "[", 
                  RowBox[{"cell2", ",", "cell1", ",", "edge"}], "]"}], " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"X", "[", 
                    RowBox[{"cell2", ",", " ", "edge"}], "]"}], "[", 
                   "Global`t", "]"}], "/", "aij"}]}]}], "}"}]}]}], 
            "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Wall", " ", "to", " ", "Wall", " ", "Diffusion", " ", 
            RowBox[{"(", 
             RowBox[{"at", " ", "Corners"}], ")"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "Only", " ", "allow", " ", "diffusion", " ", "between", " ", 
            "wall", " ", "components", " ", "of", " ", "same", " ", "cell"}], 
           " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"DRWWC", "[", 
            RowBox[{"X_", ",", " ", "FWall_", ",", " ", 
             RowBox[{"{", 
              RowBox[{"e1_", ",", "e2_"}], "}"}]}], "]"}], ":=", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "p", ",", "q", ",", "r", ",", "s", ",", " ", "E1", ",", " ", 
               "E2", ",", " ", "v1", ",", "v2", ",", " ", "da", ",", " ", 
               "cell1", ",", " ", "cell2", ",", " ", "cell3", ",", " ", 
               "cell4", ",", "commonCell", ",", " ", "theEdge", ",", 
               "reaction", ",", "reaction2", ",", "c1", ",", "c2", ",", "c3", 
               ",", "c4", ",", "e1cells", ",", "e2cells", ",", " ", 
               "interactionWidth", ",", "wall1Area", ",", "wall2Area", ",", 
               " ", "result"}], "}"}], ",", " ", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"dPrint", "[", 
               RowBox[{"\"\<DRWWC e1,e2=\>\"", ",", " ", 
                RowBox[{"{", 
                 RowBox[{"e1", ",", "e2"}], "}"}]}], "]"}], ";", " ", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"p", ",", "q"}], "}"}], " ", "=", " ", 
               RowBox[{"e", "[", 
                RowBox[{"[", "e1", "]"}], "]"}]}], ";", " ", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"r", ",", "s"}], "}"}], " ", "=", " ", 
               RowBox[{"e", "[", 
                RowBox[{"[", "e2", "]"}], "]"}]}], ";", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"dPrint", "[", 
               RowBox[{"\"\<DRWWC {p,q},{r,s}=\>\"", ",", " ", 
                RowBox[{"{", 
                 RowBox[{"p", ",", "q"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"r", ",", "s"}], "}"}]}], "]"}], ";", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"E1", " ", "=", " ", 
               RowBox[{
                RowBox[{"edgeVariable", "[", "e1", "]"}], "[", "Global`t", 
                "]"}]}], ";", " ", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{"edgeLengths", "[", 
                 RowBox[{"[", "e1", "]"}], "]"}], ";"}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"E2", " ", "=", " ", 
               RowBox[{
                RowBox[{"edgeVariable", "[", "e2", "]"}], "[", "Global`t", 
                "]"}]}], ";", " ", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{"edgeLengths", "[", 
                 RowBox[{"[", "e2", "]"}], "]"}], ";"}], " ", "*)"}], " ", 
              "\[IndentingNewLine]", 
              RowBox[{"dPrint", "[", 
               RowBox[{
               "\"\<DRWWC E1,E2=\>\"", ",", " ", "E1", ",", "\"\<,\>\"", ",", 
                " ", "E2"}], "]"}], ";", " ", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"v1", " ", "=", " ", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"v", "[", 
                    RowBox[{"[", "p", "]"}], "]"}], "-", 
                    RowBox[{"v", "[", 
                    RowBox[{"[", "q", "]"}], "]"}]}], ")"}], "/", "E1"}]}], 
                ";", " ", 
                RowBox[{"v2", " ", "=", " ", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"v", "[", 
                    RowBox[{"[", "r", "]"}], "]"}], " ", "-", 
                    RowBox[{"v", "[", 
                    RowBox[{"[", "s", "]"}], "]"}]}], ")"}], "/", "E2"}]}], 
                ";"}], " ", "*)"}], "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{"Block", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"vp", ",", "vq", ",", "vr", ",", "vs"}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"vp", "=", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"x", "[", "p", "]"}], "[", "Global`t", "]"}], ",", 
                    RowBox[{
                    RowBox[{"y", "[", "p", "]"}], "[", "Global`t", "]"}]}], 
                   "}"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"vq", "=", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"x", "[", "q", "]"}], "[", "Global`t", "]"}], ",", 
                    RowBox[{
                    RowBox[{"y", "[", "q", "]"}], "[", "Global`t", "]"}]}], 
                   "}"}]}], ";", " ", "\[IndentingNewLine]", 
                 RowBox[{"vr", "=", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"x", "[", "r", "]"}], "[", "Global`t", "]"}], ",", 
                    RowBox[{
                    RowBox[{"y", "[", "r", "]"}], "[", "Global`t", "]"}]}], 
                   "}"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"vs", "=", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"x", "[", "s", "]"}], "[", "Global`t", "]"}], ",", 
                    RowBox[{
                    RowBox[{"y", "[", "s", "]"}], "[", "Global`t", "]"}]}], 
                   "}"}]}], ";", " ", "\[IndentingNewLine]", 
                 RowBox[{"v1", "=", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"vp", "-", "vq"}], ")"}], "/", "E1"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"v2", "=", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"vr", "-", "vs"}], ")"}], "/", "E2"}]}], ";"}]}], 
               " ", "\[IndentingNewLine]", 
               RowBox[{"(*", " ", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"v1", " ", "=", " ", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"V", "[", "p", "]"}], "[", "Global`t", "]"}], "-", 
                    RowBox[{
                    RowBox[{"V", "[", "q", "]"}], "[", "Global`t", "]"}]}], 
                    ")"}], "/", "E1"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"v2", " ", "=", " ", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"V", "[", "r", "]"}], "[", "Global`t", "]"}], " ",
                     "-", 
                    RowBox[{
                    RowBox[{"V", "[", "s", "]"}], "[", "Global`t", "]"}]}], 
                    ")"}], "/", "E2"}]}], ";"}], "*)"}], 
               "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{"Either", " ", "r"}], "=", 
                RowBox[{
                 RowBox[{"q", " ", "or", " ", "r"}], "=", 
                 RowBox[{
                  RowBox[{"p", " ", "or", " ", "s"}], "=", 
                  RowBox[{
                   RowBox[{"q", " ", "or", " ", "s"}], "=", "p"}]}]}]}], " ", 
               "*)"}], "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{
               "Want", " ", "vectors", " ", "to", " ", "either", " ", "start",
                 " ", "at", " ", "same", " ", "point", " ", "or", " ", "end", 
                " ", "at", " ", "same", " ", "point"}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"r", "\[Equal]", "q"}], " ", "||", " ", 
                 RowBox[{"s", "\[Equal]", "p"}]}], ",", " ", 
                RowBox[{"v2", "=", 
                 RowBox[{"-", "v2"}]}]}], "]"}], ";", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"p", ",", "q"}], "}"}], "\[Equal]", 
                  RowBox[{"{", 
                   RowBox[{"r", ",", "s"}], "}"}]}], " ", "||", " ", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"p", ",", "q"}], "}"}], "\[Equal]", 
                  RowBox[{"{", 
                   RowBox[{"s", ",", "r"}], "}"}]}]}], ",", " ", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{"\"\<Error: DRWWC: \>\"", ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"p", ",", "q"}], "}"}], ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"r", ",", " ", "s"}], "}"}]}], "]"}], ";", " ", 
                 RowBox[{"Return", "[", "Infinity", "]"}]}]}], "]"}], ";", 
              " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{"da", " ", "is", " ", "the", " ", "ratio", " ", 
                RowBox[{"d", "/", "a"}], " ", 
                RowBox[{"(", 
                 RowBox[{"diagonal", "/", "altitude"}], ")"}]}], " ", "*)"}], 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"interactionWidth", " ", "=", " ", 
               RowBox[{"aij", "/", 
                RowBox[{"Sqrt", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1.0", "-", 
                    RowBox[{"v1", ".", "v2"}]}], ")"}], "/", "2.0"}], 
                 "]"}]}]}], ";", " ", "\[IndentingNewLine]", 
              RowBox[{"wall1Area", "=", 
               RowBox[{"aij", "*", "E1"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"wall2Area", "=", 
               RowBox[{"aij", "*", "E2"}]}], ";", " ", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{"replace", " ", 
                RowBox[{"l", "[", 
                 RowBox[{"p", ",", "q"}], "]"}], " ", "with", " ", "the", " ",
                 "edge", " ", "between", " ", "vertices", " ", "p", " ", 
                "and", " ", "q"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{"outeredges", ",", " ", "e1"}], "]"}], ",", " ", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"cell1", " ", "=", " ", 
                  RowBox[{
                   RowBox[{"Position", "[", 
                    RowBox[{"cellIndices", ",", " ", "e1"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", " ", 
                 "\[IndentingNewLine]", 
                 RowBox[{"cell2", " ", "=", " ", "0"}], ";"}], 
                "\[IndentingNewLine]", ",", " ", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"cell1", ",", " ", "cell2"}], "}"}], " ", "=", " ", 
                 
                 RowBox[{
                  RowBox[{"Position", "[", 
                   RowBox[{
                    RowBox[{"Normal", "[", "allEdgesBetween", "]"}], ",", " ",
                     "e1"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{"outeredges", ",", " ", "e2"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"cell3", " ", "=", " ", 
                  RowBox[{
                   RowBox[{"Position", "[", 
                    RowBox[{"cellIndices", ",", " ", "e2"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", " ", 
                 "\[IndentingNewLine]", 
                 RowBox[{"cell4", " ", "=", " ", "0"}], ";"}], 
                "\[IndentingNewLine]", ",", " ", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"cell3", ",", " ", "cell4"}], "}"}], " ", "=", " ", 
                 
                 RowBox[{
                  RowBox[{"Position", "[", 
                   RowBox[{
                    RowBox[{"Normal", "[", "allEdgesBetween", "]"}], ",", " ",
                     "e2"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"cell1", ",", "cell2", ",", "cell3", ",", "cell4"}], 
                "}"}], "=", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"cell1", ",", "cell2", ",", "cell3", ",", "cell4"}], 
                 "}"}], "/.", "toDynamicNumberRules"}]}], ";", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{"Ignore", " ", "any", " ", "edge"}], "-", 
                RowBox[{
                "edge", " ", "intersection", " ", "that", " ", "is", " ", 
                 "not", " ", "between", " ", "edges", " ", "of", " ", "the", 
                 " ", "same", " ", "cell"}]}], " ", "*)"}], 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"commonCell", "=", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"cell1", ",", "cell2"}], "}"}], "\[Intersection]", 
                RowBox[{"{", 
                 RowBox[{"cell3", ",", "cell4"}], "}"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"dPrint", "[", 
               RowBox[{
               "\"\<DRWWC {cell1,cell2}, {cell3, cell4}=\>\"", ",", " ", 
                RowBox[{"{", 
                 RowBox[{"cell1", ",", "cell2"}], "}"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{"cell3", ",", " ", "cell4"}], "}"}]}], "]"}], ";", 
              "  ", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"commonCell", "\[Equal]", 
                 RowBox[{"{", "0", "}"}]}], ",", " ", 
                RowBox[{
                 RowBox[{
                 "dPrint", "[", "\"\<Edge Cell no common edge.\>\"", "]"}], 
                 ";", "  ", 
                 RowBox[{"Return", "[", 
                  RowBox[{"{", "}"}], "]"}]}]}], "]"}], ";", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"commonCell", "\[Equal]", 
                 RowBox[{"{", "}"}]}], ",", " ", 
                RowBox[{
                 RowBox[{
                 "dPrint", "[", "\"\<Edge Cell no common edge.\>\"", "]"}], 
                 ";", "  ", 
                 RowBox[{"Return", "[", 
                  RowBox[{"{", "}"}], "]"}]}]}], "]"}], ";", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"commonCell", " ", "=", " ", 
               RowBox[{"Complement", "[", 
                RowBox[{"commonCell", ",", " ", 
                 RowBox[{"{", "0", "}"}]}], "]"}]}], ";", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"dPrint", "[", 
               RowBox[{"\"\<commonCell=\>\"", ",", " ", "commonCell"}], "]"}],
               ";", " ", "\[IndentingNewLine]", 
              RowBox[{"commonCell", " ", "=", " ", 
               RowBox[{"commonCell", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{
               "The", " ", "PadRight", " ", "adds", " ", "a", " ", "zero", 
                " ", "if", " ", "there", " ", "is", " ", "only", " ", "one", 
                " ", "cell", " ", "that", " ", "includes", " ", "an", " ", 
                "edge"}], " ", "*)"}], "\[IndentingNewLine]", 
              RowBox[{"e1cells", "=", 
               RowBox[{"PadRight", "[", 
                RowBox[{
                 RowBox[{"First", "/@", 
                  RowBox[{"Position", "[", 
                   RowBox[{"cellIndices", ",", "e1"}], "]"}]}], ",", "2"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"e2cells", "=", 
               RowBox[{"PadRight", "[", 
                RowBox[{
                 RowBox[{"First", "/@", 
                  RowBox[{"Position", "[", 
                   RowBox[{"cellIndices", ",", "e2"}], "]"}]}], ",", "2"}], 
                "]"}]}], ";", " ", "\[IndentingNewLine]", 
              RowBox[{"dPrint", "[", 
               RowBox[{
               "\"\<DRWWC e1cells,e2cells:\>\"", ",", " ", "e1cells", ",", 
                "\"\<,\>\"", ",", "e2cells"}], "]"}], ";", " ", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"dPrint", "[", 
               RowBox[{"\"\<DRWWC cell1,cell2,cell3,cell4=\>\"", ",", " ", 
                RowBox[{"{", 
                 RowBox[{"cell1", ",", "cell2"}], "}"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{"cell3", ",", "cell4"}], "}"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"dPrint", "[", 
               RowBox[{"\"\<DRWWC commonCell=\>\"", ",", " ", "commonCell"}], 
               "]"}], ";", "  ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"dPrint", "[", 
               RowBox[{
               "\"\<DRWWC linteractionWidth=\>\"", ",", " ", 
                "interactionWidth"}], "]"}], ";", " ", "\[IndentingNewLine]", 
              
              RowBox[{"dPrint", "[", 
               RowBox[{"\"\<DRWWC {wall1Area, wall2Area}:\>\"", ",", " ", 
                RowBox[{"{", 
                 RowBox[{"wall1Area", ",", " ", "wall2Area"}], "}"}]}], "]"}],
               ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"c1", ",", "c2"}], "}"}], "=", "e1cells"}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{"reaction", "=", 
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"X", "[", 
                    RowBox[{"commonCell", ",", "e1"}], "]"}], 
                   "\[RightArrowLeftArrow]", "Global`\[EmptySet]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"interactionWidth", " ", "*", " ", 
                    RowBox[{"FWall", "[", 
                    RowBox[{"c1", ",", "c2", ",", "e1"}], "]"}]}], "  ", 
                    ")"}], "/", 
                   RowBox[{"(", "wall1Area", ")"}]}], " ", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"interactionWidth", " ", "*", "  ", 
                    RowBox[{
                    RowBox[{"FWall", "[", 
                    RowBox[{"c1", ",", "c2", ",", "e1"}], "]"}], "/", 
                    RowBox[{"(", "wall1Area", ")"}]}]}], ")"}], " ", 
                   RowBox[{
                    RowBox[{"X", "[", 
                    RowBox[{"commonCell", ",", "e1"}], "]"}], "[", "Global`t",
                     "]"}]}]}], "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"c3", ",", "c4"}], "}"}], "=", "e2cells"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"reaction2", "=", 
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"X", "[", 
                    RowBox[{"commonCell", ",", "e2"}], "]"}], 
                   "\[RightArrowLeftArrow]", "Global`\[EmptySet]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"interactionWidth", " ", "*", " ", 
                    RowBox[{"FWall", "[", 
                    RowBox[{"c3", ",", "c4", ",", "e2"}], "]"}]}], "  ", 
                    ")"}], "/", 
                   RowBox[{"(", "wall2Area", ")"}]}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"interactionWidth", " ", "*", "  ", 
                    RowBox[{
                    RowBox[{"FWall", "[", 
                    RowBox[{"c3", ",", "c4", ",", "e2"}], "]"}], "/", 
                    RowBox[{"(", "wall2Area", ")"}]}]}], " ", ")"}], 
                   RowBox[{
                    RowBox[{"X", "[", 
                    RowBox[{"commonCell", ",", "e2"}], "]"}], "[", "Global`t",
                     "]"}]}]}], "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
              " ", "\[IndentingNewLine]", 
              RowBox[{"result", " ", "=", " ", 
               RowBox[{"{", 
                RowBox[{"reaction", ",", " ", "reaction2"}], "}"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"dPrint", "[", 
               RowBox[{"\"\<DRWWC result=\>\"", ",", " ", "result"}], "]"}], 
              ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"Return", "[", "result", "]"}], ";"}]}], " ", 
            "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "diffusion", " ", "cell", " ", "to", " ", "adjacent", " ", 
            "wall"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"diffusionReactions", "[", 
            RowBox[{
            "X_", " ", ",", "Fout_", ",", " ", "Fin_", ",", " ", "p_"}], 
            "]"}], ":=", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"t1", ",", "t2", ",", "t", ",", " ", "nbrs"}], "}"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"nbrs", " ", "=", " ", 
               RowBox[{"neighbors", "[", "p", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"dPrint", "[", 
               RowBox[{
               "\"\<diffusionReactions: p, nbrs: \>\"", ",", "p", ",", 
                "\"\<;\>\"", ",", "  ", "nbrs"}], "]"}], ";", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"t1", "=", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"DR", "[", 
                  RowBox[{"X", ",", "Fout", ",", " ", "Fin", ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"p", ",", "inbr"}], "}"}]}], "]"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"inbr", ",", " ", "nbrs"}], "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"t2", "=", " ", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"DRW", "[", " ", 
                  RowBox[{"X", ",", " ", "Fout", ",", " ", "Fin", ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"p", ",", " ", "inbr"}], "}"}]}], "]"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"inbr", ",", " ", "nbrs"}], "}"}]}], "]"}]}], ";", 
              " ", "\[IndentingNewLine]", 
              RowBox[{"t", "=", 
               RowBox[{"Join", "[", 
                RowBox[{"t1", ",", "t2"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"dPrint", "[", 
               RowBox[{
               "\"\<dbg: DiffusionReactions: t: \>\"", ",", " ", "t"}], "]"}],
               ";", " ", "\[IndentingNewLine]", 
              RowBox[{"Return", "[", "t", "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}]}], ";", " ", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "also", " ", "need", " ", "to", " ", "diffuse", " ", "from", " ", 
            "cell", " ", "to", " ", "adjacent", " ", "wall", " ", "of", " ", 
            "OUTER", " ", "EDGE", " ", "cells"}], " ", "*)"}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"diffusionOEReactions", "[", 
            RowBox[{"X_", ",", " ", "Fout_", ",", " ", "Fin_"}], "]"}], ":=", 
           
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"DR", "[", 
               RowBox[{"X", ",", "Fout", ",", " ", "Fin", ",", " ", 
                RowBox[{"{", 
                 RowBox[{"#", ",", "0"}], "}"}]}], "]"}], "&"}], ",", " ", 
             "outercells"}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "drow", " ", "does", " ", "not", " ", "work", " ", "for", " ", 
            "dynamic", " ", "walls"}], " ", "*)"}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"drow", "[", 
            RowBox[{"X_", ",", "Fout_", ",", "Fin_", ",", " ", 
             RowBox[{"{", 
              RowBox[{"cell_", ",", "edge_"}], "}"}]}], "]"}], ":=", 
           "\[IndentingNewLine]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"X", "[", "cell", "]"}], "\[RightArrowLeftArrow]", 
                "Global`\[EmptySet]"}], ",", "\[IndentingNewLine]", "  ", 
               RowBox[{
                RowBox[{"Fout", "[", 
                 RowBox[{"cell", ",", "0", ",", " ", "edge"}], "]"}], 
                RowBox[{
                 RowBox[{
                  RowBox[{"edgeVariable", "[", "edge", "]"}], "[", "Global`t",
                   "]"}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"areaVariable", "[", "cell", "]"}], "[", 
                   "Global`t", "]"}], ")"}]}]}], ",", 
               RowBox[{
                RowBox[{"(", "  ", 
                 RowBox[{
                  RowBox[{"Fin", "[", 
                   RowBox[{"cell", ",", "0", ",", "edge"}], "]"}], " ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"edgeVariable", "[", "edge", "]"}], "[", 
                    "Global`t", "]"}], "/", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"areaVariable", "[", "cell", "]"}], "[", 
                    "Global`t", "]"}], ")"}]}]}], ")"}], " ", 
                RowBox[{
                 RowBox[{"X", "[", 
                  RowBox[{"cell", ",", "edge"}], "]"}], "[", "Global`t", 
                 "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"X", "[", 
                 RowBox[{"cell", ",", " ", "edge"}], "]"}], 
                "\[RightArrowLeftArrow]", "Global`\[EmptySet]"}], ",", 
               "\[IndentingNewLine]", " ", 
               RowBox[{
                RowBox[{"Fin", "[", 
                 RowBox[{"cell", ",", "0", ",", "edge"}], "]"}], "/", "aij"}],
                " ", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"(", " ", 
                 RowBox[{"Fout", "[", 
                  RowBox[{"cell", ",", "0", ",", "edge"}], "]"}], ")"}], " ", 
                
                RowBox[{
                 RowBox[{
                  RowBox[{"X", "[", "cell", "]"}], "[", "Global`t", "]"}], 
                 "/", "aij"}]}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], 
          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"DROW", "[", 
            RowBox[{"X_", ",", "  ", "Fout_", ",", " ", "Fin_"}], "]"}], ":=",
            " ", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "cells", ",", "cell", ",", "dcell", ",", "rlist", ",", " ", 
               "edges", ",", " ", "nextr", ",", " ", 
               RowBox[{"dbg", "=", "False"}], ",", "ddPrint"}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"ddPrint", "[", "u___", "]"}], ":=", " ", 
               RowBox[{"If", "[", 
                RowBox[{"dbg", ",", " ", 
                 RowBox[{"Print", "[", "u", "]"}]}], "]"}]}], ";", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"rlist", "=", 
               RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
              RowBox[{"cells", " ", "=", " ", "outercells"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"dPrint", "[", 
               RowBox[{"\"\<DROW: outer cells: \>\"", ",", " ", "cells"}], 
               "]"}], ";", " ", "\[IndentingNewLine]", 
              RowBox[{"While", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "cells", "]"}], ">", "0"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"cell", " ", "=", " ", 
                  RowBox[{"First", "[", "cells", "]"}]}], ";", " ", 
                 RowBox[{"cells", "=", 
                  RowBox[{"Rest", "[", "cells", "]"}]}], ";", " ", 
                 "\[IndentingNewLine]", 
                 RowBox[{"edges", " ", "=", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"cellIndices", "[", 
                    RowBox[{"[", "cell", "]"}], "]"}], " ", "\[Intersection]",
                     " ", "outeredges"}], ")"}]}], ";", " ", 
                 "\[IndentingNewLine]", 
                 RowBox[{"dcell", " ", "=", " ", 
                  RowBox[{"cell", "/.", "toDynamicNumberRules"}]}], ";", " ", 
                 "\[IndentingNewLine]", 
                 RowBox[{"ddPrint", "[", 
                  RowBox[{
                  "\"\<DROW: dcell: \>\"", ",", " ", "dcell", ",", " ", 
                   "\"\< edges: \>\"", ",", " ", "edges"}], "]"}], ";", " ", 
                 "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                   RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<c=\>\"", ",", " ", "c", ",", " ", "\"\<c[cell]=\>\"",
                     ",", " ", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", "cell", "]"}], "]"}], ",", "\"\< edges=\>\"",
                     ",", " ", "edges"}], "]"}], ";"}], " ", "*)"}], " ", 
                 "\[IndentingNewLine]", 
                 RowBox[{"AppendTo", "[", 
                  RowBox[{"rlist", ",", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"drow", "[", 
                    RowBox[{"X", ",", "  ", "Fout", ",", " ", "Fin", ",", 
                    RowBox[{"{", 
                    RowBox[{"dcell", ",", " ", "#"}], "}"}]}], "]"}], "&"}], "/@",
                     "edges"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"ddPrint", "[", 
               RowBox[{"\"\<DROW: rlist:\>\"", ",", " ", "rlist"}], "]"}], 
              ";", " ", "\[IndentingNewLine]", 
              RowBox[{"Return", "[", "rlist", "]"}], ";"}]}], " ", 
            "\[IndentingNewLine]", "]"}]}], ";", " ", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "diffusion", " ", "cell", " ", "wall", " ", "to", " ", "adjacent", 
            " ", "cell", " ", "wall"}], " ", "*)"}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"diffusionWWReactions", "[", 
            RowBox[{"X_", ",", " ", "Fwall_", ",", " ", "p_"}], "]"}], ":=", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", "nbrs", "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"nbrs", " ", "=", " ", 
               RowBox[{"neighbors", "[", "p", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"dPrint", "[", 
               RowBox[{
               "\"\<diffusionWWReactions: p, nbrs = \>\"", ",", " ", "p", 
                ",", "\"\< ; \>\"", ",", " ", "nbrs"}], "]"}], ";", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"DRWW", "[", 
                 RowBox[{"X", ",", " ", "Fwall", ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"p", ",", "inbr"}], "}"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"inbr", ",", "nbrs"}], "}"}]}], "]"}]}]}], 
            "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "need", " ", "to", " ", "drop", " ", "all", " ", "outer", " ", 
            "edges", " ", "from", " ", "the", " ", "following"}], " ", "*)"}],
           "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<eused: \>\"", ",", " ", "eused"}], "]"}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"intesectingEdges", "=", "\[IndentingNewLine]", 
           RowBox[{"Most", "/@", 
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{"Join", "@@", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"eused", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                   RowBox[{"eused", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", 
                   RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{"e", "[", 
                    RowBox[{"[", 
                    RowBox[{"eused", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], 
                    "\[Intersection]", 
                    RowBox[{"e", "[", 
                    RowBox[{"[", 
                    RowBox[{"eused", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}]}], "]"}]}], 
                  "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", "neused"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", 
                   RowBox[{"i", "+", "1"}], ",", "neused"}], "}"}]}], "]"}]}],
               ",", 
              RowBox[{
               RowBox[{
                RowBox[{"Last", "[", "#", "]"}], ">", "0"}], "&"}]}], 
             "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{
           "\"\<intesectingEdges = \>\"", ",", " ", "intesectingEdges"}], 
           "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"difSpec", "=", "diffusingSpecies"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "difSpec", "]"}], ">", "0"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"dPrint", "[", 
              RowBox[{"\"\<difSpec: \>\"", ",", "difSpec"}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"diffData", "=", 
              RowBox[{"First", "[", "difSpec", "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"difSpec", "=", 
              RowBox[{"Rest", "[", "difSpec", "]"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"Y", "=", 
              RowBox[{"diffData", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"dPrint", "[", 
              RowBox[{
              "\"\<diffData=\>\"", ",", "diffData", ",", " ", "\"\< Y=\>\"", 
               ",", " ", "Y"}], "]"}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "diffData", "]"}], ">", "1"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"\[Beta]out", "=", 
                RowBox[{"getTransferFunction", "[", 
                 RowBox[{"diffData", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"\[Beta]out", "=", 
                RowBox[{"0", "&"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
             " ", "\[IndentingNewLine]", 
             RowBox[{"dPrint", "[", 
              RowBox[{"\"\<\[Beta]out=\>\"", ",", "\[Beta]out"}], "]"}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "diffData", "]"}], ">", "2"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"\[Beta]in", "=", 
                 RowBox[{"getTransferFunction", "[", 
                  RowBox[{"diffData", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "]"}]}], ";"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"\[Beta]in", "=", 
                RowBox[{"0", "&"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
             " ", "\[IndentingNewLine]", 
             RowBox[{"dPrint", "[", 
              RowBox[{"\"\<\[Beta]in=\>\"", ",", "\[Beta]in"}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "diffData", "]"}], ">", "3"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"\[Beta]wall", "=", 
                 RowBox[{"getTransferFunction", "[", 
                  RowBox[{"diffData", "[", 
                   RowBox[{"[", "4", "]"}], "]"}], "]"}]}], ";"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"\[Beta]wall", "=", 
                RowBox[{"0", "&"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
             " ", "\[IndentingNewLine]", 
             RowBox[{"dPrint", "[", 
              RowBox[{"\"\<\[Beta]wall=\>\"", ",", "\[Beta]wall"}], "]"}], 
             ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"temp", "=", 
              RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", "*)"}], "\[IndentingNewLine]", 
             RowBox[{"Block", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "temp1", ",", " ", "temp2", ",", " ", "temp3", ",", " ", 
                 "temp4"}], "}"}], ",", " ", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"dPrint", "[", 
                 RowBox[{"\"\<cellIndices: \>\"", ",", " ", "cellNumbers"}], 
                 "]"}], ";", " ", "\[IndentingNewLine]", 
                RowBox[{"temp1", "=", 
                 RowBox[{"Flatten", "[", 
                  RowBox[{
                   RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"diffusionReactions", "[", 
                    RowBox[{
                    "Y", ",", "\[Beta]out", ",", " ", "\[Beta]in", ",", " ", 
                    "#"}], "]"}], "&"}], "/@", "cellNumbers"}], "]"}], ",", 
                   "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"dPrint", "[", 
                 RowBox[{"\"\<temp1: \>\"", ",", " ", "temp1"}], "]"}], ";", 
                " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"temp2", "=", 
                 RowBox[{"Join", "@@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"diffusionWWReactions", "[", 
                    RowBox[{"Y", ",", "\[Beta]wall", ",", "#"}], "]"}], "&"}],
                     "/@", "cellNumbers"}], ")"}]}]}], ";", " ", 
                "\[IndentingNewLine]", 
                RowBox[{"dPrint", "[", 
                 RowBox[{"\"\<temp2: \>\"", ",", " ", "temp2"}], "]"}], ";", 
                "  ", "\[IndentingNewLine]", " ", 
                RowBox[{"temp3", " ", "=", " ", 
                 RowBox[{"Flatten", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Join", "@@", " ", 
                    RowBox[{"DRWWC", "[", 
                    RowBox[{"Y", ",", "\[Beta]wall", ",", " ", "#"}], "]"}]}],
                     "&"}], "/@", "intesectingEdges"}], ",", "1"}], "]"}]}], 
                ";", " ", "\[IndentingNewLine]", 
                RowBox[{"dPrint", "[", 
                 RowBox[{"\"\<temp3=\>\"", ",", " ", "temp3"}], "]"}], ";", 
                " ", "\[IndentingNewLine]", 
                RowBox[{"temp4", " ", "=", " ", 
                 RowBox[{"Flatten", "[", 
                  RowBox[{
                   RowBox[{"Join", "@@", 
                    RowBox[{"DROW", "[", 
                    RowBox[{
                    "Y", ",", " ", "\[Beta]out", ",", " ", "\[Beta]in"}], 
                    "]"}]}], ",", "1"}], "]"}]}], ";", " ", 
                "\[IndentingNewLine]", " ", 
                RowBox[{"dPrint", "[", 
                 RowBox[{"\"\<temp4=\>\"", ",", " ", "temp4"}], "]"}], ";", 
                "  ", "\[IndentingNewLine]", 
                RowBox[{"temp", " ", "=", " ", 
                 RowBox[{"Join", "@@", 
                  RowBox[{"{", 
                   RowBox[{
                   "temp1", ",", " ", "temp2", ",", " ", "temp3", ",", " ", 
                    "temp4"}], "}"}]}]}], ";"}]}], "\[IndentingNewLine]", 
              "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", "*)"}], " ", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"nxtra", "=", 
              RowBox[{"Length", "[", 
               RowBox[{"Select", "[", 
                RowBox[{"temp", ",", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"Rest", "[", "#", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0.", ",", "0"}], "}"}]}], "]"}], " ", "\[Equal]",
                    "  ", 
                   RowBox[{"{", "}"}]}], "&"}]}], "]"}], "]"}]}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"nxtra", ">", "0"}], ",", " ", "\[IndentingNewLine]", 
               RowBox[{"Print", "[", 
                RowBox[{
                "\"\<Removing \>\"", ",", "nxtra", ",", 
                 "\"\< null reactions for \>\"", ",", " ", "Y"}], "]"}]}], 
              "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"temp", "=", 
              RowBox[{"Select", "[", 
               RowBox[{"temp", ",", " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Complement", "[", 
                   RowBox[{
                    RowBox[{"Rest", "[", "#", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0.", ",", "0"}], "}"}]}], "]"}], " ", 
                  "\[NotEqual]", " ", 
                  RowBox[{"{", "}"}]}], "&"}]}], "]"}]}], ";", " ", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"diff", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"diff", ",", "temp"}], "]"}]}], ";"}]}], " ", 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "diff", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], " "}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5460180772307253`*^9, 3.546018312185288*^9}, {
   3.546018343204597*^9, 3.5460183492976437`*^9}, {3.546018402471764*^9, 
   3.546018429463974*^9}, {3.54601848042784*^9, 3.546018488008587*^9}, {
   3.5460185269625463`*^9, 3.546018537154026*^9}, {3.546018573289722*^9, 
   3.546018579259461*^9}, {3.5461020517711267`*^9, 3.54610220733775*^9}, {
   3.546102282111742*^9, 3.546102381681357*^9}, {3.546102442564843*^9, 
   3.546102453810349*^9}, {3.547047502964469*^9, 3.547047513871488*^9}, {
   3.547047551887636*^9, 3.5470475732214737`*^9}, {3.547047651100218*^9, 
   3.5470477935808573`*^9}, {3.5470478904270363`*^9, 3.547047890841753*^9}, {
   3.5470479344302597`*^9, 3.5470479562532177`*^9}, {3.54704812763588*^9, 
   3.547048153899448*^9}, {3.5470876669712057`*^9, 3.547087761335661*^9}, {
   3.547087803110664*^9, 3.547087804292839*^9}, 3.547087857774626*^9, {
   3.5470879036994762`*^9, 3.54708790899872*^9}, {3.547087954840776*^9, 
   3.547087957948189*^9}, {3.547088118100717*^9, 3.547088230071069*^9}, {
   3.547088276945458*^9, 3.5470882910630608`*^9}, {3.547088352510434*^9, 
   3.547088387426292*^9}, {3.54708846845231*^9, 3.547088488951256*^9}, {
   3.547088534047902*^9, 3.547088543049842*^9}, {3.5470886033278723`*^9, 
   3.547088612683528*^9}, {3.547129426972031*^9, 3.547129495157604*^9}, {
   3.547129596835958*^9, 3.547129657478447*^9}, {3.5471297626534863`*^9, 
   3.547129844311365*^9}, {3.54712990762383*^9, 3.5471299136882257`*^9}, {
   3.547130198499971*^9, 3.5471302072195044`*^9}, {3.547130237671543*^9, 
   3.5471302440756283`*^9}, {3.5471303508735657`*^9, 3.547130359507677*^9}, {
   3.547130477125991*^9, 3.547130514136364*^9}, {3.547130677536124*^9, 
   3.5471306783631897`*^9}, {3.547132331850915*^9, 3.5471323344623613`*^9}, {
   3.547132370071187*^9, 3.547132371485957*^9}, {3.547132416389553*^9, 
   3.5471324643295097`*^9}, 3.5471325410935707`*^9, {3.547139092819208*^9, 
   3.547139138565852*^9}, {3.547139216818823*^9, 3.547139221116385*^9}, {
   3.557967851043373*^9, 3.557967859418871*^9}, {3.557967962211545*^9, 
   3.5579680131253023`*^9}, {3.557968730864039*^9, 3.557968751098069*^9}, {
   3.557969388271085*^9, 3.557969428901986*^9}, {3.5579695774720592`*^9, 
   3.557969593391996*^9}, {3.557969660846526*^9, 3.5579696689418097`*^9}, {
   3.561757004963604*^9, 3.561757050634776*^9}, {3.561757100675576*^9, 
   3.561757105384534*^9}, {3.561757275780298*^9, 3.561757327805756*^9}, {
   3.5617578736783037`*^9, 3.5617579200553513`*^9}, {3.561758239435507*^9, 
   3.561758246001457*^9}, {3.561758589357101*^9, 3.561758590492848*^9}, {
   3.5617586238539333`*^9, 3.561758625562714*^9}, {3.5766857695736513`*^9, 
   3.576685783783313*^9}, {3.576685822062808*^9, 3.5766858221454906`*^9}, {
   3.576685862478508*^9, 3.576685889499186*^9}, 
   3.576685932726433*^9},ExpressionUUID->"acb5104e-e1d9-428d-9355-\
ecdc295e67cf"]
}, Closed]],

Cell[CellGroupData[{

Cell["generateCelleratorWalledPumpReactions", "Subsubsection",
 CellChangeTimes->{
  3.546017166754369*^9},ExpressionUUID->"e098a838-5e78-4d11-b55f-\
fef9cdcfe653"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"generateCelleratorWalledPumpReactions", "[", 
    RowBox[{
    "c_", ",", "  ", "pumps_", ",", " ", "allEdgesBetween_", ",", " ", 
     "allneighbors_", ",", "outercells_", ",", " ", "outeredges_", ",", " ", 
     "\[IndentingNewLine]", "edgeVariable_", ",", " ", "areaVariable_", ",", 
     " ", "aij_", ",", " ", 
     RowBox[{"options___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "pr", ",", "XPR", ",", "XPROW", ",", "  ", "pumpReactions", ",", 
       "pumpReactionsOuterWall", ",", "pumpdata", ",", "nextpump", ",", "Y", 
       ",", " ", "F", ",", "F1", ",", "Fin", ",", "Fout", ",", "F2", ",", 
       "  ", "temp1", ",", " ", "temp2", ",", " ", "temp", ",", " ", "DPrint",
        ",", " ", "ZERO", ",", " ", "neighbors", ",", "dbg", ",", "n", ",", 
       " ", "cellNumbers", ",", "toDynamicNumberRules", ",", 
       "toStaticNumberRules", ",", " ", "cellIndices"}], "}"}], ",", " ", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dbg", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<Debug\>\"", "/.", 
         RowBox[{"{", "options", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Debug\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DPrint", "[", "x___", "]"}], ":=", 
       RowBox[{"If", "[", 
        RowBox[{"dbg", ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<DBG:generateCelleratorWalledPumpReactions:\>\"", ",", "x"}], 
          "]"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"cellNumbers", "=", 
       RowBox[{"First", "/@", "c"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"toDynamicNumberRules", " ", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Rule", ",", 
         RowBox[{"{", " ", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", "c", "]"}], "]"}], ",", "cellNumbers"}], 
          "}"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"toStaticNumberRules", "=", 
       RowBox[{"Reverse", "/@", "toDynamicNumberRules"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"DPrint", "[", 
       RowBox[{
       "\"\<toDynamicNumberRules: \>\"", ",", " ", "toDynamicNumberRules"}], 
       "]"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"DPrint", "[", 
       RowBox[{
       "\"\<toStaticNumberRules: \>\"", ",", " ", "toStaticNumberRules"}], 
       "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"cellIndices", " ", "=", " ", 
       RowBox[{"Last", "/@", "c"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"pr", "=", 
       RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "c", "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "pumps", "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"ZERO", "[", 
           RowBox[{"p_", ",", "q_", ",", " ", "r_"}], "]"}], ":=", " ", "0"}],
          ";", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"neighbors", "[", "p_", "]"}], ":=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"allneighbors", "[", 
             RowBox[{"[", 
              RowBox[{"p", "/.", "toStaticNumberRules"}], "]"}], "]"}], ")"}],
            "/.", "toDynamicNumberRules"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         
         RowBox[{"DPrint", "[", 
          RowBox[{"\"\<pumps: \>\"", ",", " ", "pumps"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Pump", " ", "Reaction"}], " ", "-"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
            RowBox[{" ", 
             RowBox[{
              RowBox[{"Convert", " ", "reactions", " ", 
               RowBox[{"x", "[", "i", "]"}]}], " ", "\[Rule]", " ", 
              RowBox[{"x", "[", 
               RowBox[{"i", ",", "edge"}]}]}], "}"}], " ", "and", " ", 
            RowBox[{"x", "[", 
             RowBox[{"i", ",", "edge"}], "]"}]}], "\[Rule]", " ", 
           RowBox[{
            RowBox[{"x", "[", "i", "]"}], " ", 
            RowBox[{"into", ":"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Reactions", " ", 
             RowBox[{"x", "[", "i", "]"}]}], " ", "\[Rule]", " ", 
            "\[EmptySet]"}], ",", " ", 
           RowBox[{"\[EmptySet]", " ", "\[Rule]", " ", 
            RowBox[{"x", "[", "i", "]"}]}], ",", " ", 
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{"i", ",", "edge"}], "]"}], "\[Rule]", " ", 
            "\[EmptySet]"}], ",", " ", 
           RowBox[{"\[EmptySet]", " ", "\[Rule]", " ", 
            RowBox[{"x", "[", 
             RowBox[{"i", ",", "edge"}], "]"}]}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"XPR", "[", 
           RowBox[{"X_", ",", "fout_", ",", "fin_", ",", " ", 
            RowBox[{"{", 
             RowBox[{"p_", ",", "q_"}], "}"}]}], "]"}], ":=", 
          "\[IndentingNewLine]", 
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "edge", ",", "r1", ",", "r2", ",", "r3", ",", "r4", ",", " ", 
              "AW", ",", "AC", ",", " ", "E"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"edge", "=", 
              RowBox[{"allEdgesBetween", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"p", "/.", "toStaticNumberRules"}], ",", 
                 RowBox[{"q", "/.", "toStaticNumberRules"}]}], "]"}], "]"}]}],
              ";", "\[IndentingNewLine]", 
             RowBox[{"E", "=", 
              RowBox[{
               RowBox[{"edgeVariable", "[", "edge", "]"}], "[", "Global`t", 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"AW", " ", "=", " ", 
              RowBox[{"aij", " ", "*", " ", "E"}]}], ";", "  ", 
             "\[IndentingNewLine]", 
             RowBox[{"AC", " ", "=", " ", 
              RowBox[{
               RowBox[{"areaVariable", "[", "p", "]"}], "[", "Global`t", 
               "]"}]}], ";", " ", "\[IndentingNewLine]", 
             RowBox[{"r1", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"X", "[", "p", "]"}], "\[Implies]", " ", 
                 "Global`\[EmptySet]"}], ",", 
                RowBox[{
                 RowBox[{"fout", "[", 
                  RowBox[{"p", ",", "q", ",", "edge"}], "]"}], "*", 
                 RowBox[{"E", "/", "AC"}]}]}], "}"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"r2", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Global`\[EmptySet]", "\[Implies]", " ", 
                 RowBox[{"X", "[", 
                  RowBox[{"p", ",", " ", "edge"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"fout", "[", 
                  RowBox[{"p", ",", "q", ",", " ", "edge"}], "]"}], " ", "*", 
                 
                 RowBox[{"E", "/", "AC"}]}]}], "   ", "}"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"r3", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"X", "[", 
                  RowBox[{"p", ",", "edge"}], "]"}], "\[Implies]", " ", 
                 "Global`\[EmptySet]"}], ",", " ", 
                RowBox[{
                 RowBox[{"fin", "[", 
                  RowBox[{"p", ",", "q", ",", "edge"}], "]"}], " ", "*", 
                 RowBox[{"E", "/", "AC"}]}]}], "}"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"r4", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Global`\[EmptySet]", "\[Implies]", 
                 RowBox[{"X", "[", "p", "]"}]}], ",", " ", 
                RowBox[{
                 RowBox[{"fin", "[", 
                  RowBox[{"p", ",", "q", ",", "edge"}], "]"}], "*", 
                 RowBox[{"E", "/", "AC"}]}]}], "}"}]}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"r1", ",", "r2", ",", "r3", ",", "r4"}], "}"}]}]}], 
           "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Same", " ", "Thing", " ", "but", " ", "for", " ", "outer", " ", 
           "wall"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"XPROW", "[", 
           RowBox[{"X_", ",", "fout_", ",", " ", "fin_", ",", " ", 
            RowBox[{"{", 
             RowBox[{"cell_", ",", "edge_"}], "}"}]}], "]"}], ":=", 
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "r1", ",", "r2", ",", "r3", ",", "r4", ",", " ", "E", ",", "AC", 
              ",", " ", "AW"}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"E", "=", 
              RowBox[{
               RowBox[{"edgeVariable", "[", "edge", "]"}], "[", "Global`t", 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"AC", " ", "=", " ", 
              RowBox[{
               RowBox[{"areaVariable", "[", "cell", "]"}], "[", "Global`t", 
               "]"}]}], ";", " ", "\[IndentingNewLine]", 
             RowBox[{"AW", " ", "=", " ", 
              RowBox[{"aij", " ", "*", " ", "E"}]}], ";", "  ", 
             "\[IndentingNewLine]", 
             RowBox[{"r1", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"X", "[", "cell", "]"}], "\[Implies]", " ", 
                 "Global`\[EmptySet]"}], ",", 
                RowBox[{
                 RowBox[{"fout", "[", 
                  RowBox[{"cell", ",", "0", ",", " ", "edge"}], "]"}], "*", 
                 RowBox[{"E", "/", "AC"}]}]}], "}"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"r2", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Global`\[EmptySet]", "\[Implies]", " ", 
                 RowBox[{"X", "[", 
                  RowBox[{"cell", ",", " ", "edge"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"fout", "[", 
                  RowBox[{"cell", ",", "0", ",", "edge"}], "]"}], " ", "*", 
                 RowBox[{"E", "/", "AC"}]}]}], "}"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"r3", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"X", "[", 
                  RowBox[{"cell", ",", "edge"}], "]"}], "\[Implies]", " ", 
                 "Global`\[EmptySet]"}], ",", " ", 
                RowBox[{
                 RowBox[{"fin", "[", 
                  RowBox[{"cell", ",", "0", ",", "edge"}], "]"}], "*", 
                 RowBox[{"E", "/", "AC"}]}]}], "}"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"r4", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Global`\[EmptySet]", "\[Implies]", 
                 RowBox[{"X", "[", "cell", "]"}]}], ",", " ", 
                RowBox[{
                 RowBox[{"fin", "[", 
                  RowBox[{"cell", ",", "0", ",", "edge"}], "]"}], "*", 
                 RowBox[{"E", "/", "AC"}]}]}], "}"}]}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"Return", "[", 
              RowBox[{"{", 
               RowBox[{"r1", ",", "r2", ",", "r3", ",", "r4"}], "}"}], 
              "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Generate", " ", "list", " ", "of", " ", "reactions", " ", "for", 
           " ", "a", " ", "given", " ", "cell", " ", "corresponding", " ", 
           "to", " ", "all", " ", "of", " ", "its", " ", "neighbors"}], " ", 
          "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"pumpReactions", "[", 
           RowBox[{"X_", ",", "FOUT_", ",", "FIN_", " ", ",", "p_"}], "]"}], ":=", 
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"reactions", ",", "nbrs"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"nbrs", "=", 
              RowBox[{"neighbors", "[", "p", "]"}]}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"DPrint", "[", 
              RowBox[{
              "\"\<pumpReactions: p: \>\"", ",", " ", "p", ",", " ", 
               "\"\< neighbors: \>\"", ",", " ", "nbrs"}], "]"}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"reactions", "=", 
              RowBox[{"Join", "@@", 
               RowBox[{"Table", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"XPR", "[", 
                  RowBox[{"X", ",", "FOUT", ",", " ", "FIN", ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"p", ",", "inbr"}], "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"inbr", ",", "nbrs"}], "}"}]}], "]"}]}]}]}]}], 
           "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"pumpReactions", "[", 
           RowBox[{"X_", ",", " ", "FOUT_", ",", " ", "FIN_"}], "]"}], ":=", 
          " ", 
          RowBox[{"Join", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"pumpReactions", "[", 
               RowBox[{"X", ",", "FOUT", ",", "FIN", ",", "#"}], "]"}], "&"}],
              "/@", "cellNumbers"}], ")"}]}]}], ";", " ", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"pumpReactionsOuterWall", "[", 
           RowBox[{"X_", ",", " ", "FOUT_", ",", "FIN_"}], "]"}], ":=", " ", 
          RowBox[{"Module", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "cells", ",", "cell", ",", "result", ",", " ", "edges", ",", " ",
               "nextr"}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"result", "=", 
              RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
             RowBox[{"cells", " ", "=", " ", "outercells"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"DPrint", "[", 
              RowBox[{
              "\"\<pumpReactionsOuterWall: outercells: \>\"", ",", " ", 
               "outercells"}], "]"}], ";", " ", "\[IndentingNewLine]", 
             RowBox[{"While", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "cells", "]"}], ">", "0"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"cell", " ", "=", " ", 
                 RowBox[{"First", "[", "cells", "]"}]}], ";", " ", 
                RowBox[{"cells", "=", 
                 RowBox[{"Rest", "[", "cells", "]"}]}], ";", " ", 
                "\[IndentingNewLine]", 
                RowBox[{"edges", " ", "=", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"cellIndices", "[", 
                    RowBox[{"[", "cell", "]"}], "]"}], " ", "\[Intersection]",
                    " ", "outeredges"}], ")"}]}], ";", " ", 
                "\[IndentingNewLine]", 
                RowBox[{"result", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"result", ",", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"XPROW", "[", 
                    RowBox[{"X", ",", " ", "FOUT", ",", "FIN", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"cell", "/.", "toDynamicNumberRules"}], ",", " ", 
                    "#"}], "}"}]}], "]"}], "&"}], "/@", "edges"}]}], 
                  "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"result", " ", "=", " ", 
              RowBox[{"Join", "@@", "result"}]}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"Return", "[", "result", "]"}], ";"}]}], " ", 
           "\[IndentingNewLine]", "]"}]}], ";", " ", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"pumpdata", "=", "pumps"}], ";", " ", "\[IndentingNewLine]", 
         
         RowBox[{"DPrint", "[", 
          RowBox[{"\"\<pumpdata: \>\"", ",", " ", "pumpdata"}], "]"}], ";", 
         " ", "\[IndentingNewLine]", 
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "pumpdata", "]"}], ">", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nextpump", "=", 
             RowBox[{"First", "[", "pumpdata", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"pumpdata", "=", 
             RowBox[{"Rest", "[", "pumpdata", "]"}]}], ";", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"Not", "[", 
               RowBox[{"ListQ", "[", "nextpump", "]"}], "]"}], ",", " ", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{
                "\"\<Error: Incorect form for pump data:  \>\"", ",", " ", 
                 "nextpump"}], "]"}], ";", " ", 
               RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "nextpump", "]"}], "<", "1"}], ",", " ", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{
                "\"\<Error: No species specified for pump data: \>\"", ",", 
                 " ", "nextpump"}], "]"}], ";", " ", 
               RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"DPrint", "[", 
             RowBox[{"\"\<nextpump:\>\"", ",", " ", "nextpump"}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Y", "=", 
             RowBox[{"nextpump", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "nextpump", "]"}], ">", "1"}], ",", " ",
               "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"F1", "=", 
                RowBox[{"nextpump", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]",
                "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"SameQ", "[", 
                  RowBox[{
                   RowBox[{"Head", "[", "F1", "]"}], ",", " ", "Function"}], 
                  "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Fout", "=", "F1"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Fout", "=", 
                  RowBox[{
                   RowBox[{"Evaluate", "[", "F1", "]"}], "&"}]}]}], "]"}], 
               ";"}], "\[IndentingNewLine]", ",", " ", "\[IndentingNewLine]", 
              
              RowBox[{"Fout", "=", "ZERO"}]}], "]"}], ";", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "nextpump", "]"}], ">", "2"}], ",", " ",
               "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"F2", "=", 
                RowBox[{"nextpump", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"DPrint", "[", 
                RowBox[{"\"\<F2=\>\"", ",", " ", "F2"}], "]"}], ";", " ", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"SameQ", "[", 
                  RowBox[{
                   RowBox[{"Head", "[", "F2", "]"}], ",", " ", "Function"}], 
                  "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Fin", "=", "F2"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Fin", "=", 
                  RowBox[{
                   RowBox[{"Evaluate", "[", "F2", "]"}], "&"}]}]}], "]"}], 
               ";"}], "\[IndentingNewLine]", ",", " ", "\[IndentingNewLine]", 
              
              RowBox[{"Fin", "=", "ZERO"}]}], "]"}], ";", " ", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"DPrint", "[", 
             RowBox[{"\"\<{Y,Fout,Fin}:\>\"", ",", " ", 
              RowBox[{"{", 
               RowBox[{"Y", ",", " ", "Fout", ",", " ", "Fin"}], "}"}]}], 
             "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"temp1", "=", 
             RowBox[{"pumpReactions", "[", 
              RowBox[{"Y", ",", "Fout", ",", "Fin"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"DPrint", "[", 
             RowBox[{"\"\<temp1:\>\"", ",", " ", "temp1"}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"temp2", "=", 
             RowBox[{"pumpReactionsOuterWall", "[", 
              RowBox[{"Y", ",", "Fout", ",", "Fin"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"DPrint", "[", 
             RowBox[{"\"\<temp2:\>\"", ",", " ", "temp2"}], "]"}], ";", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"temp", " ", "=", " ", 
             RowBox[{"Join", "[", 
              RowBox[{"temp1", ",", " ", "temp2"}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"Block", "[", 
             RowBox[{
              RowBox[{"{", "nxtra", "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"nxtra", "=", 
                RowBox[{"Length", "[", 
                 RowBox[{"Select", "[", 
                  RowBox[{"pr", ",", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"Rest", "[", "#", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0.", ",", "0"}], "}"}]}], "]"}], " ", "\[Equal]",
                     "  ", 
                    RowBox[{"{", "}"}]}], "&"}]}], "]"}], "]"}]}], ";", " ", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"nxtra", ">", "0"}], ",", " ", "\[IndentingNewLine]", 
                 RowBox[{"Print", "[", 
                  RowBox[{
                  "\"\<Removing \>\"", ",", "nxtra", ",", 
                   "\"\< null reactions for \>\"", ",", " ", "Y"}], "]"}]}], 
                "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"temp", "=", 
                RowBox[{"Select", "[", 
                 RowBox[{"temp", ",", " ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"Rest", "[", "#", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0.", ",", "0"}], "}"}]}], "]"}], " ", 
                    "\[NotEqual]", " ", 
                    RowBox[{"{", "}"}]}], "&"}]}], "]"}]}], ";"}]}], " ", 
             "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"pr", " ", "=", " ", 
             RowBox[{"Join", "[", 
              RowBox[{"pr", ",", " ", "temp"}], "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"DPrint", "[", 
          RowBox[{"\"\<pr=\>\"", ",", " ", "pr"}], "]"}], ";"}]}], " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "pr", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.546017101586808*^9, 3.546017110308014*^9}, {
   3.54601716893703*^9, 3.5460171879486094`*^9}, {3.546017228560923*^9, 
   3.546017265371728*^9}, {3.546017298058022*^9, 3.546017302861239*^9}, {
   3.546017368070737*^9, 3.546017388533926*^9}, {3.546017456892527*^9, 
   3.546017524457419*^9}, {3.5460176821216383`*^9, 3.5460177211249037`*^9}, {
   3.546017792866598*^9, 3.546017812817213*^9}, {3.546017890102354*^9, 
   3.546017891423634*^9}, {3.5460179526978617`*^9, 3.546017953775042*^9}, {
   3.5460185928219357`*^9, 3.54601860488367*^9}, 3.547085476726654*^9, {
   3.547085607210503*^9, 3.547085637462348*^9}, {3.54708583354066*^9, 
   3.547085888239649*^9}, {3.5470859356383057`*^9, 3.547085942967493*^9}, 
   3.547086056459532*^9, {3.547086088770651*^9, 3.547086092308771*^9}, 
   3.547086182622449*^9, {3.547086345207876*^9, 3.5470863585230217`*^9}, {
   3.5470863901625433`*^9, 3.547086558824595*^9}, 3.547086616115808*^9, {
   3.547086668274663*^9, 3.547086723398265*^9}, {3.547086787536376*^9, 
   3.547086873165711*^9}, {3.547086971174244*^9, 3.547086976789507*^9}, {
   3.5470870688667927`*^9, 3.547087082004239*^9}, {3.5470871410903587`*^9, 
   3.547087147646184*^9}, {3.547087212512439*^9, 3.5470872274256372`*^9}, {
   3.5470874166853323`*^9, 3.547087418158238*^9}, 3.547087466010291*^9, {
   3.556801192379588*^9, 3.5568013357884912`*^9}, {3.556802425960639*^9, 
   3.5568024322551947`*^9}, {3.5568030328707047`*^9, 3.556803038939219*^9}, 
   3.55785157145578*^9, {3.5578525850621567`*^9, 3.5578526275770063`*^9}, {
   3.557853056544745*^9, 3.557853063044756*^9}, {3.557853094188736*^9, 
   3.5578531883549423`*^9}, {3.557854175165626*^9, 3.5578542037674713`*^9}, {
   3.557854259836726*^9, 3.557854274544364*^9}, {3.557854326613988*^9, 
   3.557854338335471*^9}, {3.557968180872548*^9, 3.557968220872552*^9}, {
   3.5579682613574457`*^9, 3.557968266688311*^9}, {3.557968386007674*^9, 
   3.557968394768897*^9}, {3.557968442152467*^9, 3.557968484404361*^9}, {
   3.561759303137948*^9, 3.561759353642665*^9}, {3.5617594055419903`*^9, 
   3.561759407180274*^9}, {3.56175945863131*^9, 
   3.5617595027346687`*^9}},ExpressionUUID->"34466dde-22cb-410d-898c-\
298812db669a"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData["generateCelleratorInWallReactions"], "Subsubsection",
 CellChangeTimes->{{3.5460171183135767`*^9, 
  3.546017132052286*^9}},ExpressionUUID->"5839f751-3582-4f73-aedd-\
6115de1abc1c"],

Cell["\<\
walls is a list of cellerator reactions (non indexed)
cells is a list of cells from a dtissue in the form of {i1->{e1,e2,..}, \
i2->{e1,e2,...}, ...}\
\>", "Text",
 CellChangeTimes->{{3.547064045557262*^9, 
  3.547064082596498*^9}},ExpressionUUID->"41633360-6b1d-456d-a2e9-\
feec6cf05c2e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"generateCelleratorInWallReactions", "[", 
    RowBox[{"wall_", ",", "cells_", ",", " ", 
     RowBox[{"verbose_:", "True"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "wallreactions", ",", "w", ",", "cellnumber", ",", "edgenumber", ",", 
       "thenextcell", ",", "edgewallpairs", ",", "subnet", ",", "i"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"wallreactions", "=", 
       RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "wall", "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{"verbose", ",", " ", 
           RowBox[{"Print", "[", 
            RowBox[{
             RowBox[{"Length", "[", "wall", "]"}], ",", 
             "\"\< internal reactions in each wall compartment.\>\""}], 
            "]"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
         RowBox[{"edgewallpairs", " ", "=", " ", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"MapThread", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Outer", "[", 
                RowBox[{"List", ",", 
                 RowBox[{"{", "#1", "}"}], ",", "#2"}], "]"}], "&"}], ",", 
              RowBox[{"Transpose", "[", 
               RowBox[{"cells", "/.", 
                RowBox[{"{", 
                 RowBox[{"Rule", "\[Rule]", "List"}], "}"}]}], "]"}]}], "]"}],
             ",", "2"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
         RowBox[{"w", "=", 
          RowBox[{"lowLevelReactions", "[", "wall", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"w", "=", 
          RowBox[{
           RowBox[{"indexify", "[", 
            RowBox[{"w", ",", "i"}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{"i", "\[Rule]", " ", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"{", 
               RowBox[{"cellnumber", ",", "edgenumber"}], "}"}]}]}], 
            "}"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"subnet", "[", "i_", "]"}], ":=", 
          RowBox[{"indexify", "[", 
           RowBox[{"wall", ",", "i"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"wallreactions", " ", "=", " ", 
          RowBox[{"Join", "@@", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"subnet", "[", "i", "]"}], "/.", 
               RowBox[{"{", 
                RowBox[{"i", "\[Rule]", 
                 RowBox[{"Sequence", "@@", "#"}]}], "}"}]}], "&"}], ")"}], "/@",
             "edgewallpairs"}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "wallreactions", "]"}], ";"}]}], "  ", 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.546016734422318*^9, 3.5460168453452168`*^9}, {
  3.546016921946924*^9, 3.546016947202042*^9}, {3.547062564358322*^9, 
  3.547062664008523*^9}, {3.547063506223267*^9, 3.54706352116181*^9}, {
  3.547063761828093*^9, 3.547063795307372*^9}, {3.547063876447383*^9, 
  3.5470640365543528`*^9}, {3.584829707165098*^9, 
  3.5848297108689632`*^9}},ExpressionUUID->"a3210bdb-3cb3-402b-bab6-\
5f4da915d4e5"]
}, Closed]],

Cell[CellGroupData[{

Cell["getBC", "Subsubsection",
 CellChangeTimes->{
  3.546017145770246*^9},ExpressionUUID->"a82fbc92-f3a2-4e7e-af4c-\
0a2a05a85e1e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"getBC", "[", 
    RowBox[{"opt___", "?", "OptionQ"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "boundaryConditions", ",", "okbc", ",", "BCVars", ",", "BCVals", ",", 
       " ", 
       RowBox[{"dbg", "=", "False"}], ",", " ", "dPrint", ",", " ", 
       "diffVars", ",", " ", "pumpVars", ",", "missingBC"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"dPrint", "[", "x___", "]"}], ":=", " ", 
       RowBox[{"If", "[", 
        RowBox[{"dbg", ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<getBC: \>\"", ",", " ", "x"}], "]"}]}], "]"}]}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{"boundaryConditions", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<BoundaryConditions\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<BoundaryConditions\>\"", "\[Rule]", " ", 
          RowBox[{"{", "}"}]}], "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"diffVars", " ", "=", " ", 
       RowBox[{"First", "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\"\<Diffusion\>\"", "/.", 
           RowBox[{"{", "opt", "}"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{"\"\<Diffusion\>\"", "\[Rule]", " ", 
            RowBox[{"{", "}"}]}], "}"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pumpVars", " ", "=", 
       RowBox[{"First", "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\"\<Pumps\>\"", "/.", 
           RowBox[{"{", "opt", "}"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{"\"\<Pumps\>\"", "\[Rule]", " ", 
            RowBox[{"{", "}"}]}], "}"}]}], ")"}]}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"okbc", "=", "False"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"RuleQ", "[", "boundaryConditions", "]"}], ",", 
        RowBox[{"okbc", "=", 
         RowBox[{"And", "@@", 
          RowBox[{"(", 
           RowBox[{"NumberQ", "/@", 
            RowBox[{"Last", "/@", "boundaryConditions"}]}], ")"}]}]}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"okbc", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"BCVars", " ", "=", 
          RowBox[{"First", "/@", "boundaryConditions"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"BCVals", " ", "=", " ", 
          RowBox[{"Last", "/@", "boundaryConditions"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"dPrint", "[", 
          RowBox[{"\"\<BCVars: \>\"", ",", " ", "BCVars"}], "]"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"dPrint", "[", 
          RowBox[{"\"\<BCVals: \>\"", ",", " ", "BCVals"}], "]"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"boundaryConditions", "=", 
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Rule", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"#1", " ", "[", "0", "]"}], "[", "Global`t", "]"}], 
               ",", " ", "#2"}], "]"}], "&"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"BCVars", ",", " ", "BCVals"}], "}"}]}], "]"}]}], ";"}], 
        " ", "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Error: Invalid Format for \
\\\"BoundaryConditions\\\"\[Rule]\>\"", ",", "boundaryConditions", ",", 
           "\"\< should be alist of rules of the form variable \[Rule] \
number.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"boundaryConditions", "=", 
          RowBox[{"{", "}"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"diffVars", "=", 
       RowBox[{"Complement", "[", 
        RowBox[{"diffVars", ",", "BCVars"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pumpVars", "=", 
       RowBox[{"Complement", "[", 
        RowBox[{"pumpVars", ",", "BCVars"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"missingBC", " ", "=", " ", 
       RowBox[{"Union", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"diffVars", ",", "pumpVars"}], "}"}], "]"}], "]"}]}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{"missingBC", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", "0", "]"}], "[", "Global`t", "]"}], "\[Rule]", 
           " ", "0"}], ")"}], "&"}], "/@", "missingBC"}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<missinBC: \>\"", ",", " ", "missingBC"}], "]"}], ";", 
      "  ", "\[IndentingNewLine]", 
      RowBox[{"boundaryConditions", " ", "=", " ", 
       RowBox[{"Join", "[", 
        RowBox[{"boundaryConditions", ",", " ", "missingBC"}], "]"}]}], ";", 
      " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "boundaryConditions", "]"}], ";"}]}], " ", 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.546016139202897*^9, 3.546016188753986*^9}, {
  3.5460163508253193`*^9, 3.546016358586145*^9}, {3.5460164518610983`*^9, 
  3.546016466624608*^9}, {3.576794233956305*^9, 3.576794360357854*^9}, {
  3.5767944427720213`*^9, 3.5767945017363863`*^9}, {3.576794791116062*^9, 
  3.576795023622706*^9}, {3.576795056309259*^9, 3.576795106877575*^9}, {
  3.576795220726666*^9, 3.576795221425178*^9}, {3.576795542692856*^9, 
  3.576795543244647*^9}, {3.5767956310338573`*^9, 
  3.5767956314357862`*^9}},ExpressionUUID->"75f2ec6b-9c71-4c85-b949-\
e1d040ceb080"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["StaticSimulation", "Subsection",
 CellChangeTimes->{{3.57497828504478*^9, 
  3.574978287356696*^9}},ExpressionUUID->"bd4e2141-6cd7-4c0a-88af-\
2a55b9c99335"],

Cell["\<\
\[OpenCurlyDoubleQuote]Reactions\[CloseCurlyDoubleQuote]-> ReactionNetwork
\[OpenCurlyDoubleQuote]Diffusion\[CloseCurlyDoubleQuote]-> DiffusionVariables\
\
\>", "Text",
 CellChangeTimes->{{3.574978537834289*^9, 
  3.574978558001876*^9}},ExpressionUUID->"b0b24dce-eaf2-420a-b22f-\
f55d884598a3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"StaticSimulation", "[", 
   RowBox[{"DT_DTissue", ",", " ", "tstart_", ",", " ", "tstop_", ",", " ", 
    RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"grow", "[", 
     RowBox[{
     "DT", ",", "tstart", ",", " ", "tstop", ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<Growing\>\"", "\[Rule]", " ", "False"}], ",", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<DivisionThreshold\>\"", "\[Rule]", " ", "Infinity"}], ",", 
      "\[IndentingNewLine]", "opt", ",", " ", "\[IndentingNewLine]", 
      RowBox[{"\"\<Intercellular\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<IC\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<Walls\>\"", "\[Rule]", "False"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<TestCase\>\"", "\[Rule]", "\"\<Static-Simulation\>\""}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<Reactions\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<Pumps\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{"\"\<Diffusion\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<WallReactions\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<BoundaryConditions\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<Verbose\>\"", "\[Rule]", "False"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<Show\>\"", "\[Rule]", " ", "False"}], ",", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "turn", " ", "off", " ", "position", " ", "dependent", " ", 
        "variables", " ", "by", " ", "default", " ", "to", " ", "save", " ", 
        "CPU"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"\"\<tip\>\"", "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<xy\>\"", "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"(*", " ", 
       RowBox[{
       "make", " ", "simulation", " ", "internal", " ", "and", " ", "do", " ",
         "not", " ", "save", " ", "to", " ", "file", " ", "to", " ", "save", 
        " ", "CPU"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"\"\<Internal\>\"", "\[Rule]", "True"}], ",", 
      RowBox[{"\"\<Save\>\"", "\[Rule]", "False"}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5749782885792007`*^9, 3.574978333031013*^9}, {
  3.5749783965320177`*^9, 3.5749785280296087`*^9}, {3.574978568748081*^9, 
  3.5749786368979692`*^9}, {3.57497880165186*^9, 3.5749788092744923`*^9}, {
  3.574980652016206*^9, 3.574980652654112*^9}, {3.576085364482538*^9, 
  3.576085417661488*^9}, {3.57661394443337*^9, 3.576613948448968*^9}, {
  3.5766145611555767`*^9, 3.5766145916115723`*^9}, {3.576614626148747*^9, 
  3.576614626932026*^9}},ExpressionUUID->"9f5f9496-13cf-430e-b666-\
960ff9581996"]
}, Closed]],

Cell[CellGroupData[{

Cell["Cell Growth Implementations", "Subsection",
 CellChangeTimes->{{3.5461127639457245`*^9, 
  3.546112780501026*^9}},ExpressionUUID->"8b45a6d1-09e8-4f11-b2e4-\
dfe697405ed4"],

Cell[CellGroupData[{

Cell["generateTipEquations", "Subsubsection",
 CellChangeTimes->{{3.575231726403208*^9, 
  3.575231730602504*^9}},ExpressionUUID->"37cea3f0-97e2-47d0-8cbb-\
5a039800f608"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"generateTipEquations", "[", 
    RowBox[{"T_", ",", " ", "x_", ",", " ", "y_", ",", " ", "tip_"}], "]"}], ":=",
    " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{
      "v", ",", " ", "tipEQ", ",", " ", "vx", ",", "vy", ",", " ", "itip", 
       ",", "n", ",", "tops", ",", " ", "found", ",", " ", "top", ",", 
       "allcellnumbers"}], "}"}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ToString", "[", "tip", "]"}], "\[Equal]", "\"\<False\>\""}],
         ",", " ", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<equations\>\"", "\[Rule]", " ", 
            RowBox[{"{", "}"}]}], ",", " ", 
           RowBox[{"\"\<vertex\>\"", "\[Rule]", " ", "False"}]}], "}"}], 
         "]"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "there", " ", "may", " ", "be", " ", "some", " ", "vertices", " ", 
         "that", " ", "are", " ", "not", " ", "used", " ", "in", " ", 
         "cells"}], ",", " ", 
        RowBox[{"what", " ", "to", " ", "ignore", " ", 
         RowBox[{"those", "!"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{"TissueVertices", "[", "T", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "v", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tops", "=", 
       RowBox[{"Reverse", "[", 
        RowBox[{"Ordering", "[", 
         RowBox[{"Last", "/@", "v"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"found", "=", "False"}], ";", "\[IndentingNewLine]", 
      RowBox[{"top", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"allcellnumbers", "=", 
       RowBox[{"Union", "@@", 
        RowBox[{"CellVertexNumbers", "[", "T", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "tops", "]"}], ">", "0"}], "\[And]", 
         RowBox[{"Not", "[", "found", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"top", "=", 
          RowBox[{"First", "[", "tops", "]"}]}], ";", 
         RowBox[{"tops", "=", 
          RowBox[{"Rest", "[", "tops", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"allcellnumbers", ",", "top"}], "]"}], ",", 
           RowBox[{"found", "=", "True"}]}], "]"}]}]}], "\[IndentingNewLine]",
        "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"tipEQ", "=", 
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"vx", ",", "vy"}], "}"}], "=", 
          RowBox[{"Transpose", "[", "v", "]"}]}], ";", "\[IndentingNewLine]", 
         
         RowBox[{"itip", "=", "top"}], ";", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"tip", "[", "1", "]"}], "[", "Global`t", "]"}], 
            "\[Equal]", " ", 
            RowBox[{
             RowBox[{"x", "[", "itip", "]"}], "[", "Global`t", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"tip", "[", "2", "]"}], "[", "Global`t", "]"}], 
            "\[Equal]", " ", 
            RowBox[{
             RowBox[{"y", "[", "itip", "]"}], "[", "Global`t", "]"}]}]}], 
          "}"}]}], "\[IndentingNewLine]", ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<equations\>\"", "\[Rule]", " ", "tipEQ"}], ",", " ", 
         RowBox[{"\"\<vertex\>\"", "\[Rule]", " ", "itip"}]}], "}"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.574808915185067*^9, 3.574809020070278*^9}, {
  3.5748090654473667`*^9, 3.574809073494946*^9}, {3.574809121991722*^9, 
  3.574809125140893*^9}, {3.575235582161358*^9, 3.5752356032634287`*^9}, {
  3.576004507194437*^9, 3.576004550317996*^9}, {3.576004583159889*^9, 
  3.5760045856543007`*^9}, {3.576011537595251*^9, 
  3.576011688792053*^9}},ExpressionUUID->"5456b50e-c755-4625-b066-\
52ea553682be"]
}, Closed]],

Cell[CellGroupData[{

Cell["generateTipIndicatorEquations", "Subsubsection",
 CellChangeTimes->{
  3.57523573335433*^9},ExpressionUUID->"eca03cb9-ed62-48e7-a271-92ac2073112c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"generateTipIndicatorEquations", "[", 
   RowBox[{"T_", ",", " ", "TIP_", ",", " ", "vtip_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"cvn", ",", "icell", ",", "n", ",", " ", "eqs"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "[", "TIP", "]"}], "\[Equal]", " ", 
        "\"\<False\>\""}], ",", " ", 
       RowBox[{"Return", "[", 
        RowBox[{"{", "}"}], "]"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"AbortIf", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "[", "vtip", "]"}], "\[Equal]", "\"\<False\>\""}],
        ",", " ", 
       "\"\<\\\"TipFlag\\\"\[Rule]True but by \\\"tip\\\"\[Rule]False; A tip \
variable must be set if the TipFlag is used.\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "[", "vtip", "]"}], "\[Equal]", "\"\<False\>\""}],
        ",", " ", 
       RowBox[{"Return", "[", 
        RowBox[{"{", "}"}], "]"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"cvn", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"#", ",", "vtip"}], "]"}], "&"}], "/@", 
       RowBox[{"CellVertexNumbers", "[", "T", "]"}]}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"Length", "[", "cvn", "]"}]}], ";", " ", "\[IndentingNewLine]", 
     
     RowBox[{"icell", "=", 
      RowBox[{"Pick", "[", 
       RowBox[{
        RowBox[{"Range", "[", "n", "]"}], ",", " ", "cvn"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"eqs", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"icell", ",", " ", "#"}], "]"}], ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"TIP", "[", "#", "]"}], "[", "Global`t", "]"}], 
            "\[Equal]", " ", "1"}], ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"TIP", "[", "#", "]"}], "[", "Global`t", "]"}], 
            "\[Equal]", " ", "0"}]}], "]"}], "&"}], "/@", 
        RowBox[{"Range", "[", "n", "]"}]}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "eqs", "]"}], ";"}]}], " ", "\[IndentingNewLine]",
    "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5752357359378557`*^9, 3.575235984384239*^9}, {
  3.575236026641053*^9, 3.575236028727151*^9}, {3.5753100628844843`*^9, 
  3.5753100646731243`*^9}, {3.576004570875791*^9, 
  3.576004768469386*^9}},ExpressionUUID->"05cb5bf7-5dfe-41fb-81f5-\
327275aca7da"]
}, Closed]],

Cell[CellGroupData[{

Cell["GenerateCenterEquations", "Subsubsection",
 CellChangeTimes->{{3.57523173410721*^9, 
  3.575231739570804*^9}},ExpressionUUID->"f60c0e05-7598-48f9-8e59-\
72f7539eb3a5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"generateCenterEquations", "[", 
    RowBox[{
    "T_Tissue", ",", "center_", ",", "x_", ",", " ", "y_", ",", "  ", 
     "area_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "centroidEQS", ",", " ", "cf", ",", "j", ",", " ", "n", ",", "fx", ",", 
       " ", "fy"}], "}"}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"NTissueCells", "[", "T", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"centroidEQS", "=", 
       RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ToString", "[", "center", "]"}], "\[NotEqual]", " ", 
         "\"\<False\>\""}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"cf", "[", "j_", "]"}], ":=", " ", 
          RowBox[{"CentroidFormula", "[", 
           RowBox[{"T", ",", "j", ",", "x", ",", "y", ",", "area"}], "]"}]}], 
         ";", " ", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", "1"}], ",", " ", 
           RowBox[{"j", "\[LessEqual]", " ", "n"}], ",", " ", 
           RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"fx", ",", "fy"}], "}"}], "=", 
             RowBox[{"cf", "[", "j", "]"}]}], ";", " ", "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"centroidEQS", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"center", "[", 
                 RowBox[{"j", ",", "1"}], "]"}], "[", "Global`t", "]"}], 
               "\[Equal]", " ", "fx"}]}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"centroidEQS", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"center", "[", 
                 RowBox[{"j", ",", "2"}], "]"}], "[", "Global`t", "]"}], 
               "\[Equal]", " ", "fy"}]}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "centroidEQS", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.574809146808785*^9, 3.574809183461738*^9}, {
   3.574809223113472*^9, 3.5748093119180403`*^9}, 3.574809374863318*^9, {
   3.574810342536001*^9, 3.574810347745367*^9}, {3.574810440495756*^9, 
   3.5748104521109133`*^9}, {3.5748106222870007`*^9, 3.574810641957196*^9}, {
   3.574810684259426*^9, 
   3.574810686154957*^9}},ExpressionUUID->"4fd7fc03-b204-4411-9b13-\
bfd28845467e"]
}, Closed]],

Cell[CellGroupData[{

Cell["generateTipDistanceEquations", "Subsubsection",
 CellChangeTimes->{{3.5752317468025503`*^9, 
  3.575231755874606*^9}},ExpressionUUID->"3f53c575-1d11-45da-bdf0-\
4557fa789d5d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"generateTipDistanceEquations", "[", 
     RowBox[{"tipdist_", ",", "center_", ",", " ", "tip_", ",", "n_"}], "]"}],
     ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tipdistEQS", ",", " ", "j"}], "}"}], ",", " ", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tipdistEQS", "=", 
        RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ToString", "[", "tipdist", "]"}], "\[NotEqual]", " ", 
          "\"\<False\>\""}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"AbortIf", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"ToString", "[", "center", "]"}], "\[Equal]", "  ", 
             "\"\<False\>\""}], ",", "\[IndentingNewLine]", 
            "\"\<Error: \\\"tipDistance\\\" variable has been requested, but \
\\\"center\\\" variable name has not been assigned. Assign a variable name to \
\\\"center\\\" and re-run the program. \>\""}], "\[IndentingNewLine]", "]"}], 
          ";", " ", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"AbortIf", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"ToString", "[", "tip", "]"}], "\[Equal]", "  ", 
              "\"\<False\>\""}], ",", "\[IndentingNewLine]", 
             "\"\<Error: \\\"tipDistance\\\" variable has been requested, but \
\\\"tip\\\" variable name has not been assigned. Assign a variable name to \\\
\"tip\\\" and re-run the program. \>\""}], "\[IndentingNewLine]", "]"}], 
           "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "1"}], ",", " ", 
             RowBox[{"j", "\[LessEqual]", "n"}], ",", " ", 
             RowBox[{"j", "++"}], ",", " ", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{"tipdistEQS", ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"tipdist", "[", "j", "]"}], "[", "Global`t", "]"}], 
                 "\[Equal]", " ", "\[IndentingNewLine]", 
                 RowBox[{"Norm", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"center", "[", 
                    RowBox[{"j", ",", "1"}], "]"}], "[", "Global`t", "]"}], 
                    "-", 
                    RowBox[{
                    RowBox[{"tip", "[", "1", "]"}], "[", "Global`t", "]"}]}], 
                    ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"center", "[", 
                    RowBox[{"j", ",", "2"}], "]"}], "[", "Global`t", "]"}], 
                    "-", 
                    RowBox[{
                    RowBox[{"tip", "[", "2", "]"}], "[", "Global`t", 
                    "]"}]}]}], "}"}], "]"}]}]}], "\[IndentingNewLine]", "]"}],
               ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], " ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "tipdistEQS", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], " "}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.574809376806715*^9, 3.574809383172127*^9}, {
   3.574809418827177*^9, 3.574809504357338*^9}, 3.574809662272257*^9, {
   3.574811400370038*^9, 3.574811485683766*^9}, {3.574811594514344*^9, 
   3.574811620577606*^9}, {3.576004803871539*^9, 
   3.576004818727455*^9}},ExpressionUUID->"f28c6931-ac28-433d-a768-\
66447de5040e"]
}, Closed]],

Cell[CellGroupData[{

Cell["generateL1Equations, generateL2Equations", "Subsubsection",
 CellChangeTimes->{{3.575233124466621*^9, 3.575233127592766*^9}, {
  3.575234939382386*^9, 
  3.5752349461006947`*^9}},ExpressionUUID->"3a43ea4f-95ed-437a-b9a8-\
39046a724dd9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"generateL1Equations", "[", 
    RowBox[{"T_", ",", " ", "L1_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"l1cells", ",", "n", ",", "eqs"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ToString", "[", "L1", "]"}], "\[Equal]", " ", 
         "\"\<False\>\""}], ",", " ", 
        RowBox[{"Return", "[", 
         RowBox[{"{", "}"}], "]"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
      
      RowBox[{"l1cells", "=", 
       RowBox[{"L1Cells", "[", "T", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"NTissueCells", "[", "T", "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"eqs", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"l1cells", ",", " ", "#"}], "]"}], ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"L1", "[", "#", "]"}], "[", "Global`t", "]"}], 
             "\[Equal]", " ", "1"}], ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"L1", "[", "#", "]"}], "[", "Global`t", "]"}], 
             "\[Equal]", " ", "0"}]}], "]"}], "&"}], "/@", 
         RowBox[{"Range", "[", "n", "]"}]}], ")"}]}], ";", 
      "\[IndentingNewLine]", "eqs"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"generateL2Equations", "[", 
   RowBox[{"T_", ",", " ", "L2_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"l2cells", ",", "n", ",", "eqs"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "[", "L2", "]"}], "\[Equal]", " ", 
        "\"\<False\>\""}], ",", " ", 
       RowBox[{"Return", "[", 
        RowBox[{"{", "}"}], "]"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"l2cells", "=", 
      RowBox[{"L2Cells", "[", "T", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"n", "=", 
      RowBox[{"NTissueCells", "[", "T", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"eqs", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"l2cells", ",", " ", "#"}], "]"}], ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"L2", "[", "#", "]"}], "[", "Global`t", "]"}], 
            "\[Equal]", " ", "1"}], ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"L2", "[", "#", "]"}], "[", "Global`t", "]"}], 
            "\[Equal]", " ", "0"}]}], "]"}], "&"}], "/@", 
        RowBox[{"Range", "[", "n", "]"}]}], ")"}]}], ";", 
     "\[IndentingNewLine]", "eqs"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.575233130072205*^9, 3.5752332186450653`*^9}, {
  3.575233331682754*^9, 3.5752335130693893`*^9}, {3.575233549096299*^9, 
  3.575233552615264*^9}, {3.575234913271572*^9, 3.575234935115706*^9}, {
  3.575235015704143*^9, 3.575235015931862*^9}, {3.575310104276946*^9, 
  3.575310104431332*^9}},ExpressionUUID->"3ad0560d-a461-4bcd-95dd-\
579432fc3c72"]
}, Closed]],

Cell[CellGroupData[{

Cell["generatePDEquations", "Subsubsection",
 CellChangeTimes->{{3.577540555521017*^9, 
  3.5775405577599697`*^9}},ExpressionUUID->"c2bfb372-6511-482f-aee8-\
ea543496bfad"],

Cell["PD equations for a static tissue", "Text",
 CellChangeTimes->{{3.577540590864416*^9, 
  3.57754059516815*^9}},ExpressionUUID->"343954e1-6ef4-4d3a-a9d5-\
858424f2dbff"],

Cell[BoxData[
 RowBox[{
  RowBox[{"generatePDEquations", "[", 
   RowBox[{
   "T_Tissue", ",", " ", "center_", ",", " ", "PD_", ",", " ", "x_", ",", " ",
     "y_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "DT", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "[", "PD", "]"}], "\[Equal]", " ", 
        "\"\<False\>\""}], ",", " ", 
       RowBox[{"Return", "[", 
        RowBox[{"{", "}"}], "]"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"DT", "=", 
      RowBox[{"Tissue2DTissue", "[", "T", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"AbortIf", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "[", "center", "]"}], "\[Equal]", 
        "\"\<False\>\""}], ",", " ", 
       "\"\<PrincipalDirection requested by \\\"center\\\" not \
defined.\>\""}], "]"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"SVDPrincipalDirectionFormula", "[", 
      RowBox[{"DT", ",", "center", ",", " ", "PD", ",", "x", ",", "y"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5775405711719093`*^9, 3.577540701447666*^9}, {
  3.5775407414004498`*^9, 3.577540752888934*^9}, {3.5775411753425817`*^9, 
  3.5775411788542967`*^9}, {3.577637233331376*^9, 
  3.577637233682559*^9}},ExpressionUUID->"04bb18cf-e6a6-4816-8573-\
e7f96e76aeb9"]
}, Closed]],

Cell[CellGroupData[{

Cell["generateSpecialVariables", "Subsubsection",
 CellChangeTimes->{{3.575231776354397*^9, 
  3.575231779626712*^9}},ExpressionUUID->"c0d90ef0-7845-4cbb-9088-\
f0db733358e8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"generateSpecialVariables", "[", 
   RowBox[{"T_", ",", " ", 
    RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "tip", ",", " ", "tipEQ", ",", " ", "center", ",", "x", ",", " ", "y", 
      ",", " ", "v", ",", " ", "area", ",", " ", "centroidEQS", ",", " ", 
      "tipdist", ",", " ", "tipdistEQS", ",", " ", "eqs", ",", "n", ",", " ", 
      "L1", ",", " ", "L2", ",", " ", "L1EQS", ",", " ", "L2EQS", ",", " ", 
      "vtip", ",", " ", "tipf", ",", " ", "TFEQ", ",", " ", 
      RowBox[{"dbg", "=", "False"}], ",", " ", "dPrint", ",", " ", "xy", ",", 
      " ", "PD", ",", " ", "PDEQS"}], "}"}], ",", " ", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"dPrint", "[", "u___", "]"}], ":=", " ", 
      RowBox[{"If", "[", 
       RowBox[{"dbg", ",", " ", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<generateSpecialVariables: \>\"", ",", " ", "u"}], 
         "]"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"xy", "=", 
      RowBox[{
       RowBox[{"\"\<xy\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<xy\>\"", "\[Rule]", " ", "True"}], "}"}]}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "[", "xy", "]"}], "\[Equal]", "\"\<False\>\""}], 
       ",", " ", 
       RowBox[{"Return", "[", 
        RowBox[{"{", "}"}], "]"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"x", " ", "=", " ", 
      RowBox[{
       RowBox[{"\"\<x\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<x\>\"", "\[Rule]", " ", "Global`x"}], "}"}]}]}], ";", 
     " ", "\[IndentingNewLine]", 
     RowBox[{"y", "=", 
      RowBox[{
       RowBox[{"\"\<y\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<y\>\"", "\[Rule]", " ", "Global`y"}], "}"}]}]}], ";", 
     " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"v", "=", 
      RowBox[{"TissueVertices", "[", "T", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"tip", "=", 
      RowBox[{
       RowBox[{"\"\<tip\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<tip\>\"", "\[Rule]", " ", "Global`tip"}], "}"}]}]}], ";",
      " ", "\[IndentingNewLine]", 
     RowBox[{"tipEQ", "=", 
      RowBox[{"generateTipEquations", "[", 
       RowBox[{"T", ",", " ", "x", ",", " ", "y", ",", " ", "tip"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"vtip", " ", "=", " ", 
      RowBox[{"\"\<vertex\>\"", "/.", "tipEQ"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tipEQ", "=", 
      RowBox[{"\"\<equations\>\"", "/.", "tipEQ"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<tipEQ: \>\"", ",", " ", "tipEQ"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"tipf", "=", 
      RowBox[{
       RowBox[{"\"\<TipFlag\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<TipFlag\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"TFEQ", "=", 
      RowBox[{"generateTipIndicatorEquations", "[", 
       RowBox[{"T", ",", "tipf", ",", "vtip"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<TFEQ: \>\"", ",", " ", "TFEQ"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"center", " ", "=", " ", 
      RowBox[{
       RowBox[{"\"\<center\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<center\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";", 
     " ", "\[IndentingNewLine]", 
     RowBox[{"area", "=", 
      RowBox[{
       RowBox[{"\"\<CellVariable\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<CellVariable\>\"", "\[Rule]", " ", "Global`cell"}], 
        "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"centroidEQS", "=", 
      RowBox[{"generateCenterEquations", "[", 
       RowBox[{
       "T", ",", "center", ",", "x", ",", " ", "y", ",", " ", "area"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<cengtroidEQS: \>\"", ",", " ", "centroidEQS"}], "]"}], ";",
      " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"tipdist", " ", "=", " ", 
      RowBox[{
       RowBox[{"\"\<tipDistance\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<tipDistance\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], 
     ";", " ", "\[IndentingNewLine]", 
     RowBox[{"n", "=", 
      RowBox[{"NTissueCells", "[", "T", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"tipdistEQS", "=", 
      RowBox[{"generateTipDistanceEquations", "[", 
       RowBox[{"tipdist", ",", "center", ",", " ", "tip", ",", "n"}], "]"}]}],
      ";", " ", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<tipdistEQS: \>\"", ",", " ", "tipdistEQS"}], "]"}], ";", 
     " ", "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"L1", " ", "=", " ", 
      RowBox[{
       RowBox[{"\"\<L1\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<L1\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"L1EQS", " ", "=", " ", 
      RowBox[{"generateL1Equations", "[", 
       RowBox[{"T", ",", " ", "L1"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<L1: \>\"", ",", " ", "L1EQS"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"L2", " ", "=", " ", 
      RowBox[{
       RowBox[{"\"\<L2\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<L2\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"L2EQS", " ", "=", " ", 
      RowBox[{"generateL2Equations", "[", 
       RowBox[{"T", ",", " ", "L2"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<L2: \>\"", ",", " ", "L2EQS"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"PD", " ", "=", " ", 
      RowBox[{
       RowBox[{"\"\<PrincipalDirection\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<PrincipalDirection\>\"", "\[Rule]", " ", "False"}], 
        "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"PDEQS", "=", 
      RowBox[{"generatePDEquations", "[", 
       RowBox[{
       "T", ",", " ", "center", ",", " ", "PD", ",", " ", "x", ",", " ", 
        "y"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"eqs", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
       "tipEQ", ",", " ", "centroidEQS", ",", " ", "tipdistEQS", ",", " ", 
        "L1EQS", ",", " ", "L2EQS", ",", "TFEQ", ",", " ", "PDEQS"}], "]"}]}],
      ";", " ", "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "eqs", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.574809913295433*^9, 3.574809976823277*^9}, {
   3.57481022686091*^9, 3.5748103229653378`*^9}, {3.5748105087001953`*^9, 
   3.5748105391293488`*^9}, {3.5748105766942596`*^9, 3.574810585136773*^9}, {
   3.574810699826125*^9, 3.574810701242568*^9}, {3.574811358498911*^9, 
   3.574811390995119*^9}, {3.574811496368576*^9, 3.574811514228325*^9}, 
   3.575231785392194*^9, {3.575233015825488*^9, 3.5752330918759193`*^9}, {
   3.575233140267956*^9, 3.5752331427118673`*^9}, 3.5752332744791822`*^9, {
   3.575233557817268*^9, 3.575233559412573*^9}, {3.575234957455949*^9, 
   3.5752349978966513`*^9}, {3.5752356154866467`*^9, 3.575235724185754*^9}, {
   3.575236041050396*^9, 3.575236041456126*^9}, {3.5753098943744507`*^9, 
   3.575310001006637*^9}, {3.575310236887591*^9, 3.575310262979653*^9}, {
   3.575479979057673*^9, 3.575479979472095*^9}, {3.57548003373986*^9, 
   3.575480048115954*^9}, {3.575480314412078*^9, 3.575480315136478*^9}, {
   3.576004434079341*^9, 3.5760044534133053`*^9}, {3.576005258462531*^9, 
   3.576005258829257*^9}, {3.5760061920126963`*^9, 3.576006326744547*^9}, {
   3.576006358285289*^9, 3.57600643085275*^9}, {3.576006514387714*^9, 
   3.576006519784553*^9}, {3.576006708976467*^9, 3.5760067257330933`*^9}, 
   3.5760067900372057`*^9, {3.576006861719699*^9, 3.576006885337681*^9}, {
   3.5760093874996233`*^9, 3.576009388673183*^9}, {3.576011527177053*^9, 
   3.576011528680737*^9}, {3.576614303823292*^9, 3.576614306353136*^9}, {
   3.576619998979636*^9, 3.576620001282276*^9}, {3.577540338952345*^9, 
   3.577540417740443*^9}, {3.5775407156043043`*^9, 3.577540716851635*^9}, {
   3.5775410331262083`*^9, 3.577541063353302*^9}, 
   3.57754118914319*^9},ExpressionUUID->"edf1fd77-1d65-448e-a706-\
bfd21ee40a12"]
}, Closed]],

Cell[CellGroupData[{

Cell["generateGrowthReactions", "Subsubsection",
 CellChangeTimes->{{3.546112800703127*^9, 
  3.5461128078337145`*^9}},ExpressionUUID->"9011fa33-571a-439b-8664-\
58f53267106a"],

Cell["\<\
Special options:
\[OpenCurlyDoubleQuote]IsotropicGrowth\[CloseCurlyDoubleQuote]->True (for mu) \
or \[OpenCurlyDoubleQuote]mumin\[CloseCurlyDoubleQuote], \
\[OpenCurlyDoubleQuote]mumax\[CloseCurlyDoubleQuote],\[CloseCurlyDoubleQuote]\
muThetaMaxDeg\[CloseCurlyDoubleQuote] . \[OpenCurlyDoubleQuote]mux\
\[CloseCurlyDoubleQuote], \[OpenCurlyDoubleQuote]muy\[CloseCurlyDoubleQuote] \
should be set
\[OpenCurlyDoubleQuote]IsottropicSprings\[CloseCurlyDoubleQuote]->True (for \
k) or \[OpenCurlyDoubleQuote]kx\[CloseCurlyDoubleQuote], \
\[OpenCurlyDoubleQuote]ky\[CloseCurlyDoubleQuote] should be set\
\>", "Text",
 CellChangeTimes->{{3.571059263552602*^9, 3.571059306832053*^9}, {
  3.572368722472355*^9, 
  3.572368753160239*^9}},ExpressionUUID->"6a42274a-a59d-4988-b916-\
5862ccca8e4d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"generateGrowthReactions", "[", 
    RowBox[{
    "c_", ",", "cvn_", ",", " ", "e_", ",", "vertexCoordinates_", ",", 
     "eused_", ",", "vused_", ",", " ", "edgeVariable_", ",", "outeredges_", 
     ",", " ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ne", ",", "\[Mu]", ",", "k", ",", "P", ",", "\[CapitalPsi]", ",", 
       "rest", ",", "ER", ",", "DR", ",", "GR", ",", "verbose", ",", "vPrint",
        ",", "edgeBetween", ",", "nv", ",", "v", ",", "neighbors", ",", "xR", 
       ",", "xRterm", ",", "XYR", ",", "yR", ",", "yRterm", ",", "x", ",", 
       "y", ",", "R", ",", "equations", ",", "EV", ",", "EVS", ",", "PR", ",",
        "eflags", ",", "vflags", ",", "neused", ",", "nvused", ",", " ", 
       "eallowed", ",", "\[IndentingNewLine]", "GV", ",", " ", "\[Mu]min", 
       ",", " ", "\[Mu]max", ",", " ", "\[Mu]\[Theta]0", ",", "\[Mu]outer", 
       ",", " ", "GVS", ",", " ", "isotropic", ",", "kmin", ",", " ", "kmax", 
       ",", "k\[Theta]0", ",", "kouter", ",", " ", "isospring", ",", " ", 
       "SE", ",", " ", "SES", ",", "kvar", ",", " ", "kformula", ",", 
       "kindexed", ",", " ", 
       RowBox[{"dbg", "=", "False"}], ",", " ", "dPrint", ",", 
       "cellsAbuttingEdge", ",", " ", "outers", ",", "upwards", ",", " ", 
       "tip", ",", "iv", ",", " ", "tipEQ", ",", "\[IndentingNewLine]", 
       "muindexed", ",", "muvar", ",", "muformula", ",", "vx", ",", "vy", ",",
        "itip", ",", "outerperps", ",", " ", "L1L2", ",", "kouters", ",", " ",
        "muouters", ",", " ", "muL1L2", ",", "muouterperps", ",", "\[Mu]L1", 
       ",", "\[Mu]L1L2", ",", "center", ",", " ", "DT", ",", " ", "T", ",", 
       "area", ",", " ", "cf", ",", " ", "centroidEQS", ",", "n", ",", "fx", 
       ",", "fy", ",", " ", "perim", ",", " ", "perimEQS", ",", "  ", "PREQ", 
       ",", " ", "tipdist", ",", " ", "tipdistEQS", ",", "j", ",", "SVEQS", 
       ",", " ", "EVX", ",", " ", "EVY", ",", " ", "EVARX", ",", " ", "EVARY",
        ",", " ", "ell"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"dPrint", "[", "u___", "]"}], ":=", " ", 
       RowBox[{"If", "[", 
        RowBox[{"dbg", ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<generateGrowthReactions: \>\"", ",", " ", "u"}], 
          "]"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"DT", "=", 
       RowBox[{"DTissue", "[", 
        RowBox[{"vertexCoordinates", ",", "e", ",", "c"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"T", "=", 
       RowBox[{"DTissue2Tissue", "[", "DT", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"NTissueCells", "[", "T", "]"}]}], ";", "  ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"top", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x1_", ",", "y1_"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x2_", ",", "y2_"}], "}"}]}], "}"}], "]"}], ":=", " ", 
         RowBox[{"Max", "[", 
          RowBox[{"y1", ",", "y2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"len", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x1_", ",", "y1_"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"x2_", ",", "y2_"}], "}"}]}], "}"}], "]"}], ":=", " ", 
         RowBox[{"Norm", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x2", "-", "x1"}], ",", 
            RowBox[{"y2", "-", "y1"}]}], "}"}], "]"}]}], ";"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"ne", "=", 
       RowBox[{"Length", "[", "e", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nv", "=", 
       RowBox[{"Length", "[", "vertexCoordinates", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "In", " ", "future", " ", "iterations", " ", "replace", " ", "mu"}], 
        ",", "k", ",", 
        RowBox[{
        "with", " ", "indexed", " ", "variable", " ", "in", " ", "the", " ", 
         "same", " ", "way", " ", "as", " ", "diffusion", " ", "rates"}]}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"verbose", "=", 
       RowBox[{
        RowBox[{"\"\<Verbose\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Verbose\>\"", "\[Rule]", "False"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vPrint", "[", "x___", "]"}], ":=", 
       RowBox[{"If", "[", 
        RowBox[{"verbose", ",", 
         RowBox[{"Print", "[", "x", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Mu]", "=", 
       RowBox[{
        RowBox[{"\"\<mu\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<mu\>\"", "\[Rule]", "Global`\[Mu]"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"\[Mu]x", "=", 
         RowBox[{
          RowBox[{"\"\<mux\>\"", "/.", 
           RowBox[{"{", "opt", "}"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{"\"\<mux\>\"", "\[Rule]", "1"}], "}"}]}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Mu]y", "=", 
         RowBox[{
          RowBox[{"\"\<muy\>\"", "/.", 
           RowBox[{"{", "opt", "}"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{"\"\<muy\>\"", "\[Rule]", "1"}], "}"}]}]}], ";"}], " ", 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"\[Mu]max", "=", 
       RowBox[{
        RowBox[{"\"\<mumax\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<mumax\>\"", "\[Rule]", "1"}], "}"}]}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Mu]min", "=", 
       RowBox[{
        RowBox[{"\"\<mumin\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<mumin\>\"", "\[Rule]", "\[Mu]max"}], "}"}]}]}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{"\[Mu]\[Theta]0", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Pi", "/", "180.0"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\"\<muMaxDegrees\>\"", "/.", 
           RowBox[{"{", "opt", "}"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{"\"\<muMaxDegrees\>\"", "\[Rule]", "90.0"}], "}"}]}], 
         ")"}]}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"\[Mu]outer", "=", 
       RowBox[{
        RowBox[{"\"\<muouter\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<muouter\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";",
       " ", "\[IndentingNewLine]", 
      RowBox[{"\[Mu]L1L2", "=", 
       RowBox[{
        RowBox[{"\"\<muL1L2\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<muL1L2\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Mu]L1", "=", 
       RowBox[{
        RowBox[{"\"\<muL1\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<muL1\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";", 
      "  ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"upwards", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<Upwards\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Upwards\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";",
       " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"outers", ",", "outerperps", " ", ",", " ", "L1L2"}], "}"}], 
       "=", 
       RowBox[{"findOuters", "[", 
        RowBox[{"upwards", ",", "vertexCoordinates", ",", "e", ",", 
         RowBox[{"Last", "/@", "c"}], ",", " ", "outeredges"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"NumberQ", "[", "\[Mu]L1L2", "]"}], ",", " ", 
        RowBox[{"muL1L2", "=", "L1L2"}], ",", 
        RowBox[{"muL1L2", "=", 
         RowBox[{"{", "}"}]}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"NumberQ", "[", "\[Mu]outer", "]"}], ",", " ", 
        RowBox[{"muouters", "=", "outers"}], ",", " ", 
        RowBox[{"muouters", "=", 
         RowBox[{"{", "}"}]}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"NumberQ", "[", "\[Mu]L1", "]"}], ",", " ", 
        RowBox[{"muouterperps", "=", "outerperps"}], ",", " ", 
        RowBox[{"muouterperps", "=", 
         RowBox[{"{", "}"}]}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"kmax", "=", 
       RowBox[{
        RowBox[{"\"\<kmax\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<kmax\>\"", "\[Rule]", "1"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"kmin", "=", 
       RowBox[{
        RowBox[{"\"\<kmin\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<kmin\>\"", "\[Rule]", "kmax"}], "}"}]}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"k\[Theta]0", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Pi", "/", "180.0"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\"\<kMaxDegrees\>\"", "/.", 
           RowBox[{"{", "opt", "}"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{"\"\<kMaxDegrees\>\"", "\[Rule]", " ", "90.0"}], "}"}]}], 
         ")"}]}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"kouter", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<kouter\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<kouter\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"NumberQ", "[", "kouter", "]"}], ",", " ", 
        RowBox[{"kouters", "=", "outers"}], ",", " ", 
        RowBox[{"kouters", "=", 
         RowBox[{"{", "}"}]}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"k", "=", 
       RowBox[{
        RowBox[{"\"\<k\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<k\>\"", "\[Rule]", "Global`springconstant"}], "}"}]}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"P", "=", 
       RowBox[{
        RowBox[{"\"\<P\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<P\>\"", "\[Rule]", "Global`P"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"x", "=", 
       RowBox[{
        RowBox[{"\"\<x\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<x\>\"", "\[Rule]", "Global`x"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"y", "=", 
       RowBox[{
        RowBox[{"\"\<y\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<y\>\"", "\[Rule]", "Global`y"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"eflags", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"eused", ",", "#"}], "]"}], "&"}], "/@", 
        RowBox[{"Range", "[", "ne", "]"}]}]}], ";", "  ", 
      "\[IndentingNewLine]", 
      RowBox[{"neused", " ", "=", " ", 
       RowBox[{"Length", "[", "eused", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"vflags", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"vused", ",", "#"}], "]"}], "&"}], "/@", 
        RowBox[{"Range", "[", "nv", "]"}]}]}], ";", "  ", 
      "\[IndentingNewLine]", 
      RowBox[{"nvused", " ", "=", " ", 
       RowBox[{"Length", "[", "vused", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"iv", "=", 
       RowBox[{"Pick", "[", 
        RowBox[{
         RowBox[{"Range", "[", "nv", "]"}], ",", " ", "vflags"}], "]"}]}], 
      ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "coordinates", " ", "of", " ", "tip", " ", "of", " ", 
        "\"\<template\>\"", " ", 
        RowBox[{"(", 
         RowBox[{"tip", " ", "of", " ", "meristem"}], ")"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"SVEQS", "=", 
       RowBox[{"generateSpecialVariables", "[", 
        RowBox[{"T", ",", "opt"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<SVEQS: \>\"", ",", " ", "SVEQS"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "perimeters", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"perim", "=", 
       RowBox[{
        RowBox[{"\"\<perimeter\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<perimeter\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], 
      ";", " ", "\[IndentingNewLine]", 
      RowBox[{"perimEQS", "=", 
       RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ToString", "[", "perim", "]"}], "\[NotEqual]", "  ", 
         "\"\<False\>\""}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", "1"}], ",", " ", 
           RowBox[{"j", "\[LessEqual]", " ", "n"}], ",", " ", 
           RowBox[{"j", "++"}], ",", " ", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{"perimEQS", ",", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"perim", "[", "j", "]"}], "[", "Global`t", "]"}], 
               "\[Equal]", " ", 
               RowBox[{"PerimeterFormula", "[", 
                RowBox[{"T", ",", "j", ",", "edgeVariable"}], "]"}]}]}], 
             "]"}], ";"}]}], " ", "\[IndentingNewLine]", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "  ", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<perimEQS: \>\"", ",", " ", 
        RowBox[{"Short", "[", 
         RowBox[{"perimEQS", ",", "5"}], "]"}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"rest", "=", 
       RowBox[{
        RowBox[{"\"\<Restlength\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Restlength\>\"", "\[Rule]", "Global`resting"}], 
         "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[CapitalPsi]", "[", "u_", "]"}], ":=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"u", "+", 
          RowBox[{"Abs", "[", "u", "]"}]}], ")"}], "/", "2"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"growth", " ", "of", " ", "the", " ", "spring"}], "-", 
        RowBox[{"increase", " ", "in", " ", "resting", " ", "length"}]}], 
       "*)"}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"Subscript", "[", 
          RowBox[{"d\[ScriptL]", ",", "ij"}], "]"}], "/", "dt"}], "=", 
        RowBox[{
         RowBox[{"Subscript", "[", 
          RowBox[{"\[Mu]", ",", "ij"}], "]"}], 
         RowBox[{"\[CapitalPsi]", "[", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Subscript", "[", 
             RowBox[{"d", ",", "ij"}], "]"}], "-", 
            RowBox[{"Subscript", "[", 
             RowBox[{"\[ScriptL]", ",", "ij"}], "]"}]}], ")"}], "]"}]}]}], 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"isotropic", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<IsotropicGrowth\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<IsotropicGrowth\>\"", "\[Rule]", " ", "True"}], 
         "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"isospring", "=", 
       RowBox[{
        RowBox[{"\"\<IsotropicSprings\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<IsotropicSprings\>\"", "\[Rule]", " ", "True"}], 
         "}"}]}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"muindexed", "=", "False"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ListQ", "[", "\[Mu]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"muindexed", "=", "True"}], ";", " ", "\[IndentingNewLine]", 
         
         RowBox[{"muvar", "=", 
          RowBox[{"First", "[", "\[Mu]", "]"}]}], ";", "\[IndentingNewLine]", 
         
         RowBox[{"muformula", "=", 
          RowBox[{"Rest", "[", "\[Mu]", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "muformula", "]"}], ">", "0"}], ",", " ", 
           RowBox[{"muformula", "=", 
            RowBox[{"muformula", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
           RowBox[{"muformula", "=", 
            RowBox[{"1", "&"}]}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
         RowBox[{"\[Mu]", "=", "muvar"}], ";"}], "\[IndentingNewLine]", ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"muformula", "=", 
          RowBox[{"1", "&"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"muvar", "=", "\[Mu]"}], ";"}]}], " ", "\[IndentingNewLine]",
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"dbg", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"dPrint", "[", 
          RowBox[{"\"\<muindexed = \>\"", ",", " ", "muindexed"}], "]"}], ";",
          " ", "\[IndentingNewLine]", 
         RowBox[{"dPrint", "[", 
          RowBox[{"\"\<muvar=\>\"", ",", " ", "muvar"}], "]"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"dPrint", "[", 
          RowBox[{"\"\<muformula=\>\"", ",", " ", "muformula"}], "]"}], ";", 
         " ", "\[IndentingNewLine]", 
         RowBox[{"dPrint", "[", 
          RowBox[{"\"\<\[Mu]=\>\"", ",", " ", "\[Mu]"}], "]"}], ";"}]}], " ", 
       "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"isotropic", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ER", "[", "j_", "]"}], ":=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Global`\[EmptySet]", "\[Rule]", 
            RowBox[{"rest", "[", "j", "]"}]}], ",", 
           RowBox[{"\[Mu]", "*", 
            RowBox[{"\[CapitalPsi]", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"edgeVariable", "[", "j", "]"}], "[", "Global`t", 
               "]"}], "-", 
              RowBox[{
               RowBox[{"rest", "[", "j", "]"}], "[", "Global`t", "]"}]}], 
             "]"}]}]}], "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ER", "[", "j_", "]"}], ":=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Global`\[EmptySet]", "\[Rule]", 
            RowBox[{"rest", "[", "j", "]"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Mu]", "[", "j", "]"}], "[", "Global`t", "]"}], "*", 
            RowBox[{"\[CapitalPsi]", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"edgeVariable", "[", "j", "]"}], "[", "Global`t", 
               "]"}], "-", 
              RowBox[{
               RowBox[{"rest", "[", "j", "]"}], "[", "Global`t", "]"}]}], 
             "]"}]}]}], "}"}]}]}], "\[IndentingNewLine]", "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"GR", "=", 
       RowBox[{"Join", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"ER", "[", "#", "]"}], "}"}], "&"}], "/@", 
          RowBox[{"Pick", "[", 
           RowBox[{
            RowBox[{"Range", "[", "ne", "]"}], ",", "eflags"}], "]"}]}], 
         ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vPrint", "[", 
       RowBox[{
        RowBox[{"Length", "[", "GR", "]"}], ",", 
        "\"\< spring growth reactions.\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "vertex", " ", "dynamics", " ", "due", " ", "to", " ", "springs"}], 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{"Pick", "[", 
        RowBox[{
         RowBox[{"Range", "[", "nv", "]"}], ",", "vflags"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"eallowed", " ", "=", " ", 
       RowBox[{"Pick", "[", 
        RowBox[{"e", ",", "eflags"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"neighbors", "[", "v_", "]"}], ":=", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"Select", "[", 
           RowBox[{"eallowed", ",", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{"#", ",", "v"}], "]"}], "&"}]}], "]"}], "]"}], ",", 
         RowBox[{"{", "v", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"edgeBetween", "[", 
        RowBox[{"p_", ",", "q_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"Union", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{"e", ",", 
              RowBox[{"{", 
               RowBox[{"p", ",", "q"}], "}"}]}], "]"}], ",", 
            RowBox[{"Position", "[", 
             RowBox[{"e", ",", 
              RowBox[{"{", 
               RowBox[{"q", ",", "p"}], "}"}]}], "]"}]}], "}"}], "]"}], "]"}],
         "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"cellsAbuttingEdge", "[", "p_", "]"}], ":=", " ", 
       RowBox[{"PadRight", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"First", "/@", 
           RowBox[{"Position", "[", 
            RowBox[{"c", ",", "p"}], "]"}]}], "]"}], ",", "2"}], "]"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"kindexed", "=", "False"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ListQ", "[", "k", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"kindexed", "=", "True"}], ";", " ", "\[IndentingNewLine]", 
         RowBox[{"kvar", "=", 
          RowBox[{"First", "[", "k", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"kformula", "=", 
          RowBox[{"Rest", "[", "k", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "kformula", "]"}], ">", "0"}], ",", " ", 
           RowBox[{"kformula", "=", 
            RowBox[{"kformula", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
           RowBox[{"kformula", "=", 
            RowBox[{"1", "&"}]}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
         RowBox[{"k", "=", "kvar"}], ";"}], "\[IndentingNewLine]", ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"kformula", "=", 
          RowBox[{"1", "&"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"kvar", "=", "k"}], ";"}]}], " ", "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"dbg", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"dPrint", "[", 
          RowBox[{"\"\<kindexed = \>\"", ",", " ", "kindexed"}], "]"}], ";", 
         " ", "\[IndentingNewLine]", 
         RowBox[{"dPrint", "[", 
          RowBox[{"\"\<kvar=\>\"", ",", " ", "kvar"}], "]"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"dPrint", "[", 
          RowBox[{"\"\<kformula=\>\"", ",", " ", "kformula"}], "]"}], ";", 
         " ", "\[IndentingNewLine]", 
         RowBox[{"dPrint", "[", 
          RowBox[{"\"\<k=\>\"", ",", " ", "k"}], "]"}], ";"}]}], " ", 
       "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"isospring", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"xRterm", "[", 
          RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"p", "=", 
             RowBox[{"edgeBetween", "[", 
              RowBox[{"i", ",", "j"}], "]"}]}], "}"}], ",", 
           RowBox[{"k", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"x", "[", "j", "]"}], "[", "Global`t", "]"}], "-", 
              RowBox[{
               RowBox[{"x", "[", "i", "]"}], "[", "Global`t", "]"}]}], ")"}], 
            "*", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{
               RowBox[{
                RowBox[{"rest", "[", "p", "]"}], "[", "Global`t", "]"}], "/", 
               
               RowBox[{
                RowBox[{"edgeVariable", "[", "p", "]"}], "[", "Global`t", 
                "]"}]}]}], ")"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"xRterm", "[", 
          RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"p", "=", 
             RowBox[{"edgeBetween", "[", 
              RowBox[{"i", ",", "j"}], "]"}]}], "}"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"k", "[", "p", "]"}], "[", "Global`t", "]"}], "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"x", "[", "j", "]"}], "[", "Global`t", "]"}], "-", 
              RowBox[{
               RowBox[{"x", "[", "i", "]"}], "[", "Global`t", "]"}]}], ")"}], 
            "*", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{
               RowBox[{
                RowBox[{"rest", "[", "p", "]"}], "[", "Global`t", "]"}], "/", 
               
               RowBox[{
                RowBox[{"edgeVariable", "[", "p", "]"}], "[", "Global`t", 
                "]"}]}]}], ")"}]}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}],
       ";", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"xR", "[", "i_", "]"}], ":=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Global`\[EmptySet]", "\[Rule]", 
          RowBox[{"x", "[", "i", "]"}]}], ",", 
         RowBox[{"Plus", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"xRterm", "[", 
              RowBox[{"i", ",", "#"}], "]"}], "&"}], "/@", 
            RowBox[{"neighbors", "[", "i", "]"}]}], ")"}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"isospring", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"yRterm", "[", 
          RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"p", "=", 
             RowBox[{"edgeBetween", "[", 
              RowBox[{"i", ",", "j"}], "]"}]}], "}"}], ",", 
           RowBox[{"k", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"y", "[", "j", "]"}], "[", "Global`t", "]"}], "-", 
              RowBox[{
               RowBox[{"y", "[", "i", "]"}], "[", "Global`t", "]"}]}], ")"}], 
            "*", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{
               RowBox[{
                RowBox[{"rest", "[", "p", "]"}], "[", "Global`t", "]"}], "/", 
               
               RowBox[{
                RowBox[{"edgeVariable", "[", "p", "]"}], "[", "Global`t", 
                "]"}]}]}], ")"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"yRterm", "[", 
          RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"p", "=", 
             RowBox[{"edgeBetween", "[", 
              RowBox[{"i", ",", "j"}], "]"}]}], "}"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"k", "[", "p", "]"}], "[", "Global`t", "]"}], "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"y", "[", "j", "]"}], "[", "Global`t", "]"}], "-", 
              RowBox[{
               RowBox[{"y", "[", "i", "]"}], "[", "Global`t", "]"}]}], ")"}], 
            "*", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{
               RowBox[{
                RowBox[{"rest", "[", "p", "]"}], "[", "Global`t", "]"}], "/", 
               
               RowBox[{
                RowBox[{"edgeVariable", "[", "p", "]"}], "[", "Global`t", 
                "]"}]}]}], ")"}]}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"yR", "[", "i_", "]"}], ":=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Global`\[EmptySet]", "\[Rule]", 
          RowBox[{"y", "[", "i", "]"}]}], ",", 
         RowBox[{"Plus", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"yRterm", "[", 
              RowBox[{"i", ",", "#"}], "]"}], "&"}], "/@", 
            RowBox[{"neighbors", "[", "i", "]"}]}], ")"}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"XYR", "=", 
       RowBox[{"Join", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"xR", "[", "#", "]"}], ",", 
             RowBox[{"yR", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
          RowBox[{"Pick", "[", 
           RowBox[{
            RowBox[{"Range", "[", "nv", "]"}], ",", "vflags"}], "]"}]}], 
         ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vPrint", "[", 
       RowBox[{
        RowBox[{"Length", "[", "XYR", "]"}], ",", 
        "\"\< spring reactions.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Set", " ", "up", " ", "equations", " ", 
        RowBox[{"(", 
         RowBox[{"not", " ", "ODEs"}], ")"}]}], "*)"}], "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"ell", "=", 
       RowBox[{"ToString", "[", "edgeVariable", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"EVARX", "=", 
       RowBox[{"ToExpression", "[", 
        RowBox[{"ell", "<>", "\"\<X\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"EVARY", "=", 
       RowBox[{"ToExpression", "[", 
        RowBox[{"ell", "<>", "\"\<Y\>\""}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"EVX", "[", "i_", "]"}], ":=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"EVARX", "[", "i", "]"}], "[", "Global`t", "]"}], 
         "\[Equal]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{"e", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], "[", "Global`t", 
            "]"}], "-", 
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{"e", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}], "[", "Global`t", 
            "]"}]}], ")"}]}], ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"EVY", "[", "i_", "]"}], ":=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"EVARY", "[", "i", "]"}], "[", "Global`t", "]"}], 
         "\[Equal]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"y", "[", 
             RowBox[{"e", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], "[", "Global`t", 
            "]"}], "-", 
           RowBox[{
            RowBox[{"y", "[", 
             RowBox[{"e", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}], "[", "Global`t", 
            "]"}]}], ")"}]}], ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"EV", "[", "i_", "]"}], ":=", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"edgeVariable", "[", "i", "]"}], "[", "Global`t", "]"}], 
         "\[Equal]", 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"EVARX", "[", "i", "]"}], "[", "Global`t", "]"}], "^", 
            "2"}], " ", "+", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"EVARY", "[", "i", "]"}], "[", "Global`t", "]"}], "^", 
            "2"}]}], "]"}]}], ")"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"EV", "[", "i_", "]"}], ":=", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"v1", "=", 
              RowBox[{"e", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
             RowBox[{"v2", "=", 
              RowBox[{"e", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"edgeVariable", "[", "i", "]"}], "[", "Global`t", "]"}],
              "\[Equal]", 
             RowBox[{"Sqrt", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"x", "[", "v1", "]"}], "[", "Global`t", "]"}], "-", 
                  RowBox[{
                   RowBox[{"x", "[", "v2", "]"}], "[", "Global`t", "]"}]}], 
                 ")"}], "^", "2"}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"y", "[", "v1", "]"}], "[", "Global`t", "]"}], "-", 
                  RowBox[{
                   RowBox[{"y", "[", "v2", "]"}], "[", "Global`t", "]"}]}], 
                 ")"}], "^", "2"}]}], "]"}]}], ")"}]}], "]"}]}], ";"}], 
       "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"EVS", "=", "\[IndentingNewLine]", 
       RowBox[{"Join", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"EVX", "/@", 
          RowBox[{"Pick", "[", 
           RowBox[{
            RowBox[{"Range", "[", "ne", "]"}], ",", " ", "eflags"}], "]"}]}], 
         ",", " ", "\[IndentingNewLine]", 
         RowBox[{"EVY", "/@", 
          RowBox[{"Pick", "[", 
           RowBox[{
            RowBox[{"Range", "[", "ne", "]"}], ",", " ", "eflags"}], "]"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"EV", "/@", 
          RowBox[{"Pick", "[", 
           RowBox[{
            RowBox[{"Range", "[", "ne", "]"}], ",", "eflags"}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"isotropic", ",", "\[IndentingNewLine]", 
        RowBox[{"GVS", "=", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Anisotropic", " ", "Growth", " ", "mu"}], " ", "=", " ", 
          RowBox[{"mumin", " ", "+", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"mumax", " ", "-", " ", "mumin"}], ")"}], " ", 
            RowBox[{"Cos", "^", "2"}], 
            RowBox[{"(", 
             RowBox[{"theta", "-", "theta0"}], ")"}]}]}]}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"GV", "[", "i_", "]"}], ":=", " ", 
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "v1", ",", "v2", ",", " ", "cosine", ",", " ", "sine", ",", " ", 
              
              RowBox[{"cos0", "=", 
               RowBox[{"Cos", "[", "\[Mu]\[Theta]0", "]"}]}], ",", " ", 
              RowBox[{"sin0", "=", 
               RowBox[{"Sin", "[", "\[Mu]\[Theta]0", "]"}]}], ",", " ", 
              "costotal", ",", " ", "formula", ",", "p", ",", "q"}], "}"}], 
            ",", " ", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "Which", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{
               "for", " ", "upwards", " ", "growth", " ", "use", " ", "the", 
                " ", "outer", " ", "edge", " ", "value"}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"upwards", " ", "\[And]", " ", 
                RowBox[{"MemberQ", "[", 
                 RowBox[{"muouters", ",", " ", "i"}], "]"}]}], ",", " ", 
               "\[IndentingNewLine]", 
               RowBox[{"formula", "=", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Mu]", "[", "i", "]"}], "[", "Global`t", "]"}], 
                  "\[Equal]", "\[Mu]outer"}], ")"}]}], ",", " ", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{"inhibit", " ", 
                 RowBox[{"perp", ".", " ", "growth"}], " ", "in", " ", "L1"}],
                 " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"upwards", " ", "\[And]", " ", 
                RowBox[{"MemberQ", "[", 
                 RowBox[{"muouterperps", ",", " ", "i"}], "]"}]}], ",", " ", 
               "\[IndentingNewLine]", 
               RowBox[{"formula", "=", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Mu]", "[", "i", "]"}], "[", "Global`t", "]"}], 
                  "\[Equal]", "\[Mu]L1"}], ")"}]}], ",", " ", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{"inhibit", " ", "growth", " ", "on", " ", 
                 RowBox[{"L1", "/", "L2"}], " ", "interface"}], " ", "*)"}], 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"upwards", " ", "\[And]", " ", 
                RowBox[{"MemberQ", "[", 
                 RowBox[{"muL1L2", ",", " ", "i"}], "]"}]}], ",", " ", 
               "\[IndentingNewLine]", 
               RowBox[{"formula", "=", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Mu]", "[", "i", "]"}], "[", "Global`t", "]"}], 
                  "\[Equal]", "\[Mu]L1L2"}], ")"}]}], ",", " ", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{"Otherwise", ",", " ", 
                 RowBox[{"apply", " ", "the", " ", "growth", " ", "model"}]}],
                 " ", "*)"}], "\[IndentingNewLine]", "True", ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"v1", "=", 
                 RowBox[{"e", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ";", 
                RowBox[{"v2", "=", 
                 RowBox[{"e", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"cosine", " ", "=", " ", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"x", "[", "v1", "]"}], "[", "Global`t", "]"}], 
                    "-", 
                    RowBox[{
                    RowBox[{"x", "[", "v2", "]"}], "[", "Global`t", "]"}]}], 
                   ")"}], "/", " ", 
                  RowBox[{
                   RowBox[{"edgeVariable", "[", "i", "]"}], "[", "Global`t", 
                   "]"}]}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"sine", " ", "=", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"y", "[", "v1", "]"}], "[", "Global`t", "]"}], 
                    "-", 
                    RowBox[{
                    RowBox[{"y", "[", "v2", "]"}], "[", "Global`t", "]"}]}], 
                   ")"}], "/", " ", 
                  RowBox[{
                   RowBox[{"edgeVariable", "[", "i", "]"}], "[", "Global`t", 
                   "]"}]}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{
                  RowBox[{"Use", " ", "Cos", 
                   RowBox[{"(", 
                    RowBox[{"x", "-", "y"}], ")"}]}], "=", 
                  RowBox[{
                   RowBox[{"cosx", " ", "cosy"}], " ", "+", " ", 
                   RowBox[{"sinx", " ", "siny"}]}]}], "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{"costotal", " ", "=", " ", 
                 RowBox[{
                  RowBox[{"cosine", "*", "cos0"}], " ", "+", " ", 
                  RowBox[{"sine", "*", "sin0"}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{"muindexed", ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"p", ",", "q"}], "}"}], "=", 
                    RowBox[{"cellsAbuttingEdge", "[", "i", "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"formula", "=", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"\[Mu]", "[", "i", "]"}], "[", "Global`t", "]"}], 
                    "\[Equal]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\[Mu]max", "-", "\[Mu]min"}], ")"}], "*", 
                    RowBox[{"Abs", "[", 
                    RowBox[{"(", "costotal", ")"}], "]"}]}], " ", "+", " ", 
                    "\[Mu]min"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"muformula", "@@", 
                    RowBox[{"{", 
                    RowBox[{"p", ",", "q", ",", "i"}], "}"}]}], ")"}]}]}], 
                    ")"}]}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"formula", "=", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"\[Mu]", "[", "i", "]"}], "[", "Global`t", "]"}], 
                    "\[Equal]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\[Mu]max", "-", "\[Mu]min"}], ")"}], "*", 
                    RowBox[{"Abs", "[", 
                    RowBox[{"(", "costotal", ")"}], "]"}]}], " ", "+", " ", 
                    "\[Mu]min"}], ")"}]}], ")"}]}]}], "\[IndentingNewLine]", 
                 "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", " ", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"Return", "[", "formula", "]"}], ";"}]}], " ", 
           "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"GVS", " ", "=", " ", 
          RowBox[{"GV", "/@", 
           RowBox[{"Pick", "[", 
            RowBox[{
             RowBox[{"Range", "[", "ne", "]"}], ",", " ", "eflags"}], 
            "]"}]}]}]}]}], "\[IndentingNewLine]", "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<GVS=\>\"", ",", 
        RowBox[{"Short", "[", " ", 
         RowBox[{"GVS", ",", "5"}], "]"}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Non", "-", 
        RowBox[{"isotropic", " ", "spring", " ", "constants"}]}], " ", "*)"}],
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"isospring", ",", "\[IndentingNewLine]", 
        RowBox[{"SES", "=", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Anisotropic", " ", 
           RowBox[{"Growth", ":", " ", "k"}]}], " ", "=", " ", 
          RowBox[{"kmin", " ", "+", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"kmax", "-", "kmin"}], ")"}], "*", 
            RowBox[{"Cos", "^", "2"}], 
            RowBox[{"(", 
             RowBox[{"theta", "-", "theta0"}], ")"}]}]}]}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"SE", "[", "i_", "]"}], ":=", " ", 
          RowBox[{"Module", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "v1", ",", "v2", ",", "p", ",", "q", ",", " ", "cosine", ",", 
              " ", "sine", ",", "costotal", ",", 
              RowBox[{"cos0", "=", 
               RowBox[{"Cos", "[", "k\[Theta]0", "]"}]}], ",", " ", 
              RowBox[{"sin0", "=", 
               RowBox[{"Sin", "[", "k\[Theta]0", "]"}]}], ",", " ", 
              "formula"}], "}"}], ",", " ", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"v1", "=", 
              RowBox[{"e", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"v2", "=", 
              RowBox[{"e", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"cosine", " ", "=", " ", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"x", "[", "v1", "]"}], "[", "Global`t", "]"}], "-", 
                 
                 RowBox[{
                  RowBox[{"x", "[", "v2", "]"}], "[", "Global`t", "]"}]}], 
                ")"}], "/", " ", 
               RowBox[{
                RowBox[{"edgeVariable", "[", "i", "]"}], "[", "Global`t", 
                "]"}]}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"sine", " ", "=", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"y", "[", "v1", "]"}], "[", "Global`t", "]"}], "-", 
                 
                 RowBox[{
                  RowBox[{"y", "[", "v2", "]"}], "[", "Global`t", "]"}]}], 
                ")"}], "/", " ", 
               RowBox[{
                RowBox[{"edgeVariable", "[", "i", "]"}], "[", "Global`t", 
                "]"}]}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"costotal", " ", "=", " ", 
              RowBox[{
               RowBox[{"cosine", "*", "cos0"}], " ", "+", " ", 
               RowBox[{"sine", "*", "sin0"}]}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{"kindexed", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"p", ",", "q"}], "}"}], "=", 
                 RowBox[{"cellsAbuttingEdge", "[", "i", "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"formula", "=", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"k", "[", "i", "]"}], "[", "Global`t", "]"}], 
                   "\[Equal]", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"kmax", "-", "kmin"}], ")"}], "*", 
                    RowBox[{"Abs", "[", 
                    RowBox[{"(", "costotal", ")"}], "]"}]}], "+", " ", 
                    "kmin"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"kformula", "@@", 
                    RowBox[{"{", 
                    RowBox[{"p", ",", "q", ",", "i"}], "}"}]}], ")"}]}]}], 
                  ")"}]}]}], "\[IndentingNewLine]", ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Which", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"upwards", " ", "\[And]", " ", 
                   RowBox[{"MemberQ", "[", 
                    RowBox[{"kouters", ",", " ", "i"}], "]"}]}], ",", " ", 
                  "\[IndentingNewLine]", 
                  RowBox[{"formula", "=", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"k", "[", "i", "]"}], "[", "Global`t", "]"}], 
                    "\[Equal]", "kouter"}], ")"}]}], ",", 
                  "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{"upwards", " ", "\[And]", " ", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"outerperps", ",", " ", "i"}], "]"}]}], ",", " ", 
                    "\[IndentingNewLine]", 
                    RowBox[{"formula", "=", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"k", "[", "i", "]"}], "[", "Global`t", "]"}], 
                    "\[Equal]", "kmin"}], ")"}]}], ","}], 
                   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
                  "True", ",", "\[IndentingNewLine]", 
                  RowBox[{"formula", "=", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"k", "[", "i", "]"}], "[", "Global`t", "]"}], 
                    "\[Equal]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"kmax", "-", "kmin"}], ")"}], "*", 
                    RowBox[{"Abs", "[", 
                    RowBox[{"(", "costotal", ")"}], "]"}]}], " ", "+", " ", 
                    "kmin"}]}], ")"}]}]}], "\[IndentingNewLine]", "]"}], 
                ";"}]}], " ", "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
             RowBox[{"Return", "[", "formula", "]"}], ";"}]}], " ", 
           "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"SES", " ", "=", " ", 
          RowBox[{"SE", "/@", 
           RowBox[{"Pick", "[", 
            RowBox[{
             RowBox[{"Range", "[", "ne", "]"}], ",", " ", "eflags"}], 
            "]"}]}]}]}]}], "\[IndentingNewLine]", "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<SES = \>\"", ",", " ", 
        RowBox[{"Short", "[", 
         RowBox[{"SES", ",", "5"}], "]"}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"equations", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
        "EVS", ",", " ", "GVS", ",", " ", "SES", ",", "perimEQS", ",", " ", 
         "SVEQS"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Pressure", " ", "Force", " ", "on", " ", "Outer", " ", "Wall", " ", 
        RowBox[{"(", 
         RowBox[{"for", " ", "Stability"}], ")"}]}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ListQ", "[", "P", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"PR", "=", 
          RowBox[{"generateIndexedPressureReactions", "[", 
           RowBox[{
           "P", ",", "x", ",", "y", ",", " ", "vertexCoordinates", ",", " ", 
            "e", ",", " ", "c", ",", " ", "vused", ",", " ", "eused", ",", 
            " ", "cvn"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"PREQ", " ", "=", " ", 
          RowBox[{"\"\<equations\>\"", "/.", "PR"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"PR", "=", 
          RowBox[{"\"\<reactions\>\"", "/.", "PR"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"equations", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"equations", ",", "PREQ"}], "]"}]}], ";"}], " ", 
        "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"PR", "=", 
          RowBox[{"generateCelleratorOuterWallPressurePressureReactions", "[", 
           RowBox[{
           "x", ",", "y", ",", "P", ",", "c", ",", "cvn", ",", " ", "e", ",", 
            "outeredges", ",", "vertexCoordinates", ",", "vused", ",", 
            "eused", ",", " ", "opt"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"PREQ", "=", 
          RowBox[{"{", "}"}]}], ";"}]}], " ", "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<PR=\>\"", ",", " ", 
        RowBox[{"Short", "[", 
         RowBox[{"PR", ",", "5"}], "]"}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<PREQ=\>\"", ",", " ", 
        RowBox[{"Short", "[", 
         RowBox[{"PREQ", ",", "5"}], "]"}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"vPrint", "[", 
       RowBox[{
        RowBox[{"Length", "[", "PR", "]"}], ",", 
        "\"\< pressure reactions.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"R", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"GR", ",", "XYR", ",", "PR"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<reactions\>\"", "\[Rule]", "R"}], ",", 
         RowBox[{"\"\<equations\>\"", "\[Rule]", "equations"}]}], "}"}], 
       "]"}], ";"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5461127939405613`*^9, 3.5461127939425616`*^9}, {
   3.546112877282978*^9, 3.546112910742585*^9}, {3.5461879528784018`*^9, 
   3.54618795357443*^9}, {3.546187997183837*^9, 3.546188001159657*^9}, {
   3.546201750549011*^9, 3.546201751395606*^9}, {3.546201812657148*^9, 
   3.5462018283755293`*^9}, {3.547048277629941*^9, 3.547048368188183*^9}, {
   3.547048435357033*^9, 3.547048478408496*^9}, {3.5470485535244093`*^9, 
   3.547048582378943*^9}, {3.547052050610222*^9, 3.54705209007899*^9}, {
   3.547054268371975*^9, 3.547054269479198*^9}, {3.5566622919959784`*^9, 
   3.556662292914955*^9}, {3.5617523753290873`*^9, 3.561752378803056*^9}, {
   3.570903923037578*^9, 3.570903942323288*^9}, {3.570903979450097*^9, 
   3.570904253560046*^9}, {3.570904297490923*^9, 3.570904311060885*^9}, {
   3.570904352964859*^9, 3.570904357280007*^9}, {3.570904675191502*^9, 
   3.5709046869470663`*^9}, 3.5709050430939198`*^9, 3.5710000746012297`*^9, {
   3.571000351812509*^9, 3.571000352266696*^9}, 3.571000448477862*^9, {
   3.571001497049864*^9, 3.571001567211711*^9}, {3.57100162212973*^9, 
   3.571001656096488*^9}, {3.571001784169827*^9, 3.57100180346653*^9}, {
   3.571002131956334*^9, 3.5710021504970512`*^9}, {3.571002330401486*^9, 
   3.5710023427528887`*^9}, {3.571002375744608*^9, 3.571002405502627*^9}, {
   3.571002532046712*^9, 3.571002605298297*^9}, {3.571002641842361*^9, 
   3.571002746729805*^9}, {3.571002831886331*^9, 3.5710028811114597`*^9}, {
   3.571002951008185*^9, 3.571003051218604*^9}, {3.5710030843314133`*^9, 
   3.571003095554111*^9}, {3.571003142306188*^9, 3.5710033567733593`*^9}, {
   3.571003424497945*^9, 3.571003510892004*^9}, {3.57100364767131*^9, 
   3.57100364798276*^9}, {3.571003703797614*^9, 3.571003715156907*^9}, {
   3.571003851739181*^9, 3.571003852614513*^9}, {3.571007632300346*^9, 
   3.5710076513666773`*^9}, {3.57105879221133*^9, 3.571058872298401*^9}, {
   3.5710589440087547`*^9, 3.5710590357491302`*^9}, {3.5710590755269003`*^9, 
   3.571059114352365*^9}, {3.571059148961767*^9, 3.571059244553773*^9}, 
   3.571059310719804*^9, {3.572112577937739*^9, 3.572112613429994*^9}, 
   3.572112755483199*^9, {3.572113164288398*^9, 3.572113172116403*^9}, {
   3.572114749406822*^9, 3.572114914156246*^9}, {3.572114953984026*^9, 
   3.57211496935553*^9}, {3.572131586981728*^9, 3.5721317431248207`*^9}, {
   3.5721317887538023`*^9, 3.572131795710355*^9}, {3.57213182624508*^9, 
   3.572131829605644*^9}, {3.572132399387825*^9, 3.572132400038012*^9}, {
   3.572132449020591*^9, 3.572132468631193*^9}, {3.572132544775041*^9, 
   3.572132596839251*^9}, {3.57213263521663*^9, 3.572132668910956*^9}, {
   3.572132772362306*^9, 3.572132793464176*^9}, {3.572132937014748*^9, 
   3.572132988211532*^9}, {3.572133025653366*^9, 3.572133119042041*^9}, {
   3.572133159922161*^9, 3.5721332107789717`*^9}, {3.572133285552964*^9, 
   3.572133315806336*^9}, {3.572133555022861*^9, 3.572133555752022*^9}, {
   3.572133637760997*^9, 3.572133638443729*^9}, {3.5721338315093527`*^9, 
   3.572133832413179*^9}, {3.572368757901626*^9, 3.572368960811081*^9}, {
   3.572369087252166*^9, 3.572369152620263*^9}, {3.572369234752986*^9, 
   3.5723692456658583`*^9}, {3.572369281006257*^9, 3.572369429350374*^9}, {
   3.572369508991468*^9, 3.57236952020675*^9}, 3.5723695761781473`*^9, {
   3.572369641628504*^9, 3.5723696454052973`*^9}, {3.5723697063878307`*^9, 
   3.5723698897360353`*^9}, {3.5723699235368423`*^9, 
   3.5723699816204023`*^9}, {3.572371795728944*^9, 3.5723718608345327`*^9}, {
   3.572371893792766*^9, 3.5723719119378443`*^9}, {3.572371987761958*^9, 
   3.572372052101885*^9}, {3.5723720834737377`*^9, 3.572372222050089*^9}, {
   3.572372258735526*^9, 3.572372262874501*^9}, {3.572372306127859*^9, 
   3.572372769954852*^9}, {3.57237282539052*^9, 3.572372892456492*^9}, {
   3.572372923176176*^9, 3.57237302377483*^9}, 3.572373073433498*^9, {
   3.5723732218304377`*^9, 3.5723732459275217`*^9}, {3.572373296661216*^9, 
   3.57237336747258*^9}, {3.5723759043413143`*^9, 3.57237598781668*^9}, {
   3.572376148716385*^9, 3.572376158469421*^9}, {3.5723762124159813`*^9, 
   3.572376298871401*^9}, {3.572376375045114*^9, 3.572376379337819*^9}, {
   3.572388970005272*^9, 3.572389033017817*^9}, {3.572389129557728*^9, 
   3.572389163877224*^9}, {3.5723897929057817`*^9, 3.5723898601998777`*^9}, {
   3.572391574828905*^9, 3.572391895032714*^9}, {3.572391926668407*^9, 
   3.572391967142874*^9}, {3.5723923433940477`*^9, 3.572392345045494*^9}, {
   3.5723952212716293`*^9, 3.57239524643399*^9}, {3.572395301776909*^9, 
   3.5723954922131653`*^9}, {3.5723955444892807`*^9, 3.572395603553371*^9}, {
   3.5723965877317533`*^9, 3.572396616030588*^9}, {3.572396649785063*^9, 
   3.572396688238772*^9}, {3.572397336256792*^9, 3.572397353138616*^9}, {
   3.572458650168084*^9, 3.57245865050463*^9}, {3.572458726731978*^9, 
   3.572458904230711*^9}, {3.5724594978611937`*^9, 3.572459580722356*^9}, 
   3.5724596208872137`*^9, 3.5724596987180223`*^9, {3.5724599570418987`*^9, 
   3.572459982567061*^9}, {3.5724600354013977`*^9, 3.57246007121318*^9}, {
   3.5724608072182426`*^9, 3.572460822959743*^9}, {3.572460909612529*^9, 
   3.572460982747765*^9}, {3.572461172132741*^9, 3.572461198924021*^9}, {
   3.57246142737521*^9, 3.572461427936886*^9}, {3.572461831933322*^9, 
   3.5724618335543833`*^9}, {3.572461970548646*^9, 3.5724619931585417`*^9}, {
   3.572462060731*^9, 3.572462068776628*^9}, {3.572462703669733*^9, 
   3.572462704547575*^9}, 3.5724628491850853`*^9, {3.572830066191441*^9, 
   3.572830126904026*^9}, {3.57283020371729*^9, 3.5728302519062357`*^9}, {
   3.572830307944203*^9, 3.572830309040058*^9}, {3.572830446147791*^9, 
   3.572830464020022*^9}, {3.5728306056279488`*^9, 3.572830607520578*^9}, {
   3.572873415022299*^9, 3.572873454118535*^9}, {3.5728735648775797`*^9, 
   3.5728735663860073`*^9}, {3.572873715758315*^9, 3.5728737199569798`*^9}, {
   3.57287524695849*^9, 3.5728752572273407`*^9}, {3.572987506689217*^9, 
   3.572987665937812*^9}, {3.572987760511668*^9, 3.572987966487591*^9}, {
   3.5730493726504393`*^9, 3.573049405243836*^9}, {3.574028737232028*^9, 
   3.574028812597361*^9}, {3.574029057615552*^9, 3.574029141918023*^9}, {
   3.57402920930118*^9, 3.574029297916889*^9}, {3.574029360973447*^9, 
   3.574029368591449*^9}, {3.574029420730817*^9, 3.5740295040500727`*^9}, {
   3.574029579139873*^9, 3.57402959194969*^9}, {3.574029641454764*^9, 
   3.574029696589061*^9}, {3.5740297330909243`*^9, 3.574029921854533*^9}, 
   3.574029978279277*^9, {3.574030043288768*^9, 3.574030044594912*^9}, {
   3.574030094422256*^9, 3.574030095065346*^9}, {3.574030296143714*^9, 
   3.5740302976115007`*^9}, {3.57403147138059*^9, 3.574031626900208*^9}, {
   3.5740316787007303`*^9, 3.574031698495448*^9}, {3.574032071653228*^9, 
   3.574032367403047*^9}, {3.574032413701097*^9, 3.5740324501419497`*^9}, {
   3.5740328168675537`*^9, 3.574032925260293*^9}, {3.5740336629484243`*^9, 
   3.574033667420362*^9}, {3.5740342569220867`*^9, 3.5740343497914753`*^9}, {
   3.574034530225113*^9, 3.574034571152886*^9}, {3.574034688626623*^9, 
   3.574034710647655*^9}, {3.5748086740492992`*^9, 3.574808681541247*^9}, 
   3.574808736160097*^9, {3.574808796940987*^9, 3.574808812090891*^9}, {
   3.574809038672426*^9, 3.574809055693779*^9}, {3.574809086204563*^9, 
   3.574809117554728*^9}, {3.5748091910827227`*^9, 3.574809193809943*^9}, {
   3.5748093303798103`*^9, 3.574809369955093*^9}, {3.574809526655755*^9, 
   3.574809599435234*^9}, {3.5748107092478857`*^9, 3.574810710227738*^9}, {
   3.574811550963608*^9, 3.5748115511796427`*^9}, {3.575232291318128*^9, 
   3.575232382173297*^9}, {3.575233287401932*^9, 3.575233287882245*^9}, {
   3.5752345697059917`*^9, 3.575234569968377*^9}, {3.5753087566799707`*^9, 
   3.575308757199503*^9}, {3.575308859167241*^9, 3.5753089589306297`*^9}, {
   3.5753092339232197`*^9, 3.57530923457168*^9}, {3.5753097323921547`*^9, 
   3.5753097342727127`*^9}, {3.575309792363806*^9, 3.575309846825345*^9}, {
   3.575310280276144*^9, 3.575310281437693*^9}, 3.576010593611944*^9, {
   3.57601084916276*^9, 3.576010852243999*^9}, 3.576615419273426*^9, {
   3.5776384179643307`*^9, 3.5776385925764313`*^9}, {3.577638626661021*^9, 
   3.577638848694784*^9}, {3.5776394260054283`*^9, 3.5776394324226427`*^9}, {
   3.5776536767359257`*^9, 3.577653700495433*^9}, {3.577653830628695*^9, 
   3.5776538795094223`*^9}, {3.5776543360723267`*^9, 3.577654346418644*^9}, {
   3.577654413247099*^9, 
   3.5776544231172*^9}},ExpressionUUID->"30ca4419-8337-4f72-902d-\
3eae5deeb54b"]
}, Closed]],

Cell[CellGroupData[{

Cell["findOuters", "Subsubsection",
 CellChangeTimes->{{3.57245976743878*^9, 
  3.572459770981001*^9}},ExpressionUUID->"66bd9cc0-0235-49a2-a95b-\
fdbe4eebb729"],

Cell[BoxData[
 RowBox[{
  RowBox[{"findOuters", "[", 
   RowBox[{
   "upwards_", ",", "v_", ",", "e_", ",", "c_", ",", " ", "outeredges_"}], 
   "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ymin", ",", 
      RowBox[{"dbg", "=", "False"}], ",", "dPrint", ",", "eoe", ",", "eouter",
       ",", "edgelengths", ",", "len", ",", "top", ",", "meanlength", ",", 
      "tops", ",", "bottoms", ",", "outers", ",", "perps", ",", "n", ",", 
      "L1AC", ",", "flags", ",", " ", "L1L2", ",", " ", "T"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"dPrint", "[", "u___", "]"}], ":=", " ", 
      RowBox[{"If", "[", 
       RowBox[{"dbg", ",", " ", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<findOuters: \>\"", ",", " ", "u"}], "]"}]}], "]"}]}], 
     ";", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"top", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x1_", ",", "y1_"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x2_", ",", "y2_"}], "}"}]}], "}"}], "]"}], ":=", " ", 
      RowBox[{"Max", "[", 
       RowBox[{"y1", ",", "y2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"len", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x1_", ",", "y1_"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"x2_", ",", "y2_"}], "}"}]}], "}"}], "]"}], ":=", " ", 
      RowBox[{"Norm", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x2", "-", "x1"}], ",", 
         RowBox[{"y2", "-", "y1"}]}], "}"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"outers", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"perps", "=", 
      RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"upwards", ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "figure", " ", "out", " ", "which", " ", "edges", " ", "are", " ", 
         "on", " ", "the", " ", "L1", " ", "outer", " ", "edge"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ymin", " ", "=", " ", 
         RowBox[{"Min", "[", 
          RowBox[{"Last", "/@", "v"}], "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"dPrint", "[", 
         RowBox[{"\"\<ymin=\>\"", ",", " ", "ymin"}], "]"}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"eoe", "=", 
         RowBox[{"e", "[", 
          RowBox[{"[", "outeredges", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"eouter", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "eoe"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"edgelengths", "=", 
         RowBox[{"len", "/@", "eouter"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dPrint", "[", 
         RowBox[{"\"\<lens: \>\"", ",", " ", "edgelengths"}], "]"}], ";", " ",
         "\[IndentingNewLine]", 
        RowBox[{"meanlength", "=", 
         RowBox[{"Mean", "[", "edgelengths", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dPrint", "[", 
         RowBox[{"\"\<meanlength: \>\"", ",", " ", "meanlength"}], "]"}], ";",
         " ", "\[IndentingNewLine]", 
        RowBox[{"tops", " ", "=", " ", 
         RowBox[{"top", "/@", "eouter"}]}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"dPrint", "[", 
         RowBox[{"\"\<tops: \>\"", ",", " ", "tops"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"bottoms", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "<", 
             RowBox[{"0.5", "*", "meanlength"}]}], ")"}], "&"}], "/@", 
          "tops"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dPrint", "[", 
         RowBox[{"\"\<bottoms: \>\"", ",", " ", "bottoms"}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"outers", "=", 
         RowBox[{"Pick", "[", 
          RowBox[{"outeredges", ",", " ", 
           RowBox[{"Not", "/@", "bottoms"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dPrint", "[", 
         RowBox[{"\"\<outers: \>\"", ",", " ", "outers"}], "]"}], ";", " ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"eoe", "=", 
         RowBox[{"e", "[", 
          RowBox[{"[", "outers", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"n", "=", 
         RowBox[{"Length", "[", "e", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"L1AC", "[", "edge_", "]"}], ":=", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"Union", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Intersection", "[", 
                RowBox[{"edge", ",", "#"}], "]"}], "&"}], "/@", "eoe"}], 
             "]"}], "]"}], "]"}], ">", "0"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"flags", "=", 
         RowBox[{"L1AC", "/@", "e"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"perps", "=", 
         RowBox[{"Complement", "[", 
          RowBox[{
           RowBox[{"Pick", "[", 
            RowBox[{
             RowBox[{"Range", "[", "n", "]"}], ",", "flags"}], "]"}], ",", 
           "outers"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"perps", "=", 
         RowBox[{"Complement", "[", 
          RowBox[{"perps", ",", "bottoms"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"T", "=", 
         RowBox[{"Tissue", "[", 
          RowBox[{"v", ",", "e", ",", "c"}], "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"L1L2", "=", 
         RowBox[{"FindL1L2Edges", "[", 
          RowBox[{"T", ",", " ", "meanlength"}], "]"}]}], ";"}]}], " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{"outers", ",", "perps", ",", " ", "L1L2"}], "}"}], "]"}], 
     ";"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.572459772607462*^9, 3.572459938245983*^9}, {
  3.572460196433432*^9, 3.572460198404727*^9}, {3.57246067830844*^9, 
  3.572460782266489*^9}, {3.5728301890102367`*^9, 3.572830190332515*^9}, {
  3.5728302667649517`*^9, 3.5728302882863092`*^9}, {3.572830338066156*^9, 
  3.5728303392127657`*^9}, {3.572830544587617*^9, 3.572830586827442*^9}, {
  3.572830617933707*^9, 
  3.572830619532978*^9}},ExpressionUUID->"0b2572e1-897e-486e-a7b1-\
320789a40684"]
}, Closed]],

Cell[CellGroupData[{

Cell["generateIndexedPressureReactions", "Subsubsection",
 CellChangeTimes->{{3.572872514115921*^9, 
  3.572872519283031*^9}},ExpressionUUID->"92aea813-205e-46cf-85a9-\
a8cb35794ce2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"generateIndexedPressureReactions", "[", 
    RowBox[{
    "P_", ",", " ", "x_", ",", "y_", ",", " ", "v_", ",", " ", "e_", ",", " ",
      "c_", ",", " ", "vused_", ",", " ", "eused_", ",", " ", "cvn_"}], "]"}],
    ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dbg", "=", "False"}], ",", " ", "dPrint", ",", " ", "pvar", 
       ",", " ", "pfunc", ",", " ", "cellnumbers", ",", " ", "cells", ",", 
       "  ", "edgesAtVertex", ",", "ev", ",", " ", "cellsAbuttingEdge", ",", 
       "cellsAbuttingEdges", ",", "cv", ",", "i", ",", " ", "vertex", ",", 
       " ", "RelevantEdges", ",", " ", "RelevantCells", ",", "centroids", ",",
        "nv", ",", "xreactions", ",", "yreactions", ",", " ", "edge", ",", 
       " ", "edgecells", ",", "iedge", ",", " ", "nextcell", ",", " ", 
       "TheEdge", ",", " ", "TheVertices", ",", " ", "TheMidPoint", ",", "x1",
        ",", "y1", ",", "x2", ",", "y2", ",", "ANormalVector", ",", 
       "TheVerticesVariables", ",", "x1v", ",", "x2v", ",", "y1v", ",", "y2v",
        ",", "ANormalVectorVariables", ",", "TheCentroid", ",", 
       "AnOutwardVector", ",", "TheNormalVector", ",", 
       "TheNormalVectorVariables", ",", "mult", ",", "TheRates", ",", "xRate",
        ",", "yRate", ",", "icell", ",", " ", "eqs"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"dPrint", "[", "u___", "]"}], ":=", " ", 
       RowBox[{"If", "[", 
        RowBox[{"dbg", ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Indexed Pressure: \>\"", ",", " ", "u"}], "]"}]}], 
        "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"pvar", " ", "=", " ", 
       RowBox[{"First", "[", "P", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "P", "]"}], ">", "1"}], ",", " ", 
        RowBox[{"pfunc", "=", 
         RowBox[{"P", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
        RowBox[{"pfunc", "=", 
         RowBox[{"1", "&"}]}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<P: \>\"", ",", " ", "P"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<pfunc: \>\"", ",", " ", "pfunc"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"cellnumbers", " ", "=", " ", 
       RowBox[{"First", "/@", "c"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cells", " ", "=", " ", 
       RowBox[{"Last", "/@", "c"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<vused: \>\"", ",", " ", "vused"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"edgesAtVertex", "[", "j_", "]"}], ":=", " ", 
       RowBox[{"First", "/@", 
        RowBox[{"Position", "[", 
         RowBox[{"e", ",", "j"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ev", "=", 
       RowBox[{"edgesAtVertex", "/@", "vused"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<edges at each used vertex: \>\"", ",", " ", "ev"}], "]"}],
       ";", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"cellsAbuttingEdge", "[", "j_", "]"}], ":=", " ", 
       RowBox[{"First", "/@", 
        RowBox[{"Position", "[", 
         RowBox[{"cells", ",", "j"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"cellsAbuttingEdges", "[", "j_", "]"}], ":=", " ", 
       RowBox[{"cellsAbuttingEdge", "/@", "j"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cv", "=", 
       RowBox[{"cellsAbuttingEdges", "/@", "ev"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<cells along each set of edges: \>\"", ",", " ", "cv"}], 
       "]"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"centroids", "=", 
       RowBox[{"Centroid", "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "cvn"}], ")"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<centroids: \>\"", ",", " ", "centroids"}], "]"}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{"nv", "=", 
       RowBox[{"Length", "[", "vused", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"xreactions", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"yreactions", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", " ", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", " ", "nv"}], ",", " ", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"vertex", " ", "=", " ", 
          RowBox[{"vused", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"RelevantEdges", " ", "=", " ", 
          RowBox[{"ev", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"RelevantCells", "=", 
          RowBox[{"cv", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"dPrint", "[", 
          RowBox[{
          "\"\<vertex: \>\"", ",", " ", "vertex", ",", " ", 
           "\"\< edges: \>\"", ",", " ", "RelevantEdges", ",", " ", 
           "\"\< Cells: \>\"", ",", " ", "RelevantCells"}], "]"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"iedge", "=", "1"}], ",", " ", 
           RowBox[{"iedge", "\[LessEqual]", " ", 
            RowBox[{"Length", "[", "RelevantEdges", "]"}]}], ",", " ", 
           RowBox[{"iedge", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"edge", "=", 
             RowBox[{"RelevantEdges", "[", 
              RowBox[{"[", "iedge", "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"edgecells", "=", 
             RowBox[{"RelevantCells", "[", 
              RowBox[{"[", "iedge", "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"dPrint", "[", 
               RowBox[{
               "\"\<---: edge \>\"", ",", " ", "edge", ",", " ", 
                "\"\< abuts  cells \>\"", " ", ",", " ", "edgecells"}], "]"}],
               ";"}], " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"TheEdge", "=", 
             RowBox[{"e", "[", 
              RowBox[{"[", "edge", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"TheVertices", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"v", "[", 
                RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "TheEdge"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"TheMidPoint", "=", 
             RowBox[{"0.5", "*", 
              RowBox[{"Plus", "@@", "TheVertices"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x1", ",", "y1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"x2", ",", "y2"}], "}"}]}], "}"}], "=", 
             "TheVertices"}], ";", "\[IndentingNewLine]", 
            RowBox[{"ANormalVector", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"y2", "-", "y1"}], ",", " ", 
               RowBox[{"x1", "-", "x2"}]}], "}"}]}], ";", " ", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"TheVerticesVariables", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"x", "[", "#", "]"}], "[", "Global`t", "]"}], ",", 
                 RowBox[{
                  RowBox[{"y", "[", "#", "]"}], "[", "Global`t", "]"}]}], 
                "}"}], "&"}], "/@", "TheEdge"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x1v", ",", "y1v"}], "}"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"x2v", ",", "y2v"}], "}"}]}], "}"}], "=", 
             "TheVerticesVariables"}], ";", "\[IndentingNewLine]", 
            RowBox[{"ANormalVectorVariables", " ", "=", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"y2v", "-", "y1v"}], ",", " ", 
               RowBox[{"x1v", "-", "x2v"}]}], "}"}]}], ";", " ", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"icell", "=", "1"}], ",", " ", 
              RowBox[{"icell", "\[LessEqual]", " ", 
               RowBox[{"Length", "[", "edgecells", "]"}]}], ",", " ", 
              RowBox[{"icell", "++"}], ",", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"nextcell", "=", 
                RowBox[{"edgecells", "[", 
                 RowBox[{"[", "icell", "]"}], "]"}]}], ";", " ", 
               "\[IndentingNewLine]", 
               RowBox[{"dPrint", "[", 
                RowBox[{
                "\"\<-----------------> Force on vertex \>\"", " ", ",", 
                 "vertex", ",", " ", "\"\< along edge \>\"", ",", " ", "edge",
                  ",", "\"\< due to pressure in cell \>\"", ",", " ", 
                 "nextcell"}], "]"}], " ", ";", "\[IndentingNewLine]", 
               RowBox[{"TheCentroid", "=", 
                RowBox[{"centroids", "[", 
                 RowBox[{"[", "nextcell", "]"}], "]"}]}], ";", " ", 
               "\[IndentingNewLine]", 
               RowBox[{"AnOutwardVector", "=", 
                RowBox[{"TheMidPoint", "-", "TheCentroid"}]}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"AnOutwardVector", ".", "ANormalVector"}], "<", 
                  "0"}], ",", " ", 
                 RowBox[{"mult", "=", 
                  RowBox[{"-", "1.0"}]}], ",", " ", 
                 RowBox[{"mult", "=", "1.0"}]}], "]"}], ";", " ", 
               "\[IndentingNewLine]", 
               RowBox[{"TheNormalVector", "=", 
                RowBox[{
                 RowBox[{"Normalize", "[", "ANormalVector", "]"}], "*", 
                 "mult"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"TheNormalVectorVariables", "=", 
                RowBox[{"ANormalVectorVariables", "*", "mult"}]}], ";", " ", 
               "\[IndentingNewLine]", 
               RowBox[{"TheRates", " ", "=", " ", 
                RowBox[{"0.5", "*", 
                 RowBox[{
                  RowBox[{"pvar", "[", "icell", "]"}], "[", "Global`t", "]"}],
                  "*", "TheNormalVectorVariables"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"xRate", ",", "yRate"}], "}"}], "=", "TheRates"}], 
               ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"dPrint", "[", 
                RowBox[{
                "\"\<TheEdge: \>\"", ",", " ", "TheEdge", ",", " ", 
                 "\"\< TheVertices: \>\"", ",", " ", "TheVertices", ",", 
                 "\"\<The Vertices Variables: \>\"", ",", " ", 
                 "TheVerticesVariables", ",", "\"\< TheMidPoint: \>\"", ",", 
                 " ", "TheMidPoint", ",", " ", "\"\< Centroid: \>\"", ",", 
                 " ", "TheCentroid", ",", " ", "\"\< AnOutwardVector: \>\"", 
                 ",", " ", "AnOutwardVector", ",", " ", 
                 "\"\< ANormalVector: \>\"", ",", " ", "ANormalVector", ",", 
                 " ", "\"\< ANormalVectorVariables: \>\"", ",", " ", 
                 "ANormalVectorVariables", ",", " ", 
                 "\"\< TheNormalVector: \>\"", ",", " ", "TheNormalVector", 
                 ",", " ", "\"\< TheNormalVectorVariables: \>\"", ",", " ", 
                 "TheNormalVectorVariables", ",", " ", "\"\< TheRates:\>\"", 
                 ",", " ", "TheRates"}], "]"}], ";", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"xreactions", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Global`\[EmptySet]", "\[Rule]", 
                    RowBox[{"x", "[", "vertex", "]"}]}], ",", "xRate"}], 
                  "}"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"yreactions", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Global`\[EmptySet]", "\[Rule]", 
                    RowBox[{"y", "[", "vertex", "]"}]}], ",", "yRate"}], 
                  "}"}]}], "]"}], ";"}]}], " ", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}],
       ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ncells", " ", "=", " ", 
       RowBox[{"Length", "[", "c", "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"eqs", "=", 
       RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"icell", "=", "1"}], ",", " ", 
        RowBox[{"icell", "\[LessEqual]", " ", "ncells"}], ",", " ", 
        RowBox[{"icell", "++"}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AppendTo", "[", 
          RowBox[{"eqs", ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"pvar", "[", "icell", "]"}], "[", "Global`t", "]"}], 
            "\[Equal]", " ", 
            RowBox[{"pfunc", "[", "icell", "]"}]}]}], "]"}], ";"}]}], " ", 
       "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<Reactions: \>\"", ",", " ", 
        RowBox[{"{", 
         RowBox[{"xreactions", ",", " ", "yreactions"}], "}"}]}], "]"}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<Equations: \>\"", ",", " ", "eqs"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", " ", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\"\<reactions\>\"", "\[Rule]", " ", 
          RowBox[{"Join", "[", 
           RowBox[{"xreactions", ",", " ", "yreactions"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<equations\>\"", "\[Rule]", " ", "eqs"}]}], 
        "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwd0F1IUwEABeDLhlvb8qcUG4Gja3+6ZekeRomYRlmMpNLoQSbpckJhDcGW
UC6ZFXfSoJYtclkr0Zz2I2pT25wDByno1lVWLaLI+WBbS5ipNQ27Zw+H7+W8
nEMq1SUqFkEQWUzg8WiN1fY4WHjMKuuFOw5ViwYZ+3LF26HuczQTbuYIDkBC
vfMIpIwdxTD32blyuCi3KeHsywcXIR33XAMDY8oGOOAktXBNJNHDyba9BmjT
Wozw6s3QIzhxt7gLXrFPDUJO2tER6HrFc0P5Buc0PDN7bQaavsmCsD7+bxju
vhe3CGfOu5Zg8P6HKEx+d30VLh9+vQ5Lhj8SQ4zTFR0a/hNmH0Vp4a0icRNM
kZIm2C20m2ENaW2D276/fQrnjWsxHbrMbig6dXAYahL7aHj6vfYr/HnWMwd3
ZakjsCoh/w8sGrHHTOj0/4PV/fxUAePJT/EkHF85sR/y3NxSWNUoLocBQWMl
5O/ruQDZQksd1DXtqYeOznQdbE1V3YAtl8IU9IXMt6GqtMEEI0M5XdBjNQdg
kkQxB1kPWT/g7/TadfhG5uVtxA96YyI00L3JsJWrEEO6bGs2TKInc2A2IZDB
9hWpHL7wSxxhC9Nf7ok5sTTlhtE7nnEY4Xq9MM816oMpQr0fSr+0zMOChRDn
F2NzPpsPnbwtCkV7sHCTLyNmbd5CHaQM7MvwPyNMerQ=
  
  "],ExpressionUUID->"896fc7a2-8b27-42b9-95d8-4742c05ca1a1"]
}, Closed]],

Cell[CellGroupData[{

Cell["generateCelleratorOuterWallPressurePressureReactions", "Subsubsection",
 CellChangeTimes->{{3.546112855056963*^9, 
  3.546112858257736*^9}},ExpressionUUID->"04adcc91-7f4f-4829-8ee8-\
9dfa83e1b416"],

Cell[BoxData[
 RowBox[{
  RowBox[{"generateCelleratorOuterWallPressurePressureReactions", "[", 
   RowBox[{
   "x_", ",", "y_", ",", "P_", ",", "c_", ",", "cvn_", ",", " ", "e_", ",", 
    "outeredges_", ",", "vertexCoordinates_", ",", "vused_", ",", " ", 
    "eused_", ",", " ", 
    RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "r", ",", "reactions", ",", "allneighbors", ",", " ", "oddneighbor", ",",
       "neighbors", ",", "outerv", ",", "outere", ",", " ", "whichcell", ",", 
      
      RowBox[{"dbg", "=", "False"}], ",", " ", "dPrint", ",", "v"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dbg", "=", 
      RowBox[{
       RowBox[{"\"\<DebugPressure\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<DebugPressure\>\"", "\[Rule]", " ", "False"}], "}"}]}]}],
      ";", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dPrint", "[", "u___", "]"}], ":=", " ", 
      RowBox[{"If", "[", 
       RowBox[{"dbg", ",", " ", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<generateCelleratorOuterWallPressurePressureReactions: \>\"", 
          ",", "u"}], "]"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<outeredges: \>\"", ",", " ", "outeredges"}], "]"}], ";", 
     " ", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<e: \>\"", ",", " ", "e"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<cvn: \>\"", ",", " ", "cvn"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"outere", "=", 
      RowBox[{"e", "[", 
       RowBox[{"[", "outeredges", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<outere: \>\"", ",", " ", "outere"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"outerv", "=", 
      RowBox[{"Union", "[", 
       RowBox[{"Flatten", "[", "outere", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"neighbors", "[", "v_", "]"}], ":=", 
      RowBox[{"Complement", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"Select", "[", 
          RowBox[{"outere", ",", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"#", ",", "v"}], "]"}], "&"}]}], "]"}], "]"}], ",", 
        RowBox[{"{", "v", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"allneighbors", "[", "v_", "]"}], ":=", 
      RowBox[{"Complement", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"Select", "[", 
          RowBox[{"eused", ",", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"#", ",", "v"}], "]"}], "&"}]}], "]"}], "]"}], ",", 
        RowBox[{"{", "v", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"oddneighbor", "[", "v_", "]"}], ":=", 
      RowBox[{"Complement", "[", 
       RowBox[{
        RowBox[{"allneighbors", "[", "v", "]"}], ",", " ", 
        RowBox[{"neighbors", "[", "v", "]"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"r", "[", "i_", "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "j", ",", "k", ",", "n", ",", " ", "rx", ",", "ry", ",", "mult", ",",
           "dot"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"j", ",", "k"}], "}"}], "=", 
          RowBox[{"neighbors", "[", "i", "]"}]}], ";", "\[IndentingNewLine]", 
         
         RowBox[{"n", "=", 
          RowBox[{"oddneighbor", "[", "i", "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"n", " ", "=", " ", 
          RowBox[{"Select", "[", 
           RowBox[{"n", ",", " ", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{"vused", ",", "#"}], "]"}], "&"}]}], "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"dPrint", "[", 
          RowBox[{
          "\"\<Vertex i: \>\"", ",", " ", "i", ",", " ", 
           "\"\<, neighbors {j,k}: \>\"", ",", " ", 
           RowBox[{"{", 
            RowBox[{"j", ",", "k"}], "}"}], ",", "\"\<, oddneighbor n=\>\"", 
           ",", "n"}], "]"}], ";", " ", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "n", "]"}], ">", "0"}], ",", " ", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"n", "=", 
             RowBox[{"First", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "use", " ", "third", " ", "neighboring", " ", "vertex", " ", 
              "as", " ", "\"\<inside\>\"", " ", "point"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"v", "=", 
             RowBox[{"vertexCoordinates", "[", 
              RowBox[{"[", "n", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"dPrint", "[", 
             RowBox[{"\"\<using neighbor vertex = \>\"", ",", " ", "v"}], 
             "]"}], ";"}], " ", "\[IndentingNewLine]", ",", " ", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"whichcell", "=", 
             RowBox[{"Position", "[", 
              RowBox[{"cvn", ",", "i"}], "]"}]}], ";", "\[IndentingNewLine]", 
            
            RowBox[{"While", "[", 
             RowBox[{
              RowBox[{"ListQ", "[", "whichcell", "]"}], ",", 
              RowBox[{"whichcell", "=", 
               RowBox[{"First", "[", "whichcell", "]"}]}]}], "]"}], ";", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"v", "=", 
             RowBox[{"Centroid", "[", "\[IndentingNewLine]", 
              RowBox[{"vertexCoordinates", "[", 
               RowBox[{"[", "   ", 
                RowBox[{"cvn", "[", 
                 RowBox[{"[", "whichcell", "]"}], "]"}], "]"}], "]"}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"dPrint", "[", 
             RowBox[{"\"\<using cell centroid = \>\"", ",", " ", "v"}], "]"}],
             ";"}]}], " ", "\[IndentingNewLine]", "]"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"vector", " ", "now"}], "*)"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"rx", "=", 
          RowBox[{
           RowBox[{"vertexCoordinates", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "2"}], "]"}], "]"}], "-", 
           RowBox[{"vertexCoordinates", "[", 
            RowBox[{"[", 
             RowBox[{"k", ",", "2"}], "]"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ry", "=", 
          RowBox[{
           RowBox[{"vertexCoordinates", "[", 
            RowBox[{"[", 
             RowBox[{"k", ",", "1"}], "]"}], "]"}], "-", 
           RowBox[{"vertexCoordinates", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "1"}], "]"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"dot", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"{", 
             RowBox[{"rx", ",", "ry"}], "}"}], ")"}], ".", 
           RowBox[{"(", 
            RowBox[{"v", "-", 
             RowBox[{"vertexCoordinates", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"mult", "=", "1.0"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"dot", ">", "0"}], ",", 
           RowBox[{"mult", "=", 
            RowBox[{"-", "1.0"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"dynamic", " ", "vector"}], "*)"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"rx", "=", 
          RowBox[{"mult", "*", 
           RowBox[{"(", 
            RowBox[{"P", "/", "2"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"y", "[", "j", "]"}], "[", "Global`t", "]"}], "-", 
             RowBox[{
              RowBox[{"y", "[", "k", "]"}], "[", "Global`t", "]"}]}], 
            ")"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"ry", "=", 
          RowBox[{"mult", "*", 
           RowBox[{"(", 
            RowBox[{"P", "/", "2"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"x", "[", "k", "]"}], "[", "Global`t", "]"}], "-", 
             RowBox[{
              RowBox[{"x", "[", "j", "]"}], "[", "Global`t", "]"}]}], 
            ")"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Global`\[EmptySet]", "\[Rule]", 
              RowBox[{"x", "[", "i", "]"}]}], ",", "rx"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Global`\[EmptySet]", "\[Rule]", 
              RowBox[{"y", "[", "i", "]"}]}], ",", "ry"}], "}"}]}], "}"}]}]}],
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"reactions", "=", 
      RowBox[{"Join", "@@", 
       RowBox[{"(", 
        RowBox[{"r", "/@", "outerv"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<reactions: \>\"", ",", " ", "reactions"}], "]"}], ";", " ",
      "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "reactions", "]"}], ";"}]}], " ", 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.546112841875703*^9, 3.5461128418777037`*^9}, {
   3.5461129568156376`*^9, 3.5461130129772425`*^9}, 3.546172408828085*^9, 
   3.546187016891624*^9, {3.546187121014264*^9, 3.5461871777484093`*^9}, {
   3.546187297317013*^9, 3.5461873068634853`*^9}, {3.5461874240280533`*^9, 
   3.5461874848954372`*^9}, {3.546187682139491*^9, 3.546187716914341*^9}, {
   3.546187773454115*^9, 3.546187800980753*^9}, {3.546187832046767*^9, 
   3.5461878455609503`*^9}, {3.546201397624823*^9, 3.5462013986761303`*^9}, {
   3.5462015116768637`*^9, 3.5462015401201563`*^9}, {3.546201831009985*^9, 
   3.546201856059967*^9}, {3.546202058331212*^9, 3.546202068155924*^9}, {
   3.5462021130360203`*^9, 3.546202252684861*^9}, {3.546202330204088*^9, 
   3.546202361969141*^9}, {3.546202400804666*^9, 3.546202473689612*^9}, {
   3.5462025104438763`*^9, 3.546202513217813*^9}, {3.54620341792826*^9, 
   3.54620341867741*^9}, 3.547054068156151*^9, {3.54705410405114*^9, 
   3.547054104694634*^9}, {3.5470542724165087`*^9, 3.547054313046137*^9}, {
   3.5470544946790657`*^9, 3.547054495410308*^9}, {3.5471307850690536`*^9, 
   3.54713084111198*^9}, {3.547131342374082*^9, 3.5471313747383213`*^9}, {
   3.547131442213542*^9, 3.54713149480881*^9}, {3.556661071983603*^9, 
   3.556661089512267*^9}, 3.556661181302135*^9, {3.556661258704975*^9, 
   3.556661260416346*^9}, {3.556661304382785*^9, 3.5566613174760513`*^9}, {
   3.5566615939979687`*^9, 3.556661622298737*^9}, {3.556661654341338*^9, 
   3.556661663007493*^9}, 3.556661894958363*^9, {3.556662181370377*^9, 
   3.556662182924485*^9}, {3.55666221924677*^9, 
   3.5566622197468224`*^9}},ExpressionUUID->"0414336a-d624-47be-8724-\
01e08cd1c796"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ShowPressureArrows", " ", 
  RowBox[{"(", 
   RowBox[{
   "used", " ", "for", " ", "debugging", " ", 
    "generateCelleratorOuterWallPressurePressureReactions"}], 
   ")"}]}]], "Subsubsection",
 CellChangeTimes->{{3.546186259856697*^9, 
  3.546186295020904*^9}},ExpressionUUID->"381563b4-be9a-4793-9a0c-\
c60240b29d1c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ShowPressureArrows", "[", 
    RowBox[{
    "sim_", ",", "DT_", ",", "time_", ",", "pressure_", ",", "x_", ",", "y_", 
     ",", " ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "T", ",", "nv", ",", "n", ",", "origins", ",", "indices", ",", "xy", 
       ",", "ct", ",", "ctr", ",", "cvn", ",", " ", "vr", ",", 
       RowBox[{"gt", "=", "Global`t"}], ",", "directions", ",", "a", ",", 
       "cells", ",", "be", ",", "edges", ",", "PR", ",", "g", ",", "vused", 
       ",", " ", "dbg", ",", "dPrint", ",", "edgesused"}], "}"}], ",", " ", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dbg", "=", 
       RowBox[{
        RowBox[{"\"\<DebugPressure\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<DebugPressure\>\"", "\[Rule]", " ", "False"}], 
         "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dPrint", "[", "u___", "]"}], ":=", " ", 
       RowBox[{"If", "[", 
        RowBox[{"dbg", ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<ShowPressureArrows: \>\"", ",", "u"}], "]"}]}], 
        "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"vused", " ", "=", " ", 
       RowBox[{"VerticesUsed", "[", "DT", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"nv", "=", 
       RowBox[{"NTissueVertices", "[", "DT", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xy", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"x", "[", "#", "]"}], "[", "gt", "]"}], ",", 
             RowBox[{
              RowBox[{"y", "[", "#", "]"}], "[", "gt", "]"}]}], "}"}], "&"}], 
          "/@", 
          RowBox[{"Range", "[", "nv", "]"}]}], "/.", 
         RowBox[{"Flatten", "[", "sim", "]"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"gt", "\[Rule]", "time"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ct", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"x", "[", "#", "]"}], "[", "gt", "]"}], ",", 
           RowBox[{
            RowBox[{"y", "[", "#", "]"}], "[", "gt", "]"}]}], "}"}], "&"}], "/@", 
        RowBox[{"Range", "[", "nv", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ctr", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Rule", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Flatten", "[", "ct", "]"}], ",", 
           RowBox[{"Flatten", "[", "xy", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"T", "=", 
       RowBox[{"DTissue2Tissue", "[", "DT", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"cells", "=", 
       RowBox[{"TissueCells", "[", "T", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"edges", "=", 
       RowBox[{"TissueEdges", "[", "T", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"edgesused", " ", "=", " ", 
       RowBox[{"edges", "[", 
        RowBox[{"[", 
         RowBox[{"EdgesUsed", "[", "T", "]"}], "]"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<edges: \>\"", ",", " ", "edges"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<edgesused: \>\"", ",", " ", "edgesused"}], "]"}], ";", 
      " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"be", "=", 
       RowBox[{"EdgesOnBoundary", "[", "T", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"cvn", " ", "=", " ", 
       RowBox[{"CellVertexNumbers", "[", "T", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"PR", "=", 
       RowBox[{"generateCelleratorOuterWallPressurePressureReactions", "[", 
        RowBox[{
        "x", ",", "y", ",", "pressure", ",", "cells", ",", "cvn", ",", " ", 
         "edges", ",", "be", ",", "xy", ",", "vused", ",", "edgesused", ",", 
         " ", "opt"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vr", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"interpret", "[", "PR", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "/.", "ctr"}], "/.", 
        RowBox[{"{", 
         RowBox[{"pressure", "\[Rule]", "1"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"indices", "=", 
       RowBox[{"Sort", "[", 
        RowBox[{"VerticesOnBoundary", "[", "T", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"origins", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"x", "[", "#", "]"}], "[", "gt", "]"}], ",", 
             RowBox[{
              RowBox[{"y", "[", "#", "]"}], "[", "gt", "]"}]}], "}"}], "&"}], 
          "/@", "indices"}], "/.", 
         RowBox[{"Flatten", "[", "sim", "]"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"gt", "\[Rule]", "time"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "indices", "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"directions", "=", 
       RowBox[{
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{"Last", "/@", "vr"}], ",", "n"}], "]"}], "//", 
        "Transpose"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"a", "=", 
       RowBox[{"Graphics", "[", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Arrow", "[", 
            RowBox[{"{", 
             RowBox[{"#1", ",", 
              RowBox[{"#1", "+", "#2"}]}], "}"}], "]"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"origins", ",", "directions"}], "}"}]}], "]"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"g", "=", 
       RowBox[{"SimShow", "[", 
        RowBox[{"sim", ",", "time", ",", "DT", ",", "opt"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"g", ",", "a"}], "}"}], ",", 
        RowBox[{"MyFilterOptions", "[", 
         RowBox[{"Graphics", ",", "opt"}], "]"}]}], "]"}]}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5461862451878967`*^9, 3.54618624518943*^9}, {
  3.546186311607589*^9, 3.546186318515195*^9}, {3.546187913861726*^9, 
  3.546187922540917*^9}, {3.546203028291703*^9, 3.546203060204685*^9}, {
  3.546203353898736*^9, 3.5462033563503647`*^9}, {3.54705437385949*^9, 
  3.547054388664516*^9}, {3.547054432155013*^9, 3.547054461566041*^9}, {
  3.556661135451234*^9, 3.5566611359330177`*^9}, {3.556661833681486*^9, 
  3.556661884714302*^9}, {3.55666192197755*^9, 3.556661946161887*^9}, {
  3.556662000316112*^9, 3.556662098464964*^9}, {3.556662131970306*^9, 
  3.5566621750811043`*^9}},ExpressionUUID->"81020aac-2c80-4584-bd24-\
58d9a469c076"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["ProcessVolumeCorrectionArrows", "Subsection",
 CellChangeTimes->{{3.5783420227438173`*^9, 
  3.578342035406452*^9}},ExpressionUUID->"99840edd-e361-4eba-9846-\
118bbe05853a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ProcessVolumeCorrectionArrows", "[", 
    RowBox[{"net_", ",", " ", "growing_", ",", " ", "cell_"}], "]"}], ":=", 
   " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{"species", ",", 
       RowBox[{"dbg", "=", "False"}], ",", " ", "dPrint", ",", "arrow", ",", 
       " ", "rnew"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"dPrint", "[", "u___", "]"}], ":=", " ", 
       RowBox[{"If", "[", 
        RowBox[{"dbg", ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<ProcessVolumeCorrectionArrows: \>\"", ",", " ", "u"}], 
          "]"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "[", "growing", "]"}], ",", " ", 
        RowBox[{"Return", "[", 
         RowBox[{"{", "}"}], "]"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
      
      RowBox[{"species", "=", 
       RowBox[{
        RowBox[{"interpret", "[", "net", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<species: \>\"", ",", " ", "species"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"arrow", "[", "var_", "]"}], ":=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"var", "\[Rule]", " ", "Global`\[EmptySet]"}], ",", " ", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{
            RowBox[{"cell", "'"}], "[", "Global`t", "]"}]}], "/", 
          RowBox[{"cell", "[", "Global`t", "]"}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"rnew", " ", "=", " ", 
       RowBox[{"arrow", "/@", "species"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<rnew: \>\"", ",", " ", "rnew"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "rnew", "]"}], ";"}]}], " ", 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.578342028644381*^9, 3.578342143953496*^9}, {
  3.578342458770214*^9, 3.5783425279589567`*^9}, {3.578342616268978*^9, 
  3.5783427836046886`*^9}, {3.578342820972333*^9, 3.578342823022582*^9}, {
  3.578343007934589*^9, 3.578343010352343*^9}, {3.578343184670557*^9, 
  3.5783431913772297`*^9}, {3.578343287772287*^9, 3.578343338559025*^9}, {
  3.578343786870927*^9, 
  3.57834378935807*^9}},ExpressionUUID->"23011767-972f-4560-a4b0-\
7f70cae564d2"]
}, Closed]],

Cell[CellGroupData[{

Cell["ProcessCellzillaArrows", "Subsection",
 CellChangeTimes->{{3.575392695543281*^9, 3.575392701198428*^9}, {
  3.575392732783332*^9, 
  3.57539273435121*^9}},ExpressionUUID->"4357585b-0c14-4954-ae41-\
2ea7779de468"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TransportQ", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"X_", "\[LongRightArrow]", "X_"}], ",", "  ", 
      RowBox[{"Transport", "[", "u___", "]"}]}], "}"}], "]"}], ":=", " ", 
   "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TransportQ", "[", "u___", "]"}], ":=", " ", "False"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BadTransportQ", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"X_", "\[LongRightArrow]", " ", "Y_"}], ",", " ", 
       RowBox[{"Transport", "[", "u___", "]"}]}], "}"}], "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"ToString", "[", "X", "]"}], "\[NotEqual]", " ", 
      RowBox[{"ToString", "[", "Y", "]"}]}], ")"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BadTransportQ", "[", "X___", "]"}], ":=", " ", "False"}], ";"}], 
  " ", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DiffusionReactionQ", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"X_", "\[LongRightArrow]", " ", "X_"}], ",", " ", 
       RowBox[{"Diffusion", "[", "u___", "]"}]}], "}"}], "]"}], ":=", " ", 
    "True"}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DiffusionReactionQ", "[", "X___", "]"}], ":=", " ", "False"}], 
   ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BadDiffusionQ", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"X_", "\[LongRightArrow]", " ", "Y_"}], ",", " ", 
       RowBox[{"Diffusion", "[", "u___", "]"}]}], "}"}], "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"ToString", "[", "X", "]"}], "\[NotEqual]", " ", 
      RowBox[{"ToString", "[", "Y", "]"}]}], ")"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BadDiffusionQ", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"X_", "\[Rule]", " ", "Y_"}], ",", " ", 
       RowBox[{"Diffusion", "[", "u___", "]"}]}], "}"}], "]"}], ":=", " ", 
    "True"}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BadDiffusionQ", "[", "X___", "]"}], ":=", " ", "False"}], ";"}], 
  " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IGRNQ", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"RightTeeArrow", "[", 
        RowBox[{"X_", ",", " ", "Y_"}], "]"}], ",", " ", 
       RowBox[{"IGRN", "[", "Z___", "]"}]}], "}"}], "]"}], ":=", " ", 
    "True"}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IGRNQ", "[", "X___", "]"}], ":=", " ", "False"}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IGRN2GRN", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"RightTeeArrow", "[", 
      RowBox[{"X_", ",", " ", "Y_"}], "]"}], ",", " ", 
     RowBox[{"IGRN", "[", "Z___", "]"}]}], "}"}], "]"}], ":=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"RightTeeArrow", "[", 
     RowBox[{"X", ",", " ", "Y"}], "]"}], ",", " ", 
    RowBox[{"GRN", "[", "Z", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IGRN2GRN", "[", "X___", "]"}], ":=", " ", 
    RowBox[{"AbortIf", "[", 
     RowBox[{"True", ",", " ", 
      RowBox[{"\"\<IGRN2GRN: expecting an IGRN arrow, not: \>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{"InputForm", "[", "X", "]"}], "]"}]}]}], "]"}]}], ";"}], " ", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SpringQ", "[", 
     RowBox[{"Spring", "[", "X___", "]"}], "]"}], ":=", " ", "True"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SpringQ", "[", "X___", "]"}], ":=", " ", "False"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GrowthRateQ", "[", 
     RowBox[{"GrowthRate", "[", "X___", "]"}], "]"}], ":=", " ", "True"}], 
   ";"}], "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GrowthRateQ", "[", "X___", "]"}], ":=", " ", "False"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PressureQ", "[", 
    RowBox[{"Pressure", "[", "X___", "]"}], "]"}], ":=", " ", "True"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PressureQ", "[", "X___", "]"}], ":=", " ", "False"}], ";"}], " ",
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProcessCellzillaArrows", "[", 
   RowBox[{"opt___", "?", "OptionQ"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "opt1", ",", " ", "optt", ",", " ", "net", ",", " ", "onet", ",", " ", 
      "PR", ",", "PRQ", ",", "  ", 
      RowBox[{"dbg", "=", "False"}], ",", "PV", ",", "PA", ",", " ", "dPrint",
       ",", " ", "ArgReaction", ",", " ", "SpeciesReaction", ",", " ", 
      "explicitPumps", ",", " ", "DR", ",", " ", "DRQ", ",", " ", "DV", ",", 
      " ", "DA", ",", " ", "explicitDR", ",", " ", "IR", ",", " ", 
      "explicitIR", ",", " ", "IRQ", ",", " ", "GA", ",", " ", "GAQ", ",", 
      " ", "ArgsGrow", ",", " ", "kS", ",", " ", "muS", ",", " ", "pS", ",", 
      "cell", ",", " ", "GrowthQ", ",", " ", "BadGrowthQ", ",", " ", "BGQ", 
      ",", " ", "BG", ",", "cellq", ",", " ", "notcellq", ",", " ", 
      "DivisionQ", ",", " ", "DAQ", ",", " ", "DivA", ",", " ", 
      "DivisionArgs", ",", " ", "DivisionRule", ",", " ", "divVar", ",", " ", 
      "divThreshold", ",", " ", "divSigma", ",", " ", "divWeight", ",", " ", 
      "arguments", ",", " ", "SymbolQ", ",", " ", "theDivaA", ",", " ", 
      "divRule", ",", " ", "BadDivisionQ", ",", " ", "BD", ",", " ", "BDQ", 
      ",", " ", "BadD", ",", " ", "BadT", ",", " ", "VCA", ",", " ", "VC"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"dPrint", "[", "x___", "]"}], ":=", " ", 
      RowBox[{"If", "[", 
       RowBox[{"dbg", ",", " ", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<ProcessCellzillaArrows: \>\"", ",", " ", "x"}], "]"}]}],
        "]"}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SymbolQ", "[", "X_", "]"}], ":=", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"Head", "[", "X", "]"}], "]"}], "\[Equal]", 
        "\"\<Symbol\>\""}], ")"}]}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"cell", "=", 
      RowBox[{
       RowBox[{"\"\<CellVariable\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<CellVariable\>\"", "\[Rule]", " ", "Global`cell"}], 
        "}"}]}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cellq", "[", "x_", "]"}], ":=", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ToString", "[", "x", "]"}], "\[Equal]", " ", 
        RowBox[{"ToString", "[", "cell", "]"}]}], ")"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"notcellq", "[", "x_", "]"}], ":=", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ToString", "[", "x", "]"}], "\[NotEqual]", " ", 
        RowBox[{"ToString", "[", "cell", "]"}]}], ")"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"arguments", "[", 
       RowBox[{"f_", "[", "x___", "]"}], "]"}], ":=", " ", 
      RowBox[{"{", "x", "}"}]}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"GrowthQ", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"cell", "\[LongRightArrow]", "cell"}], ",", " ", 
         RowBox[{"Grow", "[", "Z___", "]"}]}], "}"}], "]"}], ":=", " ", 
      "True"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"GrowthQ", "[", "X___", "]"}], ":=", " ", "False"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"BadGrowthQ", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"X_", "?", "notcellq"}], "\[LongRightArrow]", 
          RowBox[{"Y_", "?", "notcellq"}]}], ",", " ", 
         RowBox[{"Grow", "[", "Z___", "]"}]}], "}"}], "]"}], ":=", " ", 
      "True"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"BadGrowthQ", "[", "X___", "]"}], ":=", " ", "False"}], ";", 
     " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DivisionQ", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"cell", "\[LongRightArrow]", "cell"}], "+", "cell"}], ",", 
         " ", 
         RowBox[{"ErreraRule", "[", "Z___", "]"}]}], "}"}], "]"}], ":=", " ", 
      "True"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DivisionQ", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"cell", "\[LongRightArrow]", "cell"}], "+", "cell"}], ",", 
         " ", 
         RowBox[{"Potential", "[", "Z___", "]"}]}], "}"}], "]"}], ":=", " ", 
      "True"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DivisionQ", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"cell", "\[LongRightArrow]", "cell"}], "+", "cell"}], ",", 
         " ", 
         RowBox[{"UnknownRule_", "[", "Z___", "]"}]}], "}"}], "]"}], ":=", 
      " ", "True"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DivisionQ", "[", "X___", "]"}], ":=", " ", "False"}], ";", " ",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"BadDivisionQ", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"cell", "\[LongRightArrow]", "cell"}], "+", 
          RowBox[{"X_", "?", "notcellq"}]}], ",", 
         RowBox[{"f_", "[", "Z___", "]"}]}], "}"}], "]"}], ":=", " ", 
      "True"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"BadDivisionQ", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Z_", "\[LongRightArrow]", "X_"}], "+", "Y_"}], ",", " ", 
         RowBox[{"f_", "[", "u___", "]"}]}], "}"}], "]"}], ":=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"notcellq", "[", "X", "]"}], "\[Or]", 
         RowBox[{"notcellq", "[", "Y", "]"}], "\[Or]", 
         RowBox[{"notcellq", "[", "Z", "]"}]}], ")"}], "\[And]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"cellq", "[", "X", "]"}], "\[Or]", 
         RowBox[{"cellq", "[", "Y", "]"}], "\[Or]", 
         RowBox[{"cellq", "[", "Z", "]"}]}], ")"}]}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"BadDivisionQ", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"cell", "\[LongRightArrow]", "cell"}], "+", " ", "cell"}], 
        "}"}], "]"}], ":=", " ", "True"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"BadDivisionQ", "[", "Y___", "]"}], ":=", " ", "False"}], ";", 
     " ", "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DivisionArgs", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"cell", "\[LongRightArrow]", "cell"}], "+", "cell"}], ",", 
         " ", 
         RowBox[{"ErreraRule", "[", "Z___", "]"}]}], "}"}], "]"}], ":=", " ", 
      
      RowBox[{"ErreraRule", "[", "Z", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DivisionArgs", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"cell", "\[LongRightArrow]", "cell"}], "+", "cell"}], ",", 
         " ", 
         RowBox[{"Potential", "[", "Z___", "]"}]}], "}"}], "]"}], ":=", 
      RowBox[{"Potential", "[", "Z", "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DivisionArgs", "[", "Z___", "]"}], ":=", 
      RowBox[{"AbortIf", "[", 
       RowBox[{"True", ",", " ", 
        RowBox[{"\"\<ProcessCellzillaArrows: DivisionArgs: Expecting {\>\"", "<>", 
         RowBox[{"ToString", "[", "cell", "]"}], "<>", 
         "\"\<\[LongRightArrow]\>\"", "<>", 
         RowBox[{"ToString", "[", "cell", "]"}], "<>", "\"\<+\>\"", "<>", 
         RowBox[{"ToString", "[", "cell", "]"}], "<>", 
         "\"\<, SomeValidRule[\[Ellipsis]]} and not \>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"InputForm", "[", "Z", "]"}], "]"}]}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DivisionRule", "[", 
       RowBox[{"ErreraRule", "[", "X___", "]"}], "]"}], ":=", " ", 
      "\"\<Errera\>\""}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DivisionRule", "[", 
       RowBox[{"Potential", "[", "X___", "]"}], "]"}], ":=", " ", 
      "\"\<Potential\>\""}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DivisionRule", "[", "Unknown___", "]"}], ":=", " ", 
      RowBox[{"AbortIf", "[", 
       RowBox[{"True", ",", " ", 
        RowBox[{"\"\<ProcessCellzillaArrows: Invalid Division Rule \>\"", "<>", 
         RowBox[{"ToString", "[", "Unknown", "]"}]}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ArgReaction", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"X_", "\[LongRightArrow]", " ", "X_"}], ",", " ", 
         RowBox[{"Y_", "[", "Z___", "]"}]}], "}"}], "]"}], ":=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{"{", "Z", "}"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SpeciesReaction", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"X_", "\[LongRightArrow]", "X_"}], ",", " ", 
         RowBox[{"Y_", "[", "Z___", "]"}]}], "}"}], "]"}], ":=", " ", "X"}], 
     ";", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ArgsGrow", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"cell", "\[LongRightArrow]", "cell"}], ",", 
         RowBox[{"Grow", "[", "Z___", "]"}]}], "}"}], "]"}], ":=", " ", 
      RowBox[{"{", "Z", "}"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ArgsGrow", "[", "Z___", "]"}], ":=", " ", 
      RowBox[{"AbortIf", "[", 
       RowBox[{"True", ",", " ", 
        RowBox[{"\"\<ProcessCellzillaArrows: ArgsGrow: Expecting {\>\"", "<>", 
         RowBox[{"ToString", "[", "cell", "]"}], "<>", 
         "\"\<\[LongRightArrow]\>\"", "<>", 
         RowBox[{"ToString", "[", "cell", "]"}], "<>", 
         "\"\<,Grow[\[Ellipsis]]} and not \>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"InputForm", "[", "Z", "]"}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"net", " ", "=", " ", 
      RowBox[{
       RowBox[{"\"\<Reactions\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<Reactions\>\"", "\[Rule]", " ", 
         RowBox[{"{", "}"}]}], "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"onet", " ", "=", " ", "net"}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"keep", " ", "because", " ", "of", " ", "sorting"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Extract", " ", "Pump", " ", "Reactions"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"PRQ", " ", "=", " ", 
      RowBox[{"TransportQ", "/@", "net"}]}], ";", " ", "\[IndentingNewLine]", 
     
     RowBox[{"PR", " ", "=", " ", 
      RowBox[{"Pick", "[", 
       RowBox[{"net", ",", " ", "PRQ"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"net", " ", "=", " ", 
      RowBox[{"Complement", "[", 
       RowBox[{"net", ",", " ", "PR"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<Pump Reactions: \>\"", ",", " ", "PR"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<rest of network: \>\"", ",", " ", "net"}], "]"}], ";", " ",
      "\[IndentingNewLine]", 
     RowBox[{"PV", " ", "=", " ", 
      RowBox[{"SpeciesReaction", "/@", "PR"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"PA", " ", "=", " ", 
      RowBox[{"ArgReaction", "/@", "PR"}]}], ";", " ", "\[IndentingNewLine]", 
     
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<Pump Variables: \>\"", ",", " ", "PV"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<Pump Arguments: \>\"", " ", ",", "PA"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"PR", " ", "=", " ", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Prepend", "[", 
          RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"PA", ",", " ", "PV"}], "}"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<PR: \>\"", ",", " ", "PR"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"explicitPumps", "=", 
      RowBox[{
       RowBox[{"\"\<Pumps\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<Pumps\>\"", "\[Rule]", " ", 
         RowBox[{"{", "}"}]}], "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"PR", " ", "=", " ", 
      RowBox[{"Join", "[", 
       RowBox[{"PR", ",", " ", "explicitPumps"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<PR: \>\"", ",", " ", "PR"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"optt", " ", "=", " ", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"{", "opt", "}"}], ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"ToString", "[", 
           RowBox[{"First", "[", "#", "]"}], "]"}], "\[NotEqual]", " ", 
          "\"\<Pumps\>\""}], "&"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"BadT", " ", "=", " ", 
      RowBox[{"BadTransportQ", "/@", "onet"}]}], ";", "  ", 
     "\[IndentingNewLine]", 
     RowBox[{"BadT", " ", "=", " ", 
      RowBox[{"Pick", "[", 
       RowBox[{"onet", ",", " ", "BadT"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"AbortIf", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "BadT", "]"}], ">", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
       "\"\<There are incorrectly formatted Transport Reactions, which must \
have the precise form {X\[LongRightArrow]X,Transport[\[Ellipsis]]}, with the \
same variable on both sides of the arrow, and not \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"InputForm", "[", "BadT", "]"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Extract", " ", "Diffusion"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"DRQ", " ", "=", " ", 
      RowBox[{"DiffusionReactionQ", "/@", "net"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"DR", " ", "=", " ", 
      RowBox[{"Pick", "[", 
       RowBox[{"net", ",", " ", "DRQ"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"net", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{"net", ",", " ", "DR"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"DV", " ", "=", " ", 
      RowBox[{"SpeciesReaction", "/@", "DR"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"DA", " ", "=", " ", 
      RowBox[{"ArgReaction", "/@", "DR"}]}], ";", " ", "\[IndentingNewLine]", 
     
     RowBox[{"DR", " ", "=", " ", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Prepend", "[", 
          RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"DA", ",", "DV"}], "}"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"explicitDR", " ", "=", " ", 
      RowBox[{
       RowBox[{"\"\<Diffusion\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<Diffusion\>\"", "\[Rule]", " ", 
         RowBox[{"{", "}"}]}], "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"DR", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"DR", ",", " ", "explicitDR"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"optt", " ", "=", " ", 
      RowBox[{"Select", "[", 
       RowBox[{"optt", ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"ToString", "[", 
           RowBox[{"First", "[", "#", "]"}], "]"}], "\[NotEqual]", " ", 
          "\"\<Diffusion\>\""}], "&"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"BadD", " ", "=", " ", 
      RowBox[{"BadDiffusionQ", "/@", "onet"}]}], ";", "  ", 
     "\[IndentingNewLine]", 
     RowBox[{"BadD", " ", "=", " ", 
      RowBox[{"Pick", "[", 
       RowBox[{"onet", ",", " ", "BadD"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"AbortIf", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "BadD", "]"}], ">", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
       "\"\<There are incorrectly formatted Diffusion Reactions, which must \
have the precise form {X\[LongRightArrow]X,Diffusion[\[Ellipsis]]}, with the \
same variable on both sides of the arrow, and not \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"InputForm", "[", "BadD", "]"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Extract", " ", "Intracellular", " ", "GRN", " ", "Arrows"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"IRQ", " ", "=", " ", 
      RowBox[{"IGRNQ", "/@", "net"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"IR", " ", "=", " ", 
      RowBox[{"Pick", "[", 
       RowBox[{"net", ",", " ", "IRQ"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"net", " ", "=", " ", 
      RowBox[{"Complement", "[", 
       RowBox[{"net", ",", " ", "IR"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"IR", " ", "=", " ", 
      RowBox[{"IGRN2GRN", "/@", "IR"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"explicitIR", " ", "=", " ", 
      RowBox[{
       RowBox[{"\"\<Intercellular\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<Intercellular\>\"", "\[Rule]", " ", 
         RowBox[{"{", "}"}]}], "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"IR", " ", "=", " ", 
      RowBox[{"Join", "[", 
       RowBox[{"IR", ",", " ", "explicitIR"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"optt", " ", "=", " ", 
      RowBox[{"Select", "[", 
       RowBox[{"optt", ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"ToString", "[", 
           RowBox[{"First", "[", "#", "]"}], "]"}], "\[NotEqual]", " ", 
          "\"\<Intercellular\>\""}], "&"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "Extract", " ", "any", " ", "growth", " ", "arrows", " ", "from", " ", 
        "onet"}], ",", " ", 
       RowBox[{
       "but", " ", "remove", " ", "from", " ", "net", " ", "to", " ", "keep", 
        " ", "ordering"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"GAQ", " ", "=", " ", 
      RowBox[{"GrowthQ", "/@", "onet"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"GA", " ", "=", " ", 
      RowBox[{"Pick", "[", 
       RowBox[{"onet", ",", " ", "GAQ"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"net", " ", "=", " ", 
      RowBox[{"Complement", "[", 
       RowBox[{"net", ",", " ", "GA"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"GA", " ", "=", " ", 
      RowBox[{"ArgsGrow", "/@", "GA"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"GA", " ", "=", " ", 
      RowBox[{"Join", "@@", "GA"}]}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"kS", "=", 
      RowBox[{"Pick", "[", 
       RowBox[{"GA", ",", " ", 
        RowBox[{"SpringQ", "/@", "GA"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "kS", "]"}], "\[GreaterEqual]", " ", "1"}], 
       ",", " ", "\[IndentingNewLine]", 
       RowBox[{"kS", "=", 
        RowBox[{
         RowBox[{"First", "[", "kS", "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{"Spring", "\[Rule]", " ", "List"}], "}"}]}]}], ",", "  ", 
       "\[IndentingNewLine]", 
       RowBox[{"kS", "=", " ", 
        RowBox[{
         RowBox[{"\"\<k\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<k\>\"", "\[Rule]", "Global`k"}], "}"}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"optt", " ", "=", " ", 
      RowBox[{"Select", "[", 
       RowBox[{"optt", ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"ToString", "[", 
           RowBox[{"First", "[", "#", "]"}], "]"}], "\[NotEqual]", " ", 
          "\"\<k\>\""}], "&"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"muS", " ", "=", " ", 
      RowBox[{"Pick", "[", 
       RowBox[{"GA", ",", " ", 
        RowBox[{"GrowthRateQ", "/@", "GA"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "muS", "]"}], "\[GreaterEqual]", " ", "1"}], 
       ",", " ", "\[IndentingNewLine]", 
       RowBox[{"muS", "=", 
        RowBox[{
         RowBox[{"First", "[", "muS", "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{"GrowthRate", "\[Rule]", " ", "List"}], "}"}]}]}], ",", " ",
        "\[IndentingNewLine]", 
       RowBox[{"muS", "=", 
        RowBox[{
         RowBox[{"\"\<mu\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<mu\>\"", "\[Rule]", " ", "Global`\[Mu]"}], "}"}]}]}]}],
       "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"optt", " ", "=", " ", 
      RowBox[{"Select", "[", 
       RowBox[{"optt", ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"ToString", "[", 
           RowBox[{"First", "[", "#", "]"}], "]"}], "\[NotEqual]", " ", 
          "\"\<mu\>\""}], "&"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"pS", " ", "=", " ", 
      RowBox[{"Pick", "[", 
       RowBox[{"GA", ",", " ", 
        RowBox[{"PressureQ", "/@", "GA"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "pS", "]"}], "\[GreaterEqual]", " ", "1"}], 
       ",", " ", "\[IndentingNewLine]", 
       RowBox[{"pS", "=", 
        RowBox[{
         RowBox[{"First", "[", "pS", "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{"Pressure", "\[Rule]", " ", "List"}], "}"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"pS", "=", 
        RowBox[{
         RowBox[{"\"\<P\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<P\>\"", "\[Rule]", " ", "Global`P"}], "}"}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"optt", " ", "=", " ", 
      RowBox[{"Select", "[", 
       RowBox[{"optt", ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"ToString", "[", 
           RowBox[{"First", "[", "#", "]"}], "]"}], "\[NotEqual]", " ", 
          "\"\<P\>\""}], "&"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<kS= \>\"", ",", " ", "kS"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<muS= \>\"", ",", " ", "muS"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<pS=\>\"", ",", " ", "pS"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Check", " ", "for", " ", "badly", " ", "formatted", " ", "Growth", " ",
        "reactions"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"BGQ", " ", "=", " ", 
      RowBox[{"BadGrowthQ", "/@", "onet"}]}], ";", "  ", 
     "\[IndentingNewLine]", 
     RowBox[{"BG", " ", "=", " ", 
      RowBox[{"Pick", "[", 
       RowBox[{"onet", ",", " ", "BGQ"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"AbortIf", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "BG", "]"}], ">", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
       "\"\<There are incorrectly formatted Growth Reactions, which must only \
refer to the CellVariable \\\"\>\"", "<>", 
        RowBox[{"ToString", "[", "cell", "]"}], "<>", 
        "\"\<\\\" in the reaction arrow, e.g.,  as {\>\"", "<>", 
        RowBox[{"ToString", "[", "cell", "]"}], "<>", 
        "\"\<\[LongRightArrow]\>\"", "<>", 
        RowBox[{"ToString", "[", "cell", "]"}], "<>", 
        "\"\<,Grow[\[Ellipsis]]}, and not as \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"InputForm", "[", "BG", "]"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Pick", " ", "out", " ", "the", " ", "Division", " ", "Arrows"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"DAQ", " ", "=", " ", 
      RowBox[{"DivisionQ", "/@", "onet"}]}], ";", " ", "\[IndentingNewLine]", 
     
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<DAQ: \>\"", ",", " ", "DAQ"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"DivA", " ", "=", " ", 
      RowBox[{"Pick", "[", 
       RowBox[{"onet", ",", " ", "DAQ"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "DivA", "]"}], ">", "0"}], ",", " ", 
       RowBox[{"theDivaA", "=", 
        RowBox[{"First", "[", "DivA", "]"}]}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"net", " ", "=", " ", 
      RowBox[{"Complement", "[", 
       RowBox[{"net", ",", " ", "DivA"}], "]"}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"DivA", "=", 
      RowBox[{"DivisionArgs", "/@", "DivA"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "get", " ", "default", " ", "values", " ", "from", " ", "options", " ",
         "in", " ", "case", " ", "not", " ", "specified"}], ",", " ", 
       RowBox[{"then", " ", "reomve", " ", "from", " ", "options"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"divThreshold", "=", 
      RowBox[{
       RowBox[{"\"\<DivisionThreshold\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<DivisionThreshold\>\"", "\[Rule]", " ", "Infinity"}], 
        "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"optt", " ", "=", " ", 
      RowBox[{"Select", "[", 
       RowBox[{"optt", ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"ToString", "[", 
           RowBox[{"First", "[", "#", "]"}], "]"}], "\[NotEqual]", " ", 
          "\"\<divThreshold\>\""}], "&"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"divSigma", "=", 
      RowBox[{
       RowBox[{"\"\<DivisionSigma\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<DivisionSigma\>\"", "\[Rule]", " ", "0.1"}], "}"}]}]}], 
     ";", " ", "\[IndentingNewLine]", 
     RowBox[{"optt", " ", "=", " ", 
      RowBox[{"Select", "[", 
       RowBox[{"optt", ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"ToString", "[", 
           RowBox[{"First", "[", "#", "]"}], "]"}], "\[NotEqual]", " ", 
          "\"\<divSigma\>\""}], "&"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"divVar", "=", 
      RowBox[{
       RowBox[{"\"\<DivisionVariable\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<DivisionVariable\>\"", "\[Rule]", " ", "cell"}], 
        "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"optt", " ", "=", " ", 
      RowBox[{"Select", "[", 
       RowBox[{"optt", ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"ToString", "[", 
           RowBox[{"First", "[", "#", "]"}], "]"}], "\[NotEqual]", " ", 
          "\"\<divVar\>\""}], "&"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"divWeight", "=", 
      RowBox[{
       RowBox[{"\"\<Weight\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<Weight\>\"", "\[Rule]", " ", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "}"}]}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"optt", " ", "=", " ", 
      RowBox[{"Select", "[", 
       RowBox[{"optt", ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"ToString", "[", 
           RowBox[{"First", "[", "#", "]"}], "]"}], "\[NotEqual]", " ", 
          "\"\<Weight\>\""}], "&"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"divRule", "=", 
      RowBox[{
       RowBox[{"\"\<DivisionModel\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<DivisionModel\>\"", "\[Rule]", " ", "\"\<Errera\>\""}], 
        "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"optt", " ", "=", " ", 
      RowBox[{"Select", "[", 
       RowBox[{"optt", ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"ToString", "[", 
           RowBox[{"First", "[", "#", "]"}], "]"}], "\[NotEqual]", " ", 
          "\"\<DivisionModel\>\""}], "&"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"extract", " ", "division", " ", "rule", " ", "arguments"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"ErreraModel", "[", 
        RowBox[{"variable", ",", " ", "threshold", ",", " ", "sigma"}], "]"}],
        " ", "or"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Potential", "[", 
       RowBox[{
       "variable", ",", " ", "threshold", ",", " ", "sigma", ",", " ", 
        "weightvector"}], "]"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "DivA", "]"}], ">", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"DivA", "=", 
         RowBox[{"DivA", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"divRule", " ", "=", " ", 
         RowBox[{"DivisionRule", "[", "DivA", "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"DivA", "=", 
         RowBox[{"arguments", "[", "DivA", "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "DivA", "]"}], ">", "0"}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"divVar", "=", 
            RowBox[{"DivA", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"AbortIf", "[", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"SymbolQ", "[", "divVar", "]"}]}], ",", " ", 
             RowBox[{"\"\<Invalid Division Variable: \>\"", "<>", 
              RowBox[{"ToString", "[", "divVar", "]"}], "<>", 
              "\"\< requested in \>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"InputForm", "[", "theDivaA", "]"}], "]"}]}]}], "]"}], 
           ";"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "DivA", "]"}], ">", "1"}], ",", " ", 
          RowBox[{"divThreshold", "=", 
           RowBox[{"DivA", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "DivA", "]"}], ">", "2"}], ",", 
          RowBox[{"divSigma", "=", 
           RowBox[{"DivA", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}]}], "]"}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "DivA", "]"}], ">", "3"}], ",", " ", 
          RowBox[{"divWeight", "=", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"DivA", "[", 
              RowBox[{"[", "4", "]"}], "]"}], "}"}], "]"}]}]}], "]"}], 
        ";"}]}], "  ", "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{
      "\"\<Division Model: var: \>\"", ",", " ", "divVar", ",", " ", 
       "\"\< threshold: \>\"", ",", " ", "divThreshold", ",", " ", 
       "\"\< sigma: \>\"", ",", " ", "divSigma", ",", " ", 
       "\"\< Weight: \>\"", ",", " ", "divWeight"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Look", " ", "for", " ", "most", " ", "likely", " ", "badly", " ", 
       "formatted", " ", "cell", " ", "division", " ", "rules"}], " ", "*)"}],
      "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Check", " ", "for", " ", "badly", " ", "formatted", " ", "Growth", " ",
        "reactions"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"BDQ", " ", "=", " ", 
      RowBox[{"BadDivisionQ", "/@", "onet"}]}], ";", "  ", 
     "\[IndentingNewLine]", 
     RowBox[{"BD", " ", "=", " ", 
      RowBox[{"Pick", "[", 
       RowBox[{"onet", ",", " ", "BDQ"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"AbortIf", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "BD", "]"}], ">", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
       "\"\<There are incorrectly formatted Cell Division Reactions, which \
must only refer to the CellVariable \\\"\>\"", "<>", 
        RowBox[{"ToString", "[", "cell", "]"}], "<>", 
        "\"\<\\\" in the reaction arrow, e.g.,  as {\>\"", "<>", 
        RowBox[{"ToString", "[", "cell", "]"}], "<>", 
        "\"\<\[LongRightArrow]\>\"", "<>", 
        RowBox[{"ToString", "[", "cell", "]"}], "<>", "\"\<+\>\"", "<>", 
        RowBox[{"ToString", "[", "cell", "]"}], "<>", 
        "\"\<,Grow[\[Ellipsis]]}, and not as \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"InputForm", "[", "BD", "]"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"remove", " ", "input", " ", "reactions"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"optt", " ", "=", " ", 
      RowBox[{"Select", "[", 
       RowBox[{"optt", ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"ToString", "[", 
           RowBox[{"First", "[", "#", "]"}], "]"}], "\[NotEqual]", " ", 
          "\"\<Reactions\>\""}], "&"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"VC", "=", 
      RowBox[{
       RowBox[{"\"\<VolumeCorrection\>\"", "/.", 
        RowBox[{"{", "optt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<VolumeCorrection\>\"", "\[Rule]", " ", "True"}], 
        "}"}]}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"VC", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"VCA", "=", " ", 
         RowBox[{
         "ProcessVolumeCorrectionArrows", "[", "\[IndentingNewLine]", 
          RowBox[{"net", ",", " ", "\[IndentingNewLine]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\"\<Growing\>\"", "/.", 
              RowBox[{"{", "optt", "}"}]}], "/.", 
             RowBox[{"{", 
              RowBox[{"\"\<Growing\>\"", "\[Rule]", " ", "False"}], "}"}]}], 
            ")"}], ",", "\[IndentingNewLine]", "cell"}], "]"}]}], ";", " ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"net", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"net", ",", " ", "VCA"}], "]"}]}], ";"}]}], " ", 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"opt1", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<Reactions\>\"", "\[Rule]", " ", "net"}], ",", " ", 
         RowBox[{"\"\<Diffusion\>\"", "\[Rule]", " ", "DR"}], ",", " ", 
         RowBox[{"\"\<Pumps\>\"", "\[Rule]", " ", "PR"}], ",", " ", 
         RowBox[{"\"\<Intercellular\>\"", "\[Rule]", " ", "IR"}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<k\>\"", "\[Rule]", " ", "kS"}], ",", " ", 
         RowBox[{"\"\<mu\>\"", "\[Rule]", " ", "muS"}], ",", " ", 
         RowBox[{"\"\<P\>\"", "\[Rule]", " ", "pS"}], ",", " ", 
         RowBox[{"\"\<DivisionModel\>\"", "\[Rule]", " ", "divRule"}], ",", 
         " ", 
         RowBox[{
         "\"\<DivisionThreshold\>\"", "\[Rule]", " ", "divThreshold"}], ",", 
         " ", 
         RowBox[{"\"\<DivisionSigma\>\"", "\[Rule]", " ", "divSigma"}], ",", 
         " ", 
         RowBox[{"\"\<DivisionVariable\>\"", "\[Rule]", " ", "divVar"}], ",", 
         " ", 
         RowBox[{"\"\<Weights\>\"", "\[Rule]", " ", "divWeight"}], ",", 
         "\[IndentingNewLine]", " ", "optt"}], "}"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "opt1", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.575392703927937*^9, 3.5753927383889008`*^9}, {
   3.575392773134057*^9, 3.575392797143462*^9}, {3.575392891630455*^9, 
   3.575392896543214*^9}, {3.5753931225747957`*^9, 3.5753931254605827`*^9}, {
   3.575393415603198*^9, 3.5753935001829433`*^9}, {3.575393594750263*^9, 
   3.5753937172672453`*^9}, {3.575393747817273*^9, 3.5753938127280273`*^9}, {
   3.575393896407485*^9, 3.5753940073225813`*^9}, {3.5753941363773327`*^9, 
   3.575394267220831*^9}, {3.5753943084052753`*^9, 3.575394311029871*^9}, {
   3.5753943536756287`*^9, 3.57539444106287*^9}, {3.575394484885983*^9, 
   3.5753945886154137`*^9}, {3.575394683219584*^9, 3.575394775000246*^9}, {
   3.575395216083086*^9, 3.5753952180249147`*^9}, {3.5753953187914057`*^9, 
   3.5753953398772087`*^9}, {3.575395373174262*^9, 3.575395621574648*^9}, {
   3.575395969144458*^9, 3.575396294660212*^9}, {3.575396330691086*^9, 
   3.5753963326200457`*^9}, {3.575396391321995*^9, 3.575396406605784*^9}, {
   3.575570628750057*^9, 3.575570646619192*^9}, {3.576613713915827*^9, 
   3.57661372446659*^9}, {3.576613841803377*^9, 3.5766138512941303`*^9}, {
   3.576615627453043*^9, 3.5766158858007507`*^9}, {3.5766159446609697`*^9, 
   3.576615990149695*^9}, {3.57661624650668*^9, 3.576616248270583*^9}, {
   3.576616332619545*^9, 3.576616332931632*^9}, {3.5766163688609753`*^9, 
   3.5766164057538567`*^9}, {3.5766169560649767`*^9, 3.576616969441183*^9}, {
   3.576617026379074*^9, 3.5766171550950623`*^9}, {3.576617195143207*^9, 
   3.576617199133834*^9}, {3.576617276140956*^9, 3.576617422934639*^9}, {
   3.57661745815142*^9, 3.5766178101552687`*^9}, {3.576617926713044*^9, 
   3.576618023598827*^9}, {3.5766180630676003`*^9, 3.576618349994048*^9}, {
   3.576618393455758*^9, 3.576618541499114*^9}, {3.576620081941416*^9, 
   3.576620105615378*^9}, {3.576620156599193*^9, 3.5766202165628567`*^9}, {
   3.576620269839191*^9, 3.5766203106902933`*^9}, {3.576621424765254*^9, 
   3.5766218116078863`*^9}, {3.576621850240163*^9, 3.576621903938078*^9}, {
   3.5766219466729813`*^9, 3.576622020879221*^9}, {3.576622083264449*^9, 
   3.576622104121647*^9}, {3.576622190247822*^9, 3.576622192232863*^9}, {
   3.576622248951639*^9, 3.576622252299704*^9}, {3.5766224280943832`*^9, 
   3.576622462209927*^9}, {3.5766225294880333`*^9, 3.576622556620428*^9}, {
   3.5766227628706903`*^9, 3.576622899169406*^9}, {3.576623047686081*^9, 
   3.5766230489388313`*^9}, {3.576623108185444*^9, 3.576623369882703*^9}, {
   3.576623426741794*^9, 3.5766234600460978`*^9}, {3.576623526089717*^9, 
   3.5766235472876587`*^9}, {3.576623602343419*^9, 3.576623842002824*^9}, {
   3.576623872981655*^9, 3.576623957598434*^9}, {3.5766240116746807`*^9, 
   3.57662406151779*^9}, {3.576624102963399*^9, 3.576624260883148*^9}, {
   3.576624291149558*^9, 3.576624297959263*^9}, {3.5766243342888813`*^9, 
   3.5766243643126163`*^9}, {3.576624407423499*^9, 3.576624464912537*^9}, {
   3.5766244977428617`*^9, 3.576624874854286*^9}, {3.57662495610034*^9, 
   3.576625292659589*^9}, {3.57662533197887*^9, 3.576625580498417*^9}, {
   3.5766257406892853`*^9, 3.576625742529273*^9}, {3.576625817806933*^9, 
   3.5766258907442217`*^9}, {3.576625956121544*^9, 3.57662602197715*^9}, 
   3.576626066415264*^9, {3.576626098551402*^9, 3.576626270617859*^9}, {
   3.576626305963966*^9, 3.576626337404187*^9}, {3.576626386009*^9, 
   3.576626528762539*^9}, {3.576626598626034*^9, 3.576626607315501*^9}, {
   3.576675086636005*^9, 3.576675194084156*^9}, {3.576675228526638*^9, 
   3.576675241977807*^9}, {3.576675287979212*^9, 3.576675426506454*^9}, {
   3.576675526501223*^9, 3.57667559367834*^9}, {3.576675697487125*^9, 
   3.57667591197381*^9}, {3.576675947067132*^9, 3.57667594760693*^9}, {
   3.576676047437181*^9, 3.5766760677371197`*^9}, {3.576676125079895*^9, 
   3.5766761333657513`*^9}, 3.5766761884983187`*^9, {3.576683217412176*^9, 
   3.576683319500799*^9}, {3.57668342106036*^9, 3.576683437994845*^9}, {
   3.5767962603941708`*^9, 3.576796285084588*^9}, 3.576797007145973*^9, {
   3.5783428406289663`*^9, 3.5783428924106894`*^9}, {3.578343053304863*^9, 
   3.5783431608734283`*^9}, {3.5783432266637*^9, 3.578343265225081*^9}, {
   3.578343349811707*^9, 3.578343357447143*^9}, {3.5837046272594337`*^9, 
   3.583704706925696*^9}},ExpressionUUID->"c8c7672b-c03b-4c83-84b0-\
283f02839aa5"]
}, Closed]],

Cell[CellGroupData[{

Cell["go, grow", "Subsection",
 CellChangeTimes->{{3.546204079671953*^9, 3.546204079767199*^9}, {
  3.547488076722351*^9, 
  3.547488077330208*^9}},ExpressionUUID->"dc92490c-4b3c-4a34-82e7-\
8383ab7c6057"],

Cell[CellGroupData[{

Cell["go", "Subsubsection",
 CellChangeTimes->{{3.5474880856020937`*^9, 
  3.5474880856656446`*^9}},ExpressionUUID->"fbf20c82-5c92-43c2-bf40-\
dfd0f86eca8c"],

Cell["\<\
go performs one round of solution, including all necessary follow up cell \
division\
\>", "Text",
 CellChangeTimes->{{3.546885103074479*^9, 
  3.546885119129855*^9}},ExpressionUUID->"c9cf83b8-2109-4a56-97e8-\
f7fd8ec124a9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"go", "[", 
    RowBox[{
     RowBox[{"DT_", "?", "DTissueQ"}], ",", " ", "network_", ",", "  ", 
     "tbegin_", ",", " ", "tend_", ",", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "s", ",", " ", "equations", ",", " ", "odes", ",", "vars", ",", 
       "systemvars", ",", " ", "event", ",", "sim", ",", "w", ",", "DTNOW", 
       ",", " ", "TF1", ",", "TF", ",", " ", "lineage", ",", "edgelineage", 
       ",", " ", "dbg", ",", " ", "IRH", ",", " ", "dPrint", ",", " ", "save",
        ",", "SaveODES", ",", " ", "stepstring", ",", "simdir", ",", 
       "memtrace", ",", "cpu0", ",", "MemPrint", ",", "OK", ",", "ic", ",", 
       "parameters", ",", "initialRates", ",", "result", ",", " ", "TF2", ",",
        "maxradius", ",", "eventequations", ",", "SaveEquations", ",", 
       "eventIC", ",", "\[IndentingNewLine]", "dbgDivide", ",", " ", 
       "upwards", ",", "y", ",", "x", ",", "lhs", ",", " ", "lhshead", ",", 
       " ", "rhs", ",", " ", "found", ",", "n", ",", " ", "LHS", ",", " ", 
       "RHS", ",", " ", "UPONLY", ",", "variables", ",", " ", "variable", ",",
        "meanradius", ",", "yvals", ",", "ybottom", ",", "i", ",", " ", 
       "newode", ",", "index", ",", " ", "divisionthreshold", ",", " ", 
       "dump", ",", " ", "growing", ",", " ", "cell", ",", "okflag", ",", 
       "mostrates", ",", " ", "cellrates"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"index", "[", 
        RowBox[{"x_", "[", "j_", "]"}], "]"}], ":=", " ", "j"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"meanradius", " ", "=", " ", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1.0", "/", "Pi"}], ")"}], "*", 
         RowBox[{"Mean", "[", 
          RowBox[{"areafunction", "[", "DT", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"yvals", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", 
        RowBox[{"TissueVertices", "[", "DT", "]"}]}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"ybottom", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"#", "<", 
           RowBox[{".5", "*", "meanradius"}]}], ")"}], "&"}], "/@", 
        "yvals"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ybottom", "=", 
       RowBox[{"Pick", "[", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"Length", "[", "yvals", "]"}], "]"}], ",", "ybottom"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"growing", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<Growing\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Growing\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";",
       " ", "\[IndentingNewLine]", 
      RowBox[{"cell", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<CellVariable\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<CellVariable\>\"", "\[Rule]", " ", "Global`cell"}], 
         "}"}]}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"UPONLY", "[", "x_", "]"}], ":=", " ", 
       RowBox[{"Max", "[", 
        RowBox[{"x", ",", "0"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"dbgDivide", "=", 
       RowBox[{
        RowBox[{"\"\<DivideDebug\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<DivideDebug\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dbg", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<GoDebug\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<GoDebug\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";",
       " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dPrint", "[", "u___", "]"}], ":=", " ", 
       RowBox[{"If", "[", 
        RowBox[{"dbg", ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<go: \>\"", ",", " ", "u"}], "]"}]}], "]"}]}], ";", " ",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"memtrace", "=", 
       RowBox[{
        RowBox[{"\"\<MemTrace\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<MemTrace\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], 
      ";", " ", "\[IndentingNewLine]", 
      RowBox[{"cpu0", "=", 
       RowBox[{
        RowBox[{"\"\<CPU0\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<CPU0\>\"", "\[Rule]", " ", 
          RowBox[{"TimeUsed", "[", "]"}]}], "}"}]}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"MemPrint", "[", "u___", "]"}], ":=", " ", 
       RowBox[{"If", "[", 
        RowBox[{"memtrace", ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{
           RowBox[{"MemoryInUse", "[", "]"}], ",", "\"\< \>\"", ",", " ", 
           RowBox[{"MaxMemoryUsed", "[", "]"}], ",", "\"\< \>\"", ",", 
           RowBox[{
            RowBox[{"TimeUsed", "[", "]"}], "-", "cpu0"}], ",", "\"\< \>\"", 
           ",", " ", "u"}], "]"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"ic", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<IC\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<IC\>\"", "\[Rule]", " ", 
          RowBox[{"{", "}"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"equations", "=", 
       RowBox[{
        RowBox[{"\"\<Equations\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Equations\>\"", "\[Rule]", " ", 
          RowBox[{"{", "}"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"w", "=", 
       RowBox[{
        RowBox[{"\"\<Weights\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Weights\>\"", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"$$REACTIONS", " ", "=", " ", "network"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", "\"\<Interpreting.\>\"", "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"odes", ",", " ", "vars"}], "}"}], "=", 
       RowBox[{"interpret", "[", "network", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"MemPrint", "[", "\"\<interpret\>\"", "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"upwards", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<Upwards\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Upwards\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";",
       " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"y", "=", 
       RowBox[{"ToString", "[", 
        RowBox[{"\"\<y\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"x", "=", 
       RowBox[{"ToString", "[", 
        RowBox[{"\"\<x\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"upwards", ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"dPrint", "[", "\"\<***** upwards *****\>\"", "]"}], ";"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"lhs", " ", "=", " ", 
          RowBox[{"First", "/@", "odes"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"lhshead", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", 
             RowBox[{"First", "[", "#", "]"}], "]"}], "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Head", "/@", "lhs"}], ")"}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Derivative", "[", "1", "]"}], "\[Rule]", " ", 
               "List"}], "}"}]}], ")"}]}]}], ";", " ", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"found", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Equal", "[", 
             RowBox[{
              RowBox[{"ToString", "[", "#", "]"}], ",", " ", "y"}], "]"}], 
            "&"}], "/@", "lhshead"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"variables", " ", "=", " ", 
          RowBox[{"First", "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Head", "/@", "lhs"}], ")"}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Derivative", "[", "1", "]"}], "\[Rule]", " ", 
               "List"}], "}"}]}], ")"}]}]}], ";", " ", "\[IndentingNewLine]", 
         
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"dPrint", "[", 
            RowBox[{"\"\<go: variables: \>\"", ",", " ", "variables"}], "]"}],
            ";"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         
         RowBox[{"rhs", " ", "=", " ", 
          RowBox[{"Last", "/@", "odes"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"dPrint", "[", 
            RowBox[{"\"\<go: lhs: \>\"", ",", " ", "lhs"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"dPrint", "[", 
            RowBox[{"\"\<go: lhshead: \>\"", ",", " ", "lhshead"}], "]"}], 
           ";", " ", "\[IndentingNewLine]", 
           RowBox[{"dPrint", "[", 
            RowBox[{"\"\<go: found: \>\"", ",", " ", "found"}], "]"}], ";", 
           " ", "\[IndentingNewLine]", 
           RowBox[{"dPrint", "[", 
            RowBox[{"\"\<go: rhs: \>\"", ",", " ", "rhs"}], "]"}], ";"}], " ",
           "*)"}], " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"n", "=", 
          RowBox[{"Length", "[", "odes", "]"}]}], ";", "\[IndentingNewLine]", 
         
         RowBox[{"(*", " ", 
          RowBox[{
          "rebuild", " ", "ODES", " ", "to", " ", "use", " ", "wrapper", " ", 
           "if", " ", "necessary"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"odes", "=", 
          RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "1"}], ",", 
           RowBox[{"i", "\[LessEqual]", " ", "n"}], ",", " ", 
           RowBox[{"i", "++"}], ",", " ", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"LHS", "=", 
             RowBox[{"lhs", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"RHS", "=", 
             RowBox[{"rhs", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"variable", " ", "=", " ", 
             RowBox[{"variables", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ";", " ", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "If", " ", "the", " ", "variable", " ", "is", " ", "\"\<y\>\"", 
              " ", "force", " ", "upwards", " ", "movement"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"found", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{
                "if", " ", "its", " ", "on", " ", "the", " ", "bottom", " ", 
                 "row"}], ",", " ", 
                RowBox[{
                "make", " ", "sure", " ", "it", " ", "stays", " ", 
                 "fixed"}]}], " ", "*)"}], "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"MemberQ", "[", 
                  RowBox[{"ybottom", ",", " ", 
                   RowBox[{"index", "[", "variable", "]"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"RHS", " ", "=", " ", "0.0"}], ",", " ", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{"otherwise", ",", " ", 
                   RowBox[{"force", " ", "upwards"}]}], " ", "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{"RHS", "=", 
                  RowBox[{"UPONLY", "[", "RHS", "]"}]}]}], " ", 
                "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
             "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"newode", " ", "=", " ", 
             RowBox[{"Equal", "[", 
              RowBox[{"LHS", ",", " ", "RHS"}], "]"}]}], ";", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"odes", " ", "=", " ", 
             RowBox[{"Append", "[", 
              RowBox[{"odes", ",", " ", 
               RowBox[{"Equal", "[", 
                RowBox[{"LHS", ",", " ", "RHS"}], "]"}]}], "]"}]}], ";"}]}], 
          " ", "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}]}], 
       " ", "\[IndentingNewLine]", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<go: revised odes: \>\"", ",", " ", "odes"}], "]"}], 
         ";"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"parameters", "=", 
       RowBox[{
        RowBox[{"\"\<Parameters\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Parameters\>\"", "\[Rule]", " ", 
          RowBox[{"{", "}"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", "\"\<Checking ICs\>\"", "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"OK", " ", "=", " ", 
       RowBox[{"HasSufficientInfo", "[", 
        RowBox[{
        "odes", ",", "vars", ",", "equations", ",", "ic", ",", "parameters", 
         ",", " ", "growing", ",", " ", "x", ",", " ", "y", ",", " ", "cell", 
         ",", " ", "False"}], "]"}]}], ";", "\[IndentingNewLine]", " ", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"okflag", ",", " ", "initialRates"}], "}"}], "=", "OK"}], ";",
       " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"MemPrint", "[", "\"\<Checking ICs\>\"", "]"}], ";", 
      "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "[", "okflag", "]"}], ",", " ", "\[IndentingNewLine]", 
        
        RowBox[{
         RowBox[{"Print", "/@", 
          RowBox[{"HasSufficientInfo", "[", 
           RowBox[{
           "odes", ",", "vars", ",", "equations", ",", "ic", ",", 
            "parameters", ",", "growing", ",", " ", "x", ",", " ", "y", ",", 
            " ", "cell", ",", " ", "True"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Simulation Error at t = \>\"", ",", " ", "tbegin"}], 
          "]"}], ";", " ", "\[IndentingNewLine]", 
         RowBox[{"Abort", "[", "]"}], ";"}]}], " ", "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"save", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<Save\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Save\>\"", "\[Rule]", " ", "True"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dump", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<Dump\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Dump\>\"", "\[Rule]", " ", "True"}], "}"}]}]}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{"dump", " ", "=", " ", 
       RowBox[{"dump", " ", "\[And]", " ", "save"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"SaveODES", "=", 
       RowBox[{
        RowBox[{"\"\<SaveODES\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<SaveODES\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], 
      ";", " ", "\[IndentingNewLine]", 
      RowBox[{"SaveEquations", "=", 
       RowBox[{
        RowBox[{"\"\<SaveEquations\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<SaveEquations\>\"", "\[Rule]", " ", "False"}], 
         "}"}]}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"systemvars", " ", "=", " ", 
       RowBox[{"Join", "[", 
        RowBox[{"vars", ",", " ", 
         RowBox[{"Head", "/@", 
          RowBox[{"First", "/@", "equations"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"event", ",", "eventequations", ",", " ", "eventIC"}], "}"}], 
       " ", "=", " ", 
       RowBox[{"setDivision", "[", 
        RowBox[{"systemvars", ",", " ", "DT", ",", " ", "opt"}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"dbgDivide", "=", 
       RowBox[{
        RowBox[{"\"\<DivideDebug\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<DivideDebug\>\"", "\[Rule]", " ", "True"}], "}"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"divisionthreshold", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<DivisionThreshold\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<DivisionThreshold\>\"", "\[Rule]", " ", "\[Infinity]"}],
          "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"divisionthreshold", "<", "Infinity"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"equations", "=", 
          RowBox[{"Join", "[", " ", 
           RowBox[{"eventequations", ",", " ", "equations"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"dbgDivide", ",", 
           RowBox[{"equations", "=", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Global`DivisionEventFlag", "[", "Global`t", "]"}], 
                 "\[Equal]", "event"}], ")"}], "}"}], ",", " ", "equations"}],
              "]"}]}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "eventic", ",", "eific", ",", " ", "funcinate", ",", "icrules"}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"funcinate", "[", "x_", "]"}], ":=", " ", 
          RowBox[{"x", "[", "Global`t", "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"icrules", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"funcinate", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[Rule]", " ", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "&"}], "/@", 
           RowBox[{"Join", "[", 
            RowBox[{"eventIC", ",", "ic"}], "]"}]}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"eventic", " ", "=", " ", 
          RowBox[{"event", "/.", "icrules"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", "divisionthreshold", "]"}], "<", "Infinity"}],
            ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ic", "=", 
             RowBox[{"Join", "[", 
              RowBox[{"eventIC", ",", " ", "ic"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{"dbgDivide", ",", 
              RowBox[{"ic", " ", "=", " ", 
               RowBox[{"Prepend", "[", 
                RowBox[{"ic", ",", 
                 RowBox[{
                 "Global`DivisionEventFlag", "\[Rule]", " ", "eventic"}]}], 
                "]"}]}]}], "]"}], ";"}]}], " ", "\[IndentingNewLine]", "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<Division event set to: \>\"", ",", " ", "event"}], "]"}], 
      ";", " ", "\[IndentingNewLine]", 
      RowBox[{"MemPrint", "[", "\"\<SetDivision\>\"", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"save", " ", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"stepstring", "=", 
          RowBox[{
           RowBox[{"\"\<StepString\>\"", "/.", 
            RowBox[{"{", "opt", "}"}]}], "/.", 
           RowBox[{"\"\<StepString\>\"", "\[Rule]", " ", "\"\<\>\""}]}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"simdir", " ", "=", " ", 
          RowBox[{
           RowBox[{"\"\<SimDir\>\"", "/.", 
            RowBox[{"{", "opt", "}"}]}], "/.", 
           RowBox[{"\"\<SimDir\>\"", "\[Rule]", " ", 
            RowBox[{"Directory", "[", "]"}]}]}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"SaveODES", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"MemPrint", "[", "\"\<Saving ODEs\>\"", "]"}], ";", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"$ODEFILE", " ", "=", " ", 
             RowBox[{"UniqueFileName", "[", 
              RowBox[{"simdir", ",", 
               RowBox[{"\"\<ODES\>\"", "<>", "stepstring"}], ",", 
               "\"\<nb\>\""}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
            RowBox[{"SaveFile", "[", 
             RowBox[{"$ODEFILE", ",", 
              RowBox[{"ToString", "[", 
               RowBox[{"InputForm", "[", "odes", "]"}], "]"}]}], "]"}], 
            ";"}]}], "\[IndentingNewLine]", "]"}], ";", " ", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"SaveEquations", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"MemPrint", "[", "\"\<Saving Equations\>\"", "]"}], ";", 
            " ", "\[IndentingNewLine]", 
            RowBox[{"$EQNFILE", "=", 
             RowBox[{"UniqueFileName", "[", 
              RowBox[{"simdir", ",", 
               RowBox[{"\"\<Equations\>\"", "<>", "stepstring"}], ",", 
               "\"\<nb\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"SaveFile", "[", 
             RowBox[{"$EQNFILE", ",", "equations"}], "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"MemPrint", "[", "\"\<Saving ICs\>\"", "]"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"$ICFILE", "=", 
          RowBox[{"UniqueFileName", "[", 
           RowBox[{"simdir", ",", 
            RowBox[{"\"\<IC\>\"", "<>", "stepstring"}], ",", "\"\<nb\>\""}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"SaveFile", "[", 
          RowBox[{"$ICFILE", ",", "ic"}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", "\"\<Solving.\>\"", "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"event", " ", "=", " ", 
       RowBox[{"event", " ", "+", " ", 
        RowBox[{"Abs", "[", 
         RowBox[{"\[CapitalPsi]", "[", 
          RowBox[{"Global`t", "-", "tend"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"$$SYSTEM", "=", 
       RowBox[{"{", 
        RowBox[{"odes", ",", "vars"}], "}"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"$$IC", "=", "ic"}], ";", "\[IndentingNewLine]", 
      RowBox[{"$$RATES", "=", 
       RowBox[{"initialRates", "/.", 
        RowBox[{"{", 
         RowBox[{"Global`t", "\[Rule]", " ", "tbegin"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"$$EQUATIONS", "=", "equations"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "equations", "]"}], "\[Equal]", "0"}], ",", 
        " ", 
        RowBox[{"initialRates", "=", 
         RowBox[{"{", "}"}]}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"s", "=", 
       RowBox[{"run", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"odes", ",", "vars"}], "}"}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<Equations\>\"", "\[Rule]", " ", "equations"}], ",", " ",
          "\[IndentingNewLine]", 
         RowBox[{"\"\<IC\>\"", "\[Rule]", " ", "ic"}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"MaxSteps", "\[Rule]", " ", "Infinity"}], ",", " ", 
         "\[IndentingNewLine]", "opt", ",", " ", 
         RowBox[{"\"\<TimeSpan\>\"", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{"tbegin", ",", "tend"}], "}"}]}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<InitialRates\>\"", "\[Rule]", " ", "$$RATES"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Method", "\[Rule]", " ", 
          RowBox[{"{", " ", 
           RowBox[{"\"\<EventLocator\>\"", ",", "  ", 
            RowBox[{"\"\<Event\>\"", "\[Rule]", " ", "event"}], ",", " ", 
            RowBox[{"\"\<Direction\>\"", "\[Rule]", " ", "1"}]}], "}"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"s", "=", 
       RowBox[{"Flatten", "[", "s", "]"}]}], ";", " ", "\[IndentingNewLine]", 
      
      RowBox[{"MemPrint", "[", "\"\<run\>\"", "]"}], ";", " ", 
      "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", "\"\<IRH.\>\"", "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"IRH", " ", "=", " ", 
       RowBox[{"identifyReasonForHalt", "[", 
        RowBox[{
        "s", ",", "DT", ",", " ", "eventequations", ",", " ", "tend", ",", 
         " ", "opt"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"sim", " ", "=", " ", 
       RowBox[{"Append", "[", 
        RowBox[{"IRH", ",", 
         RowBox[{"\"\<Solution\>\"", "\[Rule]", " ", "s"}]}], "]"}]}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{"MemPrint", "[", "\"\<IRH\>\"", "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<Reason for halt: \>\"", ",", " ", "IRH"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"TF1", "=", 
       RowBox[{"performAllNecessaryCellDivisions", "[", 
        RowBox[{"sim", ",", "DT", ",", "opt"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"MemPrint", "[", "\"\<CellDivision\>\"", "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"result", " ", "=", " ", 
       RowBox[{"Join", "[", 
        RowBox[{"sim", ",", "TF1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<*** GO: Tissue (TF1): \>\"", ",", " ", 
        RowBox[{"\"\<Tissue\>\"", "/.", "TF1"}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"maxradius", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<MaxRadius\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<MaxRadius\>\"", "\[Rule]", " ", "\[Infinity]"}], 
         "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", " ", 
       RowBox[{
        RowBox[{"maxradius", "<", " ", "\[Infinity]"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"dPrint", "[", "\"\<Checking for Outliers.\>\"", "]"}], ";", 
         " ", "\[IndentingNewLine]", 
         RowBox[{"TF2", "=", " ", 
          RowBox[{"ExpungeOutliers", "[", 
           RowBox[{"result", ",", "opt"}], "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"TF2", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "]"}], "<", "1"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{
               "\"\<Error: All cells have been classified as outliers and \
removed from the tissue at t=\>\"", "<>", 
                RowBox[{"ToString", "[", 
                 RowBox[{"Last", "[", 
                  RowBox[{"\"\<TimeSpan\>\"", "/.", "IRH"}], "]"}], "]"}]}], 
               ",", "Red", ",", "Bold"}], "]"}], "\[IndentingNewLine]", "]"}],
             ";"}]}], " ", "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"dPrint", "[", 
          RowBox[{"\"\<*** GO: Tissue (TF2): \>\"", ",", " ", "TF2"}], "]"}], 
         ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"result", " ", "=", " ", 
          RowBox[{"Select", "[", 
           RowBox[{"result", ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"First", "[", "#", "]"}], "\[NotEqual]", " ", 
              "\"\<Tissue\>\""}], "&"}]}], "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"result", " ", "=", " ", 
          RowBox[{"Prepend", "[", 
           RowBox[{"result", ",", " ", 
            RowBox[{"\"\<Tissue\>\"", "\[Rule]", " ", "TF2"}]}], "]"}]}], 
         ";"}]}], " ", "\[IndentingNewLine]", "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "result", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5462040842571077`*^9, 3.5462041791149883`*^9}, {
   3.546207480573278*^9, 3.546207572239644*^9}, {3.5462077866556664`*^9, 
   3.546207820170898*^9}, {3.546207975779984*^9, 3.5462080651546173`*^9}, {
   3.546208115482005*^9, 3.546208125413046*^9}, {3.54620825639095*^9, 
   3.5462082587017527`*^9}, {3.546208289158164*^9, 3.546208301381489*^9}, {
   3.546208391790285*^9, 3.5462083923319798`*^9}, {3.546208620240279*^9, 
   3.546208719765785*^9}, {3.546208857488228*^9, 3.546208881899734*^9}, {
   3.546209483064024*^9, 3.546209484298883*^9}, 3.546209780829588*^9, {
   3.546210340209093*^9, 3.54621034662481*^9}, {3.5462103768102493`*^9, 
   3.5462103989906282`*^9}, {3.546210462964538*^9, 3.546210465666439*^9}, 
   3.5462105058679037`*^9, {3.5462111631055613`*^9, 3.54621117904311*^9}, {
   3.546884901588509*^9, 3.5468850391399612`*^9}, {3.546885093910491*^9, 
   3.546885094119355*^9}, {3.546891510152986*^9, 3.546891549784053*^9}, 
   3.5468918091180468`*^9, {3.547054606750227*^9, 3.5470546114575357`*^9}, {
   3.5472183342906523`*^9, 3.5472183415084667`*^9}, {3.5472325444385366`*^9, 
   3.5472325686141663`*^9}, {3.54723260066654*^9, 3.5472326066621113`*^9}, {
   3.547232719348653*^9, 3.5472327839146748`*^9}, {3.547233174968857*^9, 
   3.547233191658553*^9}, {3.547233408417549*^9, 3.547233412794046*^9}, {
   3.547474379833825*^9, 3.5474744912104177`*^9}, {3.5474746444141207`*^9, 
   3.5474746558575563`*^9}, {3.5474781348426847`*^9, 3.547478135655733*^9}, {
   3.547478171816556*^9, 3.547478172030533*^9}, 3.547488073764926*^9, {
   3.547491224214926*^9, 3.547491335567404*^9}, {3.54749139248495*^9, 
   3.547491397809065*^9}, {3.547491445141979*^9, 3.547491445423306*^9}, {
   3.547491617985688*^9, 3.547491618747417*^9}, {3.547567784153612*^9, 
   3.547567809439102*^9}, {3.547567902628274*^9, 3.5475679275623293`*^9}, {
   3.547568114162345*^9, 3.547568141195622*^9}, {3.5475681719672213`*^9, 
   3.547568208367897*^9}, {3.547568243760024*^9, 3.547568250053278*^9}, {
   3.547568282327526*^9, 3.547568285116274*^9}, {3.547568387897531*^9, 
   3.547568400856777*^9}, {3.5475684744825563`*^9, 3.54756847540301*^9}, {
   3.54757668244479*^9, 3.54757668301118*^9}, {3.547586248156192*^9, 
   3.5475862486079683`*^9}, 3.547586367729628*^9, {3.54764687714559*^9, 
   3.5476468795522413`*^9}, {3.5476469156441793`*^9, 3.547646916138083*^9}, {
   3.547648425112463*^9, 3.547648427177908*^9}, {3.547648461981277*^9, 
   3.547648482272296*^9}, {3.547664314885783*^9, 3.5476643584049473`*^9}, {
   3.547664392856135*^9, 3.5476644859156837`*^9}, {3.547664805055169*^9, 
   3.547664811712296*^9}, {3.5476648583856497`*^9, 3.5476648621747913`*^9}, {
   3.5476691023317432`*^9, 3.547669118451098*^9}, {3.547739475439888*^9, 
   3.547739492366899*^9}, {3.547739537896895*^9, 3.547739592464595*^9}, {
   3.547739682945322*^9, 3.54773968604582*^9}, {3.5477451032711277`*^9, 
   3.5477451069054813`*^9}, {3.547745305695099*^9, 3.547745316340514*^9}, {
   3.547745464504243*^9, 3.547745493306781*^9}, {3.547745578094442*^9, 
   3.547745600332038*^9}, {3.547745708446563*^9, 3.547745718637952*^9}, {
   3.547746348138123*^9, 3.5477464402332487`*^9}, {3.547746654480715*^9, 
   3.547746654733131*^9}, {3.5479338503889*^9, 3.5479339861455727`*^9}, {
   3.547935146183056*^9, 3.54793515203335*^9}, {3.547937735964026*^9, 
   3.5479377648076067`*^9}, {3.547937805716443*^9, 3.547937849196747*^9}, {
   3.547937986795354*^9, 3.547938141797194*^9}, {3.547938325433712*^9, 
   3.547938326872986*^9}, {3.547942864333531*^9, 3.54794286769809*^9}, {
   3.547942972118771*^9, 3.547943050369342*^9}, {3.547943131710206*^9, 
   3.547943133970892*^9}, {3.547943950890724*^9, 3.547944042289665*^9}, {
   3.547944087022447*^9, 3.547944121324054*^9}, {3.547944160939434*^9, 
   3.54794416351418*^9}, {3.547944196590753*^9, 3.5479441991953087`*^9}, {
   3.547944718411708*^9, 3.547944817038579*^9}, {3.547944852884556*^9, 
   3.547944872544735*^9}, {3.547945861318631*^9, 3.547945905635994*^9}, {
   3.54794612471528*^9, 3.547946126307365*^9}, {3.548516357879752*^9, 
   3.548516412016427*^9}, {3.548516468640643*^9, 3.5485164934327393`*^9}, {
   3.548516634662903*^9, 3.548516649501132*^9}, {3.5485184629283457`*^9, 
   3.5485184774218616`*^9}, {3.548518835913096*^9, 3.5485188968082542`*^9}, {
   3.548520164325871*^9, 3.548520190596723*^9}, 3.548520227663637*^9, {
   3.5485231206772003`*^9, 3.5485231518342333`*^9}, 3.5494708443435993`*^9, {
   3.549470904977048*^9, 3.549470957501899*^9}, {3.556796137009665*^9, 
   3.556796175639443*^9}, {3.556796265152914*^9, 3.5567962655117483`*^9}, {
   3.558182512360165*^9, 3.558182513686495*^9}, {3.558182623029501*^9, 
   3.5581826271064053`*^9}, {3.558183081059896*^9, 3.55818308226723*^9}, {
   3.5581842632374563`*^9, 3.558184267711215*^9}, {3.5581843071055117`*^9, 
   3.558184307898443*^9}, {3.558550431066201*^9, 3.558550450040691*^9}, {
   3.559491825558571*^9, 3.559491835505856*^9}, {3.559492129508607*^9, 
   3.559492148691884*^9}, {3.559492231078411*^9, 3.559492264427291*^9}, {
   3.5594923245329103`*^9, 3.5594923651321793`*^9}, {3.5594924087496023`*^9, 
   3.559492429632093*^9}, 3.55949250290521*^9, {3.559492726642364*^9, 
   3.5594927409144907`*^9}, {3.559492794765499*^9, 3.559492801209359*^9}, {
   3.559500022685267*^9, 3.5595001297551737`*^9}, {3.5595005091384172`*^9, 
   3.559500643329555*^9}, {3.5595006827870817`*^9, 3.559500688269862*^9}, {
   3.5595923750456753`*^9, 3.559592429581168*^9}, {3.5595930522187967`*^9, 
   3.559593064011134*^9}, {3.559593143301309*^9, 3.5595931591202106`*^9}, 
   3.5595947347495003`*^9, {3.55959528812799*^9, 3.559595367653677*^9}, {
   3.559595560307472*^9, 3.55959556351825*^9}, {3.559596341270936*^9, 
   3.5595963420608883`*^9}, {3.5595966307449093`*^9, 3.559596649337441*^9}, 
   3.5595968652365847`*^9, {3.559596983469104*^9, 3.5595969850631437`*^9}, {
   3.559597282542056*^9, 3.55959731853612*^9}, {3.559597398223003*^9, 
   3.5595974164041967`*^9}, {3.55959745609836*^9, 3.559597490086391*^9}, {
   3.559598028009945*^9, 3.559598037677589*^9}, {3.5596633135659447`*^9, 
   3.5596633658947067`*^9}, {3.559663409284095*^9, 3.5596634584001303`*^9}, {
   3.5596635021425457`*^9, 3.559663726980137*^9}, {3.559663771329022*^9, 
   3.559663783712701*^9}, {3.5596638250811663`*^9, 3.559663849215774*^9}, {
   3.559663888623288*^9, 3.559663917548856*^9}, {3.559663959972858*^9, 
   3.559664016766769*^9}, {3.5600043517027893`*^9, 3.560004352607465*^9}, {
   3.5600047847422943`*^9, 3.560004785453452*^9}, {3.560168463925252*^9, 
   3.560168630662642*^9}, {3.570904752098589*^9, 3.570904767176218*^9}, {
   3.570905151013256*^9, 3.57090517540867*^9}, {3.570905211842861*^9, 
   3.570905263517708*^9}, {3.570905295734408*^9, 3.5709053057872066`*^9}, {
   3.570905433241126*^9, 3.570905479484541*^9}, {3.570905612397859*^9, 
   3.5709056370579567`*^9}, {3.570905670651864*^9, 3.570905763524036*^9}, {
   3.57090588243557*^9, 3.5709059238620996`*^9}, {3.570905981614656*^9, 
   3.570906059716057*^9}, {3.570906123983696*^9, 3.5709061380310297`*^9}, {
   3.570906193111504*^9, 3.570906247887189*^9}, {3.5709062856359386`*^9, 
   3.57090628864142*^9}, {3.570906334155901*^9, 3.570906411950953*^9}, {
   3.570906457265452*^9, 3.570906469138956*^9}, {3.570906965421432*^9, 
   3.570907142540752*^9}, {3.5709072011858883`*^9, 3.5709072176044903`*^9}, {
   3.570907305611614*^9, 3.570907356167301*^9}, {3.570907426714862*^9, 
   3.570907462897108*^9}, {3.570907542248374*^9, 3.5709075887848387`*^9}, {
   3.570908093682426*^9, 3.5709080989221783`*^9}, {3.570908130677387*^9, 
   3.570908214198782*^9}, {3.5709082904186773`*^9, 3.570908355204862*^9}, {
   3.570908389015176*^9, 3.5709084222368402`*^9}, {3.570908486163507*^9, 
   3.5709084989422083`*^9}, {3.57090860850138*^9, 3.57090861228398*^9}, 
   3.571004276132115*^9, {3.571007402152919*^9, 3.571007440713758*^9}, {
   3.572227641036875*^9, 3.572227649518133*^9}, 3.5722279907681427`*^9, {
   3.5722644789840918`*^9, 3.572264514751348*^9}, {3.572264559453033*^9, 
   3.57226463614715*^9}, {3.57226466917735*^9, 3.572264829033677*^9}, {
   3.572264873391261*^9, 3.572264946956141*^9}, {3.572269854569001*^9, 
   3.5722699001175003`*^9}, {3.5722699397350397`*^9, 3.5722701047798*^9}, {
   3.572270135750311*^9, 3.572270145154146*^9}, {3.572270183226697*^9, 
   3.572270411371484*^9}, 3.572270445400054*^9, {3.5730488979148912`*^9, 
   3.573048903313694*^9}, 3.573048956985669*^9, {3.574707524941299*^9, 
   3.5747075393824997`*^9}, {3.574707601052064*^9, 3.574707601971105*^9}, {
   3.574707638346324*^9, 3.574707646957838*^9}, {3.574708095318931*^9, 
   3.574708103862113*^9}, {3.574980243842471*^9, 3.574980337668889*^9}, {
   3.5749808928278*^9, 3.574980919266219*^9}, {3.5749814970266047`*^9, 
   3.5749815012113857`*^9}, {3.575493983576976*^9, 3.575494007591338*^9}, {
   3.57549403810324*^9, 3.575494053868346*^9}, {3.5754941017357063`*^9, 
   3.575494111379779*^9}, {3.575494144788496*^9, 3.5754941856840343`*^9}, {
   3.5754942440592823`*^9, 3.575494381008337*^9}, {3.575494427582468*^9, 
   3.575494565161647*^9}, {3.575494611222486*^9, 3.575494614180736*^9}, {
   3.575494734599514*^9, 3.575494773148964*^9}, {3.576007641043112*^9, 
   3.576007662415319*^9}, {3.576007742204262*^9, 3.576007801810259*^9}, {
   3.576007844245225*^9, 3.5760079230769377`*^9}, {3.576007995072885*^9, 
   3.576008003700746*^9}, {3.576008089277219*^9, 3.576008098538855*^9}, {
   3.5760121053132057`*^9, 3.5760121110880117`*^9}, {3.5760121925056047`*^9, 
   3.576012192881282*^9}, {3.5760123350166407`*^9, 3.5760123360353394`*^9}, {
   3.5766209636205053`*^9, 3.5766210087312737`*^9}, {3.5766763501569157`*^9, 
   3.576676358788639*^9}, {3.576676550921232*^9, 3.576676557634158*^9}, {
   3.576684187858885*^9, 3.57668420419866*^9}, {3.57754557265352*^9, 
   3.577545578800271*^9}, {3.577545612158431*^9, 3.577545612960453*^9}, {
   3.577545828533681*^9, 3.5775458559620113`*^9}, {3.577545925621151*^9, 
   3.5775459428406763`*^9}, {3.577545995909507*^9, 3.5775460082787437`*^9}, {
   3.5775461482584352`*^9, 3.5775461491326113`*^9}, {3.5775477669590273`*^9, 
   3.577547791971189*^9}, {3.577547844449637*^9, 3.5775478821853228`*^9}, {
   3.5775479274524393`*^9, 3.5775479296608753`*^9}, 3.577547960806754*^9, {
   3.577745844822328*^9, 3.577745850869343*^9}, {3.578346153524036*^9, 
   3.578346161018324*^9}, {3.578346444063364*^9, 3.578346463858567*^9}, {
   3.5783465113595257`*^9, 3.578346558495902*^9}, {3.578346592848461*^9, 
   3.578346600121607*^9}, {3.578347084717209*^9, 3.578347117800506*^9}, {
   3.578352042392552*^9, 3.578352092029084*^9}, {3.578352221924799*^9, 
   3.578352240233551*^9}, {3.5783522717447863`*^9, 3.578352368925357*^9}, {
   3.5783525449373198`*^9, 3.578352595838374*^9}, {3.578352638770506*^9, 
   3.578352641159068*^9}, {3.57835274191881*^9, 3.5783527513882227`*^9}, {
   3.578355656788189*^9, 3.578355661406139*^9}, {3.578355794122911*^9, 
   3.578355798671751*^9}, {3.5783558299380283`*^9, 3.578355835691638*^9}, {
   3.705712961866578*^9, 
   3.705712963277577*^9}},ExpressionUUID->"e81ce2ca-170c-4539-88bc-\
f8846dd0e27d"]
}, Closed]],

Cell[CellGroupData[{

Cell["ExpungeOutliers", "Subsubsection",
 CellChangeTimes->{{3.5485165215833807`*^9, 3.5485165237685204`*^9}, 
   3.5485189876751223`*^9, 
   3.54852021741064*^9},ExpressionUUID->"f54770c6-a937-4330-9a92-\
76b43040b275"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExpungeOutliers", "[", 
    RowBox[{"sim_", ",", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "s", ",", "dbg", ",", "rmax", ",", "dPrint", ",", " ", "T", ",", 
       "bcells", ",", "cvc", ",", "TC", ",", "d", ",", " ", "droppers", ",", 
       " ", "TNew", ",", "D2S", ",", "nstatic", ",", "cnums", ",", 
       "staticbcells", ",", " ", "origin"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dbg", " ", "=", " ", "False"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dPrint", "[", "u___", "]"}], ":=", " ", 
       RowBox[{"If", "[", 
        RowBox[{"dbg", ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<DropOutlyingCells: \>\"", ",", " ", "u"}], "]"}]}], 
        "]"}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"rmax", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<MaxRadius\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<MaxRadius\>\"", "\[Rule]", " ", "\[Infinity]"}], 
         "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"origin", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<Origin\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Origin\>\"", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{"0.0", ",", "0.0"}], "}"}]}], "}"}]}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<rmax=\>\"", ",", " ", "rmax"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"T", "=", 
       RowBox[{"\"\<Tissue\>\"", "/.", "sim"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"cnums", " ", "=", " ", 
       RowBox[{"First", "/@", 
        RowBox[{"TissueCells", "[", "T", "]"}]}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"nstatic", "=", 
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", "cnums", "]"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"D2S", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Rule", ",", 
         RowBox[{"{", 
          RowBox[{"cnums", ",", "nstatic"}], "}"}]}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"bcells", " ", "=", " ", 
       RowBox[{"CellsOnBoundary", "[", "T", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<Boundary Cells: \>\"", ",", " ", "bcells"}], "]"}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{"staticbcells", "=", 
       RowBox[{"bcells", "/.", "D2S"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<Static Boundary Cells: \>\"", ",", " ", "staticbcells"}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"cvc", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"CellVertexCoordinates", "[", "T", "]"}], ")"}], "[", 
        RowBox[{"[", "staticbcells", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ToString", "[", "origin", "]"}], "\[Equal]", 
         "\"\<Centroid\>\""}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{"TC", " ", "=", " ", 
         RowBox[{"TissueCentroid", "[", 
          RowBox[{"DTissue2Tissue", "[", "T", "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"TC", "=", "origin"}]}], "\[IndentingNewLine]", "]"}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<TC: \>\"", ",", " ", "TC"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"TNew", "  ", "=", " ", "T"}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "cells", ",", " ", "cell", ",", "voutlier", ",", "outliers", ",", 
          " ", "outlier", ",", " ", "cellnumber", ",", " ", "coordinates"}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"cells", "=", 
          RowBox[{"MapThread", "[", 
           RowBox[{"Rule", ",", 
            RowBox[{"{", 
             RowBox[{"bcells", ",", "cvc"}], "}"}]}], "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"dPrint", "[", 
          RowBox[{"\"\<cells: \>\"", ",", " ", 
           RowBox[{"Short", "[", 
            RowBox[{"cvc", ",", "5"}], "]"}]}], "]"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "figure", " ", "out", " ", "which", " ", "cells", " ", "poke", " ", 
           "out", " ", "the", " ", "boundary"}], " ", "*)"}], " ", 
         "\[IndentingNewLine]", 
         RowBox[{"outliers", "=", 
          RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "cells", "]"}], ">", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"cell", "=", 
             RowBox[{"First", "[", "cells", "]"}]}], ";", " ", 
            RowBox[{"cells", "=", 
             RowBox[{"Rest", "[", "cells", "]"}]}], ";", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"coordinates", " ", "=", " ", 
             RowBox[{"Last", "[", "cell", "]"}]}], ";", " ", 
            RowBox[{"cellnumber", "=", 
             RowBox[{"First", "[", "cell", "]"}]}], ";", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"voutlier", "=", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"distance", "[", 
                  RowBox[{"#", ",", "TC"}], "]"}], ">", "rmax"}], ")"}], 
               "&"}], "/@", "coordinates"}]}], ";", " ", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"dPrint", "[", 
               RowBox[{
               "\"\<cell: \>\"", ",", " ", "cellnumber", ",", " ", 
                "\"\< voutlier: \>\"", ",", " ", "voutlier"}], "]"}], ";"}], 
             "*)"}], "  ", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"And", "@@", "voutlier"}], ",", " ", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"outliers", ",", " ", "cellnumber"}], "]"}]}], "]"}], 
            ";"}]}], " ", "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"dPrint", "[", 
          RowBox[{"\"\<outliers: \>\"", ",", " ", "outliers"}], "]"}], ";", 
         " ", "\[IndentingNewLine]", 
         RowBox[{"droppers", " ", "=", " ", "outliers"}], ";"}]}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"TNew", " ", "=", " ", "T"}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"drop", " ", "required", " ", "cells"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "droppers", "]"}], "\[GreaterEqual]", 
         RowBox[{"Length", "[", 
          RowBox[{"TNew", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"Style", "[", 
           RowBox[{
           "\"\<Error: All cells have been classified as outliers and removed \
from the tissue.\>\"", ",", "Red", ",", "Bold"}], "]"}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], " ", "\[IndentingNewLine]", 
       "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "droppers", "]"}], ">", "0"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"d", "=", 
          RowBox[{"First", "[", "droppers", "]"}]}], ";", " ", 
         RowBox[{"droppers", "=", 
          RowBox[{"Rest", "[", "droppers", "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"TNew", "=", 
          RowBox[{"DeleteCell", "[", 
           RowBox[{"TNew", ",", "d"}], "]"}]}], ";"}]}], " ", 
       "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "TNew", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5485165261571093`*^9, 3.5485165500727386`*^9}, {
   3.548516581066229*^9, 3.548516671369349*^9}, {3.54851682980807*^9, 
   3.548516843258752*^9}, {3.548517523730551*^9, 3.548517573980295*^9}, {
   3.5485181642208853`*^9, 3.548518283445402*^9}, {3.54851837076397*^9, 
   3.548518441614839*^9}, {3.548518723946116*^9, 3.548518799182568*^9}, {
   3.548519070176869*^9, 3.548519198625285*^9}, {3.5485195391571207`*^9, 
   3.54851954393591*^9}, {3.5485196008911133`*^9, 3.548519603227532*^9}, {
   3.54851965185252*^9, 3.54851973028994*^9}, {3.548519903350772*^9, 
   3.548519939104707*^9}, {3.5485202100688353`*^9, 3.548520221907691*^9}, {
   3.5485231563076963`*^9, 3.548523157018984*^9}, {3.5485371821725893`*^9, 
   3.548537302719204*^9}, {3.5485375874936647`*^9, 3.548537604433002*^9}, {
   3.548537635014888*^9, 3.548538003171938*^9}, 3.5485380808557463`*^9, {
   3.548538193891128*^9, 3.548538220532639*^9}, {3.548538262389078*^9, 
   3.548538271042951*^9}, {3.548538310121749*^9, 3.548538330400538*^9}, {
   3.548538503007063*^9, 3.54853857690091*^9}, {3.54853865858178*^9, 
   3.548538732447156*^9}, {3.54853878614554*^9, 3.548538792014113*^9}, {
   3.548538836711727*^9, 3.548539078506626*^9}, {3.548539131688654*^9, 
   3.548539240827612*^9}, {3.548539343422893*^9, 3.548539346745541*^9}, {
   3.548539454903487*^9, 3.548539463664653*^9}, 3.548539513415382*^9, {
   3.54853955115662*^9, 3.54853959613348*^9}, {3.548539684739793*^9, 
   3.548539685682032*^9}, {3.548539757694995*^9, 3.548539798499542*^9}, {
   3.5485398300497303`*^9, 3.548539868045101*^9}, {3.548544185051136*^9, 
   3.548544211002029*^9}, {3.548544241749937*^9, 3.548544266576305*^9}, {
   3.548544710725567*^9, 3.5485448684489717`*^9}, {3.549027471270537*^9, 
   3.549027549139182*^9}, {3.549027762932292*^9, 3.5490277730445747`*^9}, {
   3.549028020426656*^9, 3.549028056331361*^9}, {3.549028107331654*^9, 
   3.549028116225157*^9}, {3.54903130199218*^9, 3.549031302561824*^9}, {
   3.549031784727393*^9, 3.549031857651245*^9}, {3.5490319343730803`*^9, 
   3.5490319379373693`*^9}, {3.549032145643159*^9, 3.549032146089485*^9}, {
   3.549040123382121*^9, 3.549040208244856*^9}, {3.549470387501086*^9, 
   3.54947051802713*^9}, {3.549470557183241*^9, 3.5494705590256653`*^9}, {
   3.5583867158109627`*^9, 3.558386716512344*^9}, {3.559597069468869*^9, 
   3.5595972767995043`*^9}, {3.5595976912363977`*^9, 3.559597737842826*^9}, {
   3.559597857140012*^9, 3.5595978696734667`*^9}, {3.559597911504113*^9, 
   3.559597936717074*^9}, {3.559597991569902*^9, 
   3.559598013747344*^9}},ExpressionUUID->"ed3433cb-509e-41ee-8c3d-\
d825cc086a0f"]
}, Closed]],

Cell[CellGroupData[{

Cell["LineRadiusIntersection", "Subsubsection",
 CellChangeTimes->{{3.548542865642459*^9, 3.548542871816905*^9}, {
  3.54854290220303*^9, 
  3.5485429122023706`*^9}},ExpressionUUID->"7c2c26d6-7b1e-4d2b-ae92-\
b2e01ffd9bfc"],

Cell[TextData[{
 "Locates the point on the line segment from {x1,y1} to {x2,y2} that is a \
distance r from {x,y}\nReturns a pair {Flag, location}\nIf the value of Flag \
is True, location is the {x,y} coordiates of the location\nIf the value of \
the Flag is False, then there is no intersection and location is \
indeterminate.\n\nEquations derived using ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " Solve as follows:\n\ntvals = Flatten[\n  Solve[{(x - p)^2 + (y - q)^2 == \
r^2} /. {p -> x1 - t x1 + t x2, \n     q -> y1 - t y1 + t y2}, t]];\n     \
FullSimplify[{ x1 + t*(x2 - x1), y1 + t*(y2 - y1)} /. tvals]\n     \n The two \
special cases are derived by replacing the rule for p by p->x1 or the rule \
for q by q-> y1, etc. \n \n *** Not currently used ***"
}], "Text",
 CellChangeTimes->{{3.548542923049705*^9, 3.54854294712885*^9}, {
  3.548543142715469*^9, 3.548543189265674*^9}, {3.548543410420824*^9, 
  3.548543505049671*^9}, {3.549470604105803*^9, 
  3.549470610814776*^9}},ExpressionUUID->"1a5b6883-b5e6-4236-ad2d-\
964eec859419"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LineRadiusIntersection", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1_", ",", "y1_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x2_", ",", "y2_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x_", ",", "y_"}], "}"}], ",", "r_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pt", ",", "intersects"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"intersects", "=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"distance", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x1", ",", "y1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "y"}], "}"}]}], "]"}], "-", "r"}], ")"}], 
           "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"distance", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x2", ",", "y2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "y"}], "}"}]}], "]"}], "-", "r"}], ")"}]}], 
          "<", "0"}], ")"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", "intersects"}], ",", " ", 
         RowBox[{"Return", "[", 
          RowBox[{"{", 
           RowBox[{"False", ",", " ", 
            RowBox[{"{", 
             RowBox[{"Indeterminate", ",", " ", "Indeterminate"}], "}"}]}], 
           "}"}], "]"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"zero", " ", "-", " ", 
         RowBox[{"length", " ", "edge"}], " ", "-", " ", 
         RowBox[{
         "may", " ", "intersect", " ", "at", " ", "a", " ", "point"}]}], " ", 
        "*)"}], " ", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"x1", "\[Equal]", "x2"}], "\[And]", 
          RowBox[{"y1", "\[Equal]", "y2"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"intersects", ",", " ", 
           RowBox[{"Return", "[", 
            RowBox[{"{", 
             RowBox[{"intersects", ",", " ", 
              RowBox[{"{", 
               RowBox[{"x1", ",", "y1"}], "}"}]}], "}"}], "]"}], ",", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"Return", "[", 
            RowBox[{"{", 
             RowBox[{"intersects", ",", " ", 
              RowBox[{"{", 
               RowBox[{"Indeterminate", ",", " ", "Indeterminate"}], "}"}]}], 
             "}"}], "]"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"vertical", " ", "line"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"x1", "\[Equal]", "x2"}], ",", 
         RowBox[{
          RowBox[{"pt", "=", 
           RowBox[{"{", 
            RowBox[{"x1", ",", 
             RowBox[{"y", "+", 
              RowBox[{
               RowBox[{"Sqrt", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"r", "+", "x", "-", "x1"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"r", "-", "x", "+", "x1"}], ")"}], " ", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"y1", "-", "y2"}], ")"}], "^", "2"}]}], "]"}], "/", 
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}]}]}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "pt", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"horizontal", " ", "line"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"y1", "\[Equal]", "y2"}], ",", 
         RowBox[{
          RowBox[{"pt", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x", "+", 
              RowBox[{
               RowBox[{"Sqrt", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"x1", "-", "x2"}], ")"}], "^", "2"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"r", "+", "y", "-", "y1"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"r", "-", "y", "+", "y1"}], ")"}]}], "]"}], "/", 
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}]}]}], ",", "y1"}], "}"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "pt", "]"}], ";"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"general", " ", "case"}], " ", "*)"}], "\[IndentingNewLine]", 
       
       RowBox[{"pt", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x1", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"x1", "-", "x2"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"(", 
                   RowBox[{"x", "-", "x1"}], ")"}]}], " ", 
                 RowBox[{"(", 
                  RowBox[{"x1", "-", "x2"}], ")"}]}], "+", 
                RowBox[{"y1", "^", "2"}], "+", 
                RowBox[{"y", " ", "y2"}], "-", 
                RowBox[{"y1", " ", 
                 RowBox[{"(", 
                  RowBox[{"y", "+", "y2"}], ")"}]}], "-", 
                RowBox[{"\[Sqrt]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"r", "^", "2"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x1", "-", "x2"}], ")"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"y1", "-", "y2"}], ")"}], "^", "2"}]}], ")"}]}], 
                   "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "x2"}], " ", "y"}], "-", 
                    RowBox[{"x", " ", "y1"}], "+", 
                    RowBox[{"x2", " ", "y1"}], "+", 
                    RowBox[{"x1", " ", 
                    RowBox[{"(", 
                    RowBox[{"y", "-", "y2"}], ")"}]}], "+", 
                    RowBox[{"x", " ", "y2"}]}], ")"}], "^", "2"}]}], 
                  ")"}]}]}], ")"}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "^", "2"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "^", "2"}]}], ")"}]}]}], 
          ",", 
          RowBox[{"y1", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"y1", "-", "y2"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"(", 
                   RowBox[{"x", "-", "x1"}], ")"}]}], " ", 
                 RowBox[{"(", 
                  RowBox[{"x1", "-", "x2"}], ")"}]}], "+", 
                RowBox[{"y1", "^", "2"}], "+", 
                RowBox[{"y", " ", "y2"}], "-", 
                RowBox[{"y1", " ", 
                 RowBox[{"(", 
                  RowBox[{"y", "+", "y2"}], ")"}]}], "-", 
                RowBox[{"\[Sqrt]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"r", "^", "2"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x1", "-", "x2"}], ")"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"y1", "-", "y2"}], ")"}], "^", "2"}]}], ")"}]}], 
                   "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "x2"}], " ", "y"}], "-", 
                    RowBox[{"x", " ", "y1"}], "+", 
                    RowBox[{"x2", " ", "y1"}], "+", 
                    RowBox[{"x1", " ", 
                    RowBox[{"(", 
                    RowBox[{"y", "-", "y2"}], ")"}]}], "+", 
                    RowBox[{"x", " ", "y2"}]}], ")"}], "^", "2"}]}], 
                  ")"}]}]}], ")"}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "^", "2"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "^", "2"}]}], ")"}]}]}]}], 
         "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"intersects", ",", " ", "pt"}], "}"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\n"}]], "Input",
 CellChangeTimes->{{3.548542880194816*^9, 3.548542887297133*^9}, {
  3.548542954782668*^9, 3.548543133745419*^9}, {3.548543198028172*^9, 
  3.548543299084734*^9}},ExpressionUUID->"4721d4f0-ec9e-41b7-837e-\
58a918c8578e"]
}, Closed]],

Cell[CellGroupData[{

Cell["grow", "Subsubsection",
 CellChangeTimes->{{3.547488090793707*^9, 
  3.547488091290257*^9}},ExpressionUUID->"60bef6b0-8ede-41bc-a6c1-\
827fa9adb577"],

Cell[CellGroupData[{

Cell["\<\
grow[Tissue, start, stop,options] (** initialization mode **)\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.5495722212992887`*^9, 3.549572236721695*^9}, {
  3.549575789774158*^9, 
  3.549575794645445*^9}},ExpressionUUID->"c79cc559-99ad-4209-828e-\
791b9384ced2"],

Cell[TextData[{
 "\[OpenCurlyDoubleQuote]Debug\[CloseCurlyDoubleQuote]-> False\n\
\[OpenCurlyDoubleQuote]MemTrace\[CloseCurlyDoubleQuote]-> False\n\
\[OpenCurlyDoubleQuote]Walls\[CloseCurlyDoubleQuote]->True\n\
\[OpenCurlyDoubleQuote]Internal\[CloseCurlyDoubleQuote]-> False\n\
\[OpenCurlyDoubleQuote]Save\[CloseCurlyDoubleQuote]-> True\n\
\[OpenCurlyDoubleQuote]SaveEquations\[CloseCurlyDoubleQuote]-> False\n\
\[OpenCurlyDoubleQuote]SaveODES\[CloseCurlyDoubleQuote]-> False\n\
\[OpenCurlyDoubleQuote]Show\[CloseCurlyDoubleQuote]-> True\n\
\[OpenCurlyDoubleQuote]ShowOptions\[CloseCurlyDoubleQuote]-> {Frame-> True, \
\[OpenCurlyDoubleQuote]CellNumbers\[CloseCurlyDoubleQuote]->True}\n\
\[OpenCurlyDoubleQuote]MaxDivision\[CloseCurlyDoubleQuote]->Infinity\n\
\[OpenCurlyDoubleQuote]MaxRadius\[CloseCurlyDoubleQuote]-> Infinity\n\
\[OpenCurlyDoubleQuote]StepCounter\[CloseCurlyDoubleQuote]-> 1\n\
\[OpenCurlyDoubleQuote]EdgeVariable\[CloseCurlyDoubleQuote]-> ell\n\
\[OpenCurlyDoubleQuote]CellVariable\[CloseCurlyDoubleQuote]-> area\n\
\[OpenCurlyDoubleQuote]RestLength->resting\n\[OpenCurlyDoubleQuote]IC\
\[CloseCurlyDoubleQuote]-> {}\n\[OpenCurlyDoubleQuote]k\
\[CloseCurlyDoubleQuote]-> k (and set value k->value in \
\[OpenCurlyDoubleQuote]Parameters\[CloseCurlyDoubleQuote])\n(or \
\[OpenCurlyDoubleQuote]IsotropicSprings\[CloseCurlyDoubleQuote]->False, \
\[OpenCurlyDoubleQuote]kx\[CloseCurlyDoubleQuote]->value, \
\[OpenCurlyDoubleQuote]ky\[CloseCurlyDoubleQuote]->value, do not set \
\[OpenCurlyDoubleQuote]k\[CloseCurlyDoubleQuote] in \
\[OpenCurlyDoubleQuote]Parameters\[CloseCurlyDoubleQuote])\n\
\[OpenCurlyDoubleQuote]mu\[CloseCurlyDoubleQuote]-> \\[mu] (and set value in \
\[OpenCurlyDoubleQuote]Parameters\[CloseCurlyDoubleQuote])\n(or \
\[OpenCurlyDoubleQuote]Isotropic Growth\[CloseCurlyDoubleQuote]->False, \
\[OpenCurlyDoubleQuote]mux\[CloseCurlyDoubleQuote]-> value, \
\[OpenCurlyDoubleQuote]muy\[CloseCurlyDoubleQuote]-> value, do not set \
\[OpenCurlyDoubleQuote]mu\[CloseCurlyDoubleQuote] in \
\[OpenCurlyDoubleQuote]Parameters\[CloseCurlyDoubleQuote])\n\
\[OpenCurlyDoubleQuote]P\[CloseCurlyDoubleQuote]-> pressure\n\
\[OpenCurlyDoubleQuote]x\[CloseCurlyDoubleQuote]-> x\n\
\[OpenCurlyDoubleQuote]y\[CloseCurlyDoubleQuote]->y\n\
\[OpenCurlyDoubleQuote]extension\[CloseCurlyDoubleQuote]-> 1.0\n\
\[OpenCurlyDoubleQuote]RandomMin\[CloseCurlyDoubleQuote]-> 0.0\n\
\[OpenCurlyDoubleQuote]RandomMax\[CloseCurlyDoubleQuote]-> 0.05\n\
\[OpenCurlyDoubleQuote]DivisionModel\[CloseCurlyDoubleQuote]->\
\[CloseCurlyDoubleQuote]Potential\[CloseCurlyDoubleQuote] (default) or \
\[OpenCurlyDoubleQuote]Errera\[CloseCurlyDoubleQuote]\n\
\[OpenCurlyDoubleQuote]Weights\[CloseCurlyDoubleQuote]-> {1.0, 1.0, 1.0, 0.0} \
requires \[OpenCurlyDoubleQuote]DivisionModel\[CloseCurlyDoubleQuote]->\
\[CloseCurlyDoubleQuote]Potential\[CloseCurlyDoubleQuote]\n\
\[OpenCurlyDoubleQuote]DivisionThreshold\[CloseCurlyDoubleQuote]-> Infinity\n\
\[OpenCurlyDoubleQuote]DivisionSigma\[CloseCurlyDoubleQuote]->0.1 (fraction \
of Threshold)\n\
\[OpenCurlyDoubleQuote]DivisionVariable\[CloseCurlyDoubleQuote]-> area\n\
\[OpenCurlyDoubleQuote]DivisionThresholdVariable\[CloseCurlyDoubleQuote]->\
DivisionThreshold\n\[OpenCurlyDoubleQuote]BoundaryConditions\
\[CloseCurlyDoubleQuote]-> {}\n\[OpenCurlyDoubleQuote]MinAngleSpread\
\[CloseCurlyDoubleQuote]-> 135\n\[OpenCurlyDoubleQuote]Origin\
\[CloseCurlyDoubleQuote]-> {0.0, 0.0}\n\[OpenCurlyDoubleQuote]Virtual\
\[CloseCurlyDoubleQuote]-> False\n\[OpenCurlyDoubleQuote]MaxMemAllowed\
\[CloseCurlyDoubleQuote]-> 0.9\n\[OpenCurlyDoubleQuote]Parameters\
\[CloseCurlyDoubleQuote]-> {}\n\[OpenCurlyDoubleQuote]Diffusion\
\[CloseCurlyDoubleQuote]->{{A,DA}, ...}\n\[OpenCurlyDoubleQuote]Pumps\
\[CloseCurlyDoubleQuote]-> {...} (walled systems only)\n\
\[OpenCurlyDoubleQuote]Intercellular\[CloseCurlyDoubleQuote]->{",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     RowBox[{"X", "\[RightTeeArrow]", "Y"}], ",", 
     RowBox[{"GRN", "[", 
      RowBox[{"v", ",", "b", ",", "n", ",", "h"}], "]"}]}], "}"}], 
   TraditionalForm]],ExpressionUUID->"8b75cd61-fda5-4173-84ac-a266a16fe3cf"],
 ",...} (unwalled systems only)\n\[OpenCurlyDoubleQuote]Dump\
\[CloseCurlyDoubleQuote]->False (changes Save to DumpSave)\n\n\nFor example,  \
To pick up a simulation at an intermediate point from an old file:\n\n\
oldlistofoptions = Get[\[OpenCurlyDoubleQuote]Simulation-Options.nb\
\[CloseCurlyDoubleQuote]] where Simulation-Options is the old \
simulation-options file\noldic = Get[\[OpenCurlyDoubleQuote]ICnnnn.nb\
\[CloseCurlyDoubleQuote]] where ICnnnn.nb is the old IC file\noldTissue = \
ToExpression[Get[\[OpenCurlyDoubleQuote]DTissuennnn.nb\[CloseCurlyDoubleQuote]\
]] where DTissuennnn.nb is the old tissue file\n\ngrow[oldTissue,  tstart,  \
tend, \[OpenCurlyDoubleQuote]IC\[CloseCurlyDoubleQuote]-> oldic, ... \
insert-all-new-options-here, ... Sequence@@oldlistofoptions]\n\n"
}], "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.5495755846559057`*^9, 3.549575674223674*^9, {3.556724227183399*^9, 
   3.556724451533901*^9}, {3.5594914783537292`*^9, 3.5594915030059023`*^9}, {
   3.55949157941334*^9, 3.559491587196682*^9}, {3.559494227812646*^9, 
   3.559494264069848*^9}, {3.566141055273205*^9, 3.566141086570866*^9}, {
   3.571059342022151*^9, 3.571059457127903*^9}, {3.572017478858573*^9, 
   3.572017547917615*^9}, {3.5766208624997177`*^9, 
   3.5766208782675543`*^9}},ExpressionUUID->"02afca92-546d-4a7f-aa61-\
c97944b4c129"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"grow", "[", 
     RowBox[{
      RowBox[{"DT1_", "?", "DTissueQ"}], ",", "tstart_", ",", " ", "tend_", 
      ",", " ", 
      RowBox[{"options___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "Network", ",", "Equations", ",", "ell", ",", "area", ",", 
        "restlength", ",", "k", ",", "mu", ",", "P", ",", " ", "IC", ",", "x",
         ",", "y", ",", " ", "extension", ",", "rmin", ",", "rmax", ",", "OK",
         ",", "parameters", ",", "S", ",", "DT", ",", "weights", ",", " ", 
        "DivThresh", ",", "DivSigma", ",", "DivVar", ",", "ThreshVar", ",", 
        "Rates", ",", " ", "BC", ",", " ", "internal", ",", "save", ",", 
        "simdir", ",", "tdir", ",", "stepcounter", ",", "stepstring", ",", 
        RowBox[{"stepdigits", "=", "4"}], ",", " ", "show", ",", 
        "showoptions", ",", "species", ",", "done", ",", "tbegin", ",", 
        "initial", ",", "MinAngleSpread", ",", "dbg", ",", " ", "dPrint", ",",
         "maxdivs", ",", "ndivs", ",", "lineage", ",", "edgeLineage", ",", 
        "ne", ",", "cpu0", ",", "memtrace", ",", "MemPrint", ",", " ", 
        "haswalls", ",", " ", "tstopped", ",", "maxradius", ",", " ", "DTOLD",
         ",", "origin", ",", "Virtual", ",", "MaxMemAllowed", ",", " ", 
        "SaveEquations", ",", " ", "SaveODES", ",", " ", "SaveNet", ",", 
        "continuation", ",", " ", "continuationnote", ",", " ", "GB", ",", 
        "TestCase", ",", "snapshot", ",", " ", 
        "IgnoreDivisionBeyondThisRadius", ",", " ", "divisionModel", ",", " ",
         "IsotropicGrowth", ",", " ", "IsotropicSprings", ",", " ", 
        "L1Anticlinal", ",", " ", "L2Anticlinal", ",", "L2AnticlinalRatio", 
        ",", " ", "tip", ",", "center", ",", "perim", ",", "tipdist", ",", 
        " ", "growing", ",", " ", "L1", ",", " ", "L2", ",", " ", "TIPF", ",",
         " ", "opt", ",", " ", "xy", ",", "dump", ",", " ", "PD"}], "}"}], 
      ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"GB", "=", 
        RowBox[{"1024.0", "*", "1024.0", "*", "1024.0"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"cpu0", "=", 
        RowBox[{"TimeUsed", "[", "]"}]}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"opt", " ", "=", " ", 
        RowBox[{"Sequence", "@@", 
         RowBox[{"ProcessCellzillaArrows", "[", "options", "]"}]}]}], ";", 
       " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"{", "opt", "}"}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dbg", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<Debug\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<Debug\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";", 
       " ", "\[IndentingNewLine]", 
       RowBox[{"$DebugHasSufficientInfo", "=", 
        RowBox[{
         RowBox[{"\"\<DebugHasSufficientInfo\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<DebugHasSufficientInfo\>\"", "\[Rule]", " ", "False"}],
           "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dPrint", "[", "u___", "]"}], ":=", " ", 
        RowBox[{"If", "[", 
         RowBox[{"dbg", ",", " ", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<grow: \>\"", ",", " ", "u"}], "]"}]}], "]"}]}], ";", 
       " ", "\[IndentingNewLine]", 
       RowBox[{"memtrace", "=", 
        RowBox[{
         RowBox[{"\"\<MemTrace\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<MemTrace\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], 
       ";", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MemPrint", "[", "u___", "]"}], ":=", " ", 
        RowBox[{"If", "[", 
         RowBox[{"memtrace", ",", " ", 
          RowBox[{"Print", "[", 
           RowBox[{
            RowBox[{"MemoryInUse", "[", "]"}], ",", "\"\< \>\"", ",", " ", 
            RowBox[{"MaxMemoryUsed", "[", "]"}], ",", "\"\< \>\"", ",", 
            RowBox[{
             RowBox[{"TimeUsed", "[", "]"}], "-", "cpu0"}], ",", "\"\< \>\"", 
            ",", " ", "u"}], "]"}]}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "override", " ", "any", " ", "default", " ", "values", " ", "further",
          " ", 
         RowBox[{"downstream", "!"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"IsotropicGrowth", "=", 
        RowBox[{
         RowBox[{"\"\<IsotropicGrowth\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<IsotropicGrowth\>\"", "\[Rule]", " ", "True"}], 
          "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"IsotropicSprings", "=", 
        RowBox[{
         RowBox[{"\"\<IsotropicSprings\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<IsotropicSprings\>\"", "\[Rule]", " ", "True"}], 
          "}"}]}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"haswalls", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<Walls\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<Walls\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";", 
       " ", "\[IndentingNewLine]", 
       RowBox[{"internal", "=", 
        RowBox[{
         RowBox[{"\"\<Internal\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<Internal\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], 
       ";", " ", "\[IndentingNewLine]", 
       RowBox[{"save", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<Save\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<Save\>\"", "\[Rule]", " ", "True"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dump", "=", 
        RowBox[{
         RowBox[{"\"\<Dump\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<Dump\>\"", "\[Rule]", " ", "True"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dump", " ", "=", " ", 
        RowBox[{"dump", " ", "\[And]", " ", "save"}]}], ";", "   ", 
       "\[IndentingNewLine]", 
       RowBox[{"SaveEquations", "=", 
        RowBox[{
         RowBox[{"\"\<SaveEquations\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<SaveEquations\>\"", "\[Rule]", " ", "False"}], 
          "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"SaveODES", "=", 
        RowBox[{
         RowBox[{"\"\<SaveODES\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<SaveODES\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], 
       ";", " ", "\[IndentingNewLine]", 
       RowBox[{"SaveNet", "=", 
        RowBox[{
         RowBox[{"\"\<SaveNet\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<SaveNet\>\"", "\[Rule]", " ", "True"}], "}"}]}]}], ";",
        " ", "\[IndentingNewLine]", 
       RowBox[{"show", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<Show\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<Show\>\"", "\[Rule]", " ", "True"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"showoptions", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<ShowOptions\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<ShowOptions\>\"", "\[Rule]", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", " ", 
             RowBox[{"\"\<CellNumbers\>\"", "\[Rule]", " ", "True"}], ",", 
             " ", 
             RowBox[{"ImageSize", "\[Rule]", " ", "200"}], ",", " ", 
             RowBox[{"\"\<EdgeNumbers\>\"", "\[Rule]", " ", "False"}]}], 
            "}"}]}], "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"maxdivs", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<MaxDivisions\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<MaxDivisions\>\"", "\[Rule]", " ", "\[Infinity]"}], 
          "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ndivs", " ", "=", " ", "0"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"maxradius", "=", 
        RowBox[{
         RowBox[{"\"\<MaxRadius\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<MaxRadius\>\"", "\[Rule]", " ", "\[Infinity]"}], 
          "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"continuationnote", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<Continuation\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<Continuation\>\"", "\[Rule]", " ", "\"\<\>\""}], 
          "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"continuation", " ", "=", " ", 
        RowBox[{
         RowBox[{"StringLength", "[", "continuationnote", "]"}], ">", "0"}]}],
        ";", " ", "\[IndentingNewLine]", 
       RowBox[{"TestCase", "=", 
        RowBox[{
         RowBox[{"\"\<TestCase\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<TestCase\>\"", "\[Rule]", " ", "\"\<Growzilla\>\""}], 
          "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"TestCase", "=", 
        RowBox[{
         RowBox[{"ToString", "[", "TestCase", "]"}], "<>", "\"\<-\>\""}]}], 
       ";", " ", "\[IndentingNewLine]", 
       RowBox[{"growing", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<Growing\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<Growing\>\"", "\[Rule]", " ", "True"}], "}"}]}]}], ";",
        " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", "\"\<Initializing.\>\"", "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"lineage", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Rule", "[", 
           RowBox[{"0", ",", "#"}], "]"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{"First", "/@", 
           RowBox[{"TissueCells", "[", "DT1", "]"}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ne", "=", 
        RowBox[{"NTissueEdges", "[", "DT1", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"edgeLineage", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Rule", "[", 
           RowBox[{"0", ",", "#"}], "]"}], "&"}], "/@", 
         RowBox[{"Range", "[", "ne", "]"}]}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"initialize$olutions", "[", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"internal", ",", " ", "\[IndentingNewLine]", 
         RowBox[{"save", "=", "False"}], ",", " ", 
         RowBox[{"save", "=", "True"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"stepcounter", "=", "1"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"save", ",", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"CellzillaHome", "=", 
           RowBox[{"CreateHomeFolder", "[", "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"tdir", " ", "=", " ", 
           RowBox[{"createTodaysFolder", "[", 
            RowBox[{"ToFileName", "[", 
             RowBox[{"CellzillaHome", ",", "\"\<Simulations-\>\""}], "]"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"simdir", "=", 
           RowBox[{"createUniqueFolder", "[", 
            RowBox[{"ToFileName", "[", 
             RowBox[{"tdir", ",", "TestCase"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"$SIMDIR", " ", "=", " ", "simdir"}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<simdir = \>\"", ",", " ", "simdir"}], "]"}], ";", " ",
           "\[IndentingNewLine]", 
          RowBox[{"stepcounter", " ", "=", " ", 
           RowBox[{
            RowBox[{"\"\<StepCounter\>\"", "/.", 
             RowBox[{"{", "opt", "}"}]}], "/.", 
            RowBox[{"{", 
             RowBox[{"\"\<StepCounter\>\"", "\[Rule]", " ", "1"}], "}"}]}]}], 
          ";", " ", "\[IndentingNewLine]", 
          RowBox[{"stepstring", " ", "=", " ", 
           RowBox[{"IntegerString", "[", 
            RowBox[{"stepcounter", ",", "10", ",", "stepdigits"}], "]"}]}], 
          ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"$TISSUEFILE", "=", 
           RowBox[{"UniqueFileName", "[", 
            RowBox[{"simdir", ",", 
             RowBox[{"\"\<DTissue\>\"", "<>", "stepstring"}], ",", 
             "\"\<nb\>\""}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"SaveFile", "[", 
           RowBox[{"$TISSUEFILE", ",", 
            RowBox[{"ToString", "[", 
             RowBox[{"InputForm", "[", "DT1", "]"}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"$OPTIONFILE", "=", 
           RowBox[{"UniqueFileName", "[", 
            RowBox[{
            "simdir", ",", "\"\<Simulation-Options\>\"", ",", "\"\<nb\>\""}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"SaveFile", "[", 
           RowBox[{"$OPTIONFILE", ",", 
            RowBox[{"{", "opt", "}"}]}], "]"}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"continuation", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"SaveFile", "[", 
              RowBox[{
               RowBox[{"UniqueFileName", "[", 
                RowBox[{
                "simdir", ",", "\"\<continuation\>\"", ",", " ", 
                 "\"\<txt\>\""}], "]"}], ",", " ", "continuationnote"}], 
              "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], " ", 
        "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", "\"\<Getting options.\>\"", "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"ell", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<EdgeVariable\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<EdgeVariable\>\"", "\[Rule]", " ", "Global`ell"}], 
          "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"area", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<CellVariable\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<CellVariable\>\"", "\[Rule]", " ", "Global`cell"}], 
          "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"restlength", "=", 
        RowBox[{
         RowBox[{"\"\<Restlength\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<Restlength\>\"", "\[Rule]", " ", "Global`resting"}], 
          "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"IC", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<IC\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<IC\>\"", "\[Rule]", " ", 
           RowBox[{"{", "}"}]}], "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"k", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<k\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<k\>\"", "\[Rule]", " ", "Global`k"}], "}"}]}]}], ";", 
       " ", "\[IndentingNewLine]", 
       RowBox[{"mu", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<mu\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<mu\>\"", "\[Rule]", " ", "Global`\[Mu]"}], "}"}]}]}], 
       ";", " ", "\[IndentingNewLine]", 
       RowBox[{"P", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<P\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<P\>\"", "\[Rule]", " ", "Global`P"}], "}"}]}]}], ";", 
       " ", "\[IndentingNewLine]", 
       RowBox[{"xy", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<xy\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<xy\>\"", "\[Rule]", " ", "True"}], "}"}]}]}], ";", " ",
        "\[IndentingNewLine]", 
       RowBox[{"x", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<x\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<x\>\"", "\[Rule]", " ", "Global`x"}], "}"}]}]}], ";", 
       " ", "\[IndentingNewLine]", 
       RowBox[{"y", "=", 
        RowBox[{
         RowBox[{"\"\<y\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<y\>\"", "\[Rule]", " ", "Global`y"}], "}"}]}]}], ";", 
       " ", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", "xy"}], ",", " ", 
         RowBox[{"x", "=", 
          RowBox[{"y", "=", "False"}]}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"tip", "=", 
        RowBox[{
         RowBox[{"\"\<tip\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<tip\>\"", "\[Rule]", " ", "Global`tip"}], "}"}]}]}], 
       ";", " ", "\[IndentingNewLine]", 
       RowBox[{"center", "=", 
        RowBox[{
         RowBox[{"\"\<center\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<center\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";",
        " ", "\[IndentingNewLine]", 
       RowBox[{"perim", "=", 
        RowBox[{
         RowBox[{"\"\<perimeter\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<perimeter\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], 
       ";", " ", "\[IndentingNewLine]", 
       RowBox[{"tipdist", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<tipDistance\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<tipDistance\>\"", "\[Rule]", " ", "False"}], "}"}]}]}],
        ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"extension", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<extension\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<extension\>\"", "\[Rule]", " ", "1.0"}], "}"}]}]}], 
       ";", " ", "\[IndentingNewLine]", 
       RowBox[{"rmin", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<RandomMin\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<RandomMin\>\"", "\[Rule]", " ", "0.0"}], "}"}]}]}], 
       ";", " ", "\[IndentingNewLine]", 
       RowBox[{"rmax", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<RandomMax\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<RandomMax\>\"", "\[Rule]", " ", "0.05"}], "}"}]}]}], 
       ";", " ", "\[IndentingNewLine]", 
       RowBox[{"weights", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<Weights\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<Weights\>\"", "\[Rule]", " ", 
           RowBox[{"{", 
            RowBox[{"1.", ",", "1.", ",", "1.", ",", " ", "0."}], "}"}]}], 
          "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"divisionModel", "=", 
        RowBox[{
         RowBox[{"\"\<DivisionModel\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{
          "\"\<DivisionModel\>\"", "\[Rule]", " ", "\"\<Potential\>\""}], 
          "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"DivThresh", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<DivisionThreshold\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{
          "\"\<DivisionThreshold\>\"", "\[Rule]", " ", "\[Infinity]"}], 
          "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"DivSigma", "=", 
        RowBox[{
         RowBox[{"\"\<DivisionSigma\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<DivisionSigma\>\"", "\[Rule]", " ", "0.1"}], "}"}]}]}],
        ";", " ", "\[IndentingNewLine]", 
       RowBox[{"DivSigma", "=", 
        RowBox[{"DivSigma", "*", "DivThresh"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"L1Anticlinal", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<L1Anticlinal\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<L1Anticlinal\>\"", "\[Rule]", " ", "True"}], "}"}]}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"L2Anticlinal", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<L2Anticlinal\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<L2Anticlinal\>\"", "\[Rule]", " ", "False"}], 
          "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"L2AnticlinalRatio", "=", " ", 
        RowBox[{
         RowBox[{"\"\<L2AnticlinalRatio\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<L2AnticlinalRatio\>\"", "\[Rule]", " ", 
           RowBox[{"1.0", "*", "GoldenRatio"}]}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"PD", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<PrincipalDirection\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<PrincipalDirection\>\"", "\[Rule]", " ", "False"}], 
          "}"}]}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       " ", "\[IndentingNewLine]", 
       RowBox[{"L1", " ", "=", 
        RowBox[{
         RowBox[{"\"\<L1\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<L1\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";", 
       " ", "\[IndentingNewLine]", 
       RowBox[{"L2", "=", " ", 
        RowBox[{
         RowBox[{"\"\<L2\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<L2\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";", 
       " ", "\[IndentingNewLine]", 
       RowBox[{"TIPF", "=", 
        RowBox[{
         RowBox[{"\"\<TipFlag\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<TipFlag\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], 
       ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"IgnoreDivisionBeyondThisRadius", "=", 
        RowBox[{
         RowBox[{"\"\<IgnoreDivisionRadius\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{
          "\"\<IgnoreDivisionRadius\>\"", "\[Rule]", " ", "\[Infinity]"}], 
          "}"}]}]}], ";", " ", "\[IndentingNewLine]", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"DivVar", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<DivisionVariable\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<DivisionVariable\>\"", "\[Rule]", "area"}], "}"}]}]}], 
       ";", " ", "\[IndentingNewLine]", 
       RowBox[{"ThreshVar", "=", 
        RowBox[{
         RowBox[{"\"\<DivisionThresholdVariable\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{
          "\"\<DivisionThresholdVariable\>\"", "\[Rule]", " ", 
           "Global`CellDivisionThreshold"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"$DivisionThresholds", "=", 
        RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"BC", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<BoundaryConditions\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<BoundaryConditions\>\"", "\[Rule]", " ", 
           RowBox[{"{", "}"}]}], "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"MinAngleSpread", "=", 
        RowBox[{
         RowBox[{"\"\<MinAngleSpread\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<MinAngleSpread\>\"", "\[Rule]", " ", "135.0"}], 
          "}"}]}]}], ";", "   ", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<MinAngleSpread: \>\"", ",", " ", "MinAngleSpread"}], 
        "]"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"origin", "=", " ", 
        RowBox[{
         RowBox[{"\"\<Origin\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<Origin\>\"", "\[Rule]", " ", 
           RowBox[{"{", 
            RowBox[{"0.0", ",", "0.0"}], "}"}]}], "}"}]}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"Virtual", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<Virtual\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<Virtual\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], 
       ";", " ", "\[IndentingNewLine]", 
       RowBox[{"MaxMemAllowed", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<MaxMemAllowed\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<MaxMemAllowed\>\"", "\[Rule]", " ", ".9"}], "}"}]}]}], 
       ";", " ", "\[IndentingNewLine]", 
       RowBox[{"MaxMemAllowed", "=", 
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"Min", "[", 
           RowBox[{"MaxMemAllowed", ",", "1.0"}], "]"}], ",", "0.0"}], 
         "]"}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"parameters", " ", "=", 
        RowBox[{
         RowBox[{"\"\<Parameters\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<Parameters\>\"", "\[Rule]", " ", 
           RowBox[{"{", "}"}]}], "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"DT", " ", "=", " ", "DT1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"tbegin", "=", "tstart"}], ";", "\[IndentingNewLine]", 
       RowBox[{"initial", " ", "=", " ", "True"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"done", "=", "False"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"MemPrint", "[", "\"\<Getting options\>\"", "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", "\"\<Starting While loop.\>\"", "]"}], ";", " ",
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"show", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"snapshot", "=", 
           RowBox[{"ShowTissue", "[", 
            RowBox[{"DT", ",", 
             RowBox[{"PlotLabel", "\[Rule]", " ", "\"\<Initial Tissue\>\""}], 
             ",", " ", 
             RowBox[{"Sequence", "@@", "showoptions"}], ",", " ", 
             RowBox[{"\"\<CellNumbers\>\"", "\[Rule]", " ", "True"}], ",", 
             RowBox[{"\"\<EdgeStyles\>\"", "\[Rule]", " ", "Brown"}], ",", 
             " ", 
             RowBox[{"PlotRange", "\[Rule]", " ", "All"}], ",", " ", 
             RowBox[{"Frame", "\[Rule]", " ", "True"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"save", ",", " ", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"$SNAPSHOTFILE", "=", 
              RowBox[{"UniqueFileName", "[", 
               RowBox[{"simdir", ",", 
                RowBox[{"\"\<Snapshot\>\"", "<>", "stepstring"}], ",", 
                "\"\<png\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"Export", "[", 
              RowBox[{"$SNAPSHOTFILE", ",", "snapshot"}], "]"}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<Tissue snapshot written to \>\"", ",", " ", 
               "$SNAPSHOTFILE"}], "]"}], ";"}]}], " ", "\[IndentingNewLine]", 
           "]"}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", "\[IndentingNewLine]", 
           RowBox[{"TableForm", "[", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\"\<Actual Clock Time: \>\"", ",", " ", 
                RowBox[{"now", "[", "]"}]}], "}"}], ",", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"\"\<Memory in Use (GB): \>\"", ",", " ", 
                RowBox[{
                 RowBox[{"MemoryInUse", "[", "]"}], "/", "GB"}]}], "}"}], ",",
               "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"\"\<Max Memory Used (GB): \>\"", ",", " ", 
                RowBox[{
                 RowBox[{"MaxMemoryUsed", "[", "]"}], "/", "GB"}]}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"\"\<Free Memory (GB): \>\"", ",", " ", 
                RowBox[{
                 RowBox[{"MemoryFree", "[", "]"}], "/", "GB"}]}], "}"}]}], 
             "\[IndentingNewLine]", "}"}], "]"}], "]"}], ";"}]}], " ", 
        "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{"Not", "[", "done", "]"}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"$Tissue", "=", "DT"}], ";", " ", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", "\"\<Generating Network.\>\"", "]"}], ";", 
          " ", "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<haswalls=\>\"", ",", " ", "haswalls"}], "]"}], ";", 
          " ", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"haswalls", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Network", ",", " ", "Equations"}], "}"}], "=", 
              RowBox[{"WalledNetwork", "[", 
               RowBox[{"DT", ",", 
                RowBox[{"\"\<EdgeVariable\>\"", "\[Rule]", " ", "ell"}], ",", 
                " ", 
                RowBox[{"\"\<CellVariable\>\"", "\[Rule]", " ", "area"}], ",", 
                RowBox[{"\"\<Restlength\>\"", "\[Rule]", " ", "restlength"}], 
                ",", 
                RowBox[{"\"\<k\>\"", "\[Rule]", " ", "k"}], ",", "  ", 
                RowBox[{"\"\<mu\>\"", "\[Rule]", " ", "mu"}], ",", 
                RowBox[{"\"\<P\>\"", "\[Rule]", " ", "P"}], ",", 
                RowBox[{"\"\<x\>\"", "\[Rule]", " ", "x"}], ",", " ", 
                RowBox[{"\"\<y\>\"", "\[Rule]", " ", "y"}], ",", " ", "opt"}],
                "]"}]}], ";"}], " ", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Network", ",", " ", "Equations"}], "}"}], "=", 
              RowBox[{"UnwalledNetwork", "[", 
               RowBox[{"DT", ",", 
                RowBox[{"\"\<EdgeVariable\>\"", "\[Rule]", " ", "ell"}], ",", 
                " ", 
                RowBox[{"\"\<CellVariable\>\"", "\[Rule]", " ", "area"}], ",", 
                RowBox[{"\"\<Restlength\>\"", "\[Rule]", " ", "restlength"}], 
                ",", 
                RowBox[{"\"\<k\>\"", "\[Rule]", " ", "k"}], ",", "  ", 
                RowBox[{"\"\<mu\>\"", "\[Rule]", " ", "mu"}], ",", 
                RowBox[{"\"\<P\>\"", "\[Rule]", " ", "P"}], ",", 
                RowBox[{"\"\<x\>\"", "\[Rule]", " ", "x"}], ",", " ", 
                RowBox[{"\"\<y\>\"", "\[Rule]", " ", "y"}], ",", " ", "opt"}],
                "]"}]}], ";"}]}], " ", "\[IndentingNewLine]", "]"}], ";", " ",
           "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<network:\>\"", ",", " ", 
            RowBox[{"Short", "[", 
             RowBox[{"Network", ",", "5"}], "]"}]}], "]"}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"MemPrint", "[", "\"\<Generating Network.\>\"", "]"}], ";", 
          " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"save", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{"SaveNet", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"$NETFILE", "=", 
                 RowBox[{"UniqueFileName", "[", 
                  RowBox[{"simdir", ",", 
                   RowBox[{"\"\<Network\>\"", "<>", "stepstring"}], ",", 
                   "\"\<nb\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"SaveFile", "[", 
                 RowBox[{"$NETFILE", ",", "Network"}], "]"}]}]}], "]"}], 
             ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{
          "MemPrint", "[", "\"\<Saving Network & Equations.\>\"", "]"}], ";", 
          " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", "\"\<Generaing ICs\>\"", "]"}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"initial", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"IC", " ", "=", " ", 
              RowBox[{"SetRandomizedIC", "[", 
               RowBox[{
               "IC", ",", " ", "DT", ",", "Network", ",", " ", "Equations", 
                ",", "  ", "ell", ",", "area", ",", "restlength", ",", "x", 
                ",", "y", ",", "extension", ",", "rmin", ",", "rmax", ",", 
                " ", "IsotropicGrowth", ",", " ", "mu", ",", " ", 
                "IsotropicSprings", ",", " ", "k", ",", " ", "tip", ",", 
                "center", ",", "tipdist", ",", "perim", ",", " ", "P", ",", 
                " ", "growing", ",", " ", "L1", ",", " ", "L2", ",", " ", 
                "TIPF", ",", " ", "PD", ",", " ", "parameters"}], "]"}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"initial", "=", "False"}], ";"}], "\[IndentingNewLine]", 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"IC", "=", 
              RowBox[{"SetNextIC", "[", 
               RowBox[{
               "DT", ",", "DTOLD", ",", " ", "S", ",", "Network", ",", 
                "Equations", ",", "  ", "ell", ",", "area", ",", "restlength",
                 ",", "x", ",", "y", ",", " ", "IsotropicGrowth", ",", " ", 
                "mu", ",", " ", "IsotropicSprings", ",", "k", ",", " ", "tip",
                 ",", "center", ",", "tipdist", ",", " ", "perim", ",", "P", 
                ",", " ", "L1", ",", "L2", ",", "TIPF", ",", " ", "PD", ",", 
                " ", "parameters", ",", " ", 
                RowBox[{
                 RowBox[{"\"\<ICDebug\>\"", "/.", 
                  RowBox[{"{", "opt", "}"}]}], "/.", 
                 RowBox[{"{", 
                  RowBox[{"\"\<ICDebug\>\"", "\[Rule]", " ", "False"}], 
                  "}"}]}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"MemPrint", "[", "\"\<Generating ICs\>\"", "]"}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", "\"\<Running simulation.\>\"", "]"}], ";", 
          " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"S", " ", "=", " ", 
           RowBox[{"go", "[", 
            RowBox[{
            "DT", ",", " ", "Network", ",", "tbegin", ",", "tend", ",", 
             RowBox[{"\"\<Lineage\>\"", "\[Rule]", " ", "lineage"}], ",", 
             RowBox[{"\"\<EdgeLineage\>\"", "\[Rule]", " ", "edgeLineage"}], 
             ",", "  ", 
             RowBox[{"\"\<IC\>\"", "\[Rule]", " ", "IC"}], ",", 
             RowBox[{"\"\<Parameters\>\"", "\[Rule]", " ", "parameters"}], 
             ",", " ", 
             RowBox[{"\"\<Equations\>\"", "\[Rule]", " ", "Equations"}], ",", 
             " ", "\[IndentingNewLine]", 
             RowBox[{
             "\"\<DivisionModel\>\"", "\[Rule]", " ", "divisionModel"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
             "\"\<L1Anticlinal\>\"", "\[Rule]", "  ", "L1Anticlinal"}], ",", 
             " ", "\[IndentingNewLine]", 
             RowBox[{"\"\<L2Anticlinal\>\"", "\[Rule]", " ", "L2Anticlinal"}],
              ",", "\[IndentingNewLine]", 
             RowBox[{
             "\"\<L2AnticlinalRatio\>\"", "\[Rule]", " ", 
              "L2AnticlinalRatio"}], ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<Weights\>\"", "\[Rule]", " ", "weights"}], ",", " ", 
             RowBox[{
             "\"\<DivisionThreshold\>\"", "\[Rule]", " ", "DivThresh"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<DivisionSigma\>\"", "\[Rule]", " ", "DivSigma"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{
             "\"\<IgnoreDivisionRadius\>\"", "\[Rule]", " ", 
              "IgnoreDivisionBeyondThisRadius"}], ",", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<DivisionVariable\>\"", "\[Rule]", " ", "DivVar"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{
             "\"\<DivisionThresholdVariable\>\"", "\[Rule]", " ", 
              "ThreshVar"}], ",", "\[IndentingNewLine]", 
             RowBox[{
             "\"\<MinAngleSpread\>\"", "\[Rule]", " ", "MinAngleSpread"}], 
             ",", " ", 
             RowBox[{"\"\<Save\>\"", "\[Rule]", " ", "save"}], ",", 
             RowBox[{"\"\<Dump\>\"", "\[Rule]", " ", "dump"}], ",", "  ", 
             RowBox[{"\"\<StepString\>\"", "\[Rule]", " ", "stepstring"}], 
             ",", 
             RowBox[{"\"\<SimDir\>\"", "\[Rule]", " ", "simdir"}], ",", " ", 
             RowBox[{"\"\<GoDebug\>\"", "\[Rule]", " ", "dbg"}], ",", " ", 
             RowBox[{"\"\<DivideDebug\>\"", "\[Rule]", " ", 
              RowBox[{"(", 
               RowBox[{"\"\<DivideDebug\>\"", "/.", 
                RowBox[{"{", "opt", "}"}]}], ")"}]}], ",", " ", 
             RowBox[{"\"\<MemTrace\>\"", "\[Rule]", " ", "memtrace"}], ",", 
             " ", 
             RowBox[{"\"\<CPU0\>\"", "\[Rule]", " ", "cpu0"}], ",", 
             RowBox[{"\"\<EdgeVariable\>\"", "\[Rule]", " ", "ell"}], ",", 
             RowBox[{"\"\<CellVariable\>\"", "\[Rule]", " ", "area"}], ",", 
             " ", 
             RowBox[{"\"\<MaxRadius\>\"", "\[Rule]", " ", "maxradius"}], ",", 
             " ", 
             RowBox[{"\"\<Origin\>\"", "\[Rule]", " ", "origin"}], ",", " ", 
             RowBox[{"\"\<SaveODES\>\"", "\[Rule]", " ", "SaveODES"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
             "\"\<SaveEquations\>\"", "\[Rule]", " ", "SaveEquations"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<Upwards\>\"", "\[Rule]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\"\<Upwards\>\"", "/.", 
                 RowBox[{"{", "opt", "}"}]}], "/.", 
                RowBox[{"{", 
                 RowBox[{"\"\<Upwards\>\"", "\[Rule]", " ", "False"}], 
                 "}"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<x\>\"", "\[Rule]", " ", "x"}], ",", " ", 
             RowBox[{"\"\<y\>\"", "\[Rule]", " ", "y"}], ",", " ", 
             RowBox[{"\"\<Growing\>\"", "\[Rule]", " ", "growing"}]}], 
            "]"}]}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"MemPrint", "[", "\"\<Simulation\>\"", "]"}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", "\"\<Saving results.\>\"", "]"}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "TNext", ",", "t1", ",", "t2", ",", "TheseTimes", ",", "n", ",", 
              "div", ",", "divl", ",", "colors", ",", "dynamicc", ",", 
              "staticc", ",", "dynamnic2Static", ",", "MostRecentChild", ",", 
              "nvars"}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"TNext", " ", "=", " ", 
              RowBox[{"\"\<Tissue\>\"", "/.", "S"}]}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"Global`$$SOLUTION", " ", "=", " ", 
              RowBox[{"\"\<Solution\>\"", "/.", "S"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"nvars", " ", "=", " ", 
              RowBox[{"Length", "[", "Global`$$SOLUTION", "]"}]}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"TheseTimes", " ", "=", " ", 
              RowBox[{"\"\<TimeSpan\>\"", "/.", "S"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"t1", ",", "t2"}], "}"}], "=", "TheseTimes"}], ";", 
             " ", "\[IndentingNewLine]", 
             RowBox[{"$TimeSpans", " ", "=", " ", 
              RowBox[{"Append", "[", 
               RowBox[{"$TimeSpans", ",", 
                RowBox[{"{", 
                 RowBox[{"t1", ",", "t2"}], "}"}]}], "]"}]}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"lineage", " ", "=", " ", 
              RowBox[{"\"\<Lineage\>\"", "/.", "S"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"edgeLineage", "=", 
              RowBox[{"\"\<EdgeLineage\>\"", "/.", "S"}]}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{"save", " ", ",", " ", 
               RowBox[{"(*", " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"don", "'"}], "t", " ", "save", " ", "end", " ", 
                   "of", " ", "static", " ", "simulation", " ", "if", " ", 
                   "x"}], "&"}], "y", " ", "turned", " ", 
                 RowBox[{"off", "!!"}]}], " ", "*)"}], "\[IndentingNewLine]", 
               
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{"dump", ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"$SOLUTIONFILE", "=", 
                    RowBox[{"UniqueFileName", "[", 
                    RowBox[{"simdir", ",", 
                    RowBox[{"\"\<Solution\>\"", "<>", "stepstring"}], ",", 
                    "\"\<mx\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"DumpSave", "[", 
                    RowBox[{"$SOLUTIONFILE", ",", "Global`$$SOLUTION"}], 
                    "]"}], ";"}], "\[IndentingNewLine]", ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"$SOLUTIONFILE", "=", 
                    RowBox[{"UniqueFileName", "[", 
                    RowBox[{"simdir", ",", 
                    RowBox[{"\"\<Solution\>\"", "<>", "stepstring"}], ",", 
                    "\"\<nb\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"SaveFile", "[", 
                    RowBox[{"$SOLUTIONFILE", ",", "Global`$$SOLUTION"}], 
                    "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"$LINEAGEFILE", "=", 
                 RowBox[{"ToFileName", "[", 
                  RowBox[{"simdir", ",", "\"\<Lineage.nb\>\""}], "]"}]}], ";",
                 "\[IndentingNewLine]", 
                RowBox[{"SaveFile", "[", 
                 RowBox[{"$LINEAGEFILE", ",", "lineage"}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"$EDGELINEAGEFILE", "=", 
                 RowBox[{"ToFileName", "[", 
                  RowBox[{"simdir", ",", "\"\<EdgeLineage.nb\>\""}], "]"}]}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"SaveFile", "[", 
                 RowBox[{"$EDGELINEAGEFILE", ",", "edgeLineage"}], "]"}], ";",
                 "\[IndentingNewLine]", 
                RowBox[{"$TIMESPANFILE", "=", 
                 RowBox[{"ToFileName", "[", 
                  RowBox[{"simdir", ",", "\"\<TimeSpans.nb\>\""}], "]"}]}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"SaveFile", "[", 
                 RowBox[{"$TIMESPANFILE", ",", " ", "$TimeSpans"}], "]"}], 
                ";", " ", "\[IndentingNewLine]", 
                RowBox[{"stepcounter", " ", "=", " ", 
                 RowBox[{"stepcounter", "+", "1"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"stepstring", " ", "=", " ", 
                 RowBox[{"IntegerString", "[", 
                  RowBox[{"stepcounter", ",", "10", ",", "stepdigits"}], 
                  "]"}]}], ";", " ", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{"xy", ",", " ", 
                  RowBox[{
                   RowBox[{"$TISSUEFILE", " ", "=", " ", 
                    RowBox[{"UniqueFileName", "[", 
                    RowBox[{"simdir", ",", 
                    RowBox[{"\"\<DTissue\>\"", "<>", "stepstring"}], ",", 
                    "\"\<nb\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"SaveFile", "[", 
                    RowBox[{"$TISSUEFILE", ",", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"InputForm", "[", "TNext", "]"}], "]"}]}], 
                    "]"}]}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"MemPrint", "[", "\"\<Saving Files\>\"", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"ndivs", " ", "=", " ", 
              RowBox[{"ndivs", " ", "+", " ", 
               RowBox[{"Length", "[", " ", 
                RowBox[{
                 RowBox[{"\"\<Divide\>\"", "/.", "S"}], "/.", 
                 RowBox[{"{", 
                  RowBox[{"\"\<Divide\>\"", "\[Rule]", " ", 
                   RowBox[{"{", "}"}]}], "}"}]}], "]"}]}]}], ";", " ", 
             "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"dPrint", "[", 
              RowBox[{"\"\<**** tissue: \>\"", ",", " ", "TNext"}], "]"}], 
             ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{"show", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"n", "=", 
                 RowBox[{"NTissueCells", "[", "TNext", "]"}]}], ";", " ", 
                "\[IndentingNewLine]", 
                RowBox[{"div", " ", "=", " ", 
                 RowBox[{
                  RowBox[{"\"\<Divide\>\"", "/.", "S"}], "/.", 
                  RowBox[{"{", 
                   RowBox[{"\"\<Divide\>\"", "\[Rule]", " ", 
                    RowBox[{"{", "}"}]}], "}"}]}]}], ";", 
                "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{
                 "In", " ", "Most", " ", "Cases", " ", "the", " ", 
                  "following", " ", "will", " ", "be", " ", "the", " ", 
                  "same", " ", "as", " ", 
                  RowBox[{"Reverse", "[", "lineage", "]"}]}], " ", "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{
                 "But", " ", "not", " ", "if", " ", "the", " ", "numbers", 
                  " ", "are", " ", "out", " ", "of", " ", "order"}], " ", 
                 "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"MostRecentChild", "=", 
                 RowBox[{"Reverse", "/@", 
                  RowBox[{"Reverse", "[", 
                   RowBox[{"Sort", "[", 
                    RowBox[{"Reverse", "/@", "lineage"}], "]"}], "]"}]}]}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"divl", " ", "=", " ", 
                 RowBox[{"div", "/.", "MostRecentChild"}]}], ";", " ", 
                "\[IndentingNewLine]", 
                RowBox[{"div", " ", "=", " ", 
                 RowBox[{"Join", "[", 
                  RowBox[{"div", ",", "divl"}], "]"}]}], ";", " ", 
                "\[IndentingNewLine]", 
                RowBox[{"dynamicc", "=", 
                 RowBox[{"First", "/@", 
                  RowBox[{"TissueCells", "[", "TNext", "]"}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"colors", "=", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"div", ",", "#"}], "]"}], ",", 
                    RowBox[{"{", "LightPink", "}"}], ",", 
                    RowBox[{"{", "LightGreen", "}"}]}], "]"}], "&"}], "/@", 
                  "dynamicc"}]}], ";", 
                RowBox[{"snapshot", "=", 
                 RowBox[{"ShowTissue", "[", 
                  RowBox[{"TNext", ",", 
                   RowBox[{"PlotLabel", "\[Rule]", " ", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"InputForm", "[", "t2", "]"}], "]"}]}], ",", 
                   RowBox[{"\"\<CellStyles\>\"", "\[Rule]", " ", "colors"}], 
                   ",", " ", 
                   RowBox[{"Sequence", "@@", "showoptions"}], ",", " ", 
                   RowBox[{"\"\<CellNumbers\>\"", "\[Rule]", " ", "True"}], 
                   ",", 
                   RowBox[{"\"\<EdgeStyles\>\"", "\[Rule]", " ", "Brown"}]}], 
                  "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                
                RowBox[{"If", "[", 
                 RowBox[{"xy", ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{"save", ",", " ", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"$SNAPSHOTFILE", "=", 
                    RowBox[{"UniqueFileName", "[", 
                    RowBox[{"simdir", ",", 
                    RowBox[{"\"\<Snapshot\>\"", "<>", "stepstring"}], ",", 
                    "\"\<png\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Export", "[", 
                    RowBox[{"$SNAPSHOTFILE", ",", "snapshot"}], "]"}], ";", 
                    " ", "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<Tissue snapshot written to \>\"", ",", " ", 
                    "$SNAPSHOTFILE"}], "]"}], ";"}], " ", 
                    "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{"show", ",", 
                    RowBox[{"Print", "[", "snapshot", "]"}]}], "]"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], " ", 
                 "\[IndentingNewLine]", "]"}], ";", " ", 
                "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"Print", "[", "\[IndentingNewLine]", 
                 RowBox[{"TableForm", "[", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<Actual Clock Time: \>\"", ",", " ", 
                    RowBox[{"now", "[", "]"}]}], "}"}], ",", " ", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Memory in Use (GB): \>\"", ",", " ", 
                    RowBox[{
                    RowBox[{"MemoryInUse", "[", "]"}], "/", "GB"}]}], "}"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Max Memory Used (GB): \>\"", ",", " ", 
                    RowBox[{
                    RowBox[{"MaxMemoryUsed", "[", "]"}], "/", "GB"}]}], "}"}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Free Memory (GB): \>\"", ",", " ", 
                    RowBox[{
                    RowBox[{"MemoryFree", "[", "]"}], "/", "GB"}]}], "}"}], 
                    ",", " ", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<CPU Used(seconds): \>\"", ",", " ", 
                    RowBox[{
                    RowBox[{"TimeUsed", "[", "]"}], "-", "cpu0"}]}], "}"}], 
                    ",", " ", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Number of Cells: \>\"", ",", " ", "n"}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Cell Divisions: \>\"", ",", " ", "ndivs"}], 
                    "}"}], ",", " ", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<Simulator Steps: \>\"", ",", " ", "stepcounter"}], 
                    "}"}], ",", " ", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<Number of Variables: \>\"", ",", " ", "nvars"}], 
                    "}"}]}], "}"}], "]"}], "]"}], ";"}]}], " ", 
              "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"tbegin", " ", "=", " ", "t2"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"tbegin", "\[GreaterEqual]", " ", "tend"}], ",", 
               RowBox[{"done", "=", "True"}]}], "]"}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"ndivs", "\[GreaterEqual]", " ", "maxdivs"}], ",", " ", 
               RowBox[{"done", "=", "True"}]}], "]"}], ";", " ", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"done", " ", "\[And]", " ", "xy", "\[And]", "show"}], 
               ",", " ", 
               RowBox[{"Print", "[", "snapshot", "]"}]}], "]"}], ";", " ", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"Not", "[", "Virtual", "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"MemoryInUse", "[", "]"}], ">", 
                  RowBox[{"MaxMemAllowed", "*", 
                   RowBox[{"MemoryInstalled", "[", "]"}]}]}], ",", 
                 RowBox[{
                  RowBox[{"Print", "[", 
                   RowBox[{"\"\<Usage exceeds \>\"", ",", " ", 
                    RowBox[{"Round", "[", 
                    RowBox[{"MaxMemAllowed", "*", "100.0"}], "]"}], ",", 
                    "  ", "\"\< percent of installed memory. Set flag \
\\\"Virtual\\\"\[Rule]True to allow use of virual memory (will run much more \
slowly) or the parameter \\\"MaxMemAllowed\\\" to a number between 0 and 1 to \
allow use of more memory. \>\""}], "]"}], ";", " ", "\[IndentingNewLine]", 
                  RowBox[{"done", "=", "True"}]}]}], "]"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"DTOLD", " ", "=", " ", "DT"}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"DT", " ", "=", " ", "TNext"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{"done", ",", " ", 
               RowBox[{"tstopped", "=", "t2"}]}], "]"}], ";", " ", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{"memtrace", " ", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{"TableForm", "[", 
                  RowBox[{"MemTable", "[", 
                   RowBox[{"\"\<Cellzilla2D`Private`\>\"", ",", "10000"}], 
                   "]"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"Print", "[", 
                 RowBox[{"TableForm", "[", 
                  RowBox[{"MemTable", "[", 
                   RowBox[{"\"\<xlr8r`Private`\>\"", ",", "10000"}], "]"}], 
                  "]"}], "]"}], ";"}]}], " ", "\[IndentingNewLine]", "]"}], 
             ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], 
          ";"}]}], " ", 
        RowBox[{"(*", " ", 
         RowBox[{"End", " ", "Block"}], " ", "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "]"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"End", " ", 
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{"Not", "[", "done", "]"}], "..."}], " "}]}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"MemPrint", "[", "\"\<End of Run.\>\"", "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<Simulation Completed at t = \>\"", ",", " ", "tstopped", ",", 
         "\"\< after \>\"", ",", " ", "ndivs", ",", 
         "\"\< cell divisions; Normal Exit. CPU: \>\"", ",", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"TimeUsed", "[", "]"}], "-", "cpu0"}], ")"}]}], "]"}], ";",
        "  ", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Not", "[", "internal", "]"}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Return", "[", "simdir", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"\"\<Solution\>\"", "/.", "S"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.5468918133920717`*^9, 3.5468918137640257`*^9}, {
   3.5474782054268084`*^9, 3.547478325439671*^9}, {3.547478388407353*^9, 
   3.547478421872637*^9}, {3.547478489864999*^9, 3.547478771438795*^9}, {
   3.547478811791192*^9, 3.547479443835162*^9}, {3.547488266488881*^9, 
   3.5474883433898573`*^9}, {3.547488425693735*^9, 3.5474884600252132`*^9}, {
   3.547488559137917*^9, 3.547488609929331*^9}, 3.547488680473864*^9, {
   3.5474889094213057`*^9, 3.547488922398758*^9}, {3.5474889619437647`*^9, 
   3.547489064433839*^9}, {3.547489557888897*^9, 3.547489567251897*^9}, {
   3.547489653123537*^9, 3.547489656420471*^9}, 3.5474896964514*^9, {
   3.547489762744494*^9, 3.547489854932873*^9}, {3.547491158398789*^9, 
   3.5474911677992773`*^9}, {3.547491588129745*^9, 3.547491589731449*^9}, 
   3.547491654258937*^9, {3.5474917046177187`*^9, 3.547491853563006*^9}, {
   3.547498962488152*^9, 3.547498989014205*^9}, {3.5475005539929657`*^9, 
   3.5475007632590714`*^9}, {3.547558158266466*^9, 3.5475581719276943`*^9}, {
   3.5475582048432837`*^9, 3.547558255462573*^9}, {3.547558837391717*^9, 
   3.547559009356341*^9}, {3.547559048425561*^9, 3.547559049210532*^9}, {
   3.5475590897858343`*^9, 3.547559097246861*^9}, {3.5475594068171186`*^9, 
   3.547559439370204*^9}, {3.547559506647456*^9, 3.547559548439108*^9}, {
   3.5475596189547863`*^9, 3.5475597623837147`*^9}, {3.5475598349492397`*^9, 
   3.547559878949551*^9}, {3.547559926278874*^9, 3.547560357495018*^9}, {
   3.547560412233921*^9, 3.547560553343495*^9}, {3.5475607486754847`*^9, 
   3.547560753988976*^9}, {3.5475608434587183`*^9, 3.547560845379471*^9}, {
   3.5475609883691673`*^9, 3.547561006126768*^9}, {3.547561927596428*^9, 
   3.547561950083453*^9}, {3.54756204733114*^9, 3.547562082578529*^9}, {
   3.54756229812753*^9, 3.547562359313655*^9}, {3.5475645241521463`*^9, 
   3.5475645695013514`*^9}, {3.54756500218371*^9, 3.547565083479082*^9}, {
   3.547565212432653*^9, 3.547565224605112*^9}, {3.547565344656753*^9, 
   3.5475653948156013`*^9}, {3.54756545210513*^9, 3.547565474459011*^9}, {
   3.547565768328178*^9, 3.5475658354036417`*^9}, {3.547565879248664*^9, 
   3.547565893062139*^9}, {3.5475659378007*^9, 3.547565954637011*^9}, {
   3.5475661210223083`*^9, 3.547566211837534*^9}, 3.5475662660727997`*^9, {
   3.547566303238367*^9, 3.547566360575845*^9}, {3.547566400867071*^9, 
   3.547566681640484*^9}, {3.547566750612206*^9, 3.547566783313273*^9}, {
   3.5475670329942636`*^9, 3.547567041563362*^9}, {3.547567090936475*^9, 
   3.5475670970788593`*^9}, {3.547567202033544*^9, 3.547567255055935*^9}, {
   3.547567425383896*^9, 3.547567425824706*^9}, {3.5475675236199093`*^9, 
   3.547567529968487*^9}, {3.547567584198078*^9, 3.547567588127639*^9}, {
   3.547567641180353*^9, 3.5475676500339613`*^9}, {3.547567707708733*^9, 
   3.5475677299415073`*^9}, {3.547568227836128*^9, 3.547568230890409*^9}, {
   3.54756850526659*^9, 3.5475685749315977`*^9}, {3.547568796690878*^9, 
   3.54756891703976*^9}, {3.547568995147421*^9, 3.5475690010617857`*^9}, {
   3.547569046054358*^9, 3.547569048982877*^9}, 3.547586408697289*^9, {
   3.5476454838941298`*^9, 3.547645503634445*^9}, {3.547647191558814*^9, 
   3.547647192070945*^9}, {3.547647227528759*^9, 3.547647285566053*^9}, {
   3.5476473592133217`*^9, 3.5476473802481613`*^9}, 3.547647416232024*^9, 
   3.5476475002642307`*^9, {3.547647537576236*^9, 3.547647696600532*^9}, {
   3.5476478672489853`*^9, 3.547647919193925*^9}, {3.547648200289239*^9, 
   3.547648203011545*^9}, {3.5476482977385073`*^9, 3.5476483036960573`*^9}, {
   3.547648341262611*^9, 3.5476483532199087`*^9}, {3.547664258612239*^9, 
   3.547664301063159*^9}, {3.547664471768674*^9, 3.5476644775681143`*^9}, 
   3.5476645879584923`*^9, 3.547667873699114*^9, {3.547727637349144*^9, 
   3.5477276383722878`*^9}, {3.547727703688113*^9, 3.547727704334169*^9}, {
   3.5477280012709637`*^9, 3.547728001818087*^9}, {3.547729105563569*^9, 
   3.547729116726516*^9}, {3.547729155966061*^9, 3.5477291675957947`*^9}, {
   3.547729207561863*^9, 3.5477292717672453`*^9}, {3.547738315697192*^9, 
   3.5477384727125187`*^9}, {3.547739400759794*^9, 3.54773944434194*^9}, {
   3.547739663959208*^9, 3.547739672248581*^9}, {3.5477399781040154`*^9, 
   3.5477399975540037`*^9}, {3.547745180251663*^9, 3.5477452080375423`*^9}, {
   3.5477452884459133`*^9, 3.547745293470996*^9}, {3.547745369660654*^9, 
   3.547745425390521*^9}, {3.5477455119420652`*^9, 3.5477455601106567`*^9}, {
   3.547746271097785*^9, 3.54774631140221*^9}, {3.547748520153263*^9, 
   3.547748600437088*^9}, {3.547748672380972*^9, 3.5477486992056017`*^9}, {
   3.547748826292057*^9, 3.547748842117433*^9}, {3.547748874154792*^9, 
   3.547748925072966*^9}, {3.547756859683964*^9, 3.547756880477165*^9}, {
   3.54793325296686*^9, 3.5479335673481207`*^9}, {3.547933786474379*^9, 
   3.547933793002816*^9}, {3.547933824443303*^9, 3.547933831726139*^9}, {
   3.547934944595121*^9, 3.5479350099681063`*^9}, {3.5479353623478193`*^9, 
   3.5479354373820257`*^9}, {3.547935495821884*^9, 3.547935499816141*^9}, {
   3.5479356901414757`*^9, 3.547935691174664*^9}, {3.547935775773868*^9, 
   3.5479357871883097`*^9}, {3.5479358285517693`*^9, 3.547935831547172*^9}, {
   3.547936260858137*^9, 3.547936270087308*^9}, {3.547936368907929*^9, 
   3.5479363768500834`*^9}, {3.547936462853868*^9, 3.547936471590534*^9}, {
   3.547936508019334*^9, 3.547936519762532*^9}, {3.5479379057783527`*^9, 
   3.547937909566691*^9}, {3.547937971441244*^9, 3.54793797166444*^9}, {
   3.5479381764512377`*^9, 3.5479381799935637`*^9}, {3.54793906748492*^9, 
   3.547939096682213*^9}, {3.547940180635722*^9, 3.5479401873206673`*^9}, {
   3.547942934158166*^9, 3.547942963333568*^9}, {3.547943916137775*^9, 
   3.547943917187344*^9}, {3.5479457543164167`*^9, 3.54794579720794*^9}, {
   3.5480044284364643`*^9, 3.548004435454362*^9}, {3.548004472885962*^9, 
   3.548004487515469*^9}, {3.5480045243765917`*^9, 3.548004530118021*^9}, {
   3.548004782242093*^9, 3.548004783853608*^9}, 3.548442264599318*^9, {
   3.5484427911994247`*^9, 3.548442806909842*^9}, {3.548442881548287*^9, 
   3.548442918880715*^9}, {3.548442974721498*^9, 3.5484429767238503`*^9}, {
   3.548443045554488*^9, 3.548443073332336*^9}, {3.548447043924802*^9, 
   3.5484470446409903`*^9}, {3.548448695473276*^9, 3.548448711281959*^9}, {
   3.548448759736184*^9, 3.5484488097957153`*^9}, {3.548516283708572*^9, 
   3.548516344397106*^9}, {3.5490304876042013`*^9, 3.5490304995918713`*^9}, {
   3.549030537801346*^9, 3.549030564351293*^9}, {3.549040254008532*^9, 
   3.549040298859089*^9}, {3.549202628033955*^9, 3.5492026571646233`*^9}, {
   3.549205109766746*^9, 3.549205623897085*^9}, {3.549470657843666*^9, 
   3.549470801214065*^9}, {3.5494708735149813`*^9, 3.549470884582593*^9}, {
   3.5494709853500957`*^9, 3.549470985813472*^9}, {3.549479600928321*^9, 
   3.54947962614931*^9}, {3.549483268994026*^9, 3.5494832834334383`*^9}, {
   3.5494846443895903`*^9, 3.549484644938939*^9}, 3.5495722367218523`*^9, {
   3.549575023203566*^9, 3.549575046797968*^9}, {3.54957536645794*^9, 
   3.549575367142477*^9}, {3.549575426259164*^9, 3.549575428381068*^9}, {
   3.549575947720872*^9, 3.549576026213472*^9}, {3.5497200209187803`*^9, 
   3.549720050284747*^9}, {3.549720083650193*^9, 3.549720238640209*^9}, {
   3.556664837770068*^9, 3.556664845072459*^9}, {3.556710060121076*^9, 
   3.5567100650288277`*^9}, {3.556710427900354*^9, 3.556710441759213*^9}, {
   3.556710517672847*^9, 3.556710540527588*^9}, {3.55671057615378*^9, 
   3.5567106420950212`*^9}, {3.556710866924065*^9, 3.556711043241494*^9}, {
   3.556711135492509*^9, 3.55671118823349*^9}, {3.556711228882409*^9, 
   3.556711381006454*^9}, {3.556711435365529*^9, 3.556711477029498*^9}, 
   3.556718722504183*^9, {3.556725295953369*^9, 3.556725309166354*^9}, {
   3.556796239193181*^9, 3.556796335138234*^9}, {3.556796368857751*^9, 
   3.556796538349743*^9}, {3.556796590447769*^9, 3.556796612030299*^9}, {
   3.5578660298099537`*^9, 3.557866107975498*^9}, {3.558021888357192*^9, 
   3.558021986899259*^9}, {3.558022019599391*^9, 3.558022047391262*^9}, {
   3.558095706056501*^9, 3.558095734406609*^9}, {3.558182099294342*^9, 
   3.558182197766108*^9}, {3.5581822305245037`*^9, 3.55818226402528*^9}, {
   3.55818233338138*^9, 3.558182334745616*^9}, {3.558548713821216*^9, 
   3.5585487275756063`*^9}, {3.5594915171659203`*^9, 
   3.5594915709059343`*^9}, {3.559491613590583*^9, 3.559491621867343*^9}, {
   3.559491666619587*^9, 3.5594916748769283`*^9}, {3.559494280390779*^9, 
   3.559494426386633*^9}, 3.559500381992866*^9, {3.55950045357712*^9, 
   3.5595004782950697`*^9}, 3.559592363873993*^9, {3.5595949952774973`*^9, 
   3.559595037759583*^9}, {3.559595143980118*^9, 3.559595166267049*^9}, 
   3.5595956035726423`*^9, {3.559595650120639*^9, 3.559595663170825*^9}, {
   3.560004727590776*^9, 3.560004733379469*^9}, {3.561501329123015*^9, 
   3.5615013454372473`*^9}, {3.5615014401468782`*^9, 3.56150145822447*^9}, {
   3.56150159799676*^9, 3.561501603075728*^9}, {3.561501658508954*^9, 
   3.561501658988639*^9}, {3.561501746358371*^9, 3.5615017627169123`*^9}, {
   3.5615017948748903`*^9, 3.561501796817647*^9}, {3.561501842156289*^9, 
   3.561501857532963*^9}, {3.561501919330212*^9, 3.5615019210126467`*^9}, {
   3.561501972894619*^9, 3.5615019850500507`*^9}, {3.561752434996039*^9, 
   3.561752452456573*^9}, {3.561752557253687*^9, 3.5617525742511187`*^9}, {
   3.566139892152115*^9, 3.566139894524226*^9}, {3.566139954792913*^9, 
   3.566140005530382*^9}, {3.570905363017952*^9, 3.570905397437364*^9}, {
   3.570905518706822*^9, 3.570905592507144*^9}, {3.571005679994814*^9, 
   3.571005680513356*^9}, {3.571005711088812*^9, 3.571005786292544*^9}, {
   3.571006139537446*^9, 3.571006141649322*^9}, {3.5710077799357357`*^9, 
   3.571007781354971*^9}, {3.571007859301207*^9, 3.571007860042226*^9}, {
   3.571007929397674*^9, 3.5710079308335876`*^9}, {3.571008379695022*^9, 
   3.5710083803526983`*^9}, {3.571059670987131*^9, 3.571059721541255*^9}, {
   3.57105978938631*^9, 3.57105979891014*^9}, {3.572135856382351*^9, 
   3.57213586386812*^9}, {3.5721359153966303`*^9, 3.572135920712668*^9}, {
   3.572135986974916*^9, 3.572136022989089*^9}, {3.572136677522472*^9, 
   3.572136700285166*^9}, {3.572223777331538*^9, 3.5722238692234*^9}, {
   3.5722273123395*^9, 3.572227314580628*^9}, {3.572227807525855*^9, 
   3.572227832270595*^9}, {3.572227884964547*^9, 3.572227901548579*^9}, {
   3.5723923595910053`*^9, 3.572392407609192*^9}, {3.57245892218978*^9, 
   3.572458944382312*^9}, {3.574030384582424*^9, 3.5740304243483753`*^9}, {
   3.574031735297028*^9, 3.574031787433383*^9}, {3.574032485291195*^9, 
   3.57403251954412*^9}, {3.574034775720388*^9, 3.5740347814467916`*^9}, {
   3.5743755865284967`*^9, 3.5743755924394407`*^9}, {3.5745971809346046`*^9, 
   3.574597200511579*^9}, {3.574707186717656*^9, 3.574707237393631*^9}, {
   3.574707490225012*^9, 3.574707502732233*^9}, {3.574707657268238*^9, 
   3.5747076598880453`*^9}, {3.574978367045197*^9, 3.574978374891852*^9}, {
   3.575233771222826*^9, 3.5752338482681303`*^9}, {3.5752360754085617`*^9, 
   3.5752361163775787`*^9}, {3.5753900138213043`*^9, 
   3.5753900143201237`*^9}, {3.5753927469879923`*^9, 
   3.5753927659689617`*^9}, {3.5753929119485273`*^9, 3.575392917867852*^9}, {
   3.575392952268317*^9, 3.575393084872736*^9}, {3.575394621010645*^9, 
   3.575394657901904*^9}, {3.5753949262825537`*^9, 3.575394932915872*^9}, {
   3.575395056924872*^9, 3.575395156931158*^9}, 3.5753952396367683`*^9, 
   3.5753964142213173`*^9, {3.575492455602079*^9, 3.5754924637673197`*^9}, {
   3.57549252092313*^9, 3.575492521643332*^9}, {3.575493907703117*^9, 
   3.5754939711719847`*^9}, {3.575494789212309*^9, 3.5754948021475077`*^9}, {
   3.575570283514188*^9, 3.575570287687364*^9}, {3.575570338967877*^9, 
   3.5755703423426456`*^9}, {3.575570373920348*^9, 3.575570380309147*^9}, {
   3.576007285498404*^9, 3.5760073349647493`*^9}, {3.576008429135511*^9, 
   3.576008452882085*^9}, {3.576008521594701*^9, 3.5760085274108057`*^9}, {
   3.576008592543836*^9, 3.576008597087975*^9}, {3.576008973270298*^9, 
   3.576008996607113*^9}, {3.576085183651843*^9, 3.5760851852108173`*^9}, {
   3.576085243694016*^9, 3.576085247460228*^9}, {3.576273599544653*^9, 
   3.576273643344706*^9}, {3.5766143154775057`*^9, 3.576614316037726*^9}, 
   3.576615426701672*^9, {3.576620012578306*^9, 3.576620014907929*^9}, {
   3.576620891665215*^9, 3.576620920715152*^9}, {3.5766210170840397`*^9, 
   3.576621022171262*^9}, {3.5766765668838263`*^9, 3.576676567503306*^9}, {
   3.5766766847336073`*^9, 3.576676760501553*^9}, {3.576677820197*^9, 
   3.5766778299498034`*^9}, {3.576678065606696*^9, 3.5766780914589252`*^9}, {
   3.576678293687491*^9, 3.5766783202395773`*^9}, {3.576678930109872*^9, 
   3.576679000729878*^9}, {3.576679881486466*^9, 3.576679908565625*^9}, {
   3.576795882541891*^9, 3.5767959184886713`*^9}, 3.5767960128459044`*^9, {
   3.57720959224185*^9, 3.5772096404271812`*^9}, {3.57731755963828*^9, 
   3.577317602404112*^9}, {3.5773178141101847`*^9, 3.577317814783482*^9}, {
   3.577541430512966*^9, 3.577541463660212*^9}, {3.577543579029624*^9, 
   3.5775435820174313`*^9}, {3.577655442776353*^9, 3.577655444263665*^9}, {
   3.577655529802689*^9, 3.577655531698537*^9}, {3.578346410037732*^9, 
   3.5783464237084503`*^9}, 3.578346986668598*^9, {3.5848290747601223`*^9, 
   3.584829096042453*^9}, {3.585940663177527*^9, 3.58594069101059*^9}, 
   3.706024232520052*^9},ExpressionUUID->"c7954815-f9d5-4d34-a238-\
c21449cd3dc9"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
grow[Options] (** continuation mode **)
This module is currently broken because the continuation IC does not have the \
correct call sequence\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 CellChangeTimes->{{3.549572243157154*^9, 3.5495722550672073`*^9}, {
  3.549575782478211*^9, 3.549575787357176*^9}, {3.571008657029755*^9, 
  3.571008678132434*^9}},ExpressionUUID->"a0c8d4ed-ccc7-49e7-a864-\
ceb98d819e0e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"grow", "[", 
     RowBox[{"opt___", "?", "OptionQ"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "GetTimeDomainFromFile", ",", " ", "d", ",", " ", "TFiles", ",", "nT", 
        ",", "SFiles", ",", " ", "dPrint", ",", " ", "dbg", ",", " ", "nS", 
        ",", "nN", ",", "  ", "n", ",", " ", "NFiles", ",", " ", "TSFile", 
        ",", " ", "tended", ",", " ", "tstart", ",", " ", "tend", ",", " ", 
        "oldopts", ",", " ", "options", ",", " ", "DT", ",", " ", "DTOLD", 
        ",", " ", "S", ",", " ", "Network", ",", " ", "ell", ",", " ", "area",
         ",", " ", "x", ",", " ", "y", ",", "restlength", ",", "IC", ",", " ",
         "thetimespan", ",", "sim", ",", " ", "lineage", ",", " ", 
        "edgelineage", ",", "cells", ",", " ", "edges", ",", "note"}], "}"}], 
      ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dbg", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<Debug\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<Debug\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";", 
       " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dPrint", "[", "u___", "]"}], ":=", " ", 
        RowBox[{"If", "[", 
         RowBox[{"dbg", ",", " ", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<grow (continuation):\>\"", ",", " ", "u"}], "]"}]}], 
         "]"}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"GetTimeDomainFromFile", "[", "f_", "]"}], ":=", " ", 
        RowBox[{"CommonTimeDomain", "[", 
         RowBox[{"Get", "[", "f", "]"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"tend", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<Tend\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<Tend\>\"", "\[Rule]", " ", "\[Infinity]"}], "}"}]}]}], 
       ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"d", "=", 
        RowBox[{"SystemDialogInput", "[", 
         RowBox[{"\"\<Directory\>\"", ",", " ", 
          RowBox[{"ToFileName", "[", 
           RowBox[{"HomeDirectory", "[", "]"}], "]"}], ",", " ", 
          RowBox[{
          "WindowTitle", "\[Rule]", " ", 
           "\"\<Please select the folder that contains the results of the \
previous part of the simulation, e.g., the DTissue*.nb, Solution*.nb, IC*.nb, \
TimeSpans.nb, Simulation-Options.nb):\>\""}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<d: \>\"", ",", " ", "d"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<Initializing continuation mode. Reading files from \>\"", " ", "<>",
          "d"}], "]"}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"TFiles", " ", "=", " ", 
        RowBox[{"FileNames", "[", 
         RowBox[{"ToFileName", "[", 
          RowBox[{"d", ",", "\"\<DTissue*.nb\>\""}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nT", "=", 
        RowBox[{"Length", "[", "TFiles", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"SFiles", "=", 
        RowBox[{"FileNames", "[", 
         RowBox[{"ToFileName", "[", 
          RowBox[{"d", ",", "\"\<Solution*.nb\>\""}], "]"}], "]"}]}], ";", 
       " ", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<SFiles:\>\"", ",", " ", 
         RowBox[{"Short", "[", 
          RowBox[{"SFiles", ",", "5"}], "]"}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"nS", "=", 
        RowBox[{"Length", "[", "SFiles", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"NFiles", " ", "=", " ", 
        RowBox[{"FileNames", "[", 
         RowBox[{"ToFileName", "[", 
          RowBox[{"d", ",", " ", "\"\<Network*.nb\>\""}], "]"}], "]"}]}], ";",
        " ", "\[IndentingNewLine]", 
       RowBox[{"nN", "=", 
        RowBox[{"Length", "[", "NFiles", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<nT,nS, nN:\>\"", ",", " ", 
         RowBox[{"{", 
          RowBox[{"nT", ",", " ", "nS", ",", " ", "nN"}], "}"}]}], "]"}], ";",
        " ", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"nT", "\[Equal]", "0"}], ",", " ", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<No Tissues found in \>\"", "<>", "d"}], "]"}], ";", 
          " ", 
          RowBox[{"Return", "[", 
           RowBox[{"{", "}"}], "]"}]}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"nS", "\[Equal]", "0"}], ",", " ", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<No Simulation results found in \>\"", "<>", "d"}], 
           "]"}], ";", " ", 
          RowBox[{"Return", "[", 
           RowBox[{"{", "}"}], "]"}]}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"nN", "\[Equal]", "0"}], ",", " ", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<No Network files found in \>\"", "<>", "d"}], "]"}], 
          ";", " ", 
          RowBox[{"Return", "[", 
           RowBox[{"{", "}"}], "]"}]}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"n", "=", 
        RowBox[{"Min", "[", 
         RowBox[{"{", 
          RowBox[{"nT", ",", "nS", ",", " ", "nN"}], "}"}], "]"}]}], ";", " ",
        "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{
        "\"\<n: \>\"", ",", " ", "n", ",", " ", "\"\< simulation sets.\>\""}],
         "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"TSFile", " ", "=", " ", 
        RowBox[{"FileNames", "[", 
         RowBox[{"ToFileName", "[", 
          RowBox[{"d", ",", "\"\<TimeSpans.nb\>\""}], "]"}], "]"}]}], ";", 
       " ", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "TSFile", "]"}], ">", "0"}], ",", " ", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"TSFile", "=", 
           RowBox[{"First", "[", "TSFile", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"thetimespan", " ", "=", " ", 
           RowBox[{"Last", "[", 
            RowBox[{"Get", "[", "TSFile", "]"}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"tended", " ", "=", " ", 
           RowBox[{"thetimespan", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ";"}], " ", 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
            RowBox[{"\"\<File \>\"", "<>", 
             RowBox[{"ToFileName", "[", 
              RowBox[{"d", ",", "\"\<TimeSpans.nb\>\""}], "]"}], "<>", 
             "\"\<Attempting to determine timespan manually from file set \
\>\""}], ",", " ", "n"}], "]"}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"thetimespan", "=", 
           RowBox[{"GetTimeDomainFromFile", "[", 
            RowBox[{"SFiles", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"tended", " ", "=", " ", 
           RowBox[{"thetimespan", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ";"}]}], " ", 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"tstart", " ", "=", " ", "tended"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<{start, tend}: \>\"", ",", " ", 
         RowBox[{"{", 
          RowBox[{"tstart", ",", " ", "tend"}], "}"}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"oldopts", " ", "=", " ", 
        RowBox[{"getOldSimFile", "[", 
         RowBox[{"d", ",", " ", "\"\<Simulation-Options.nb\>\""}], "]"}]}], 
       ";", " ", "\[IndentingNewLine]", 
       RowBox[{"oldopts", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", "oldopts", "}"}], "]"}]}], ";", "  ", 
       "\[IndentingNewLine]", 
       RowBox[{"options", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", "opt", "}"}], ",", " ", "oldopts"}], "]"}]}], ";", " ",
        "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<options:\>\"", ",", " ", "options"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Calculate", " ", "parameter", " ", "\"\<IC\>\"", " ", "from", " ", 
         "solution"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "<", "2"}], ",", " ", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<There must be at least two tissues to run in continuation \
mode.\>\"", "]"}], ";", " ", 
          RowBox[{"Return", "[", 
           RowBox[{"{", "}"}], "]"}]}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"DT", " ", "=", " ", 
        RowBox[{"ToExpression", "[", 
         RowBox[{"Get", "[", 
          RowBox[{"TFiles", "[", 
           RowBox[{"[", "n", "]"}], "]"}], "]"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<DT: \>\"", ",", " ", 
         RowBox[{"ShowTissue", "[", "DT", "]"}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"lineage", " ", "=", " ", 
        RowBox[{"getOldSimFile", "[", 
         RowBox[{"d", ",", " ", "\"\<Lineage.nb\>\""}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"lineage", " ", "\[Equal]", 
          RowBox[{"{", "}"}]}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"cells", " ", "=", " ", 
           RowBox[{"First", "/@", 
            RowBox[{"TissueCells", "[", "DT", "]"}]}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"lineage", " ", "=", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Rule", "[", 
               RowBox[{"0", ",", "#"}], "]"}], "&"}], "/@", "cells"}], 
            ")"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<lineage: \>\"", ",", " ", 
         RowBox[{"Short", "[", 
          RowBox[{"lineage", ",", "3"}], "]"}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"edgelineage", " ", "=", " ", 
        RowBox[{"getOldSimFile", "[", 
         RowBox[{"d", ",", " ", "\"\<EdgeLineage.nb\>\""}], "]"}]}], ";", " ",
        "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"edgelineage", "\[Equal]", 
          RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"edges", " ", "=", " ", 
           RowBox[{"Range", "[", 
            RowBox[{"NTissueEdges", "[", "DT", "]"}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"edgelineage", " ", "=", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Rule", "[", 
               RowBox[{"0", ",", "#"}], "]"}], "&"}], "/@", "edges"}], 
            ")"}]}], ";"}]}], " ", "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<edgelineage: \>\"", ",", " ", 
         RowBox[{"Short", "[", 
          RowBox[{"edgelineage", ",", " ", "3"}], "]"}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"DTOLD", "=", 
        RowBox[{"ToExpression", "[", 
         RowBox[{"Get", "[", 
          RowBox[{"TFiles", "[", 
           RowBox[{"[", 
            RowBox[{"n", "-", "1"}], "]"}], "]"}], "]"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<DTOLD: \>\"", ",", " ", 
         RowBox[{"ShowTissue", "[", "DTOLD", "]"}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"S", " ", "=", " ", 
        RowBox[{"Get", "[", 
         RowBox[{"SFiles", "[", 
          RowBox[{"[", "n", "]"}], "]"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<S: \>\"", ",", " ", 
         RowBox[{"Short", "[", 
          RowBox[{"S", ",", " ", "5"}], "]"}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"Network", " ", "=", 
        RowBox[{"Get", "[", 
         RowBox[{"NFiles", "[", 
          RowBox[{"[", "n", "]"}], "]"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<Network: \>\"", ",", " ", 
         RowBox[{"Short", "[", 
          RowBox[{"Network", ",", "5"}], "]"}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"ell", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<EdgeVariable\>\"", "/.", "oldopts"}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<EdgeVariable\>\"", "\[Rule]", " ", "Global`ell"}], 
          "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"area", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<CellVariable\>\"", "/.", "oldopts"}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<CellVariable\>\"", "\[Rule]", " ", "Global`cell"}], 
          "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"restlength", "=", 
        RowBox[{
         RowBox[{"\"\<Restlength\>\"", "/.", "oldopts"}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<Restlength\>\"", "\[Rule]", " ", "Global`resting"}], 
          "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"x", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<x\>\"", "/.", "oldopts"}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<x\>\"", "\[Rule]", " ", "Global`x"}], "}"}]}]}], ";", 
       " ", "\[IndentingNewLine]", 
       RowBox[{"y", "=", 
        RowBox[{
         RowBox[{"\"\<y\>\"", "/.", "oldopts"}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<y\>\"", "\[Rule]", " ", "Global`y"}], "}"}]}]}], ";", 
       " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"sim", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<TimeSpan\>\"", "\[Rule]", " ", "thetimespan"}], ",", 
          " ", 
          RowBox[{"\"\<Lineage\>\"", "\[Rule]", " ", "lineage"}], ",", " ", 
          RowBox[{"\"\<EdgeLineage\>\"", "\[Rule]", " ", "edgelineage"}], ",",
           " ", 
          RowBox[{"\"\<Solution\>\"", "\[Rule]", " ", "S"}]}], "}"}]}], ";", 
       " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"IC", "=", 
        RowBox[{"SetNextIC", "[", 
         RowBox[{
         "DT", ",", "DTOLD", ",", " ", "sim", ",", "Network", ",", "ell", ",",
           "area", ",", "restlength", ",", "x", ",", "y", ",", " ", 
          RowBox[{
           RowBox[{"\"\<ICDebug\>\"", "/.", "options"}], "/.", 
           RowBox[{"{", 
            RowBox[{"\"\<ICDebug\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"options", " ", "=", " ", 
        RowBox[{"Select", "[", 
         RowBox[{"options", ",", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"First", "[", "#", "]"}], "\[NotEqual]", " ", 
             "\"\<IC\>\""}], ")"}], "&"}]}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<IC: \>\"", ",", " ", 
         RowBox[{"Short", "[", 
          RowBox[{"IC", ",", "5"}], "]"}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", "\"\<Continuation mode successfully initialized.\>\"", 
        "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"note", " ", "=", " ", 
        RowBox[{"\"\<This is a continuation of \>\"", "<>", "d"}]}], ";", " ",
        "\[IndentingNewLine]", 
       RowBox[{"grow", "[", 
        RowBox[{"DT", ",", " ", "tstart", ",", " ", "tend", ",", 
         RowBox[{"\"\<StepCounter\>\"", "\[Rule]", " ", 
          RowBox[{"(", 
           RowBox[{"n", "+", "1"}], ")"}]}], ",", " ", 
         RowBox[{"\"\<IC\>\"", "\[Rule]", " ", "IC"}], ",", " ", 
         RowBox[{"\"\<Continuation\>\"", "\[Rule]", " ", "note"}], ",", " ", 
         RowBox[{"Sequence", "@@", "options"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"getOldSimFile", "[", 
   RowBox[{"dir_", ",", "filename_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"handle", ",", "result"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"handle", " ", "=", " ", 
      RowBox[{"FileNames", "[", 
       RowBox[{"ToFileName", "[", 
        RowBox[{"dir", ",", "filename"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "handle", "]"}], ">", "0"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"handle", "=", 
         RowBox[{"First", "[", "handle", "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"result", " ", "=", " ", 
         RowBox[{"Get", "[", "handle", "]"}]}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Waring: No previous file \>\"", "<>", "filename", "<>", 
          "\"\< was found.\>\""}], "]"}], ";"}]}], " ", "\[IndentingNewLine]",
       "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "result", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.5494833705617247`*^9, 3.5494834530840683`*^9}, {
   3.549483500730597*^9, 3.549483582323655*^9}, {3.5494836197180567`*^9, 
   3.5494836221703444`*^9}, {3.549483654682564*^9, 3.54948391846821*^9}, {
   3.549483974701388*^9, 3.549484003965478*^9}, {3.549484034577869*^9, 
   3.549484183726671*^9}, {3.549484244446334*^9, 3.549484364648225*^9}, {
   3.549484447978697*^9, 3.5494845822706537`*^9}, {3.5494846923843203`*^9, 
   3.549485001901482*^9}, 3.549572255067361*^9, {3.549572549612808*^9, 
   3.5495725935200357`*^9}, {3.5495726236921167`*^9, 3.549572697473439*^9}, {
   3.549572790021543*^9, 3.549572793092064*^9}, {3.549573039355166*^9, 
   3.549573041527376*^9}, {3.549573099046989*^9, 3.5495731100085707`*^9}, {
   3.549573164302307*^9, 3.549573168477613*^9}, {3.5495734761212177`*^9, 
   3.549573554770628*^9}, {3.549573587935718*^9, 3.549574149502748*^9}, {
   3.5495743130999403`*^9, 3.549574335720159*^9}, {3.549574415500352*^9, 
   3.549574436709298*^9}, {3.5495745060215282`*^9, 3.549574516258646*^9}, {
   3.54957460041693*^9, 3.549574620009959*^9}, {3.5495747165873747`*^9, 
   3.549574731210245*^9}, {3.5495747840262203`*^9, 3.549574938443891*^9}, {
   3.5495751158174067`*^9, 3.549575162950799*^9}, {3.549575682750964*^9, 
   3.549575701086664*^9}, {3.5495760425912952`*^9, 3.549576104809424*^9}, {
   3.549719898719214*^9, 3.549719925797277*^9}, {3.549719977484086*^9, 
   3.5497200020360603`*^9}, {3.558550225079373*^9, 3.558550226198599*^9}, {
   3.576614336938464*^9, 3.576614337540475*^9}, {3.576620024224677*^9, 
   3.576620026449534*^9}},ExpressionUUID->"b5967a69-a8ce-42c9-bbc1-\
da6f3673de36"]
}, Closed]],

Cell[CellGroupData[{

Cell["grow (error mode)", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 CellChangeTimes->{{3.549575804509366*^9, 
  3.549575817901359*^9}},ExpressionUUID->"20003b5d-0471-4ed4-89d1-\
f94e2407a97d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"grow", "[", "somethingElse___", "]"}], ":=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Print", "[", "\"\<Unexpected Input to grow.\>\"", "]"}], ";", 
     RowBox[{"Abort", "[", "]"}], ";"}], " ", ")"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 InitializationCell->True,
 CellChangeTimes->{{3.549483294517391*^9, 3.5494833180864897`*^9}, 
   3.5495758179014397`*^9},ExpressionUUID->"69e364e5-a51c-40d7-bc06-\
7cb01d955704"]
}, Closed]],

Cell[CellGroupData[{

Cell["SaveFile, MemTable, initializeSolutions", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 CellChangeTimes->{{3.549575829628488*^9, 
  3.5495758578922033`*^9}},ExpressionUUID->"ea38891a-3bec-4c87-b922-\
c6ae29138f4c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SaveFile", "[", 
    RowBox[{"filename_", ",", " ", "object_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"symbol", ",", "f"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"f", "=", "filename"}], ";", "\[IndentingNewLine]", 
      RowBox[{"symbol", "=", "object"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Save", "[", 
       RowBox[{"filename", ",", "symbol"}], "]"}]}]}], "]"}]}], 
  ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 InitializationCell->True,
 CellChangeTimes->{{3.54948328983152*^9, 3.549483316278289*^9}, 
   3.5495758578922853`*^9, {3.576621183523014*^9, 
   3.576621222315271*^9}},ExpressionUUID->"47934b6b-3c0f-40a6-be5b-\
37729f53afdf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MemTable", "[", 
   RowBox[{"context_", ",", "xmin_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"names", ",", " ", "sizes"}], "}"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"names", "=", 
      RowBox[{"Names", "[", 
       RowBox[{"context", "<>", "\"\<*\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sizes", "=", 
      RowBox[{"ByteCount", "/@", 
       RowBox[{"ToExpression", "/@", "names"}]}]}], ";", 
     RowBox[{
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"sizes", ",", "names"}], "}"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ">", "xmin"}], "&"}]}], "]"}], "//",
        "Sort"}], "//", "Reverse"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 InitializationCell->True,
 CellChangeTimes->{{3.547935262010756*^9, 3.5479353554026213`*^9}, {
   3.547935420365947*^9, 3.547935425353922*^9}, {3.547936525760672*^9, 
   3.547936531178628*^9}, 
   3.549575857892344*^9},ExpressionUUID->"ae7590a5-18ab-4eb5-bc30-\
41a582740378"],

Cell[BoxData[
 RowBox[{
  RowBox[{"initialize$olutions", "[", "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"$Tissues", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"$Solutions", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"$Networks", " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"$Lineage", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"$EdgeLineage", "=", 
      RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"$TimeSpans", "=", 
      RowBox[{"{", "}"}]}], ";"}]}], " ", "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 InitializationCell->True,
 CellChangeTimes->{{3.5475581808902807`*^9, 3.547558192121695*^9}, {
   3.547559683840414*^9, 3.54755968859594*^9}, {3.547559811042337*^9, 
   3.547559824953527*^9}, 
   3.5495758578924007`*^9},ExpressionUUID->"b39a34fc-ec78-43a2-8270-\
506401a1e5a9"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["identifyReasonForHalt", "Subsubsection",
 CellChangeTimes->{{3.5462102917165003`*^9, 
  3.546210299917491*^9}},ExpressionUUID->"622bf18d-8449-48e3-9992-\
060e0302b72c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"identifyReasonForHalt", "[", 
   RowBox[{
   "s_", ",", " ", "DT_", ",", "eventequations_", ",", "normalstop_", ",", 
    "   ", 
    RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "divisionthreshold", ",", " ", "divisionvariable", ",", "ss", ",", " ", 
      "tstop", ",", "vals", ",", "vars", ",", "readyToDivide", ",", " ", 
      "ctd", ",", " ", "IgnoreDivisionBeyondThisRadius", ",", " ", "dPrint", 
      ",", "ThreshVar", ",", 
      RowBox[{"dbg", "=", "False"}], ",", " ", "threshvars", ",", 
      "threshvals", ",", " ", "index", ",", " ", "varrules", ",", 
      "threshrules", ",", " ", "test"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"dPrint", "[", "x___", "]"}], ":=", " ", 
      RowBox[{"If", "[", 
       RowBox[{"dbg", ",", " ", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<identifyReasonForHalt: \>\"", ",", " ", "x"}], "]"}]}], 
       "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"index", "[", 
       RowBox[{"x_", "[", "i_", "]"}], "]"}], ":=", " ", "i"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"normalstop", " ", "=", 
        RowBox[{"Last", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", " ", 
           RowBox[{"xlr8r`timeSpan", "/.", 
            RowBox[{"{", "opt", "}"}]}], "}"}], "]"}], "]"}]}], ";"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<eventequations: \>\"", ",", " ", "eventequations"}], "]"}],
      ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"check", " ", "for", " ", "division"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"divisionthreshold", " ", "=", " ", 
      RowBox[{
       RowBox[{"\"\<DivisionThreshold\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<DivisionThreshold\>\"", "\[Rule]", " ", "\[Infinity]"}], 
        "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<divisionthreshold: \>\"", ",", " ", "divisionthreshold"}], 
      "]"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"divisionvariable", "=", 
      RowBox[{
       RowBox[{"\"\<DivisionVariable\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
        "\"\<DivisionVariable\>\"", "\[Rule]", " ", "\"\<Unknown\>\""}], 
        "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"IgnoreDivisionBeyondThisRadius", "=", 
      RowBox[{
       RowBox[{"\"\<IgnoreDivisionRadius\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
        "\"\<IgnoreDivisionRadius\>\"", "\[Rule]", " ", "\[Infinity]"}], 
        "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ThreshVar", "=", 
      RowBox[{
       RowBox[{"\"\<DivisionThresholdVariable\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
        "\"\<DivisionThresholdVariable\>\"", "\[Rule]", " ", 
         "\"\<Unknown\>\""}], "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"ctd", " ", "=", " ", 
      RowBox[{"CommonTimeDomain", "[", "s", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tstop", "=", 
      RowBox[{"Last", "[", "ctd", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vals", "=", " ", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", "s", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", 
           RowBox[{"First", "[", "#", "]"}], "]"}], "\[Equal]", 
          "divisionvariable"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"vars", " ", "=", " ", 
      RowBox[{"First", "/@", "vals"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vals", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", "tstop", "]"}], "&"}], "/@", 
       RowBox[{"Last", "/@", "vals"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"varrules", " ", "=", " ", 
      RowBox[{"MapThread", "[", 
       RowBox[{"Rule", ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"index", "/@", "vars"}], ",", " ", "vals"}], "}"}]}], 
       "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<vars: \>\"", ",", " ", "vars"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<vals: \>\"", ",", " ", "vals"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<varrules: \>\"", ",", " ", "varrules"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"threshvals", "=", " ", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", "s", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", 
           RowBox[{"First", "[", "#", "]"}], "]"}], "\[Equal]", "ThreshVar"}],
          "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"threshvars", " ", "=", " ", 
      RowBox[{"First", "/@", "threshvals"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"threshvals", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", "tstop", "]"}], "&"}], "/@", 
       RowBox[{"Last", "/@", "threshvals"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"threshrules", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{"Rule", ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"index", "/@", "threshvars"}], ",", " ", "threshvals"}], 
         "}"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<threshvars: \>\"", ",", " ", "threshvars"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<threshvals: \>\"", ",", " ", "threshvals"}], "]"}], ";", 
     " ", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<threshrules: \>\"", ",", " ", "threshrules"}], "]"}], ";", 
     " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"readyToDivide", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"divisionthreshold", "<", "Infinity"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"test", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Rule", "[", 
             RowBox[{
              RowBox[{"First", "[", "#1", "]"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", "#2"}], ",", " ", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", "#1"}]}], "}"}]}], 
             "]"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"threshrules", ",", " ", "varrules"}], "}"}]}], "]"}]}], 
        ";", " ", "\[IndentingNewLine]", 
        RowBox[{"dPrint", "[", 
         RowBox[{"\"\<test: \>\"", ",", " ", "test"}], "]"}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"test", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Rule", "[", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
             RowBox[{"GreaterEqual", "@@", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], "&"}], "/@", 
          "test"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "test", "]"}], ">", "0"}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"test", "=", 
            RowBox[{"Transpose", "[", 
             RowBox[{"test", "/.", 
              RowBox[{"{", 
               RowBox[{"Rule", "\[Rule]", " ", "List"}], "}"}]}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"dPrint", "[", 
            RowBox[{"\"\<test: \>\"", ",", " ", "test"}], "]"}], ";", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"readyToDivide", "=", 
            RowBox[{"Pick", "@@", "test"}]}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";"}]}], " ", "\[IndentingNewLine]", "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<readyToDivide (1): \>\"", ",", " ", "readyToDivide"}], 
      "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
       "IgnoreDivisionBeyondThisRadius", " ", "<", " ", "\[Infinity]"}], ",", 
       " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Block", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "Origin", ",", " ", "centroids", ",", " ", "radii", ",", " ", 
            "divisible", ",", "cellnumbers"}], "}"}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Origin", " ", "=", "  ", 
            RowBox[{"\"\<Origin\>\"", "/.", 
             RowBox[{"{", "opt", "}"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "Use", " ", "Centeroid", " ", "because", " ", "its", " ", 
              "faster"}], ",", " ", 
             RowBox[{
             "and", " ", "in", " ", "bizzare", " ", "cases", " ", "we", " ", 
              "could", " ", "get", " ", "Folding", " ", "which", " ", "gives",
               " ", "wrong", " ", "answer", " ", "with", " ", "Centroid"}]}], 
            " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"centroids", "=", 
            RowBox[{"Centeroid", "[", "DT", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"centroids", " ", "=", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#", "-", "Origin"}], ")"}], "&"}], "/@", 
             "centroids"}]}], ";", " ", "\[IndentingNewLine]", 
           RowBox[{"radii", " ", "=", " ", 
            RowBox[{"Norm", "/@", "centroids"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"dPrint", "[", 
            RowBox[{"\"\<radii: \>\"", ",", " ", "radii"}], "]"}], ";", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"divisible", " ", "=", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#", "<", "IgnoreDivisionBeyondThisRadius"}], ")"}], 
              "&"}], "/@", "radii"}]}], " ", ";", " ", "\[IndentingNewLine]", 
           
           RowBox[{"cellnumbers", " ", "=", " ", 
            RowBox[{"First", "/@", 
             RowBox[{"TissueCells", "[", "DT", "]"}]}]}], ";", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"divisible", "=", 
            RowBox[{"Pick", "[", 
             RowBox[{"cellnumbers", ",", "divisible"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"readyToDivide", "=", 
            RowBox[{"Select", "[", 
             RowBox[{"readyToDivide", ",", " ", 
              RowBox[{
               RowBox[{"MemberQ", "[", 
                RowBox[{"divisible", ",", "#"}], "]"}], "&"}]}], "]"}]}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"dPrint", "[", 
            RowBox[{
            "\"\<readyToDivide (2): \>\"", ",", " ", "readyToDivide"}], "]"}],
            ";"}]}], " ", "\[IndentingNewLine]", "]"}], ";"}]}], " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<Finished: \>\"", ",", " ", 
       RowBox[{"(", 
        RowBox[{"tstop", " ", "\[GreaterEqual]", " ", "normalstop"}], ")"}]}],
       "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<Divide\>\"", "\[Rule]", " ", "readyToDivide"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<TimeSpan\>\"", "\[Rule]", " ", "ctd"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<Finished\>\"", "\[Rule]", " ", 
         RowBox[{"(", 
          RowBox[{"tstop", " ", "\[GreaterEqual]", " ", "normalstop"}], 
          ")"}]}]}], "\[IndentingNewLine]", "}"}], "]"}], ";"}]}], " ", 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.546210303050354*^9, 3.546210361851153*^9}, {
   3.5462104559954243`*^9, 3.546210496903697*^9}, {3.546210630669989*^9, 
   3.546210840528717*^9}, {3.546210872200213*^9, 3.546210934577252*^9}, {
   3.54621098054838*^9, 3.5462111345171423`*^9}, {3.5466980017580853`*^9, 
   3.546698036290092*^9}, 3.5476717610431843`*^9, {3.558184215495125*^9, 
   3.558184225677065*^9}, {3.558184322047998*^9, 3.558184324421359*^9}, {
   3.558184366727355*^9, 3.558184668559161*^9}, {3.558185059565494*^9, 
   3.558185162360298*^9}, {3.558200794709894*^9, 3.5582007954827423`*^9}, {
   3.558386527859397*^9, 3.5583865571242332`*^9}, {3.559493333580905*^9, 
   3.559493346980665*^9}, {3.559500146610887*^9, 3.559500179543438*^9}, {
   3.55959330823545*^9, 3.559593328501761*^9}, {3.559593384578849*^9, 
   3.559593525103002*^9}, {3.559593560941142*^9, 3.559593576734336*^9}, {
   3.5595936430211678`*^9, 3.559593681986122*^9}, {3.5595937378822393`*^9, 
   3.559593766597027*^9}, {3.559593857694439*^9, 3.559593961543325*^9}, {
   3.559594021997527*^9, 3.559594030865696*^9}, {3.5595940701307983`*^9, 
   3.55959410174008*^9}, {3.559594143908334*^9, 3.559594170877696*^9}, {
   3.559594209088153*^9, 3.559594218438794*^9}, {3.559594270552621*^9, 
   3.559594370309244*^9}, {3.5595946330806837`*^9, 3.559594633576784*^9}, {
   3.5595963501834307`*^9, 3.559596365180436*^9}, {3.5747077410537987`*^9, 
   3.5747077417024*^9}, {3.574707776844181*^9, 3.574707785607627*^9}, {
   3.574707837086527*^9, 3.5747078792209873`*^9}, {3.5747079443794537`*^9, 
   3.574707960386112*^9}, {3.574708050075981*^9, 3.5747080505775347`*^9}, {
   3.5749803850710583`*^9, 3.5749803858468027`*^9}, {3.574980463289446*^9, 
   3.574980598433219*^9}, {3.574980630174646*^9, 
   3.574980630892926*^9}},ExpressionUUID->"6294ad29-95e6-4b69-823a-\
52ef02fb8b50"]
}, Closed]],

Cell[CellGroupData[{

Cell["setDevision ", "Subsubsection",
 CellChangeTimes->{{3.5462102488768597`*^9, 
  3.546210251149123*^9}},ExpressionUUID->"6fec917b-ba58-4a31-8f29-\
53e27c84568a"],

Cell["\<\
defines the flag used to determine when cell area has surpassed the threshold \
for cell division\
\>", "Text",
 CellChangeTimes->{{3.546210253652396*^9, 
  3.546210277492486*^9}},ExpressionUUID->"54aa2303-5ebc-417c-ab0c-\
64225fbbc8a0"],

Cell["\<\
SmallArea is a \[OpenCurlyDoubleQuote]fudge factor\[CloseCurlyDoubleQuote] \
for the Event locator which can only locate a negative to positive transition \
so the first time a mass hits Threshold + smallarea the system will stop\
\>", "Text",
 CellChangeTimes->{{3.546210165540464*^9, 
  3.546210202340251*^9}},ExpressionUUID->"8dcea196-0ab8-47c0-b793-\
2d7cc65241f7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"setDivision", "[", 
     RowBox[{"allvars_", ",", " ", "DT_", ",", " ", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "divisionthreshold", ",", "divisionvariable", ",", "vars", ",", "div", 
        ",", "smallarea", ",", " ", "IgnoreDivisionBeyondThisRadius", ",", 
        "centroids", ",", " ", "Origin", ",", " ", "radii", ",", " ", 
        "cellnumbers", ",", "divisible", ",", "dPrint", ",", " ", "sigma", 
        ",", "thresholds", ",", "  ", 
        RowBox[{"dbg", "=", "False"}], ",", " ", "dbgDivide", ",", " ", 
        "index", ",", "indices", ",", "heads", ",", " ", "ThreshVar", ",", 
        "threshequations", ",", "thresholdIC", ",", "test", ",", " ", 
        "setprecision", ",", " ", "areas", ",", " ", "oldICRules", ",", 
        "GetDivisionThreshold"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dbgDivide", "=", 
        RowBox[{
         RowBox[{"\"\<DivideDebug\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<DivideDebug\>\"", "\[Rule]", " ", "False"}], "}"}]}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dPrint", "[", "x___", "]"}], ":=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"dbg", " ", "\[Or]", " ", "dbgDivide"}], ",", " ", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<setDivision: \>\"", ",", " ", "x"}], "]"}]}], "]"}]}],
        ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"setprecision", "[", 
         RowBox[{"x_", ",", "y_"}], "]"}], ":=", " ", 
        RowBox[{"Round", "[", 
         RowBox[{"x", ",", 
          RowBox[{"10.", "^", 
           RowBox[{"Round", "[", 
            RowBox[{"Log", "[", 
             RowBox[{"10", ",", 
              RowBox[{"y", "*", "x"}]}], "]"}], "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"index", "[", 
         RowBox[{"x_", "[", "i_", "]"}], "]"}], ":=", " ", "i"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"divisionthreshold", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<DivisionThreshold\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{
          "\"\<DivisionThreshold\>\"", "\[Rule]", " ", "\[Infinity]"}], 
          "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{
        "\"\<divisionthreshold: \>\"", ",", " ", "divisionthreshold"}], "]"}],
        ";", " ", "\[IndentingNewLine]", 
       RowBox[{"smallarea", "=", 
        RowBox[{
         RowBox[{"\"\<SmallArea\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<SmallArea\>\"", "\[Rule]", " ", 
           RowBox[{"divisionthreshold", "/", "100"}]}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sigma", "=", 
        RowBox[{"\"\<DivisionSigma\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<sigma=\>\"", ",", " ", "sigma"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"divisionvariable", "=", 
        RowBox[{
         RowBox[{"\"\<DivisionVariable\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{
          "\"\<DivisionVariable\>\"", "\[Rule]", " ", "\"\<Unknown\>\""}], 
          "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ThreshVar", "=", 
        RowBox[{
         RowBox[{"\"\<DivisionThresholdVariable\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{
          "\"\<DivisionThresholdVariable\>\"", "\[Rule]", " ", 
           "\"\<Unknown\>\""}], "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{
        "\"\<divisionvariable: \>\"", ",", " ", "divisionvariable", ",", " ", 
         "\"\< threshold variable: \>\"", ",", " ", "ThreshVar"}], "]"}], ";",
        " ", "\[IndentingNewLine]", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"divisionthreshold", "\[Equal]", "Infinity"}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "dPrint", "[", "\"\<division is inhibited: infinite threshold\>\"", 
           "]"}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", " ", 
             RowBox[{"{", "}"}], ",", " ", 
             RowBox[{"{", "}"}]}], "}"}], "]"}]}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{
        "\"\<$DivisionThresholds: \>\"", ",", " ", "$DivisionThresholds"}], 
        "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"vars", " ", "=", " ", 
        RowBox[{"Select", "[", 
         RowBox[{"allvars", ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", "#", "]"}], "\[Equal]", "divisionvariable"}],
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"IgnoreDivisionBeyondThisRadius", "=", 
        RowBox[{
         RowBox[{"\"\<IgnoreDivisionRadius\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{
          "\"\<IgnoreDivisionRadius\>\"", "\[Rule]", " ", "\[Infinity]"}], 
          "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"IgnoreDivisionBeyondThisRadius", "<", "\[Infinity]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Origin", " ", "=", "  ", 
           RowBox[{"\"\<Origin\>\"", "/.", 
            RowBox[{"{", "opt", "}"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "Use", " ", "Centeroid", " ", "instead", " ", "of", " ", 
            "Centroid", " ", "because", " ", "funny", " ", "tings", " ", 
            "can", " ", "happen", " ", "on", " ", "the", " ", "outer", " ", 
            "edge"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"centroids", "=", 
           RowBox[{"Centeroid", "[", "DT", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"centroids", " ", "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#", "-", "Origin"}], ")"}], "&"}], "/@", 
            "centroids"}]}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"radii", " ", "=", " ", 
           RowBox[{"Norm", "/@", "centroids"}]}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"divisible", " ", "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#", "<", "IgnoreDivisionBeyondThisRadius"}], ")"}], 
             "&"}], "/@", "radii"}]}], " ", ";", " ", "\[IndentingNewLine]", 
          RowBox[{"cellnumbers", " ", "=", " ", 
           RowBox[{"First", "/@", 
            RowBox[{"TissueCells", "[", "DT", "]"}]}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"divisible", "=", 
           RowBox[{"Pick", "[", 
            RowBox[{"cellnumbers", ",", "divisible"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "select", " ", "rather", " ", "than", " ", "just", " ", "pick", 
            " ", "because", " ", "vars", " ", "might", " ", "not", " ", "be", 
            " ", "in", " ", "order"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"why", " ", 
            RowBox[{"can", "'"}], "t", " ", "just", " ", "do", " ", 
            RowBox[{"divisionvariable", "/@", 
             RowBox[{"visible", " ", "?"}]}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"vars", " ", "=", " ", 
           RowBox[{"Select", "[", 
            RowBox[{"vars", ",", " ", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{"divisible", ",", " ", 
                RowBox[{"Last", "[", "#", "]"}]}], "]"}], "&"}]}], "]"}]}], 
          " ", ";", "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<vars: \>\"", ",", " ", "vars"}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<vars: \>\"", ",", " ", "vars"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"heads", " ", "=", " ", 
        RowBox[{"Head", "/@", "vars"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"indices", " ", "=", " ", 
        RowBox[{"index", "/@", "vars"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<heads: \>\"", ",", " ", "heads"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<indices: \>\"", ",", " ", "indices"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"thresholds", " ", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"RandomVariate", "[", 
           RowBox[{"NormalDistribution", "[", 
            RowBox[{"divisionthreshold", ",", " ", "sigma"}], "]"}], "]"}], 
          ",", " ", 
          RowBox[{"{", 
           RowBox[{"Length", "[", "vars", "]"}], "}"}]}], "]"}]}], ";", 
       RowBox[{"thresholds", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"setprecision", "[", 
           RowBox[{"#", ",", ".001"}], "]"}], "&"}], "/@", "thresholds"}]}], 
       ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Make", " ", "sure", " ", "new", " ", "thresholds", " ", "exceed", 
         " ", "current", " ", "areas"}], " ", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<thresholds (before cap): \>\"", ",", " ", "thresholds"}],
         "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"thresholds", " ", "=", " ", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"1.001", "*", 
              RowBox[{"areafunction", "[", 
               RowBox[{"DT", ",", "#1"}], "]"}]}], ",", "#2"}], "]"}], "&"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"indices", ",", " ", "thresholds"}], "}"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<thresholds (after cap): \>\"", ",", " ", "thresholds"}], 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"GetDivisionThreshold", "[", 
         RowBox[{"i_", ",", "v_"}], "]"}], ":=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"ThreshVar", "[", "i", "]"}], "/.", "$DivisionThresholds"}],
          "/.", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ThreshVar", "[", "i", "]"}], "\[Rule]", " ", "v"}], 
          ")"}]}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"threshequations", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"ThreshVar", "[", "#1", "]"}], "[", "Global`t", "]"}], 
             "\[Equal]", 
             RowBox[{"GetDivisionThreshold", "[", 
              RowBox[{"#1", ",", "#2"}], "]"}]}], ")"}], "&"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"indices", ",", " ", "thresholds"}], "}"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<threshequations: \>\"", ",", " ", "threshequations"}], 
        "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"thresholdIC", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Rule", "[", 
            RowBox[{
             RowBox[{"ThreshVar", "[", "#1", "]"}], ",", 
             RowBox[{"GetDivisionThreshold", "[", 
              RowBox[{"#1", ",", "#2"}], "]"}]}], "]"}], "&"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"indices", ",", "thresholds"}], "}"}]}], "]"}]}], ";", " ",
        "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<theIC: \>\"", ",", " ", "thresholdIC"}], "]"}], ";", " ",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"save", " ", "for", " ", "next", " ", "time"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"$DivisionThresholds", "=", "thresholdIC"}], ";", "  ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"div", "=", 
        RowBox[{"\[CapitalPsi]", "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"divisionvariable", "[", "#", "]"}], "[", "Global`t", 
               "]"}], "-", 
              RowBox[{
               RowBox[{"ThreshVar", "[", "#", "]"}], "[", "Global`t", "]"}]}],
              ")"}], "&"}], "/@", "indices"}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"div", " ", "=", " ", 
        RowBox[{
         RowBox[{"-", "smallarea"}], "+", 
         RowBox[{"Plus", "@@", 
          RowBox[{"Abs", "/@", "div"}]}]}]}], ";", " ", "\[IndentingNewLine]",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", "Ident", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Ident", "[", "x_", "]"}], "[", "t_", "]"}], ":=", " ", 
           "divisionthreshold"}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<test/.stuf \>\"", ",", " ", 
            RowBox[{"test", "/.", 
             RowBox[{"(", 
              RowBox[{"ThreshVar", "\[Rule]", " ", "Ident"}], ")"}]}]}], 
           "]"}], ";"}]}], " ", "\[IndentingNewLine]", "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"div", " ", "=", 
          RowBox[{
           RowBox[{"-", "smallarea"}], "+", " ", 
           RowBox[{"Plus", "@@", 
            RowBox[{"Abs", "/@", 
             RowBox[{"(", 
              RowBox[{"\[CapitalPsi]", "/@", 
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", "Global`t", "]"}], "-", 
                   "divisionthreshold"}], "&"}], "/@", "vars"}], ")"}]}], 
              ")"}]}]}]}]}], ";"}], " ", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<div: \>\"", ",", " ", "div"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"div", "=", "test"}], ";"}], "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"div", ",", "threshequations", ",", " ", "thresholdIC"}], 
         "}"}], "]"}], ";"}]}], " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "]"}]}], ";"}], " "}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.546207613462906*^9, 3.5462077782706947`*^9}, {
   3.546207836733078*^9, 3.5462078440205727`*^9}, {3.546208399511979*^9, 
   3.5462084548089323`*^9}, {3.546208487879052*^9, 3.5462084988057632`*^9}, {
   3.546208553024611*^9, 3.546208599849382*^9}, {3.546209090242997*^9, 
   3.5462090956704473`*^9}, {3.546209131954747*^9, 3.546209133691709*^9}, {
   3.546209371020402*^9, 3.546209403421872*^9}, {3.546209510825617*^9, 
   3.5462095348837147`*^9}, {3.5462095751729383`*^9, 3.546209633100079*^9}, {
   3.546209675705638*^9, 3.546209678799514*^9}, {3.546209753948113*^9, 
   3.546209775328824*^9}, {3.5462099728466587`*^9, 3.546209974529839*^9}, {
   3.546210046599285*^9, 3.546210095394212*^9}, {3.546210144903034*^9, 
   3.546210159156999*^9}, {3.546210216989293*^9, 3.546210218103465*^9}, {
   3.547671140270089*^9, 3.547671179700016*^9}, {3.558182384303707*^9, 
   3.558182407574538*^9}, {3.558182895061267*^9, 3.5581829080288877`*^9}, {
   3.5581829859052057`*^9, 3.5581829984201717`*^9}, {3.55818308783217*^9, 
   3.55818314936876*^9}, {3.558183209290201*^9, 3.5581832412762547`*^9}, {
   3.558183272432811*^9, 3.558183470069953*^9}, {3.5581835912329206`*^9, 
   3.5581836721522284`*^9}, {3.558183746152904*^9, 3.558183757591514*^9}, {
   3.558183803946231*^9, 3.5581838276891108`*^9}, {3.558183909395564*^9, 
   3.558183989036557*^9}, 3.558184022588896*^9, {3.558205715025638*^9, 
   3.558205738592001*^9}, {3.558386585879074*^9, 3.558386608409333*^9}, {
   3.5594930128132887`*^9, 3.559493026359318*^9}, {3.559493356990651*^9, 
   3.559493379646228*^9}, {3.559493422212716*^9, 3.559493423541513*^9}, {
   3.559493462738421*^9, 3.559493651354734*^9}, {3.559493728156434*^9, 
   3.559493732268024*^9}, {3.559493813749793*^9, 3.559493864987585*^9}, {
   3.559493906473572*^9, 3.559493926282558*^9}, {3.559494115473989*^9, 
   3.559494121446144*^9}, {3.559494467383606*^9, 3.559494532975872*^9}, {
   3.559494598213311*^9, 3.559494797216609*^9}, {3.559494840937441*^9, 
   3.559494980886715*^9}, {3.559495078219301*^9, 3.55949508076082*^9}, {
   3.559495174558632*^9, 3.559495208251635*^9}, {3.559495292929524*^9, 
   3.559495402560512*^9}, {3.559499952862937*^9, 3.559500005934785*^9}, {
   3.559592516058663*^9, 3.559592619472084*^9}, {3.559592821264091*^9, 
   3.5595928565469217`*^9}, {3.559592894499056*^9, 3.5595928947271442`*^9}, {
   3.559592954394909*^9, 3.559592974583418*^9}, {3.559593036448913*^9, 
   3.559593038210711*^9}, {3.5595946477598763`*^9, 3.5595946483144283`*^9}, {
   3.559662959824892*^9, 3.5596630264554987`*^9}, {3.559663089229951*^9, 
   3.559663123927143*^9}, {3.559664500382543*^9, 3.5596646382745943`*^9}, {
   3.559664690738162*^9, 3.559664702735076*^9}, 3.559664938625249*^9, {
   3.560004369100287*^9, 3.560004370779224*^9}, {3.560004425575841*^9, 
   3.5600045499230757`*^9}, {3.5600048292144737`*^9, 
   3.5600048597233458`*^9}, {3.560004899109941*^9, 3.560004915708275*^9}, {
   3.5600050901156187`*^9, 3.560005173170974*^9}, {3.560005244205963*^9, 
   3.560005471349106*^9}, {3.560005529788477*^9, 3.560005538164975*^9}, {
   3.560005581960257*^9, 3.560005582504603*^9}, {3.561501161779715*^9, 
   3.5615011626204157`*^9}, {3.574979051972104*^9, 3.574979052453155*^9}, {
   3.574979119200083*^9, 3.574979181776314*^9}, {3.57497930384297*^9, 
   3.574979306765119*^9}, {3.5749793950487957`*^9, 3.574979491390023*^9}, {
   3.5749795306087933`*^9, 3.574979542257967*^9}, {3.574979664802964*^9, 
   3.574979690292287*^9}, {3.574979725951791*^9, 3.574979730352776*^9}, {
   3.57497981314686*^9, 3.5749798141021023`*^9}, {3.574980215080703*^9, 
   3.574980217560473*^9}, {3.5749808222313633`*^9, 3.5749808231909237`*^9}, {
   3.705712984131041*^9, 
   3.705712985614258*^9}},ExpressionUUID->"5044b99e-6bb1-4ba5-9704-\
62cf70f23f20"]
}, Closed]],

Cell[CellGroupData[{

Cell["performAllNecessaryCellDivisions", "Subsubsection",
 CellChangeTimes->{{3.5468825674245043`*^9, 
  3.5468825828796377`*^9}},ExpressionUUID->"7b2151b7-a509-4d57-9a22-\
429a78973ed4"],

Cell["\<\
return value:
\[OpenCurlyDoubleQuote]Tissue\[CloseCurlyDoubleQuote]-> DTissue[...] with new \
cell division pattern based on sim
\[OpenCurlyDoubleQuote]Lineage\[CloseCurlyDoubleQuote]->modified lineage tree \
(compatible with Treeplot[lineage, \[OpenCurlyDoubleQuote]VertexLabeling\
\[CloseCurlyDoubleQuote]->True] for a plot)
\[OpenCurlyDoubleQuote]EdgeLIneage\[CloseCurlyDoubleQuote]->modified edge \
lineage tree (also compatible with TreePlot\
\>", "Text",
 CellChangeTimes->{{3.54723291256168*^9, 3.547232961328403*^9}, {
  3.547233468098566*^9, 3.547233485185492*^9}, {3.547475746529079*^9, 
  3.547475762189369*^9}},ExpressionUUID->"e920af58-2956-4816-a4e0-\
9fd626e73244"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"performAllNecessaryCellDivisions", "[", 
    RowBox[{"sim_", ",", " ", "DTSTART_", ",", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "TFinal", ",", " ", "cells", ",", "cell", ",", "celldivstuff", ",", 
       "DT", ",", "c", ",", "cellnumbers", ",", "dbg", ",", " ", "dPrint", 
       ",", "done", ",", " ", "tstart", ",", "tend", ",", "s", ",", "angles", 
       ",", "p1", ",", "p2", ",", "T1", ",", "T2", ",", "nmax", ",", 
       "toDynamicNumberRules", ",", "toStaticNumberRules", ",", " ", 
       "staticcell", ",", " ", "newlineage", ",", "edgechanges", ",", 
       "newedgelineage", ",", "MinAngleSpread", ",", "x", ",", "y", ",", " ", 
       "lineage", ",", " ", "edgelineage", ",", "weights", ",", " ", 
       "divisionmodel", ",", "method", ",", " ", "L1Anticlinal", ",", 
       "L2Anticlinal", ",", " ", "L2AnticlinalRatio", ",", "upwards"}], "}"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dbg", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<DivideDebug\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<DivideDebug\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"upwards", "=", 
       RowBox[{
        RowBox[{"\"\<Upwards\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Upwards\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";",
       " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"divisionmodel", "=", 
       RowBox[{
        RowBox[{"\"\<DivisionModel\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
         "\"\<DivisionModel\>\"", "\[Rule]", " ", "\"\<Potential\>\""}], 
         "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"L1Anticlinal", " ", "=", " ", 
       RowBox[{"\"\<L1Anticlinal\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"L2Anticlinal", " ", "=", " ", 
       RowBox[{"\"\<L2Anticlinal\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"L2AnticlinalRatio", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<L2AnticlinalRatio\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<L2AnticlinalRatio\>\"", "\[Rule]", " ", 
          RowBox[{"1.0", "*", "GoldenRatio"}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<performAllNecessaryCellDivisions: opt: \>\"", ",", " ", 
          RowBox[{"{", "opt", "}"}]}], "]"}], ";"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{
       "\"\<performAllNecessaryCellDivisions: L1Anticlinal: \>\"", ",", " ", 
        "L1Anticlinal"}], "]"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{
       "\"\<performAllNecessaryCellDivisions: L2Anticlinal: \>\"", ",", " ", 
        "L2Anticlinal"}], "]"}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Switch", "[", 
       RowBox[{
       "divisionmodel", ",", "\[IndentingNewLine]", "\"\<Potential\>\"", ",", 
        
        RowBox[{"method", "=", "1"}], ",", "\[IndentingNewLine]", 
        "\"\<Errera\>\"", ",", " ", 
        RowBox[{"method", "=", "2"}], ",", "\[IndentingNewLine]", "_", ",", 
        " ", 
        RowBox[{"AbortIf", "[", 
         RowBox[{"True", ",", " ", 
          RowBox[{"\"\<Invalid division model = '\>\"", "<>", 
           RowBox[{"ToString", "[", "divisionmodel", "]"}], "<>", 
           "\"\<' Expecting \\\"Potential\\\" or \\\"Errera\\\".\>\""}]}], 
         "]"}]}], "\[IndentingNewLine]", "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dPrint", "[", "u___", "]"}], ":=", " ", 
       RowBox[{"If", "[", 
        RowBox[{"dbg", ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<performAllNecessaryCellDivisions: \>\"", ",", " ", "u"}], 
          "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"s", "=", 
       RowBox[{"\"\<Solution\>\"", "/.", "sim"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"done", " ", "=", " ", 
       RowBox[{"\"\<Finished\>\"", "/.", "sim"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<done: \>\"", ",", " ", "done"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"x", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<x\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<x\>\"", "\[Rule]", " ", "Global`x"}], "}"}]}]}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{"y", "=", 
       RowBox[{
        RowBox[{"\"\<y\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<y\>\"", "\[Rule]", " ", "Global`y"}], "}"}]}]}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{"lineage", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<Lineage\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Lineage\>\"", "\[Rule]", " ", 
          RowBox[{"{", "}"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"edgelineage", "=", 
       RowBox[{
        RowBox[{"\"\<EdgeLineage\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<EdgeLineage\>\"", "\[Rule]", " ", 
          RowBox[{"{", "}"}]}], "}"}]}]}], ";", "  ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<lineage: \>\"", ",", " ", "lineage"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<edgelineage: \>\"", ",", " ", "edgelineage"}], "]"}], ";",
       " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"weights", "=", 
       RowBox[{
        RowBox[{"\"\<Weights\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Weights\>\"", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"MinAngleSpread", "=", 
       RowBox[{
        RowBox[{"\"\<MinAngleSpread\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<MinAngleSpread\>\"", "\[Rule]", " ", "135.0"}], 
         "}"}]}]}], ";", "   ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tstart", ",", "tend"}], "}"}], "=", 
       RowBox[{"\"\<TimeSpan\>\"", "/.", "sim"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"TissueCells", "[", "DTSTART", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"cellnumbers", "=", 
       RowBox[{"First", "/@", "c"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<cellnumbers: \>\"", ",", " ", "cellnumbers"}], "]"}], ";",
       " ", "\[IndentingNewLine]", 
      RowBox[{"toDynamicNumberRules", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Rule", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", "c", "]"}], "]"}], ",", "cellnumbers"}], 
          "}"}]}], "]"}]}], ";", 
      RowBox[{"toStaticNumberRules", "=", 
       RowBox[{"Reverse", "/@", "toDynamicNumberRules"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{
       "\"\<toStaticNumberRules: \>\"", ",", " ", "toStaticNumberRules"}], 
       "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"TFinal", " ", "=", " ", 
       RowBox[{"DTissue2Tissue", "[", 
        RowBox[{"DTSTART", ",", " ", "s", ",", "tend"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"done", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"dPrint", "[", 
          RowBox[{
          "\"\<performAllNecessaryCellDivisions called with Finished = True; \
div = \>\"", ",", 
           RowBox[{"\"\<Divide\>\"", "/.", "sim"}]}], "]"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"dPrint", "[", 
          RowBox[{
          "\"\<Simulation completed normally at t = \>\"", ",", " ", "tend"}],
           "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"dPrint", "[", "TFinal", "]"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"dPrint", "[", 
          RowBox[{"Tissue2DTissue", "[", 
           RowBox[{"TFinal", ",", 
            RowBox[{"\"\<Numbers\>\"", "\[Rule]", " ", "cellnumbers"}]}], 
           "]"}], "]"}], ";", " ", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\"\<Tissue\>\"", "\[Rule]", " ", 
             RowBox[{"Tissue2DTissue", "[", 
              RowBox[{"TFinal", ",", 
               RowBox[{"\"\<Numbers\>\"", "\[Rule]", " ", "cellnumbers"}]}], 
              "]"}]}], ",", " ", 
            RowBox[{"\"\<Lineage\>\"", "\[Rule]", " ", "lineage"}], ",", " ", 
            
            RowBox[{"\"\<EdgeLineage\>\"", "\[Rule]", " ", "edgelineage"}]}], 
           "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<TFinal: \>\"", ",", " ", "TFinal"}], "]"}], ";", "  ", 
      "\[IndentingNewLine]", 
      RowBox[{"cells", "=", 
       RowBox[{"\"\<Divide\>\"", "/.", "sim"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"DT", "=", 
       RowBox[{"Tissue2DTissue", "[", 
        RowBox[{"TFinal", ",", 
         RowBox[{"\"\<Numbers\>\"", "\[Rule]", " ", "cellnumbers"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"$Tissue", "=", "DT"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<DT = \>\"", ",", " ", "DT"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"celldivstuff", "=", 
       RowBox[{"DetermineCellDivisionPoints", "[", 
        RowBox[{
        "sim", ",", "DT", ",", "L1Anticlinal", ",", "L2Anticlinal", ",", " ", 
         "L2AnticlinalRatio", ",", " ", "upwards", ",", " ", "weights", ",", 
         "x", ",", "y", ",", "method", ",", " ", "MinAngleSpread"}], " ", 
        "]"}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"T1", "=", "TFinal"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"nmax", " ", "=", " ", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"Max", "[", "cellnumbers", "]"}], ",", 
         RowBox[{"Length", "[", "cellnumbers", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newlineage", " ", "=", " ", "lineage"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<lineage=\>\"", ",", " ", "lineage"}], "]"}], ";", "  ", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<edgelineage=\>\"", ",", " ", "edgelineage"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newedgelineage", "=", "edgelineage"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "cells", "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"angles", ",", "p1", ",", "p2"}], "}"}], "=", 
          RowBox[{"First", "[", "celldivstuff", "]"}]}], ";", " ", 
         RowBox[{"celldivstuff", "=", 
          RowBox[{"Rest", "[", "celldivstuff", "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"cell", "=", 
          RowBox[{"First", "[", "cells", "]"}]}], ";", " ", 
         RowBox[{"cells", "=", 
          RowBox[{"Rest", "[", "cells", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"staticcell", " ", "=", " ", 
          RowBox[{"cell", "/.", "toStaticNumberRules"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"dPrint", "[", 
          RowBox[{
          "\"\<cell = \>\"", ",", " ", "cell", ",", " ", 
           "\"\< staticcell = \>\"", ",", " ", "staticcell", ",", " ", 
           "\"\< points = \>\"", ",", " ", "p1", ",", " ", "\"\< and \>\"", 
           ",", " ", "p2"}], "]"}], ";", " ", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Cell \>\"", ",", " ", "cell", ",", " ", 
           "\"\< (static cell \>\"", ",", " ", "staticcell", ",", 
           "\"\<) divides at t = \>\"", ",", "tend"}], "]"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"edgechanges", ",", "T1"}], "}"}], "=", " ", 
          RowBox[{"DivideCell", "[", 
           RowBox[{"T1", ",", "staticcell", ",", 
            RowBox[{"{", 
             RowBox[{"p1", ",", "p2"}], "}"}], ",", " ", 
            RowBox[{"\"\<Changes\>\"", "\[Rule]", " ", "True"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"edgechanges", "\[Equal]", "$Failed"}], ",", " ", 
           RowBox[{"Abort", "[", "]"}]}], "]"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"edgechanges", " ", "=", " ", 
          RowBox[{"edgechanges", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "}"}], "\[Rule]", " ", "0"}], "}"}]}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"newedgelineage", " ", "=", " ", 
          RowBox[{"Join", "[", 
           RowBox[{"newedgelineage", ",", " ", 
            RowBox[{"Select", "[", 
             RowBox[{"edgechanges", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"First", "[", "#", "]"}], "\[NotEqual]", " ", 
                RowBox[{"Last", "[", "#", "]"}]}], "&"}]}], "]"}]}], "]"}]}], 
         ";", " ", "\[IndentingNewLine]", 
         RowBox[{"nmax", " ", "=", " ", 
          RowBox[{"nmax", "+", "1"}]}], ";", "  ", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"newlineage", ",", 
           RowBox[{"cell", "\[Rule]", " ", "nmax"}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<newlineage: \>\"", ",", " ", "newlineage"}], "]"}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<newedgelineage: \>\"", ",", " ", "newedgelineage"}], 
       "]"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"T2", "=", 
       RowBox[{"Tissue2DTissue", "[", 
        RowBox[{"T1", ",", 
         RowBox[{"\"\<Numbers\>\"", "\[Rule]", " ", "cellnumbers"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<Tissue\>\"", "\[Rule]", " ", "T2"}], ",", " ", 
        RowBox[{"\"\<Lineage\>\"", "\[Rule]", " ", "newlineage"}], ",", " ", 
        RowBox[{"\"\<EdgeLineage\>\"", "\[Rule]", " ", "newedgelineage"}]}], 
       "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.546882584276626*^9, 3.546882717773035*^9}, {
   3.546882825581356*^9, 3.546882859028706*^9}, {3.546882928255229*^9, 
   3.546883036201467*^9}, {3.5468830908464003`*^9, 3.546883160010192*^9}, {
   3.546883224514587*^9, 3.546883267026987*^9}, {3.546883341377919*^9, 
   3.546883386279866*^9}, {3.546883543872061*^9, 3.54688365633707*^9}, {
   3.546883687993423*^9, 3.5468836882924967`*^9}, {3.546883740481966*^9, 
   3.546883783873075*^9}, {3.546883847449461*^9, 3.546883902986568*^9}, {
   3.546884033634837*^9, 3.546884127523682*^9}, {3.546884210271308*^9, 
   3.5468842294907722`*^9}, {3.546884310466394*^9, 3.546884412667068*^9}, {
   3.546884458776146*^9, 3.546884624336677*^9}, {3.546884655885406*^9, 
   3.5468848206761017`*^9}, {3.546891578479261*^9, 3.546891578955183*^9}, {
   3.546891672459188*^9, 3.5468916997221403`*^9}, {3.547055700597341*^9, 
   3.547055700974669*^9}, {3.547217878518022*^9, 3.5472180078283873`*^9}, {
   3.547218153572056*^9, 3.5472181551582823`*^9}, {3.547218252976109*^9, 
   3.547218253665173*^9}, 3.547218304463813*^9, {3.547232613658036*^9, 
   3.547232700911839*^9}, {3.547233086411419*^9, 3.5472330920445642`*^9}, {
   3.5472332743418417`*^9, 3.54723335625251*^9}, {3.547474496609366*^9, 
   3.547474499376638*^9}, {3.5474745470416107`*^9, 3.547474547427436*^9}, {
   3.5474745819467373`*^9, 3.547474619486361*^9}, {3.547474736436501*^9, 
   3.547474778085532*^9}, {3.547474857935437*^9, 3.547474907082959*^9}, {
   3.5474750534352016`*^9, 3.5474750624894667`*^9}, {3.547475336708067*^9, 
   3.5474754147817163`*^9}, {3.5474755805123787`*^9, 3.5474756864186*^9}, {
   3.5474757949745398`*^9, 3.547475810045829*^9}, {3.5475767802155027`*^9, 
   3.547576780805765*^9}, {3.547586070857924*^9, 3.547586081799816*^9}, {
   3.547586270160549*^9, 3.547586271093183*^9}, {3.547645553898918*^9, 
   3.547645557750787*^9}, {3.547645656250368*^9, 3.547645661834734*^9}, {
   3.547646831586501*^9, 3.547646853074301*^9}, {3.5476469275241623`*^9, 
   3.5476469886561623`*^9}, {3.5476470698448563`*^9, 3.547647087297538*^9}, {
   3.547647148940028*^9, 3.5476471560375957`*^9}, 3.547648514355212*^9, {
   3.547668029202869*^9, 3.547668060559999*^9}, {3.547668166779615*^9, 
   3.5476682243943863`*^9}, {3.5476682548247223`*^9, 3.5476682623639193`*^9}, 
   3.547668434690618*^9, {3.547671390808469*^9, 3.547671484897081*^9}, {
   3.547671788339807*^9, 3.547671789876697*^9}, {3.547731109711946*^9, 
   3.547731124801557*^9}, {3.547739835168998*^9, 3.547739853079328*^9}, {
   3.547739920040945*^9, 3.547739931912285*^9}, 3.547740033836268*^9, {
   3.547745657071175*^9, 3.5477456751293297`*^9}, {3.54774576324926*^9, 
   3.54774578212808*^9}, {3.547746466983775*^9, 3.547746486132595*^9}, {
   3.547746679288711*^9, 3.547746689528688*^9}, {3.559596117140972*^9, 
   3.5595961363945217`*^9}, {3.559596456531295*^9, 3.559596463586286*^9}, {
   3.559596516741468*^9, 3.5595965370988398`*^9}, {3.5595975409370327`*^9, 
   3.559597561846682*^9}, {3.5661396665436563`*^9, 3.566139721730007*^9}, {
   3.566139827100716*^9, 3.566139854620036*^9}, {3.566140061870921*^9, 
   3.566140167271488*^9}, {3.566140250593122*^9, 3.566140253918221*^9}, {
   3.566140307076214*^9, 3.566140341525075*^9}, {3.5661415423401747`*^9, 
   3.566141554376388*^9}, 3.566141943331901*^9, {3.572224077964275*^9, 
   3.5722241379209747`*^9}, {3.5722274191554737`*^9, 
   3.5722274499669113`*^9}, {3.572227520688652*^9, 3.5722275282648687`*^9}, {
   3.572227630012381*^9, 3.572227633051311*^9}, 3.57222812989113*^9, {
   3.572261722643135*^9, 3.572261764976907*^9}, {3.577209653438593*^9, 
   3.577209700125224*^9}, {3.577317653596466*^9, 
   3.5773177175802917`*^9}},ExpressionUUID->"a29b131e-f960-4a63-a2fc-\
14f662e55783"]
}, Closed]],

Cell[CellGroupData[{

Cell["ShowSavedFiles, GetSavedFile", "Subsubsection",
 CellChangeTimes->{{3.556796858533551*^9, 3.5567968625331287`*^9}, {
  3.556797725872054*^9, 
  3.556797728263159*^9}},ExpressionUUID->"22a1200d-53f6-4aeb-bc96-\
421390c09ee8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ShowSavedFiles", "[", "]"}], ":=", " ", 
   RowBox[{"FileNames", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ToFileName", "[", 
       RowBox[{"$SIMDIR", ",", "#"}], "]"}], "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{"\"\<*.nb\>\"", ",", " ", "\"\<*.mx\>\""}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ShowSavedFiles", "[", "type_", "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Type", ",", "f"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Type", "=", 
       RowBox[{"ToString", "[", "type", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"f", "=", 
       RowBox[{"Switch", "[", 
        RowBox[{"Type", ",", "\[IndentingNewLine]", "\"\<IC\>\"", ",", " ", 
         RowBox[{"{", "\"\<IC*.nb\>\"", "}"}], ",", " ", 
         "\[IndentingNewLine]", "\"\<ODE\>\"", ",", 
         RowBox[{"{", "\"\<ODE*.nb\>\"", "}"}], ",", "\[IndentingNewLine]", 
         "\"\<Options\>\"", ",", 
         RowBox[{"{", "\"\<Simulation-Options.nb\>\"", "}"}], ",", 
         "\[IndentingNewLine]", "\"\<Tissue\>\"", ",", 
         RowBox[{"{", "\"\<DTissue*.nb\>\"", "}"}], ",", 
         "\[IndentingNewLine]", "\"\<Net\>\"", ",", 
         RowBox[{"{", "\"\<Network*.nb\>\"", "}"}], ",", 
         "\[IndentingNewLine]", "\"\<Equations\>\"", ",", 
         RowBox[{"{", "\"\<Equations*.nb\>\"", "}"}], ",", 
         "\[IndentingNewLine]", "\"\<Solutions\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<Solution*.mx\>\"", ",", " ", "\"\<Solution*.nb\>\""}], 
          "}"}], ",", "\[IndentingNewLine]", "\"\<Lineage\>\"", ",", 
         RowBox[{"{", "\"\<Lineage.nb\>\"", "}"}], ",", 
         "\[IndentingNewLine]", "\"\<EdgeLineage\>\"", ",", 
         RowBox[{"{", "\"\<EdgeLineage.nb\>\"", "}"}], ",", 
         "\[IndentingNewLine]", "_", ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Type", "<>", "\"\<*.nb\>\""}], ",", " ", 
           RowBox[{"Type", "<>", "\"\<*.mx\>\""}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"f", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"ToFileName", "[", 
          RowBox[{"$SIMDIR", ",", " ", "#"}], "]"}], "&"}], "/@", "f"}]}], 
      ";", " ", "\[IndentingNewLine]", 
      RowBox[{"FileNames", "[", "f", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetSavedFile", "[", "type_", "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Type", ",", "f", ",", " ", "str", ",", "object", ",", "dumped", ",", 
       "objname"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Type", "=", 
       RowBox[{"ToString", "[", "type", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"str", "=", "False"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"f", "=", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "Type", ",", "\[IndentingNewLine]", "\"\<IC\>\"", ",", " ", "$ICFILE",
          ",", "\[IndentingNewLine]", "\"\<ODE\>\"", ",", " ", 
         RowBox[{
          RowBox[{"str", "=", "True"}], ";", " ", "$ODEFILE"}], ",", " ", 
         "\[IndentingNewLine]", "\"\<Options\>\"", ",", " ", "$OPTIONFILE", 
         ",", "\[IndentingNewLine]", "\"\<Tissue\>\"", ",", " ", 
         RowBox[{
          RowBox[{"str", "=", "True"}], ";", " ", "$TISSUEFILE"}], ",", 
         "\[IndentingNewLine]", "\"\<Net\>\"", ",", " ", "$NETFILE", ",", 
         "\[IndentingNewLine]", "\"\<Equation\>\"", ",", " ", "$EQNFILE", ",",
          "\[IndentingNewLine]", "\"\<Solution\>\"", ",", "$SOLUTIONFILE", 
         ",", "\[IndentingNewLine]", "\"\<Lineage\>\"", ",", " ", 
         "$LINEAGEFILE", ",", "\[IndentingNewLine]", "\"\<EdgeLineage\>\"", 
         ",", "$EDGELINEAGEFILE", ",", "\[IndentingNewLine]", "_", ",", 
         RowBox[{"ToFileName", "[", 
          RowBox[{"$SIMDIR", ",", " ", "Type"}], "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"f", "=", 
       RowBox[{"FileNames", "[", "f", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "f", "]"}], "<", "1"}], ",", " ", 
        RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"f", "=", 
       RowBox[{"First", "[", "f", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"object", "=", 
       RowBox[{"Get", "[", "f", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"str", ",", " ", 
        RowBox[{"object", "=", 
         RowBox[{"ToExpression", "[", "object", "]"}]}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Type", "\[Equal]", "\"\<Solution\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"FileExtension", "[", "$SOLUTIONFILE", "]"}], "\[Equal]", 
            "\"\<mx\>\""}], ",", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "Global`$$SOLUTION", "]"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "object", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetSavedFile", "[", 
    RowBox[{"folder_", ",", "type_", ",", "n_", ",", " ", 
     RowBox[{"quiet_:", "False"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "num", ",", "numx", ",", " ", "Type", ",", "str", ",", "f", ",", 
       "object"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"num", "=", 
       RowBox[{
        RowBox[{"IntegerString", "[", 
         RowBox[{"n", ",", "10", ",", "4"}], "]"}], "<>", "\"\<.nb\>\""}]}], 
      ";", " ", "\[IndentingNewLine]", 
      RowBox[{"numx", "=", 
       RowBox[{
        RowBox[{"IntegerString", "[", 
         RowBox[{"n", ",", "10", ",", "4"}], "]"}], "<>", "\"\<.mx\>\""}]}], 
      ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Type", "=", 
       RowBox[{"ToString", "[", "type", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"str", "=", "False"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"f", "=", 
       RowBox[{"Switch", "[", 
        RowBox[{"Type", ",", "\[IndentingNewLine]", "\"\<IC\>\"", ",", " ", 
         RowBox[{"\"\<IC\>\"", "<>", "num"}], ",", "\[IndentingNewLine]", 
         "\"\<ODE\>\"", ",", " ", 
         RowBox[{
          RowBox[{"str", "=", "True"}], ";", " ", 
          RowBox[{"\"\<ODES\>\"", "<>", "num"}]}], ",", " ", 
         "\[IndentingNewLine]", "\"\<Options\>\"", ",", " ", 
         "\"\<Simulation-Options.nb\>\"", ",", "\[IndentingNewLine]", 
         "\"\<Tissue\>\"", ",", " ", 
         RowBox[{
          RowBox[{"str", "=", "True"}], ";", " ", 
          RowBox[{"\"\<DTissue\>\"", "<>", "num"}]}], ",", 
         "\[IndentingNewLine]", "\"\<Net\>\"", ",", " ", 
         RowBox[{"\"\<Network\>\"", "<>", "num"}], ",", 
         "\[IndentingNewLine]", "\"\<Equation\>\"", ",", " ", 
         RowBox[{"\"\<Equations\>\"", "<>", "num"}], ",", 
         "\[IndentingNewLine]", "\"\<Solution\>\"", ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<Solution\>\"", "<>", "num"}], ",", 
           RowBox[{"\"\<Solution\>\"", "<>", "numx"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "\"\<Lineage\>\"", ",", " ", 
         "\"\<Lineage.nb\>\"", ",", "\[IndentingNewLine]", 
         "\"\<EdgeLineage\>\"", ",", "\"\<EdgeLineage.nb\>\"", ",", 
         "\[IndentingNewLine]", "_", ",", 
         RowBox[{
          RowBox[{"AbortIf", "[", 
           RowBox[{"True", ",", 
            RowBox[{"\"\<Unknown file type: \>\"", "<>", "Type"}]}], "]"}], 
          ";"}]}], " ", "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"f", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"ToFileName", "[", 
          RowBox[{"folder", ",", " ", "#"}], "]"}], "&"}], "/@", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", "f", "}"}], "]"}]}]}], ";", " ", "\[IndentingNewLine]", 
      
      RowBox[{"f", "=", 
       RowBox[{"FileNames", "[", "f", "]"}]}], ";", "  ", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "f", "]"}], "<", "1"}], ",", " ", 
        RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"f", "=", 
       RowBox[{"First", "[", "f", "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "[", "quiet", "]"}], ",", " ", 
        RowBox[{"Print", "[", "f", "]"}]}], "]"}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"object", "=", 
       RowBox[{"Get", "[", "f", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"str", ",", " ", 
        RowBox[{"object", "=", 
         RowBox[{"ToExpression", "[", "object", "]"}]}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Type", "\[Equal]", "\"\<Solution\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"FileExtension", "[", "f", "]"}], "\[Equal]", 
            "\"\<mx\>\""}], ",", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "Global`$$SOLUTION", "]"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "object", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetSavedFile", "[", 
    RowBox[{"f_", ",", " ", "type_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Type", ",", " ", "str", ",", "object"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Type", "=", 
       RowBox[{"ToString", "[", "type", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"str", "=", "False"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"Switch", "[", 
       RowBox[{"Type", ",", "\[IndentingNewLine]", "\"\<ODE\>\"", ",", " ", 
        RowBox[{"str", "=", "True"}], ",", "\[IndentingNewLine]", 
        "\"\<Tissue\>\"", ",", " ", 
        RowBox[{"str", "=", "True"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"object", "=", 
       RowBox[{"Get", "[", "f", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"str", ",", " ", 
        RowBox[{"object", "=", 
         RowBox[{"ToExpression", "[", "object", "]"}]}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Type", "\[Equal]", "\"\<Solution\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"FileExtension", "[", "f", "]"}], "\[Equal]", 
            "\"\<mx\>\""}], ",", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "Global`$$SOLUTION", "]"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "object", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.556796864031371*^9, 3.5567968877753267`*^9}, {
   3.556796953200345*^9, 3.556797520284687*^9}, {3.556797637198121*^9, 
   3.556797702645463*^9}, {3.556797882317072*^9, 3.55679788403941*^9}, {
   3.556797918777919*^9, 3.556797921332646*^9}, {3.556797969355978*^9, 
   3.556798016493819*^9}, {3.557000912646488*^9, 3.5570011748263073`*^9}, {
   3.557001220162573*^9, 3.557001253000607*^9}, {3.557932878600603*^9, 
   3.557932880970475*^9}, 3.557932913383464*^9, {3.558549542740038*^9, 
   3.5585496122560883`*^9}, {3.561813565724341*^9, 3.561813587128394*^9}, {
   3.576676973136813*^9, 3.5766771032196217`*^9}, {3.5766771584165287`*^9, 
   3.5766771771120663`*^9}, {3.576677278805764*^9, 3.576677339643214*^9}, {
   3.5766779270089407`*^9, 3.576678026181424*^9}, {3.5766781047413692`*^9, 
   3.5766781387645206`*^9}, {3.576678190107922*^9, 3.576678196071579*^9}, {
   3.576678356890608*^9, 3.576678582511324*^9}, {3.576679027691564*^9, 
   3.576679045153695*^9}, {3.576679169308456*^9, 3.5766791708062277`*^9}, {
   3.5766792219017*^9, 3.576679346953614*^9}, {3.576679464659616*^9, 
   3.576679465817819*^9}, {3.576679502694606*^9, 3.576679506623187*^9}, {
   3.5766795470709133`*^9, 3.576679560796179*^9}, {3.576679597698079*^9, 
   3.5766795996857643`*^9}, {3.576679916092746*^9, 3.576679922641979*^9}, {
   3.576679993348729*^9, 3.576679995282219*^9}, {3.576680026920396*^9, 
   3.576680032055502*^9}, {3.576680616128421*^9, 3.576680845082436*^9}, {
   3.576680879482031*^9, 3.576680880872954*^9}, {3.5766819956105947`*^9, 
   3.5766819973460608`*^9}},ExpressionUUID->"f8ef2404-a269-4921-b602-\
db47d8650918"]
}, Closed]],

Cell[CellGroupData[{

Cell["GetODEs", "Subsubsection",
 CellChangeTimes->{{3.5567992013415213`*^9, 
  3.556799202757215*^9}},ExpressionUUID->"5eccadd9-6fe1-465f-b0fd-\
436990dddf0b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GetODES", "[", 
    RowBox[{
     RowBox[{"odes_", "?", "ListQ"}], ",", " ", 
     RowBox[{"vars_", "?", "ListQ"}]}], "]"}], ":=", " ", 
   RowBox[{"Pick", "[", 
    RowBox[{"odes", ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"vars", ",", "#"}], "]"}], "&"}], "/@", 
      RowBox[{"Head", "/@", 
       RowBox[{"First", "/@", 
        RowBox[{"Head", "/@", 
         RowBox[{"First", "/@", "odes"}]}]}]}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetODES", "[", 
     RowBox[{
      RowBox[{"odes_", "?", "ListQ"}], ",", " ", "var_"}], "]"}], ":=", " ", 
    RowBox[{"GetODES", "[", 
     RowBox[{"odes", ",", " ", 
      RowBox[{"{", "var", "}"}]}], "]"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.556799334471882*^9, 
  3.556799389955544*^9}},ExpressionUUID->"888b9f5e-01ec-4b93-a01e-\
ef5748de316e"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["BalanceLineage, ShowBalancedLIneage", "Subsection",
 CellChangeTimes->{{3.548254648836918*^9, 3.548254650549358*^9}, {
  3.548254952516691*^9, 
  3.548254956197257*^9}},ExpressionUUID->"81fd7c5e-ed46-49e8-9aef-\
6c30dfec39c2"],

Cell["\<\
Input: parent -> child lineage tree (some cells will be on roots, some cells \
on leaves)

Output: all cells will be on leaves. The nodes will represent successive cell \
divisions. (This assumes that the input lineage tree is time-ordered from \
left to right so that {2->3, 2->4,3->5 means that 2 divided into 2 and 3 \
before it divided up into 3 and 5}.
Each cell division node is labeled as \[OpenCurlyDoubleQuote]parent+child\
\[CloseCurlyDoubleQuote], i.e., 2->3 is replace by two nodes \
\[OpenCurlyDoubleQuote]2+3\[CloseCurlyDoubleQuote]->2 and \
\[OpenCurlyDoubleQuote]2+3\[CloseCurlyDoubleQuote]->3. 

The resulting tree is compatible with TreePlot and can be parsed to display \
only the parents (if desired) by using an appropriate VertexRenderingFunction \
(See ShowBalancedLineage)\
\>", "Text",
 CellChangeTimes->{{3.54825466919783*^9, 
  3.548254947399225*^9}},ExpressionUUID->"3078a446-1ab8-4f6a-915d-\
ba264ad9afc7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BalanceLineage", "[", "linput_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "newlineage", ",", "next", ",", "parent", ",", "child", ",", "newnode", 
      ",", "rule", ",", "l"}], "}"}], ",", 
    RowBox[{
     RowBox[{"l", "=", "linput"}], ";", "\[IndentingNewLine]", 
     RowBox[{"newlineage", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "l", "]"}], ">", "0"}], ",", 
       RowBox[{
        RowBox[{"next", "=", 
         RowBox[{"First", "[", "l", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"l", "=", 
         RowBox[{"Rest", "[", "l", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"parent", "=", 
         RowBox[{"First", "[", "next", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"child", "=", 
         RowBox[{"Last", "[", "next", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"parent", ">", "0"}], ",", 
          RowBox[{
           RowBox[{"newnode", "=", 
            RowBox[{
             RowBox[{"ToString", "[", "parent", "]"}], "<>", "\"\<+\>\"", "<>", 
             RowBox[{"ToString", "[", "child", "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"rule", "=", 
            RowBox[{"(", 
             RowBox[{"parent", "\[Rule]", "newnode"}], ")"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"newlineage", "=", 
            RowBox[{"newlineage", "/.", "rule"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"newlineage", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"newlineage", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"newnode", "\[Rule]", "parent"}], ",", 
                RowBox[{"newnode", "\[Rule]", "child"}]}], "}"}]}], "]"}]}], 
           ";"}], ",", 
          RowBox[{"newlineage", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"newlineage", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"parent", "\[Rule]", 
                RowBox[{"ToString", "[", "child", "]"}]}], ",", 
               RowBox[{
                RowBox[{"ToString", "[", "child", "]"}], "\[Rule]", 
                "child"}]}], "}"}]}], "]"}]}]}], "]"}], ";"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "newlineage", "]"}], ";"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.548254663941494*^9, 
  3.548254663946806*^9}},ExpressionUUID->"9aa8534c-9a79-45c1-ade5-\
e4ec4e195c19"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ShowBalancedLineage", "[", 
   RowBox[{"l_", ",", "position_", ",", 
    RowBox[{"label_:", "True"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"pstring", ",", "new", ",", 
      RowBox[{"okpositions", "=", 
       RowBox[{"{", 
        RowBox[{
        "Top", ",", "Bottom", ",", "Left", ",", "Right", ",", "Center"}], 
        "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Not", "[", 
        RowBox[{"MemberQ", "[", 
         RowBox[{"okpositions", ",", "position"}], "]"}], "]"}], ",", " ", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Error: ShowBalancedLineage: position must be one of \>\"", ",", 
          " ", "okpositions"}], "]"}], ";", " ", 
        RowBox[{"Return", "[", 
         RowBox[{"Graphics", "[", "]"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"pstring", "[", "s_", "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"p", ",", "str"}], "}"}], ",", 
        RowBox[{
         RowBox[{"str", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"StringQ", "[", "s", "]"}], ",", "s", ",", 
            RowBox[{"ToString", "[", "s", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"p", "=", 
          RowBox[{"StringPosition", "[", 
           RowBox[{"str", ",", "\"\<+\>\""}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "p", "]"}], "<", "1"}], ",", 
           RowBox[{"Return", "[", "str", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"p", "=", 
          RowBox[{"First", "/@", "p"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"p", "=", 
          RowBox[{"Min", "[", "p", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"StringTake", "[", 
          RowBox[{"str", ",", 
           RowBox[{"p", "-", "1"}]}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"new", " ", "=", " ", 
      RowBox[{"BalanceLineage", "[", "l", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"label", ",", "\[IndentingNewLine]", 
       RowBox[{"TreePlot", "[", 
        RowBox[{"new", ",", "position", ",", "0", ",", 
         RowBox[{"\"\<VertexLabeling\>\"", "\[Rule]", "True"}], ",", 
         RowBox[{"\"\<VertexRenderingFunction\>\"", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"pstring", "[", "#2", "]"}], ",", "#1", ",", 
              RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], "&"}], 
           ")"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"TreePlot", "[", 
        RowBox[{"new", ",", "position", ",", "0"}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5482549855606937`*^9, 3.5482550583601303`*^9}, {
  3.548255113669132*^9, 3.548255248831214*^9}, {3.548255381174839*^9, 
  3.548255430870133*^9}},ExpressionUUID->"f5f31f5d-1511-475b-80ca-\
da1f39550db6"]
}, Closed]],

Cell[CellGroupData[{

Cell["SetNextIC", "Subsection",
 CellChangeTimes->{{3.5473070025148087`*^9, 
  3.547307004866048*^9}},ExpressionUUID->"6673cf43-2cf4-48f5-89ce-\
20b53872407f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetNextIC", "[", 
   RowBox[{
   "Tnew_", ",", "Told_", ",", " ", "Sim_", ",", "NewNet_", ",", " ", 
    "equations_", ",", " ", "ell_", ",", "area_", ",", "resting_", ",", "x_", 
    ",", "y_", ",", " ", "IsotropicGrowth_", ",", " ", "mu_", ",", 
    "IsotropicSprings_", ",", "k_", ",", " ", "tip_", ",", "  ", "center_", 
    ",", "tipdist_", ",", " ", "perim_", ",", "P_", ",", " ", "L1_", ",", " ",
     "L2_", ",", " ", "TIPF_", ",", " ", "PD_", ",", "parameters_", ",", "  ",
     "dbg_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "species", ",", " ", "eused", ",", "ne", ",", "eflags", ",", "eneeded", 
      ",", "lvalsneeded", ",", "icell", ",", "cellnumbers", ",", "icarea", 
      ",", "nv", ",", "vflags", ",", "vused", ",", "vneeded", ",", "xyused", 
      ",", "vall", ",", "icx", ",", "icy", ",", "s", ",", "values", ",", 
      "tbegin", ",", "tend", ",", " ", "dPrint", ",", "icfromsim", ",", 
      "icallsim", ",", "icneeded", ",", " ", "lineage", ",", " ", "firstArg", 
      ",", " ", "restingneeded", ",", "redge", ",", "icrnew", ",", 
      "elengthrules", ",", " ", "lastdivision", ",", "parent", ",", " ", 
      "child", ",", " ", "icchild", ",", "icchildp", ",", " ", 
      "replaceFirstArg", ",", "ic", ",", " ", "edgelineage", ",", 
      "edgeparents", ",", "secondArg", ",", " ", "cellparents", ",", 
      "replaceSecondArg", ",", "nargs", ",", "cc", ",", "incell", ",", 
      "redgecell", ",", "redgeparents", ",", "redgeparentvalues", ",", 
      "parentelextensions", ",", "parentallengths", ",", "icrok", ",", " ", 
      "icstillneeded", ",", "adjacentedges", ",", " ", "adjacentresting", ",",
       " ", "adjacentlengths", ",", "adjacentextensions", ",", "lengths", ",",
       "restingAppliedErroneouslyNums", ",", " ", "restingAppliedErroneously",
       ",", "restingApplied", ",", "restingAppliedNums", ",", "muic", ",", 
      "kic", ",", "tic", ",", "ticrules", ",", "kvar", ",", "muvar", ",", 
      "centerIC", ",", "perimIC", ",", " ", "tipdistIC", ",", " ", 
      "PressureIC", ",", "Pvar", ",", " ", "L1IC", ",", " ", "L2IC", ",", " ",
       "TIPFIC", ",", " ", "PDIC", ",", " ", "EVIC"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"dPrint", "[", "u___", "]"}], ":=", " ", 
      RowBox[{"If", "[", 
       RowBox[{"dbg", ",", " ", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<SetNextIC: \>\"", ",", " ", "u"}], "]"}]}], "]"}]}], 
     ";", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nargs", "[", 
       RowBox[{"afunction_", "[", "u___", "]"}], "]"}], ":=", " ", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "u", "}"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"firstArg", "[", 
       RowBox[{"somefunction_", "[", 
        RowBox[{"u_", ",", "v___"}], "]"}], "]"}], ":=", " ", "u"}], ";", " ",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"secondArg", "[", 
       RowBox[{"someFunction_", "[", 
        RowBox[{"u_", ",", "v_", ",", "w___"}], "]"}], "]"}], ":=", " ", 
      "v"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"replaceFirstArg", "[", 
       RowBox[{
        RowBox[{"somefunction_", "[", 
         RowBox[{"u_", ",", "v___"}], "]"}], ",", "unew_"}], "]"}], ":=", " ", 
      RowBox[{"somefunction", "[", 
       RowBox[{"unew", ",", "v"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"replaceSecondArg", "[", 
       RowBox[{
        RowBox[{"someFunction_", "[", 
         RowBox[{"u_", ",", "v_", ",", "w___"}], "]"}], ",", "vnew_"}], "]"}],
       ":=", " ", 
      RowBox[{"someFunction", "[", 
       RowBox[{"u", ",", "vnew", ",", "w"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Actual", " ", "lengths", " ", "of", " ", "edges", " ", "used"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"eused", "=", 
      RowBox[{"EdgesUsed", "[", "Tnew", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"ne", "=", 
      RowBox[{"NTissueEdges", "[", "Tnew", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"eflags", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"eused", ",", "#"}], "]"}], "&"}], "/@", 
       RowBox[{"Range", "[", "ne", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"eneeded", " ", "=", " ", 
      RowBox[{"Pick", "[", 
       RowBox[{
        RowBox[{"Range", "[", "ne", "]"}], ",", "eflags"}], "]"}]}], ";", " ",
      "\[IndentingNewLine]", 
     RowBox[{"lvalsneeded", " ", "=", " ", 
      RowBox[{"Pick", "[", 
       RowBox[{
        RowBox[{"EdgeLengths", "[", "Tnew", "]"}], ",", "eflags"}], "]"}]}], 
     ";", " ", "\[IndentingNewLine]", 
     RowBox[{"elengthrules", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{"Rule", ",", 
        RowBox[{"{", 
         RowBox[{"eneeded", ",", "lvalsneeded"}], "}"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<elengthrules:\>\"", ",", 
       RowBox[{"Short", "[", 
        RowBox[{"elengthrules", ",", "5"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Actual", " ", 
       RowBox[{"(", "dynamic", ")"}], " ", "cell", " ", "numbers"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"cc", "=", 
      RowBox[{"TissueCells", "[", "Tnew", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"cellnumbers", "=", 
      RowBox[{"First", "/@", "cc"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"incell", "[", "edgeNumber_", "]"}], ":=", " ", 
      RowBox[{"First", "/@", 
       RowBox[{"Select", "[", 
        RowBox[{"cc", ",", " ", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"Last", "[", "#", "]"}], ",", "edgeNumber"}], "]"}], 
          "&"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Actual", " ", "vertices", " ", "used"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"nv", "=", 
      RowBox[{"NTissueVertices", "[", "Tnew", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"vused", " ", "=", " ", 
      RowBox[{"VerticesUsed", "[", "Tnew", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"vall", " ", "=", " ", 
      RowBox[{"TissueVertices", "[", "Tnew", "]"}]}], ";", "  ", 
     "\[IndentingNewLine]", 
     RowBox[{"vflags", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"vused", ",", "#"}], "]"}], "&"}], "/@", 
       RowBox[{"Range", "[", "nv", "]"}]}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"vneeded", "=", 
      RowBox[{"Pick", "[", 
       RowBox[{
        RowBox[{"Range", "[", "nv", "]"}], ",", "vflags"}], "]"}]}], ";", " ",
      "\[IndentingNewLine]", 
     RowBox[{"xyused", "=", 
      RowBox[{"Pick", "[", 
       RowBox[{"vall", ",", "vflags"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"species", "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"interpret", "[", "NewNet", "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"ell", ",", "area", ",", "x", ",", "y"}], "}"}], ",", 
            RowBox[{"Head", "[", "#", "]"}]}], "]"}], "]"}], "&"}]}], "]"}]}],
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Find", " ", "Values", " ", "in", " ", "Solution"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"s", " ", "=", " ", 
      RowBox[{"\"\<Solution\>\"", "/.", "Sim"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tbegin", ",", "tend"}], "}"}], "=", 
      RowBox[{"\"\<TimeSpan\>\"", "/.", "Sim"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"values", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", "[", "Global`t", "]"}], "/.", "s"}], ")"}], "&"}], "/@",
          "species"}], ")"}], "/.", 
       RowBox[{"{", 
        RowBox[{"Global`t", "\[Rule]", "tend"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<values: \>\"", ",", " ", 
       RowBox[{"Short", "[", 
        RowBox[{"values", ",", "5"}], "]"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"icallsim", " ", "=", " ", 
      RowBox[{"MapThread", "[", 
       RowBox[{"Rule", ",", 
        RowBox[{"{", 
         RowBox[{"species", ",", "values"}], "}"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"icfromsim", " ", "=", " ", 
      RowBox[{"Pick", "[", 
       RowBox[{"icallsim", ",", " ", 
        RowBox[{"NumberQ", "/@", "values"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<icfromsim: \>\"", ",", " ", 
       RowBox[{"Short", "[", 
        RowBox[{"icfromsim", ",", "5"}], "]"}]}], "]"}], ";", "  ", 
     "\[IndentingNewLine]", 
     RowBox[{"icneeded", " ", "=", " ", 
      RowBox[{"First", "/@", 
       RowBox[{"Pick", "[", 
        RowBox[{"icallsim", ",", " ", 
         RowBox[{"Not", "/@", 
          RowBox[{"NumberQ", "/@", "values"}]}]}], "]"}]}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"NOTE", ":", " ", 
       RowBox[{
       "SOME", " ", "OF", " ", "THE", " ", "resting", " ", "VALUES", " ", 
        "were", " ", "just", " ", "ERRONEOUSLY", " ", "REPLACED", " ", "with",
         " ", "their", " ", "PARENT", " ", 
        RowBox[{"VALUES", "!"}], " ", "NEED", " ", "TO", " ", "REMOVE", " ", 
        RowBox[{"THOSE", "!"}], " ", "THESE", " ", "ARE", " ", "RESTINGS", 
        " ", "FOR", " ", "EDGES", " ", "THAT", " ", "JUST", " ", 
        RowBox[{"DIVIDED", ".", " ", "BUT"}], " ", "THESE", " ", "WILL", " ", 
        "BE", " ", "PARENTS", " ", "OF", " ", "REMAING", " ", "EDGES"}]}], 
      " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"restingApplied", " ", "=", " ", 
      RowBox[{"Select", "[", 
       RowBox[{"icfromsim", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", 
           RowBox[{"First", "[", "#", "]"}], "]"}], "\[Equal]", "resting"}], 
         "&"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"restingAppliedNums", " ", "=", " ", 
      RowBox[{"firstArg", "/@", 
       RowBox[{"(", 
        RowBox[{"First", "/@", "restingApplied"}], ")"}]}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<restingApplied: \>\"", ",", " ", 
       RowBox[{"Short", "[", 
        RowBox[{"restingApplied", ",", "5"}], "]"}], ",", " ", 
       "\"\<\\nEdgeNumbers: \>\"", ",", " ", 
       RowBox[{"Short", "[", 
        RowBox[{"restingAppliedNums", ",", "5"}], "]"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"To", " ", "determine", " ", "new", " ", "edge", " ", 
        RowBox[{"tension", ":", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", "1", ")"}], " ", "For", " ", "edges", " ", "that", " ",
           "divide", " ", "in", " ", "2"}]}]}], ",", " ", 
       RowBox[{
        RowBox[{"use", " ", "same", " ", "compression", " ", 
         RowBox[{"(", 
          RowBox[{"rest", "/", "length"}], ")"}], " ", "ratio", " ", "as", 
         " ", 
         RowBox[{"parent", ":", "\[IndentingNewLine]", "      ", 
          RowBox[{"rest", 
           RowBox[{"(", "new", ")"}]}]}]}], " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"rest", 
            RowBox[{
             RowBox[{"(", "parent", ")"}], "/", "length"}], 
            RowBox[{"(", "parent", ")"}]}], ")"}], "*", " ", "length", 
          RowBox[{"(", "extension", ")"}], "\[IndentingNewLine]", "      ", 
          "where", " ", "parent", " ", "is", " ", "the", " ", "original", " ",
           "edge", " ", "prior", " ", "to", " ", "divisions", 
          "\[IndentingNewLine]", 
          RowBox[{"(", "2", ")"}], " ", "For", " ", "edges", " ", "formed", 
          " ", "de"}], "-", "novo"}]}], ",", " ", 
       RowBox[{
       "after", " ", "all", " ", "the", " ", "other", " ", "edges", " ", 
        "are", " ", "formed"}], ",", " ", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"determine", " ", "the", " ", "averge", " ", 
        RowBox[{"compression", "/", "tension"}], " ", "of", " ", "the", " ", 
        "intersecting", " ", "edges"}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
       "and", " ", "use", " ", "that", " ", "to", " ", "determine", " ", 
        "the", " ", "new", " ", "resting", " ", 
        RowBox[{"length", ".", "\[IndentingNewLine]", 
         RowBox[{"Note", ":", " ", 
          RowBox[{"This", " ", "idea", " ", "actually", " ", 
           RowBox[{"doesn", "'"}], "t", " ", "work"}]}]}]}], ",", " ", 
       RowBox[{
       "because", " ", "the", " ", "average", " ", "of", " ", "the", " ", 
        "intersecting", " ", "edges", " ", "can", " ", "produce", " ", "a", 
        " ", "significant", " ", "bias", " ", "if", " ", "one", " ", "of", 
        " ", "the", " ", "neighboring", " ", "edges", " ", "is", " ", 
        "significantly", " ", "compressed", " ", "or", " ", 
        RowBox[{"extended", "."}]}]}], "\[IndentingNewLine]", " ", "*)"}], 
     " ", "\[IndentingNewLine]", 
     RowBox[{"lineage", " ", "=", " ", 
      RowBox[{"\"\<Lineage\>\"", "/.", "Sim"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"cellparents", " ", "=", " ", 
      RowBox[{"Reverse", "/@", "lineage"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<cellparents: \>\"", ",", " ", 
       RowBox[{"Short", "[", 
        RowBox[{"cellparents", ",", "5"}], "]"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"edgelineage", " ", "=", " ", 
      RowBox[{"\"\<EdgeLineage\>\"", "/.", "Sim"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"edgeparents", " ", "=", " ", 
      RowBox[{"Reverse", "/@", "edgelineage"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<edgeparents: \>\"", ",", " ", 
       RowBox[{"Short", "[", 
        RowBox[{"edgeparents", ",", "5"}], "]"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"restingneeded", " ", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"icneeded", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", "#", "]"}], "\[Equal]", "resting"}], "&"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"redge", " ", "=", " ", 
      RowBox[{"firstArg", "/@", "restingneeded"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"redgeparents", " ", "=", " ", 
      RowBox[{"redge", "/.", "edgeparents"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<redge:\>\"", ",", " ", 
       RowBox[{"Short", "[", 
        RowBox[{"redge", ",", "5"}], "]"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<redgeparents:\>\"", ",", " ", 
       RowBox[{"Short", "[", 
        RowBox[{"redgeparents", ",", "5"}], "]"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"restingAppliedErroneouslyNums", "=", 
      RowBox[{"Intersection", "[", 
       RowBox[{"restingAppliedNums", ",", "redgeparents"}], "]"}]}], ";", " ",
      "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<restingAppliedErroneousyNums:\>\"", ",", " ", 
       RowBox[{"Short", "[", 
        RowBox[{"restingAppliedErroneouslyNums", ",", "5"}], "]"}]}], "]"}], 
     ";", " ", "\[IndentingNewLine]", 
     RowBox[{"restingAppliedErroneously", "=", 
      RowBox[{"resting", "/@", "restingAppliedErroneouslyNums"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<restingApplieErroneously: \>\"", ",", 
       RowBox[{"Short", "[", " ", 
        RowBox[{"restingAppliedErroneously", ",", "5"}], "]"}]}], "]"}], ";", 
     " ", "\[IndentingNewLine]", 
     RowBox[{"icfromsim", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"icfromsim", ",", " ", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{"MemberQ", "[", 
           RowBox[{"restingAppliedErroneously", ",", 
            RowBox[{"First", "[", "#", "]"}]}], "]"}], "]"}], "&"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<icfromsim (corrected):\>\"", ",", " ", 
       RowBox[{"Short", "[", 
        RowBox[{"icfromsim", ",", "5"}], "]"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Don", "'"}], "t", " ", "use", " ", "parents", " ", "of", " ",
         "erroneous", " ", "edges", " ", "for", " ", "parents"}], ",", " ", 
       RowBox[{
       "because", " ", "they", " ", "really", " ", "were", " ", "the", " ", 
        RowBox[{"parents", "!"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"redge", " ", "=", " ", 
      RowBox[{"Join", "[", 
       RowBox[{"redge", ",", " ", "restingAppliedErroneouslyNums"}], "]"}]}], 
     ";", " ", "\[IndentingNewLine]", 
     RowBox[{"redgeparents", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"restingAppliedErroneouslyNums", ",", "#"}], "]"}], ",", 
          "#", ",", " ", 
          RowBox[{"#", "/.", "edgeparents"}]}], "]"}], "&"}], "/@", 
       "redge"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"restingneeded", " ", "=", " ", 
      RowBox[{"resting", "/@", "redge"}]}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<redge (revised):\>\"", ",", " ", 
       RowBox[{"Short", "[", 
        RowBox[{"redge", ",", "5"}], "]"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<redgeparents (revised):\>\"", ",", " ", 
       RowBox[{"Short", "[", 
        RowBox[{"redgeparents", ",", "5"}], "]"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"redgecell", " ", "=", " ", 
      RowBox[{"incell", "/@", "redge"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<redge:\>\"", ",", " ", 
       RowBox[{"Short", "[", 
        RowBox[{"redge", ",", "5"}], "]"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"lengths", " ", "=", " ", 
      RowBox[{"redge", "/.", "elengthrules"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<redgecell:\>\"", ",", " ", 
       RowBox[{"Short", "[", 
        RowBox[{"redgecell", ",", "5"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<redgeparents:\>\"", ",", " ", 
       RowBox[{"Short", "[", 
        RowBox[{"redgeparents", ",", "5"}], "]"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"redgeparentvalues", " ", "=", "  ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", "[", "Global`t", "]"}], "/.", "s"}], ")"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{"resting", "/@", "redgeparents"}], ")"}]}], ")"}], "/.", 
       RowBox[{"{", 
        RowBox[{"Global`t", "\[Rule]", "tend"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"redgeparentvalues", " ", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"NumberQ", "[", "#", "]"}], ",", "#", ",", 
          "Indeterminate"}], "]"}], "&"}], "/@", "redgeparentvalues"}]}], ";",
      " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "get", " ", "parental", " ", "lengths", " ", "from", " ", "solution"}],
        ",", " ", 
       RowBox[{"not", " ", "tissue"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"parentallengths", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"ell", "[", "#", "]"}], "[", "Global`t", "]"}], "/.", 
            "s"}], ")"}], "&"}], "/@", "redgeparents"}], ")"}], "/.", 
       RowBox[{"{", 
        RowBox[{"Global`t", "\[Rule]", " ", "tend"}], "}"}]}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"parentallengths", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"NumberQ", "[", "#", "]"}], ",", "#", ",", 
          "Indeterminate"}], "]"}], "&"}], "/@", "parentallengths"}]}], ";", 
     " ", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<Parental Resting: \>\"", ",", " ", 
       RowBox[{"Short", "[", 
        RowBox[{"redgeparentvalues", ",", "5"}], "]"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<Parentel Lengths:\>\"", ",", " ", 
       RowBox[{"Short", "[", 
        RowBox[{"parentallengths", ",", "5"}], "]"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"parentelextensions", " ", "=", " ", 
      RowBox[{"parentallengths", "/", "redgeparentvalues"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<parentelextensions:\>\"", ",", " ", 
       RowBox[{"Short", "[", 
        RowBox[{"parentelextensions", ",", "5"}], "]"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"icrnew", " ", "=", " ", 
      RowBox[{"MapThread", "[", 
       RowBox[{"Rule", ",", 
        RowBox[{"{", 
         RowBox[{"restingneeded", ",", " ", 
          RowBox[{"lengths", "/", "parentelextensions"}]}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"icrok", " ", "=", " ", 
      RowBox[{"Select", "[", 
       RowBox[{"icrnew", ",", " ", 
        RowBox[{
         RowBox[{"NumberQ", "[", 
          RowBox[{"Last", "[", "#", "]"}], "]"}], "&"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"icstillneeded", " ", "=", " ", 
      RowBox[{"First", "/@", 
       RowBox[{"Complement", "[", 
        RowBox[{"icrnew", ",", " ", "icrok"}], "]"}]}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"redge", " ", "=", " ", 
      RowBox[{"firstArg", "/@", "icstillneeded"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"lengths", " ", "=", " ", 
      RowBox[{"redge", "/.", "elengthrules"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"icrnew", " ", "=", " ", "icrok"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"adjacentedges", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"IntersectingEdges", "[", 
         RowBox[{"Tnew", ",", "#"}], "]"}], "&"}], "/@", "redge"}]}], ";", 
     " ", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<icrnew: \>\"", ",", 
       RowBox[{"Short", "[", 
        RowBox[{"icrnew", ",", "5"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"finally", ",", " ", 
       RowBox[{
       "the", " ", "ones", " ", "that", " ", "need", " ", "to", " ", "be", 
        " ", "fround", " ", "from", " ", "averages"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"adjacentresting", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{"resting", ",", "adjacentedges", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}], "/.", "icrnew"}], "/.", 
       "icfromsim"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{
      "\"\<icstillneeded:\>\"", ",", " ", "icstillneeded", ",", " ", 
       "\"\< redge: \>\"", ",", " ", "redge", ",", 
       "\"\< actual lengths: \>\"", ",", " ", "lengths", ",", "  ", 
       "\"\< adjacentedges: \>\"", ",", " ", "adjacentedges", ",", " ", 
       "\"\<adjacentretsing: \>\"", ",", " ", "adjacentresting"}], "]"}], ";",
      " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Some", " ", "of", " ", "the", " ", "adjacentedges", " ", "may", " ", 
       "be", " ", "next", " ", "to", " ", "each", " ", 
       RowBox[{"other", "!"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"False", ",", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Use", " ", "average", " ", "of", " ", "neighbors"}], ",", 
         " ", 
         RowBox[{
         "but", " ", "this", " ", "potentially", " ", "gives", " ", "a", " ", 
          "disastorous", " ", 
          RowBox[{"bias", "!"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"adjacentedges", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Select", "[", 
            RowBox[{"#", ",", 
             RowBox[{
              RowBox[{"Not", "[", 
               RowBox[{"MemberQ", "[", 
                RowBox[{"redge", ",", "#"}], "]"}], "]"}], "&"}]}], "]"}], 
           "&"}], "/@", "adjacentedges"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"adjacentresting", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{"resting", ",", "adjacentedges", ",", 
             RowBox[{"{", "2", "}"}]}], "]"}], "/.", "icrnew"}], "/.", 
          "icfromsim"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dPrint", "[", 
         RowBox[{
         "\"\<icstillneeded (revised):\>\"", ",", " ", "icstillneeded", ",", 
          " ", "\"\< redge: \>\"", ",", " ", "redge", ",", " ", 
          "\"\< adjacentedges: \>\"", ",", " ", "adjacentedges", ",", " ", 
          "\"\<adjacentretsing: \>\"", ",", " ", "adjacentresting"}], "]"}], 
        ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"adjacentlengths", "=", 
         RowBox[{"adjacentedges", "/.", "elengthrules"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"adjacentextensions", " ", "=", " ", 
         RowBox[{"Mean", "/@", 
          RowBox[{"(", 
           RowBox[{"adjacentlengths", "/", "adjacentresting"}], ")"}]}]}], 
        ";", " ", "\[IndentingNewLine]", 
        RowBox[{"dPrint", "[", 
         RowBox[{
         "\"\<adjacentresting: \>\"", ",", " ", "adjacentresting", ",", 
          "\"\< adjacentlengths: \>\"", ",", "  ", "adjacentlengths", ",", 
          " ", "\"\< adjacentextensions: \>\"", ",", " ", 
          "adjacentextensions"}], "]"}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"icstillneeded", " ", "=", " ", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Rule", ",", 
           RowBox[{"{", 
            RowBox[{"icstillneeded", ",", 
             RowBox[{"lengths", "/", "adjacentextensions"}]}], "}"}]}], 
          "]"}]}], ";"}]}], " ", "\[IndentingNewLine]", "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"icstillneeded", " ", "=", " ", 
      RowBox[{"MapThread", "[", 
       RowBox[{"Rule", ",", 
        RowBox[{"{", 
         RowBox[{"icstillneeded", ",", "lengths"}], "}"}]}], "]"}]}], ";", 
     " ", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{
      "\"\<icstillneeded: (set equal to length): \>\"", ",", " ", 
       "icstillneeded"}], "]"}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"icrnew", " ", "=", " ", 
      RowBox[{"Join", "[", 
       RowBox[{"icstillneeded", ",", "icrnew"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<icrnew: \>\"", ",", "icrnew"}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"icneeded", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{"icneeded", ",", "restingneeded"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<icneeded: \>\"", ",", " ", "icneeded"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Get", " ", "remaining", " ", "IC", " ", "from", " ", "pre"}], 
       "-", "division"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"lastdivision", " ", "=", " ", 
      RowBox[{"Last", "[", "lineage", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"parent", " ", "=", " ", 
      RowBox[{"First", "[", "lastdivision", "]"}]}], ";", " ", 
     RowBox[{"child", "=", 
      RowBox[{"Last", "[", "lastdivision", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "NEEDIC", ",", "nextvar", ",", "cellParent", ",", "edgeParent"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"NEEDIC", "=", "icneeded"}], ";", " ", "\[IndentingNewLine]", 
        
        RowBox[{"values", "=", 
         RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "NEEDIC", "]"}], ">", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"nextvar", " ", "=", " ", 
            RowBox[{"First", "[", "NEEDIC", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"NEEDIC", " ", "=", " ", 
            RowBox[{"Rest", "[", "NEEDIC", "]"}]}], ";", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"cellParent", " ", "=", " ", 
            RowBox[{
             RowBox[{"firstArg", "[", "nextvar", "]"}], "/.", 
             "cellparents"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"edgeParent", " ", "=", " ", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"nargs", "[", "nextvar", "]"}], ">", "1"}], ",", 
               RowBox[{"secondArg", "[", "nextvar", "]"}], ",", "0"}], "]"}], 
             "/.", "edgeparents"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"cellParent", "\[NotEqual]", " ", "0"}], ",", " ", 
             RowBox[{"nextvar", " ", "=", " ", 
              RowBox[{"replaceFirstArg", "[", 
               RowBox[{"nextvar", ",", "cellParent"}], "]"}]}]}], "]"}], ";", 
           " ", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"edgeParent", "\[NotEqual]", " ", "0"}], ",", " ", 
             RowBox[{"nextvar", " ", "=", " ", 
              RowBox[{"replaceSecondArg", "[", 
               RowBox[{"nextvar", ",", " ", "edgeParent"}], "]"}]}]}], "]"}], 
           ";", " ", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"values", ",", " ", "nextvar"}], "]"}], ";"}]}], " ", 
         "\[IndentingNewLine]", "]"}], ";"}]}], " ", "\[IndentingNewLine]", 
      "]"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{
      "\"\<values from (using parent cells and edges): \>\"", ",", " ", 
       "values"}], "]"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"values", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", "[", "Global`t", "]"}], "/.", "s"}], ")"}], "&"}], "/@",
          "values"}], ")"}], "/.", 
       RowBox[{"{", 
        RowBox[{"Global`t", "\[Rule]", "tend"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{
      "\"\<values (mostly almost numerical): \>\"", ",", " ", "values"}], 
      "]"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"values", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"NumberQ", "[", "#", "]"}], ",", "#", ",", "0.0"}], "]"}], 
        "&"}], "/@", "values"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"only", " ", "entirely", " ", "de"}], "-", 
       RowBox[{"novo", " ", "edges", " ", "should", " ", "be", " ", "non"}], 
       "-", 
       RowBox[{"numerical", " ", "at", " ", "this", " ", "point"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<values (entirely numerical): \>\"", ",", " ", "values"}], 
      "]"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"icneeded", " ", "=", " ", 
      RowBox[{"MapThread", "[", 
       RowBox[{"Rule", ",", " ", 
        RowBox[{"{", 
         RowBox[{"icneeded", ",", " ", "values"}], "}"}]}], "]"}]}], ";", " ",
      "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<icneeded: \>\"", ",", " ", "icneeded"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"icell", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{"Rule", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ell", "/@", "eneeded"}], ",", "lvalsneeded"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"icarea", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{"Rule", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"area", "/@", "cellnumbers"}], ",", 
          RowBox[{"areafunction", "[", "Tnew", "]"}]}], "}"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"icx", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{"Rule", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "/@", "vneeded"}], ",", 
          RowBox[{"First", "/@", "xyused"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"icy", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{"Rule", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"y", "/@", "vneeded"}], ",", 
          RowBox[{"Last", "/@", "xyused"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"ic", " ", "=", " ", 
      RowBox[{"Join", "[", 
       RowBox[{
       "icfromsim", ",", "icrnew", ",", "  ", "icneeded", ",", " ", "icell", 
        ",", " ", "icarea", ",", " ", "icx", ",", "icy"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"IC", " ", "for", " ", "ell", " ", "added", " ", "separately"}],
       " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "[", "ell", "]"}], "\[NotEqual]", " ", 
        "\"\<False\>\""}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"EVIC", "=", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"InputForm", "[", "equations", "]"}], "]"}], ",", 
             RowBox[{"\"\<[t]\>\"", "\[Rule]", " ", "\"\<\>\""}]}], "]"}], 
           "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{"Equal", "\[Rule]", " ", "Rule"}], "}"}]}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"EVIC", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"EVIC", ",", " ", 
           RowBox[{
            RowBox[{"Or", "[", 
             RowBox[{
              RowBox[{"ThingEndsWith", "[", 
               RowBox[{"#", ",", "ell", ",", "\"\<X\>\""}], "]"}], ",", " ", 
              RowBox[{"ThingEndsWith", "[", 
               RowBox[{"#", ",", "ell", ",", "\"\<Y\>\""}], "]"}]}], "]"}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"EVIC", " ", "=", " ", 
         RowBox[{
          RowBox[{"EVIC", "/.", "icx"}], "/.", "icy"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ic", " ", "=", " ", 
         RowBox[{"Join", "[", 
          RowBox[{"ic", ",", " ", "EVIC"}], "]"}]}], ";"}]}], " ", 
      "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "[", "center", "]"}], "\[Equal]", "  ", 
        "\"\<False\>\""}], ",", "\[IndentingNewLine]", 
       RowBox[{"centerIC", "=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"centerIC", " ", "=", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"InputForm", "[", "equations", "]"}], "]"}], ",", 
             RowBox[{"\"\<[t]\>\"", "\[Rule]", " ", "\"\<\>\""}]}], "]"}], 
           "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{"Equal", "\[Rule]", " ", "Rule"}], "}"}]}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"centerIC", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"centerIC", ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"Head", "[", 
               RowBox[{"First", "[", "#", "]"}], "]"}], "]"}], "\[Equal]", 
             RowBox[{"ToString", "[", "center", "]"}]}], "&"}]}], "]"}]}], 
        ";", " ", "\[IndentingNewLine]", 
        RowBox[{"centerIC", " ", "=", " ", 
         RowBox[{"(", 
          RowBox[{"centerIC", "/.", "ic"}], ")"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ic", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"ic", ",", "centerIC"}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "[", "PD", "]"}], "\[Equal]", "\"\<False\>\""}], 
       ",", " ", "\[IndentingNewLine]", 
       RowBox[{"PDIC", "=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"PDIC", "=", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"InputForm", "[", "equations", "]"}], "]"}], ",", 
             RowBox[{"\"\<[t]\>\"", "\[Rule]", " ", "\"\<\>\""}]}], "]"}], 
           "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{"Equal", "\[Rule]", " ", "Rule"}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"PDIC", "=", 
           RowBox[{"Select", "[", 
            RowBox[{"PDIC", ",", " ", 
             RowBox[{
              RowBox[{"Or", "[", 
               RowBox[{
                RowBox[{"ThingEndsWith", "[", 
                 RowBox[{"#", ",", "PD", ",", "\"\<A\>\""}], "]"}], ",", " ", 
                
                RowBox[{"ThingEndsWith", "[", 
                 RowBox[{"#", ",", "PD", ",", "\"\<B\>\""}], "]"}], ",", " ", 
                
                RowBox[{"ThingEndsWith", "[", 
                 RowBox[{"#", ",", " ", "PD", ",", "\"\<D\>\""}], "]"}], ",", 
                " ", 
                RowBox[{"ThingEndsWith", "[", 
                 RowBox[{"#", ",", "PD", ",", "\"\<X\>\""}], "]"}], ",", " ", 
                
                RowBox[{"ThingEndsWith", "[", 
                 RowBox[{"#", ",", " ", "PD", " ", ",", "\"\<Y\>\""}], "]"}], 
                ",", " ", 
                RowBox[{"ThingEndsWith", "[", 
                 RowBox[{"#", ",", " ", "PD", ",", " ", "\"\<EV1\>\""}], 
                 "]"}], ",", " ", 
                RowBox[{"ThingEndsWith", "[", 
                 RowBox[{"#", ",", " ", "PD", ",", " ", "\"\<EV2\>\""}], 
                 "]"}], ",", " ", 
                RowBox[{"ThingEndsWith", "[", 
                 RowBox[{"#", ",", " ", "PD", ",", " ", "\"\<MAXEV\>\""}], 
                 "]"}], ",", " ", 
                RowBox[{"ThingEndsWith", "[", 
                 RowBox[{"#", ",", "PD", ",", "\"\<NORM\>\""}], "]"}], ",", 
                " ", 
                RowBox[{"ThingEndsWith", "[", 
                 RowBox[{"#", ",", " ", "PD", ",", " ", "\"\<UNITX\>\""}], 
                 "]"}], ",", " ", 
                RowBox[{"ThingEndsWith", "[", 
                 RowBox[{"#", ",", " ", "PD", ",", " ", "\"\<UNITY\>\""}], 
                 "]"}]}], "]"}], "&"}]}], "]"}]}], ";"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"PDIC", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"PDIC", ",", " ", 
           RowBox[{
            RowBox[{"ThingsStartWith", "[", 
             RowBox[{"#", ",", "PD"}], "]"}], "&"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Block", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"LHS", ",", " ", "RHS"}], "}"}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"PDIC", " ", "=", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"PDIC", "/.", "centerIC"}], "/.", "icx"}], "/.", 
             "icy"}]}], ";", " ", "\[IndentingNewLine]", 
           RowBox[{"RHS", " ", "=", " ", 
            RowBox[{"Last", "/@", "PDIC"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"LHS", " ", "=", " ", 
            RowBox[{"First", "/@", "PDIC"}]}], ";", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"PDIC", " ", "=", " ", 
            RowBox[{"MapThread", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#1", "\[Rule]", " ", "#2"}], "&"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"LHS", ",", " ", "RHS"}], "}"}]}], "]"}]}], ";", " ", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"RHS", " ", "=", " ", 
            RowBox[{"RHS", "//.", "PDIC"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"PDIC", " ", "=", " ", 
            RowBox[{"MapThread", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#1", "\[Rule]", " ", "#2"}], "&"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"LHS", ",", " ", "RHS"}], "}"}]}], "]"}]}], ";", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"ic", " ", "=", " ", 
            RowBox[{"Join", "[", 
             RowBox[{"ic", ",", " ", "PDIC"}], "]"}]}], ";"}]}], " ", 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"ticrules", " ", "=", " ", 
      RowBox[{"equations", "/.", 
       RowBox[{"{", 
        RowBox[{"Equal", "\[Rule]", " ", "Rule"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tic", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"tip", "[", "1", "]"}], "[", "Global`t", "]"}], ",", 
         RowBox[{
          RowBox[{"tip", "[", "2", "]"}], "[", "Global`t", "]"}]}], "}"}], "/.",
        "ticrules"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tic", "=", 
      RowBox[{"1.0", "*", 
       RowBox[{"ToExpression", "[", 
        RowBox[{"StringReplace", "[", 
         RowBox[{
          RowBox[{"ToString", "[", 
           RowBox[{"InputForm", "[", "tic", "]"}], "]"}], ",", 
          RowBox[{"\"\<[t]\>\"", "\[Rule]", " ", "\"\<\>\""}]}], "]"}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tic", "=", 
      RowBox[{
       RowBox[{"tic", "/.", "icx"}], "/.", "icy"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tic", " ", "=", " ", 
      RowBox[{"MapThread", "[", 
       RowBox[{"Rule", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"tip", "[", "1", "]"}], ",", 
            RowBox[{"tip", "[", "2", "]"}]}], "}"}], ",", "tic"}], "}"}]}], 
       "]"}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"ic", " ", "=", " ", 
      RowBox[{"Join", "[", 
       RowBox[{"ic", ",", " ", "tic"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "[", "perim", "]"}], "\[Equal]", "  ", 
        "\"\<False\>\""}], ",", "\[IndentingNewLine]", 
       RowBox[{"perimIC", "=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"perimIC", " ", "=", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"InputForm", "[", "equations", "]"}], "]"}], ",", 
             RowBox[{"\"\<[t]\>\"", "\[Rule]", " ", "\"\<\>\""}]}], "]"}], 
           "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{"Equal", "\[Rule]", " ", "Rule"}], "}"}]}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"perimIC", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"perimIC", ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"Head", "[", 
               RowBox[{"First", "[", "#", "]"}], "]"}], "]"}], "\[Equal]", 
             RowBox[{"ToString", "[", "perim", "]"}]}], "&"}]}], "]"}]}], ";",
         " ", "\[IndentingNewLine]", 
        RowBox[{"perimIC", " ", "=", " ", 
         RowBox[{"(", 
          RowBox[{"perimIC", "/.", "ic"}], ")"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ic", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"ic", ",", " ", "perimIC"}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "[", "tipdist", "]"}], "\[Equal]", "  ", 
        "\"\<False\>\""}], ",", "\[IndentingNewLine]", 
       RowBox[{"tipdistIC", "=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tipdistIC", " ", "=", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"InputForm", "[", "equations", "]"}], "]"}], ",", 
             RowBox[{"\"\<[t]\>\"", "\[Rule]", " ", "\"\<\>\""}]}], "]"}], 
           "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{"Equal", "\[Rule]", " ", "Rule"}], "}"}]}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"tipdistIC", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"tipdistIC", ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"Head", "[", 
               RowBox[{"First", "[", "#", "]"}], "]"}], "]"}], "\[Equal]", 
             RowBox[{"ToString", "[", "tipdist", "]"}]}], "&"}]}], "]"}]}], 
        ";", " ", "\[IndentingNewLine]", 
        RowBox[{"tipdistIC", " ", "=", " ", 
         RowBox[{"(", 
          RowBox[{"tipdistIC", "/.", "ic"}], ")"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ic", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"ic", ",", "tipdistIC"}], "]"}]}], ";"}]}], " ", 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"muvar", " ", "=", " ", "mu"}], ";", " ", "\[IndentingNewLine]", 
     
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ListQ", "[", "muvar", "]"}], ",", " ", 
       RowBox[{"muvar", "=", 
        RowBox[{"First", "[", "muvar", "]"}]}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"IsotropicGrowth", ",", "\[IndentingNewLine]", 
       RowBox[{"muic", "=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"muic", " ", "=", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"InputForm", "[", "equations", "]"}], "]"}], ",", 
             RowBox[{"\"\<[t]\>\"", "\[Rule]", " ", "\"\<\>\""}]}], "]"}], 
           "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{"Equal", "\[Rule]", " ", "Rule"}], "}"}]}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"muic", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"muic", ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"Head", "[", 
               RowBox[{"First", "[", "#", "]"}], "]"}], "]"}], "\[Equal]", 
             RowBox[{"ToString", "[", "muvar", "]"}]}], "&"}]}], "]"}]}], ";",
         " ", "\[IndentingNewLine]", 
        RowBox[{"muic", " ", "=", " ", 
         RowBox[{"(", 
          RowBox[{"muic", "/.", "ic"}], ")"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ic", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"ic", ",", "muic"}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"kvar", " ", "=", " ", "k"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ListQ", "[", "kvar", "]"}], ",", " ", 
       RowBox[{"kvar", "=", 
        RowBox[{"First", "[", "kvar", "]"}]}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"IsotropicSprings", ",", "\[IndentingNewLine]", 
       RowBox[{"kic", "=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"kic", " ", "=", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"InputForm", "[", "equations", "]"}], "]"}], ",", 
             RowBox[{"\"\<[t]\>\"", "\[Rule]", " ", "\"\<\>\""}]}], "]"}], 
           "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{"Equal", "\[Rule]", " ", "Rule"}], "}"}]}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"kic", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"kic", ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"Head", "[", 
               RowBox[{"First", "[", "#", "]"}], "]"}], "]"}], "\[Equal]", 
             RowBox[{"ToString", "[", "kvar", "]"}]}], "&"}]}], "]"}]}], ";", 
        " ", "\[IndentingNewLine]", 
        RowBox[{"kic", " ", "=", " ", 
         RowBox[{"(", 
          RowBox[{"kic", "/.", "ic"}], ")"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ic", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"ic", ",", "kic"}], "]"}]}], ";"}]}], " ", 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Pvar", " ", "=", " ", "P"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ListQ", "[", "Pvar", "]"}], ",", " ", 
       RowBox[{"Pvar", "=", 
        RowBox[{"First", "[", "Pvar", "]"}]}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"IsotropicGrowth", ",", "\[IndentingNewLine]", 
       RowBox[{"PressureIC", "=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"PressureIC", " ", "=", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"InputForm", "[", "equations", "]"}], "]"}], ",", 
             RowBox[{"\"\<[t]\>\"", "\[Rule]", " ", "\"\<\>\""}]}], "]"}], 
           "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{"Equal", "\[Rule]", " ", "Rule"}], "}"}]}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"PressureIC", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"PressureIC", ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"Head", "[", 
               RowBox[{"First", "[", "#", "]"}], "]"}], "]"}], "\[Equal]", 
             RowBox[{"ToString", "[", "Pvar", "]"}]}], "&"}]}], "]"}]}], ";", 
        " ", "\[IndentingNewLine]", 
        RowBox[{"PressureIC", " ", "=", " ", 
         RowBox[{"(", 
          RowBox[{"PressureIC", "/.", "ic"}], ")"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"ic", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"ic", ",", "PressureIC"}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<PressureIC=\>\"", ",", " ", "PressureIC"}], "]"}], ";", 
     " ", "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "[", "L1", "]"}], "\[NotEqual]", "   ", 
        "\"\<False\>\""}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"L1IC", " ", "=", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"InputForm", "[", "equations", "]"}], "]"}], ",", 
             RowBox[{"\"\<[t]\>\"", "\[Rule]", " ", "\"\<\>\""}]}], "]"}], 
           "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{"Equal", "\[Rule]", " ", "Rule"}], "}"}]}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"L1IC", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"L1IC", ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"Head", "[", 
               RowBox[{"First", "[", "#", "]"}], "]"}], "]"}], "\[Equal]", 
             RowBox[{"ToString", "[", "L1", "]"}]}], "&"}]}], "]"}]}], ";", 
        " ", "\[IndentingNewLine]", 
        RowBox[{"ic", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"ic", ",", " ", "L1IC"}], "]"}]}], ";"}]}], " ", 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "[", "L2", "]"}], "\[NotEqual]", "   ", 
        "\"\<False\>\""}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"L2IC", " ", "=", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"InputForm", "[", "equations", "]"}], "]"}], ",", 
             RowBox[{"\"\<[t]\>\"", "\[Rule]", " ", "\"\<\>\""}]}], "]"}], 
           "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{"Equal", "\[Rule]", " ", "Rule"}], "}"}]}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"L2IC", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"L2IC", ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"Head", "[", 
               RowBox[{"First", "[", "#", "]"}], "]"}], "]"}], "\[Equal]", 
             RowBox[{"ToString", "[", "L2", "]"}]}], "&"}]}], "]"}]}], ";", 
        " ", "\[IndentingNewLine]", 
        RowBox[{"ic", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"ic", ",", " ", "L2IC"}], "]"}]}], ";"}]}], " ", 
      "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "[", "TIPF", "]"}], "\[NotEqual]", "   ", 
        "\"\<False\>\""}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"TIPFIC", " ", "=", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"InputForm", "[", "equations", "]"}], "]"}], ",", 
             RowBox[{"\"\<[t]\>\"", "\[Rule]", " ", "\"\<\>\""}]}], "]"}], 
           "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{"Equal", "\[Rule]", " ", "Rule"}], "}"}]}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"TIPFIC", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"TIPFIC", ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"Head", "[", 
               RowBox[{"First", "[", "#", "]"}], "]"}], "]"}], "\[Equal]", 
             RowBox[{"ToString", "[", "TIPF", "]"}]}], "&"}]}], "]"}]}], ";", 
        " ", "\[IndentingNewLine]", 
        RowBox[{"ic", " ", "=", " ", 
         RowBox[{"Join", "[", 
          RowBox[{"ic", ",", " ", "TIPFIC"}], "]"}]}], ";"}]}], " ", 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"ic", "/.", "parameters"}], "]"}], ";"}]}], " ", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5473070066129513`*^9, 3.547307128406706*^9}, {
   3.5473072149414883`*^9, 3.547307219995573*^9}, {3.547307261639817*^9, 
   3.5473074400524607`*^9}, {3.5473074732076197`*^9, 3.547307708887987*^9}, {
   3.547307743406663*^9, 3.547307782756831*^9}, {3.5473082678533783`*^9, 
   3.547308394222533*^9}, {3.547308449055037*^9, 3.547308450522706*^9}, {
   3.54730848547683*^9, 3.54730872459022*^9}, {3.5473088138625793`*^9, 
   3.5473089508559103`*^9}, {3.547308981803686*^9, 3.5473090265785227`*^9}, {
   3.5473267016953487`*^9, 3.547326703763381*^9}, {3.5473267532667294`*^9, 
   3.547326901245923*^9}, {3.5473270244682007`*^9, 3.547327031945115*^9}, {
   3.5473270817952223`*^9, 3.547327082296729*^9}, {3.547327129043442*^9, 
   3.5473271790942163`*^9}, {3.547327444723197*^9, 3.547327662733241*^9}, {
   3.547327692734456*^9, 3.5473280553893843`*^9}, {3.5473280875595903`*^9, 
   3.547328111147633*^9}, {3.547328152591428*^9, 3.547328316124106*^9}, {
   3.547328397550828*^9, 3.5473286452308702`*^9}, {3.547475880781336*^9, 
   3.5474759178518248`*^9}, {3.547475975825163*^9, 3.547476038303568*^9}, 
   3.547476125992387*^9, {3.5474761822358*^9, 3.5474761838374577`*^9}, {
   3.547476265769596*^9, 3.547476364209834*^9}, {3.547476894428*^9, 
   3.547476898084844*^9}, {3.547476933865077*^9, 3.5474774051242847`*^9}, {
   3.547477499128295*^9, 3.5474775093564243`*^9}, {3.547477546334111*^9, 
   3.5474775827245903`*^9}, {3.547477614467671*^9, 3.547477678055942*^9}, {
   3.547477731877515*^9, 3.54747790070811*^9}, {3.547478018486253*^9, 
   3.5474780310397243`*^9}, {3.5475669006048803`*^9, 3.547566917132221*^9}, {
   3.547654058694508*^9, 3.5476540687243757`*^9}, {3.547654100920888*^9, 
   3.5476541108467407`*^9}, {3.547654155600482*^9, 3.547654164405158*^9}, {
   3.5476542819535513`*^9, 3.547654288122122*^9}, {3.547654339512864*^9, 
   3.547654339986538*^9}, {3.54765456734203*^9, 3.547654694527611*^9}, {
   3.547654899726116*^9, 3.547654936040786*^9}, {3.5476550133195963`*^9, 
   3.547655028464218*^9}, {3.547655115039654*^9, 3.54765512721583*^9}, {
   3.547655165190177*^9, 3.547655210850456*^9}, {3.547655243342054*^9, 
   3.547655244094643*^9}, {3.5476553218459473`*^9, 3.5476554071261463`*^9}, {
   3.547655515266768*^9, 3.547655530402464*^9}, {3.547655674352449*^9, 
   3.547655691508966*^9}, {3.54765574761228*^9, 3.547655761928316*^9}, {
   3.5476558173855667`*^9, 3.5476558343929787`*^9}, {3.547655869375781*^9, 
   3.547655961715127*^9}, {3.547656743806754*^9, 3.547656791877784*^9}, {
   3.5476568382562847`*^9, 3.547656864299013*^9}, {3.547656908381549*^9, 
   3.5476571416773233`*^9}, {3.547657276861305*^9, 3.547657325798751*^9}, {
   3.547657390565583*^9, 3.547657525041321*^9}, {3.547657564568748*^9, 
   3.547657598027007*^9}, {3.5476577724779243`*^9, 3.547657786520687*^9}, {
   3.547657819988632*^9, 3.547657848184939*^9}, {3.547657900369938*^9, 
   3.547657906026061*^9}, {3.5476579364789658`*^9, 3.5476580099347887`*^9}, {
   3.547658062815977*^9, 3.54765807931385*^9}, {3.547658151047868*^9, 
   3.54765816216041*^9}, {3.5476582282352743`*^9, 3.547658233881097*^9}, {
   3.5476582646171722`*^9, 3.5476582800176277`*^9}, {3.547658362195462*^9, 
   3.547658633199253*^9}, {3.547659021483718*^9, 3.547659045675652*^9}, {
   3.547659077111504*^9, 3.54765909572328*^9}, {3.5476606570600653`*^9, 
   3.547660682706092*^9}, {3.547660739782518*^9, 3.547660740341707*^9}, {
   3.547661120612912*^9, 3.547661179699706*^9}, {3.547661292839727*^9, 
   3.5476615759112988`*^9}, {3.547661626062277*^9, 3.547661769386973*^9}, {
   3.5476619383261557`*^9, 3.547662031539168*^9}, 3.547662064105748*^9, {
   3.547662113064567*^9, 3.5476622218748083`*^9}, {3.547662326138857*^9, 
   3.547662391076016*^9}, {3.547662439870755*^9, 3.547662458535997*^9}, 
   3.547662488807282*^9, {3.547662563781794*^9, 3.547662575773057*^9}, {
   3.547662676435441*^9, 3.547662725585187*^9}, {3.547667015778617*^9, 
   3.5476670338837013`*^9}, {3.547667296792938*^9, 3.5476673233247538`*^9}, {
   3.547667361582684*^9, 3.5476674077368307`*^9}, {3.547667451483513*^9, 
   3.547667452221933*^9}, {3.547667482873581*^9, 3.547667561251203*^9}, {
   3.547667606142084*^9, 3.547667653092898*^9}, {3.547727718656872*^9, 
   3.547727719133947*^9}, {3.547728125571082*^9, 3.547728170482678*^9}, {
   3.547729046388287*^9, 3.5477290465330267`*^9}, {3.547939149889682*^9, 
   3.5479391513785143`*^9}, {3.547939661637631*^9, 3.54793967886506*^9}, {
   3.547939710025578*^9, 3.547939784332316*^9}, {3.54793988965793*^9, 
   3.547939972086403*^9}, {3.5479400818904257`*^9, 3.547940082658354*^9}, {
   3.547943699266011*^9, 3.547943702641893*^9}, {3.547943755408513*^9, 
   3.547943759096932*^9}, 3.549028336273829*^9, {3.549028440904323*^9, 
   3.549028487043501*^9}, {3.549028565688705*^9, 3.549028674956951*^9}, {
   3.549028827945339*^9, 3.549028828176317*^9}, {3.54902891583348*^9, 
   3.549028924162487*^9}, {3.549028969156583*^9, 3.549028972378392*^9}, {
   3.5490290470147533`*^9, 3.549029160309226*^9}, {3.549029238581518*^9, 
   3.54902950602853*^9}, {3.5490297504690657`*^9, 3.549029760659232*^9}, 
   3.5490298301278276`*^9, {3.5490299574675913`*^9, 3.5490301862818327`*^9}, {
   3.549030321560424*^9, 3.549030324831727*^9}, {3.5490305906305428`*^9, 
   3.549030606618154*^9}, {3.549030708537719*^9, 3.549030815159183*^9}, {
   3.549030892870207*^9, 3.5490309536057262`*^9}, {3.5490311426350307`*^9, 
   3.549031172497583*^9}, {3.549063105438382*^9, 3.549063114432931*^9}, {
   3.549063144940545*^9, 3.5490631714026003`*^9}, {3.556721580214465*^9, 
   3.5567216309216537`*^9}, {3.556721768608819*^9, 3.556721791848872*^9}, {
   3.5567231902534857`*^9, 3.5567233590565023`*^9}, {3.571007939599609*^9, 
   3.571007946703259*^9}, {3.571008146925234*^9, 3.5710081535134077`*^9}, {
   3.571008200584043*^9, 3.571008218329607*^9}, {3.571008300125885*^9, 
   3.57100831793742*^9}, {3.571008394112796*^9, 3.571008411573827*^9}, {
   3.571008452395197*^9, 3.571008521457541*^9}, {3.571008552818718*^9, 
   3.5710085592959414`*^9}, {3.571008610611821*^9, 3.57100862794416*^9}, {
   3.571059733111968*^9, 3.571059736405658*^9}, {3.571059804168091*^9, 
   3.571059804973935*^9}, {3.571059887085011*^9, 3.571059947085307*^9}, {
   3.571060447967238*^9, 3.5710605145717993`*^9}, {3.571060677362763*^9, 
   3.5710607030968113`*^9}, {3.5723924354478903`*^9, 3.572392438270801*^9}, {
   3.5723931350204372`*^9, 3.5723931957162952`*^9}, {3.5723948390077887`*^9, 
   3.5723948769048367`*^9}, {3.572394961187047*^9, 3.5723950479047117`*^9}, {
   3.572395103265808*^9, 3.5723951216791267`*^9}, {3.572395787765943*^9, 
   3.572395804310783*^9}, {3.572397657935482*^9, 3.572397661291313*^9}, {
   3.572458953585079*^9, 3.572458998677967*^9}, {3.5740304466712914`*^9, 
   3.57403044787932*^9}, {3.574030697069916*^9, 3.5740306987211018`*^9}, {
   3.57403077251966*^9, 3.574030801875655*^9}, {3.574031798552511*^9, 
   3.574031799770338*^9}, {3.574031877166367*^9, 3.574031897971821*^9}, {
   3.574032525176436*^9, 3.574032527023239*^9}, {3.574032611042243*^9, 
   3.574032656570413*^9}, {3.5740330778776073`*^9, 3.574033082823442*^9}, {
   3.574033311613757*^9, 3.574033334937046*^9}, {3.574033417314595*^9, 
   3.574033449481393*^9}, {3.5740348265543613`*^9, 3.574034833557325*^9}, {
   3.574035029636745*^9, 3.57403506273174*^9}, {3.575233919986703*^9, 
   3.575233994838851*^9}, {3.575234312518259*^9, 3.575234330253248*^9}, {
   3.575236185297628*^9, 3.5752362163738194`*^9}, {3.576010227569965*^9, 
   3.5760102322980213`*^9}, {3.576010348662519*^9, 3.576010349268774*^9}, {
   3.577543594411043*^9, 3.5775436634169283`*^9}, {3.577543708451536*^9, 
   3.57754371308813*^9}, {3.5776388919993258`*^9, 3.577638903863121*^9}, {
   3.5776389378440104`*^9, 3.577639085110527*^9}, {3.577639116429641*^9, 
   3.5776391171111317`*^9}, {3.577639206496624*^9, 3.577639210579129*^9}, 
   3.577654886005278*^9, {3.577654922155261*^9, 3.577654948768779*^9}, {
   3.577655540461149*^9, 3.577655542584734*^9}, {3.5776555887581987`*^9, 
   3.577655627382512*^9}, {3.577737371783593*^9, 3.5777373785821342`*^9}, {
   3.577737418874919*^9, 3.577737429112371*^9}, {3.705711610759891*^9, 
   3.705711614891056*^9}},ExpressionUUID->"80a090ce-6d2c-40d3-8dc2-\
0a2964e16ee6"]
}, Closed]],

Cell[CellGroupData[{

Cell["SetRandomizedIC", "Subsection",
 CellChangeTimes->{{3.546697713592167*^9, 
  3.546697718585281*^9}},ExpressionUUID->"81fc0916-adff-4bf9-952a-\
db4a6ee75b4e"],

Cell["\<\
ell, area, resting, x, y are variable names used in model
extension is initial extension (fixed for all cells): later version, should \
be an array
rmin, rmax: range of values used for randomizing all other variables in odes

Some input IC may be provided, but some values may be overrided, such as \
initial edge lengths. 

Return values: initial conditions\
\>", "Text",
 CellChangeTimes->{{3.546697751656848*^9, 3.546697813623908*^9}, {
  3.5477290551961203`*^9, 3.547729060531234*^9}, {3.5477292971422873`*^9, 
  3.547729317619111*^9}},ExpressionUUID->"f8e9f0a7-c116-4e76-bb43-\
dc3a84b08a34"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DEBUG$IC", "=", "False"}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ThingIs", "[", 
     RowBox[{"thing_", ",", " ", "val_"}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{"Head", "[", 
       RowBox[{"First", "[", "thing", "]"}], "]"}], "]"}], "\[Equal]", 
     RowBox[{"ToString", "[", "val", "]"}]}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ThingEndsWith", "[", 
     RowBox[{"thing_", ",", "val_", ",", "end_"}], "]"}], ":=", " ", 
    RowBox[{"ThingIs", "[", 
     RowBox[{"thing", ",", " ", 
      RowBox[{
       RowBox[{"ToString", "[", "val", "]"}], "<>", "end"}]}], "]"}]}], ";"}],
   " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ThingsStartWith", "[", 
    RowBox[{"thing_", ",", " ", "val_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", ",", "v", ",", "hft"}], "}"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"v", "=", 
       RowBox[{"ToString", "[", "val", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"StringLength", "[", "v", "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"hft", "=", 
       RowBox[{"ToString", "[", 
        RowBox[{"Head", "[", 
         RowBox[{"First", "[", "thing", "]"}], "]"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"StringLength", "[", "hft", "]"}], "<", "n"}], ",", " ", 
        RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{"hft", ",", "n"}], "]"}], "\[Equal]", "v"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetRandomizedIC", "[", 
   RowBox[{"INPUTIC_", ",", " ", 
    RowBox[{"tissue_", "?", "DTissueQ"}], ",", "network_", ",", " ", 
    "equations_", ",", " ", "ell_", ",", "area_", ",", "resting_", ",", "x_", 
    ",", "y_", ",", "extension_", ",", "rmin_", ",", "rmax_", ",", " ", 
    "IsotropicGrowth_", ",", " ", "mu_", ",", " ", "IsotropicSprings_", ",", 
    " ", "k_", ",", " ", "tip_", ",", "center_", ",", " ", "tipdist_", ",", 
    " ", "perim_", ",", " ", "P_", ",", " ", "growing_", ",", " ", "L1_", ",",
     " ", "L2_", ",", " ", "TIPF_", ",", " ", "PD_", ",", " ", 
    "parameters_"}], "]"}], " ", ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "species", ",", "r", ",", "ic", ",", "v", ",", "vall", ",", "e", ",", 
      "ne", ",", "nv", ",", "eused", ",", "vused", ",", " ", "eflags", ",", 
      "vflags", ",", "xyused", ",", "vneeded", ",", "lvalsneeded", ",", 
      "eneeded", ",", " ", "cellnumbers", ",", " ", "icout", ",", 
      RowBox[{"dbg", "=", "False"}], ",", " ", "dPrint", ",", "el", ",", 
      "restingic", ",", "ARandomValue", ",", " ", "muic", ",", "ineeded", ",",
       " ", "ellic", ",", " ", "xic", ",", " ", "yic", ",", "kic", ",", " ", 
      "kvar", ",", " ", "speciesIC", ",", "tic", ",", "ticrules", ",", 
      "muvar", ",", " ", "areaic", ",", "centerIC", ",", " ", "perimIC", ",", 
      " ", "tipdistIC", ",", " ", "PressureIC", ",", " ", "Pvar", ",", " ", 
      "L1IC", ",", " ", "L2IC", ",", " ", "TIPFIC", ",", " ", "PDIC", ",", 
      " ", "EVIC"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"dPrint", "[", "u___", "]"}], ":=", " ", 
      RowBox[{"If", "[", 
       RowBox[{"dbg", ",", " ", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<SetRandomizedIC: \>\"", ",", " ", "u"}], "]"}]}], 
       "]"}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"DEBUG$IC", ",", " ", 
       RowBox[{"dbg", "=", "True"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"eused", "=", 
      RowBox[{"EdgesUsed", "[", "tissue", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"vused", " ", "=", " ", 
      RowBox[{"VerticesUsed", "[", "tissue", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"ne", "=", 
      RowBox[{"NTissueEdges", "[", "tissue", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"nv", "=", 
      RowBox[{"NTissueVertices", "[", "tissue", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"eflags", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"eused", ",", "#"}], "]"}], "&"}], "/@", 
       RowBox[{"Range", "[", "ne", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vflags", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"vused", ",", "#"}], "]"}], "&"}], "/@", 
       RowBox[{"Range", "[", "nv", "]"}]}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"cellnumbers", "=", 
      RowBox[{"First", "/@", 
       RowBox[{"TissueCells", "[", "tissue", "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"eneeded", " ", "=", " ", 
      RowBox[{"Pick", "[", 
       RowBox[{
        RowBox[{"Range", "[", "ne", "]"}], ",", "eflags"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<eneeded:\>\"", ",", " ", "eneeded"}], "]"}], ";", "  ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"el", "  ", "=", 
      RowBox[{"EdgeLengths", "[", "tissue", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"lvalsneeded", " ", "=", " ", 
      RowBox[{"Pick", "[", 
       RowBox[{"el", ",", "eflags"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "the", " ", "user", " ", "may", " ", "have", " ", "supplied", " ", 
        "some", " ", "resting", " ", "lengths"}], ",", " ", 
       RowBox[{"rev", " ", "9.15", ".12"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"restingic", " ", "=", 
      RowBox[{"Map", "[", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"resting", "[", "#", "]"}], "\[Rule]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"resting", "[", "#", "]"}], "/.", "INPUTIC"}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"resting", "[", "#", "]"}], "\[Rule]", " ", 
               RowBox[{
                RowBox[{"el", "[", 
                 RowBox[{"[", "#", "]"}], "]"}], "/", "extension"}]}], 
              "}"}]}], ")"}]}], ")"}], "&"}], ",", " ", "eneeded"}], "]"}]}], 
     ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<restingic: \>\"", ",", " ", "restingic"}], "]"}], ";", " ",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"vall", " ", "=", " ", 
      RowBox[{"TissueVertices", "[", "tissue", "]"}]}], ";", "  ", 
     "\[IndentingNewLine]", 
     RowBox[{"vneeded", "=", 
      RowBox[{"Pick", "[", 
       RowBox[{
        RowBox[{"Range", "[", "nv", "]"}], ",", "vflags"}], "]"}]}], ";", " ",
      "\[IndentingNewLine]", 
     RowBox[{"xyused", "=", 
      RowBox[{"Pick", "[", 
       RowBox[{"vall", ",", "vflags"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"ineeded", "=", 
      RowBox[{
       RowBox[{"interpret", "[", "network", "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"species", "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"interpret", "[", "network", "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "ell", ",", "area", ",", "resting", ",", "x", ",", "y", ",", 
              "mu"}], "}"}], ",", 
            RowBox[{"Head", "[", "#", "]"}]}], "]"}], "]"}], "&"}]}], "]"}]}],
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"r", ":=", 
        RowBox[{"Random", "[", 
         RowBox[{"Real", ",", 
          RowBox[{"{", 
           RowBox[{"rmin", ",", "rmax"}], "}"}]}], "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"rmax", ">", "rmin"}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{"ARandomValue", ":=", " ", 
        RowBox[{"Random", "[", 
         RowBox[{"Real", ",", 
          RowBox[{"{", 
           RowBox[{"rmin", ",", "rmax"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ARandomValue", ":=", " ", "rmin"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"r", "[", "s_", "]"}], ":=", " ", 
      RowBox[{
       RowBox[{"s", "/.", "INPUTIC"}], "/.", 
       RowBox[{"{", 
        RowBox[{"s", "\[Rule]", " ", "ARandomValue"}], "}"}]}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"speciesIC", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"#", "\[Rule]", 
          RowBox[{"r", "[", "#", "]"}]}], ")"}], "&"}], "/@", "species"}]}], 
     ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"ellic", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{"Rule", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ell", "/@", "eneeded"}], ",", "lvalsneeded"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"xic", "=", 
      RowBox[{"yic", "=", 
       RowBox[{"{", "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"ToString", "[", "x", "]"}], "\[NotEqual]", " ", 
         "\"\<False\>\""}], " ", "\[And]", " ", 
        RowBox[{
         RowBox[{"ToString", "[", "y", "]"}], "\[NotEqual]", " ", 
         "\"\<False\>\""}]}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xic", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Rule", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x", "/@", "vneeded"}], ",", 
             RowBox[{"First", "/@", "xyused"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"yic", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Rule", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"y", "/@", "vneeded"}], ",", 
             RowBox[{"Last", "/@", "xyused"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"xic", " ", "=", " ", 
         RowBox[{"xic", "/.", "speciesIC"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"yic", " ", "=", " ", 
         RowBox[{"yic", "/.", "speciesIC"}]}], ";"}]}], "\[IndentingNewLine]",
       "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"EVIC", "=", 
      RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "[", "ell", "]"}], "\[NotEqual]", " ", 
        "\"\<False\>\""}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"EVIC", "=", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"InputForm", "[", "equations", "]"}], "]"}], ",", 
             RowBox[{"\"\<[t]\>\"", "\[Rule]", " ", "\"\<\>\""}]}], "]"}], 
           "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{"Equal", "\[Rule]", " ", "Rule"}], "}"}]}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"EVIC", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"EVIC", ",", " ", 
           RowBox[{
            RowBox[{"Or", "[", 
             RowBox[{
              RowBox[{"ThingEndsWith", "[", 
               RowBox[{"#", ",", "ell", ",", "\"\<X\>\""}], "]"}], ",", " ", 
              RowBox[{"ThingEndsWith", "[", 
               RowBox[{"#", ",", "ell", ",", "\"\<Y\>\""}], "]"}]}], "]"}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"EVIC", " ", "=", " ", 
         RowBox[{
          RowBox[{"EVIC", "/.", "xic"}], "/.", "yic"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<ellic=\>\"", ",", " ", "ellic"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<xic=\>\"", ",", " ", "xic"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<yic=\>\"", ",", " ", "yic"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "[", "area", "]"}], "\[Equal]", "\"\<False\>\""}],
        ",", " ", "\[IndentingNewLine]", 
       RowBox[{"areaic", "=", 
        RowBox[{"{", "}"}]}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{"areaic", " ", "=", " ", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"area", "/@", "cellnumbers"}], ",", 
            RowBox[{"areafunction", "[", "tissue", "]"}]}], "}"}]}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<areaic=\>\"", ",", " ", "areaic"}], "]"}], ";", "  ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "[", "center", "]"}], "\[Equal]", "  ", 
        "\"\<False\>\""}], ",", "\[IndentingNewLine]", 
       RowBox[{"centerIC", "=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"centerIC", " ", "=", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"InputForm", "[", "equations", "]"}], "]"}], ",", 
             RowBox[{"\"\<[t]\>\"", "\[Rule]", " ", "\"\<\>\""}]}], "]"}], 
           "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{"Equal", "\[Rule]", " ", "Rule"}], "}"}]}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"centerIC", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"centerIC", ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"Head", "[", 
               RowBox[{"First", "[", "#", "]"}], "]"}], "]"}], "\[Equal]", 
             RowBox[{"ToString", "[", "center", "]"}]}], "&"}]}], "]"}]}], 
        ";", " ", "\[IndentingNewLine]", 
        RowBox[{"centerIC", " ", "=", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"centerIC", "/.", "xic"}], "/.", "yic"}], "/.", 
           "areaic"}], ")"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "[", "PD", "]"}], "\[Equal]", "\"\<False\>\""}], 
       ",", " ", "\[IndentingNewLine]", 
       RowBox[{"PDIC", "=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"PDIC", "=", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"InputForm", "[", "equations", "]"}], "]"}], ",", 
             RowBox[{"\"\<[t]\>\"", "\[Rule]", " ", "\"\<\>\""}]}], "]"}], 
           "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{"Equal", "\[Rule]", " ", "Rule"}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"dPrint", "[", 
         RowBox[{"\"\<PDIC: \>\"", ",", " ", 
          RowBox[{"Short", "[", 
           RowBox[{"PDIC", ",", "10"}], "]"}]}], "]"}], ";", " ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"PDIC", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"PDIC", ",", " ", 
           RowBox[{
            RowBox[{"ThingsStartWith", "[", 
             RowBox[{"#", ",", "PD"}], "]"}], "&"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dPrint", "[", 
         RowBox[{"\"\<First/@PDIC: \>\"", ",", " ", 
          RowBox[{"Short", "[", 
           RowBox[{
            RowBox[{"First", "/@", "PDIC"}], ",", " ", "10"}], "]"}]}], "]"}],
         ";", "  ", "\[IndentingNewLine]", 
        RowBox[{"Block", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"LHS", ",", " ", "RHS"}], "}"}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"PDIC", " ", "=", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"PDIC", "/.", "centerIC"}], "/.", "xic"}], "/.", 
             "yic"}]}], ";", " ", "\[IndentingNewLine]", 
           RowBox[{"RHS", " ", "=", " ", 
            RowBox[{"Last", "/@", "PDIC"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"LHS", " ", "=", " ", 
            RowBox[{"First", "/@", "PDIC"}]}], ";", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"PDIC", " ", "=", " ", 
            RowBox[{"MapThread", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#1", "\[Rule]", " ", "#2"}], "&"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"LHS", ",", " ", "RHS"}], "}"}]}], "]"}]}], ";", " ", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"RHS", " ", "=", " ", 
            RowBox[{"RHS", "//.", "PDIC"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"PDIC", " ", "=", " ", 
            RowBox[{"MapThread", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#1", "\[Rule]", " ", "#2"}], "&"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"LHS", ",", " ", "RHS"}], "}"}]}], "]"}]}], ";", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"dPrint", "[", 
            RowBox[{"\"\<PDIC: \>\"", ",", 
             RowBox[{"Short", "[", " ", 
              RowBox[{"PDIC", ",", "10"}], "]"}]}], "]"}], ";"}]}], " ", 
         "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "[", "tip", "]"}], "\[Equal]", "\"\<False\>\""}], 
       ",", " ", "\[IndentingNewLine]", 
       RowBox[{"tic", "=", 
        RowBox[{"{", "}"}]}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ticrules", " ", "=", " ", 
         RowBox[{"equations", "/.", 
          RowBox[{"{", 
           RowBox[{"Equal", "\[Rule]", " ", "Rule"}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tic", "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"tip", "[", "1", "]"}], "[", "Global`t", "]"}], ",", 
            RowBox[{
             RowBox[{"tip", "[", "2", "]"}], "[", "Global`t", "]"}]}], "}"}], 
          "/.", "ticrules"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tic", "=", 
         RowBox[{"1.0", "*", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"InputForm", "[", "tic", "]"}], "]"}], ",", 
             RowBox[{"\"\<[t]\>\"", "\[Rule]", " ", "\"\<\>\""}]}], "]"}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"tic", "=", 
         RowBox[{
          RowBox[{"tic", "/.", "xic"}], "/.", "yic"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tic", " ", "=", " ", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Rule", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"tip", "[", "1", "]"}], ",", 
               RowBox[{"tip", "[", "2", "]"}]}], "}"}], ",", "tic"}], "}"}]}],
           "]"}]}], ";"}]}], " ", "\[IndentingNewLine]", "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "[", "perim", "]"}], "\[Equal]", "  ", 
        "\"\<False\>\""}], ",", "\[IndentingNewLine]", 
       RowBox[{"perimIC", "=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"perimIC", " ", "=", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"InputForm", "[", "equations", "]"}], "]"}], ",", 
             RowBox[{"\"\<[t]\>\"", "\[Rule]", " ", "\"\<\>\""}]}], "]"}], 
           "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{"Equal", "\[Rule]", " ", "Rule"}], "}"}]}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"perimIC", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"perimIC", ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"Head", "[", 
               RowBox[{"First", "[", "#", "]"}], "]"}], "]"}], "\[Equal]", 
             RowBox[{"ToString", "[", "perim", "]"}]}], "&"}]}], "]"}]}], ";",
         " ", "\[IndentingNewLine]", 
        RowBox[{"perimIC", " ", "=", " ", 
         RowBox[{"(", 
          RowBox[{"perimIC", "/.", "ellic"}], ")"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "[", "tipdist", "]"}], "\[Equal]", "  ", 
        "\"\<False\>\""}], ",", "\[IndentingNewLine]", 
       RowBox[{"tipdistIC", "=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tipdistIC", " ", "=", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"InputForm", "[", "equations", "]"}], "]"}], ",", 
             RowBox[{"\"\<[t]\>\"", "\[Rule]", " ", "\"\<\>\""}]}], "]"}], 
           "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{"Equal", "\[Rule]", " ", "Rule"}], "}"}]}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"tipdistIC", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"tipdistIC", ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"Head", "[", 
               RowBox[{"First", "[", "#", "]"}], "]"}], "]"}], "\[Equal]", 
             RowBox[{"ToString", "[", "tipdist", "]"}]}], "&"}]}], "]"}]}], 
        ";", " ", "\[IndentingNewLine]", 
        RowBox[{"tipdistIC", " ", "=", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"tipdistIC", "/.", "tic"}], "/.", "centerIC"}], ")"}]}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"kvar", " ", "=", " ", "k"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ListQ", "[", "kvar", "]"}], ",", " ", 
       RowBox[{"kvar", "=", 
        RowBox[{"First", "[", "kvar", "]"}]}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"IsotropicSprings", ",", "\[IndentingNewLine]", 
       RowBox[{"kic", "=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"kic", " ", "=", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"InputForm", "[", "equations", "]"}], "]"}], ",", 
             RowBox[{"\"\<[t]\>\"", "\[Rule]", " ", "\"\<\>\""}]}], "]"}], 
           "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{"Equal", "\[Rule]", " ", "Rule"}], "}"}]}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"kic", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"kic", ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"Head", "[", 
               RowBox[{"First", "[", "#", "]"}], "]"}], "]"}], "\[Equal]", 
             RowBox[{"ToString", "[", "kvar", "]"}]}], "&"}]}], "]"}]}], ";", 
        " ", "\[IndentingNewLine]", 
        RowBox[{"kic", " ", "=", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"kic", "/.", "ellic"}], "/.", "xic"}], "/.", 
                  "yic"}], "/.", "speciesIC"}], "/.", "centerIC"}], "/.", 
               "perimIC"}], "/.", "tipdistIC"}], "/.", "areaic"}], "/.", 
            "EVIC"}], "/.", "PDIC"}], ")"}]}]}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<kic=\>\"", ",", " ", "kic"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"muvar", " ", "=", " ", "mu"}], ";", " ", "\[IndentingNewLine]", 
     
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ListQ", "[", "muvar", "]"}], ",", " ", 
       RowBox[{"muvar", "=", 
        RowBox[{"First", "[", "muvar", "]"}]}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"IsotropicGrowth", ",", "\[IndentingNewLine]", 
       RowBox[{"muic", "=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"muic", " ", "=", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"InputForm", "[", "equations", "]"}], "]"}], ",", 
             RowBox[{"\"\<[t]\>\"", "\[Rule]", " ", "\"\<\>\""}]}], "]"}], 
           "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{"Equal", "\[Rule]", " ", "Rule"}], "}"}]}]}], ";", " ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<muic: \>\"", ",", " ", "muic"}], "]"}], ";"}], " ", 
         "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"muic", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"muic", ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"Head", "[", 
               RowBox[{"First", "[", "#", "]"}], "]"}], "]"}], "\[Equal]", 
             RowBox[{"ToString", "[", "muvar", "]"}]}], "&"}]}], "]"}]}], ";",
         " ", "\[IndentingNewLine]", 
        RowBox[{"muic", " ", "=", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"muic", "/.", "ellic"}], "/.", "xic"}], "/.", 
                  "yic"}], "/.", "speciesIC"}], "/.", "centerIC"}], "/.", 
               "perimIC"}], "/.", "tipdistIC"}], "/.", "areaic"}], "/.", 
            "EVIC"}], "/.", "PDIC"}], ")"}]}], ";"}]}], "\[IndentingNewLine]",
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Pvar", " ", "=", " ", "P"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ListQ", "[", "Pvar", "]"}], ",", " ", 
       RowBox[{"Pvar", "=", 
        RowBox[{"First", "[", "Pvar", "]"}]}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"IsotropicGrowth", ",", "\[IndentingNewLine]", 
       RowBox[{"PressureIC", "=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"PressureIC", " ", "=", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"InputForm", "[", "equations", "]"}], "]"}], ",", 
             RowBox[{"\"\<[t]\>\"", "\[Rule]", " ", "\"\<\>\""}]}], "]"}], 
           "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{"Equal", "\[Rule]", " ", "Rule"}], "}"}]}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"PressureIC", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"PressureIC", ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"Head", "[", 
               RowBox[{"First", "[", "#", "]"}], "]"}], "]"}], "\[Equal]", 
             RowBox[{"ToString", "[", "Pvar", "]"}]}], "&"}]}], "]"}]}], ";", 
        " ", "\[IndentingNewLine]", 
        RowBox[{"PressureIC", " ", "=", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"PressureIC", "/.", "ellic"}], "/.", "xic"}], "/.", 
                "yic"}], "/.", "speciesIC"}], "/.", "centerIC"}], "/.", 
             "perimIC"}], "/.", "tipdistIC"}], "/.", "areaic"}], ")"}]}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<PressureIC=\>\"", ",", " ", "PressureIC"}], "]"}], ";", 
     " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "[", "L1", "]"}], "\[Equal]", "  ", 
        "\"\<False\>\""}], ",", "\[IndentingNewLine]", 
       RowBox[{"L1IC", "=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"L1IC", " ", "=", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"InputForm", "[", "equations", "]"}], "]"}], ",", 
             RowBox[{"\"\<[t]\>\"", "\[Rule]", " ", "\"\<\>\""}]}], "]"}], 
           "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{"Equal", "\[Rule]", " ", "Rule"}], "}"}]}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"L1IC", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"L1IC", ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"Head", "[", 
               RowBox[{"First", "[", "#", "]"}], "]"}], "]"}], "\[Equal]", 
             RowBox[{"ToString", "[", "L1", "]"}]}], "&"}]}], "]"}]}], 
        ";"}]}], " ", "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "[", "L2", "]"}], "\[Equal]", "  ", 
        "\"\<False\>\""}], ",", "\[IndentingNewLine]", 
       RowBox[{"L2IC", "=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"L2IC", " ", "=", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"InputForm", "[", "equations", "]"}], "]"}], ",", 
             RowBox[{"\"\<[t]\>\"", "\[Rule]", " ", "\"\<\>\""}]}], "]"}], 
           "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{"Equal", "\[Rule]", " ", "Rule"}], "}"}]}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"L2IC", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"L2IC", ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"Head", "[", 
               RowBox[{"First", "[", "#", "]"}], "]"}], "]"}], "\[Equal]", 
             RowBox[{"ToString", "[", "L2", "]"}]}], "&"}]}], "]"}]}], 
        ";"}]}], " ", "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "[", "TIPF", "]"}], "\[Equal]", "  ", 
        "\"\<False\>\""}], ",", "\[IndentingNewLine]", 
       RowBox[{"TIPFIC", "=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"TIPFIC", " ", "=", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"InputForm", "[", "equations", "]"}], "]"}], ",", 
             RowBox[{"\"\<[t]\>\"", "\[Rule]", " ", "\"\<\>\""}]}], "]"}], 
           "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{"Equal", "\[Rule]", " ", "Rule"}], "}"}]}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"TIPFIC", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"TIPFIC", ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"Head", "[", 
               RowBox[{"First", "[", "#", "]"}], "]"}], "]"}], "\[Equal]", 
             RowBox[{"ToString", "[", "TIPF", "]"}]}], "&"}]}], "]"}]}], 
        ";"}]}], " ", "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"ic", " ", "=", " ", 
      RowBox[{"Join", "[", 
       RowBox[{
       "speciesIC", ",", " ", "xic", ",", " ", "yic", ",", " ", "areaic", ",",
         "  ", "tic", ",", " ", "centerIC", ",", " ", "tipdistIC", ",", " ", 
        "L1IC", ",", " ", "L2IC", ",", " ", "TIPFIC", ",", " ", "PDIC"}], 
       "]"}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"growing", ",", " ", "\[IndentingNewLine]", 
       RowBox[{"ic", " ", "=", " ", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
          "ic", ",", " ", "ellic", ",", " ", "EVIC", ",", " ", "restingic", 
           ",", " ", "muic", ",", "kic", ",", "perimIC", ",", " ", 
           "PressureIC"}], "]"}], "/.", "parameters"}]}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "ic", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.546697727481743*^9, 3.546697733857855*^9}, {
   3.54705093815097*^9, 3.5470511226162252`*^9}, {3.547051156988194*^9, 
   3.547051278950324*^9}, {3.547051384577284*^9, 3.547051392608356*^9}, {
   3.5470514480992117`*^9, 3.547051715676673*^9}, {3.547051752662362*^9, 
   3.54705179834588*^9}, {3.547139593554887*^9, 3.547139664033948*^9}, {
   3.547310832888687*^9, 3.547310839757053*^9}, {3.5477290759068527`*^9, 
   3.547729084632036*^9}, {3.547729291563253*^9, 3.547729293393162*^9}, {
   3.547729354507653*^9, 3.547729399410922*^9}, {3.547729464100747*^9, 
   3.547729561850081*^9}, {3.547729803839826*^9, 3.547729809343788*^9}, {
   3.5567189251609373`*^9, 3.556718962985456*^9}, {3.556719186037722*^9, 
   3.55671919787236*^9}, {3.556719229602633*^9, 3.55671934563134*^9}, {
   3.5567195154883127`*^9, 3.556719876111713*^9}, {3.556719911868423*^9, 
   3.556719964610034*^9}, {3.556720079635957*^9, 3.556720084469809*^9}, {
   3.5568839074902*^9, 3.556883989427002*^9}, {3.5710056884240303`*^9, 
   3.571005689254232*^9}, {3.571005798081134*^9, 3.5710059883166227`*^9}, {
   3.5710060468556337`*^9, 3.5710060620107527`*^9}, {3.5710061498228416`*^9, 
   3.5710061634830837`*^9}, {3.571006240353056*^9, 3.571006301636602*^9}, {
   3.571006336656887*^9, 3.571006354648179*^9}, {3.5710064158821383`*^9, 
   3.571006476656986*^9}, {3.571006611476343*^9, 3.571006743417405*^9}, {
   3.571006785425075*^9, 3.571006794938767*^9}, {3.5710068702798243`*^9, 
   3.571007003175845*^9}, {3.571059748503295*^9, 3.5710597526231413`*^9}, {
   3.571059821635351*^9, 3.571059822344171*^9}, {3.571059964168292*^9, 
   3.571059992338711*^9}, {3.571060524062254*^9, 3.571060592709985*^9}, {
   3.572136070396706*^9, 3.572136262603733*^9}, {3.572136317887829*^9, 
   3.5721363338680553`*^9}, {3.572136400443247*^9, 3.5721364540680323`*^9}, {
   3.572136542633493*^9, 3.572136640027734*^9}, {3.5723921390966587`*^9, 
   3.5723921397445297`*^9}, {3.572392421206925*^9, 3.572392424181429*^9}, {
   3.572392546662723*^9, 3.572392769716002*^9}, {3.572392806642602*^9, 
   3.5723928357588787`*^9}, {3.572392870155055*^9, 3.5723930429504747`*^9}, {
   3.572393076795393*^9, 3.5723930775858393`*^9}, {3.572395730847327*^9, 
   3.572395763239176*^9}, {3.5723958379900913`*^9, 3.5723958386043177`*^9}, {
   3.5723959088238564`*^9, 3.572396033664495*^9}, {3.572396064008251*^9, 
   3.5723960708786697`*^9}, {3.5723961723884697`*^9, 
   3.5723962102728167`*^9}, {3.5723962783751907`*^9, 3.5723962842397327`*^9}, 
   3.57239636544823*^9, {3.572396398444662*^9, 3.572396398694854*^9}, {
   3.5723964661141253`*^9, 3.5723964965373163`*^9}, {3.5723965329780083`*^9, 
   3.57239653710647*^9}, {3.5723967347729387`*^9, 3.572396747848473*^9}, {
   3.572396797407846*^9, 3.572396800906271*^9}, {3.572397700011222*^9, 
   3.572397759349955*^9}, {3.5724590044876223`*^9, 3.572459033565391*^9}, {
   3.572459233119604*^9, 3.572459233679047*^9}, {3.572459309644907*^9, 
   3.572459318666836*^9}, {3.5724593690296917`*^9, 3.572459375100263*^9}, {
   3.5724594596677513`*^9, 3.572459465705243*^9}, {3.574030201186091*^9, 
   3.5740302052546*^9}, {3.5740302504503717`*^9, 3.57403025111547*^9}, {
   3.574030330654207*^9, 3.57403034750718*^9}, {3.574030435293104*^9, 
   3.574030436261263*^9}, {3.574030484542198*^9, 3.574030689726153*^9}, {
   3.574031814736698*^9, 3.574031868442932*^9}, {3.5740325366417522`*^9, 
   3.5740325983401403`*^9}, {3.574032705578977*^9, 3.574032707028247*^9}, {
   3.5740330415159073`*^9, 3.5740330454475822`*^9}, {3.574033119705832*^9, 
   3.57403312910909*^9}, {3.574033165414879*^9, 3.5740332776890993`*^9}, {
   3.574033363492841*^9, 3.57403336551031*^9}, {3.574034796101186*^9, 
   3.574034817573188*^9}, {3.574034852690445*^9, 3.5740348707593737`*^9}, {
   3.57403491234247*^9, 3.5740350170837107`*^9}, {3.574707252381352*^9, 
   3.5747073335090847`*^9}, {3.5747084533778563`*^9, 
   3.5747084635513983`*^9}, {3.574808351499752*^9, 3.574808352140111*^9}, {
   3.5748084495454187`*^9, 3.574808477790311*^9}, {3.5748085183956013`*^9, 
   3.574808555486454*^9}, {3.574808593187109*^9, 3.57480863650314*^9}, {
   3.574811002765923*^9, 3.5748110050497227`*^9}, {3.574811082669138*^9, 
   3.574811107045274*^9}, {3.5748111401743107`*^9, 3.574811142879302*^9}, {
   3.5748111825329103`*^9, 3.574811185655748*^9}, {3.5748112424229813`*^9, 
   3.574811242862578*^9}, {3.574811941592512*^9, 3.5748119477043743`*^9}, {
   3.575233688348649*^9, 3.575233703844576*^9}, {3.5752337344822206`*^9, 
   3.575233753581677*^9}, {3.575233856777602*^9, 3.575233905487945*^9}, {
   3.575234082103134*^9, 3.5752340947336817`*^9}, {3.575234148234679*^9, 
   3.575234160071225*^9}, {3.575234228341344*^9, 3.575234293480901*^9}, 
   3.575234352464281*^9, {3.57523612924195*^9, 3.575236172039456*^9}, {
   3.575492396123418*^9, 3.5754924344319143`*^9}, {3.576004972840509*^9, 
   3.576005093369392*^9}, {3.57600512562713*^9, 3.57600513546457*^9}, {
   3.576005787189786*^9, 3.576005826031364*^9}, {3.5760072298961983`*^9, 
   3.576007231311346*^9}, {3.576007389816577*^9, 3.576007446949304*^9}, {
   3.576010377000661*^9, 3.57601040314716*^9}, {3.576011797069751*^9, 
   3.576011811055359*^9}, 3.577541354918672*^9, {3.577541470280636*^9, 
   3.577541583323677*^9}, {3.577541618564218*^9, 3.577541664475684*^9}, {
   3.577541701395527*^9, 3.5775419950631943`*^9}, {3.577542051818557*^9, 
   3.577542056320547*^9}, {3.577542102927718*^9, 3.5775421305558653`*^9}, {
   3.5775423035268517`*^9, 3.5775423159364223`*^9}, {3.5775423874300203`*^9, 
   3.577542455115429*^9}, {3.577542494269187*^9, 3.577542494915913*^9}, {
   3.577542549771832*^9, 3.577542605862953*^9}, {3.577542702850451*^9, 
   3.577542717287972*^9}, {3.5775427937000437`*^9, 3.577542817681246*^9}, {
   3.577542926871488*^9, 3.577542968519643*^9}, {3.577543002205242*^9, 
   3.577543062369677*^9}, {3.5775431308688726`*^9, 3.5775431354432907`*^9}, {
   3.577543165993023*^9, 3.577543204866518*^9}, {3.577543321307448*^9, 
   3.577543327096442*^9}, {3.5776372001942997`*^9, 3.57763721673059*^9}, {
   3.577639149366139*^9, 3.577639192801372*^9}, {3.5776395168320723`*^9, 
   3.577639522918487*^9}, {3.577639647235669*^9, 3.577639650500084*^9}, {
   3.577639706307795*^9, 3.577639733325226*^9}, {3.577639804662054*^9, 
   3.577639856932076*^9}, {3.5776398959483*^9, 3.577639918305458*^9}, {
   3.577654664099032*^9, 3.5776546900254097`*^9}, {3.577654735797793*^9, 
   3.577654780947884*^9}, 3.577654996796899*^9, {3.577655190661128*^9, 
   3.577655205710086*^9}, {3.5776553531027822`*^9, 3.57765536161629*^9}, {
   3.577655455711948*^9, 3.577655485503706*^9}, {3.577736014849217*^9, 
   3.577736041163493*^9}, {3.577736074715295*^9, 3.577736085923498*^9}, 
   3.5777361369050617`*^9, {3.577736182515086*^9, 3.577736231086659*^9}, {
   3.5777362705801973`*^9, 3.577736422716407*^9}, {3.577736464572597*^9, 
   3.5777365168570423`*^9}, {3.577736565912408*^9, 3.5777365803394403`*^9}, {
   3.577736770901223*^9, 3.5777367881542788`*^9}, {3.5777368468666553`*^9, 
   3.5777368598717003`*^9}, {3.57773692744604*^9, 3.577736938674561*^9}, 
   3.577736968968813*^9, {3.577737069228508*^9, 3.577737097287174*^9}, {
   3.577737162745491*^9, 3.577737202573105*^9}, {3.577737251479759*^9, 
   3.577737349835073*^9}, {3.57773746898251*^9, 3.577737489925522*^9}, 
   3.57773752650294*^9, {3.5783436985016623`*^9, 3.5783436988299103`*^9}, {
   3.5783437448544683`*^9, 3.57834375142087*^9}, {3.578343853935212*^9, 
   3.578343902213441*^9}, {3.5783439460451193`*^9, 3.57834401896985*^9}, 
   3.578344072074692*^9, {3.57834413078473*^9, 3.5783441489435587`*^9}, 
   3.578344190095366*^9, {3.578345358902733*^9, 3.578345394105006*^9}, {
   3.5783454973728027`*^9, 3.578345531233696*^9}, 3.578345757186709*^9, {
   3.705712993504281*^9, 
   3.7057129948876743`*^9}},ExpressionUUID->"4c71b58c-5464-479c-b16a-\
3bae4bc4b6de"]
}, Closed]],

Cell[CellGroupData[{

Cell["ShowInitialRates", "Subsection",
 CellChangeTimes->{{3.545393069375175*^9, 
  3.545393071390671*^9}},ExpressionUUID->"8d26237f-79cb-43e7-bc16-\
84b5321e7c8d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ShowInitialRates", "[", 
   RowBox[{
   "eqs_", ",", " ", "ic_", ",", " ", "rates_", ",", " ", 
    "BoundaryConditions_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"iclist", ",", " ", "BC"}], " ", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"eqs", "=", 
       RowBox[{
        RowBox[{"interpret", "[", "network", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", "J"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"iclist", " ", "=", 
      RowBox[{"ic", "/.", 
       RowBox[{"{", 
        RowBox[{"Rule", "\[Rule]", " ", "List"}], "}"}]}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"iclist", " ", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Rule", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", "Global`t", "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}], "/@", "iclist"}]}],
      " ", ";", "\[IndentingNewLine]", 
     RowBox[{"BC", " ", "=", " ", 
      RowBox[{"BoundaryConditions", "/.", 
       RowBox[{"{", 
        RowBox[{"Rule", "\[Rule]", " ", "List"}], "}"}]}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"BC", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Rule", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", "0", "]"}], "[", "Global`t",
            "]"}], ",", " ", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}], "/@", "BC"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"eqs", "/.", "iclist"}], "/.", "rates"}], "/.", "BC"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5453930825779448`*^9, 3.545393170151609*^9}, 
   3.545393403626408*^9, 3.545393438895796*^9, {3.5453934740698*^9, 
   3.545393579318824*^9}, 3.5453936179964333`*^9, {3.5453936658894672`*^9, 
   3.545393755865182*^9}, {3.547938710054387*^9, 3.547938721784101*^9}, 
   3.5479444697515078`*^9},ExpressionUUID->"09515ee4-6d7c-4e32-95e9-\
3ba0a4be002f"]
}, Closed]],

Cell[CellGroupData[{

Cell["HasSufficientInfo", "Subsection",
 CellChangeTimes->{{3.545071228596382*^9, 
  3.545071231265535*^9}},ExpressionUUID->"d6fce2cd-79db-4940-ae5f-\
f80db65cbd78"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"$DebugHasSufficientInfo", "=", "False"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HasSufficientInfo", "[", 
    RowBox[{
    "network_", ",", "equations_", ",", " ", "ic_", ",", "parameters_", ",", 
     "growing_", ",", " ", "x_", ",", " ", "y_", ",", " ", "cell_", ",", " ", 
     "ReturnString_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eq", ",", "species"}], "}"}], ",", " ", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"eq", ",", "species"}], "}"}], "=", 
       RowBox[{"interpret", "[", "network", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"HasSufficientInfo", "[", 
       RowBox[{
       "eq", ",", "species", ",", "equations", ",", " ", "ic", ",", 
        "parameters", ",", "growing", ",", "x", ",", " ", "y", ",", "  ", 
        "cell", ",", " ", "ReturnString"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HasSufficientInfo", "[", 
   RowBox[{
   "eq_", ",", "species_", ",", "equations_", ",", " ", "ic_", ",", "parms_", 
    ",", "growing_", ",", "x_", ",", " ", "y_", ",", "  ", "cell_", ",", " ", 
    "ReturnString_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "speciesr1", ",", "icr1", ",", "vals", ",", "ok", ",", "okstring", ",", 
      " ", "problem", ",", "xsp", ",", "xspt", ",", "r1", ",", "xr1", ",", 
      "xr2", ",", "eqlhs", ",", "eqrhs", ",", " ", "ir", ",", "OK", ",", 
      "rok", ",", 
      RowBox[{"dbg", "=", "$DebugHasSufficientInfo"}], ",", "dPrint", ",", 
      " ", "parameters", ",", " ", "APRATES"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"parameters", " ", "=", " ", "parms"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dPrint", "[", "u___", "]"}], ":=", " ", 
      RowBox[{"If", "[", 
       RowBox[{"dbg", ",", " ", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<HasSufficientInfo: \>\"", ",", " ", "u"}], "]"}]}], 
       "]"}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<eq: \>\"", ",", " ", 
       RowBox[{"Short", "[", 
        RowBox[{"eq", ",", "5"}], "]"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<parameters = \>\"", ",", " ", "parameters"}], "]"}], ";", 
     " ", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<species = \>\"", ",", " ", 
       RowBox[{"Short", "[", 
        RowBox[{"species", ",", "3"}], "]"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<equations = \>\"", ",", " ", 
       RowBox[{"Short", "[", 
        RowBox[{"equations", ",", "3"}], "]"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"APRATES", "=", 
      RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"growing", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Block", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "APIC", ",", " ", "APRHS", ",", "APLHS", ",", "myx", ",", " ", 
            "xir", ",", " ", "yir", ",", " ", "aprules"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"APIC", "=", 
            RowBox[{"Select", "[", 
             RowBox[{"equations", ",", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"ToString", "[", 
                 RowBox[{"Head", "[", 
                  RowBox[{"Head", "[", 
                   RowBox[{"First", "[", "#", "]"}], "]"}], "]"}], "]"}], 
                "\[Equal]", 
                RowBox[{"ToString", "[", "cell", "]"}]}], "&"}]}], "]"}]}], 
           ";", " ", "\[IndentingNewLine]", 
           RowBox[{"APLHS", " ", "=", " ", 
            RowBox[{"First", "/@", "APIC"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"APRHS", " ", "=", " ", 
            RowBox[{"InputForm", "[", 
             RowBox[{"(", 
              RowBox[{"Last", "/@", "APIC"}], ")"}], "]"}]}], ";", " ", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"APRHS", "=", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"StringReplace", "[", 
              RowBox[{
               RowBox[{"ToString", "[", "APRHS", "]"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"\"\<[t]\>\"", "\[Rule]", " ", "\"\<'[t]\>\""}], " ", 
                "}"}]}], "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
           RowBox[{"dPrint", "[", 
            RowBox[{"\"\<APRHS: \>\"", ",", " ", 
             RowBox[{"Short", "[", 
              RowBox[{"APRHS", ",", " ", "5"}], "]"}]}], "]"}], ";", " ", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"ir", "=", 
            RowBox[{"ShowInitialRates", "[", 
             RowBox[{"eq", ",", "ic", ",", "parameters", ",", 
              RowBox[{"{", "}"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
           
           RowBox[{"xir", " ", "=", " ", 
            RowBox[{"Select", "[", 
             RowBox[{"ir", ",", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"ToString", "[", 
                 RowBox[{"Head", "[", 
                  RowBox[{"First", "[", 
                   RowBox[{"Head", "[", 
                    RowBox[{"First", "[", "#", "]"}], "]"}], "]"}], "]"}], 
                 "]"}], "\[Equal]", 
                RowBox[{"ToString", "[", "x", "]"}]}], "&"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"yir", " ", "=", " ", 
            RowBox[{"Select", "[", 
             RowBox[{"ir", ",", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"ToString", "[", 
                 RowBox[{"Head", "[", 
                  RowBox[{"First", "[", 
                   RowBox[{"Head", "[", 
                    RowBox[{"First", "[", "#", "]"}], "]"}], "]"}], "]"}], 
                 "]"}], "\[Equal]", 
                RowBox[{"ToString", "[", "y", "]"}]}], "&"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"xir", " ", "=", " ", 
            RowBox[{"(", 
             RowBox[{"xir", "/.", 
              RowBox[{"{", 
               RowBox[{"Equal", "\[Rule]", " ", "Rule"}], "}"}]}], ")"}]}], 
           ";", " ", "\[IndentingNewLine]", 
           RowBox[{"yir", " ", "=", " ", 
            RowBox[{"(", 
             RowBox[{"yir", " ", "/.", " ", 
              RowBox[{"{", 
               RowBox[{"Equal", " ", "\[Rule]", " ", "Rule"}], "}"}]}], 
             ")"}]}], ";", " ", "\[IndentingNewLine]", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"dPrint", "[", 
            RowBox[{"\"\<xir=\>\"", ",", " ", 
             RowBox[{"Short", "[", 
              RowBox[{"xir", ",", "5"}], "]"}]}], "]"}], ";", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"dPrint", "[", 
            RowBox[{"\"\<yir=\>\"", ",", " ", 
             RowBox[{"Short", "[", 
              RowBox[{"yir", ",", " ", "5"}], "]"}]}], "]"}], ";", " ", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"APRHS", " ", "=", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"APRHS", "/.", "xir"}], "/.", "yir"}], ")"}]}], ";", 
           " ", "\[IndentingNewLine]", 
           RowBox[{"dPrint", "[", 
            RowBox[{"\"\<APRHS: \>\"", ",", " ", 
             RowBox[{"Short", "[", 
              RowBox[{"APRHS", ",", " ", "5"}], "]"}]}], "]"}], ";", " ", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"APLHS", "=", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"StringReplace", "[", 
              RowBox[{
               RowBox[{"ToString", "[", "APLHS", "]"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"\"\<[t]\>\"", "\[Rule]", " ", "\"\<'[t]\>\""}], " ", 
                "}"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"dPrint", "[", 
            RowBox[{"\"\<APLHS: \>\"", ",", " ", 
             RowBox[{"Short", "[", 
              RowBox[{"APLHS", ",", " ", "5"}], "]"}]}], "]"}], ";", " ", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"APRATES", " ", "=", " ", 
            RowBox[{"MapThread", "[", 
             RowBox[{"Equal", ",", " ", 
              RowBox[{"{", 
               RowBox[{"APLHS", ",", " ", "APRHS"}], "}"}]}], "]"}]}], ";", 
           " ", "\[IndentingNewLine]", 
           RowBox[{"dPrint", "[", 
            RowBox[{"\"\<APRATES: \>\"", ",", " ", 
             RowBox[{"Short", "[", 
              RowBox[{"APRATES", ",", " ", "5"}], "]"}]}], "]"}], ";", " ", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"aprules", " ", "=", " ", 
            RowBox[{"APRATES", "/.", 
             RowBox[{"{", 
              RowBox[{"Equal", "\[Rule]", " ", "Rule"}], "}"}]}]}], ";", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"dPrint", "[", 
            RowBox[{"\"\<aprules: \>\"", ",", " ", 
             RowBox[{"Short", "[", 
              RowBox[{"aprules", ",", " ", "5"}], "]"}]}], "]"}], ";", " ", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"parameters", " ", "=", " ", 
            RowBox[{"Join", "[", 
             RowBox[{"parameters", ",", " ", "aprules"}], "]"}]}], ";"}]}], 
         " ", "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"xspt", " ", "=", " ", 
      RowBox[{"First", "/@", "equations"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"xsp", "=", " ", 
      RowBox[{"Head", "/@", "xspt"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"xr1", " ", "=", " ", 
      RowBox[{"MapThread", "[", 
       RowBox[{"Rule", ",", 
        RowBox[{"{", 
         RowBox[{"xsp", ",", "xspt"}], "}"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"r1", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"#", "\[Rule]", " ", 
          RowBox[{"#", "[", "Global`t", "]"}]}], ")"}], "&"}], "/@", 
       "species"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"r1", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"r1", ",", "xr1"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"icr1", "=", 
      RowBox[{"ic", "/.", "r1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<ic: \>\"", ",", " ", 
       RowBox[{"Short", "[", 
        RowBox[{"ic", ",", "3"}], "]"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<icr1: \>\"", ",", " ", 
       RowBox[{"Short", "[", 
        RowBox[{"icr1", ",", "3"}], "]"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "if", " ", "variables", " ", "in", " ", "equations", " ", "have", " ", 
       "ic", " ", "this", " ", 
       RowBox[{"won", "'"}], "t", " ", "be", " ", "necessary", " ", "to", " ",
        "check", " ", "but", " ", "it", " ", 
       RowBox[{"shouldn", "'"}], "t", " ", "hurt"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"eqlhs", " ", "=", " ", 
      RowBox[{"First", "/@", "equations"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<eqlhs: \>\"", ",", " ", 
       RowBox[{"Short", "[", 
        RowBox[{"eqlhs", ",", "3"}], "]"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"eqrhs", " ", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", " ", 
         RowBox[{"Last", "/@", "equations"}], ")"}], "/.", "icr1"}], "/.", 
       "parameters"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<eqrhs: \>\"", ",", " ", 
       RowBox[{"Short", "[", 
        RowBox[{"eqrhs", ",", "3"}], "]"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"xr2", " ", "=", " ", 
      RowBox[{"MapThread", "[", 
       RowBox[{"Rule", ",", 
        RowBox[{"{", 
         RowBox[{"eqlhs", ",", "eqrhs"}], "}"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<xr2: \>\"", ",", " ", 
       RowBox[{"Short", "[", 
        RowBox[{"xr2", ",", "3"}], "]"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"vals", "=", 
      RowBox[{"Last", "/@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"eq", "/.", 
           RowBox[{"(", "icr1", ")"}]}], ")"}], "/.", "parameters"}], 
        ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<vals: \>\"", ",", " ", 
       RowBox[{"Short", "[", 
        RowBox[{"vals", ",", "3"}], "]"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"vals", " ", "=", " ", 
      RowBox[{
       RowBox[{"1.0", "*", "vals"}], "/.", "xr2"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<vals/.xr2: \>\"", ",", " ", 
       RowBox[{"Short", "[", 
        RowBox[{"vals", ",", "3"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Complex", " ", "Infinity", " ", "Might", " ", "Arise"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"vals", " ", "=", " ", 
      RowBox[{"Quiet", "[", 
       RowBox[{"vals", "/.", 
        RowBox[{"{", 
         RowBox[{"Global`t", "\[Rule]", " ", "1"}], "}"}]}], "]"}]}], ";", 
     "  ", "\[IndentingNewLine]", 
     RowBox[{"vals", " ", "=", " ", 
      RowBox[{"Complement", "[", 
       RowBox[{"vals", ",", " ", 
        RowBox[{"{", 
         RowBox[{"Infinity", ",", " ", 
          RowBox[{"-", "Infinity"}], ",", " ", "ComplexInfinity"}], "}"}]}], 
       "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"ok", "=", 
      RowBox[{"And", "@@", 
       RowBox[{"NumericQ", "/@", "vals"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"OK", " ", "=", " ", "ok"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<ok=\>\"", ",", " ", "ok"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"problem", "=", 
      RowBox[{"Select", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Union", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"vals", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Plus", "\[Rule]", " ", "List"}], ",", 
             RowBox[{"Times", "\[Rule]", " ", "List"}], ",", 
             RowBox[{"Abs", "\[Rule]", " ", "List"}], ",", "  ", 
             RowBox[{"Power", "\[Rule]", " ", "List"}]}], "}"}]}], "]"}], 
         "]"}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{"NumericQ", "[", "#", "]"}], "]"}], "&"}]}], "]"}]}], ";", 
     " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", "derivatives", "}"}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"derivatives", "=", " ", 
           RowBox[{"Select", "[", 
            RowBox[{"problem", ",", " ", 
             RowBox[{
              RowBox[{"StringMatchQ", "[", 
               RowBox[{
                RowBox[{"ToString", "[", 
                 RowBox[{"FullForm", "[", "#", "]"}], "]"}], ",", " ", 
                "\"\<Derivative*\>\""}], "]"}], "&"}]}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"problem", "=", 
           RowBox[{"Complement", "[", 
            RowBox[{"problem", ",", " ", "derivatives"}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "problem", "]"}], "<", "1"}], ",", " ", 
            RowBox[{"OK", "=", 
             RowBox[{"ok", "=", "True"}]}]}], "]"}], ";"}]}], " ", 
        "\[IndentingNewLine]", "]"}], ";"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<problem=\>\"", ",", " ", "problem"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"ReturnString", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"problem", "=", 
         RowBox[{"If", "[", 
          RowBox[{"ok", ",", "\"\<\>\"", ",", 
           RowBox[{"\"\< because of \>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"InputForm", "[", "problem", "]"}], "]"}]}]}], "]"}]}], 
        ";", " ", "\[IndentingNewLine]", 
        RowBox[{"ok", " ", "=", " ", 
         RowBox[{"If", "[", 
          RowBox[{"ok", ",", "\"\<\>\"", ",", "\"\< not\>\""}], "]"}]}], ";", 
        " ", "\[IndentingNewLine]", 
        RowBox[{"ok", "=", 
         RowBox[{
         "\"\<This simulation is\>\"", "<>", "ok", "<>", 
          "\"\< complete and may\>\"", "<>", "ok", "<>", 
          "\"\< be used to run a simulation.\>\"", "<>", "problem"}]}], 
        ";"}]}], " ", "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"ir", "=", "Indeterminate"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"OK", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ir", "=", 
         RowBox[{"ShowInitialRates", "[", 
          RowBox[{"eq", ",", "ic", ",", "parameters", ",", 
           RowBox[{"{", "}"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"vals", " ", "=", 
         RowBox[{"NumericQ", "/@", 
          RowBox[{"(", 
           RowBox[{"Last", "/@", 
            RowBox[{"(", "ir", ")"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"problem", "=", 
         RowBox[{"Pick", "[", 
          RowBox[{"ir", ",", " ", 
           RowBox[{"Not", "/@", "vals"}]}], "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"rok", " ", "=", " ", 
         RowBox[{"And", "@@", "vals"}]}]}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"ir", " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{"ReturnString", ",", " ", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "problem", "]"}], "\[Equal]", "0"}], ",", 
            " ", "\"\<The initial rates are all numeric.\>\"", ",", " ", 
            RowBox[{
            "\"\<The initial rates may have some issues: \>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"InputForm", "[", "problem", "]"}], "]"}]}]}], "]"}], 
          ",", " ", "\[IndentingNewLine]", "rok"}], "]"}]}], 
       "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{"ok", ",", 
        RowBox[{"Join", "[", 
         RowBox[{"ir", ",", " ", "APRATES"}], "]"}]}], "}"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.54524408254694*^9, 3.5452441819536133`*^9}, {
   3.545244228689871*^9, 3.545244231835059*^9}, {3.545244363039825*^9, 
   3.54524437562878*^9}, {3.5452444183405733`*^9, 3.545244510444281*^9}, {
   3.5460321624229507`*^9, 3.546032165613812*^9}, {3.546039113071108*^9, 
   3.5460392246046047`*^9}, {3.546039561232473*^9, 3.54603962964592*^9}, {
   3.5460397446844063`*^9, 3.546039972994051*^9}, {3.54714732478155*^9, 
   3.5471474308251543`*^9}, {3.547147462026163*^9, 3.547147622900305*^9}, {
   3.5471476691471863`*^9, 3.547147822570072*^9}, {3.547147863211685*^9, 
   3.5471479272205544`*^9}, {3.547147975673246*^9, 3.547148018607101*^9}, {
   3.54714804976442*^9, 3.547148050602069*^9}, {3.547148094149087*^9, 
   3.547148145770204*^9}, {3.547148255582966*^9, 3.547148257286126*^9}, {
   3.547148369871603*^9, 3.5471483705378027`*^9}, {3.5471484056130943`*^9, 
   3.547148414516061*^9}, {3.547489159763706*^9, 3.54748926834834*^9}, {
   3.547489299136765*^9, 3.547489383315949*^9}, {3.547489488149209*^9, 
   3.5474895145778227`*^9}, {3.547489978201684*^9, 3.547489994265094*^9}, {
   3.5474901042464733`*^9, 3.547490126747052*^9}, {3.547490279737606*^9, 
   3.547490285417493*^9}, {3.5474903828460817`*^9, 3.5474904174190207`*^9}, {
   3.547490452038498*^9, 3.5474904821013823`*^9}, {3.547490697894618*^9, 
   3.54749069815058*^9}, {3.547490730419615*^9, 3.5474907317933187`*^9}, {
   3.54749096916087*^9, 3.547490969932517*^9}, {3.5479375788419437`*^9, 
   3.547937693142045*^9}, {3.547938378320388*^9, 3.5479383845735598`*^9}, {
   3.5479385522491817`*^9, 3.5479385529156523`*^9}, {3.547938612252698*^9, 
   3.547938631059667*^9}, {3.5479387405833683`*^9, 3.547938748708405*^9}, {
   3.5479388689104567`*^9, 3.5479388695045853`*^9}, {3.548447385994116*^9, 
   3.548447386985944*^9}, {3.548447769835474*^9, 3.548447770787479*^9}, {
   3.561766593296081*^9, 3.561766593942823*^9}, {3.561766844659411*^9, 
   3.561766845438628*^9}, {3.572133946134157*^9, 3.57213394688482*^9}, {
   3.572134523650606*^9, 3.572134524452792*^9}, {3.5721348192311153`*^9, 
   3.572134819878004*^9}, {3.5721348596747913`*^9, 3.572134861135227*^9}, 
   3.5721349219621563`*^9, {3.57213685004136*^9, 3.572136850716856*^9}, {
   3.5721371572805843`*^9, 3.5721371587161083`*^9}, {3.572394658918653*^9, 
   3.572394671859639*^9}, {3.572394766873062*^9, 3.5723947673070717`*^9}, {
   3.572394939179941*^9, 3.572394939763735*^9}, {3.574791167993185*^9, 
   3.574791168407127*^9}, {3.574791267855709*^9, 3.574791268798645*^9}, {
   3.574791403943611*^9, 3.5747914075903673`*^9}, {3.5747914662224207`*^9, 
   3.574791514710621*^9}, {3.574791553158552*^9, 3.574791591566661*^9}, {
   3.574807843332806*^9, 3.574807844640753*^9}, {3.5748079195391197`*^9, 
   3.574807920805717*^9}, {3.57556613025135*^9, 3.5755661309395933`*^9}, {
   3.575566519764201*^9, 3.5755665206267633`*^9}, {3.578343532391033*^9, 
   3.578343533035591*^9}, {3.5783436553321743`*^9, 3.5783436562064*^9}, {
   3.578344542729103*^9, 3.5783445788976727`*^9}, {3.578344837805667*^9, 
   3.578344938002633*^9}, {3.578344988121265*^9, 3.578345025887869*^9}, {
   3.5783450931283503`*^9, 3.578345106264729*^9}, {3.5783451486011066`*^9, 
   3.578345149195874*^9}, {3.5783457720346737`*^9, 3.5783458068849*^9}, {
   3.578345850669567*^9, 3.5783458534550247`*^9}, {3.578345904130114*^9, 
   3.578345921584477*^9}, {3.578346611271399*^9, 3.57834665046402*^9}, {
   3.57834673866405*^9, 3.5783468278087187`*^9}, {3.578346859739627*^9, 
   3.578346898511505*^9}, {3.578346935014122*^9, 3.578346938475809*^9}, {
   3.5783470142662973`*^9, 3.5783470297480783`*^9}, {3.578347132569141*^9, 
   3.578347204591012*^9}, {3.578347332839465*^9, 3.578347388437438*^9}, 
   3.578347426316791*^9, {3.57834750969459*^9, 3.5783475110145807`*^9}, {
   3.578347557078578*^9, 3.578347560107641*^9}, {3.5783476027296143`*^9, 
   3.57834762815867*^9}, {3.578347682285289*^9, 3.5783476987608128`*^9}, {
   3.578347934643466*^9, 3.578347942077077*^9}, {3.5783480030210333`*^9, 
   3.578348003751388*^9}, {3.578348038110826*^9, 3.578348054496299*^9}, {
   3.578348086549629*^9, 3.578348149524737*^9}, {3.578348183229426*^9, 
   3.57834829324815*^9}, {3.578348363819016*^9, 3.578348364419536*^9}, {
   3.578348430936328*^9, 3.578348440691972*^9}, {3.5783484727584887`*^9, 
   3.578348484000901*^9}, {3.5783485769289913`*^9, 3.57834858730939*^9}, {
   3.578348680205956*^9, 3.578348748877883*^9}, {3.57834878343041*^9, 
   3.5783488185099497`*^9}, {3.5783488589020357`*^9, 3.578349018928604*^9}, {
   3.578349074600697*^9, 3.57834910066401*^9}, {3.578349131829822*^9, 
   3.578349136644636*^9}, {3.57834918043259*^9, 3.578349231735764*^9}, {
   3.578349324211376*^9, 3.5783493712477407`*^9}, {3.578349569804994*^9, 
   3.578349591869761*^9}, {3.578349647158836*^9, 3.578349675237629*^9}, {
   3.578349706801363*^9, 3.5783497585432367`*^9}, {3.578349835727704*^9, 
   3.578349911952848*^9}, {3.57834995576643*^9, 3.578349956343194*^9}, {
   3.57834999023999*^9, 3.5783500353456306`*^9}, {3.578350113292688*^9, 
   3.578350113830628*^9}, {3.578350244546247*^9, 3.578350260827602*^9}, 
   3.578350298796961*^9, {3.57835038445721*^9, 3.578350405644246*^9}, {
   3.5783504837103577`*^9, 3.5783504838889103`*^9}, {3.578350593422492*^9, 
   3.578350612364438*^9}, {3.5783506568439817`*^9, 3.578350696175242*^9}, {
   3.5783507603666677`*^9, 3.5783507962350273`*^9}, {3.5783508804053183`*^9, 
   3.578350881359612*^9}, {3.578350915502796*^9, 3.5783510246406927`*^9}, {
   3.578351062055212*^9, 3.578351093544297*^9}, {3.5783511261408463`*^9, 
   3.578351149128935*^9}, {3.578351179227667*^9, 3.57835122154951*^9}, {
   3.578351260358245*^9, 3.578351320792034*^9}, {3.5783513566734457`*^9, 
   3.578351406200759*^9}, {3.578351522320991*^9, 3.578351595832038*^9}, {
   3.578351667415329*^9, 3.578351699389761*^9}, {3.578351741913332*^9, 
   3.578351808012135*^9}, {3.5783518507333*^9, 3.578351870479692*^9}, {
   3.578351913071917*^9, 3.578351931679389*^9}, {3.578352610448531*^9, 
   3.578352613510792*^9}, {3.578353393361109*^9, 3.578353396396495*^9}, {
   3.584828323469906*^9, 3.5848283254315453`*^9}, {3.584828631328074*^9, 
   3.584828660081229*^9}, {3.584828802174036*^9, 3.584828858599162*^9}, {
   3.584828919007039*^9, 
   3.5848290426508713`*^9}},ExpressionUUID->"0e6c2321-935e-46c7-9f89-\
c6d87f3eae21"]
}, Closed]],

Cell[CellGroupData[{

Cell["SSANetwork", "Subsection",
 CellChangeTimes->{{3.456320895991547*^9, 3.4563208993684673`*^9}, 
   3.5477459205277*^9, 
   3.561656481407476*^9},ExpressionUUID->"1d4e6329-5ff0-4624-a532-\
d80723bbf55b"],

Cell["xlr8r reactions --> SSA network", "Text",
 CellChangeTimes->{{3.456321281830299*^9, 3.456321307637748*^9}, {
  3.4563214982653418`*^9, 
  3.456321503301179*^9}},ExpressionUUID->"88406729-dd91-4c34-8c8a-\
f32b1bffd241"],

Cell[BoxData[
 RowBox[{
  RowBox[{"X2SSANetwork", "[", 
   RowBox[{"net_", ",", " ", "diff_", ",", "  ", 
    RowBox[{"tissue_", "?", "TissueQ"}], ",", " ", 
    RowBox[{"verbose_:", "True"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "bignet", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"bignet", " ", "=", " ", 
      RowBox[{"CelleratorNetwork", "[", 
       RowBox[{"tissue", ",", " ", 
        RowBox[{"\"\<Reactions\>\"", "\[Rule]", " ", "net"}], ",", " ", 
        RowBox[{"\"\<Diffusion\>\"", "\[Rule]", " ", "diff"}], ",", " ", 
        RowBox[{"\"\<Verbose\>\"", "\[Rule]", " ", "verbose"}]}], "]"}]}], 
     ";", " ", "\[IndentingNewLine]", 
     RowBox[{"bignet", "=", 
      RowBox[{"ToExpression", "[", 
       RowBox[{"StringReplace", "[", 
        RowBox[{
         RowBox[{"ToString", "[", "bignet", "]"}], ",", 
         RowBox[{"\"\<[t]\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"bignet", "=", 
      RowBox[{"XLR8RtoSSA", "[", "bignet", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "bignet", "]"}], ";"}]}], " ", 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.456320900608477*^9, 3.456320902568386*^9}, {
  3.4563210286705513`*^9, 3.4563210543747673`*^9}, {3.456321125439107*^9, 
  3.456321200906513*^9}, {3.456321249256983*^9, 3.45632127601622*^9}, {
  3.4563214692681007`*^9, 3.456321469697225*^9}, {3.507594037782795*^9, 
  3.5075940483179083`*^9}, {3.5616564914392242`*^9, 3.561656512742498*^9}, {
  3.561658620585816*^9, 
  3.561658645675653*^9}},ExpressionUUID->"2a592611-e0d4-461b-a35f-\
1d3b3b44eef8"],

Cell["SSA reactions ---> SSA network", "Text",
 CellChangeTimes->{{3.456321474185769*^9, 
  3.456321495784789*^9}},ExpressionUUID->"4c9343a2-ce02-40ca-a741-\
52bd14e22e9e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SSANetwork", "[", 
   RowBox[{"net_", ",", " ", "diff_", ",", "  ", 
    RowBox[{"tissue_", "?", "TissueQ"}], ",", " ", 
    RowBox[{"verbose_:", "True"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "bignet", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"bignet", " ", "=", " ", 
      RowBox[{"SSAtoXLR8R", "[", "net", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"bignet", " ", "=", " ", 
      RowBox[{"X2SSANetwork", "[", 
       RowBox[{
       "bignet", ",", " ", "diff", ",", " ", "tissue", ",", " ", "verbose"}], 
       "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "bignet", "]"}], ";"}]}], " ", 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.456320900608477*^9, 3.456320902568386*^9}, {
  3.4563210286705513`*^9, 3.4563210543747673`*^9}, {3.456321125439107*^9, 
  3.456321200906513*^9}, {3.456321249256983*^9, 3.45632127601622*^9}, {
  3.456321509660975*^9, 3.4563215478781557`*^9}, {3.456321707674871*^9, 
  3.456321711909561*^9}},ExpressionUUID->"2cc33c77-9c85-4c4c-8637-\
d426b790fb15"]
}, Closed]],

Cell[CellGroupData[{

Cell["indexify", "Subsection",
 CellChangeTimes->{{3.452346800225915*^9, 
  3.452346801254599*^9}},ExpressionUUID->"82bf7ba7-c34e-4ad8-a6bf-\
cb467229e793"],

Cell[TextData[{
 "function to add a single index to a cellerator reaction network.\n\nNote: \
this is revised from cellzilla 1.3 & corrected to allow for references to \
species in rate constants as well as species subscripts, e.g.,  {A --> B, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["k", "A"], "*", 
      RowBox[{"B", "[", "t", "]"}]}], "}"}], " "}], TraditionalForm]],
  ExpressionUUID->"52e5f6b7-a14a-45ad-a834-863e07b0735f"],
 " will become {A[i] --> B[i], ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["k", "A"], TraditionalForm]],ExpressionUUID->
  "130e5529-6154-4031-9d42-1b706bc99819"],
 " B[i]} as expected\n\nv12: remove flattening and re-listing \n\nrev. 2.2.8 \
to allow for empty networks (growth-only simulations)\n\nrev 3.0.15 allow \
extra variables to be indexed as part of rate constant: tipdistance[t] \
becomes tipdistance[j][t]; \nxcenter[i][t] and ycenter[i][t] become \
center[i,1][t] and center[i,2][t]"
}], "Text",
 CellChangeTimes->{{3.452346875922333*^9, 3.452346897772709*^9}, {
  3.452348034022826*^9, 3.4523481289595346`*^9}, {3.4531460577727747`*^9, 
  3.453146073125436*^9}, {3.558095567894009*^9, 3.558095580026134*^9}, {
  3.574089668176458*^9, 
  3.5740897396857367`*^9}},ExpressionUUID->"bad10578-d042-4566-a077-\
3b44268c116b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"indexify", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "index_"}], "]"}], ":=", " ", 
    RowBox[{"{", "}"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"indexify", "[", 
    RowBox[{"net_", ",", "index_", ",", " ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "species", ",", "reactions", ",", "rateRules", ",", "rules", ",", 
       "indexedSpecies", ",", " ", "mysub", ",", " ", "mysup", ",", " ", 
       "myexpr", ",", " ", "dbg", ",", " ", "dPrint", ",", " ", "lengths", 
       ",", " ", "extraSpecies", ",", " ", "tipdist", ",", " ", "xcenter", 
       ",", " ", "ycenter", ",", " ", "center", ",", " ", "myxcenter", ",", 
       "myycenter", ",", " ", "hasCEN", ",", "L1", ",", "L2", ",", "TIPFLAG", 
       ",", " ", "A", ",", " ", "cellindex"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dbg", "=", 
       RowBox[{
        RowBox[{"\"\<indexifydbg\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<indexifydbg\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], 
      ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dPrint", "[", "x___", "]"}], ":=", " ", 
       RowBox[{"If", "[", 
        RowBox[{"dbg", ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<indexify: \>\"", ",", " ", "x"}], "]"}]}], "]"}]}], 
      ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"cellindex", "=", 
       RowBox[{"\"\<CellIndex\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"don", "'"}], "t", " ", "specify", " ", "a", " ", "default", 
        " ", "and", " ", "it", " ", "should", " ", "be", " ", "OK"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<options: \>\"", ",", " ", 
        RowBox[{"{", "opt", "}"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<cellindex: \>\"", ",", " ", "cellindex"}], "]"}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<index: \>\"", ",", " ", "index"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"tipdist", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<tipDistance\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<tipDistance\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], 
      ";", " ", "\[IndentingNewLine]", 
      RowBox[{"L1", "=", 
       RowBox[{
        RowBox[{"\"\<L1\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"L1", "\[Rule]", " ", "False"}], "}"}]}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"L2", "=", 
       RowBox[{
        RowBox[{"\"\<L2\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"L2", "\[Rule]", " ", "False"}], "}"}]}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"TIPFLAG", "=", 
       RowBox[{
        RowBox[{"\"\<TipFlag\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<TipFlag\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";",
       " ", "\[IndentingNewLine]", 
      RowBox[{"A", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<CellVariable\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<CellVariable\>\"", "\[Rule]", " ", "Global`cell"}], 
         "}"}]}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"extraSpecies", "=", 
       RowBox[{"{", "A", "}"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ToString", "[", "tipdist", "]"}], "\[NotEqual]", " ", 
         "\"\<False\>\""}], ",", " ", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"extraSpecies", ",", " ", "tipdist"}], "]"}]}], "]"}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ToString", "[", "L1", "]"}], "\[NotEqual]", " ", 
         "\"\<False\>\""}], ",", " ", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"extraSpecies", ",", " ", "L1"}], "]"}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ToString", "[", "L2", "]"}], "\[NotEqual]", " ", 
         "\"\<False\>\""}], ",", " ", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"extraSpecies", ",", " ", "L2"}], "]"}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ToString", "[", "TIPFLAG", "]"}], "\[NotEqual]", " ", 
         "\"\<False\>\""}], ",", " ", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"extraSpecies", ",", " ", "TIPFLAG"}], "]"}]}], "]"}], ";", 
      " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"center", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<center\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<center\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{"hasCEN", "=", "False"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ToString", "[", "center", "]"}], "\[NotEqual]", " ", 
         "\"\<False\>\""}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"xcenter", "=", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<x\>\"", "<>", 
            RowBox[{"ToString", "[", "center", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ycenter", "=", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<y\>\"", "<>", 
            RowBox[{"ToString", "[", "center", "]"}]}], "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"extraSpecies", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"extraSpecies", ",", " ", 
            RowBox[{"{", 
             RowBox[{"xcenter", ",", " ", "ycenter"}], "}"}]}], "]"}]}], ";", 
         " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"myxcenter", "[", "j_", "]"}], "[", "t_", "]"}], ":=", " ", 
          RowBox[{
           RowBox[{"center", "[", 
            RowBox[{"j", ",", "1"}], "]"}], "[", "t", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"myycenter", "[", "j_", "]"}], "[", "t_", "]"}], ":=", " ", 
          RowBox[{
           RowBox[{"center", "[", 
            RowBox[{"j", ",", "2"}], "]"}], "[", "t", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"hasCEN", "=", "True"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"generate", " ", "replacement", " ", "rules", " ", 
          RowBox[{"x", "--"}]}], ">", 
         RowBox[{"x", "[", "index", "]"}]}], ",", "..."}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"mysub", "[", "x__", "]"}], ":=", " ", 
       RowBox[{"stringify", "[", 
        RowBox[{"InputForm", "[", 
         RowBox[{"Subscript", "[", "x", "]"}], "]"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"mysup", "[", "x__", "]"}], ":=", " ", 
       RowBox[{"stringify", "[", 
        RowBox[{"InputForm", "[", 
         RowBox[{"Superscript", "[", "x", "]"}], "]"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "add", " ", "the", " ", "following", " ", "If", " ", "statement", " ", 
        "3.0", ".51", "c"}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "net", "]"}], ">", "0"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"species", "=", 
         RowBox[{
          RowBox[{"interpret", "[", "net", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"species", "=", 
         RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"species", " ", "=", " ", 
       RowBox[{"Join", "[", 
        RowBox[{"species", ",", " ", "extraSpecies"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"indexedSpecies", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", "index", "]"}], "&"}], "/@", "species"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"rules", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Rule", ",", 
         RowBox[{"{", 
          RowBox[{"species", ",", "indexedSpecies"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"separate", " ", "rate", " ", "rules", " ", "from", " ", 
        RowBox[{"reactions", ":", 
         RowBox[{
         "this", " ", "is", " ", "becasue", " ", "we", " ", "may", " ", 
          "have", " ", "a", " ", "rate", " ", "constant", " ", "like", " ", 
          RowBox[{"Subscript", "[", 
           RowBox[{"k", ",", "CLV"}], "]"}], " ", "where", " ", "CLV", " ", 
          "is", " ", "the", " ", "name", " ", "of", " ", "a", " ", 
          "species"}]}]}], "*)"}], 
      RowBox[{"reactions", "=", 
       RowBox[{"First", "/@", "net"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rateRules", "=", 
       RowBox[{"Rest", "/@", "net"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"hide", " ", "any", " ", 
        RowBox[{"super", "/", "subscripts"}], " ", "in", " ", "the", " ", 
        "rate", " ", "constants"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"rateRules", " ", "=", " ", 
       RowBox[{"rateRules", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Subscript", "\[Rule]", " ", "mysub"}], ",", " ", 
          RowBox[{"Superscript", "\[Rule]", " ", "mysup"}]}], "}"}]}]}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{"lengths", " ", "=", " ", 
       RowBox[{"Length", "/@", "rateRules"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<rateRules (1):\>\"", ",", " ", "rateRules"}], "]"}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<lengths: \>\"", ",", " ", "lengths"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "apply", " ", "the", " ", "indices", " ", "to", " ", "the", " ", 
         "rate", " ", "constants"}], ",", " ", 
        RowBox[{
        "just", " ", "in", " ", "case", " ", "there", " ", "is", " ", "a", 
         " ", "species", " ", "in", " ", "there"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"rateRules", "=", 
       RowBox[{"rateRules", "/.", "rules"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<rateRules (2):\>\"", ",", " ", "rateRules"}], "]"}], ";", 
      " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"recover", " ", "any", " ", "hidden", " ", 
        RowBox[{"superscrips", "/", "subscripts"}], " ", "in", " ", "the", 
        " ", "rate", " ", "constants"}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"rateRules", "=", 
         RowBox[{"Flatten", "[", "rateRules", "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"dPrint", "[", 
         RowBox[{"\"\<rateRules (3):\>\"", ",", " ", "rateRules"}], "]"}], 
        ";"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"rateRules", " ", "=", " ", 
       RowBox[{"InputForm", "/@", "rateRules"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<rateRules (4):\>\"", ",", " ", "rateRules"}], "]"}], ";", 
      " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"rateRules", "=", 
       RowBox[{"stringify", "/@", "rateRules"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<rateRules (5):\>\"", ",", " ", "rateRules"}], "]"}], ";", 
      " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"rateRules", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"StringReplace", "[", 
          RowBox[{"#", ",", " ", 
           RowBox[{"{", 
            RowBox[{"\"\<\\\"\>\"", "\[Rule]", " ", "\"\<\>\""}], "}"}]}], 
          "]"}], "&"}], "/@", "rateRules"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"rateRules", "=", 
       RowBox[{"ToExpression", "/@", "rateRules"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"rateRules", "=", 
         RowBox[{"List", "/@", "rateRules"}]}], ";"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<rateRules (6):\>\"", ",", " ", "rateRules"}], "]"}], ";", 
      " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "apply", " ", "the", " ", "indexing", " ", "to", " ", "the", " ", 
        "species"}], "*)"}], 
      RowBox[{"reactions", "=", 
       RowBox[{"reactions", "/.", "rules"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "join", " ", "the", " ", "reactions", " ", "back", " ", "to", " ", 
        "the", " ", "rate", " ", "rules"}], "*)"}], 
      RowBox[{"reactions", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Prepend", "[", 
           RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"rateRules", ",", "reactions"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"hasCEN", ",", "\[IndentingNewLine]", 
        RowBox[{"reactions", " ", "=", " ", 
         RowBox[{"(", 
          RowBox[{"reactions", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"xcenter", "\[Rule]", " ", "myxcenter"}], ",", " ", 
             RowBox[{"ycenter", "\[Rule]", " ", "myycenter"}]}], "}"}]}], 
          ")"}]}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "replace", " ", "externally", " ", "specified", " ", "cell", " ", 
        "number", " ", "with", " ", "actual", " ", "cell", " ", "number"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"reactions", " ", "=", " ", 
       RowBox[{"reactions", "/.", 
        RowBox[{"{", 
         RowBox[{"cellindex", "\[Rule]", " ", "index"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "reactions", "]"}]}]}], "]"}]}], ";"}]}], "Input",\

 InitializationCell->True,
 CellChangeTimes->{
  3.452346817018394*^9, {3.4523469615251207`*^9, 3.452346968231452*^9}, {
   3.452347026220702*^9, 3.452347031409987*^9}, {3.452347072471074*^9, 
   3.452347108683587*^9}, {3.4523471940512657`*^9, 3.4523472899890413`*^9}, {
   3.452347325963097*^9, 3.45234733592474*^9}, {3.452347370935092*^9, 
   3.452347418224514*^9}, {3.452347449801766*^9, 3.4523474557390957`*^9}, {
   3.452347487963765*^9, 3.4523474904247007`*^9}, {3.452347649345181*^9, 
   3.4523477237042*^9}, {3.452347790223536*^9, 3.452348012002651*^9}, {
   3.4523796552071342`*^9, 3.4523796574147377`*^9}, {3.453145649813114*^9, 
   3.453145724337841*^9}, {3.453145891139852*^9, 3.4531459262595177`*^9}, {
   3.453145964513336*^9, 3.4531460161724157`*^9}, {3.453146076282239*^9, 
   3.453146112063601*^9}, {3.558095505913268*^9, 3.558095518589645*^9}, 
   3.558095997010487*^9, {3.574085421592269*^9, 3.574085421974703*^9}, {
   3.574085537037058*^9, 3.5740855555117893`*^9}, {3.574085662321313*^9, 
   3.574085678329874*^9}, {3.5740857139452667`*^9, 3.5740857160762253`*^9}, {
   3.574085783773078*^9, 3.574085806804183*^9}, {3.5740859275821743`*^9, 
   3.5740860167238903`*^9}, {3.574088778673394*^9, 3.574088838690145*^9}, {
   3.574088895241021*^9, 3.574088926498461*^9}, {3.574088997286996*^9, 
   3.574089040697289*^9}, {3.574089244151657*^9, 3.574089386547071*^9}, {
   3.5740894383784037`*^9, 3.574089445894909*^9}, {3.5740895012579937`*^9, 
   3.574089537278783*^9}, {3.5754931738805513`*^9, 3.5754932592648*^9}, {
   3.5754933066438932`*^9, 3.575493317305313*^9}, {3.575493466670879*^9, 
   3.575493552066264*^9}, {3.57549365233921*^9, 3.575493679814562*^9}, {
   3.576614344015573*^9, 3.57661434452178*^9}, {3.576620035186145*^9, 
   3.576620037127405*^9}, {3.584830148270067*^9, 3.584830157919518*^9}, {
   3.584830210452064*^9, 3.584830463298171*^9}, {3.584830517234686*^9, 
   3.584830561106228*^9}, {3.584830628233694*^9, 3.584830633566535*^9}, {
   3.584830725578835*^9, 3.5848307261157207`*^9}, {3.7059481800272284`*^9, 
   3.705948219546537*^9}, {3.705965776303604*^9, 3.705965808637744*^9}, {
   3.705965931306575*^9, 3.705965967692541*^9}, {3.705966107350542*^9, 
   3.705966132911438*^9}},ExpressionUUID->"e1a0a872-38ee-43d9-bf9a-\
48c956e9ac45"]
}, Closed]],

Cell[CellGroupData[{

Cell["RunSim", "Subsection",
 CellChangeTimes->{{3.452379986874535*^9, 3.4523799874545393`*^9}, {
  3.4524396168527737`*^9, 
  3.452439617799821*^9}},ExpressionUUID->"c4c4fce1-76c8-46b8-9de2-\
2d6a140e70ad"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RunSim", "[", 
   RowBox[{"bignet_", ",", " ", "parameters_", ",", " ", "ic_", ",", " ", 
    RowBox[{"{", 
     RowBox[{"tstart_", ",", " ", "tend_"}], "}"}], ",", " ", 
    RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "sim", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sim", " ", "=", " ", 
      RowBox[{"run", "[", 
       RowBox[{"bignet", ",", 
        RowBox[{"{", 
         RowBox[{"tstart", ",", " ", "tend"}], "}"}], ",", "  ", 
        RowBox[{"xlr8r`initialConditions", "\[Rule]", " ", "ic"}], ",", " ", 
        RowBox[{"xlr8r`rates", "\[Rule]", " ", "parameters"}], ",", " ", 
        "opt"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"sim", "=", 
      RowBox[{"Flatten", "[", "sim", "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "sim", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.452379990120008*^9, 3.452380174752447*^9}, {
  3.4523802125334806`*^9, 3.452380213919139*^9}, {3.4524396127197237`*^9, 
  3.452439613873645*^9}},ExpressionUUID->"d80423ff-7e6a-488a-a2a0-\
f7e3a6eef6dc"]
}, Closed]],

Cell[CellGroupData[{

Cell["bins2Histogram", "Subsection",
 CellChangeTimes->{{3.558186222749282*^9, 
  3.5581862272926683`*^9}},ExpressionUUID->"1babd567-f2d4-4c8f-b83f-\
44ee386b58fb"],

Cell[TextData[{
 "Converts output of SimBinData into a plot\n\nOptions:\n\n\
\[OpenCurlyDoubleQuote]Mean\[CloseCurlyDoubleQuote]->{Thick, Red} -- style \
options for Mean Histogram\n\[OpenCurlyDoubleQuote]Style\
\[CloseCurlyDoubleQuote]-> {Black} -- style options for ensemble of \
Histograms\n\[OpenCurlyDoubleQuote]ErrorBars\[CloseCurlyDoubleQuote]-> True\n\
\[OpenCurlyDoubleQuote]Scatter\[CloseCurlyDoubleQuote]-> True\n\
\[OpenCurlyDoubleQuote]Normalize\[CloseCurlyDoubleQuote]->False, if True, \
renormalizes data so that total area under the curve is 1 (",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Sum]", 
    SubscriptBox["x", "i"]}], TraditionalForm]],ExpressionUUID->
  "d023dfa1-d2a1-4fb4-9fe8-270074705533"],
 "=1)\n\[OpenCurlyDoubleQuote]Rounding\[CloseCurlyDoubleQuote]->0.1 - using \
in printing of statistics on plot, accuracy to round results to before \
printing\nany option for Plot\n\[OpenCurlyDoubleQuote]Format\
\[CloseCurlyDoubleQuote]-> \
\[OpenCurlyDoubleQuote]Plot\[CloseCurlyDoubleQuote] (default) or \
\[OpenCurlyDoubleQuote]Numeric\[CloseCurlyDoubleQuote]\n\
\[OpenCurlyDoubleQuote]Statistics\[CloseCurlyDoubleQuote]->True (whether or \
not to print the number of data sets, mean and standard deviation on the plot)"
}], "Text",
 CellChangeTimes->{{3.558186231099181*^9, 3.5581862366607428`*^9}, {
  3.558186516276339*^9, 3.5581865641005573`*^9}, {3.5581867387856894`*^9, 
  3.5581867393375463`*^9}, {3.558385279183577*^9, 3.558385283606309*^9}, {
  3.558386781526321*^9, 3.558386790620183*^9}, {3.5585372512009573`*^9, 
  3.558537349059087*^9}, {3.55869698084474*^9, 3.558697017308599*^9}, {
  3.559247931193467*^9, 3.559247946743136*^9}, {3.5594269192956743`*^9, 
  3.5594269450111847`*^9}},ExpressionUUID->"7ee2b24b-a148-4112-a419-\
8e9e3697d0ab"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Bins2Histogram", "[", 
   RowBox[{"bins_", ",", 
    RowBox[{"{", 
     RowBox[{"binmin_", ",", "binmax_", ",", "bindelta_"}], "}"}], ",", 
    RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "g", ",", "nb", ",", "h", ",", "theHistogram", ",", "meanHistPlot", ",", 
      "meanStyle", ",", "plotStyle", ",", " ", "EB", ",", " ", "sigmas", ",", 
      " ", "SD", ",", " ", "xvals", ",", " ", "yvals", ",", "BINS", ",", " ", 
      "TBINS", ",", " ", "errorbars", ",", " ", "means", ",", " ", "plt", " ",
       ",", "scatter", ",", " ", "normalize", ",", " ", "totals", ",", "navg",
       ",", "savg", ",", " ", "labels", ",", "meanarea", ",", " ", "SDarea", 
      ",", " ", "rounding", ",", "plot", ",", "BINLHS", ",", " ", "format", 
      ",", "showStatistics", ",", "frameticks"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"SD", "[", 
       RowBox[{"{", "x__", "}"}], "]"}], ":=", " ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"{", "x", "}"}], "]"}], "<", "2"}], ",", "0.0", ",", " ", 
        RowBox[{"StandardDeviation", "[", 
         RowBox[{"1.0", "*", 
          RowBox[{"{", "x", "}"}]}], "]"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"nb", "=", 
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"binmax", "-", "binmin"}], ")"}], "/", "bindelta"}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"meanStyle", "=", 
      RowBox[{
       RowBox[{"\"\<Mean\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<Mean\>\"", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", "Red"}], "}"}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"plotStyle", "=", 
      RowBox[{
       RowBox[{"\"\<Style\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<Style\>\"", "\[Rule]", 
         RowBox[{"{", "Black", "}"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"EB", " ", "=", " ", 
      RowBox[{
       RowBox[{"\"\<ErrorBars\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<ErrorBars\>\"", "\[Rule]", " ", "True"}], "}"}]}]}], ";",
      " ", "\[IndentingNewLine]", 
     RowBox[{"scatter", "=", 
      RowBox[{
       RowBox[{"\"\<Scatter\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<Scatter\>\"", "\[Rule]", " ", "True"}], "}"}]}]}], ";", 
     " ", "\[IndentingNewLine]", 
     RowBox[{"normalize", "=", 
      RowBox[{
       RowBox[{"\"\<Normalize\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<Normalize\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], 
     ";", " ", "\[IndentingNewLine]", 
     RowBox[{"rounding", " ", "=", " ", 
      RowBox[{
       RowBox[{"\"\<Rounding\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<Rounding\>\"", "\[Rule]", " ", ".1"}], "}"}]}]}], ";", 
     " ", "\[IndentingNewLine]", 
     RowBox[{"format", " ", "=", " ", 
      RowBox[{
       RowBox[{"\"\<Format\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<Format\>\"", "\[Rule]", " ", "\"\<Plot\>\""}], "}"}]}]}],
      ";", " ", "\[IndentingNewLine]", 
     RowBox[{"format", "=", 
      RowBox[{"ToUpperCase", "[", 
       RowBox[{"ToString", "[", "format", "]"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"showStatistics", "=", 
      RowBox[{
       RowBox[{"\"\<Statistics\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<Statistics\>\"", "\[Rule]", " ", "True"}], "}"}]}]}], 
     ";", " ", "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
     RowBox[{"BINLHS", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"binmin", "+", 
         RowBox[{"i", "*", "bindelta"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", " ", 
          RowBox[{"nb", "-", "1"}]}], "}"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"g", "[", "h_", "]"}], ":=", 
      RowBox[{"Join", "@@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"binmin", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"i", "-", "1"}], ")"}], "*", "bindelta"}]}], ",", 
             "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"binmin", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"i", "-", "1"}], ")"}], "*", "bindelta"}]}], ",", 
             RowBox[{"h", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"binmin", "+", 
              RowBox[{
               RowBox[{"(", "i", ")"}], "*", "bindelta"}]}], ",", 
             RowBox[{"h", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"binmin", "+", 
              RowBox[{"bindelta", "*", "i"}]}], ",", "0"}], "}"}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nb"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"get", " ", "the", " ", "actual", " ", "BINS", " ", "J"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"BINS", "=", 
      RowBox[{"Last", "/@", "bins"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "stats", " ", "on", " ", "total", " ", "number", " ", "of", " ", 
       "cells", " ", "in", " ", "analysis"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"totals", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"1.0", "*", 
         RowBox[{"Plus", "@@", "#"}]}], "&"}], "/@", "BINS"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"navg", "=", 
      RowBox[{"Mean", "[", "totals", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"savg", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "totals", "]"}], ">", "1"}], ",", " ", 
        RowBox[{"StandardDeviation", "[", "totals", "]"}], ",", "0"}], 
       "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"totals", " ", "=", " ", 
      RowBox[{"1.0", "/", "totals"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "normalization", " ", "sets", " ", "total", " ", "area", " ", "to", " ",
        "one"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"normalize", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"BINS", " ", "=", " ", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Times", ",", " ", 
           RowBox[{"{", 
            RowBox[{"totals", ",", " ", "BINS"}], "}"}]}], "]"}]}], ";"}]}], 
      " ", "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "generate", " ", "plottable", " ", "data", " ", "set", " ", "from", " ",
        "bins"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"h", "=", 
      RowBox[{"g", "/@", "BINS"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"TBINS", "=", 
      RowBox[{"Transpose", "[", "BINS", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"statistics", " ", "are", " ", "y"}], "-", "values"}], " ", 
      "*)"}], " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"means", "=", 
      RowBox[{"Mean", "/@", 
       RowBox[{"(", 
        RowBox[{"1.0", "*", "TBINS"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"sigmas", " ", "=", " ", 
      RowBox[{"SD", "/@", "TBINS"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"nb", "=", 
      RowBox[{"Length", "[", "sigmas", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"xvals", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"binmin", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"i", "+", ".5"}], ")"}], "*", "bindelta"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", 
          RowBox[{"nb", "-", "1"}]}], "}"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"yvals", "=", "means"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"meanarea", "=", 
      RowBox[{"1.0", "*", 
       RowBox[{"Plus", "@@", 
        RowBox[{"(", 
         RowBox[{"xvals", "*", "yvals"}], ")"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Not", "[", "normalize", "]"}], ",", " ", 
       RowBox[{"meanarea", "=", 
        RowBox[{"meanarea", "/", 
         RowBox[{"(", 
          RowBox[{"1.0", "*", 
           RowBox[{"Plus", "@@", "yvals"}]}], ")"}]}]}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
     RowBox[{"SDarea", " ", "=", " ", 
      RowBox[{"Plus", "@@", 
       RowBox[{"(", 
        RowBox[{"yvals", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#", "-", "meanarea"}], ")"}], "^", "2"}], ")"}], 
            "&"}], "/@", "xvals"}], ")"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SDarea", " ", "=", " ", 
      RowBox[{"SDarea", "/", 
       RowBox[{"(", 
        RowBox[{"1.0", "*", 
         RowBox[{"Plus", "@@", "yvals"}]}], ")"}]}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"SDarea", " ", "=", " ", 
      RowBox[{"Sqrt", "[", "SDarea", "]"}]}], ";", " ", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "generate", " ", "error", " ", "bars", " ", "for", " ", "plot"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"errorbars", "=", 
      RowBox[{"Graphics", "[", 
       RowBox[{"{", "}"}], "]"}]}], ";", "  ", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"EB", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"errorbars", " ", "=", " ", 
         RowBox[{"ErrorListPlot", "[", 
          RowBox[{
           RowBox[{"MapThread", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"#1", ",", "#2"}], "}"}], ",", " ", 
                RowBox[{"ErrorBar", "[", "#3", "]"}]}], "}"}], "&"}], ",", 
             " ", 
             RowBox[{"{", 
              RowBox[{"xvals", ",", " ", "yvals", ",", " ", "sigmas"}], 
              "}"}]}], "]"}], ",", " ", 
           RowBox[{"PlotStyle", "\[Rule]", " ", "meanStyle"}]}], "]"}]}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"popt", "=", 
         RowBox[{"MyFilterOptions", "[", 
          RowBox[{"Plot", ",", "opt"}], "]"}]}], "}"}], ",", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"theHistogram", "=", 
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{"#", ",", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               RowBox[{"InterpolationOrder", "\[Rule]", "0"}], ",", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", "plotStyle"}]}], "]"}], "&"}], 
            "/@", "h"}], ",", 
           RowBox[{"FrameTicks", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Automatic", ",", "None"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Range", "[", 
                 RowBox[{"binmin", ",", "binmax", ",", "bindelta"}], "]"}], 
                ",", "None"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"Frame", "\[Rule]", "True"}], ",", " ", "popt"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"meanHistPlot", "=", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"g", "[", "means", "]"}], ",", 
           RowBox[{"Joined", "\[Rule]", "True"}], ",", 
           RowBox[{"FrameTicks", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Automatic", ",", "None"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Range", "[", 
                 RowBox[{"binmin", ",", "binmax", ",", "bindelta"}], "]"}], 
                ",", "None"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"Frame", "\[Rule]", "True"}], ",", " ", 
           RowBox[{"PlotStyle", "\[Rule]", "meanStyle"}], ",", " ", "popt"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"showStatistics", ",", "\[IndentingNewLine]", 
          RowBox[{"labels", "=", 
           RowBox[{"Graphics", "[", 
            RowBox[{"{", 
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"\"\<n=\>\"", "<>", 
                RowBox[{"ToString", "[", 
                 RowBox[{"Round", "[", 
                  RowBox[{"navg", ",", ".1"}], "]"}], "]"}], "<>", 
                "\"\<\[PlusMinus]\>\"", "<>", 
                RowBox[{"ToString", "[", 
                 RowBox[{"Round", "[", 
                  RowBox[{"savg", ",", ".1"}], "]"}], "]"}], "<>", 
                "\"\<\\nvalue=\>\"", "<>", 
                RowBox[{"ToString", "[", 
                 RowBox[{"Round", "[", 
                  RowBox[{"meanarea", ",", "rounding"}], "]"}], "]"}], "<>", 
                "\"\<\[PlusMinus]\>\"", "<>", 
                RowBox[{"ToString", "[", 
                 RowBox[{"Round", "[", 
                  RowBox[{"SDarea", ",", "rounding"}], "]"}], "]"}]}], ",", 
               " ", 
               RowBox[{"Scaled", "[", 
                RowBox[{"{", 
                 RowBox[{"0.05", ",", ".9"}], "}"}], "]"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], "}"}], 
            "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"labels", "=", 
           RowBox[{"Graphics", "[", 
            RowBox[{"{", "}"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
        " ", "\[IndentingNewLine]", 
        RowBox[{"plot", "=", 
         RowBox[{"If", " ", "[", 
          RowBox[{"scatter", ",", " ", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", 
            RowBox[{
            "theHistogram", ",", "meanHistPlot", ",", " ", "errorbars", ",", 
             "labels", ",", " ", "popt"}], "]"}], ",", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"Show", "[", 
            RowBox[{
            "meanHistPlot", ",", "errorbars", ",", "labels", ",", " ", 
             "popt"}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}]}], "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{
      "format", ",", "\[IndentingNewLine]", "\"\<PLOT\>\"", ",", " ", 
       RowBox[{"Return", "[", "plot", "]"}], ",", "\[IndentingNewLine]", 
       "\"\<NUMERIC\>\"", ",", " ", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"BINLHS", ",", "means", ",", "sigmas"}], "}"}], "]"}], ",", 
       "\[IndentingNewLine]", "_", " ", ",", " ", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Unrecognized \\\"Format\\\"\[Rule] \>\"", ",", " ", "format"}], 
         "]"}], ";", " ", 
        RowBox[{"Return", "[", "plot", "]"}]}]}], "\[IndentingNewLine]", 
      "]"}], ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.558186270128751*^9, 3.558186272873066*^9}, {
   3.558186343493925*^9, 3.558186423952639*^9}, {3.558385286045113*^9, 
   3.558385467832609*^9}, {3.558385509349691*^9, 3.5583855106348352`*^9}, {
   3.5583855669715977`*^9, 3.5583857122751017`*^9}, {3.558385752958852*^9, 
   3.558385753546919*^9}, {3.558385789504703*^9, 3.55838581847502*^9}, {
   3.558385855415195*^9, 3.5583861728289013`*^9}, {3.558386204727992*^9, 
   3.558386247743699*^9}, {3.558386301654386*^9, 3.558386343245954*^9}, {
   3.558386794404722*^9, 3.558386818300708*^9}, {3.558386891346568*^9, 
   3.558387029089089*^9}, 3.558387092807822*^9, {3.558393326458136*^9, 
   3.558393364575893*^9}, {3.5583935521874447`*^9, 3.558393553069067*^9}, {
   3.558534828226145*^9, 3.558534847681444*^9}, {3.55853491736819*^9, 
   3.558535019984614*^9}, {3.558535083679628*^9, 3.558535084315852*^9}, {
   3.558535119822352*^9, 3.5585351454429007`*^9}, {3.558535190096187*^9, 
   3.558535234817984*^9}, {3.5585352659571753`*^9, 3.558535308653749*^9}, {
   3.5585353600806303`*^9, 3.558535436188691*^9}, {3.558535482151414*^9, 
   3.558535527386455*^9}, {3.558535572319984*^9, 3.558535605186335*^9}, {
   3.558535751782748*^9, 3.5585357887143717`*^9}, {3.558535823636717*^9, 
   3.5585358701936903`*^9}, {3.558535901524127*^9, 3.5585359520654163`*^9}, {
   3.558535990096931*^9, 3.558536017637583*^9}, {3.558536073780599*^9, 
   3.5585360779966087`*^9}, {3.558536121510859*^9, 3.5585362437695007`*^9}, {
   3.558536289765815*^9, 3.5585363234927197`*^9}, {3.5585363824451237`*^9, 
   3.5585364384429417`*^9}, {3.558536481634646*^9, 3.558536590876499*^9}, {
   3.558536836645561*^9, 3.55853686662354*^9}, {3.558536897563521*^9, 
   3.55853704947117*^9}, {3.558537084942276*^9, 3.558537088600807*^9}, {
   3.5585372069192343`*^9, 3.558537233649796*^9}, {3.558696770540143*^9, 
   3.558696821586952*^9}, 3.5586968570485153`*^9, {3.559091681391451*^9, 
   3.559091694334469*^9}, {3.559247461297291*^9, 3.559247498579767*^9}, {
   3.559247580125497*^9, 3.559247704883459*^9}, {3.559247793614739*^9, 
   3.559247793943592*^9}, {3.5592479498915854`*^9, 3.5592481113579187`*^9}, {
   3.559426425360322*^9, 3.559426499550878*^9}, {3.559477174309544*^9, 
   3.5594771758351383`*^9}, {3.559477744125469*^9, 3.559477786460703*^9}, {
   3.55947781805604*^9, 3.559477870662285*^9}, {3.559477916696254*^9, 
   3.559477917931924*^9}},ExpressionUUID->"f846aefd-6594-448e-b8f7-\
31bd7451dbc1"]
}, Closed]],

Cell[CellGroupData[{

Cell["BinData", "Subsection",
 CellChangeTimes->{{3.559091297321713*^9, 3.559091298729953*^9}, {
  3.5590913556815033`*^9, 
  3.559091359568882*^9}},ExpressionUUID->"0bcf4079-db95-4ee5-a7eb-\
5d69a047f79f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BinData", "[", 
   RowBox[{"data_", ",", 
    RowBox[{"{", 
     RowBox[{"binmin_", ",", " ", "binmax_", ",", " ", "bindelta_"}], "}"}]}],
    "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "nbins", ",", " ", "WhichBin", ",", "bins", ",", "whichbin", ",", 
      "sigma", ",", "mu"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nbins", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"binmax", "-", "binmin"}], ")"}], "/", "bindelta"}]}], ";", 
     " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"WhichBin", "[", "value_", "]"}], ":=", " ", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"value", "<", "binmin"}], ",", "1", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"value", " ", ">", "binmax"}], ",", "nbins", ",", 
        "\[IndentingNewLine]", "True", ",", " ", 
        RowBox[{
         RowBox[{"Floor", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"value", "-", "binmin"}], ")"}], "/", "bindelta"}], "]"}],
          "+", "1"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"bins", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", "nbins", "}"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"whichbin", "=", 
      RowBox[{"WhichBin", "/@", "data"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "whichbin", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{"bins", "[", 
         RowBox[{"[", 
          RowBox[{"whichbin", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "++"}]}], "]"}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "data", "]"}], "<", "2"}], ",", " ", 
       RowBox[{"sigma", "=", "0"}], ",", " ", 
       RowBox[{"sigma", "=", 
        RowBox[{"StandardDeviation", "[", "data", "]"}]}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"mu", "=", 
      RowBox[{"Mean", "[", "data", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "\[IndentingNewLine]", 
      RowBox[{"{", " ", 
       RowBox[{"mu", ",", " ", "sigma", ",", " ", "bins"}], "}"}], 
      "\[IndentingNewLine]", "]"}]}]}], " ", "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.55909130012917*^9, 3.5590913233336906`*^9}, {
  3.559091362392198*^9, 3.559091406470388*^9}, {3.559091445780253*^9, 
  3.559091538482525*^9}},ExpressionUUID->"070cbaad-81b0-4166-8815-\
0b977c1c04a5"]
}, Closed]],

Cell[CellGroupData[{

Cell["SimBinData", "Subsection",
 CellChangeTimes->{{3.557943782826378*^9, 
  3.557943784561921*^9}},ExpressionUUID->"427810be-1fab-4bb2-b214-\
79e67a351212"],

Cell["\<\
Returns a binning of saved simulation results of the form

{ {time, mean, standard deviation, {histogram at time}},
  {time, mean, standard defiation, {histogram at time}}, 
  ... } 
  
  for the specified variable. 
  
  Histograms are returned as lists of integers. 
  
  Values smaller than binmin are placed in bin 1
  Values greater than binmax are placed in bin (binmax-binbin)/bindelta
  
  Useful options:
  
  \[OpenCurlyDoubleQuote]PlotTimes\[CloseCurlyDoubleQuote]->{tstart, tend} -- \
if omitted, all data is used
  \[OpenCurlyDoubleQuote]Samples\[CloseCurlyDoubleQuote]->100 (Number of \
samples )(equally time spaced) to generate
  \[OpenCurlyDoubleQuote]MaxRadius\[CloseCurlyDoubleQuote]->Infinity
  \[OpenCurlyDoubleQuote]Origin\[CloseCurlyDoubleQuote]->{0,0}\
\>", "Text",
 CellChangeTimes->{{3.557947738551095*^9, 3.557947881166024*^9}, {
  3.5583675400897284`*^9, 3.558367600320115*^9}, {3.5583926862753067`*^9, 
  3.558392686851282*^9}, {3.558392763980476*^9, 
  3.558392769954501*^9}},ExpressionUUID->"6641bfc3-8f51-4ed0-afe2-\
fbc1e6201641"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SimBinData", "[", 
    RowBox[{"var_", ",", " ", 
     RowBox[{"{", 
      RowBox[{"binmin_", ",", " ", "binmax_", ",", " ", "bindelta_"}], "}"}], 
     ",", " ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "d", ",", "dPrint", ",", "SFiles", ",", "TFiles", ",", " ", "nS", ",", 
       "dbg", ",", "plots", ",", "f", ",", "plot", ",", "s", ",", "needed", 
       ",", " ", "solutionsneeded", ",", "solutionFiles", ",", "nFiles", ",", 
       " ", "nbins", ",", "bins", ",", " ", "binspec", ",", " ", "WhichBin", 
       ",", "  ", "samples", ",", " ", "reallyneeded", ",", " ", "results", 
       ",", "reverseneeded", ",", " ", "origin", ",", " ", "rmax", ",", " ", 
       "times", ",", " ", "tfile", ",", " ", "arg"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dbg", "=", 
       RowBox[{
        RowBox[{"\"\<Debug\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Debug\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"arg", "[", 
        RowBox[{"a_", "[", "b_", "]"}], "]"}], ":=", " ", "b"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dPrint", "[", "u___", "]"}], ":=", " ", 
       RowBox[{"If", "[", 
        RowBox[{"dbg", ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<SimBinData: \>\"", ",", " ", "u"}], "]"}]}], "]"}]}], 
      ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"nbins", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"binmax", "-", "binmin"}], ")"}], "/", "bindelta"}]}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"WhichBin", "[", "value_", "]"}], ":=", " ", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"value", "<", "binmin"}], ",", "1", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"value", " ", ">", "binmax"}], ",", "nbins", ",", 
         "\[IndentingNewLine]", "True", ",", " ", 
         RowBox[{
          RowBox[{"Floor", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"value", "-", "binmin"}], ")"}], "/", "bindelta"}], 
           "]"}], "+", "1"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Number", " ", "of", " ", "time", " ", "points", " ", "to", " ", 
        "sample"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"samples", "=", 
       RowBox[{
        RowBox[{"\"\<Samples\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Samples\>\"", "\[Rule]", " ", "100"}], "}"}]}]}], ";", 
      " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"origin", "=", 
       RowBox[{
        RowBox[{"\"\<Origin\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Origin\>\"", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "0"}], "}"}]}], "}"}]}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"rmax", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<MaxRadius\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<MaxRadius\>\"", "\[Rule]", " ", "\[Infinity]"}], 
         "}"}]}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", "stuff", "}"}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"stuff", " ", "=", " ", 
          RowBox[{"GetSimulationPoints", "[", " ", 
           RowBox[{
            RowBox[{"\"\<Points\>\"", "\[Rule]", " ", "samples"}], ",", " ", 
            "opt"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"SameQ", "[", 
            RowBox[{"stuff", ",", " ", "$Canceled"}], "]"}], ",", " ", 
           RowBox[{"Return", "[", "$Canceled", "]"}]}], "]"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"needed", " ", "=", " ", 
          RowBox[{"\"\<needed\>\"", "/.", "stuff"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"SFiles", "=", 
          RowBox[{"\"\<Solutions\>\"", "/.", "stuff"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"TFiles", "=", 
          RowBox[{"\"\<Tissues\>\"", "/.", "stuff"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"d", "=", 
          RowBox[{"\"\<folder\>\"", "/.", "stuff"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<d: \>\"", ",", " ", "d"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<needed: \>\"", ",", " ", "needed"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<SFiles: \>\"", ",", " ", "SFiles"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<TFiles: \>\"", ",", " ", "TFiles"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"d", "=", 
         RowBox[{"SystemDialogInput", "[", 
          RowBox[{"\"\<Directory\>\"", ",", " ", 
           RowBox[{"ToFileName", "[", 
            RowBox[{"HomeDirectory", "[", "]"}], "]"}], ",", " ", 
           RowBox[{
           "WindowTitle", "\[Rule]", " ", 
            "\"\<Please select the folder that contains Solution*.nb files.):\
\>\""}]}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"d", ",", "$Canceled"}], "]"}], ",", " ", 
        RowBox[{"Return", "[", "$Canceled", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
      RowBox[{"nS", "=", 
       RowBox[{"Length", "[", "SFiles", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<nS:\>\"", ",", " ", "nS"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"nS", "\[Equal]", "0"}], ",", " ", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<No Simulation results found in \>\"", "<>", "d"}], 
          "]"}], ";", " ", 
         RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"solutionsneeded", " ", "=", " ", 
       RowBox[{"First", "/@", "needed"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"solutionFiles", " ", "=", " ", 
       RowBox[{"SFiles", "[", 
        RowBox[{"[", "solutionsneeded", "]"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"nFiles", "=", 
       RowBox[{"Length", "[", "needed", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<nFiles: \>\"", ",", " ", "nFiles"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", "needed", "]"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"reverseneeded", "[", 
        RowBox[{"flist_", ",", " ", 
         RowBox[{"Rule", "[", 
          RowBox[{"A_", ",", " ", 
           RowBox[{"B_", "?", "ListQ"}]}], "]"}]}], "]"}], ":=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"#", ",", 
           RowBox[{"flist", "[", 
            RowBox[{"[", "A", "]"}], "]"}]}], "}"}], "&"}], "/@", "B"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"reallyneeded", "=", 
       RowBox[{"Join", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"reverseneeded", "[", 
            RowBox[{"SFiles", ",", "#"}], "]"}], "&"}], "/@", "needed"}], 
         ")"}]}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"times", " ", "=", 
       RowBox[{"First", "/@", "reallyneeded"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"SFiles", " ", "=", " ", 
       RowBox[{"Last", "/@", "reallyneeded"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"TFiles", " ", "=", " ", 
       RowBox[{"Last", "/@", 
        RowBox[{"(", 
         RowBox[{"Join", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"reverseneeded", "[", 
              RowBox[{"TFiles", ",", "#"}], "]"}], "&"}], "/@", "needed"}], 
           ")"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", "times", "]"}], ";", " ", "\[IndentingNewLine]", 
      
      RowBox[{"dPrint", "[", "SFiles", "]"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", "TFiles", "]"}], ";", " ", "\[IndentingNewLine]",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<reallyneeded: \>\"", ",", " ", "reallyneeded"}], "]"}], 
      ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"results", "=", 
       RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "time", ",", "file", ",", "S", ",", " ", "T", ",", "T1", ",", " ", 
          "R", ",", "CN", ",", "inside", ",", " ", "variables", ",", "values",
           ",", " ", "whichbin", ",", "i", ",", " ", "sigma"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"BINS", "=", 
          RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "SFiles", "]"}], ">", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"time", " ", "=", " ", 
             RowBox[{"First", "[", "times", "]"}]}], ";", " ", 
            RowBox[{"times", "=", 
             RowBox[{"Rest", "[", "times", "]"}]}], ";", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"file", "=", 
             RowBox[{"First", "[", "SFiles", "]"}]}], ";", " ", 
            RowBox[{"SFiles", "=", 
             RowBox[{"Rest", "[", "SFiles", "]"}]}], ";", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"tfile", "=", 
             RowBox[{"First", "[", "TFiles", "]"}]}], ";", " ", 
            RowBox[{"TFiles", "=", 
             RowBox[{"Rest", "[", "TFiles", "]"}]}], ";", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"dPrint", "[", 
             RowBox[{
             "\"\<=============================================\\nt=\>\"", 
              ",", "time", ",", " ", "\"\< \>\"", ",", " ", "file", ",", " ", 
              "\"\< \>\"", ",", " ", "tfile"}], "]"}], ";", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"S", "=", 
             RowBox[{"Get", "[", "file", "]"}]}], ";", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"T", "=", 
             RowBox[{"ToExpression", "[", 
              RowBox[{"Get", "[", "tfile", "]"}], "]"}]}], ";", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"CN", "=", 
             RowBox[{"First", "/@", 
              RowBox[{"TissueCells", "[", "T", "]"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"T1", "=", 
             RowBox[{"DTissue2Tissue", "[", 
              RowBox[{"T", ",", "S", ",", "time"}], "]"}]}], ";", " ", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"R", "=", 
             RowBox[{"Norm", "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"#", "-", "origin"}], ")"}], "&"}], "/@", 
                RowBox[{"Centeroid", "[", "T1", "]"}]}], ")"}]}]}], ";", " ", 
            "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
            RowBox[{"R", "=", 
             RowBox[{"Transpose", "[", 
              RowBox[{"{", 
               RowBox[{"CN", ",", "R"}], "}"}], "]"}]}], ";", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"dPrint", "[", 
             RowBox[{"\"\<R=\>\"", ",", "R"}], "]"}], ";", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"R", "=", 
             RowBox[{"Select", "[", 
              RowBox[{"R", ",", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Last", "[", "#", "]"}], "<", "rmax"}], ")"}], 
                "&"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
            RowBox[{"inside", " ", "=", " ", 
             RowBox[{"First", "/@", "R"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"dPrint", "[", 
             RowBox[{"\"\<inside=\>\"", ",", "inside"}], "]"}], ";", " ", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"variables", " ", "=", " ", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"First", "/@", "S"}], ",", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"Head", "[", "#", "]"}], "\[Equal]", "var"}], 
                "&"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"Print", "[", "variables", "]"}], ";"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"variables", "=", 
             RowBox[{"Select", "[", 
              RowBox[{"variables", ",", " ", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{"inside", ",", 
                  RowBox[{"arg", "[", "#", "]"}]}], "]"}], "&"}]}], "]"}]}], 
            ";", " ", "\[IndentingNewLine]", 
            RowBox[{"dPrint", "[", "variables", "]"}], ";", " ", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"values", " ", "=", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"#", "[", "time", "]"}], ")"}], "&"}], "/@", 
                "variables"}], ")"}], "/.", "S"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"dPrint", "[", "values", "]"}], ";", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"bins", "=", 
             RowBox[{"Table", "[", 
              RowBox[{"0", ",", 
               RowBox[{"{", "nbins", "}"}]}], "]"}]}], ";", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"whichbin", "=", 
             RowBox[{"WhichBin", "/@", "values"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"dPrint", "[", "whichbin", "]"}], ";", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"i", "=", "1"}], ",", 
              RowBox[{"i", "\[LessEqual]", 
               RowBox[{"Length", "[", "whichbin", "]"}]}], ",", 
              RowBox[{"i", "++"}], ",", 
              RowBox[{
               RowBox[{"bins", "[", 
                RowBox[{"[", 
                 RowBox[{"whichbin", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "++"}]}], 
             "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "values", "]"}], "<", "2"}], ",", " ", 
              RowBox[{"sigma", "=", "0"}], ",", " ", 
              RowBox[{"sigma", "=", 
               RowBox[{"StandardDeviation", "[", "values", "]"}]}]}], "]"}], 
            ";", " ", "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"results", ",", " ", 
              RowBox[{"{", 
               RowBox[{"time", ",", " ", 
                RowBox[{"Mean", "[", "values", "]"}], ",", " ", "sigma", ",", 
                " ", "bins"}], "}"}]}], "]"}], ";"}]}], " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "]"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "results", "]"}], ";"}]}], " ", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.548437263326236*^9, 3.548437374961083*^9}, {
   3.5484375616559353`*^9, 3.54843764908666*^9}, {3.548437729537332*^9, 
   3.548437831465444*^9}, {3.548437863617003*^9, 3.54843792662136*^9}, {
   3.548438024895612*^9, 3.548438028572076*^9}, {3.548438069146846*^9, 
   3.548438079049385*^9}, {3.556742637088942*^9, 3.556742683719068*^9}, {
   3.5567456586757383`*^9, 3.556745750771009*^9}, {3.556745785230227*^9, 
   3.556745804982335*^9}, {3.556746297327433*^9, 3.556746367322157*^9}, {
   3.556746438067835*^9, 3.556746489698015*^9}, {3.5567465197381496`*^9, 
   3.556746694508387*^9}, {3.556746735874075*^9, 3.5567467463615227`*^9}, {
   3.5567467977714367`*^9, 3.556746861125244*^9}, 3.55674690540272*^9, {
   3.556747045711876*^9, 3.556747056624339*^9}, {3.5567475216919193`*^9, 
   3.556747623771397*^9}, 3.556747658351376*^9, {3.5567476904901953`*^9, 
   3.556747871573868*^9}, {3.5567479244570312`*^9, 3.55674796725872*^9}, {
   3.5567480365129766`*^9, 3.556748175512288*^9}, 3.5567482137339363`*^9, {
   3.5567482742278976`*^9, 3.556748294681519*^9}, {3.5567483377319307`*^9, 
   3.5567483391890583`*^9}, {3.556748372668949*^9, 3.5567483970495167`*^9}, {
   3.556748464612012*^9, 3.556748522511273*^9}, {3.556748565886963*^9, 
   3.556748707190879*^9}, {3.556748745324296*^9, 3.556748755298688*^9}, {
   3.556748833901279*^9, 3.556748876694633*^9}, {3.556748969693573*^9, 
   3.556748978226964*^9}, {3.556749017015739*^9, 3.5567490729753513`*^9}, {
   3.556749150257024*^9, 3.556749331977042*^9}, {3.556749406391398*^9, 
   3.5567494413834352`*^9}, {3.557943802301447*^9, 3.557943806223646*^9}, {
   3.557943889956931*^9, 3.5579438957968388`*^9}, {3.557943943496249*^9, 
   3.557943969427353*^9}, {3.557943999610979*^9, 3.5579440112751226`*^9}, {
   3.557944060847664*^9, 3.5579441362165003`*^9}, {3.557944170584401*^9, 
   3.557944177860036*^9}, {3.557944480802332*^9, 3.557944595010289*^9}, {
   3.5579446254769287`*^9, 3.557944673012157*^9}, {3.557944754625148*^9, 
   3.557944759555447*^9}, {3.557944794581078*^9, 3.5579447954844007`*^9}, {
   3.557944991007568*^9, 3.5579449939935923`*^9}, {3.5579450376787167`*^9, 
   3.557945039135435*^9}, {3.557945423100719*^9, 3.557945489207123*^9}, {
   3.5579455273531427`*^9, 3.557945536640349*^9}, {3.557945651365561*^9, 
   3.557945673509109*^9}, {3.55794570505268*^9, 3.557945711494462*^9}, {
   3.557945834747384*^9, 3.557945835290668*^9}, {3.557945867369335*^9, 
   3.55794587569703*^9}, {3.557945917073228*^9, 3.5579460460286922`*^9}, {
   3.557946108604292*^9, 3.557946189434235*^9}, {3.557946228177493*^9, 
   3.5579463412229156`*^9}, {3.55794638208025*^9, 3.557946597372506*^9}, {
   3.55794662787999*^9, 3.5579466497452497`*^9}, 3.5579466834146442`*^9, {
   3.5579467606644287`*^9, 3.557946802543686*^9}, {3.557946849853776*^9, 
   3.5579468595365143`*^9}, {3.557947092653179*^9, 3.557947111157399*^9}, {
   3.557947301161399*^9, 3.557947462597624*^9}, {3.557947518520668*^9, 
   3.55794754380651*^9}, {3.557947607540737*^9, 3.557947653385457*^9}, {
   3.558365864167412*^9, 3.5583659173471947`*^9}, {3.558365962443945*^9, 
   3.558365975769045*^9}, {3.55836600872226*^9, 3.5583660858966007`*^9}, {
   3.558366157275632*^9, 3.558366188055087*^9}, {3.558366234129023*^9, 
   3.5583663960309563`*^9}, {3.558366441878883*^9, 3.5583664473476133`*^9}, {
   3.5583664942555847`*^9, 3.558366576368432*^9}, {3.5583666095176077`*^9, 
   3.5583666146296062`*^9}, {3.558366651823228*^9, 3.558366692955173*^9}, {
   3.558366741961882*^9, 3.558366822020815*^9}, {3.55836686040755*^9, 
   3.558366862950151*^9}, {3.558366943141837*^9, 3.5583670471628227`*^9}, {
   3.558367086353634*^9, 3.558367116805826*^9}, {3.5583671535676317`*^9, 
   3.558367197649045*^9}, {3.558367258044663*^9, 3.5583673477869596`*^9}, {
   3.558367381305214*^9, 3.558367434053335*^9}, {3.558367467307513*^9, 
   3.558367530495689*^9}, {3.5583711872953978`*^9, 3.558371189822826*^9}, {
   3.5583712687980556`*^9, 3.5583713555603313`*^9}, {3.5583713888384113`*^9, 
   3.558371414182693*^9}, {3.558371470413393*^9, 3.5583714708593197`*^9}, {
   3.558372261406969*^9, 3.558372291586196*^9}, 3.558384634558577*^9, {
   3.5583849443578653`*^9, 3.558384980055416*^9}, {3.558385060223051*^9, 
   3.558385117786601*^9}, {3.558385165885371*^9, 3.5583851677675467`*^9}, {
   3.558385209270973*^9, 3.558385230954206*^9}, {3.558392738209083*^9, 
   3.5583927384080563`*^9}, {3.55999241978826*^9, 3.559992465363811*^9}, 
   3.56648922612016*^9},ExpressionUUID->"d0211f82-8522-4b92-a107-\
2f85efcb7170"]
}, Closed]],

Cell[CellGroupData[{

Cell["SimBinSides", "Subsection",
 CellChangeTimes->{{3.558051347872541*^9, 
  3.55805134960058*^9}},ExpressionUUID->"1651eec3-164c-4237-b9d9-\
aa9d9faeb262"],

Cell["\<\
Returns histograms of the number of sides (neighbors) that each cell has. \
Examines the tissue after each division.

\[OpenCurlyDoubleQuote]Select\[CloseCurlyDoubleQuote]->{1,Infinity} or select \
a subset of tissues
\[OpenCurlyDoubleQuote]MaxRadius\[CloseCurlyDoubleQuote]->Infinity
\[OpenCurlyDoubleQuote]Origin\[CloseCurlyDoubleQuote]->{0,0} (for use with \
MaxRadius)
\
\>", "Text",
 CellChangeTimes->{{3.5580513734488373`*^9, 3.5580513969685783`*^9}, {
  3.558392664692925*^9, 3.558392703131632*^9}, {3.558392775490519*^9, 
  3.55839279240231*^9}},ExpressionUUID->"61895fb7-5ab3-48eb-b660-\
451adc832a4c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SimBinSides", "[", " ", 
    RowBox[{"opt___", "?", "OptionQ"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "d", ",", "dbg", ",", "dPrint", ",", "f", ",", "file", ",", "T", ",", 
       "c", ",", "bins", ",", "i", ",", "ncells", ",", "sides", ",", "hbin", 
       ",", "results", ",", " ", "selected", ",", " ", "first", ",", " ", 
       "last", ",", " ", "j", ",", " ", "rmax", ",", " ", "origin", ",", " ", 
       "R"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dbg", "=", 
       RowBox[{
        RowBox[{"\"\<Debug\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Debug\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dPrint", "[", "u___", "]"}], ":=", " ", 
       RowBox[{"If", "[", 
        RowBox[{"dbg", ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<SimBinData: \>\"", ",", " ", "u"}], "]"}]}], "]"}]}], 
      ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"selected", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<Select\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Select\>\"", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{"1", ",", "Infinity"}], "}"}]}], "}"}]}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"selected", "=", 
       RowBox[{
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"{", "selected", "}"}], ",", " ", "Infinity"}], "]"}], "//",
         "Flatten"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"first", "=", 
       RowBox[{"selected", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"last", "=", 
       RowBox[{"selected", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"rmax", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<MaxRadius\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<MaxRadius\>\"", "\[Rule]", " ", "\[Infinity]"}], 
         "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"origin", "=", 
       RowBox[{
        RowBox[{"\"\<Origin\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Origin\>\"", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "0"}], "}"}]}], "}"}]}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"SystemDialogInput", "[", 
        RowBox[{"\"\<Directory\>\"", ",", " ", 
         RowBox[{"ToFileName", "[", 
          RowBox[{"HomeDirectory", "[", "]"}], "]"}], ",", " ", 
         RowBox[{
         "WindowTitle", "\[Rule]", " ", 
          "\"\<Please select the folder that contains Tissue*.nb \
files.):\>\""}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"f", "=", 
       RowBox[{"FileNames", "[", 
        RowBox[{"ToFileName", "[", 
         RowBox[{"d", ",", "\"\<DTissue*.nb\>\""}], "]"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<Tissues: \>\"", ",", " ", "f"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<d=\>\"", ",", "d"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<f=\>\"", ",", " ", 
        RowBox[{"Short", "[", 
         RowBox[{"f", ",", "5"}], "]"}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"results", "=", 
       RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"j", "=", "0"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "f", "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"j", "++"}], ";", " ", "\[IndentingNewLine]", 
         RowBox[{"file", "=", 
          RowBox[{"First", "[", "f", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"f", "=", 
          RowBox[{"Rest", "[", "f", "]"}]}], ";", " ", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"j", "<", "first"}], ",", " ", 
           RowBox[{"Continue", "[", "]"}]}], "]"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"j", ">", "last"}], ",", " ", 
           RowBox[{"Break", "[", "]"}]}], "]"}], ";", " ", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"T", "=", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"Get", "[", "file", "]"}], "]"}]}], ";", " ", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "identify", " ", "which", " ", "cels", " ", "have", " ", "middles", 
           " ", "beyond", " ", "the", " ", "known", " ", "universe"}], "*)"}],
          "\[IndentingNewLine]", 
         RowBox[{"R", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "<", "rmax"}], ")"}], "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{"Norm", "/@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"#", "-", "origin"}], ")"}], "&"}], "/@", 
               RowBox[{"Centeroid", "[", "T", "]"}]}], ")"}]}], ")"}]}]}], 
         ";", " ", "\[IndentingNewLine]", 
         RowBox[{"c", "=", 
          RowBox[{"Length", "/@", 
           RowBox[{"Last", "/@", 
            RowBox[{"TissueCells", "[", "T", "]"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "only", " ", "pick", " ", "cells", " ", "inside", " ", "the", " ", 
           "known", " ", "universe"}], " ", "*)"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"c", "=", 
          RowBox[{"Pick", "[", 
           RowBox[{"c", ",", " ", "R"}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"ncells", "=", 
          RowBox[{"Length", "[", "c", "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"bins", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", "15", "}"}]}], "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "1"}], ",", 
           RowBox[{"i", "\[LessEqual]", " ", "ncells"}], ",", " ", 
           RowBox[{"i", "++"}], ",", " ", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"sides", "=", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"c", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "15"}], "]"}]}], ";", 
            " ", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"bins", "[", 
              RowBox[{"[", "sides", "]"}], "]"}], "++"}]}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"hbin", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Mean", "[", 
             RowBox[{"1.0", "*", "c"}], "]"}], ",", " ", 
            RowBox[{"StandardDeviation", "[", 
             RowBox[{"1.0", "*", "c"}], "]"}], ",", " ", "bins"}], "}"}]}], 
         ";", " ", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"results", ",", "hbin"}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "results", "]"}], ";"}]}], " ", 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.548437263326236*^9, 3.548437374961083*^9}, {
   3.5484375616559353`*^9, 3.54843764908666*^9}, {3.548437729537332*^9, 
   3.548437831465444*^9}, {3.548437863617003*^9, 3.54843792662136*^9}, {
   3.548438024895612*^9, 3.548438028572076*^9}, {3.548438069146846*^9, 
   3.548438079049385*^9}, {3.556742637088942*^9, 3.556742683719068*^9}, {
   3.5567456586757383`*^9, 3.556745750771009*^9}, {3.556745785230227*^9, 
   3.556745804982335*^9}, {3.556746297327433*^9, 3.556746367322157*^9}, {
   3.556746438067835*^9, 3.556746489698015*^9}, {3.5567465197381496`*^9, 
   3.556746694508387*^9}, {3.556746735874075*^9, 3.5567467463615227`*^9}, {
   3.5567467977714367`*^9, 3.556746861125244*^9}, 3.55674690540272*^9, {
   3.556747045711876*^9, 3.556747056624339*^9}, {3.5567475216919193`*^9, 
   3.556747623771397*^9}, 3.556747658351376*^9, {3.5567476904901953`*^9, 
   3.556747871573868*^9}, {3.5567479244570312`*^9, 3.55674796725872*^9}, {
   3.5567480365129766`*^9, 3.556748175512288*^9}, 3.5567482137339363`*^9, {
   3.5567482742278976`*^9, 3.556748294681519*^9}, {3.5567483377319307`*^9, 
   3.5567483391890583`*^9}, {3.556748372668949*^9, 3.5567483970495167`*^9}, {
   3.556748464612012*^9, 3.556748522511273*^9}, {3.556748565886963*^9, 
   3.556748707190879*^9}, {3.556748745324296*^9, 3.556748755298688*^9}, {
   3.556748833901279*^9, 3.556748876694633*^9}, {3.556748969693573*^9, 
   3.556748978226964*^9}, {3.556749017015739*^9, 3.5567490729753513`*^9}, {
   3.556749150257024*^9, 3.556749331977042*^9}, {3.556749406391398*^9, 
   3.5567494413834352`*^9}, {3.557943802301447*^9, 3.557943806223646*^9}, {
   3.557943889956931*^9, 3.5579438957968388`*^9}, {3.557943943496249*^9, 
   3.557943969427353*^9}, {3.557943999610979*^9, 3.5579440112751226`*^9}, {
   3.557944060847664*^9, 3.5579441362165003`*^9}, {3.557944170584401*^9, 
   3.557944177860036*^9}, {3.557944480802332*^9, 3.557944595010289*^9}, {
   3.5579446254769287`*^9, 3.557944673012157*^9}, {3.557944754625148*^9, 
   3.557944759555447*^9}, {3.557944794581078*^9, 3.5579447954844007`*^9}, {
   3.557944991007568*^9, 3.5579449939935923`*^9}, {3.5579450376787167`*^9, 
   3.557945039135435*^9}, {3.557945423100719*^9, 3.557945489207123*^9}, {
   3.5579455273531427`*^9, 3.557945536640349*^9}, {3.557945651365561*^9, 
   3.557945673509109*^9}, {3.55794570505268*^9, 3.557945711494462*^9}, {
   3.557945834747384*^9, 3.557945835290668*^9}, {3.557945867369335*^9, 
   3.55794587569703*^9}, {3.557945917073228*^9, 3.5579460460286922`*^9}, {
   3.557946108604292*^9, 3.557946189434235*^9}, {3.557946228177493*^9, 
   3.5579463412229156`*^9}, {3.55794638208025*^9, 3.557946597372506*^9}, {
   3.55794662787999*^9, 3.5579466497452497`*^9}, 3.5579466834146442`*^9, {
   3.5579467606644287`*^9, 3.557946802543686*^9}, {3.557946849853776*^9, 
   3.5579468595365143`*^9}, {3.557947092653179*^9, 3.557947111157399*^9}, {
   3.557947301161399*^9, 3.557947462597624*^9}, {3.557947518520668*^9, 
   3.55794754380651*^9}, {3.557947607540737*^9, 3.557947653385457*^9}, {
   3.5580502975465927`*^9, 3.558050324522612*^9}, {3.558050355608026*^9, 
   3.558050378114327*^9}, {3.558050409409322*^9, 3.558050519846949*^9}, 
   3.55805057484719*^9, {3.558050610280973*^9, 3.55805062031327*^9}, {
   3.558050705369425*^9, 3.558050810011117*^9}, {3.55805086958869*^9, 
   3.5580508778339653`*^9}, {3.55805091453683*^9, 3.558050944896552*^9}, {
   3.558050993196353*^9, 3.558050994323601*^9}, {3.55805102466063*^9, 
   3.558051189249339*^9}, {3.558051240762422*^9, 3.55805136702205*^9}, {
   3.5580514239293623`*^9, 3.558051427526491*^9}, {3.558392403687557*^9, 
   3.558392441372847*^9}, {3.5583925160890217`*^9, 3.558392605666089*^9}, {
   3.558392719329834*^9, 3.558392730680698*^9}, {3.558392785956429*^9, 
   3.558392844431081*^9}, {3.558392875931629*^9, 3.5583929820305243`*^9}, {
   3.5583930234182863`*^9, 3.5583930291352863`*^9}, {3.5583930720929956`*^9, 
   3.558393074644301*^9}, {3.559992369873171*^9, 
   3.5599923854352503`*^9}},ExpressionUUID->"e4f1712f-7ab1-4397-ae4e-\
4d4532d45353"]
}, Closed]],

Cell[CellGroupData[{

Cell["SimPlot, MultiSimPlot", "Subsection",
 CellChangeTimes->{{3.4524397912557907`*^9, 3.45243979227591*^9}, {
  3.489585092728236*^9, 
  3.489585096159457*^9}},ExpressionUUID->"d3c8bc04-e426-4e04-9f26-\
965db917ae10"],

Cell[CellGroupData[{

Cell["SimPlot[solution, var, {tbegin, tend}, opt];", "Subsubsection",
 CellChangeTimes->{{3.452380535227388*^9, 3.452380540140277*^9}, {
  3.4524396202142982`*^9, 3.452439622164597*^9}, {3.4524397949752617`*^9, 
  3.452439804144505*^9}},ExpressionUUID->"3b8c1d09-d63f-42c9-8b14-\
b403d17bae67"],

Cell["\<\
rev. 2.1.a.20 to return a blank graphics object in the event the variable is \
not found - this way if multiple solutions are strung together in a dynamic \
simulation where the variable only exists in some of them it will work.\
\>", "Text",
 CellChangeTimes->{{3.489500044800624*^9, 
  3.489500078029598*^9}},ExpressionUUID->"2ec6945b-f1f3-4ac6-9228-\
2f73c33d635e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SimPlot", "[", 
    RowBox[{
     RowBox[{"solution_", "?", "ListQ"}], ",", " ", "var_", ",", " ", 
     RowBox[{"{", 
      RowBox[{"tbegin_", ",", " ", "tend_"}], "}"}], ",", " ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "allvars", ",", " ", "vars", ",", " ", "s", ",", " ", "n", ",", " ", 
       "timepoints", ",", " ", "dt", ",", " ", "fline", ",", " ", "lines", 
       ",", " ", "colors", ",", " ", "nvars"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{
        RowBox[{"\"\<Points\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Points\>\"", "\[Rule]", " ", "100"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dt", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"tend", "-", "tbegin"}], ")"}], "/", "n"}]}], ";", "  ", 
      "\[IndentingNewLine]", 
      RowBox[{"timepoints", "=", 
       RowBox[{"1.0", "*", 
        RowBox[{"Range", "[", 
         RowBox[{"tbegin", ",", " ", 
          RowBox[{"tbegin", "+", 
           RowBox[{"n", "*", "dt"}]}], ",", " ", "dt"}], "]"}]}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"s", "=", 
       RowBox[{"Flatten", "[", "solution", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"allvars", " ", "=", " ", 
       RowBox[{"First", "/@", "s"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vars", " ", "=", " ", 
       RowBox[{"Select", "[", 
        RowBox[{"allvars", ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"SameQ", "[", 
            RowBox[{"#", ",", "var"}], "]"}], "\[Or]", 
           RowBox[{"SameQ", "[", 
            RowBox[{
             RowBox[{"Head", "[", "#", "]"}], ",", " ", "var"}], "]"}]}], 
          "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nvars", "=", 
       RowBox[{"Length", "[", "vars", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"s", "=", 
       RowBox[{"vars", "/.", "s"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fline", " ", "[", "if_", "]"}], ":=", 
       RowBox[{"Line", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"#", ",", " ", 
            RowBox[{"if", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
         "timepoints"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"lines", " ", "=", " ", 
       RowBox[{"fline", "/@", "s"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"colors", " ", "=", " ", 
       RowBox[{"Hue", "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1.0", "/", 
            RowBox[{"(", 
             RowBox[{"nvars", "+", "1"}], ")"}]}], ")"}], "*", 
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", 
            RowBox[{"nvars", "-", "1"}]}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Length", "[", "colors", "]"}], ",", " ", 
        RowBox[{"Length", "[", "lines", "]"}]}], "}"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"lines", " ", "=", " ", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Graphics", "[", 
           RowBox[{"{", 
            RowBox[{"#1", ",", " ", "#2"}], "}"}], "]"}], "&"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"colors", ",", " ", "lines"}], "}"}]}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "lines", "]"}], "<", "1"}], ",", " ", 
        RowBox[{"lines", "=", 
         RowBox[{"{", 
          RowBox[{"Graphics", "[", "]"}], "}"}]}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"sopt", "=", 
          RowBox[{"MyFilterOptions", "[", 
           RowBox[{"Plot", ",", "opt"}], "]"}]}], "}"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"Show", "[", 
         RowBox[{"lines", ",", " ", "sopt", ",", " ", 
          RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"AspectRatio", "\[Rule]", " ", "1"}], ",", " ", 
          RowBox[{"PlotLabel", "\[Rule]", " ", 
           RowBox[{"ToString", "[", "var", "]"}]}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.452380544365279*^9, 3.452380675813634*^9}, {
  3.45238071983814*^9, 3.452380731469839*^9}, {3.452380774727714*^9, 
  3.45238080813715*^9}, {3.452380905347002*^9, 3.4523812757788887`*^9}, {
  3.4523813543033743`*^9, 3.452381646137637*^9}, {3.4523817142387857`*^9, 
  3.4523817404738407`*^9}, {3.452439624871562*^9, 3.452439626780121*^9}, {
  3.4531590625537033`*^9, 3.453159066322896*^9}, {3.489499869772521*^9, 
  3.489499938577197*^9}, {3.489499991862303*^9, 3.4895000269958763`*^9}, {
  3.548437461689747*^9, 
  3.548437462914981*^9}},ExpressionUUID->"a13ffb56-be30-4ff5-b53b-\
80b3440ba8d9"]
}, Closed]],

Cell[CellGroupData[{

Cell["SimPlot[solution, {var__}, {tbegin, tend}, opt]", "Subsubsection",
 CellChangeTimes->{{3.45244188461471*^9, 
  3.452441899473249*^9}},ExpressionUUID->"55f3bdd8-c5c6-46c5-b7bb-\
a853e9b3122e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SimPlot", "[", 
   RowBox[{
    RowBox[{"solution_", "?", "ListQ"}], ",", " ", 
    RowBox[{"{", "var__", "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"tbegin_", ",", " ", "tend_"}], "}"}], ",", " ", 
    RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", " ", 
     RowBox[{"plots", ",", " ", "columns"}], "}"}], ",", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"make", " ", "the", " ", "plots"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"plots", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"SimPlot", "[", 
         RowBox[{"solution", ",", " ", "#", ",", " ", 
          RowBox[{"{", 
           RowBox[{"tbegin", ",", " ", "tend"}], "}"}], ",", " ", "opt"}], 
         "]"}], "&"}], "/@", 
       RowBox[{"{", "var", "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\"\<Grid\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Grid\>\"", "\[Rule]", " ", "False"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"columns", " ", "=", " ", 
         RowBox[{
          RowBox[{"\"\<Columns\>\"", "/.", 
           RowBox[{"{", "opt", "}"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{"\"\<Columns\>\"", "\[Rule]", " ", "3"}], "}"}]}]}], ";", 
        " ", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{"Length", "[", "plots", "]"}], ",", " ", "columns"}], 
            "]"}], "\[NotEqual]", " ", "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"plots", ",", " ", 
            RowBox[{"Graphics", "[", 
             RowBox[{"{", "}"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"plots", " ", "=", " ", 
         RowBox[{"Partition", "[", 
          RowBox[{"plots", ",", " ", "columns"}], "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"plots", "=", 
         RowBox[{"GraphicsGrid", "[", "plots", "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
     "plots"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.452441902225326*^9, 3.4524420002536793`*^9}, {
  3.452442128707768*^9, 3.4524421351426487`*^9}, {3.452442165791459*^9, 
  3.452442174937709*^9}, {3.548437474446677*^9, 
  3.5484374766354437`*^9}},ExpressionUUID->"d73e1cab-20b0-4ddf-9904-\
9bea85f70b1d"]
}, Closed]],

Cell[CellGroupData[{

Cell["SimPlot[solution, var, opt]", "Subsubsection",
 CellChangeTimes->{{3.45244188461471*^9, 3.452441899473249*^9}, {
  3.453735920288546*^9, 3.453735934774558*^9}, {3.55674610267102*^9, 
  3.556746103975381*^9}},ExpressionUUID->"8f8201bd-2d03-4211-805a-\
12256eb4871d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SimPlot", "[", 
   RowBox[{
    RowBox[{"solution_", "?", "ListQ"}], ",", " ", "var_", ",", " ", 
    RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", " ", 
     RowBox[{
     "plot", ",", " ", "columns", ",", " ", "tbegin", ",", " ", "tend"}], 
     "}"}], ",", " ", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"make", " ", "the", " ", "plots"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tbegin", ",", "tend"}], "}"}], "=", 
      RowBox[{"CommonTimeDomain", "[", "solution", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"plot", " ", "=", " ", 
      RowBox[{"SimPlot", "[", 
       RowBox[{"solution", ",", " ", "var", ",", " ", 
        RowBox[{"{", 
         RowBox[{"tbegin", ",", " ", "tend"}], "}"}], ",", " ", "opt"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "plot", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.452441902225326*^9, 3.4524420002536793`*^9}, {
  3.452442128707768*^9, 3.4524421351426487`*^9}, {3.452442165791459*^9, 
  3.452442174937709*^9}, {3.453735943666884*^9, 3.453736047950569*^9}, {
  3.54843739344306*^9, 
  3.548437394763303*^9}},ExpressionUUID->"a90f2d74-57e3-4903-847c-\
90d4c7c86725"]
}, Closed]],

Cell[CellGroupData[{

Cell["SimPlot[solution, {tbegin, tend}, opt]", "Subsubsection",
 CellChangeTimes->{{3.452439815479845*^9, 3.45243982614016*^9}, {
  3.452440833488366*^9, 
  3.452440834008266*^9}},ExpressionUUID->"b6b1a907-0865-4aa6-9165-\
d037afaa72ab"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SimPlot", "[", 
   RowBox[{
    RowBox[{"solution_", "?", "ListQ"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"tbegin_", ",", " ", "tend_"}], "}"}], ",", " ", 
    RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"allvars", ",", "  ", "plots", ",", " ", "columns"}], "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"allvars", " ", "=", " ", 
      RowBox[{"IndexedVarsInSolution", "[", "solution", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"plots", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"SimPlot", "[", 
         RowBox[{"solution", ",", " ", "#", ",", " ", 
          RowBox[{"{", 
           RowBox[{"tbegin", ",", " ", "tend"}], "}"}], ",", " ", "opt"}], 
         "]"}], "&"}], "/@", "allvars"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\"\<Grid\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Grid\>\"", "\[Rule]", " ", "False"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"columns", " ", "=", " ", 
         RowBox[{
          RowBox[{"\"\<Columns\>\"", "/.", 
           RowBox[{"{", "opt", "}"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{"\"\<Columns\>\"", "\[Rule]", " ", "3"}], "}"}]}]}], ";", 
        " ", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{"Length", "[", "plots", "]"}], ",", " ", "columns"}], 
            "]"}], "\[NotEqual]", " ", "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"plots", ",", " ", 
            RowBox[{"Graphics", "[", 
             RowBox[{"{", "}"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"plots", " ", "=", " ", 
         RowBox[{"Partition", "[", 
          RowBox[{"plots", ",", " ", "columns"}], "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"plots", "=", 
         RowBox[{"GraphicsGrid", "[", "plots", "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
     "plots"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.452439829045239*^9, 3.4524399203988333`*^9}, {
  3.452440000418992*^9, 3.452440034029361*^9}, {3.452440133763942*^9, 
  3.452440164669353*^9}, {3.4524402043876963`*^9, 3.4524404065860367`*^9}, {
  3.452440603128776*^9, 3.452440693421342*^9}, {3.452441718288293*^9, 
  3.452441761407061*^9}, {3.548437446081172*^9, 
  3.548437447171068*^9}},ExpressionUUID->"1d6b3bd6-56af-42a9-b336-\
401c763bfe5c"]
}, Closed]],

Cell[CellGroupData[{

Cell["SimPlot[solution, opt]", "Subsubsection",
 CellChangeTimes->{{3.4524408484259577`*^9, 
  3.452440854704081*^9}},ExpressionUUID->"44e5db67-9836-4f25-ac7f-\
bde228974f09"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SimPlot", "[", 
    RowBox[{
     RowBox[{"solution_", "?", "ListQ"}], ",", " ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"start", ",", " ", "stop", ",", " ", "times", ",", "p"}], "}"}],
      ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"determine", " ", "common", " ", "time", " ", "domain"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"times", "=", 
       RowBox[{"CommonTimeDomain", "[", "solution", "]"}]}], ";", "  ", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"times", ",", " ", "$Failed"}], "]"}], ",", " ", 
        RowBox[{
         RowBox[{
         "Print", "[", "\"\<Error: SimPlot: No common time domain.\>\"", 
          "]"}], ";", " ", 
         RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"start", ",", " ", "stop"}], "}"}], "=", "times"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"p", "=", 
       RowBox[{"SimPlot", "[", 
        RowBox[{"solution", ",", " ", 
         RowBox[{"{", 
          RowBox[{"start", ",", " ", "stop"}], "}"}], ",", " ", "opt"}], 
        "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "p", "]"}], ";"}]}], " ", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.452440856609964*^9, 3.45244085794833*^9}, {
  3.4524409397766247`*^9, 3.45244097866241*^9}, {3.4524410279290237`*^9, 
  3.4524410500117283`*^9}, {3.452441124251218*^9, 3.452441125055695*^9}, {
  3.4524411643404713`*^9, 3.452441274487235*^9}, {3.452441344749802*^9, 
  3.452441405986665*^9}, {3.452441483981689*^9, 3.452441522460338*^9}, {
  3.452441559757691*^9, 3.452441564062378*^9}, {3.5484374522378063`*^9, 
  3.548437453227647*^9}},ExpressionUUID->"7290ccc7-967e-402f-b477-\
a55313a91ec7"]
}, Closed]],

Cell[CellGroupData[{

Cell["MultSimPlot", "Subsubsection",
 CellChangeTimes->{{3.4895851044551373`*^9, 
  3.489585106678644*^9}},ExpressionUUID->"3c93587a-6d90-4bcc-a0cd-\
10c1cd4e8868"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MultiSimPlot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"solutions__", "?", "ListQ"}], "}"}], ",", " ", "var_", ",", " ", 
    RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"SimPlot", "[", 
      RowBox[{"#", ",", "var", ",", " ", "opt"}], "]"}], "&"}], "/@", 
    RowBox[{"{", "solutions", "}"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4895851077593603`*^9, 3.489585127554944*^9}, {
  3.4895851673594513`*^9, 3.489585203832089*^9}, {3.5484374994390697`*^9, 
  3.548437501727379*^9}},ExpressionUUID->"00b0f85e-647c-4aa0-a725-\
9ee78ae544cd"]
}, Closed]],

Cell[CellGroupData[{

Cell["SimPlot[var] - for external simultion results", "Subsubsection",
 CellChangeTimes->{{3.5484372725735693`*^9, 3.548437276021439*^9}, {
  3.556750002021463*^9, 
  3.556750013925548*^9}},ExpressionUUID->"249f56cd-7b9a-47b7-a502-\
2f6ea88607f3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SimPlot", "[", 
     RowBox[{"var_Symbol", ",", " ", 
      RowBox[{"f_", "?", "StringQ"}], ",", " ", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
    RowBox[{"SimPlot", "[", 
     RowBox[{"var", ",", " ", 
      RowBox[{"\"\<InputFolder\>\"", "\[Rule]", " ", "f"}], ",", " ", "opt"}],
      "]"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SimPlot", "[", 
   RowBox[{"var_Symbol", ",", " ", 
    RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "d", ",", "dPrint", ",", "SFiles", ",", "nS", ",", "dbg", ",", "plots", 
      ",", "f", ",", "plot", ",", "s", ",", "needed", ",", " ", 
      "solutionsneeded", ",", "solutionFiles", ",", "nFiles"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dbg", "=", 
      RowBox[{
       RowBox[{"\"\<Debug\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<Debug\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";", 
     " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dPrint", "[", "u___", "]"}], ":=", " ", 
      RowBox[{"If", "[", 
       RowBox[{"dbg", ",", " ", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<SimPlot: \>\"", ",", " ", "u"}], "]"}]}], "]"}]}], ";", 
     " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "stuff", "}"}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"d", "=", 
         RowBox[{
          RowBox[{"\"\<InputFolder\>\"", "/.", 
           RowBox[{"{", "opt", "}"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{"\"\<InputFolder\>\"", "\[Rule]", " ", "\"\<Unknown\>\""}],
            "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ToString", "[", "d", "]"}], "\[Equal]", 
           "\"\<Unknown\>\""}], ",", " ", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"stuff", " ", "=", " ", 
            RowBox[{"GetSimulationPoints", "[", " ", "opt", "]"}]}], ";", " ",
            "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"SameQ", "[", 
              RowBox[{"stuff", ",", " ", "$Canceled"}], "]"}], ",", " ", 
             RowBox[{"Return", "[", "$Canceled", "]"}]}], "]"}], ";"}], " ", 
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"stuff", "=", 
            RowBox[{"GetSimulationPoints", "[", 
             RowBox[{"d", ",", " ", "opt"}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"needed", " ", "=", " ", 
         RowBox[{"\"\<needed\>\"", "/.", "stuff"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SFiles", "=", 
         RowBox[{"\"\<Solutions\>\"", "/.", "stuff"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"d", "=", 
         RowBox[{"\"\<folder\>\"", "/.", "stuff"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"d", "=", 
        RowBox[{"SystemDialogInput", "[", 
         RowBox[{"\"\<Directory\>\"", ",", " ", 
          RowBox[{"ToFileName", "[", 
           RowBox[{"HomeDirectory", "[", "]"}], "]"}], ",", " ", 
          RowBox[{
          "WindowTitle", "\[Rule]", " ", 
           "\"\<Please select the folder that contains Solution*.nb \
files.):\>\""}]}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"SameQ", "[", 
        RowBox[{"d", ",", "$Canceled"}], "]"}], ",", " ", 
       RowBox[{"Return", "[", "$Canceled", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
     RowBox[{"nS", "=", 
      RowBox[{"Length", "[", "SFiles", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<nS:\>\"", ",", " ", "nS"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"nS", "\[Equal]", "0"}], ",", " ", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<No Simulation results found in \>\"", "<>", "d"}], 
         "]"}], ";", " ", 
        RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"plots", "=", 
      RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<needed: \>\"", ",", " ", "needed"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"solutionsneeded", " ", "=", " ", 
      RowBox[{"First", "/@", "needed"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"solutionFiles", " ", "=", " ", 
      RowBox[{"SFiles", "[", 
       RowBox[{"[", "solutionsneeded", "]"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"nFiles", "=", 
      RowBox[{"Length", "[", "needed", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "i", ",", " ", "fileName", ",", "times", ",", "solution", ",", " ", 
         "variables", ",", " ", "VarNames", ",", " ", "vofts", ",", " ", 
         "varvals", ",", " ", "allvars", ",", "allvarvals"}], "}"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"vofts", "[", 
          RowBox[{"v_", ",", "listOfTimes_"}], "]"}], ":=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"#", ",", 
             RowBox[{"v", "[", "#", "]"}]}], "}"}], "&"}], "/@", "times"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"allvars", "=", 
         RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"allvarvals", "=", 
         RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", " ", "nFiles"}], ",", " ", 
          RowBox[{"i", "++"}], ",", " ", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"fileName", "=", 
            RowBox[{"solutionFiles", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"times", " ", "=", " ", 
            RowBox[{"Last", "[", 
             RowBox[{"needed", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"dPrint", "[", 
            RowBox[{
            "i", ",", "\"\< \>\"", ",", " ", "times", ",", " ", "\"\< \>\"", 
             ",", " ", "fileName"}], "]"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"solution", " ", "=", " ", 
            RowBox[{"GetSavedFile", "[", 
             RowBox[{"fileName", ",", " ", "\"\<Solution\>\""}], "]"}]}], ";",
            " ", "\[IndentingNewLine]", 
           RowBox[{"dPrint", "[", 
            RowBox[{"\"\<solution: \>\"", ",", " ", 
             RowBox[{"Short", "[", 
              RowBox[{"solution", ",", " ", "5"}], "]"}]}], "]"}], ";", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"variables", " ", "=", " ", 
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{"First", "/@", "solution"}], ",", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"Head", "[", "#", "]"}], "\[Equal]", "var"}], "&"}]}],
              "]"}]}], ";", " ", "\[IndentingNewLine]", 
           RowBox[{"VarNames", " ", "=", " ", "variables"}], ";", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"allvars", " ", "=", " ", 
            RowBox[{"Union", "[", 
             RowBox[{"Join", "[", 
              RowBox[{"allvars", ",", "VarNames"}], "]"}], "]"}]}], ";", " ", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"dPrint", "[", 
            RowBox[{
             RowBox[{"Length", "[", "variables", "]"}], ",", " ", 
             "\"\< variables\>\""}], "]"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"varvals", " ", "=", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"vofts", "[", 
                 RowBox[{"#", ",", "times"}], "]"}], "&"}], "/@", 
               "VarNames"}], ")"}], "/.", "solution"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"varvals", " ", "=", " ", 
            RowBox[{"MapThread", "[", 
             RowBox[{"Rule", ",", 
              RowBox[{"{", 
               RowBox[{"VarNames", ",", " ", "varvals"}], "}"}]}], "]"}]}], 
           ";", " ", "\[IndentingNewLine]", 
           RowBox[{"dPrint", "[", "varvals", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"allvarvals", ",", " ", "varvals"}], "]"}], ";"}]}], " ", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", "allvars", "]"}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"Print", "[", "allvarvals", "]"}], ";"}], " ", 
         "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"nvars", " ", "=", " ", 
         RowBox[{"Length", "[", "allvars", "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"colors", " ", "=", " ", 
         RowBox[{
          RowBox[{"Range", "[", "nvars", "]"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"1.0", "*", "nvars"}], "+", "1"}], ")"}]}]}], ";", " ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"lines", "=", 
         RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", " ", "nvars"}], ",", " ", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"variable", " ", "=", " ", 
            RowBox[{"allvars", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ";", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"dPrint", "[", 
            RowBox[{"\"\<variable = \>\"", ",", " ", "variable"}], "]"}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"values", " ", "=", " ", 
            RowBox[{"Join", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"variable", "/.", "allvarvals"}], "/.", 
               RowBox[{"{", 
                RowBox[{"variable", "\[Rule]", " ", 
                 RowBox[{"{", "}"}]}], "}"}]}], ")"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"dPrint", "[", 
            RowBox[{"\"\<values=\>\"", ",", " ", "values"}], "]"}], ";", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "values", "]"}], ">", "0"}], ",", " ", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"line", " ", "=", " ", 
               RowBox[{"Graphics", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Hue", "[", 
                   RowBox[{"colors", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", " ", 
                  RowBox[{"Line", "[", "values", "]"}]}], "}"}], "]"}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"lines", ",", " ", "line"}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"sopt", "=", 
         RowBox[{"MyFilterOptions", "[", 
          RowBox[{"Plot", ",", "opt"}], "]"}]}], "}"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"g", " ", "=", " ", 
        RowBox[{"Show", "[", 
         RowBox[{"lines", ",", " ", "sopt", ",", " ", 
          RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", "  ", 
          RowBox[{"PlotLabel", "\[Rule]", " ", 
           RowBox[{"ToString", "[", "var", "]"}]}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "g", "]"}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "SFiles", "]"}], ">", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"f", "=", 
         RowBox[{"First", "[", "SFiles", "]"}]}], ";", 
        RowBox[{"SFiles", "=", 
         RowBox[{"Rest", "[", "SFiles", "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"dPrint", "[", 
         RowBox[{"\"\<f: \>\"", ",", " ", 
          RowBox[{"Short", "[", "f", "]"}]}], "]"}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"s", "=", 
         RowBox[{"GetSavedFile", "[", 
          RowBox[{"f", ",", " ", "\"\<Solution\>\""}], "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"plot", "=", 
         RowBox[{"SimPlot", "[", 
          RowBox[{"s", ",", " ", "var", ",", "opt", ",", " ", 
           RowBox[{"AspectRatio", "\[Rule]", " ", 
            RowBox[{"1", "/", "GoldenRatio"}]}]}], "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"plots", ",", " ", "plot"}], "]"}], ";"}]}], " ", 
      "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"Show", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.548437263326236*^9, 3.548437374961083*^9}, {
   3.5484375616559353`*^9, 3.54843764908666*^9}, {3.548437729537332*^9, 
   3.548437831465444*^9}, {3.548437863617003*^9, 3.54843792662136*^9}, {
   3.548438024895612*^9, 3.548438028572076*^9}, {3.548438069146846*^9, 
   3.548438079049385*^9}, {3.556742637088942*^9, 3.556742683719068*^9}, {
   3.5567456586757383`*^9, 3.556745750771009*^9}, {3.556745785230227*^9, 
   3.556745804982335*^9}, {3.556746297327433*^9, 3.556746367322157*^9}, {
   3.556746438067835*^9, 3.556746489698015*^9}, {3.5567465197381496`*^9, 
   3.556746694508387*^9}, {3.556746735874075*^9, 3.5567467463615227`*^9}, {
   3.5567467977714367`*^9, 3.556746861125244*^9}, 3.55674690540272*^9, {
   3.556747045711876*^9, 3.556747056624339*^9}, {3.5567475216919193`*^9, 
   3.556747623771397*^9}, 3.556747658351376*^9, {3.5567476904901953`*^9, 
   3.556747871573868*^9}, {3.5567479244570312`*^9, 3.55674796725872*^9}, {
   3.5567480365129766`*^9, 3.556748175512288*^9}, 3.5567482137339363`*^9, {
   3.5567482742278976`*^9, 3.556748294681519*^9}, {3.5567483377319307`*^9, 
   3.5567483391890583`*^9}, {3.556748372668949*^9, 3.5567483970495167`*^9}, {
   3.556748464612012*^9, 3.556748522511273*^9}, {3.556748565886963*^9, 
   3.556748707190879*^9}, {3.556748745324296*^9, 3.556748755298688*^9}, {
   3.556748833901279*^9, 3.556748876694633*^9}, {3.556748969693573*^9, 
   3.556748978226964*^9}, {3.556749017015739*^9, 3.5567490729753513`*^9}, {
   3.556749150257024*^9, 3.556749331977042*^9}, {3.556749406391398*^9, 
   3.5567494413834352`*^9}, 3.566487132056369*^9, {3.57479227893552*^9, 
   3.574792391856967*^9}, {3.575494996910349*^9, 3.575495002866444*^9}, {
   3.576680460087916*^9, 3.576680476850233*^9}, {3.576681033220647*^9, 
   3.576681041576219*^9}, {3.576681075027754*^9, 
   3.576681079875486*^9}},ExpressionUUID->"b923e716-746a-41f6-8f69-\
93d75c690427"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["IndexedVarsInSolution", "Subsection",
 CellChangeTimes->{{3.452441638397613*^9, 
  3.4524416432939987`*^9}},ExpressionUUID->"81d93ab7-9f6b-4e92-b242-\
d1436471442f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"IndexedVarsInSolution", "[", "solution_", "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "s", ",", " ", "allvars", ",", " ", "indexed", ",", " ", "nonindexed"}],
       "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"s", "=", 
       RowBox[{"Flatten", "[", "solution", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"allvars", " ", "=", " ", 
       RowBox[{"First", "/@", "s"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"indexed", " ", "=", " ", 
       RowBox[{"Select", "[", 
        RowBox[{"allvars", ",", " ", "IndexedQ"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"nonindexed", "=", 
       RowBox[{"Complement", "[", 
        RowBox[{"allvars", ",", " ", "indexed"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"indexed", " ", "=", " ", 
       RowBox[{"Union", "[", 
        RowBox[{"Head", "/@", "indexed"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"allvars", " ", "=", " ", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{"indexed", ",", " ", "nonindexed"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "allvars", "]"}], ";"}]}], " ", 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.452441645837613*^9, 
  3.452441696774473*^9}},ExpressionUUID->"87cbceff-4ccf-4f4b-9d52-\
abd11179778e"]
}, Closed]],

Cell[CellGroupData[{

Cell["CommonTimeDomain", "Subsection",
 CellChangeTimes->{{3.452441281870303*^9, 
  3.452441284678988*^9}},ExpressionUUID->"20fad786-ba53-4382-8766-\
81669d55b458"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CommonTimeDomain", "[", "solution_", "]"}], ":=", " ", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "s", ",", " ", "domains", ",", " ", "maxs", ",", " ", "mins", ",", " ", 
      "start", ",", " ", "stop"}], "}"}], ",", " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"s", "=", 
      RowBox[{"Last", "/@", 
       RowBox[{"Flatten", "[", "solution", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"domains", " ", "=", " ", 
      RowBox[{"InterpolatingFunctionDomain", "/@", "s"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"domains", "=", 
      RowBox[{"Flatten", "/@", "domains"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"domains", "=", 
      RowBox[{"Union", "[", "domains", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"domains", " ", "=", " ", 
      RowBox[{"Transpose", "[", "domains", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"mins", ",", " ", "maxs"}], "}"}], "=", "domains"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"start", " ", "=", " ", 
      RowBox[{"Max", "[", "mins", "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"stop", " ", "=", " ", 
      RowBox[{"Min", "[", "maxs", "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"start", " ", ">", " ", "stop"}], ",", " ", 
       RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{"start", ",", " ", "stop"}], "}"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.452441292367489*^9, 3.452441339818652*^9}, {
  3.452441460829253*^9, 
  3.452441467113368*^9}},ExpressionUUID->"9789e219-d71a-4f69-8f74-\
6d5c750cfac4"]
}, Closed]],

Cell[CellGroupData[{

Cell["IndexedQ", "Subsection",
 CellChangeTimes->{{3.452440051223336*^9, 
  3.452440053146496*^9}},ExpressionUUID->"d4821bfe-4f30-41b2-8faa-\
a6a1ab606f73"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IndexedQ", "[", 
     RowBox[{"var_", "?", "AtomQ"}], "]"}], ":=", " ", "False"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IndexedQ", "[", 
     RowBox[{"var_", "[", "index__", "]"}], "]"}], ":=", " ", "True"}], ";"}],
   " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IndexedQ", "[", "x___", "]"}], ":=", " ", "False"}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4524400639745817`*^9, 
  3.452440130062174*^9}},ExpressionUUID->"d8e416ee-7fe8-4265-ac93-\
d1c526d294b6"]
}, Closed]],

Cell[CellGroupData[{

Cell["ShowResults", "Subsection",
 CellChangeTimes->{{3.557000463728763*^9, 
  3.557000464967461*^9}},ExpressionUUID->"b06b2894-c3de-4120-be7e-\
ace147d29047"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ShowResults", "[", 
    RowBox[{"d_", ",", "n_", ",", " ", "specs_", ",", " ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "s", ",", "spec", ",", "g", ",", "SPECS", ",", "time", ",", " ", "var", 
       ",", "vmin", ",", "vmax", ",", "cmin", ",", "cmax", ",", " ", "p", ",",
        "plabel", ",", "f", ",", "S", ",", " ", "T"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"s", "=", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"n", ",", "10", ",", "4"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"f", "=", 
       RowBox[{"ToFileName", "[", 
        RowBox[{"d", ",", 
         RowBox[{"\"\<DTissue\>\"", "<>", "s", "<>", "\"\<.nb\>\""}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AbortIf", "[", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{"FileExistsQ", "[", "f", "]"}], "]"}], ",", " ", 
        RowBox[{
        "\"\<Tissue file \>\"", "<>", "f", "<>", "\"\< not found.\>\""}]}], 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"T", "=", 
       RowBox[{"ToExpression", "[", 
        RowBox[{"Get", "[", "f", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AbortIf", "[", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{"DTissueQ", "[", "T", "]"}], "]"}], ",", 
        RowBox[{"f", "<>", "\"\< is not a valid tissue file.\>\""}]}], "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"S", "=", 
       RowBox[{"ToFileName", "[", 
        RowBox[{"d", ",", 
         RowBox[{"\"\<Solution\>\"", "<>", "s", "<>", "\"\<.nb\>\""}]}], 
        "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"AbortIf", "[", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{"FileExistsQ", "[", "S", "]"}], "]"}], ",", " ", 
        RowBox[{
        "\"\<Solution file \>\"", "<>", "S", "<>", "\"\< not found.\>\""}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"S", "=", 
       RowBox[{"Get", "[", "S", "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"g", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"SPECS", "=", "specs"}], ";", "\[IndentingNewLine]", 
      RowBox[{"time", "=", 
       RowBox[{"Last", "[", 
        RowBox[{"CommonTimeDomain", "[", "S", "]"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "SPECS", "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"spec", "=", 
          RowBox[{"First", "[", "SPECS", "]"}]}], ";", "\[IndentingNewLine]", 
         
         RowBox[{"SPECS", "=", 
          RowBox[{"Rest", "[", "SPECS", "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"AbortIf", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"ListQ", "[", "spec", "]"}]}], ",", " ", 
           "\"\<spec must be a list\>\""}], "]"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"AbortIf", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "spec", "]"}], "\[NotEqual]", " ", "3"}], 
           ",", " ", "\"\<spec must have length 3\>\""}], "]"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"AbortIf", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"ListQ", "[", 
             RowBox[{"spec", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", " ", 
           "\"\<spec[[2]] (colors) must be a list\>\""}], "]"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"AbortIf", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"ListQ", "[", 
             RowBox[{"spec", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "]"}]}], ",", " ", 
           "\"\<spec[[3]] (values) must be a list\>\""}], "]"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"AbortIf", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"spec", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], "\[NotEqual]", " ", 
            "2"}], ",", " ", 
           "\"\<spec[[2]] (colors) must be a list of length 2\>\""}], "]"}], 
         ";", " ", "\[IndentingNewLine]", 
         RowBox[{"AbortIf", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"spec", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "]"}], "\[NotEqual]", " ", 
            "2"}], ",", " ", 
           "\"\<spec[[2]] (values) must be a list of length 2\>\""}], "]"}], 
         ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"var", ",", " ", 
            RowBox[{"{", 
             RowBox[{"cmin", ",", " ", "cmax"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"vmin", ",", "vmax"}], "}"}]}], "}"}], "=", "spec"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"plabel", " ", "=", " ", 
          RowBox[{
           RowBox[{"ToString", "[", "var", "]"}], "<>", "\"\<(\>\"", "<>", 
           RowBox[{"ToString", "[", "time", "]"}], "<>", "\"\<) in [\>\"", "<>", 
           RowBox[{"ToString", "[", "vmin", "]"}], "<>", "\"\<,\>\"", "<>", 
           RowBox[{"ToString", "[", "vmax", "]"}], "<>", "\"\<]\>\""}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"p", "=", 
          RowBox[{"SimShow", "[", 
           RowBox[{
           "S", ",", " ", "var", ",", " ", "time", ",", " ", "T", ",", " ", 
            RowBox[{"{", 
             RowBox[{"cmin", ",", "cmax"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"vmin", ",", "vmax"}], "}"}], ",", " ", 
            RowBox[{"PlotLabel", "\[Rule]", " ", "plabel"}], ",", " ", 
            "opt"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"g", ",", "p"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "g"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.55700046733748*^9, 3.557000475473075*^9}, {
   3.5578596505657454`*^9, 3.5578597635590773`*^9}, 3.557859892291191*^9, {
   3.557859930003188*^9, 3.5578601362605057`*^9}, {3.558085097772542*^9, 
   3.558085100607499*^9}, {3.5580860644547*^9, 
   3.5580860670236473`*^9}},ExpressionUUID->"3d984982-a3f7-47c7-94c1-\
91484e6bd588"]
}, Closed]],

Cell[CellGroupData[{

Cell["SimShow - single frame", "Subsection",
 CellChangeTimes->{{3.4524426762870417`*^9, 3.4524426771880074`*^9}, {
  3.452443538476519*^9, 
  3.4524435410782137`*^9}},ExpressionUUID->"fdb06b5a-dac0-429c-94c2-\
ce624e1b132b"],

Cell["\<\
Option \[OpenCurlyDoubleQuote]Hues\[CloseCurlyDoubleQuote]->{hmin,hmax} \
overrides color values and uses range of hues; hmin, hmax are values between \
0 and 1.

SimShow with Legend is broken in this version\
\>", "Text",
 CellChangeTimes->{{3.55808651996699*^9, 3.558086546295382*^9}, {
  3.55808747989048*^9, 
  3.558087489184883*^9}},ExpressionUUID->"05acbb79-f6e3-46c3-b701-\
34762d5c096b"],

Cell[CellGroupData[{

Cell["SimShow[solution,time,DTissue] (no variable) (no legend)", \
"Subsubsection",
 CellChangeTimes->{{3.546171142204524*^9, 
  3.546171162812026*^9}},ExpressionUUID->"618b7085-a6aa-4765-a5fa-\
9c4eaf537b5c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SimShow", "[", 
    RowBox[{"solution_", ",", "time_", ",", 
     RowBox[{"tissue_", "?", "DTissueQ"}], ",", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "numbers", ",", "T", ",", "c", ",", "toDynamicNumberRules", ",", " ", 
       "toStaticNumberRules"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"T", "=", 
       RowBox[{"DTissue2Tissue", "[", 
        RowBox[{"tissue", ",", "solution", ",", "time"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"numbers", "=", 
       RowBox[{
        RowBox[{"\"\<CellNumbers\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<CellNumbers\>\"", "\[Rule]", "False"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"First", "/@", 
        RowBox[{"TissueCells", "[", "tissue", "]"}]}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"toDynamicNumberRules", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Rule", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", "c", "]"}], "]"}], ",", "c"}], "}"}]}], 
        "]"}]}], ";", 
      RowBox[{"toStaticNumberRules", "=", 
       RowBox[{"Reverse", "/@", "toDynamicNumberRules"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"numbers", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"numbers", "=", 
          RowBox[{"First", "/@", 
           RowBox[{"TissueCells", "[", "tissue", "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ShowTissue", "[", 
          RowBox[{"T", ",", " ", 
           RowBox[{"\"\<CellNumbers\>\"", "\[Rule]", "numbers"}], ",", " ", 
           RowBox[{"\"\<ToStatic\>\"", "\[Rule]", "toStaticNumberRules"}], 
           ",", " ", 
           RowBox[{"\"\<ToDynamic\>\"", "\[Rule]", "toDynamicNumberRules"}], 
           ",", "   ", "opt"}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ShowTissue", "[", 
         RowBox[{"T", ",", " ", 
          RowBox[{"\"\<ToStatic\>\"", "\[Rule]", "toStaticNumberRules"}], ",",
           " ", 
          RowBox[{"\"\<ToDynamic\>\"", "\[Rule]", "toDynamicNumberRules"}], 
          ",", "opt"}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5461100748947535`*^9, 3.54611013414487*^9}, 
   3.546110922726611*^9, 3.5461109875228806`*^9, {3.5461114006115155`*^9, 
   3.546111407393488*^9}, {3.546171017717135*^9, 3.546171063338304*^9}, {
   3.546171127053711*^9, 3.546171131928336*^9}, {3.547217082512086*^9, 
   3.547217173898982*^9}, {3.547217364146854*^9, 3.547217368981295*^9}, {
   3.5568849794271107`*^9, 3.5568850005022497`*^9}, 
   3.556885035021723*^9},ExpressionUUID->"0582509d-b5b2-4297-a8eb-\
1eaee4279fbc"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
SimShow[sol, var, t, tissue, {colormin, colormax}, {valmin, valmax}] - \
without legend\
\>", "Subsubsection",
 CellChangeTimes->{{3.4596234256937437`*^9, 
  3.459623468458976*^9}},ExpressionUUID->"a8b4b74f-3714-4174-9eec-\
0e59c96c5e81"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SimShow", "[", 
    RowBox[{"solution_", ",", "variable_", ",", "time_", ",", 
     RowBox[{"tissue_", "?", "DTissueQ"}], ",", 
     RowBox[{"{", 
      RowBox[{"rgbfrom_RGBColor", ",", "rgbto_RGBColor"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"vmin_", ",", "vmax_"}], "}"}], ",", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "numbers", ",", "T", ",", "c", ",", "toDynamicNumberRules", ",", " ", 
       "toStaticNumberRules"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"T", "=", 
       RowBox[{"DTissue2Tissue", "[", 
        RowBox[{"tissue", ",", "solution", ",", "time"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"numbers", "=", 
       RowBox[{
        RowBox[{"\"\<CellNumbers\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<CellNumbers\>\"", "\[Rule]", "False"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"First", "/@", 
        RowBox[{"TissueCells", "[", "tissue", "]"}]}]}], ";", " ", 
      RowBox[{"toDynamicNumberRules", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Rule", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", "c", "]"}], "]"}], ",", "c"}], "}"}]}], 
        "]"}]}], ";", 
      RowBox[{"toStaticNumberRules", "=", 
       RowBox[{"Reverse", "/@", "toDynamicNumberRules"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"numbers", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"numbers", "=", 
          RowBox[{"First", "/@", 
           RowBox[{"TissueCells", "[", "tissue", "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"SimShow", "[", 
          RowBox[{"solution", ",", "variable", ",", "time", ",", "T", ",", 
           RowBox[{"{", 
            RowBox[{"rgbfrom", ",", "rgbto"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"vmin", ",", "vmax"}], "}"}], ",", 
           RowBox[{"\"\<CellNumbers\>\"", "\[Rule]", "numbers"}], ",", " ", 
           RowBox[{"\"\<ToStatic\>\"", "\[Rule]", "toStaticNumberRules"}], 
           ",", " ", 
           RowBox[{"\"\<ToDynamic\>\"", "\[Rule]", "toDynamicNumberRules"}], 
           ",", "opt"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"SimShow", "[", 
         RowBox[{"solution", ",", "variable", ",", "time", ",", "T", ",", 
          RowBox[{"{", 
           RowBox[{"rgbfrom", ",", "rgbto"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"vmin", ",", "vmax"}], "}"}], ",", " ", 
          RowBox[{"\"\<ToStatic\>\"", "\[Rule]", "toStaticNumberRules"}], ",",
           " ", 
          RowBox[{"\"\<ToDynamic\>\"", "\[Rule]", "toDynamicNumberRules"}], 
          ",", "opt"}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.54617097913988*^9, 3.546170991362228*^9}, {
  3.546171090525676*^9, 3.546171114028542*^9}, {3.547052512671268*^9, 
  3.54705251666066*^9}, {3.547052617208618*^9, 3.547052663326133*^9}, {
  3.547217339461309*^9, 
  3.547217386597843*^9}},ExpressionUUID->"fe206cb7-9bb8-48e4-99c2-\
8d8bb3e031aa"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SimShow", "[", 
     RowBox[{"solution_", ",", "variable_", ",", " ", "time_", ",", "  ", 
      RowBox[{"tissue_", "?", "TissueQ"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"rgbfrom_RGBColor", ",", " ", "rgbto_RGBColor"}], "}"}], ",", 
      " ", 
      RowBox[{"{", 
       RowBox[{"vmin_", ",", " ", "vmax_"}], "}"}], ",", " ", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "allvars", ",", " ", "s", ",", " ", "n", ",", " ", "colors", ",", " ", 
        "g", ",", " ", "dbg", ",", " ", "dprint", ",", " ", "cellstyles", ",",
         " ", "arglists", ",", " ", "cellvars", ",", " ", "cellnums", ",", 
        " ", "edgevars", ",", " ", "celledgepairs", ",", "cellif", ",", " ", 
        "edgeif", ",", "cellcolors", ",", "edgecolors", ",", "cellvals", ",", 
        "edgevals", ",", "ced", ",", "nextdata", ",", " ", "hue", ",", 
        "huefrom", ",", "hueto"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dbg", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<Debug\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<Debug\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";", 
       " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dprint", "[", "x___", "]"}], ":=", " ", 
        RowBox[{"If", "[", 
         RowBox[{"dbg", ",", " ", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<SimShow(1): \>\"", ",", " ", "x"}], "]"}]}], "]"}]}], 
       ";", " ", "\[IndentingNewLine]", 
       RowBox[{"dprint", "[", "\"\<**NEW*** SimShow(1)\>\"", "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"n", "=", 
        RowBox[{"NTissueCells", "[", "tissue", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"s", "=", 
        RowBox[{"Flatten", "[", "solution", "]"}]}], ";", "  ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "get", " ", "all", " ", "indexed", " ", "variables", " ", "of", " ", 
         "specified", " ", "name"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"allvars", " ", "=", " ", 
        RowBox[{"First", "/@", "s"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"allvars", " ", "=", " ", 
        RowBox[{"Select", "[", 
         RowBox[{"allvars", ",", " ", 
          RowBox[{
           RowBox[{"SameQ", "[", 
            RowBox[{
             RowBox[{"Head", "[", "#", "]"}], ",", " ", "variable"}], "]"}], 
           "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dprint", "[", 
        RowBox[{"\"\<allvars: \>\"", ",", " ", 
         RowBox[{"Short", "[", "allvars", "]"}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "allvars", "]"}], "<", "1"}], ",", " ", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Error: SimShow: \>\"", ",", " ", "variable", ",", " ", 
            "\"\< not found.\>\""}], "]"}], ";", " ", 
          RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"arglists", " ", "=", " ", 
        RowBox[{"allvars", "/.", 
         RowBox[{"{", 
          RowBox[{"variable", "\[Rule]", " ", "List"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dprint", "[", 
        RowBox[{"\"\<arglists:\>\"", ",", " ", "arglists"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"cellvars", "=", 
        RowBox[{"Pick", "[", 
         RowBox[{"allvars", ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "#", "]"}], "\[Equal]", "1"}], "&"}], "/@",
            "arglists"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"cellnums", "=", 
        RowBox[{"First", "/@", 
         RowBox[{"Select", "[", 
          RowBox[{"arglists", ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "#", "]"}], "\[Equal]", "1"}], "&"}]}], 
          "]"}]}]}], ";", "  ", "\[IndentingNewLine]", 
       RowBox[{"edgevars", "=", 
        RowBox[{"Pick", "[", 
         RowBox[{"allvars", ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "#", "]"}], "\[Equal]", "2"}], "&"}], "/@",
            "arglists"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"celledgepairs", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"arglists", ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "#", "]"}], "\[Equal]", "2"}], "&"}]}], 
         "]"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"dprint", "[", 
        RowBox[{
        "\"\<cellvars=\>\"", ",", " ", "cellvars", ",", " ", "\"\< nums=\>\"",
          ",", " ", "cellnums"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"dprint", " ", "[", 
        RowBox[{
        "\"\<edgevars=\>\"", ",", "edgevars", ",", " ", "\"\< nums=\>\"", ",",
          " ", "celledgepairs"}], "]"}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"cellif", " ", "=", 
        RowBox[{"cellvars", "/.", "s"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"edgeif", " ", "=", " ", 
        RowBox[{"edgevars", "/.", "s"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"cellvals", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", "time", "]"}], "&"}], "/@", "cellif"}]}], ";", 
       " ", "\[IndentingNewLine]", 
       RowBox[{"edgevals", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", "time", "]"}], "&"}], "/@", "edgeif"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dprint", "[", 
        RowBox[{"\"\<cellvals: \>\"", ",", " ", "cellvals"}], "]"}], ";", " ",
        "\[IndentingNewLine]", 
       RowBox[{"dprint", "[", 
        RowBox[{"\"\<edgevals: \>\"", ",", " ", "edgevals"}], "]"}], ";", " ",
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"dprint", "[", 
        RowBox[{"\"\<Length[s]:\>\"", ",", " ", 
         RowBox[{"Length", "[", "s", "]"}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"dprint", "[", 
        RowBox[{"\"\<s: \>\"", ",", " ", 
         RowBox[{"Short", "[", "s", "]"}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"dprint", "[", 
        RowBox[{"\"\<{vmin, vmax}:\>\"", ",", " ", 
         RowBox[{"{", 
          RowBox[{"vmin", ",", " ", "vmax"}], "}"}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"dprint", "[", 
        RowBox[{"\"\<{rgbfrom,rgbto}:\>\"", ",", " ", 
         RowBox[{"{", 
          RowBox[{"rgbfrom", ",", " ", "rgbto"}], "}"}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"hue", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<Hues\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<Hue\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ListQ", "[", "hue", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "hue", "]"}], "\[Equal]", "2"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"huefrom", ",", " ", "hueto"}], "}"}], "=", "hue"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"hue", "=", "True"}], ";"}], ",", "\[IndentingNewLine]", 
           RowBox[{"hue", "=", "False"}]}], "\[IndentingNewLine]", "]"}], ",",
          "\[IndentingNewLine]", 
         RowBox[{"hue", "=", "False"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"hue", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"cellcolors", " ", "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"HueInterpolate", "[", 
              RowBox[{"#", ",", " ", 
               RowBox[{"{", 
                RowBox[{"vmin", ",", " ", "vmax"}], "}"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"huefrom", ",", " ", "hueto"}], "}"}]}], "]"}], "&"}],
             "/@", "cellvals"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"edgecolors", " ", "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"HueInterpolate", "[", 
              RowBox[{"#", ",", " ", 
               RowBox[{"{", 
                RowBox[{"vmin", ",", " ", "vmax"}], "}"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"huefrom", ",", " ", "hueto"}], "}"}]}], "]"}], "&"}],
             "/@", "edgevals"}]}], ";"}], "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"cellcolors", " ", "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"RGBInterpolate", "[", 
              RowBox[{"#", ",", " ", 
               RowBox[{"{", 
                RowBox[{"vmin", ",", " ", "vmax"}], "}"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"rgbfrom", ",", " ", "rgbto"}], "}"}]}], "]"}], "&"}],
             "/@", "cellvals"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"edgecolors", " ", "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"RGBInterpolate", "[", 
              RowBox[{"#", ",", " ", 
               RowBox[{"{", 
                RowBox[{"vmin", ",", " ", "vmax"}], "}"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"rgbfrom", ",", " ", "rgbto"}], "}"}]}], "]"}], "&"}],
             "/@", "edgevals"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"ced", "=", 
        RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"Length", "[", "celledgepairs", "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"nextdata", "=", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"celledgepairs", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"edgecolors", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"ced", ",", " ", "nextdata"}], "]"}], ";"}]}], " ", 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"dprint", "[", 
        RowBox[{"\"\<ced:\>\"", ",", " ", "ced"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"dprint", "[", 
        RowBox[{"\"\<cellcolors: \>\"", ",", " ", "cellcolors"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dprint", "[", 
        RowBox[{"\"\<edgecolors: \>\"", ",", " ", "edgecolors"}], "]"}], ";", 
       "  ", "\[IndentingNewLine]", 
       RowBox[{"dprint", "[", 
        RowBox[{"\"\<opt: \>\"", ",", " ", "opt"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"cellstyles", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<CellStyle\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<CellStyle\>\"", "\[Rule]", " ", 
           RowBox[{"{", "}"}]}], "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"dprint", "[", 
        RowBox[{
        "\"\<Additional input cell styles: \>\"", ",", " ", "cellstyles"}], 
        "]"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"ListQ", "[", "cellstyles", "]"}]}], ",", " ", 
         RowBox[{"cellstyles", "=", 
          RowBox[{"{", "cellstyles", "}"}]}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "additional", " ", "user", " ", "specified", " ", "cell", " ", 
         "styles"}], " ", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "cellstyles", "]"}], ">", "0"}], ",", "  ", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "cellstyles", "]"}], "\[Equal]", "n"}], 
            ",", " ", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "a", " ", "separate", " ", "style", " ", "for", " ", "each", " ",
               "cell"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"cellstyles", " ", "=", " ", 
              RowBox[{"List", "/@", "cellstyles"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"cellcolors", " ", "=", " ", 
              RowBox[{"List", "/@", "cellcolors"}]}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"cellcolors", " ", "=", " ", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"cellcolors", ",", " ", "cellstyles"}], "}"}], "//", 
               "Transpose"}]}], ";", " ", "\[IndentingNewLine]", 
             RowBox[{"cellcolors", " ", "=", " ", 
              RowBox[{"Flatten", "/@", "cellcolors"}]}]}], 
            "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "or", " ", "a", " ", "global", " ", "style", " ", "to", " ", 
              "be", " ", "applied", " ", "to", " ", "each", " ", "cell"}], 
             " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"dprint", "[", "\"\<Global style\>\"", "]"}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"cellcolors", " ", "=", " ", 
              RowBox[{"List", "/@", "cellcolors"}]}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"cellcolors", " ", "=", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"Append", "[", 
                 RowBox[{"cellstyles", ",", " ", "#"}], "]"}], "&"}], "/@", 
               "colors"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"cellcolors", " ", "=", " ", 
           RowBox[{"Flatten", "/@", "colors"}]}]}]}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"dprint", "[", 
        RowBox[{"\"\<CellColors: \>\"", ",", " ", "cellcolors"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dprint", "[", 
        RowBox[{"\"\<tissue: \>\"", ",", " ", "tissue"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"g", "=", 
        RowBox[{"ShowTissue", "[", 
         RowBox[{"tissue", ",", " ", 
          RowBox[{"\"\<CellStyles\>\"", "\[Rule]", " ", "cellcolors"}], ",", 
          RowBox[{"\"\<EdgeCellPairs\>\"", "\[Rule]", " ", "ced"}], ",", "  ",
           "opt"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"dprint", "[", 
        RowBox[{"\"\<g:\>\"", ",", " ", "g"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "g", "]"}], ";"}]}], " ", "\[IndentingNewLine]",
      "\[IndentingNewLine]", "]"}]}], ";"}], " ", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.452442685468165*^9, 3.45244274822876*^9}, {
   3.452442782140751*^9, 3.452442861138144*^9}, {3.45244353180155*^9, 
   3.4524435320065603`*^9}, {3.452443633005455*^9, 3.45244364682345*^9}, {
   3.452443677194075*^9, 3.4524437667872477`*^9}, {3.452443801971941*^9, 
   3.452443896855008*^9}, {3.452443951215856*^9, 3.452444026217367*^9}, {
   3.452444083502722*^9, 3.452444127348773*^9}, {3.452444319081449*^9, 
   3.452444344133788*^9}, {3.453483608566576*^9, 3.453483635992853*^9}, {
   3.453483700535963*^9, 3.453483709355977*^9}, {3.45348379118546*^9, 
   3.453483848912848*^9}, {3.453483889996636*^9, 3.4534838947712603`*^9}, {
   3.453483926072359*^9, 3.453484055355844*^9}, 3.453484088980947*^9, {
   3.453484573511855*^9, 3.453484576529077*^9}, {3.45960975455678*^9, 
   3.459609828327248*^9}, {3.4596228711711903`*^9, 3.459622891156116*^9}, {
   3.512223825034752*^9, 3.512223876433473*^9}, {3.5122239210156384`*^9, 
   3.512224131317631*^9}, {3.512224183875016*^9, 3.512224210157514*^9}, {
   3.512224257299139*^9, 3.512224344578095*^9}, {3.512224386139532*^9, 
   3.512224487452155*^9}, {3.512224535834111*^9, 3.512224542046895*^9}, {
   3.512224577585013*^9, 3.512224608387919*^9}, {3.5122246593918467`*^9, 
   3.512224676119916*^9}, {3.5122247700912437`*^9, 3.512224787321347*^9}, {
   3.54474497333748*^9, 3.5447450403529043`*^9}, {3.5447450899933147`*^9, 
   3.5447453159376802`*^9}, {3.5447453736118383`*^9, 3.544745625290296*^9}, {
   3.544745660727*^9, 3.544745662370082*^9}, {3.544745712161975*^9, 
   3.544745740621029*^9}, {3.5447457834198017`*^9, 3.544745784836978*^9}, 
   3.544745820799638*^9, 3.544745854652337*^9, {3.544745898171217*^9, 
   3.544745913821578*^9}, {3.544745945553619*^9, 3.544745948413514*^9}, {
   3.544746023492832*^9, 3.544746337114105*^9}, {3.5447466144987917`*^9, 
   3.5447466552005033`*^9}, 3.545397786755443*^9, {3.545397818310327*^9, 
   3.545397820466597*^9}, 3.54539944001576*^9, {3.546267229370741*^9, 
   3.54626727393855*^9}, {3.546267327952869*^9, 3.546267329710844*^9}, {
   3.546269090186397*^9, 3.546269091988332*^9}, {3.547054927409071*^9, 
   3.5470549310275707`*^9}, {3.5471489155266848`*^9, 3.54714891750364*^9}, {
   3.547148993419898*^9, 3.547148998149809*^9}, {3.5471490502816896`*^9, 
   3.547149055239605*^9}, {3.558085185624123*^9, 3.558085231130918*^9}, {
   3.558086225077931*^9, 3.558086338999543*^9}, {3.558086404762478*^9, 
   3.558086405481783*^9}, {3.558088344887227*^9, 3.5580883521753607`*^9}, {
   3.561814258287242*^9, 3.561814259332921*^9}, {3.561814464232786*^9, 
   3.56181446733188*^9}},ExpressionUUID->"4fd334d4-58e0-4f45-86aa-\
e70953f1f4e3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SimShow", "[", 
    RowBox[{"solution_", ",", "variable_", ",", " ", "time_", ",", "  ", 
     RowBox[{"tissue_", "?", "ISTissue"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"gfrom_GrayLevel", ",", " ", "rgbto_RGBColor"}], "}"}], ",", 
     " ", 
     RowBox[{"{", 
      RowBox[{"vmin_", ",", " ", "vmax_"}], "}"}], ",", " ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"SimShow", "[", 
    RowBox[{"solution", ",", "variable", ",", "time", ",", "tissue", ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ColorConvert", "[", 
        RowBox[{"gfrom", ",", "\"\<RGB\>\""}], "]"}], ",", "rgbto"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"vmin", ",", "vmax"}], "}"}], ",", "opt"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SimShow", "[", 
    RowBox[{"solution_", ",", "variable_", ",", " ", "time_", ",", "  ", 
     RowBox[{"tissue_", "?", "ISTissue"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"rgbfrom_RGBColor", ",", " ", "gto_GrayLevel"}], "}"}], ",", 
     " ", 
     RowBox[{"{", 
      RowBox[{"vmin_", ",", " ", "vmax_"}], "}"}], ",", " ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"SimShow", "[", 
    RowBox[{"solution", ",", "variable", ",", "time", ",", "tissue", ",", 
     RowBox[{"{", 
      RowBox[{"rgbfrom", ",", 
       RowBox[{"ColorConvert", "[", 
        RowBox[{"gto", ",", "\"\<RGB\>\""}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"vmin", ",", "vmax"}], "}"}], ",", "opt"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SimShow", "[", 
    RowBox[{"solution_", ",", "variable_", ",", " ", "time_", ",", "  ", 
     RowBox[{"tissue_", "?", "ISTissue"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"gfrom_GrayLevel", ",", " ", "gto_GrayLevel"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"vmin_", ",", " ", "vmax_"}], "}"}], ",", " ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"SimShow", "[", 
    RowBox[{"solution", ",", "variable", ",", "time", ",", "tissue", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ColorConvert", "[", 
        RowBox[{"gfrom", ",", "\"\<RGB\>\""}], "]"}], ",", 
       RowBox[{"ColorConvert", "[", 
        RowBox[{"gto", ",", "\"\<RGB\>\""}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"vmin", ",", "vmax"}], "}"}], ",", "opt"}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.547908233622222*^9, 3.5479082351710253`*^9}, {
  3.547908272549572*^9, 
  3.547908451852643*^9}},ExpressionUUID->"6cd302af-6902-4362-9f60-\
3a1362d1f280"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
SimShow[sol, var, t, tissue, {colormin, colormax}, {vmin, vmax}, {xmin, \
xmax}, {ymin, ymax}] - with legend\
\>", "Subsubsection",
 CellChangeTimes->{{3.45962335893683*^9, 3.459623388133004*^9}, {
  3.459623461546125*^9, 
  3.459623463564275*^9}},ExpressionUUID->"08b8bec9-a6ee-4bcc-af1d-\
5da8dac215a3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SimShow", "[", 
     RowBox[{"solution_", ",", "variable_", ",", "time_", ",", 
      RowBox[{"tissue_", "?", "DTissueQ"}], ",", 
      RowBox[{"{", 
       RowBox[{"rgbfrom_RGBColor", ",", "rgbto_RGBColor"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"vmin_", ",", "vmax_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"xmin_", ",", "xmax_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ymin_", ",", "ymax_"}], "}"}], ",", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "numbers", ",", "T", ",", " ", "toDynamicNumberRules", ",", " ", 
        "toStaticNumberRules"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"T", "=", 
        RowBox[{"DTissue2Tissue", "[", 
         RowBox[{"tissue", ",", "solution", ",", "time"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"numbers", "=", 
        RowBox[{
         RowBox[{"\"\<CellNumbers\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<CellNumbers\>\"", "\[Rule]", " ", "False"}], "}"}]}]}],
        ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"c", "=", 
        RowBox[{"First", "/@", 
         RowBox[{"TissueCells", "[", "tissue", "]"}]}]}], ";", 
       RowBox[{"toDynamicNumberRules", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "c", "]"}], "]"}], ",", "c"}], "}"}]}], 
         "]"}]}], ";", 
       RowBox[{"toStaticNumberRules", "=", 
        RowBox[{"Reverse", "/@", "toDynamicNumberRules"}]}], ";", "\n", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"numbers", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"numbers", "=", 
           RowBox[{"First", "/@", 
            RowBox[{"TissueCells", "[", "tissue", "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"SimShow", "[", 
           RowBox[{"solution", ",", "variable", ",", "time", ",", "T", ",", 
            RowBox[{"{", 
             RowBox[{"rgbfrom", ",", "rgbto"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"vmin", ",", "vmax"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"xmin", ",", "xmax"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"ymin", ",", "ymax"}], "}"}], ",", 
            RowBox[{"\"\<CellNumbers\>\"", "\[Rule]", " ", "numbers"}], ",", 
            RowBox[{"\"\<ToStatic\>\"", "\[Rule]", "toStaticNumberRules"}], 
            ",", 
            RowBox[{"\"\<ToDynamic\>\"", "\[Rule]", "toDynamicNumberRules"}], 
            ",", " ", "opt"}], "]"}]}], "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"SimShow", "[", 
          RowBox[{"solution", ",", "variable", ",", "time", ",", "T", ",", 
           RowBox[{"{", 
            RowBox[{"rgbfrom", ",", "rgbto"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"vmin", ",", "vmax"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"xmin", ",", "xmax"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"ymin", ",", "ymax"}], "}"}], ",", 
           RowBox[{"\"\<ToStatic\>\"", "\[Rule]", "toStaticNumberRules"}], 
           ",", 
           RowBox[{"\"\<ToDynamic\>\"", "\[Rule]", "toDynamicNumberRules"}], 
           ",", "opt"}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], " "}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5461097528006487`*^9, 3.5461099250994654`*^9}, {
   3.54610996178162*^9, 3.546110049313368*^9}, {3.5461101056378336`*^9, 
   3.546110106013855*^9}, 3.54611093607594*^9, 3.546110979309411*^9, {
   3.5461114157333403`*^9, 3.546111417455432*^9}, {3.561814609658791*^9, 
   3.561814647539104*^9}},ExpressionUUID->"72e7cb79-9413-43ce-ba44-\
4df00bbbb4ed"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SimShow", "[", 
   RowBox[{"solution_", ",", "variable_", ",", " ", "time_", ",", "  ", 
    RowBox[{"tissue_", "?", "TissueQ"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"rgbfrom_RGBColor", ",", " ", "rgbto_RGBColor"}], "}"}], ",", 
    " ", 
    RowBox[{"{", 
     RowBox[{"vmin_", ",", " ", "vmax_"}], "}"}], ",", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"xmin_", ",", " ", "xmax_"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"ymin_", ",", " ", "ymax_"}], "}"}], ",", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "title", ",", " ", "xxmax", ",", " ", "legend", ",", " ", "legendstyle", 
      ",", " ", "g", ",", " ", "lxmin", ",", " ", "lxmax", ",", " ", "lymin", 
      ",", " ", "lymax", ",", " ", "lbox", ",", " ", "lboxcolo", " ", ",", 
      "dbg", ",", " ", "dprint", ",", " ", "lboxcolor"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dbg", " ", "=", " ", 
      RowBox[{
       RowBox[{"\"\<Debug\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<Debug\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";", 
     " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dprint", "[", "x___", "]"}], ":=", " ", 
      RowBox[{"If", "[", 
       RowBox[{"dbg", ",", " ", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<SimShow(2): \>\"", ",", " ", "x"}], "]"}]}], "]"}]}], 
     ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"dprint", "[", "\"\<SimShow(2)\>\"", "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
     RowBox[{"title", "=", 
      RowBox[{
       RowBox[{"\"\<Title\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<Title\>\"", "\[Rule]", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ToString", "[", "variable", "]"}], "<>", "\"\<[\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"NumberForm", "[", 
            RowBox[{"time", ",", 
             RowBox[{"{", 
              RowBox[{"10", ",", "2"}], "}"}]}], "]"}], "]"}], "<>", 
          "\"\<]\>\""}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"xxmax", " ", "=", " ", 
      RowBox[{"xmax", " ", "+", " ", 
       RowBox[{".2", "*", 
        RowBox[{"(", 
         RowBox[{"xmax", "-", "xmin"}], ")"}]}]}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"legendstyle", " ", "=", " ", 
      RowBox[{
       RowBox[{"\"\<LegendStyle\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<LegendStyle\>\"", "\[Rule]", " ", 
         RowBox[{"{", "}"}]}], "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"lxmin", " ", "=", " ", 
      RowBox[{"xmax", "+", " ", 
       RowBox[{".05", 
        RowBox[{"(", 
         RowBox[{"xmax", "-", "xmin"}], ")"}]}]}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"lxmax", " ", "=", 
      RowBox[{"xmax", "+", 
       RowBox[{".15", 
        RowBox[{"(", 
         RowBox[{"xmax", "-", "xmin"}], ")"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"lymin", "=", 
      RowBox[{"ymin", "+", 
       RowBox[{".25", 
        RowBox[{"(", 
         RowBox[{"ymax", "-", "ymin"}], ")"}]}]}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"lymax", " ", "=", " ", 
      RowBox[{"ymin", " ", "+", 
       RowBox[{".75", 
        RowBox[{"(", 
         RowBox[{"ymax", "-", "ymin"}], ")"}]}]}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"legend", " ", "=", " ", 
      RowBox[{"ColorBlendRectangle", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"lxmin", ",", "lymin"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"lxmax", ",", "lymax"}], " ", "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"rgbfrom", ",", " ", "rgbto"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NumberForm", "[", 
           RowBox[{"vmin", ",", "3"}], "]"}], ",", " ", 
          RowBox[{"NumberForm", "[", 
           RowBox[{"vmax", ",", "3"}], "]"}]}], "}"}], ",", " ", 
        "legendstyle"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"box", " ", "the", " ", "legend"}], ",", " ", 
       RowBox[{
       "the", " ", "same", " ", "color", " ", "as", " ", "the", " ", "Cell", 
        " ", "Boundary", " ", "if", " ", "not", " ", "specified"}]}], "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"lbox", " ", "=", " ", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"lxmin", ",", " ", "lymin"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"lxmax", ",", " ", "lymin"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"lxmax", ",", " ", "lymax"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"lxmin", ",", " ", "lymax"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"lxmin", ",", " ", "lymin"}], "}"}]}], "}"}], "]"}]}], ";", 
     " ", "\[IndentingNewLine]", 
     RowBox[{"lboxcolor", "=", 
      RowBox[{
       RowBox[{"\"\<LegendBoundary\>\"", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
        "\"\<LegendBoundary\>\"", "\[Rule]", " ", "\"\<BoundaryStyle\>\""}], 
        "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"lboxcolor", " ", "=", 
      RowBox[{
       RowBox[{"lboxcolor", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<BoundaryStyle\>\"", "\[Rule]", " ", "Black"}], "}"}]}]}],
      ";", " ", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "[", "lboxcolor", "]"}], "\[Equal]", 
        "\"\<None\>\""}], ",", " ", 
       RowBox[{"lboxcolor", "=", "Black"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"lbox", " ", "=", " ", 
      RowBox[{"Graphics", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"lboxcolor", ",", " ", "lbox"}], "}"}], "//", "Flatten"}], 
       "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"dprint", "[", 
      RowBox[{"\"\<lboxcolor: \>\"", ",", " ", "lboxcolor"}], "]"}], ";", " ",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"g", "=", " ", 
      RowBox[{"SimShow", "[", 
       RowBox[{
       "solution", ",", " ", "variable", ",", " ", "time", ",", " ", "tissue",
         ",", " ", 
        RowBox[{"{", 
         RowBox[{"rgbfrom", ",", " ", "rgbto"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"vmin", ",", " ", "vmax"}], "}"}], ",", " ", 
        "\[IndentingNewLine]", "opt", ",", " ", "\[IndentingNewLine]", 
        RowBox[{"PlotRange", "\[Rule]", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"xmin", ",", " ", "xxmax"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"ymin", ",", " ", "ymax"}], "}"}]}], "}"}]}]}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{",", " ", 
         RowBox[{"PlotLabel", "\[Rule]", " ", "title"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"g", "=", 
      RowBox[{"Show", "[", "g", "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"dprint", "[", "g", "]"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"dprint", "[", "legend", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"dprint", "[", "lbox", "]"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"g", "=", " ", 
      RowBox[{"Show", "[", 
       RowBox[{"g", ",", " ", "legend", ",", " ", "lbox"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dprint", "[", "g", "]"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "g", "]"}], ";"}]}], " ", "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwdzFsoQwEAxvGFzW00lFshlzeTFyFRjkscsRitlDLLiqhDeJAIe9Cy3JVI
xIs2twcxM+TSmfvlYcqLDk7YKffbiNh3Hr5+9T38w1WUXO0kEAgiHIM7XeIh
4bKNaGX6zDBuxZmGZcNFu5BbrziE+ui8EyhNWLXC728NA/fEKW9wICnRDodT
G35g9f4Hb01ziYvI4ZSkRwi903rF8KA01wsGWLIj4LTcJwr2dLCxUN0SlgPr
stPlcFOm450uaFdARdppKZSmP1Ou6DYF10DfwZeMNpONMJ8bM2GFhiOhF2Pn
zWHmCv/w33sr4EnhkQoq2y5472YXtCFmG+FPkZ2Q24rUxjj8XTfoIJm8NOQW
zRHxbOMonJJaJ6CSvDDAz/78Jdg3H2SEM6n2FVhr0K/By8XjbaiZvLbAccLp
EAbs3Bzxvd8RK/R38byCG6bFJ2hUm5/hRIjpHb6cJn3BrPrRu0CKI2jRJwcZ
MusVslU0r6y7Szim5QiP8iB3yIbSflARf8a7pytQQYnooRzedkoqIV38SMF/
9hMRiw==
  "],ExpressionUUID->"aa46ef4c-f0ba-44be-88fa-8f40551c9610"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SimShow", "[", 
    RowBox[{"solution_", ",", "variable_", ",", " ", "time_", ",", "  ", 
     RowBox[{"tissue_", "?", "ISTissue"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"gfrom_GrayLevel", ",", " ", "rgbto_RGBColor"}], "}"}], ",", 
     " ", 
     RowBox[{"{", 
      RowBox[{"vmin_", ",", " ", "vmax_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"xmin_", ",", " ", "xmax_"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"ymin_", ",", " ", "ymax_"}], "}"}], ",", " ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"SimShow", "[", 
    RowBox[{"solution", ",", "variable", ",", "time", ",", "tissue", ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ColorConvert", "[", 
        RowBox[{"gfrom", ",", "\"\<RGB\>\""}], "]"}], ",", "rgbto"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"vmin", ",", "vmax"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"xmin", ",", "xmax"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"ymin", ",", "ymax"}], "}"}], ",", " ", "opt"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SimShow", "[", 
    RowBox[{"solution_", ",", "variable_", ",", " ", "time_", ",", "  ", 
     RowBox[{"tissue_", "?", "ISTissue"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"rgbfrom_RGBColor", ",", " ", "gto_GrayLevel"}], "}"}], ",", 
     " ", 
     RowBox[{"{", 
      RowBox[{"vmin_", ",", " ", "vmax_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"xmin_", ",", " ", "xmax_"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"ymin_", ",", " ", "ymax_"}], "}"}], ",", "  ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"SimShow", "[", 
    RowBox[{"solution", ",", "variable", ",", "time", ",", "tissue", ",", 
     RowBox[{"{", 
      RowBox[{"rgbfrom", ",", 
       RowBox[{"ColorConvert", "[", 
        RowBox[{"gto", ",", "\"\<RGB\>\""}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"vmin", ",", "vmax"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"xmin", ",", "xmax"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"ymin", ",", "ymax"}], "}"}], ",", "opt"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SimShow", "[", 
    RowBox[{"solution_", ",", "variable_", ",", " ", "time_", ",", "  ", 
     RowBox[{"tissue_", "?", "ISTissue"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"gfrom_GrayLevel", ",", " ", "gto_GrayLevel"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"vmin_", ",", " ", "vmax_"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"xmin_", ",", " ", "xmax_"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"ymin_", ",", " ", "ymax_"}], "}"}], ",", " ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"SimShow", "[", 
    RowBox[{"solution", ",", "variable", ",", "time", ",", "tissue", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ColorConvert", "[", 
        RowBox[{"gfrom", ",", "\"\<RGB\>\""}], "]"}], ",", 
       RowBox[{"ColorConvert", "[", 
        RowBox[{"gto", ",", "\"\<RGB\>\""}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"vmin", ",", "vmax"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"xmin", ",", "xmax"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"ymin", ",", "ymax"}], "}"}], ",", "opt"}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.547908233622222*^9, 3.5479082351710253`*^9}, {
  3.547908272549572*^9, 3.547908451852643*^9}, {3.547908504284314*^9, 
  3.54790854652879*^9}},ExpressionUUID->"6f3cd078-c471-4db5-bf57-\
afbf9c3f7005"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
SimShow[sol, var, time, tissue, {colormin, colormax}, threshold]\
\>", "Subsubsection",
 CellChangeTimes->{
  3.546110465377962*^9},ExpressionUUID->"b350770d-b5cf-43ad-9035-\
08fcde07eaa0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SimShow", "[", 
    RowBox[{"solution_", ",", "variable_", ",", "time_", ",", 
     RowBox[{"tissue_", "?", "DTissueQ"}], ",", 
     RowBox[{"{", 
      RowBox[{"rgbfrom_RGBColor", ",", "rgbto_RGBColor"}], "}"}], ",", 
     "threshold_", ",", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"numbers", ",", "T"}], "}"}], ",", 
     RowBox[{
      RowBox[{"T", "=", 
       RowBox[{"DTissue2Tissue", "[", 
        RowBox[{"tissue", ",", "solution", ",", "time"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"numbers", "=", 
       RowBox[{
        RowBox[{"\"\<CellNumbers\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<CellNumbers\>\"", "\[Rule]", "False"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"numbers", ",", 
        RowBox[{
         RowBox[{"numbers", "=", 
          RowBox[{"First", "/@", 
           RowBox[{"TissueCells", "[", "tissue", "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"SimShow", "[", 
          RowBox[{"solution", ",", "variable", ",", "time", ",", "T", ",", 
           RowBox[{"{", 
            RowBox[{"rgbfrom", ",", "rgbto"}], "}"}], ",", "threshold", ",", 
           RowBox[{"\"\<CellNumbers\>\"", "\[Rule]", "numbers"}], ",", 
           "opt"}], "]"}]}], ",", 
        RowBox[{"SimShow", "[", 
         RowBox[{"solution", ",", "variable", ",", "time", ",", "T", ",", 
          RowBox[{"{", 
           RowBox[{"rgbfrom", ",", "rgbto"}], "}"}], ",", "threshold", ",", 
          "opt"}], "]"}]}], "]"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.546110489055826*^9, 3.5461105091225295`*^9}, {
  3.5461109441273985`*^9, 3.5461109710199366`*^9}, {3.546111423795377*^9, 
  3.5461114254802437`*^9}},ExpressionUUID->"71c13994-5b54-446f-9a67-\
abbb96b9ca3a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SimShow", "[", 
     RowBox[{"solution_", ",", "variable_", ",", "time_", ",", 
      RowBox[{"tissue_", "?", "TissueQ"}], ",", 
      RowBox[{"{", 
       RowBox[{"rgbfrom_RGBColor", ",", "rgbto_RGBColor"}], "}"}], ",", 
      "threshold_", ",", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "allvars", ",", "s", ",", "n", ",", "colors", ",", "g", ",", "dbg", 
        ",", "dprint"}], "}"}], ",", 
      RowBox[{
       RowBox[{"dbg", "=", 
        RowBox[{
         RowBox[{"\"\<Debug\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<Debug\>\"", "\[Rule]", "False"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dprint", "[", "x___", "]"}], ":=", 
        RowBox[{"If", "[", 
         RowBox[{"dbg", ",", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<SimShow(1): \>\"", ",", "x"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dprint", "[", "\"\<SimShow(1)\>\"", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"n", "=", 
        RowBox[{"NTissueCells", "[", "tissue", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"s", "=", 
        RowBox[{"Flatten", "[", "solution", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "get", " ", "all", " ", "indexed", " ", "variables", " ", "of", " ", 
         "specified", " ", "name"}], "*)"}], 
       RowBox[{"allvars", "=", 
        RowBox[{"First", "/@", "s"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"allvars", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"allvars", ",", 
          RowBox[{
           RowBox[{"SameQ", "[", 
            RowBox[{
             RowBox[{"Head", "[", "#", "]"}], ",", "variable"}], "]"}], 
           "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dprint", "[", 
        RowBox[{"\"\<allvars: \>\"", ",", 
         RowBox[{"Short", "[", "allvars", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "allvars", "]"}], "<", "1"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Error: SimShow: \>\"", ",", "variable", ",", 
            "\"\< not found.\>\""}], "]"}], ";", 
          RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "get", " ", "interpolating", " ", "functions", " ", "for", " ", 
         "variable"}], "*)"}], 
       RowBox[{"s", "=", 
        RowBox[{"allvars", "/.", "s"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "s", "]"}], "\[NotEqual]", "n"}], ",", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Error: SimShow: Tissue has \>\"", ",", "n", ",", 
           "\"\< cells; there are \>\"", ",", 
           RowBox[{"Length", "[", "s", "]"}], ",", "\"\< solutions.\>\""}], 
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"get", " ", "values", " ", "at", " ", "time"}], "*)"}], 
       RowBox[{"s", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", "time", "]"}], "&"}], "/@", "s"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dprint", "[", 
        RowBox[{"\"\<Length[s]:\>\"", ",", 
         RowBox[{"Length", "[", "s", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dprint", "[", 
        RowBox[{"\"\<s: \>\"", ",", 
         RowBox[{"Short", "[", "s", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dprint", "[", 
        RowBox[{"\"\<{rgbfrom,rgbto}:\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"rgbfrom", ",", "rgbto"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"colors", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"RGBThreshold", "[", 
           RowBox[{"#", ",", "threshold", ",", 
            RowBox[{"{", 
             RowBox[{"rgbfrom", ",", "rgbto"}], "}"}]}], "]"}], "&"}], "/@", 
         "s"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dprint", "[", 
        RowBox[{"\"\<colors: \>\"", ",", 
         RowBox[{"Short", "[", "colors", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dprint", "[", 
        RowBox[{"\"\<opt: \>\"", ",", "opt"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"g", "=", 
        RowBox[{"ShowTissue", "[", 
         RowBox[{"tissue", ",", 
          RowBox[{"\"\<CellStyle\>\"", "\[Rule]", "colors"}], ",", "opt"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dprint", "[", 
        RowBox[{"\"\<g:\>\"", ",", "g"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "g", "]"}], ";"}]}], "]"}]}], ";"}], "\n", 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.5461103746355567`*^9, 3.546110374637557*^9}, {
  3.5461104375756607`*^9, 
  3.54611044047862*^9}},ExpressionUUID->"4e2bdc33-95c9-4ed4-b362-\
ae325380d749"]
}, Closed]],

Cell[CellGroupData[{

Cell["SimShow[options only] + SimShow[variable, options]", "Subsubsection",
 CellChangeTimes->{{3.561809723387822*^9, 3.561809726738646*^9}, {
  3.56181503837532*^9, 
  3.561815042038769*^9}},ExpressionUUID->"112d9cec-81dd-492e-8a67-\
e0cafff61e15"],

Cell["\<\
This version looks for external files
\[OpenCurlyDoubleQuote]Variable\[CloseCurlyDoubleQuote]-> var
\[OpenCurlyDoubleQuote]Time\[CloseCurlyDoubleQuote]-> time (default is end of \
simulation)
\[OpenCurlyDoubleQuote]Colors\[CloseCurlyDoubleQuote]->{rgbmin, rgbmax} \
(default is {Purple, Orange})
\[OpenCurlyDoubleQuote]Values\[CloseCurlyDoubleQuote]->{minimum maximum} \
(default is auto set)
\[OpenCurlyDoubleQuote]Legend\[CloseCurlyDoubleQuote]-> True
\[OpenCurlyDoubleQuote]Tissue\[CloseCurlyDoubleQuote] -> Overrides default; \
if either \[OpenCurlyDoubleQuote]Tissue\[CloseCurlyDoubleQuote] or \
\[OpenCurlyDoubleQuote]Solution\[CloseCurlyDoubleQuote] is specified, the \
other must also be specified.
\[OpenCurlyDoubleQuote]Solution\[CloseCurlyDoubleQuote] ->Override popupmenu\
\>", "Text",
 CellChangeTimes->{{3.561813429794404*^9, 3.561813506281107*^9}, {
  3.561814765530015*^9, 3.561814770568665*^9}, {3.562003955922471*^9, 
  3.562003974983753*^9}, {3.562005537350562*^9, 
  3.562005549428578*^9}},ExpressionUUID->"da7ba837-da1a-49f5-a976-\
45b124c95169"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SimShow", "[", 
     RowBox[{"opt___", "?", "OptionQ"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "T", ",", "TS", ",", "S", ",", "SS", ",", "f", ",", "folder", ",", " ",
         "solution", ",", "sequence", ",", " ", "tissue", ",", "time", ",", 
        " ", "ctd", ",", "\[IndentingNewLine]", 
        RowBox[{"DefaultMinColor", "=", "Purple"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"DefaultMaxColor", "=", "Orange"}], ",", 
        "\[IndentingNewLine]", "DefaultColors", ",", " ", "colors", ",", 
        "range", ",", " ", "var", ",", " ", "\[IndentingNewLine]", "xrange", 
        ",", " ", "yrange", ",", " ", "legend", ",", " ", "hassolution", ",", 
        " ", "hastissue", ",", " ", "havefiles"}], "\[IndentingNewLine]", 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DefaultColors", "=", 
        RowBox[{"{", 
         RowBox[{"DefaultMinColor", ",", "DefaultMaxColor"}], "}"}]}], ";", 
       " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "options", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"legend", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<Legend\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<Legend\>\"", "\[Rule]", " ", "True"}], "}"}]}]}], ";", 
       " ", "\[IndentingNewLine]", 
       RowBox[{"var", "=", 
        RowBox[{
         RowBox[{"\"\<Variable\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<Variable\>\"", "\[Rule]", " ", "None"}], "}"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"AbortIf", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ToString", "[", "var", "]"}], "\[Equal]", "\"\<None\>\""}],
          ",", " ", "\"\<A Variable must be specified.\>\""}], "]"}], ";", 
       "  ", "\[IndentingNewLine]", 
       RowBox[{"time", " ", "=", 
        RowBox[{
         RowBox[{"\"\<Time\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<Time\>\"", "\[Rule]", " ", "0"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"range", "=", 
        RowBox[{
         RowBox[{"\"\<Values\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<Values\>\"", "\[Rule]", " ", 
           RowBox[{"{", "}"}]}], "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"solution", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<Solution\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<Solution\>\"", "\[Rule]", " ", "\"\<Unknown\>\""}], 
          "}"}]}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"hassolution", "=", "False"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"FileExistsQ", "[", "solution", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"folder", "=", 
           RowBox[{"FileNameDrop", "[", 
            RowBox[{"solution", ",", 
             RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"S", "=", 
           RowBox[{"GetSavedFile", "[", 
            RowBox[{"solution", ",", "\"\<Solution\>\""}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"hassolution", "=", "True"}], ";"}], "\[IndentingNewLine]", 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"AbortIf", "[", 
           RowBox[{
            RowBox[{"solution", " ", "\[NotEqual]", " ", "\"\<Unknown\>\""}], 
            ",", " ", 
            RowBox[{"\"\<Unable to find the file \>\"", "<>", 
             RowBox[{"ToString", "[", "solution", "]"}]}]}], "]"}], ";"}]}], 
        " ", "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"tissue", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<Tissue\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<Tissue\>\"", "\[Rule]", " ", "\"\<Unknown\>\""}], 
          "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"hastissue", "=", "False"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"FileExistsQ", "[", "tissue", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"T", "=", 
           RowBox[{"ToExpression", "[", 
            RowBox[{"Get", "[", "tissue", "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"hastissue", "=", "True"}], ";"}], "\[IndentingNewLine]", 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"AbortIf", "[", 
           RowBox[{
            RowBox[{"tissue", " ", "\[NotEqual]", " ", "\"\<Unknown\>\""}], 
            ",", " ", 
            RowBox[{"\"\<Unable to find the file \>\"", "<>", 
             RowBox[{"ToString", "[", "solution", "]"}]}]}], "]"}], ";"}]}], 
        " ", "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"havefiles", " ", "=", " ", 
        RowBox[{"hassolution", " ", "\[And]", " ", "hastissue"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AbortIf", "[", 
        RowBox[{
         RowBox[{"hassolution", " ", "\[And]", 
          RowBox[{"Not", "[", "hastissue", "]"}]}], ",", " ", 
         "\"\<Tissue File must be specified when the solution is specified.\>\
\""}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"AbortIf", "[", 
        RowBox[{
         RowBox[{"hastissue", " ", "\[And]", " ", 
          RowBox[{"Not", "[", "hassolution", "]"}]}], ",", " ", 
         "\"\<Solution File must be specified when the tissue is specified.\>\
\""}], "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"colors", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<Colors\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<Colors\>\"", "\[Rule]", " ", "DefaultColors"}], 
          "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"colors", " ", "=", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", "colors", "}"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
         RowBox[{"Length", "[", "colors", "]"}], ",", "\[IndentingNewLine]", 
         "0", ",", " ", 
         RowBox[{"colors", " ", "=", " ", "DefaultColors"}], ",", 
         "\[IndentingNewLine]", "1", ",", " ", 
         RowBox[{"colors", " ", "=", " ", 
          RowBox[{"Append", "[", 
           RowBox[{"colors", ",", " ", "DefaultMaxColor"}], "]"}]}], ",", " ",
          "\[IndentingNewLine]", "2", ",", " ", "True", ",", 
         "\[IndentingNewLine]", "_", " ", ",", " ", 
         RowBox[{"colors", "=", 
          RowBox[{"Take", "[", 
           RowBox[{"colors", ",", " ", "2"}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"find", " ", "a", " ", "folder"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Not", "[", "havefiles", "]"}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"f", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ToString", "[", "$SIMDIR", "]"}], "\[Equal]", 
              "\"\<$SIMDIR\>\""}], ",", "  ", "\[IndentingNewLine]", 
             RowBox[{"Quiet", "[", 
              RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ",", " ", 
             "$SIMDIR"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ToString", "[", "f", "]"}], "\[Equal]", 
             "\"\<$Failed\>\""}], ",", " ", 
            RowBox[{"f", "=", "\"\<\>\""}]}], "]"}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"f", "=", 
           RowBox[{"ToFileName", "[", 
            RowBox[{"f", ",", " ", "\"\<Solution*.*\>\""}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"S", "=", 
           RowBox[{"SystemDialogInput", "[", 
            RowBox[{"\"\<FileOpen\>\"", ",", " ", "f", ",", 
             RowBox[{
             "WindowTitle", "\[Rule]", " ", "\"\<Select a Solution\>\""}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"AbortIf", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ToString", "[", "S", "]"}], "\[Equal]", 
             "\"\<$Canceled\>\""}], ",", " ", "\"\<$Canceled\>\""}], "]"}], 
          ";", " ", "\[IndentingNewLine]", 
          RowBox[{"solution", "=", 
           RowBox[{"FileNameTake", "[", 
            RowBox[{"S", ",", 
             RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"folder", "=", 
           RowBox[{"FileNameDrop", "[", 
            RowBox[{"S", ",", 
             RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "check", " ", "to", " ", "make", " ", "sure", " ", "a", " ", 
            "solution", " ", "file", " ", "was", " ", "selected"}], " ", 
           "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"AbortIf", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{"solution", ",", 
                RowBox[{"-", "3"}]}], "]"}], "\[NotEqual]", " ", 
              "\"\<.nb\>\""}], " ", "\[And]", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{"solution", ",", 
                RowBox[{"-", "3"}]}], "]"}], "\[NotEqual]", " ", 
              "\"\<.mx\>\""}]}], ",", " ", 
            RowBox[{
            "\"\<Solution must have the form Solutionjjjj.nb and not '\>\"", "<>",
              "solution", "<>", "\"\<'\>\""}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AbortIf", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"StringTake", "[", 
              RowBox[{"solution", ",", "8"}], "]"}], "\[NotEqual]", " ", 
             "\"\<Solution\>\""}], ",", " ", 
            RowBox[{
            "\"\<Solution must have the form Solutionjjjj.nb or .mx and not \
\>\"", "<>", "solution", "<>", "\"\<'\>\""}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "locate", " ", "the", " ", "appropriate", " ", "tissue", " ", 
            "file"}], " ", "*)"}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"sequence", "=", 
           RowBox[{"StringDrop", "[", 
            RowBox[{
             RowBox[{"StringDrop", "[", 
              RowBox[{"solution", ",", 
               RowBox[{"-", "3"}]}], "]"}], ",", "8"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"tissue", "=", 
           RowBox[{"ToFileName", "[", 
            RowBox[{"folder", ",", " ", 
             RowBox[{
             "\"\<DTissue\>\"", "<>", "sequence", "<>", "\"\<.nb\>\""}]}], 
            "]"}]}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"AbortIf", "[", 
           RowBox[{
            RowBox[{"Not", "[", 
             RowBox[{"FileExistsQ", "[", "tissue", "]"}], "]"}], ",", " ", 
            RowBox[{
            "\"\<Unable to find tissue file '\>\"", "<>", "tissue", "<>", 
             "\"\<'\>\""}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"solution", "=", "S"}], ";", " ", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"import", " ", "the", " ", "data"}], " ", "*)"}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"T", "=", 
           RowBox[{"GetSavedFile", "[", 
            RowBox[{"folder", ",", "\"\<Tissue\>\"", ",", 
             RowBox[{"ToExpression", "[", "sequence", "]"}], ",", " ", 
             "True"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"S", "=", 
           RowBox[{"GetSavedFile", "[", 
            RowBox[{"folder", ",", " ", "\"\<Solution\>\"", ",", " ", 
             RowBox[{"ToExpression", "[", "sequence", "]"}], ",", " ", 
             "True"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"determine", " ", "the", " ", "simulation", " ", "time"}], 
        " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"ctd", " ", "=", " ", 
        RowBox[{"CommonTimeDomain", "[", "S", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{"IntervalMemberQ", "[", 
           RowBox[{
            RowBox[{"Interval", "[", "ctd", "]"}], ",", "time"}], "]"}], 
          "]"}], ",", " ", 
         RowBox[{"time", "=", 
          RowBox[{"ctd", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ";", "  ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "range", "]"}], "\[NotEqual]", " ", "2"}], 
         ",", " ", 
         RowBox[{"range", "=", 
          RowBox[{"SimRange", "[", 
           RowBox[{"S", ",", "var", ",", "time"}], "]"}]}]}], "]"}], ";", " ",
        "\[IndentingNewLine]", 
       RowBox[{"AbortIf", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ToString", "[", "range", "]"}], "\[Equal]", 
          "\"\<$Failed\>\""}], ",", " ", 
         RowBox[{"\"\<Variable \>\"", "<>", 
          RowBox[{"ToString", "[", "var", "]"}], "<>", 
          "\"\< not found.\>\""}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"xrange", ",", " ", "yrange"}], "}"}], " ", "=", " ", 
        RowBox[{"AutoScaleTemplate", "[", 
         RowBox[{"DTissue2Tissue", "[", "T", "]"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"legend", ",", " ", "\[IndentingNewLine]", 
         RowBox[{"SimShow", "[", 
          RowBox[{
          "S", ",", " ", "var", ",", " ", "time", ",", "T", ",", "colors", 
           ",", "range", ",", " ", "xrange", ",", " ", "yrange", ",", " ", 
           "opt"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"SimShow", "[", 
          RowBox[{
          "S", ",", " ", "var", ",", " ", "time", ",", " ", "T", ",", " ", 
           "colors", ",", " ", "range", ",", " ", "opt"}], "]"}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SimShow", "[", 
   RowBox[{"variable_", ",", " ", 
    RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
  RowBox[{"SimShow", "[", 
   RowBox[{
    RowBox[{"\"\<Variable\>\"", "\[Rule]", " ", "variable"}], ",", " ", 
    "opt"}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.561809727986537*^9, 3.5618097442559566`*^9}, {
   3.56180982953494*^9, 3.561809931322172*^9}, {3.561809983347076*^9, 
   3.56181011176548*^9}, {3.56181018368729*^9, 3.561810276798847*^9}, {
   3.561810389424034*^9, 3.561810438392277*^9}, {3.5618104835458603`*^9, 
   3.561810530307963*^9}, {3.561810602004095*^9, 3.561810621777219*^9}, {
   3.561810714078185*^9, 3.561810791763356*^9}, {3.561811044158731*^9, 
   3.561811075855216*^9}, {3.561811107813879*^9, 3.5618111315522747`*^9}, {
   3.561811195575397*^9, 3.561811202437573*^9}, {3.5618112414311733`*^9, 
   3.5618112624371977`*^9}, {3.561811314319046*^9, 3.561811353242859*^9}, {
   3.561811384028323*^9, 3.5618114697998857`*^9}, {3.561811529984934*^9, 
   3.561811530990952*^9}, {3.561811611135044*^9, 3.561811612381166*^9}, {
   3.5618117466383142`*^9, 3.561811832295329*^9}, {3.561812045002878*^9, 
   3.5618120552895412`*^9}, {3.561812261631324*^9, 3.5618122667384377`*^9}, {
   3.561812314767912*^9, 3.561812380141098*^9}, {3.5618124118348207`*^9, 
   3.561812673299605*^9}, {3.561812708592434*^9, 3.561812750451432*^9}, {
   3.561812950287915*^9, 3.561813171373307*^9}, {3.56181324242855*^9, 
   3.5618132450567102`*^9}, {3.56181329635056*^9, 3.561813325288166*^9}, {
   3.5618136036831408`*^9, 3.561813606641432*^9}, {3.561813713841614*^9, 
   3.561813740496804*^9}, {3.561814929510559*^9, 3.5618149729957867`*^9}, {
   3.561815012455495*^9, 3.5618150319269342`*^9}, {3.562004021890027*^9, 
   3.562004302927808*^9}, {3.562004364313387*^9, 3.562004419175145*^9}, {
   3.562004477210651*^9, 3.562004688358531*^9}, {3.562004757967741*^9, 
   3.562004848569509*^9}, {3.562004890974424*^9, 3.562004915358777*^9}, {
   3.562004958159543*^9, 3.562004963332138*^9}, {3.562005046719707*^9, 
   3.562005062705736*^9}, {3.5620050962462378`*^9, 3.562005197669135*^9}, {
   3.562005271388877*^9, 3.562005314934585*^9}, {3.5620053610783854`*^9, 
   3.562005454838107*^9}, {3.575495386821918*^9, 3.575495405634315*^9}, {
   3.576680892295123*^9, 3.576680899609939*^9}, {3.5766813289296*^9, 
   3.576681345063113*^9}, {3.5766813951906023`*^9, 3.576681427391431*^9}, {
   3.5766814788907633`*^9, 3.576681509803446*^9}, {3.576681567745553*^9, 
   3.576681570273162*^9}, {3.5766816264347687`*^9, 3.576681633574278*^9}, 
   3.5766817074276123`*^9, {3.5766818019927063`*^9, 3.576681813377919*^9}, 
   3.576681859141329*^9},ExpressionUUID->"f89905bf-5492-4dab-9e43-\
9ad0c8d06a82"]
}, Open  ]],

Cell[CellGroupData[{

Cell["SimShow[booboo]", "Subsubsection",
 CellChangeTimes->{{3.547908555244871*^9, 
  3.547908560292953*^9}},ExpressionUUID->"18bde9b6-9b86-49ec-a278-\
896d8d6e2d08"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SimShow", "[", "anythingElse___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Unexpected Input for SimShow:\>\"", ",", 
       RowBox[{"Short", "[", 
        RowBox[{
         RowBox[{"{", "anythingElse", "}"}], ",", " ", "5"}], "]"}]}], "]"}], 
     ")"}]}], ";"}], " "}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5479085615799837`*^9, 3.5479086257169847`*^9}, {
  3.561809797864932*^9, 3.561809801768509*^9}, {3.575495269828229*^9, 
  3.575495280979369*^9}},ExpressionUUID->"39d1cbe7-83b0-4ba4-afb4-\
1440b04a9a5e"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["HueInterpolate", "Subsection",
 CellChangeTimes->{{3.5580852873680897`*^9, 
  3.5580852891038857`*^9}},ExpressionUUID->"46b861f1-d871-451c-b719-\
e533f714604c"],

Cell["New 2.2.8", "Text",
 CellChangeTimes->{{3.55808529168744*^9, 
  3.5580852930399017`*^9}},ExpressionUUID->"87e74abc-2ee7-437b-b64f-\
2fee047d6c41"],

Cell[BoxData[
 RowBox[{
  RowBox[{"HueInterpolate", "[", 
   RowBox[{"x_", ",", " ", 
    RowBox[{"{", 
     RowBox[{"xmin_", ",", " ", "xmax_"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"hue1_", ",", " ", "hue2_"}], "}"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"h1", ",", " ", "h2", ",", " ", "tmp", ",", "m"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"limit", " ", 
      RowBox[{"to", " ", "[", 
       RowBox[{"0", ",", " ", "1"}], "]"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"xmin", "\[GreaterEqual]", " ", "xmax"}], ",", " ", 
       RowBox[{"Return", "[", 
        RowBox[{"Hue", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"hue1", "+", "hue2"}], ")"}], "/", "2.0"}], "]"}], "]"}]}],
       "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"h1", "=", 
      RowBox[{"Max", "[", 
       RowBox[{"0.0", ",", " ", 
        RowBox[{"Min", "[", 
         RowBox[{"hue1", ",", "hue2"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"h2", "=", 
      RowBox[{"Min", "[", 
       RowBox[{"1.0", ",", " ", 
        RowBox[{"Max", "[", 
         RowBox[{"hue1", ",", "hue2"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Make", " ", "sure", " ", "slope", " ", "is", " ", "as", " ", 
       RowBox[{"requested", "!"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"hue2", "<", " ", "hue1"}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", "h1"}], ";", " ", 
        RowBox[{"h1", "=", "h2"}], ";", " ", 
        RowBox[{"h2", "=", "tmp"}]}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"m", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"h2", "-", "h1"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"xmax", "-", "xmin"}], ")"}]}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"Hue", "[", 
       RowBox[{"h1", "+", 
        RowBox[{"m", "*", 
         RowBox[{"(", 
          RowBox[{"x", "-", "h1"}], ")"}]}]}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.558085296828315*^9, 3.5580855604089212`*^9}, {
  3.5580856174122267`*^9, 3.558085620873063*^9}, {3.558085660616536*^9, 
  3.558085664642064*^9}, {3.558085719529377*^9, 
  3.558085730039257*^9}},ExpressionUUID->"e9082f06-273f-44c1-b008-\
41273fcbde8a"]
}, Closed]],

Cell[CellGroupData[{

Cell["RGBInterpolate", "Subsection",
 CellChangeTimes->{{3.452442869027265*^9, 
  3.452442878298089*^9}},ExpressionUUID->"a49bc2ca-beba-47eb-90aa-\
5dbf4e3c3136"],

Cell["\<\
0.12, 6/8/09 - return median color if xmin=xmax or xmin > xmax \
\>", "Text",
 CellChangeTimes->{{3.453484841806985*^9, 
  3.45348485911455*^9}},ExpressionUUID->"38a88ea9-3245-48f8-b1c1-\
b1aabaf9ba32"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RGBInterpolate", "[", 
   RowBox[{"x_", ",", " ", 
    RowBox[{"{", 
     RowBox[{"xmin_", ",", " ", "xmax_"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"RGB1_", ",", " ", "RGB2_", ",", " ", "RGBS__"}], "}"}]}], "]"}],
   ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "colors", ",", " ", "nc", ",", " ", "y", ",", "r1", ",", " ", "r2", ",", 
      " ", "X", ",", " ", "X1", ",", " ", "X2", ",", " ", "C1", ",", " ", 
      "C2"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"colors", "=", 
      RowBox[{"{", 
       RowBox[{"RGB1", ",", " ", "RGB2", ",", " ", "RGBS"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nc", " ", "=", " ", 
      RowBox[{"Length", "[", "colors", "]"}]}], ";", "  ", 
     "\[IndentingNewLine]", 
     RowBox[{"X", "=", 
      RowBox[{"Min", "[", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{"x", ",", " ", "xmin"}], "]"}], ",", " ", "xmax"}], "]"}]}], 
     ";", " ", "\[IndentingNewLine]", 
     RowBox[{"y", "=", 
      RowBox[{"1", "+", 
       RowBox[{"Round", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"X", "-", "xmin"}], ")"}], "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"nc", "-", "2"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"xmax", "-", "xmin"}], ")"}]}]}], "]"}]}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"r1", " ", "=", " ", "y"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"r2", "=", 
      RowBox[{"r1", "+", "1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"C1", "=", 
      RowBox[{"colors", "[", 
       RowBox[{"[", "r1", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"C2", "=", 
      RowBox[{"colors", "[", 
       RowBox[{"[", "r2", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"X1", " ", "=", " ", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"r1", "-", "1"}], ")"}], "xmax"}], " ", "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"nc", "-", "r1", "-", "1"}], ")"}], "*", "xmin"}]}], 
       RowBox[{"nc", "-", "2"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"X2", " ", "=", " ", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"r2", "-", "1"}], ")"}], "xmax"}], " ", "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"nc", "-", "r2", "-", "1"}], ")"}], "*", "xmin"}]}], 
       RowBox[{"nc", "-", "2"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"RGBInterpolate", "[", 
      RowBox[{"x", ",", " ", 
       RowBox[{"{", 
        RowBox[{"X1", ",", " ", "X2"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"C1", ",", "C2"}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.495492154988329*^9, 3.4954922039106607`*^9}, {
   3.4954923453252783`*^9, 3.495492346036478*^9}, {3.495492393959038*^9, 
   3.495492502526451*^9}, {3.495492566002117*^9, 3.49549256843324*^9}, {
   3.495492614348143*^9, 3.4954926170833263`*^9}, {3.4954926580105877`*^9, 
   3.4954926915590973`*^9}, {3.49549272741685*^9, 3.495492756379279*^9}, {
   3.495492786468645*^9, 3.495492846257345*^9}, {3.495492894746386*^9, 
   3.495492992657922*^9}, {3.495493024576333*^9, 3.4954930249275913`*^9}, {
   3.495500510197524*^9, 3.49550051060408*^9}, {3.495500580826179*^9, 
   3.495500585815467*^9}, {3.495500627903181*^9, 3.495500664825253*^9}, {
   3.4955007144432*^9, 3.495500714850997*^9}, {3.495500783397881*^9, 
   3.495500790182459*^9}, {3.495500835232584*^9, 3.4955008355294943`*^9}, {
   3.495500983934745*^9, 3.495501047338254*^9}, 3.4955010796813383`*^9, {
   3.495501242819908*^9, 
   3.495501248268818*^9}},ExpressionUUID->"37991137-9c0b-4bfc-b3bb-\
ccd0db678a1e"],

Cell["2.2.8 don\[CloseCurlyQuote]t extrapolate beyond requested color \
range.", "Text",
 CellChangeTimes->{{3.5458361497552147`*^9, 
  3.545836168242009*^9}},ExpressionUUID->"b5883383-8666-42b9-b249-\
c4e3cee6c0aa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RGBErr", "=", "0"}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RGBInterpolate", "[", 
    RowBox[{"x_", ",", " ", 
     RowBox[{"{", 
      RowBox[{"xmin_", ",", " ", "xmax_"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"RGBmin_RGBColor", ",", " ", "RGBmax_RGBColor"}], "}"}]}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "X", ",", " ", "y", ",", " ", "RGB", ",", " ", "y1", ",", " ", "y2", 
       ",", " ", 
       RowBox[{"RGBMax", "=", "3"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"RGB", "[", 
        RowBox[{"RGBColor", "[", 
         RowBox[{"r_", ",", " ", "g_", ",", " ", "b_"}], "]"}], "]"}], ":=", 
       " ", 
       RowBox[{"{", 
        RowBox[{"r", ",", " ", "g", ",", " ", "b"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"RGB", "[", "q___", "]"}], ":=", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Error: RGBInterpolate: Not an RGBColor: \>\"", ",", " ", "q", 
           ",", " ", "\"\< Using Black.\>\""}], "]"}], ";", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], " ", ")"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"y1", "=", 
       RowBox[{"RGB", "[", "RGBmin", "]"}]}], ";", " ", 
      RowBox[{"y2", "=", 
       RowBox[{"RGB", "[", "RGBmax", "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"y1", ",", " ", "y2"}], "}"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"xmin", "\[GreaterEqual]", " ", "xmax"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"y", "=", 
          RowBox[{"RGBColor", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"y1", "+", "y2"}], ")"}], "/", "2"}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"RGBErr", "++"}], ";", " ", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"RGBErr", "\[LessEqual]", " ", "RGBMax"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{
             "\"\<Warning: RGBInterpolate: xmax = \>\"", ",", " ", "xmax", 
              ",", " ", "\"\<, must be < xmin = \>\"", ",", " ", "xmin", ",", 
              " ", "\"\<: using median value of \>\"", ",", " ", "y"}], "]"}],
             ";", " ", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"RGBEr", "\[GreaterEqual]", " ", "RGBMax"}], ",", " ", 
              RowBox[{
              "Print", "[", "\"\<Further messages will be suppressed.\>\"", 
               "]"}]}], "]"}], ";"}]}], " ", "\[IndentingNewLine]", "]"}], 
         ";", " ", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "y", "]"}], ";"}]}], "  ", 
       "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"X", "=", 
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{"Max", "[", 
          RowBox[{"x", ",", " ", "xmin"}], "]"}], ",", " ", "xmax"}], "]"}]}],
       ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"y", " ", "=", " ", 
       RowBox[{"y1", " ", "+", 
        RowBox[{
         FractionBox[
          RowBox[{"X", "-", "xmin"}], 
          RowBox[{"xmax", "-", "xmin"}]], 
         RowBox[{"(", 
          RowBox[{"y2", "-", "y1"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"Return", "[", 
       RowBox[{"RGBColor", "@@", "y"}], "]"}], ";"}]}], " ", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RGBInterpolate", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Error: Expecting RGBInterpolate[x, {xmin, xmax}, {rgbmin, \
rgbmax}], not \>\"", ",", " ", "x"}], "]"}], ";", " ", "$Failed"}], ")"}]}], 
   ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.452442880159072*^9, 3.452443121918655*^9}, {
   3.452443189672491*^9, 3.452443286639111*^9}, {3.4524434538056297`*^9, 
   3.45244352126563*^9}, {3.452444168015297*^9, 3.452444170554709*^9}, {
   3.453484139919944*^9, 3.453484141217257*^9}, {3.453484185782608*^9, 
   3.4534842068866663`*^9}, {3.453484252830172*^9, 3.453484295882573*^9}, {
   3.4534843365125847`*^9, 3.45348446326045*^9}, {3.453484543803801*^9, 
   3.453484543989345*^9}, {3.4534845942001953`*^9, 3.4534846214887114`*^9}, 
   3.453484675955017*^9, {3.453484722032989*^9, 3.453484770364694*^9}, {
   3.5458361787558002`*^9, 3.545836209947435*^9}, {3.545836282536212*^9, 
   3.5458362844122343`*^9}},ExpressionUUID->"32be1d4e-d326-472f-b371-\
76b198bea8ae"]
}, Closed]],

Cell[CellGroupData[{

Cell["RGBThreshold", "Subsection",
 CellChangeTimes->{{3.452442869027265*^9, 3.452442878298089*^9}, {
  3.459622913468686*^9, 
  3.459622916126832*^9}},ExpressionUUID->"66b48b2b-212c-4b35-a8ca-\
ad5dc33e2b4e"],

Cell["2.1.a.15 new", "Text",
 CellChangeTimes->{{3.453484841806985*^9, 3.45348485911455*^9}, {
  3.459622927629067*^9, 
  3.4596229306171007`*^9}},ExpressionUUID->"ce2c3908-816b-411d-9b33-\
1b522a5b51cc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RGBThreshold", "[", 
     RowBox[{"x_", ",", "  ", "threshold_", ",", " ", 
      RowBox[{"{", 
       RowBox[{"RGBmin_RGBColor", ",", " ", "RGBmax_RGBColor"}], "}"}]}], 
     "]"}], " ", ":=", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"x", "\[GreaterEqual]", " ", "threshold"}], ",", " ", "RGBmax", 
      ",", " ", "RGBmin"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RGBThreshold", "[", "x__", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Error: Expecting RGBThreshold[x, {xmin, xmax}, {rgbmin, rgbmax}], \
not \>\"", ",", " ", "x"}], "]"}], ";", " ", "$Failed"}], ")"}]}], ";"}], 
  " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.452442880159072*^9, 3.452443121918655*^9}, {
   3.452443189672491*^9, 3.452443286639111*^9}, {3.4524434538056297`*^9, 
   3.45244352126563*^9}, {3.452444168015297*^9, 3.452444170554709*^9}, {
   3.453484139919944*^9, 3.453484141217257*^9}, {3.453484185782608*^9, 
   3.4534842068866663`*^9}, {3.453484252830172*^9, 3.453484295882573*^9}, {
   3.4534843365125847`*^9, 3.45348446326045*^9}, {3.453484543803801*^9, 
   3.453484543989345*^9}, {3.4534845942001953`*^9, 3.4534846214887114`*^9}, 
   3.453484675955017*^9, {3.453484722032989*^9, 3.453484770364694*^9}, {
   3.459622920426667*^9, 3.459623191859829*^9}, {3.459623498967902*^9, 
   3.4596235173271027`*^9}},ExpressionUUID->"b0c465bb-aedf-4a04-8069-\
e2b29f3ec6dd"]
}, Closed]],

Cell[CellGroupData[{

Cell["ColorBlendRectangle", "Subsection",
 CellChangeTimes->{{3.452445276096939*^9, 
  3.4524452872880173`*^9}},ExpressionUUID->"c221036c-69f9-49bd-a05f-\
8137e17b6034"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ColorBlendRectangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"xmin_", ",", " ", "ymin_"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"xmax_", ",", " ", "ymax_"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"rgbfrom_", ",", " ", "rgbto_", ",", " ", "rgbs__"}], "}"}], 
      ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"textmin_:", "\"\<Min\>\""}], ",", " ", 
        RowBox[{"textmax_:", "\"\<Max\>\""}]}], "}"}], ",", " ", 
      RowBox[{"textstyle_:", 
       RowBox[{"{", "}"}]}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "n", ",", " ", "rect", ",", " ", "colors", ",", " ", "ncolors", ",", 
        " ", "deltay", ",", "htotal", ",", " ", "h", ",", " ", "y1s", ",", 
        " ", "y2s", ",", " ", "boxes", ",", " ", "tmin", ",", " ", "tmax", 
        ",", " ", "r"}], "}"}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"colors", "=", 
        RowBox[{"{", 
         RowBox[{"rgbfrom", ",", " ", "rgbto", ",", " ", "rgbs"}], "}"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"ncolors", "=", 
        RowBox[{"Length", "[", "colors", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"htotal", " ", "=", " ", 
        RowBox[{"ymax", " ", "-", " ", "ymin"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"h", " ", "=", " ", 
        RowBox[{"htotal", "/", 
         RowBox[{"(", 
          RowBox[{"ncolors", "-", "1"}], ")"}]}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"n", "=", 
        RowBox[{
         RowBox[{"100", "/", 
          RowBox[{"(", 
           RowBox[{"1", "+", "ncolors"}], ")"}]}], " ", "+", " ", "1"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rect", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x1_", ",", "y1_"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"x2_", ",", "y2_"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"C1_", ",", " ", "C2_"}], "}"}]}], "]"}], ":=", " ", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"rnext", ",", "y", ",", " ", "r", ",", " ", "c"}], "}"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"deltay", "=", 
            RowBox[{"1.0", "*", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"y2", "-", "y1"}], ")"}], "/", "n"}]}]}], ";", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"y", "=", "y1"}], ";", "\[IndentingNewLine]", 
           RowBox[{"r", "=", 
            RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{"y", "<", "ymax"}], ",", " ", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"rnext", " ", "=", " ", 
               RowBox[{"Rectangle", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"x1", ",", " ", "y"}], "}"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"x2", ",", " ", 
                   RowBox[{"y", "+", "deltay"}]}], "}"}]}], "]"}]}], ";", " ",
               "\[IndentingNewLine]", 
              RowBox[{"c", "=", 
               RowBox[{"RGBInterpolate", "[", 
                RowBox[{"y", ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"y1", ",", " ", "y2"}], "}"}], " ", ",", 
                 RowBox[{"{", 
                  RowBox[{"C1", ",", " ", "C2"}], "}"}]}], "]"}]}], ";", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"rnext", " ", "=", " ", 
               RowBox[{"Graphics", "[", 
                RowBox[{"{", 
                 RowBox[{"c", ",", " ", "rnext"}], "}"}], "]"}]}], ";", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"r", ",", " ", "rnext"}], "]"}], ";", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"y", "=", 
               RowBox[{"y", "+", "deltay"}]}], ";"}]}], "\[IndentingNewLine]",
             "]"}], ";", " ", "\[IndentingNewLine]", "r"}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"colors", " ", "=", " ", 
        RowBox[{"Partition", "[", 
         RowBox[{"colors", ",", " ", "2", ",", " ", "1"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"y1s", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"ymin", "+", 
           RowBox[{"i", "*", "h"}]}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "0", ",", " ", 
            RowBox[{"ncolors", "-", "2"}]}], "}"}]}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"y2s", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"ymin", "+", 
           RowBox[{"i", "*", "h"}]}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "1", ",", " ", 
            RowBox[{"ncolors", "-", "1"}]}], "}"}]}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"boxes", " ", "=", " ", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"rect", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"xmin", ",", " ", "#1"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"xmax", ",", " ", "#2"}], "}"}], ",", " ", "#3"}], 
            "]"}], "&"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"y1s", ",", " ", "y2s", ",", " ", "colors"}], "}"}]}], 
         "]"}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"tmin", " ", "=", " ", 
        RowBox[{"Style", "[", 
         RowBox[{"textmin", ",", " ", "textstyle"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"tmax", " ", "=", " ", 
        RowBox[{"Style", "[", 
         RowBox[{"textmax", ",", " ", "textstyle"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"boxes", ",", " ", 
         RowBox[{"Graphics", "[", 
          RowBox[{"Text", "[", 
           RowBox[{"tmin", ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"0.5", 
               RowBox[{"(", 
                RowBox[{"xmin", "+", "xmax"}], ")"}]}], ",", " ", "ymin"}], 
             "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "]"}]}], "]"}], ";", 
       " ", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"boxes", ",", " ", 
         RowBox[{"Graphics", "[", 
          RowBox[{"Text", "[", 
           RowBox[{"tmax", ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"0.5", 
               RowBox[{"(", 
                RowBox[{"xmin", "+", "xmax"}], ")"}]}], ",", " ", "ymax"}], 
             "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"r", "=", 
        RowBox[{"Show", "[", "boxes", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "r", "]"}], ";"}]}], " ", "\[IndentingNewLine]",
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.452445288840762*^9, 3.452445291613173*^9}, {
  3.452445328340867*^9, 3.4524453695407124`*^9}, {3.452445414780574*^9, 
  3.452445633410898*^9}, {3.4524457343511057`*^9, 3.4524457390535393`*^9}, {
  3.452445772159374*^9, 3.4524458306155357`*^9}, {3.4524459831546307`*^9, 
  3.452446050220867*^9}, {3.452446131539229*^9, 3.4524461925219603`*^9}, {
  3.452446307295514*^9, 3.452446337585721*^9}, {3.452446670362537*^9, 
  3.4524467167255573`*^9}, {3.4954932571975594`*^9, 3.4954936477962437`*^9}, {
  3.495493690696719*^9, 3.495493861189197*^9}, {3.495493914040317*^9, 
  3.495493914301942*^9}, {3.495493948158142*^9, 3.4954939513529253`*^9}, {
  3.4954940276972723`*^9, 3.495494035497003*^9}, {3.495499151447133*^9, 
  3.49549924365026*^9}, {3.4954992962473173`*^9, 3.495499310436716*^9}, {
  3.495501711680303*^9, 
  3.4955017223792067`*^9}},ExpressionUUID->"e59daf24-c064-4325-aaef-\
189ec064d682"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ColorBlendRectangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"xmin_", ",", " ", "ymin_"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"xmax_", ",", " ", "ymax_"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"rgbfrom_", ",", " ", "rgbto_"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"textmin_:", "\"\<Min\>\""}], ",", " ", 
        RowBox[{"textmax_:", "\"\<Max\>\""}]}], "}"}], ",", " ", 
      RowBox[{"textstyle_:", 
       RowBox[{"{", "}"}]}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "n", ",", " ", "deltay", ",", " ", "y", ",", " ", "r", ",", " ", 
        "rnext", ",", " ", "color", ",", " ", "tmin", ",", " ", "tmax"}], 
       "}"}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", "100"}], ";", "\[IndentingNewLine]", 
       RowBox[{"deltay", "=", 
        RowBox[{"1.0", "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"ymax", "-", "ymin"}], ")"}], "/", "n"}]}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"r", "=", 
        RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"y", "=", "ymin"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{"y", "<", "ymax"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"rnext", " ", "=", " ", 
           RowBox[{"Rectangle", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"xmin", ",", " ", "y"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"xmax", ",", " ", 
               RowBox[{"y", "+", "deltay"}]}], "}"}]}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"color", " ", "=", 
           RowBox[{"RGBInterpolate", "[", 
            RowBox[{"y", ",", " ", 
             RowBox[{"{", 
              RowBox[{"ymin", ",", " ", "ymax"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"rgbfrom", ",", " ", "rgbto"}], "}"}]}], "]"}]}], ";", 
          " ", "\[IndentingNewLine]", 
          RowBox[{"rnext", " ", "=", " ", 
           RowBox[{"Graphics", "[", 
            RowBox[{"{", 
             RowBox[{"color", ",", " ", "rnext"}], "}"}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"r", ",", " ", "rnext"}], "]"}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"y", "=", 
           RowBox[{"y", "+", "deltay"}]}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"tmin", " ", "=", " ", 
        RowBox[{"Style", "[", 
         RowBox[{"textmin", ",", " ", "textstyle"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"tmax", " ", "=", " ", 
        RowBox[{"Style", "[", 
         RowBox[{"textmax", ",", " ", "textstyle"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"r", ",", " ", 
         RowBox[{"Graphics", "[", 
          RowBox[{"Text", "[", 
           RowBox[{"tmin", ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"0.5", 
               RowBox[{"(", 
                RowBox[{"xmin", "+", "xmax"}], ")"}]}], ",", " ", "ymin"}], 
             "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "]"}]}], "]"}], ";", 
       " ", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"r", ",", " ", 
         RowBox[{"Graphics", "[", 
          RowBox[{"Text", "[", 
           RowBox[{"tmax", ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"0.5", 
               RowBox[{"(", 
                RowBox[{"xmin", "+", "xmax"}], ")"}]}], ",", " ", "ymax"}], 
             "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"r", "=", 
        RowBox[{"Show", "[", "r", "]"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "r", "]"}], ";"}]}], " ", "\[IndentingNewLine]",
      "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.452445288840762*^9, 3.452445291613173*^9}, {
   3.452445328340867*^9, 3.4524453695407124`*^9}, {3.452445414780574*^9, 
   3.452445633410898*^9}, {3.4524457343511057`*^9, 3.4524457390535393`*^9}, {
   3.452445772159374*^9, 3.4524458306155357`*^9}, {3.4524459831546307`*^9, 
   3.452446050220867*^9}, {3.452446131539229*^9, 3.4524461925219603`*^9}, {
   3.452446307295514*^9, 3.452446337585721*^9}, {3.452446670362537*^9, 
   3.4524467167255573`*^9}, {3.495493375496489*^9, 3.495493376974557*^9}, 
   3.495493632649494*^9},ExpressionUUID->"eb00417c-0988-4e10-9b7e-\
26d104365426"]
}, Closed]],

Cell[CellGroupData[{

Cell["SimShowFinal", "Subsection",
 CellChangeTimes->{{3.45322379176189*^9, 
  3.453223793313257*^9}},ExpressionUUID->"c4f2a242-8b93-4030-8cdc-\
a57944c05ea2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SimShowFinal", "[", 
    RowBox[{"solution_", ",", "variable_", ",", 
     RowBox[{"tissue_", "?", "DTissueQ"}], ",", 
     RowBox[{"{", 
      RowBox[{"mincolor_", ",", "maxcolor_"}], "}"}], ",", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"numbers", ",", "T", ",", "time", ",", "times"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"times", "=", 
       RowBox[{"CommonTimeDomain", "[", "solution", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"time", "=", 
       RowBox[{"Last", "[", "times", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T", "=", 
       RowBox[{"DTissue2Tissue", "[", 
        RowBox[{"tissue", ",", "solution", ",", "time"}], "]"}]}], ";", "\n", 
      "\[IndentingNewLine]", 
      RowBox[{"numbers", "=", 
       RowBox[{
        RowBox[{"\"\<CellNumbers\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<CellNumbers\>\"", "\[Rule]", "False"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"numbers", ",", 
        RowBox[{
         RowBox[{"numbers", "=", 
          RowBox[{"First", "/@", 
           RowBox[{"TissueCells", "[", "tissue", "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"SimShowFinal", "[", 
          RowBox[{"solution", ",", "variable", ",", "T", ",", 
           RowBox[{"{", 
            RowBox[{"mincolor", ",", "maxcolor"}], "}"}], ",", 
           RowBox[{"\"\<CellNumbers\>\"", "\[Rule]", "numbers"}], ",", 
           "opt"}], "]"}]}], ",", 
        RowBox[{"SimShowFinal", "[", 
         RowBox[{"solution", ",", "variable", ",", "T", ",", 
          RowBox[{"{", 
           RowBox[{"mincolor", ",", "maxcolor"}], "}"}], ",", "opt"}], 
         "]"}]}], "]"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5461123718925734`*^9, 3.546112491695947*^9}, {
  3.546112634184632*^9, 
  3.5461126350386806`*^9}},ExpressionUUID->"2d9bd3e5-5491-40b1-ab76-\
526ee45057eb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SimShowFinal", "[", 
    RowBox[{"solution_", ",", "variable_", ",", 
     RowBox[{"tissue_", "?", "DTissueQ"}], ",", 
     RowBox[{"{", 
      RowBox[{"mincolor_", ",", "maxcolor_"}], "}"}], ",", "threshold_", ",", 
     " ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"numbers", ",", "T", ",", "time", ",", "times"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"times", "=", 
       RowBox[{"CommonTimeDomain", "[", "solution", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"time", "=", 
       RowBox[{"Last", "[", "times", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T", "=", 
       RowBox[{"DTissue2Tissue", "[", 
        RowBox[{"tissue", ",", "solution", ",", "time"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"numbers", "=", 
       RowBox[{
        RowBox[{"\"\<CellNumbers\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<CellNumbers\>\"", "\[Rule]", "False"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"numbers", ",", 
        RowBox[{
         RowBox[{"numbers", "=", 
          RowBox[{"First", "/@", 
           RowBox[{"TissueCells", "[", "tissue", "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"SimShowFinal", "[", 
          RowBox[{"solution", ",", "variable", ",", "T", ",", 
           RowBox[{"{", 
            RowBox[{"mincolor", ",", "maxcolor"}], "}"}], ",", "threshold", 
           ",", " ", 
           RowBox[{"\"\<CellNumbers\>\"", "\[Rule]", "numbers"}], ",", 
           "opt"}], "]"}]}], ",", 
        RowBox[{"SimShowFinal", "[", 
         RowBox[{"solution", ",", "variable", ",", "T", ",", 
          RowBox[{"{", 
           RowBox[{"mincolor", ",", "maxcolor"}], "}"}], ",", "threshold", 
          ",", " ", "opt"}], "]"}]}], "]"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.546112519368884*^9, 3.5461125360750246`*^9}, {
  3.5461126305476284`*^9, 
  3.5461126392986293`*^9}},ExpressionUUID->"c2708343-390e-4dd4-affe-\
1730e6c1c689"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SimShowFinal", "[", 
     RowBox[{"sim_", ",", " ", "variable_", ",", " ", "template_", ",", " ", 
      RowBox[{"{", 
       RowBox[{"mincolor_", ",", " ", "maxcolor_"}], "}"}], ",", "  ", 
      "\[IndentingNewLine]", " ", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "times", ",", " ", "xrange", ",", " ", "yrange", ",", " ", "varmin", 
        ",", " ", "varmax", ",", " ", "tmax", ",", " ", "p", ",", " ", "dbg", 
        ",", " ", "dprint"}], "}"}], ",", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dbg", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<Debug\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<Debug\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";", 
       " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dprint", "[", "x___", "]"}], ":=", " ", 
        RowBox[{"If", "[", 
         RowBox[{"dbg", ",", " ", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<SimShowFinal: \>\"", ",", " ", "x"}], "]"}]}], 
         "]"}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"times", " ", "=", " ", 
        RowBox[{"CommonTimeDomain", "[", "sim", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dprint", "[", 
        RowBox[{"\"\<times: \>\"", ",", " ", "times"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"tmax", " ", "=", " ", 
        RowBox[{"Last", "[", "times", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"dprint", "[", 
        RowBox[{"\"\<tmax: \>\"", ",", " ", "tmax"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"xrange", ",", " ", "yrange"}], "}"}], " ", "=", " ", 
        RowBox[{"AutoScaleTemplate", "[", "template", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dprint", "[", 
        RowBox[{"\"\<spatial range: \>\"", ",", " ", 
         RowBox[{"{", 
          RowBox[{"xrange", ",", " ", "yrange"}], "}"}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"varmin", ",", " ", "varmax"}], "}"}], "=", 
        RowBox[{"SimRange", "[", 
         RowBox[{"sim", ",", " ", "variable", ",", " ", "tmax"}], "]"}]}], 
       ";", " ", "\[IndentingNewLine]", 
       RowBox[{"dprint", "[", 
        RowBox[{"\"\<Variable Range: \>\"", ",", " ", 
         RowBox[{"{", 
          RowBox[{"varmin", ",", " ", "varmax"}], "}"}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"p", "=", 
        RowBox[{"SimShow", "[", 
         RowBox[{
         "sim", ",", " ", "variable", ",", " ", "tmax", ",", " ", "template", 
          ",", " ", 
          RowBox[{"{", 
           RowBox[{"mincolor", ",", " ", "maxcolor"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"varmin", ",", " ", "varmax"}], "}"}], ",", " ", "xrange", 
          ",", " ", "yrange", ",", " ", "opt", ",", " ", 
          RowBox[{"\"\<CellNumbers\>\"", "\[Rule]", " ", "False"}], ",", " ", 
          
          RowBox[{"\"\<BoundaryStyle\>\"", "\[Rule]", " ", 
           RowBox[{"{", 
            RowBox[{"Thin", ",", " ", "Gray"}], "}"}]}]}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "p", "]"}], ";"}]}], " ", "\[IndentingNewLine]",
      "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SimShowFinal", "[", 
    RowBox[{"sim_", ",", " ", "variable_", ",", " ", "template_", ",", " ", 
     RowBox[{"{", 
      RowBox[{"mincolor_", ",", " ", "maxcolor_"}], "}"}], ",", "  ", 
     "\[IndentingNewLine]", 
     RowBox[{"threshold_", "?", "NumericQ"}], ",", " ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "times", ",", " ", "xrange", ",", " ", "yrange", ",", " ", "varmin", 
       ",", " ", "varmax", ",", " ", "tmax", ",", " ", "p", ",", " ", "dbg", 
       ",", " ", "dprint"}], "}"}], ",", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dbg", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<Debug\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Debug\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";", 
      " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dprint", "[", "x___", "]"}], ":=", " ", 
       RowBox[{"If", "[", 
        RowBox[{"dbg", ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<SimShowFinal: \>\"", ",", " ", "x"}], "]"}]}], "]"}]}],
       ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"times", " ", "=", " ", 
       RowBox[{"CommonTimeDomain", "[", "sim", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dprint", "[", 
       RowBox[{"\"\<times: \>\"", ",", " ", "times"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"tmax", " ", "=", " ", 
       RowBox[{"Last", "[", "times", "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"dprint", "[", 
       RowBox[{"\"\<tmax: \>\"", ",", " ", "tmax"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"xrange", ",", " ", "yrange"}], "}"}], " ", "=", " ", 
       RowBox[{"AutoScaleTemplate", "[", "template", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dprint", "[", 
       RowBox[{"\"\<spatial range: \>\"", ",", " ", 
        RowBox[{"{", 
         RowBox[{"xrange", ",", " ", "yrange"}], "}"}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"p", "=", 
       RowBox[{"SimShow", "[", 
        RowBox[{
        "sim", ",", " ", "variable", ",", " ", "tmax", ",", " ", "template", 
         ",", " ", 
         RowBox[{"{", 
          RowBox[{"mincolor", ",", " ", "maxcolor"}], "}"}], ",", " ", 
         "threshold", ",", "  ", "opt", ",", " ", 
         RowBox[{"\"\<CellNumbers\>\"", "\[Rule]", " ", "False"}], ",", " ", 
         RowBox[{"\"\<BoundaryStyle\>\"", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{"Thin", ",", " ", "Gray"}], "}"}]}]}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "p", "]"}], ";"}]}], " ", "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4532237943939753`*^9, 3.453223858666381*^9}, {
  3.453223899325869*^9, 3.453223902258513*^9}, {3.453223937093019*^9, 
  3.453223979598431*^9}, {3.453224063807281*^9, 3.45322409785262*^9}, {
  3.453224128214189*^9, 3.4532241925663013`*^9}, {3.453224260134346*^9, 
  3.453224290241948*^9}, {3.4532247020524483`*^9, 3.453224987775065*^9}, {
  3.453225360143895*^9, 3.453225362054351*^9}, {3.4534832928943777`*^9, 
  3.453483416870634*^9}, {3.453484971294949*^9, 3.453485011853137*^9}, {
  3.459626052394507*^9, 
  3.459626174486106*^9}},ExpressionUUID->"cbcce615-1059-42f4-9f77-\
2921f87c90ef"]
}, Closed]],

Cell[CellGroupData[{

Cell["SimShowAt", "Subsection",
 CellChangeTimes->{{3.45322379176189*^9, 3.453223793313257*^9}, {
  3.454070056921027*^9, 
  3.4540700583286877`*^9}},ExpressionUUID->"a392625a-7d0c-4aed-8efd-\
3080235a560f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SimShowAt", "[", 
    RowBox[{"solution_", ",", "variable_", ",", "time_", ",", 
     RowBox[{"tissue_", "?", "DTissueQ"}], ",", 
     RowBox[{"{", 
      RowBox[{"mincolor_", ",", "maxcolor_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"vmin_", ",", "vmax_"}], "}"}], ",", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"numbers", ",", "T"}], "}"}], ",", 
     RowBox[{
      RowBox[{"T", "=", 
       RowBox[{"DTissue2Tissue", "[", 
        RowBox[{"tissue", ",", "solution", ",", "time"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"numbers", "=", 
       RowBox[{
        RowBox[{"\"\<CellNumbers\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<CellNumbers\>\"", "\[Rule]", "False"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"numbers", ",", 
        RowBox[{
         RowBox[{"numbers", "=", 
          RowBox[{"First", "/@", 
           RowBox[{"TissueCells", "[", "tissue", "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"SimShowAt", "[", 
          RowBox[{"solution", ",", "variable", ",", "time", ",", "T", ",", 
           RowBox[{"{", 
            RowBox[{"mincolor", ",", "maxcolor"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"vmin", ",", "vmax"}], "}"}], ",", 
           RowBox[{"\"\<CellNumbers\>\"", "\[Rule]", "numbers"}], ",", 
           "opt"}], "]"}]}], ",", 
        RowBox[{"SimShowAt", "[", 
         RowBox[{"solution", ",", "variable", ",", "time", ",", "T", ",", 
          RowBox[{"{", 
           RowBox[{"mincolor", ",", "maxcolor"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"vmin", ",", "vmax"}], "}"}], ",", "opt"}], "]"}]}], 
       "]"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5461120694335365`*^9, 
  3.546112123469496*^9}},ExpressionUUID->"3e7c5d4f-f671-4cbd-b204-\
0fccf9728fcf"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SimShowAt", "[", 
    RowBox[{
    "sim_", ",", " ", "variable_", ",", "time_", ",", "  ", "template_", ",", 
     " ", 
     RowBox[{"{", 
      RowBox[{"mincolor_", ",", " ", "maxcolor_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"varmin_", ",", " ", "varmax_"}], "}"}], ",", "   ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "times", ",", " ", "xrange", ",", " ", "yrange", ",", "   ", "p", ",", 
       " ", "dbg", ",", " ", "dprint"}], "}"}], ",", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dbg", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<Debug\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Debug\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";", 
      " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dprint", "[", "x___", "]"}], ":=", " ", 
       RowBox[{"If", "[", 
        RowBox[{"dbg", ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<SimShowFinal: \>\"", ",", " ", "x"}], "]"}]}], "]"}]}],
       ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"times", " ", "=", " ", 
       RowBox[{"CommonTimeDomain", "[", "sim", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dprint", "[", 
       RowBox[{"\"\<times: \>\"", ",", " ", "times"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"time", " ", ">", " ", 
          RowBox[{"times", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], " ", "\[Or]", " ", 
         RowBox[{"time", " ", "<", 
          RowBox[{"times", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], ",", " ", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Error: SimShowAt: time \>\"", ",", " ", "time", ",", " ", 
           "\"\< not in range \>\"", ",", " ", "times"}], "]"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"xrange", ",", " ", "yrange"}], "}"}], " ", "=", " ", 
       RowBox[{"AutoScaleTemplate", "[", "template", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dprint", "[", 
       RowBox[{"\"\<spatial range: \>\"", ",", " ", 
        RowBox[{"{", 
         RowBox[{"xrange", ",", " ", "yrange"}], "}"}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"p", "=", 
       RowBox[{"SimShow", "[", 
        RowBox[{
        "sim", ",", " ", "variable", ",", " ", "time", ",", " ", "template", 
         ",", " ", 
         RowBox[{"{", 
          RowBox[{"mincolor", ",", " ", "maxcolor"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"varmin", ",", " ", "varmax"}], "}"}], ",", " ", "xrange", 
         ",", " ", "yrange", ",", " ", "opt", ",", " ", 
         RowBox[{"\"\<CellNumbers\>\"", "\[Rule]", " ", "False"}], ",", " ", 
         RowBox[{"\"\<BoundaryStyle\>\"", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{"Thin", ",", " ", "Gray"}], "}"}]}]}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "p", "]"}], ";"}]}], " ", "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4532237943939753`*^9, 3.453223858666381*^9}, {
  3.453223899325869*^9, 3.453223902258513*^9}, {3.453223937093019*^9, 
  3.453223979598431*^9}, {3.453224063807281*^9, 3.45322409785262*^9}, {
  3.453224128214189*^9, 3.4532241925663013`*^9}, {3.453224260134346*^9, 
  3.453224290241948*^9}, {3.4532247020524483`*^9, 3.453224987775065*^9}, {
  3.453225360143895*^9, 3.453225362054351*^9}, {3.4534832928943777`*^9, 
  3.453483416870634*^9}, {3.453484971294949*^9, 3.453485011853137*^9}, {
  3.4540700615106163`*^9, 3.4540700895343657`*^9}, {3.4540701283269787`*^9, 
  3.454070241113154*^9}},ExpressionUUID->"d7a38eaa-b083-4982-8a80-\
8c6506289efe"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SimShowAt", "[", 
    RowBox[{"solution_", ",", "variable_", ",", "time_", ",", 
     RowBox[{"tissue_", "?", "DTissueQ"}], ",", 
     RowBox[{"{", 
      RowBox[{"mincolor_", ",", "maxcolor_"}], "}"}], ",", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"numbers", ",", "T"}], "}"}], ",", 
     RowBox[{
      RowBox[{"T", "=", 
       RowBox[{"DTissue2Tissue", "[", 
        RowBox[{"tissue", ",", "solution", ",", "time"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"numbers", "=", 
       RowBox[{
        RowBox[{"\"\<CellNumbers\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<CellNumbers\>\"", "\[Rule]", "False"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"numbers", ",", 
        RowBox[{
         RowBox[{"numbers", "=", 
          RowBox[{"First", "/@", 
           RowBox[{"TissueCells", "[", "tissue", "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"SimShowAt", "[", 
          RowBox[{"solution", ",", "variable", ",", "time", ",", "T", ",", 
           RowBox[{"{", 
            RowBox[{"mincolor", ",", "maxcolor"}], "}"}], ",", 
           RowBox[{"\"\<CellNumbers\>\"", "\[Rule]", "numbers"}], ",", 
           "opt"}], "]"}]}], ",", 
        RowBox[{"SimShowAt", "[", 
         RowBox[{"solution", ",", "variable", ",", "time", ",", "T", ",", 
          RowBox[{"{", 
           RowBox[{"mincolor", ",", "maxcolor"}], "}"}], ",", "opt"}], 
         "]"}]}], "]"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5461121828374987`*^9, 
  3.546112216922434*^9}},ExpressionUUID->"148c7424-d378-427c-9e32-\
ae02acdbf259"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SimShowAt", "[", 
    RowBox[{
    "sim_", ",", " ", "variable_", ",", "time_", ",", "  ", "template_", ",", 
     " ", 
     RowBox[{"{", 
      RowBox[{"mincolor_", ",", " ", "maxcolor_"}], "}"}], ",", "  ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "times", ",", "  ", "varmin", ",", " ", "varmax", ",", "  ", "p"}], 
      "}"}], ",", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"times", " ", "=", " ", 
       RowBox[{"CommonTimeDomain", "[", "sim", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"time", " ", ">", " ", 
          RowBox[{"times", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], " ", "\[Or]", " ", 
         RowBox[{"time", " ", "<", 
          RowBox[{"times", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], ",", " ", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Error: SimShowAt: time \>\"", ",", " ", "time", ",", " ", 
           "\"\< not in range \>\"", ",", " ", "times"}], "]"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"varmin", ",", " ", "varmax"}], "}"}], "=", 
       RowBox[{"SimRange", "[", 
        RowBox[{"sim", ",", " ", "variable", ",", " ", "time"}], "]"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"p", "=", 
       RowBox[{"SimShowAt", "[", 
        RowBox[{
        "sim", ",", " ", "variable", ",", "time", ",", "  ", "template", ",", 
         " ", 
         RowBox[{"{", 
          RowBox[{"mincolor", ",", " ", "maxcolor"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"varmin", ",", " ", "varmax"}], "}"}], ",", "   ", "opt"}], 
        "]"}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "p", "]"}], ";"}]}], " ", "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4532237943939753`*^9, 3.453223858666381*^9}, {
  3.453223899325869*^9, 3.453223902258513*^9}, {3.453223937093019*^9, 
  3.453223979598431*^9}, {3.453224063807281*^9, 3.45322409785262*^9}, {
  3.453224128214189*^9, 3.4532241925663013`*^9}, {3.453224260134346*^9, 
  3.453224290241948*^9}, {3.4532247020524483`*^9, 3.453224987775065*^9}, {
  3.453225360143895*^9, 3.453225362054351*^9}, {3.4534832928943777`*^9, 
  3.453483416870634*^9}, {3.453484971294949*^9, 3.453485011853137*^9}, {
  3.4540700615106163`*^9, 3.4540700895343657`*^9}, {3.454070248741682*^9, 
  3.4540703651655083`*^9}, {3.454070435173147*^9, 3.45407053530497*^9}, {
  3.4540705677321177`*^9, 
  3.454070593182562*^9}},ExpressionUUID->"cf0bfc69-ca71-427b-a798-\
f3dca066c312"]
}, Closed]],

Cell[CellGroupData[{

Cell["ShowCellExtensions", "Subsection",
 CellChangeTimes->{{3.5776406633963757`*^9, 
  3.577640666523913*^9}},ExpressionUUID->"0addaa07-a96f-4800-a740-\
6f3f2747b990"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ShowCellExtensions", "[", 
   RowBox[{
   "S_", ",", " ", "DT_DTissue", ",", " ", "PD_", ",", " ", "t_", ",", " ", 
    RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "n", ",", " ", "T1", ",", "vals", ",", " ", "PDUNITX", ",", " ", 
      "PDUNITY", ",", "cellcenters"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{"NTissueCells", "[", "DT", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"T1", "=", 
      RowBox[{"DTissue2Tissue", "[", 
       RowBox[{"DT", ",", "S", ",", "t"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"PDUNITX", "=", 
      RowBox[{"ToExpression", "[", 
       RowBox[{
        RowBox[{"ToString", "[", "PD", "]"}], "<>", "\"\<X\>\""}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"PDUNITY", "=", 
      RowBox[{"ToExpression", "[", 
       RowBox[{
        RowBox[{"ToString", "[", "PD", "]"}], "<>", "\"\<Y\>\""}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"vals", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"PDUNITX", "[", "#", "]"}], "[", "t", "]"}], ",", 
             RowBox[{
              RowBox[{"PDUNITY", "[", "#", "]"}], "[", "t", "]"}]}], "}"}], 
           "&"}], "/@", 
          RowBox[{"Range", "[", "n", "]"}]}], ")"}], "/.", "S"}], "/.", 
       RowBox[{"{", 
        RowBox[{"t", "\[Rule]", "50"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"AbortIf", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "vals", "]"}], "<", "1"}], ",", " ", 
       "\"\<Error: ShowCellExtensions: Values for Principal Direction Unit \
Vectors Not Found in Solution.\>\""}], "]"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"cellcenters", "=", 
      RowBox[{"Centroid", "[", "T1", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"gopt", "=", 
         RowBox[{"MyFilterOptions", "[", 
          RowBox[{"Graphics", ",", "opt"}], "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"ShowTissue", "[", 
          RowBox[{"T1", ",", "opt"}], "]"}], ",", 
         RowBox[{"Graphics", "[", 
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{"#1", ",", "#2"}], "}"}], "]"}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"cellcenters", "-", 
               RowBox[{".5", " ", "vals"}]}], ",", 
              RowBox[{"cellcenters", "+", 
               RowBox[{".5", " ", "vals"}]}]}], "}"}]}], "]"}], "]"}], ",", 
         "\[IndentingNewLine]", "gopt"}], "]"}]}], "\[IndentingNewLine]", 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5776406693948107`*^9, 3.57764071523457*^9}, {
  3.577640754595945*^9, 3.577640930705091*^9}, {3.577640975974195*^9, 
  3.577640985935196*^9}, {3.577641023985317*^9, 3.577641061216013*^9}, {
  3.577740571597921*^9, 
  3.5777405738931513`*^9}},ExpressionUUID->"ddcaf687-ad28-4998-83fe-\
9683ea7d15e8"]
}, Closed]],

Cell[CellGroupData[{

Cell["SimInterpolate", "Subsection",
 CellChangeTimes->{{3.4532242145302563`*^9, 3.4532242316337967`*^9}, {
  3.453224546146454*^9, 
  3.453224549618054*^9}},ExpressionUUID->"d661c30b-cdf3-4324-9e6b-\
6dd8911932d2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SimInterpolate", "[", 
   RowBox[{"sim_", ",", " ", "var_", ",", " ", "time_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "allvars", ",", " ", "s", ",", " ", "vals", ",", " ", "timerange"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"timeRange", "=", 
      RowBox[{"CommonTimeDomain", "[", "sim", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"time", ">", 
         RowBox[{"timeRange", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], " ", "\[Or]", " ", 
        RowBox[{"time", "<", 
         RowBox[{"timeRange", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], ",", " ", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Error: SimRange: requested time \>\"", ",", " ", "time", ",", 
          " ", "\"\< is not in the data range of \>\"", ",", " ", 
          "timeRange"}], "]"}], ";", " ", 
        RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"s", "=", 
      RowBox[{"Flatten", "[", "sim", "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "get", " ", "all", " ", "indexed", " ", "variables", " ", "of", " ", 
       "specified", " ", "name"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"allvars", " ", "=", " ", 
      RowBox[{"First", "/@", "s"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"allvars", " ", "=", " ", 
      RowBox[{"Select", "[", 
       RowBox[{"allvars", ",", " ", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{
           RowBox[{"Head", "[", "#", "]"}], ",", " ", "var"}], "]"}], "&"}]}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "allvars", "]"}], "<", "1"}], ",", " ", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Error: SimInterpolate: \>\"", ",", " ", "var", ",", " ", 
          "\"\< not found.\>\""}], "]"}], ";", " ", 
        RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"vals", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"#", "[", "time", "]"}], "&"}], ")"}], "/@", 
       RowBox[{"(", 
        RowBox[{"allvars", "/.", "s"}], ")"}]}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.453224233738902*^9, 3.4532244762033587`*^9}, {
  3.453224506368166*^9, 3.453224511184826*^9}, {3.4532245694706306`*^9, 
  3.45322457215724*^9}},ExpressionUUID->"8a213095-aba6-4588-abb3-\
60d02dda2c27"]
}, Closed]],

Cell[CellGroupData[{

Cell["SimRange", "Subsection",
 CellChangeTimes->{{3.453224553874387*^9, 3.4532245553464947`*^9}, {
  3.457454173734414*^9, 3.4574541739257936`*^9}, {3.457454435433734*^9, 
  3.457454436065312*^9}},ExpressionUUID->"09549a3c-caee-4403-b4b1-\
3be8542525de"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SimRange", "[", 
   RowBox[{"sim_", ",", " ", "var_", ",", " ", 
    RowBox[{"time_", "?", "NumericQ"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"vals", ",", " ", "range"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"vals", " ", "=", " ", 
      RowBox[{"SimInterpolate", "[", 
       RowBox[{"sim", ",", " ", "var", ",", " ", "time"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"SameQ", "[", 
        RowBox[{"vals", ",", " ", "$Failed"}], "]"}], ",", " ", 
       RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"range", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Min", "[", "vals", "]"}], ",", " ", 
        RowBox[{"Max", "[", "vals", "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "range", "]"}], ";"}]}], " ", 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4532245003032103`*^9, 3.453224503477928*^9}, {
  3.4532245589590807`*^9, 3.453224661029866*^9}, {3.457454209099311*^9, 
  3.4574542112616863`*^9}},ExpressionUUID->"8b4512c8-6c60-4dfb-b265-\
1c6d8455fc34"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SimRange", "[", 
     RowBox[{"sim_", ",", " ", "var_", ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"tstart_", "?", "NumericQ"}], ",", " ", 
        RowBox[{"tend_", "?", "NumericQ"}], ",", " ", 
        RowBox[{"tdelta_", "?", "NumericQ"}]}], "}"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "s", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"s", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"SimRange", "[", 
           RowBox[{"sim", ",", " ", "var", ",", " ", "#"}], "]"}], "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"tstart", ",", " ", "tend", ",", " ", "tdelta"}], "]"}]}]}],
        ";", " ", "\[IndentingNewLine]", 
       RowBox[{"s", "=", 
        RowBox[{"Transpose", "[", "s", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"s", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Min", "[", 
           RowBox[{"s", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", " ", 
          RowBox[{"Max", "[", 
           RowBox[{"s", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "s", "]"}], ";"}]}], " ", "\[IndentingNewLine]",
      "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SimRange", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Error: Expecting SimRange[sim, var, time] or SimRange[sim, var, \
{tstart, tend, tdelta}\>\"", "]"}], ";", " ", "$Failed"}], ")"}]}], ";"}], 
  " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.457454168123144*^9, 3.45745432097227*^9}, {
  3.457454359472259*^9, 
  3.457454381910123*^9}},ExpressionUUID->"36e17595-7179-44bd-92fe-\
e7c281e318f1"]
}, Closed]],

Cell[CellGroupData[{

Cell["WTAAnimate", "Subsection",
 CellChangeTimes->{{3.571678131563005*^9, 3.571678133795959*^9}, {
  3.571689317977621*^9, 
  3.571689319464684*^9}},ExpressionUUID->"dcf547c5-18c1-41a6-82ca-\
9d9e2a984362"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"WTAAnimate", "[", 
     RowBox[{
      RowBox[{"vars_", "?", "ListQ"}], ",", " ", 
      RowBox[{"varcolors_", "?", "ListQ"}], ",", " ", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"d", ",", 
        RowBox[{"dbg", "=", "False"}], ",", " ", "dPrint", ",", "TFiles", ",",
         "SFiles", ",", " ", "nT", ",", "nS", ",", "n", ",", 
        "GetTimeDomainFromFile", ",", " ", "timespans", ",", "i", ",", "dt", 
        ",", " ", "TSFile", ",", " ", "nTimespans", ",", "plottimes", ",", 
        "frames", ",", "interval", ",", "tstart", ",", "tend", ",", "times", 
        ",", " ", "tstarts", ",", "whichinterval", ",", "whichtime", ",", 
        "jnext", ",", "timespan", ",", "timeshere", ",", "j", ",", "needed", 
        ",", " ", "colors", ",", "values", ",", "pix", ",", "need", ",", "T", 
        ",", "S", ",", "dmovie", ",", "iframe", ",", "time", ",", "pixfile", 
        ",", "type", ",", "runstring", ",", "error", ",", "rate", ",", 
        "imagetype", ",", "label", ",", "showtime", ",", "framelabel", ",", 
        "isize", ",", " ", "cwd", ",", "themovie", ",", "TheMovieFile", ",", 
        " ", "TNOW"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dbg", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<debug\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<debug\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";", 
       " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dPrint", "[", "u___", "]"}], ":=", " ", 
        RowBox[{"If", "[", 
         RowBox[{"dbg", ",", " ", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<SimMaxAnimate: \>\"", ",", " ", "u"}], "]"}]}], 
         "]"}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<vars: \>\"", ",", " ", "vars"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<colors:\>\"", ",", " ", "varcolors"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"AbortIf", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "vars", "]"}], "\[NotEqual]", " ", 
          RowBox[{"Length", "[", "varcolors", "]"}]}], ",", " ", 
         "\"\<SimMaxAnimate: Number of colors is different from number of \
variables.\>\""}], "]"}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"cwd", " ", "=", " ", 
        RowBox[{"Directory", "[", "]"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"label", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<Label\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<Label\>\"", "\[Rule]", " ", "\"\<\>\""}], "}"}]}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", "stuff", "}"}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"stuff", " ", "=", " ", 
           RowBox[{"GetSimulationPoints", "[", " ", "opt", "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"SameQ", "[", 
             RowBox[{"stuff", ",", " ", "$Canceled"}], "]"}], ",", " ", 
            RowBox[{"Return", "[", "$Canceled", "]"}]}], "]"}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"needed", " ", "=", " ", 
           RowBox[{"\"\<needed\>\"", "/.", "stuff"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"TFiles", " ", "=", " ", 
           RowBox[{"\"\<Tissues\>\"", "/.", "stuff"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"SFiles", "=", 
           RowBox[{"\"\<Solutions\>\"", "/.", "stuff"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"d", "=", 
           RowBox[{"\"\<folder\>\"", "/.", "stuff"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<TFiles: \>\"", ",", " ", 
         RowBox[{"Short", "[", 
          RowBox[{"TFiles", ",", "3"}], "]"}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<SFiles: \>\"", ",", " ", 
         RowBox[{"Short", "[", 
          RowBox[{"SFiles", ",", "3"}], "]"}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<needed: \>\"", ",", " ", "needed"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"showtime", "=", 
        RowBox[{
         RowBox[{"\"\<ShowTime\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<ShowTime\>\"", "\[Rule]", " ", "True"}], "}"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"isize", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<ImageSize\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<ImageSize\>\"", "\[Rule]", " ", "1024"}], "}"}]}]}], 
       ";", "  ", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"movie", " ", "type"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"type", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<Type\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<Type\>\"", "\[Rule]", " ", "\"\<.mov\>\""}], "}"}]}]}],
        ";", " ", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{"StringQ", "[", "type", "]"}], "]"}], ",", " ", 
         RowBox[{"type", "=", 
          RowBox[{"ToString", "[", "type", "]"}]}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"StringTake", "[", 
           RowBox[{"type", ",", "1"}], "]"}], "\[NotEqual]", " ", 
          "\"\<.\>\""}], ",", " ", 
         RowBox[{"type", "=", 
          RowBox[{"\"\<.\>\"", "<>", "type"}]}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"image", " ", "type"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"imagetype", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<ImageType\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<ImageType\>\"", "\[Rule]", " ", "\"\<.jpg\>\""}], 
          "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{"StringQ", "[", "imagetype", "]"}], "]"}], ",", " ", 
         RowBox[{"imagetype", "=", 
          RowBox[{"ToString", "[", "imagetype", "]"}]}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"StringTake", "[", 
           RowBox[{"imagetype", ",", "1"}], "]"}], "\[NotEqual]", " ", 
          "\"\<.\>\""}], ",", " ", 
         RowBox[{"imagetype", "=", 
          RowBox[{"\"\<.\>\"", "<>", "imagetype"}]}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"frame", " ", "rate"}], " ", "*)"}], " ", 
       "\[IndentingNewLine]", 
       RowBox[{"rate", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<FrameRate\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<FrameRate\>\"", "\[Rule]", " ", "4"}], "}"}]}]}], ";", 
       " ", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{"IntegerQ", "[", "rate", "]"}], "]"}], ",", " ", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<FrameRate must be an integer.\>\"", "]"}], ";", 
          " ", 
          RowBox[{"rate", "=", "4"}]}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"rate", " ", "=", " ", 
        RowBox[{"ToString", "[", "rate", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"dmovie", "=", 
        RowBox[{"ToFileName", "[", 
         RowBox[{"d", ",", "\"\<Movie-WTA-\>\""}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dmovie", "=", 
        RowBox[{"createUniqueFolder", "[", "dmovie", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Saving files to \>\"", ",", "dmovie"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"iframe", "=", "1"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "needed", "]"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"need", " ", "=", " ", 
           RowBox[{"First", "[", "needed", "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"needed", "=", 
           RowBox[{"Rest", "[", "needed", "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"i", " ", "=", " ", 
           RowBox[{"First", "[", "need", "]"}]}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"timeshere", " ", "=", " ", 
           RowBox[{"i", "/.", "need"}]}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<getting \>\"", ",", " ", 
            RowBox[{"TFiles", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"T", " ", "=", 
           RowBox[{"ToExpression", "[", 
            RowBox[{"Get", "[", " ", 
             RowBox[{"TFiles", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<getting: \>\"", ",", " ", 
            RowBox[{"SFiles", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"S", " ", "=", " ", 
           RowBox[{"Get", "[", 
            RowBox[{"SFiles", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "timeshere", "]"}], ">", "0"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"time", " ", "=", " ", 
              RowBox[{"First", "[", "timeshere", "]"}]}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"timeshere", " ", "=", " ", 
              RowBox[{"Rest", "[", "timeshere", "]"}]}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"framelabel", " ", "=", " ", "label"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{"showtime", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"framelabel", " ", "=", " ", 
                 RowBox[{"framelabel", " ", "<>", "\"\< (\>\"", "<>", 
                  RowBox[{"ToString", "[", "time", "]"}], "<>", 
                  "\"\<)\>\""}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
              " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"dPrint", "[", 
              RowBox[{
              "\"\<... insert code to handle solution at time \>\"", ",", 
               "time"}], " ", "]"}], ";", " ", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"TNOW", "=", 
              RowBox[{"DTissue2Tissue", "[", 
               RowBox[{"T", ",", "S", ",", "time"}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"pix", "=", 
              RowBox[{"WTAShow", "[", 
               RowBox[{
               "TNOW", ",", "  ", "S", ",", "time", ",", "  ", "vars", ",", 
                " ", "varcolors", ",", "opt"}], "]"}]}], ";", 
             "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
             RowBox[{"pixfile", " ", "=", " ", 
              RowBox[{"ToFileName", "[", 
               RowBox[{"dmovie", ",", 
                RowBox[{"\"\<FRAME\>\"", "<>", 
                 RowBox[{"IntegerString", "[", 
                  RowBox[{"iframe", ",", "10", ",", "4"}], "]"}], "<>", 
                 "imagetype"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"Export", "[", 
              RowBox[{"pixfile", ",", "pix", ",", 
               RowBox[{"ImageSize", "\[Rule]", " ", 
                RowBox[{"{", 
                 RowBox[{"isize", ",", "isize"}], "}"}]}]}], "]"}], ";", " ", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"iframe", " ", "=", " ", 
              RowBox[{"iframe", "+", "1"}]}], ";"}]}], " ", 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"SetDirectory", "[", "dmovie", "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"themovie", " ", "=", " ", 
        RowBox[{"\"\<Movie\>\"", "<>", "type"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"runstring", "=", 
        RowBox[{
        "\"\<ffmpeg -r \>\"", "<>", "rate", "<>", "\"\< -i 'FRAME%4d\>\"", "<>",
          "imagetype", "<>", "\"\<' '\>\"", "<>", "themovie", "<>", 
         "\"\<'\>\""}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "runstring", "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"error", "=", 
        RowBox[{"Run", "[", "runstring", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"error", "\[NotEqual]", " ", "0"}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<ERROR: ffmpeg return code is: \>\"", ",", " ", "error"}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<On some versions of Mathematica, the Kernel is unable to \
locate the correct path execute ffmpeg. You must do this manually:\\n\\nIn a \
command shell such as bash, terminal, or cmd, change your current working \
directory to (e.g., with the cd command):\\n\>\"", " ", ",", "dmovie", ",", 
            "\"\<\\nThe type the following:\\n\>\"", ",", "runstring", ",", 
            "\"\<\\nThis should create a movie file \>\"", ",", 
            RowBox[{"ToFileName", "[", 
             RowBox[{"dmovie", ",", "themovie"}], "]"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"TheMovieFile", "=", 
        RowBox[{"FileNames", "[", 
         RowBox[{"ToFileName", "[", 
          RowBox[{"dmovie", ",", "themovie"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"SetDirectory", "[", "cwd", "]"}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"Return", "[", "TheMovieFile", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], " ", 
  "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5477531698160543`*^9, 3.547753229796282*^9}, {
   3.547753328733736*^9, 3.547753330180601*^9}, 3.547753587088229*^9, {
   3.547753634931664*^9, 3.547753686199608*^9}, 3.547753790511518*^9, 
   3.547753888833336*^9, {3.5477540061369267`*^9, 3.547754027052964*^9}, {
   3.547754172601039*^9, 3.547754173864575*^9}, {3.547754215105317*^9, 
   3.5477542165682793`*^9}, {3.547754259992983*^9, 3.54775449102068*^9}, {
   3.547754584868621*^9, 3.547754939878971*^9}, {3.5477549853527*^9, 
   3.547755011472776*^9}, {3.547755086890088*^9, 3.547755121375937*^9}, {
   3.5477559573659067`*^9, 3.547756098804797*^9}, {3.5477561512150307`*^9, 
   3.547756212873509*^9}, {3.5477562438963003`*^9, 3.547756253738846*^9}, {
   3.547756984685771*^9, 3.5477572432591352`*^9}, {3.547757294149447*^9, 
   3.547757354209609*^9}, {3.54775755503302*^9, 3.547757686759404*^9}, {
   3.547757719859888*^9, 3.5477577989615107`*^9}, {3.5477578549762506`*^9, 
   3.547757905667201*^9}, {3.547757996690753*^9, 3.547757998371538*^9}, {
   3.547758162652384*^9, 3.5477582605091763`*^9}, {3.547758301683189*^9, 
   3.547758341670216*^9}, {3.547758536705174*^9, 3.547758620166934*^9}, {
   3.5477586583088427`*^9, 3.547758744332045*^9}, {3.547758783884454*^9, 
   3.547758889327382*^9}, {3.54775892387429*^9, 3.547758925255196*^9}, {
   3.5477589598469887`*^9, 3.5477589776094913`*^9}, {3.547759051638834*^9, 
   3.547759065423601*^9}, {3.547759107848626*^9, 3.547759118850274*^9}, {
   3.547759170123591*^9, 3.5477592430408*^9}, {3.5477593780399723`*^9, 
   3.547759453228355*^9}, {3.547759576143564*^9, 3.5477596132801847`*^9}, {
   3.547759657405361*^9, 3.547759737501334*^9}, {3.5477598251418667`*^9, 
   3.547760139680416*^9}, {3.547760205989085*^9, 3.547760213981234*^9}, {
   3.547760279585258*^9, 3.5477603067925367`*^9}, {3.547760500877603*^9, 
   3.547760501867032*^9}, {3.54776242566251*^9, 3.547762519133149*^9}, {
   3.5477625532775393`*^9, 3.547762635282276*^9}, {3.547762712870137*^9, 
   3.547762736136998*^9}, {3.547762787469983*^9, 3.5477629047229023`*^9}, {
   3.5477629402686653`*^9, 3.5477629692375603`*^9}, {3.547763044189412*^9, 
   3.5477630492871437`*^9}, {3.547763259802381*^9, 3.547763278542631*^9}, {
   3.547763395375918*^9, 3.547763400414771*^9}, {3.547763485991078*^9, 
   3.5477634949638968`*^9}, 3.5477635253592987`*^9, 3.5477639341534224`*^9, {
   3.5477639698247337`*^9, 3.5477639810857153`*^9}, {3.547764186579762*^9, 
   3.5477641895699177`*^9}, {3.547764319107685*^9, 3.5477644371818743`*^9}, {
   3.547764502877824*^9, 3.547764812399645*^9}, {3.547767541366242*^9, 
   3.547767626148007*^9}, {3.5477680727761307`*^9, 3.547768088267494*^9}, {
   3.5477687498160667`*^9, 3.547768752237915*^9}, {3.547905797203966*^9, 
   3.547905890264525*^9}, {3.547906029926319*^9, 3.547906037775096*^9}, {
   3.5479061282498503`*^9, 3.547906190619781*^9}, 3.547906274434999*^9, {
   3.547906406508665*^9, 3.547906438957423*^9}, {3.547906472615518*^9, 
   3.547906542763351*^9}, {3.547906665272533*^9, 3.547906665864666*^9}, {
   3.548436073755476*^9, 3.548436145228763*^9}, {3.549479974716234*^9, 
   3.549479975145404*^9}, {3.549480131189032*^9, 3.5494801397187843`*^9}, {
   3.549480212253312*^9, 3.549480235637946*^9}, {3.549480479283834*^9, 
   3.549480484656958*^9}, {3.549480663287445*^9, 3.549480663422618*^9}, {
   3.549480773950436*^9, 3.549480774638927*^9}, {3.556663969473428*^9, 
   3.556664008775008*^9}, {3.5567304071650476`*^9, 3.5567304219812317`*^9}, {
   3.55673045715371*^9, 3.556730478189983*^9}, 3.556730524082334*^9, {
   3.556730628042289*^9, 3.5567306429580297`*^9}, {3.556730886130939*^9, 
   3.5567308902786007`*^9}, 3.556730973032946*^9, {3.556731255465042*^9, 
   3.55673127321698*^9}, {3.556731354711203*^9, 3.5567313716344423`*^9}, {
   3.5567314158334923`*^9, 3.5567314745572166`*^9}, {3.556731523541204*^9, 
   3.556731529349128*^9}, {3.556731610301661*^9, 3.556731613598094*^9}, {
   3.556744303092156*^9, 3.556744355164888*^9}, {3.556744386857567*^9, 
   3.556744473535226*^9}, {3.5567446340239353`*^9, 3.556744635807032*^9}, {
   3.556744711009431*^9, 3.556744716029605*^9}, {3.5567447641889257`*^9, 
   3.556744765299499*^9}, {3.556744847031495*^9, 3.55674485124517*^9}, {
   3.556744912334176*^9, 3.556745135935693*^9}, 3.566487157487215*^9, {
   3.571678145558958*^9, 3.571678150046091*^9}, {3.5716782100711412`*^9, 
   3.571678301618163*^9}, {3.5716783589937887`*^9, 3.57167842804393*^9}, {
   3.571678510142218*^9, 3.571678547220685*^9}, {3.5716786300382032`*^9, 
   3.5716786482044086`*^9}, {3.571678684195569*^9, 3.571678776581746*^9}, {
   3.57167884051681*^9, 3.571678849377461*^9}, {3.571678906917901*^9, 
   3.571678908339301*^9}, {3.5716789395532713`*^9, 3.5716789542672863`*^9}, {
   3.571678991907024*^9, 3.5716790247658377`*^9}, {3.571679075801128*^9, 
   3.571679087986681*^9}, {3.571679121696373*^9, 3.571679122602632*^9}, {
   3.5716793153426933`*^9, 3.5716793221001453`*^9}, {3.57167939192957*^9, 
   3.571679409424137*^9}, {3.571679465255506*^9, 3.571679470034595*^9}, {
   3.571679629526581*^9, 3.5716796530447197`*^9}, {3.57167990161275*^9, 
   3.571680014067924*^9}, {3.571680051934902*^9, 3.5716800645135403`*^9}, {
   3.57168019685187*^9, 3.571680395920341*^9}, {3.5716804808172607`*^9, 
   3.5716805197039013`*^9}, {3.571680753083909*^9, 3.571680760346756*^9}, {
   3.571689194169737*^9, 3.571689224451528*^9}, {3.571689321326076*^9, 
   3.571689323198893*^9}, 3.5716895073618507`*^9, {3.571690006821349*^9, 
   3.571690044192437*^9}, {3.5716901083717937`*^9, 3.571690116934428*^9}, {
   3.571690292768416*^9, 3.571690314864985*^9}, {3.571690374596739*^9, 
   3.5716903750366*^9}, {3.7061095431860867`*^9, 3.706109544225236*^9}, {
   3.7061119927954283`*^9, 3.706112250514946*^9}, {3.70611233005945*^9, 
   3.706112331095483*^9}, 3.7061124172036037`*^9, {3.706112540798828*^9, 
   3.7061125434969673`*^9}, {3.70611294667546*^9, 3.706112949155539*^9}, {
   3.70611302752459*^9, 
   3.7061130297762547`*^9}},ExpressionUUID->"0caf0a23-78fd-497a-9ad0-\
771b23b9c88a"]
}, Closed]],

Cell[CellGroupData[{

Cell["WTAShow", "Subsection",
 CellChangeTimes->{{3.571689550184019*^9, 
  3.571689551983309*^9}},ExpressionUUID->"5be24ca4-66fa-4026-afad-\
93703d4e11a0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"WTASHOW", "[", 
     RowBox[{
     "DT_DTissue", ",", " ", "S_", ",", " ", "time_", ",", " ", "x___"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "T", "}"}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"T", "=", " ", 
        RowBox[{"DTissue2Tissue", "[", 
         RowBox[{"DT", ",", "S", ",", "time"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"WTAShow", "[", 
        RowBox[{"T", ",", " ", "S", ",", " ", "time", ",", " ", "x"}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"WTAShow", "[", 
     RowBox[{"T_Tissue", ",", "S_", ",", "time_", ",", 
      RowBox[{"vars_", "?", "ListQ"}], ",", 
      RowBox[{"varcolors_", "?", "ListQ"}], ",", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"VariableValues", ",", 
        RowBox[{"dbg", "=", "False"}], ",", "dPrint", ",", 
        "IndexOfMaximumValue", ",", "colors", ",", "pix"}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"dPrint", "[", "x___", "]"}], ":=", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"dbg", ",", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<WTAShow: \>\"", ",", "x"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "the", " ", "following", " ", "will", " ", "be", " ", "dynamic", " ",
           "variable", " ", "names"}], ",", 
         RowBox[{"not", " ", "static"}]}], "*)"}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"for", " ", "each", " ", "variable"}], ",", 
         RowBox[{"find", " ", "its", " ", "value", " ", "at", " ", "time"}]}],
         "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"VariableValues", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"SimInterpolate", "[", 
           RowBox[{"S", ",", "#", ",", "time"}], "]"}], "&"}], "/@", 
         "vars"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<VariableValues: \>\"", ",", 
         RowBox[{"Short", "[", 
          RowBox[{"VariableValues", ",", "3"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"group", " ", "by", " ", "cell"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"VariableValues", "=", 
        RowBox[{"Transpose", "[", "VariableValues", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<VariableValues: \>\"", ",", 
         RowBox[{"Short", "[", 
          RowBox[{"VariableValues", ",", "3"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "determine", " ", "which", " ", "cell", " ", "has", " ", "the", " ", 
         "maximum", " ", "value"}], "*)"}], 
       RowBox[{"IndexOfMaximumValue", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Ordering", "[", 
            RowBox[{"#", ",", 
             RowBox[{"-", "1"}]}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", "VariableValues"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<IndexOfMaximumValue: \>\"", ",", 
         RowBox[{"Short", "[", 
          RowBox[{"IndexOfMaximumValue", ",", "3"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "use", " ", "the", " ", "color", " ", "assigned", " ", "to", " ", 
         "the", " ", "maximum", " ", "value"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"colors", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"varcolors", "[", 
           RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
         "IndexOfMaximumValue"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<Colors: \>\"", ",", 
         RowBox[{"Short", "[", 
          RowBox[{"colors", ",", "3"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ShowTissue", "[", 
        RowBox[{"T", ",", 
         RowBox[{"\"\<CellStyles\>\"", "\[Rule]", "colors"}], ",", "opt"}], 
        "]"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"WTAShow", "[", 
    RowBox[{"T_Tissue", ",", "  ", "S_", ",", "time_", ",", "  ", 
     RowBox[{"vars_", "?", "ListQ"}], ",", " ", 
     RowBox[{"varcolors_", "?", "ListQ"}], ",", " ", "backgroundColor_", ",", 
     " ", 
     RowBox[{"{", 
      RowBox[{"minval_", ",", " ", "maxval_"}], "}"}], ",", "  ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"VariableValues", ",", " ", 
       RowBox[{"dbg", "=", "False"}], ",", " ", "dPrint", ",", 
       "IndexOfMaximumValue", ",", " ", "color", ",", "colors", ",", " ", 
       "pix", ",", " ", "value", ",", " ", "values", ",", "n"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"dPrint", "[", "x___", "]"}], ":=", " ", 
       RowBox[{"If", "[", 
        RowBox[{"dbg", ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<WTAShow: \>\"", ",", " ", "x"}], "]"}]}], "]"}]}], ";",
       " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"n", " ", "=", " ", 
       RowBox[{"NTissueCells", "[", "T", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"colors", "=", 
       RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<n=\>\"", ",", " ", "n"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"VariableValues", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"SimInterpolate", "[", 
          RowBox[{"S", ",", "#", ",", "time"}], "]"}], "&"}], "/@", 
        "vars"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"VariableValues", "=", 
       RowBox[{"Transpose", "[", "VariableValues", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", " ", 
        RowBox[{"i", "\[LessEqual]", " ", "n"}], ",", " ", 
        RowBox[{"i", "=", " ", 
         RowBox[{"i", "+", "1"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"values", "=", 
          RowBox[{"VariableValues", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"IndexOfMaximumValue", "=", 
          RowBox[{
           RowBox[{"Ordering", "[", 
            RowBox[{"values", ",", 
             RowBox[{"-", "1"}]}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}]}], ";", " ", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"value", "=", 
          RowBox[{"values", "[", 
           RowBox[{"[", "IndexOfMaximumValue", "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"color", "=", 
          RowBox[{"varcolors", "[", 
           RowBox[{"[", "IndexOfMaximumValue", "]"}], "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"color", " ", "=", " ", 
          RowBox[{"RGBInterpolate", "[", 
           RowBox[{"value", ",", " ", 
            RowBox[{"{", 
             RowBox[{"minval", ",", " ", "maxval"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"backgroundColor", ",", " ", "color"}], "}"}]}], "]"}]}],
          ";", " ", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"colors", ",", " ", "color"}], "]"}], ";"}]}], " ", 
       "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<Colors: \>\"", ",", " ", "colors"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"ShowTissue", "[", 
       RowBox[{"T", ",", " ", 
        RowBox[{"\"\<CellStyles\>\"", "\[Rule]", " ", "colors"}], ",", " ", 
        "opt"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"WTAShow", "[", "x___", "]"}], ":=", " ", 
    RowBox[{"AbortIf", "[", 
     RowBox[{"True", ",", " ", "\"\<WTAShow: Unexpected input.\>\""}], 
     "]"}]}], ";"}], " "}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5716895532926064`*^9, 3.571689562333207*^9}, {
   3.571689593372994*^9, 3.5716897401150713`*^9}, {3.571689863398666*^9, 
   3.571689897606642*^9}, 3.571689964927352*^9, {3.571690134882452*^9, 
   3.5716902202035847`*^9}, {3.6256093661748657`*^9, 3.625609367808181*^9}, {
   3.6256094220029488`*^9, 3.6256094366770144`*^9}, {3.6256095252759*^9, 
   3.6256095540005217`*^9}, {3.625609690429212*^9, 3.625609706896565*^9}, {
   3.6256097410714197`*^9, 3.625609838097533*^9}, {3.6256098857681313`*^9, 
   3.625610129530658*^9}, {3.625610459149116*^9, 3.625610459798473*^9}, {
   3.6256105288577337`*^9, 3.625610558309235*^9}, {3.625610617949101*^9, 
   3.625610618611467*^9}, {3.625610698107224*^9, 3.6256106996172523`*^9}, {
   3.625610730191399*^9, 3.625610752993703*^9}, {3.625610829276263*^9, 
   3.6256108335848227`*^9}, 3.6256109718129168`*^9, {3.6256110097408133`*^9, 
   3.625611050848752*^9}, {3.625611237667734*^9, 3.6256112429188137`*^9}, {
   3.6256113177377977`*^9, 3.625611368307479*^9}, {3.625611410343163*^9, 
   3.625611427801784*^9}, {3.6256116085231867`*^9, 
   3.625611763436211*^9}},ExpressionUUID->"5391be32-999a-4caa-8836-\
571e34e9849b"],

Cell["", "Text",ExpressionUUID->"3c723230-ff3e-4246-bf6a-8dd900a08303"]
}, Closed]],

Cell[CellGroupData[{

Cell["UniqueRandomColors", "Subsection",
 CellChangeTimes->{{3.5745236263421097`*^9, 3.574523628725966*^9}, 
   3.574523942780158*^9},ExpressionUUID->"d171ea8f-8fca-4780-98b3-\
b4421dc7d1fa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"UniqueRandomColors", "[", "n_", "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"r", ",", " ", "rl", ",", "j"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"r", "=", 
      RowBox[{"Range", "[", "n", "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"rl", "=", 
      RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "r", "]"}], ">", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"j", "=", 
         RowBox[{"RandomChoice", "[", "r", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"rl", ",", "j"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"r", "=", 
         RowBox[{"Complement", "[", 
          RowBox[{"r", ",", " ", 
           RowBox[{"{", "j", "}"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]",
       "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Hue", "/@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"rl", "-", "1."}], ")"}], "/", "n"}], ")"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5745236304593554`*^9, 3.574523761173131*^9}, {
  3.574523827541339*^9, 3.574523832532783*^9}, {3.574523871604866*^9, 
  3.574523938079871*^9}},ExpressionUUID->"0397d013-b810-4c25-9aee-\
38ecb21a21b6"]
}, Closed]],

Cell[CellGroupData[{

Cell["LineageAnimate", "Subsection",
 CellChangeTimes->{{3.574519543587525*^9, 
  3.5745195621136303`*^9}},ExpressionUUID->"993ba7a9-8568-4461-b4ba-\
643b95123675"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LineageAnimate", "[", 
     RowBox[{
      RowBox[{"f_", "?", "StringQ"}], ",", " ", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
    RowBox[{"LineageAnimate", "[", 
     RowBox[{
      RowBox[{"\"\<InputFolder\>\"", "\[Rule]", " ", "f"}], ",", " ", "opt"}],
      "]"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LineageAnimate", "[", 
     RowBox[{"opt___", "?", "OptionQ"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "d", ",", "dbg", ",", " ", "dPrint", ",", "TFiles", ",", "SFiles", ",",
         " ", "nT", ",", "nS", ",", "n", ",", "GetTimeDomainFromFile", ",", 
        " ", "timespans", ",", "i", ",", "dt", ",", " ", "TSFile", ",", " ", 
        "nTimespans", ",", "plottimes", ",", "frames", ",", "interval", ",", 
        "tstart", ",", "tend", ",", "times", ",", " ", "tstarts", ",", 
        "whichinterval", ",", "whichtime", ",", "jnext", ",", "timespan", ",",
         "timeshere", ",", "j", ",", "needed", ",", " ", "colors", ",", 
        "values", ",", "pix", ",", "need", ",", "T", ",", "S", ",", "dmovie", 
        ",", "iframe", ",", "time", ",", "pixfile", ",", "type", ",", 
        "runstring", ",", "error", ",", "rate", ",", "imagetype", ",", 
        "label", ",", "showtime", ",", "framelabel", ",", "isize", ",", " ", 
        "cwd", ",", "themovie", ",", "TheMovieFile", ",", " ", "TNOW", ",", 
        " ", "L", ",", " ", "nAncestralCells", ",", " ", "autoscale"}], "}"}],
       ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dbg", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<debug\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<debug\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";", 
       " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dPrint", "[", "u___", "]"}], ":=", " ", 
        RowBox[{"If", "[", 
         RowBox[{"dbg", ",", " ", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<LineageAnimate: \>\"", ",", " ", "u"}], "]"}]}], 
         "]"}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"cwd", " ", "=", " ", 
        RowBox[{"Directory", "[", "]"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"label", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<Label\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<Label\>\"", "\[Rule]", " ", "\"\<\>\""}], "}"}]}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", "\"\<stuff\>\"", "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"d", "=", 
        RowBox[{
         RowBox[{"\"\<InputFolder\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<InputFolder\>\"", "\[Rule]", " ", "\"\<Unknown\>\""}], 
          "}"}]}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", "stuff", "}"}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"d", "\[Equal]", "\"\<Unknown\>\""}], ",", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"stuff", " ", "=", " ", 
             RowBox[{"GetSimulationPoints", "[", " ", "opt", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"stuff", "=", 
             RowBox[{"GetSimulationPoints", "[", 
              RowBox[{"d", ",", "opt"}], "]"}]}]}], "\[IndentingNewLine]", 
           "]"}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"SameQ", "[", 
             RowBox[{"stuff", ",", " ", "$Canceled"}], "]"}], ",", " ", 
            RowBox[{"Return", "[", "$Canceled", "]"}]}], "]"}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"needed", " ", "=", " ", 
           RowBox[{"\"\<needed\>\"", "/.", "stuff"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"TFiles", " ", "=", " ", 
           RowBox[{"\"\<Tissues\>\"", "/.", "stuff"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"SFiles", "=", 
           RowBox[{"\"\<Solutions\>\"", "/.", "stuff"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"d", "=", 
           RowBox[{"\"\<folder\>\"", "/.", "stuff"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<TFiles: \>\"", ",", " ", 
         RowBox[{"Short", "[", 
          RowBox[{"TFiles", ",", "3"}], "]"}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<SFiles: \>\"", ",", " ", 
         RowBox[{"Short", "[", 
          RowBox[{"SFiles", ",", "3"}], "]"}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<needed: \>\"", ",", " ", "needed"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<d: \>\"", ",", " ", "d"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"L", "=", 
        RowBox[{"GetSavedFile", "[", 
         RowBox[{"d", ",", " ", "\"\<Lineage\>\"", ",", "1"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<L: \>\"", ",", " ", 
         RowBox[{"Short", "[", 
          RowBox[{"L", ",", " ", "5"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"nAncestralCells", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"Select", "[", 
          RowBox[{"L", ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"First", "[", "#", "]"}], "\[Equal]", "0"}], "&"}]}], 
          "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<nAncestralCells: \>\"", ",", " ", "nAncestralCells"}], 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"colors", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Hue", "[", 
             RowBox[{"RandomReal", "[", 
              RowBox[{"{", 
               RowBox[{"0", ",", ".9"}], "}"}], "]"}], "]"}], ",", " ", 
            RowBox[{"{", "nAncestralCells", "}"}]}], "]"}]}], ";"}], " ", 
        "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"colors", " ", "=", " ", 
        RowBox[{"UniqueRandomColors", "[", "nAncestralCells", "]"}]}], ";", 
       " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dPrint", "[", 
        RowBox[{"\"\<colors: \>\"", ",", " ", 
         RowBox[{"Short", "[", "colors", "]"}]}], "]"}], ";", "  ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Autoscaling", " ", "is", " ", "based", " ", "on", " ", "the", " ", 
         "final", " ", "time", " ", "point"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"autoscale", "=", 
        RowBox[{"AutoScaleTemplate", "[", 
         RowBox[{"ToExpression", "[", 
          RowBox[{"Get", "[", 
           RowBox[{"Last", "[", "TFiles", "]"}], "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"showtime", "=", 
        RowBox[{
         RowBox[{"\"\<ShowTime\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<ShowTime\>\"", "\[Rule]", " ", "True"}], "}"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"isize", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<ImageSize\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<ImageSize\>\"", "\[Rule]", " ", "1024"}], "}"}]}]}], 
       ";", "  ", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"movie", " ", "type"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"type", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<Type\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<Type\>\"", "\[Rule]", " ", "\"\<.mov\>\""}], "}"}]}]}],
        ";", " ", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{"StringQ", "[", "type", "]"}], "]"}], ",", " ", 
         RowBox[{"type", "=", 
          RowBox[{"ToString", "[", "type", "]"}]}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"StringTake", "[", 
           RowBox[{"type", ",", "1"}], "]"}], "\[NotEqual]", " ", 
          "\"\<.\>\""}], ",", " ", 
         RowBox[{"type", "=", 
          RowBox[{"\"\<.\>\"", "<>", "type"}]}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"image", " ", "type"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"imagetype", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<ImageType\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<ImageType\>\"", "\[Rule]", " ", "\"\<.jpg\>\""}], 
          "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{"StringQ", "[", "imagetype", "]"}], "]"}], ",", " ", 
         RowBox[{"imagetype", "=", 
          RowBox[{"ToString", "[", "imagetype", "]"}]}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"StringTake", "[", 
           RowBox[{"imagetype", ",", "1"}], "]"}], "\[NotEqual]", " ", 
          "\"\<.\>\""}], ",", " ", 
         RowBox[{"imagetype", "=", 
          RowBox[{"\"\<.\>\"", "<>", "imagetype"}]}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"frame", " ", "rate"}], " ", "*)"}], " ", 
       "\[IndentingNewLine]", 
       RowBox[{"rate", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<FrameRate\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<FrameRate\>\"", "\[Rule]", " ", "4"}], "}"}]}]}], ";", 
       " ", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{"IntegerQ", "[", "rate", "]"}], "]"}], ",", " ", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<FrameRate must be an integer.\>\"", "]"}], ";", 
          " ", 
          RowBox[{"rate", "=", "4"}]}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"rate", " ", "=", " ", 
        RowBox[{"ToString", "[", "rate", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"dmovie", "=", 
        RowBox[{"ToFileName", "[", 
         RowBox[{"d", ",", "\"\<Movie-Lineage-\>\""}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dmovie", "=", 
        RowBox[{"createUniqueFolder", "[", "dmovie", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Saving files to \>\"", ",", "dmovie"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"iframe", "=", "1"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "needed", "]"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"need", " ", "=", " ", 
           RowBox[{"First", "[", "needed", "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"needed", "=", 
           RowBox[{"Rest", "[", "needed", "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"i", " ", "=", " ", 
           RowBox[{"First", "[", "need", "]"}]}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"timeshere", " ", "=", " ", 
           RowBox[{"i", "/.", "need"}]}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<getting \>\"", ",", " ", 
            RowBox[{"TFiles", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"T", " ", "=", 
           RowBox[{"ToExpression", "[", 
            RowBox[{"Get", "[", " ", 
             RowBox[{"TFiles", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"dPrint", "[", 
           RowBox[{"\"\<getting: \>\"", ",", " ", 
            RowBox[{"SFiles", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"S", " ", "=", " ", 
           RowBox[{"GetSavedFile", "[", 
            RowBox[{
             RowBox[{"SFiles", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", " ", "\"\<Solution\>\""}], 
            "]"}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "timeshere", "]"}], ">", "0"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"time", " ", "=", " ", 
              RowBox[{"First", "[", "timeshere", "]"}]}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"timeshere", " ", "=", " ", 
              RowBox[{"Rest", "[", "timeshere", "]"}]}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"framelabel", " ", "=", " ", "label"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{"showtime", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"framelabel", " ", "=", " ", 
                 RowBox[{"framelabel", " ", "<>", "\"\< (\>\"", "<>", 
                  RowBox[{"ToString", "[", "time", "]"}], "<>", 
                  "\"\<)\>\""}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
              " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"dPrint", "[", 
              RowBox[{
              "\"\<... insert code to handle solution at time \>\"", ",", 
               "time"}], " ", "]"}], ";", " ", "\[IndentingNewLine]", 
             RowBox[{"dPrint", "[", 
              RowBox[{"\"\<T: \>\"", ",", " ", 
               RowBox[{"Short", "[", 
                RowBox[{"T", ",", "10"}], "]"}]}], "]"}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"dPrint", "[", 
              RowBox[{"\"\<S: \>\"", ",", " ", 
               RowBox[{"Short", "[", 
                RowBox[{"S", ",", "10"}], "]"}]}], "]"}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"time", ">", "0"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"TNOW", "=", 
                  RowBox[{"DTissue2Tissue", "[", 
                   RowBox[{"T", ",", "S", ",", "time"}], "]"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"TNOW", "=", 
                  RowBox[{"DTissue2Tissue", "[", "T", "]"}]}]}], 
                "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
               RowBox[{"dPrint", "[", 
                RowBox[{"\"\<TNOW: \>\"", ",", " ", 
                 RowBox[{"Short", "[", 
                  RowBox[{"TNOW", ",", " ", "10"}], "]"}]}], "]"}], ";"}], 
              " ", "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
             "\[IndentingNewLine]", " ", 
             RowBox[{"pix", " ", "=", " ", 
              RowBox[{"LineageShow", "[", 
               RowBox[{
               "T", ",", " ", "S", ",", " ", "time", ",", " ", "L", ",", "  ",
                 "opt", ",", " ", 
                RowBox[{"\"\<Colors\>\"", "\[Rule]", " ", "colors"}], ",", 
                " ", 
                RowBox[{"PlotRange", "\[Rule]", " ", "autoscale"}]}], "]"}]}],
              ";", " ", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{"pix", " ", "=", " ", 
                RowBox[{"LineageShow", "[", 
                 RowBox[{"TNOW", ",", "  ", "L", ",", "  ", "opt", ",", " ", 
                  RowBox[{"\"\<Colors\>\"", "\[Rule]", " ", "colors"}], ",", 
                  " ", 
                  RowBox[{"PlotRange", "\[Rule]", " ", "autoscale"}]}], 
                 "]"}]}], ";"}], " ", "*)"}], "\[IndentingNewLine]", 
             "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
             RowBox[{"pixfile", " ", "=", " ", 
              RowBox[{"ToFileName", "[", 
               RowBox[{"dmovie", ",", 
                RowBox[{"\"\<FRAME\>\"", "<>", 
                 RowBox[{"IntegerString", "[", 
                  RowBox[{"iframe", ",", "10", ",", "4"}], "]"}], "<>", 
                 "imagetype"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"Export", "[", 
              RowBox[{"pixfile", ",", "pix", ",", 
               RowBox[{"ImageSize", "\[Rule]", " ", 
                RowBox[{"{", 
                 RowBox[{"isize", ",", "isize"}], "}"}]}]}], "]"}], ";", " ", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"iframe", " ", "=", " ", 
              RowBox[{"iframe", "+", "1"}]}], ";"}]}], " ", 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"SetDirectory", "[", "dmovie", "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"themovie", " ", "=", " ", 
        RowBox[{"\"\<Movie\>\"", "<>", "type"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"runstring", "=", 
        RowBox[{
        "\"\<ffmpeg -r \>\"", "<>", "rate", "<>", "\"\< -i 'FRAME%4d\>\"", "<>",
          "imagetype", "<>", "\"\<' '\>\"", "<>", "themovie", "<>", 
         "\"\<'\>\""}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "runstring", "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"error", "=", 
        RowBox[{"Run", "[", "runstring", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"error", "\[NotEqual]", " ", "0"}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<ERROR: ffmpeg return code is: \>\"", ",", " ", "error"}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<On some versions of Mathematica, the Kernel is unable to \
locate the correct path execute ffmpeg. You must do this manually:\\n\\nIn a \
command shell such as bash, terminal, or cmd,  change your current working \
directory to (e.g., with the cd command):\\n\>\"", " ", ",", "dmovie", ",", 
            "\"\<\\nThe type the following:\\n\>\"", ",", "runstring", ",", 
            "\"\<\\nThis should create a movie file \>\"", ",", 
            RowBox[{"ToFileName", "[", 
             RowBox[{"dmovie", ",", "themovie"}], "]"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], " ", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"TheMovieFile", "=", 
        RowBox[{"FileNames", "[", 
         RowBox[{"ToFileName", "[", 
          RowBox[{"dmovie", ",", "themovie"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"SetDirectory", "[", "cwd", "]"}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"Return", "[", "TheMovieFile", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5477531698160543`*^9, 3.547753229796282*^9}, {
   3.547753328733736*^9, 3.547753330180601*^9}, 3.547753587088229*^9, {
   3.547753634931664*^9, 3.547753686199608*^9}, 3.547753790511518*^9, 
   3.547753888833336*^9, {3.5477540061369267`*^9, 3.547754027052964*^9}, {
   3.547754172601039*^9, 3.547754173864575*^9}, {3.547754215105317*^9, 
   3.5477542165682793`*^9}, {3.547754259992983*^9, 3.54775449102068*^9}, {
   3.547754584868621*^9, 3.547754939878971*^9}, {3.5477549853527*^9, 
   3.547755011472776*^9}, {3.547755086890088*^9, 3.547755121375937*^9}, {
   3.5477559573659067`*^9, 3.547756098804797*^9}, {3.5477561512150307`*^9, 
   3.547756212873509*^9}, {3.5477562438963003`*^9, 3.547756253738846*^9}, {
   3.547756984685771*^9, 3.5477572432591352`*^9}, {3.547757294149447*^9, 
   3.547757354209609*^9}, {3.54775755503302*^9, 3.547757686759404*^9}, {
   3.547757719859888*^9, 3.5477577989615107`*^9}, {3.5477578549762506`*^9, 
   3.547757905667201*^9}, {3.547757996690753*^9, 3.547757998371538*^9}, {
   3.547758162652384*^9, 3.5477582605091763`*^9}, {3.547758301683189*^9, 
   3.547758341670216*^9}, {3.547758536705174*^9, 3.547758620166934*^9}, {
   3.5477586583088427`*^9, 3.547758744332045*^9}, {3.547758783884454*^9, 
   3.547758889327382*^9}, {3.54775892387429*^9, 3.547758925255196*^9}, {
   3.5477589598469887`*^9, 3.5477589776094913`*^9}, {3.547759051638834*^9, 
   3.547759065423601*^9}, {3.547759107848626*^9, 3.547759118850274*^9}, {
   3.547759170123591*^9, 3.5477592430408*^9}, {3.5477593780399723`*^9, 
   3.547759453228355*^9}, {3.547759576143564*^9, 3.5477596132801847`*^9}, {
   3.547759657405361*^9, 3.547759737501334*^9}, {3.5477598251418667`*^9, 
   3.547760139680416*^9}, {3.547760205989085*^9, 3.547760213981234*^9}, {
   3.547760279585258*^9, 3.5477603067925367`*^9}, {3.547760500877603*^9, 
   3.547760501867032*^9}, {3.54776242566251*^9, 3.547762519133149*^9}, {
   3.5477625532775393`*^9, 3.547762635282276*^9}, {3.547762712870137*^9, 
   3.547762736136998*^9}, {3.547762787469983*^9, 3.5477629047229023`*^9}, {
   3.5477629402686653`*^9, 3.5477629692375603`*^9}, {3.547763044189412*^9, 
   3.5477630492871437`*^9}, {3.547763259802381*^9, 3.547763278542631*^9}, {
   3.547763395375918*^9, 3.547763400414771*^9}, {3.547763485991078*^9, 
   3.5477634949638968`*^9}, 3.5477635253592987`*^9, 3.5477639341534224`*^9, {
   3.5477639698247337`*^9, 3.5477639810857153`*^9}, {3.547764186579762*^9, 
   3.5477641895699177`*^9}, {3.547764319107685*^9, 3.5477644371818743`*^9}, {
   3.547764502877824*^9, 3.547764812399645*^9}, {3.547767541366242*^9, 
   3.547767626148007*^9}, {3.5477680727761307`*^9, 3.547768088267494*^9}, {
   3.5477687498160667`*^9, 3.547768752237915*^9}, {3.547905797203966*^9, 
   3.547905890264525*^9}, {3.547906029926319*^9, 3.547906037775096*^9}, {
   3.5479061282498503`*^9, 3.547906190619781*^9}, 3.547906274434999*^9, {
   3.547906406508665*^9, 3.547906438957423*^9}, {3.547906472615518*^9, 
   3.547906542763351*^9}, {3.547906665272533*^9, 3.547906665864666*^9}, {
   3.548436073755476*^9, 3.548436145228763*^9}, {3.549479974716234*^9, 
   3.549479975145404*^9}, {3.549480131189032*^9, 3.5494801397187843`*^9}, {
   3.549480212253312*^9, 3.549480235637946*^9}, {3.549480479283834*^9, 
   3.549480484656958*^9}, {3.549480663287445*^9, 3.549480663422618*^9}, {
   3.549480773950436*^9, 3.549480774638927*^9}, {3.556663969473428*^9, 
   3.556664008775008*^9}, {3.5567304071650476`*^9, 3.5567304219812317`*^9}, {
   3.55673045715371*^9, 3.556730478189983*^9}, 3.556730524082334*^9, {
   3.556730628042289*^9, 3.5567306429580297`*^9}, {3.556730886130939*^9, 
   3.5567308902786007`*^9}, 3.556730973032946*^9, {3.556731255465042*^9, 
   3.55673127321698*^9}, {3.556731354711203*^9, 3.5567313716344423`*^9}, {
   3.5567314158334923`*^9, 3.5567314745572166`*^9}, {3.556731523541204*^9, 
   3.556731529349128*^9}, {3.556731610301661*^9, 3.556731613598094*^9}, {
   3.556744303092156*^9, 3.556744355164888*^9}, {3.556744386857567*^9, 
   3.556744473535226*^9}, {3.5567446340239353`*^9, 3.556744635807032*^9}, {
   3.556744711009431*^9, 3.556744716029605*^9}, {3.5567447641889257`*^9, 
   3.556744765299499*^9}, {3.556744847031495*^9, 3.55674485124517*^9}, {
   3.556744912334176*^9, 3.556745135935693*^9}, 3.566487157487215*^9, {
   3.571678145558958*^9, 3.571678150046091*^9}, {3.5716782100711412`*^9, 
   3.571678301618163*^9}, {3.5716783589937887`*^9, 3.57167842804393*^9}, {
   3.571678510142218*^9, 3.571678547220685*^9}, {3.5716786300382032`*^9, 
   3.5716786482044086`*^9}, {3.571678684195569*^9, 3.571678776581746*^9}, {
   3.57167884051681*^9, 3.571678849377461*^9}, {3.571678906917901*^9, 
   3.571678908339301*^9}, {3.5716789395532713`*^9, 3.5716789542672863`*^9}, {
   3.571678991907024*^9, 3.5716790247658377`*^9}, {3.571679075801128*^9, 
   3.571679087986681*^9}, {3.571679121696373*^9, 3.571679122602632*^9}, {
   3.5716793153426933`*^9, 3.5716793221001453`*^9}, {3.57167939192957*^9, 
   3.571679409424137*^9}, {3.571679465255506*^9, 3.571679470034595*^9}, {
   3.571679629526581*^9, 3.5716796530447197`*^9}, {3.57167990161275*^9, 
   3.571680014067924*^9}, {3.571680051934902*^9, 3.5716800645135403`*^9}, {
   3.57168019685187*^9, 3.571680395920341*^9}, {3.5716804808172607`*^9, 
   3.5716805197039013`*^9}, {3.571680753083909*^9, 3.571680760346756*^9}, {
   3.571689194169737*^9, 3.571689224451528*^9}, {3.571689321326076*^9, 
   3.571689323198893*^9}, 3.5716895073618507`*^9, {3.571690006821349*^9, 
   3.571690044192437*^9}, {3.5716901083717937`*^9, 3.571690116934428*^9}, {
   3.571690292768416*^9, 3.571690314864985*^9}, {3.571690374596739*^9, 
   3.5716903750366*^9}, {3.574519551795868*^9, 3.5745196168646107`*^9}, {
   3.5745196645062428`*^9, 3.57451968256882*^9}, {3.574519896483374*^9, 
   3.574519910604905*^9}, {3.574519940758224*^9, 3.574520019403871*^9}, {
   3.574520063711734*^9, 3.574520104028655*^9}, {3.5745201409370537`*^9, 
   3.574520196663478*^9}, {3.574520241133264*^9, 3.574520304774929*^9}, {
   3.574520603213159*^9, 3.5745206775066977`*^9}, {3.574520708846534*^9, 
   3.5745207471820517`*^9}, {3.574520809329298*^9, 3.574520859355619*^9}, {
   3.574520922544669*^9, 3.574520923327693*^9}, {3.574521155275359*^9, 
   3.5745212031803217`*^9}, {3.57452125579895*^9, 3.574521272497837*^9}, {
   3.574521410642194*^9, 3.5745214490611258`*^9}, {3.574521685854095*^9, 
   3.57452168945271*^9}, {3.574521767572336*^9, 3.574521770011565*^9}, 
   3.5745218161193867`*^9, {3.574522569210083*^9, 3.574522638566988*^9}, {
   3.574522690166593*^9, 3.574522692609179*^9}, {3.57452351070534*^9, 
   3.574523511053144*^9}, {3.574523970751924*^9, 3.57452398733477*^9}, {
   3.577034942032468*^9, 3.577034983364087*^9}, {3.577035020144189*^9, 
   3.577035024617613*^9}, {3.577035097076215*^9, 3.577035101612735*^9}, {
   3.577035159860558*^9, 3.577035202387909*^9}, {3.577035256266535*^9, 
   3.577035274445859*^9}, {3.577035331545022*^9, 3.577035359778335*^9}, {
   3.577035447290389*^9, 3.577035449004183*^9}, {3.57703549584717*^9, 
   3.577035529841527*^9}, {3.706109556761407*^9, 3.70610955892178*^9}, {
   3.7061122961931334`*^9, 3.706112316068027*^9}, 3.706112454574854*^9, {
   3.7061129310906267`*^9, 3.706112933394403*^9}, {3.70611301278677*^9, 
   3.706113016602417*^9}},ExpressionUUID->"b03b46dc-2b6a-4473-a0e2-\
b680f57df9c8"]
}, Closed]],

Cell[CellGroupData[{

Cell["LineageShow", "Subsection",
 CellChangeTimes->{{3.5745183715947657`*^9, 
  3.5745183732417507`*^9}},ExpressionUUID->"a7727cda-a0c1-4844-b1aa-\
54faa0b83494"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LineageShow", "[", 
   RowBox[{
   "DT_DTissue", ",", " ", "S_", ",", " ", "time_", ",", " ", "L_", ",", " ", 
    
    RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "T", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"T", "=", " ", 
      RowBox[{"DTissue2Tissue", "[", 
       RowBox[{"DT", ",", "S", ",", "time"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"LineageShow", "[", 
      RowBox[{"T", ",", " ", "L", ",", " ", "opt"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.57451912531389*^9, 3.5745191668033323`*^9}, {
  3.5745193317223167`*^9, 
  3.574519369271299*^9}},ExpressionUUID->"6c5e1355-7c7f-4074-9a6e-\
127c1ed458a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LineageShow", "[", 
   RowBox[{"T_Tissue", ",", " ", "L_", ",", " ", 
    RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "n", ",", " ", "ancestors", ",", " ", "originals", ",", " ", "cn", ",", 
      " ", "AMap", ",", " ", "rr", ",", "rh", ",", " ", "colors", ",", " ", 
      "colormap"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"originals", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"L", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"First", "[", "#", "]"}], "\[Equal]", "0"}], "&"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"Length", "[", "originals", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"rr", ":=", " ", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", ".9"}], "}"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"rh", " ", ":=", " ", 
      RowBox[{"Hue", "[", "rr", "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"colors", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"\"\<Colors\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Colors\>\"", "\[Rule]", " ", 
          RowBox[{"{", "}"}]}], "}"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "colors", "]"}], "<", "n"}], ",", " ", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"colors", ",", " ", "rh"}], "]"}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"colors", " ", "=", " ", 
      RowBox[{"Take", "[", 
       RowBox[{"colors", ",", " ", "n"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ancestors", "[", "cellNumbers_", "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"LL", ",", "rules", ",", "theAncestors"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"LL", "=", 
          RowBox[{"Complement", "[", 
           RowBox[{"L", ",", "originals"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"rules", "=", 
          RowBox[{"Reverse", "/@", "LL"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"theAncestors", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "//.", "rules"}], ")"}], "&"}], "/@", 
           "cellNumbers"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"cn", " ", "=", " ", 
      RowBox[{"Range", "[", 
       RowBox[{"NTissueCells", "[", "T", "]"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"AMap", "=", 
      RowBox[{"ancestors", "[", "cn", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"colormap", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"colors", "[", 
         RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "AMap"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ShowTissue", "[", 
      RowBox[{"T", ",", " ", "opt", ",", " ", 
       RowBox[{"\"\<CellStyles\>\"", "\[Rule]", " ", "colormap"}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5745183930532503`*^9, 3.574518421167326*^9}, {
  3.57451846702299*^9, 3.57451850813379*^9}, {3.5745185694502487`*^9, 
  3.574518651756379*^9}, {3.574518682740601*^9, 3.574518817017836*^9}, {
  3.574518856961801*^9, 3.574518976441902*^9}, {3.57451918285544*^9, 
  3.5745192926391773`*^9}},ExpressionUUID->"588530f5-fbf6-4541-ad3d-\
26386a4f0312"]
}, Closed]],

Cell[CellGroupData[{

Cell["SimAnimate", "Subsection",
 CellChangeTimes->{{3.45244512586959*^9, 
  3.452445128018978*^9}},ExpressionUUID->"fd3e03cc-8cbb-40f3-a06e-\
06a842b2eb75"],

Cell["\<\

Any option for ShowTissue (\[OpenCurlyDoubleQuote]CellNumbers\
\[CloseCurlyDoubleQuote], EdgeStyles\[CloseCurlyDoubleQuote], etc.)  or Plot \
(Frame, BaseStyle, PlotLabel, etc.) may be used

Additional options for dynamic simulations: 

\t\[OpenCurlyDoubleQuote]Colors\[CloseCurlyDoubleQuote] -> {LightGreen, Red} \
(ignored when variable is None)
\t\[OpenCurlyDoubleQuote]Values\[CloseCurlyDoubleQuote] -> {}  (minimum, \
maximum} (unless variable is None)
\t\[OpenCurlyDoubleQuote]Label\[CloseCurlyDoubleQuote]->variable (time) (just \
(time) when variable is None), unless \[OpenCurlyDoubleQuote]ShowTime\
\[CloseCurlyDoubleQuote]->False
\t\[OpenCurlyDoubleQuote]ShowTime\[CloseCurlyDoubleQuote]->True
\t\[OpenCurlyDoubleQuote]Type\[CloseCurlyDoubleQuote]->mov (final movie type; \
whether or not it works depends on local ffmpeg and codec installation)
\t\[OpenCurlyDoubleQuote]ImageType\[CloseCurlyDoubleQuote]->jpg (whether or \
not what you choose works depends on local implementation)
\t\[OpenCurlyDoubleQuote]FrameRate\[CloseCurlyDoubleQuote]->4
\t\[OpenCurlyDoubleQuote]PlotTimes\[CloseCurlyDoubleQuote]->{start,end}, \
normally taken from timespans file, but can be overriden to do a shorter \
span.
\t\[OpenCurlyDoubleQuote]ImageSize\[CloseCurlyDoubleQuote]-> 1024
\t\[OpenCurlyDoubleQuote]Frames\[CloseCurlyDoubleQuote] -> Number of frames \
in movie (note Frames is one larger than the number of intervals, e.g, if \
\[OpenCurlyDoubleQuote]PlotTImes\[CloseCurlyDoubleQuote]-> {10,20} then you \
need to set \[OpenCurlyDoubleQuote]Frame\[CloseCurlyDoubleQuote]->3 to get \
frames at 10,15,20; and \
\[OpenCurlyDoubleQuote]Frames\[CloseCurlyDoubleQuote]-> 11 to get \
10,11,12,...,20.
\t
\t3.0.16 alllow specification of input folder to bypass menuing.  Default \
autoscale to last Tissue (previously defaults to whatever Plot does). Allow \
option \[OpenCurlyDoubleQuote]Label\[CloseCurlyDoubleQuote]-> \
\[OpenCurlyDoubleQuote]None\[CloseCurlyDoubleQuote] to override auto \
labelling by variable name. 
\t
\t3.0.51 update ffmpeg command remove sameq option\
\>", "Text",
 CellChangeTimes->{{3.547906695460072*^9, 3.547906901260816*^9}, {
  3.54790693407141*^9, 3.547906964204034*^9}, {3.5479070169643393`*^9, 
  3.5479070987711153`*^9}, {3.5484361256562843`*^9, 3.548436129924898*^9}, {
  3.556731675507584*^9, 3.556731775657867*^9}, {3.574618440171095*^9, 
  3.574618459387026*^9}, {3.5746186331221447`*^9, 3.5746186505057173`*^9}, {
  3.574618804257805*^9, 3.574618836592011*^9}, {3.706109577627323*^9, 
  3.706109603371131*^9}},ExpressionUUID->"fd2edea7-7394-472d-bb16-\
7b70f98794de"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SimAnimate", "[", 
     RowBox[{"variable_Symbol", ",", " ", 
      RowBox[{"d_", "?", "StringQ"}], ",", " ", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
    RowBox[{"SimAnimate", "[", 
     RowBox[{"variable", ",", " ", 
      RowBox[{"\"\<InputFolder\>\"", "\[Rule]", " ", "d"}], ",", " ", "opt"}],
      "]"}]}], ";"}], "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SimAnimate", "[", 
     RowBox[{"variable_Symbol", ",", " ", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"d", ",", 
        RowBox[{"dbg", "=", "True"}], ",", " ", "dPrint", ",", "TFiles", ",", 
        "SFiles", ",", " ", "nT", ",", "nS", ",", "n", ",", 
        "GetTimeDomainFromFile", ",", " ", "timespans", ",", "i", ",", "dt", 
        ",", " ", "TSFile", ",", " ", "nTimespans", ",", "plottimes", ",", 
        "frames", ",", "interval", ",", "tstart", ",", "tend", ",", "times", 
        ",", " ", "tstarts", ",", "whichinterval", ",", "whichtime", ",", 
        "jnext", ",", "timespan", ",", "timeshere", ",", "j", ",", "needed", 
        ",", " ", "colors", ",", "values", ",", "pix", ",", "need", ",", "T", 
        ",", "S", ",", "dmovie", ",", "iframe", ",", "time", ",", "pixfile", 
        ",", "type", ",", "runstring", ",", "error", ",", "rate", ",", 
        "imagetype", ",", "label", ",", " ", "none", ",", "showtime", ",", 
        "framelabel", ",", "isize", ",", " ", "cwd", ",", "themovie", ",", 
        "TheMovieFile", ",", " ", "autoscale"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"dPrint", "[", "u___", "]"}], ":=", " ", 
        RowBox[{"If", "[", 
         RowBox[{"dbg", ",", " ", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<SimAnimate: \>\"", ",", " ", "u"}], "]"}]}], "]"}]}], 
       ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"cwd", " ", "=", " ", 
        RowBox[{"Directory", "[", "]"}]}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"none", " ", "=", " ", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"variable", ",", " ", "None"}], "]"}], " ", "\[Or]", " ", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<None\>\"", ",", 
             RowBox[{"{", "}"}], ",", "False"}], "}"}], ",", " ", 
           "variable"}], "]"}]}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"d", "=", 
        RowBox[{
         RowBox[{"\"\<InputFolder\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<InputFolder\>\"", "\[Rule]", " ", "\"\<Unknown\>\""}], 
          "}"}]}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", "stuff", "}"}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ToString", "[", "d", "]"}], "\[Equal]", 
              "\"\<Unknown\>\""}], ",", " ", "\[IndentingNewLine]", 
             RowBox[{"stuff", " ", "=", " ", 
              RowBox[{"GetSimulationPoints", "[", "opt", "]"}]}], ",", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"stuff", " ", "=", " ", 
              RowBox[{"GetSimulationPoints", "[", 
               RowBox[{"d", ",", " ", "opt"}], "]"}]}]}], 
            "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"SameQ", "[", 
              RowBox[{"stuff", ",", " ", "$Canceled"}], "]"}], ",", " ", 
             RowBox[{"Return", "[", "$Canceled", "]"}]}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"needed", " ", "=", " ", 
           RowBox[{"\"\<needed\>\"", "/.", "stuff"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"TFiles", " ", "=", " ", 
           RowBox[{"\"\<Tissues\>\"", "/.", "stuff"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"SFiles", "=", 
           RowBox[{"\"\<Solutions\>\"", "/.", "stuff"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"d", "=", 
           RowBox[{"\"\<folder\>\"", "/.", "stuff"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"autoscale", "=", 
        RowBox[{"AutoScaleTemplate", "[", 
         RowBox[{"ToExpression", "[", 
          RowBox[{"Get", "[", 
           RowBox[{"Last", "[", "TFiles", "]"}], "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"colors", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<Colors\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<Colors\>\"", "\[Rule]", " ", 
           RowBox[{"{", 
            RowBox[{"LightGreen", ",", "Pink"}], "}"}]}], "}"}]}]}], ";", " ",
        "\[IndentingNewLine]", 
       RowBox[{"values", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<Values\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<Values\>\"", "\[Rule]", " ", 
           RowBox[{"{", 
            RowBox[{"0.0", ",", " ", "1.0"}], "}"}]}], "}"}]}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"label", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<Label\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<Label\>\"", "\[Rule]", " ", 
           RowBox[{
            RowBox[{"ToString", "[", "variable", "]"}], "<>", "\"\< \>\""}]}],
           "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ToString", "[", "label", "]"}], "\[Equal]", 
          "\"\<None\>\""}], ",", " ", 
         RowBox[{"label", "=", "\"\<\>\""}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"showtime", "=", 
        RowBox[{
         RowBox[{"\"\<ShowTime\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<ShowTime\>\"", "\[Rule]", " ", "True"}], "}"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"isize", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<ImageSize\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<ImageSize\>\"", "\[Rule]", " ", "1024"}], "}"}]}]}], 
       ";", "  ", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"movie", " ", "type"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"type", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<Type\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<Type\>\"", "\[Rule]", " ", "\"\<.mov\>\""}], "}"}]}]}],
        ";", " ", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{"StringQ", "[", "type", "]"}], "]"}], ",", " ", 
         RowBox[{"type", "=", 
          RowBox[{"ToString", "[", "type", "]"}]}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"StringTake", "[", 
           RowBox[{"type", ",", "1"}], "]"}], "\[NotEqual]", " ", 
          "\"\<.\>\""}], ",", " ", 
         RowBox[{"type", "=", 
          RowBox[{"\"\<.\>\"", "<>", "type"}]}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"image", " ", "type"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"imagetype", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<ImageType\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<ImageType\>\"", "\[Rule]", " ", "\"\<.jpg\>\""}], 
          "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{"StringQ", "[", "imagetype", "]"}], "]"}], ",", " ", 
         RowBox[{"imagetype", "=", 
          RowBox[{"ToString", "[", "imagetype", "]"}]}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"StringTake", "[", 
           RowBox[{"imagetype", ",", "1"}], "]"}], "\[NotEqual]", " ", 
          "\"\<.\>\""}], ",", " ", 
         RowBox[{"imagetype", "=", 
          RowBox[{"\"\<.\>\"", "<>", "imagetype"}]}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"frame", " ", "rate"}], " ", "*)"}], " ", 
       "\[IndentingNewLine]", 
       RowBox[{"rate", " ", "=", " ", 
        RowBox[{
         RowBox[{"\"\<FrameRate\>\"", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\"\<FrameRate\>\"", "\[Rule]", " ", "4"}], "}"}]}]}], ";", 
       " ", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{"IntegerQ", "[", "rate", "]"}], "]"}], ",", " ", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<FrameRate must be an integer.\>\"", "]"}], ";", 
          " ", 
          RowBox[{"rate", "=", "4"}]}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"rate", " ", "=", " ", 
        RowBox[{"ToString", "[", "rate", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Not", "[", "none", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "values", "]"}], "\[NotEqual]", " ", "2"}],
            ",", " ", 
           RowBox[{
            RowBox[{
            "Print", "[", 
             "\"\<\\\"Values\\\" must be a list of length 2.\>\"", "]"}], ";",
             " ", 
            RowBox[{"Return", "[", 
             RowBox[{"{", "}"}], "]"}]}]}], "]"}]}], "]"}], ";", "  ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"none", ",", "\[IndentingNewLine]", 
         RowBox[{"dmovie", "=", 
          RowBox[{"ToFileName", "[", 
           RowBox[{"d", ",", "\"\<Movie-\>\""}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"dmovie", "=", 
          RowBox[{"ToFileName", "[", 
           RowBox[{"d", ",", 
            RowBox[{"\"\<Movie-\>\"", "<>", 
             RowBox[{"ToString", "[", "variable", "]"}], "<>", 
             "\"\<-\>\""}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dmovie", "=", 
        RowBox[{"createUniqueFolder", "[", "dmovie", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Saving files to \>\"", ",", "dmovie"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"iframe", "=", "1"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "needed", "]"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"need", " ", "=", " ", 
           RowBox[{"First", "[", "needed", "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"needed", "=", 
           RowBox[{"Rest", "[", "needed", "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"i", " ", "=", " ", 
           RowBox[{"First", "[", "need", "]"}]}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"timeshere", " ", "=", " ", 
           RowBox[{"i", "/.", "need"}]}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"T", " ", "=", 
           RowBox[{"GetSavedFile", "[", " ", 
            RowBox[{
             RowBox[{"TFiles", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", " ", "\"\<Tissue\>\""}], 
            "]"}]}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"S", " ", "=", " ", 
           RowBox[{"GetSavedFile", "[", 
            RowBox[{
             RowBox[{"SFiles", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", " ", "\"\<Solution\>\""}], 
            "]"}]}], ";", " ", "\[IndentingNewLine]", " ", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "timeshere", "]"}], ">", "0"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"time", " ", "=", " ", 
              RowBox[{"First", "[", "timeshere", "]"}]}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"timeshere", " ", "=", " ", 
              RowBox[{"Rest", "[", "timeshere", "]"}]}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ToString", "[", "label", "]"}], "\[NotEqual]", " ", 
                "\"\<None\>\""}], ",", " ", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"framelabel", " ", "=", " ", "label"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{"showtime", ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"framelabel", " ", "=", " ", 
                    RowBox[{"framelabel", " ", "<>", "\"\< (\>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"InputForm", "[", 
                    RowBox[{"1.0", "*", "time"}], "]"}], "]"}], "<>", 
                    "\"\<)\>\""}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                ";"}]}], " ", "\[IndentingNewLine]", "]"}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{"none", ",", "\[IndentingNewLine]", 
               RowBox[{"pix", "=", 
                RowBox[{"SimShow", "[", 
                 RowBox[{"S", ",", "time", ",", "T", ",", "opt", ",", 
                  RowBox[{"PlotRange", "\[Rule]", " ", "autoscale"}], ",", 
                  " ", 
                  RowBox[{"PlotLabel", "\[Rule]", " ", "framelabel"}]}], 
                 "]"}]}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
               RowBox[{"pix", "=", 
                RowBox[{"SimShow", "[", 
                 RowBox[{
                 "S", ",", "variable", ",", "time", ",", "T", ",", "colors", 
                  ",", "values", ",", "opt", ",", 
                  RowBox[{"PlotRange", "\[Rule]", " ", "autoscale"}], ",", 
                  " ", 
                  RowBox[{"PlotLabel", "\[Rule]", " ", "framelabel"}]}], 
                 "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", " ", 
             "\[IndentingNewLine]", "\n", "\[IndentingNewLine]", 
             RowBox[{"pixfile", " ", "=", " ", 
              RowBox[{"ToFileName", "[", 
               RowBox[{"dmovie", ",", 
                RowBox[{"\"\<FRAME\>\"", "<>", 
                 RowBox[{"IntegerString", "[", 
                  RowBox[{"iframe", ",", "10", ",", "4"}], "]"}], "<>", 
                 "imagetype"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"Export", "[", 
              RowBox[{"pixfile", ",", "pix", ",", 
               RowBox[{"ImageSize", "\[Rule]", " ", 
                RowBox[{"{", 
                 RowBox[{"isize", ",", "isize"}], "}"}]}]}], "]"}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"iframe", " ", "=", " ", 
              RowBox[{"iframe", "+", "1"}]}], ";"}]}], " ", 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"SetDirectory", "[", "dmovie", "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"themovie", " ", "=", " ", 
        RowBox[{"\"\<Movie\>\"", "<>", "type"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"runstring", "=", 
        RowBox[{
        "\"\<ffmpeg -r \>\"", "<>", "rate", "<>", "\"\< -i 'FRAME%4d\>\"", "<>",
          "imagetype", "<>", "\"\<' '\>\"", "<>", "themovie", "<>", 
         "\"\<'\>\""}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "runstring", "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"error", "=", 
        RowBox[{"Run", "[", "runstring", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"error", "\[NotEqual]", " ", "0"}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<ERROR: ffmpeg return code is: \>\"", ",", " ", "error"}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<On some versions of Mathematica, the Kernel is unable to \
locate the correct path execute ffmpeg. You must do this manually:\\n\\nIn a \
command shell such as bash, terminal, or cmd, change your current working \
directory to (e.g., with the cd command):\\n\>\"", " ", ",", "dmovie", ",", 
            "\"\<\\nThe type the following:\\n\>\"", ",", "runstring", ",", 
            "\"\<\\nThis should create a movie file \>\"", ",", 
            RowBox[{"ToFileName", "[", 
             RowBox[{"dmovie", ",", "themovie"}], "]"}]}], 
           "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
       ";", " ", "\[IndentingNewLine]", 
       RowBox[{"TheMovieFile", "=", 
        RowBox[{"FileNames", "[", 
         RowBox[{"ToFileName", "[", 
          RowBox[{"dmovie", ",", "themovie"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"SetDirectory", "[", "cwd", "]"}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"Return", "[", "TheMovieFile", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5477531698160543`*^9, 3.547753229796282*^9}, {
   3.547753328733736*^9, 3.547753330180601*^9}, 3.547753587088229*^9, {
   3.547753634931664*^9, 3.547753686199608*^9}, 3.547753790511518*^9, 
   3.547753888833336*^9, {3.5477540061369267`*^9, 3.547754027052964*^9}, {
   3.547754172601039*^9, 3.547754173864575*^9}, {3.547754215105317*^9, 
   3.5477542165682793`*^9}, {3.547754259992983*^9, 3.54775449102068*^9}, {
   3.547754584868621*^9, 3.547754939878971*^9}, {3.5477549853527*^9, 
   3.547755011472776*^9}, {3.547755086890088*^9, 3.547755121375937*^9}, {
   3.5477559573659067`*^9, 3.547756098804797*^9}, {3.5477561512150307`*^9, 
   3.547756212873509*^9}, {3.5477562438963003`*^9, 3.547756253738846*^9}, {
   3.547756984685771*^9, 3.5477572432591352`*^9}, {3.547757294149447*^9, 
   3.547757354209609*^9}, {3.54775755503302*^9, 3.547757686759404*^9}, {
   3.547757719859888*^9, 3.5477577989615107`*^9}, {3.5477578549762506`*^9, 
   3.547757905667201*^9}, {3.547757996690753*^9, 3.547757998371538*^9}, {
   3.547758162652384*^9, 3.5477582605091763`*^9}, {3.547758301683189*^9, 
   3.547758341670216*^9}, {3.547758536705174*^9, 3.547758620166934*^9}, {
   3.5477586583088427`*^9, 3.547758744332045*^9}, {3.547758783884454*^9, 
   3.547758889327382*^9}, {3.54775892387429*^9, 3.547758925255196*^9}, {
   3.5477589598469887`*^9, 3.5477589776094913`*^9}, {3.547759051638834*^9, 
   3.547759065423601*^9}, {3.547759107848626*^9, 3.547759118850274*^9}, {
   3.547759170123591*^9, 3.5477592430408*^9}, {3.5477593780399723`*^9, 
   3.547759453228355*^9}, {3.547759576143564*^9, 3.5477596132801847`*^9}, {
   3.547759657405361*^9, 3.547759737501334*^9}, {3.5477598251418667`*^9, 
   3.547760139680416*^9}, {3.547760205989085*^9, 3.547760213981234*^9}, {
   3.547760279585258*^9, 3.5477603067925367`*^9}, {3.547760500877603*^9, 
   3.547760501867032*^9}, {3.54776242566251*^9, 3.547762519133149*^9}, {
   3.5477625532775393`*^9, 3.547762635282276*^9}, {3.547762712870137*^9, 
   3.547762736136998*^9}, {3.547762787469983*^9, 3.5477629047229023`*^9}, {
   3.5477629402686653`*^9, 3.5477629692375603`*^9}, {3.547763044189412*^9, 
   3.5477630492871437`*^9}, {3.547763259802381*^9, 3.547763278542631*^9}, {
   3.547763395375918*^9, 3.547763400414771*^9}, {3.547763485991078*^9, 
   3.5477634949638968`*^9}, 3.5477635253592987`*^9, 3.5477639341534224`*^9, {
   3.5477639698247337`*^9, 3.5477639810857153`*^9}, {3.547764186579762*^9, 
   3.5477641895699177`*^9}, {3.547764319107685*^9, 3.5477644371818743`*^9}, {
   3.547764502877824*^9, 3.547764812399645*^9}, {3.547767541366242*^9, 
   3.547767626148007*^9}, {3.5477680727761307`*^9, 3.547768088267494*^9}, {
   3.5477687498160667`*^9, 3.547768752237915*^9}, {3.547905797203966*^9, 
   3.547905890264525*^9}, {3.547906029926319*^9, 3.547906037775096*^9}, {
   3.5479061282498503`*^9, 3.547906190619781*^9}, 3.547906274434999*^9, {
   3.547906406508665*^9, 3.547906438957423*^9}, {3.547906472615518*^9, 
   3.547906542763351*^9}, {3.547906665272533*^9, 3.547906665864666*^9}, {
   3.548436073755476*^9, 3.548436145228763*^9}, {3.549479974716234*^9, 
   3.549479975145404*^9}, {3.549480131189032*^9, 3.5494801397187843`*^9}, {
   3.549480212253312*^9, 3.549480235637946*^9}, {3.549480479283834*^9, 
   3.549480484656958*^9}, {3.549480663287445*^9, 3.549480663422618*^9}, {
   3.549480773950436*^9, 3.549480774638927*^9}, {3.556663969473428*^9, 
   3.556664008775008*^9}, {3.5567304071650476`*^9, 3.5567304219812317`*^9}, {
   3.55673045715371*^9, 3.556730478189983*^9}, 3.556730524082334*^9, {
   3.556730628042289*^9, 3.5567306429580297`*^9}, {3.556730886130939*^9, 
   3.5567308902786007`*^9}, 3.556730973032946*^9, {3.556731255465042*^9, 
   3.55673127321698*^9}, {3.556731354711203*^9, 3.5567313716344423`*^9}, {
   3.5567314158334923`*^9, 3.5567314745572166`*^9}, {3.556731523541204*^9, 
   3.556731529349128*^9}, {3.556731610301661*^9, 3.556731613598094*^9}, {
   3.556744303092156*^9, 3.556744355164888*^9}, {3.556744386857567*^9, 
   3.556744473535226*^9}, {3.5567446340239353`*^9, 3.556744635807032*^9}, {
   3.556744711009431*^9, 3.556744716029605*^9}, {3.5567447641889257`*^9, 
   3.556744765299499*^9}, {3.556744847031495*^9, 3.55674485124517*^9}, {
   3.556744912334176*^9, 3.556745135935693*^9}, 3.566487157487215*^9, {
   3.572089553931273*^9, 3.572089565615218*^9}, {3.5746181858348627`*^9, 
   3.574618362340519*^9}, {3.574618399823742*^9, 3.5746184328524857`*^9}, {
   3.574618478732679*^9, 3.574618500900178*^9}, {3.574618626020617*^9, 
   3.5746186314460278`*^9}, {3.574618668954421*^9, 3.57461869040905*^9}, {
   3.574618730901084*^9, 3.574618793566656*^9}, {3.574619731738846*^9, 
   3.574619735944405*^9}, {3.57461978182448*^9, 3.5746198104483213`*^9}, {
   3.574619881753807*^9, 3.574619882378551*^9}, {3.5746199429610233`*^9, 
   3.574619961737365*^9}, {3.575843500689911*^9, 3.5758435055882196`*^9}, {
   3.576682173705904*^9, 3.576682201735366*^9}, {3.576682287198181*^9, 
   3.576682303399893*^9}, {3.5766823433657103`*^9, 3.5766823661142387`*^9}, {
   3.576682438579566*^9, 3.576682441109869*^9}, {3.70611353303897*^9, 
   3.7061135783002157`*^9}},ExpressionUUID->"001bda4e-1d69-4361-a3c3-\
1ba637a509fc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SimAnimate", "[", 
     RowBox[{"sim_", ",", " ", "variable_", ",", " ", "template_", ",", " ", 
      RowBox[{"{", 
       RowBox[{"tstart_", ",", " ", "tend_", ",", " ", "tdelta_"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"minColor_", ",", " ", "maxColor_"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"minVal_", ",", " ", "maxVal_"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"xmin_", ",", " ", "xmax_"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"ymin_", ",", " ", "ymax_"}], "}"}], ",", " ", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "s", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"RGBErr", "=", "0"}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"s", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"SimShow", "[", 
           RowBox[{
           "sim", ",", " ", "variable", ",", " ", "#", ",", " ", "template", 
            ",", " ", 
            RowBox[{"{", 
             RowBox[{"minColor", ",", " ", "maxColor"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"minVal", ",", " ", "maxVal"}], "}"}], ",", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"xmin", ",", " ", "xmax"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"ymin", ",", " ", "ymax"}], "}"}], ",", " ", "opt", ",", 
            " ", 
            RowBox[{"\"\<CellNumbers\>\"", "\[Rule]", " ", "False"}], ",", 
            " ", 
            RowBox[{"\"\<BoundaryStyle\>\"", "\[Rule]", " ", 
             RowBox[{"{", 
              RowBox[{"Thin", ",", " ", "Black"}], "}"}]}]}], "]"}], "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"tstart", ",", " ", "tend", ",", " ", "tdelta"}], "]"}]}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "s", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SimAnimate", "[", 
     RowBox[{"sim_", ",", " ", "variable_", ",", " ", "template_", ",", " ", 
      RowBox[{"{", 
       RowBox[{"tstart_", ",", " ", "tend_", ",", " ", "tdelta_"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"minColor_", ",", " ", "maxColor_"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"minVal_", ",", " ", "maxVal_"}], "}"}], ",", "  ", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
    RowBox[{"SimAnimate", "[", 
     RowBox[{"sim", ",", " ", "variable", ",", " ", "template", ",", " ", 
      RowBox[{"{", 
       RowBox[{"tstart", ",", " ", "tend", ",", " ", "tdelta"}], "}"}], ",", 
      " ", 
      RowBox[{"{", 
       RowBox[{"minColor", ",", " ", "maxColor"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"minVal", ",", " ", "maxVal"}], "}"}], ",", " ", 
      RowBox[{"Sequence", "@@", 
       RowBox[{"AutoScaleTemplate", "[", "template", "]"}]}], ",", " ", 
      "opt"}], "]"}]}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SimAnimate", "[", 
     RowBox[{"sim_", ",", " ", "variable_", ",", " ", "template_", ",", " ", 
      RowBox[{"{", 
       RowBox[{"tstart_", ",", " ", "tend_", ",", " ", "tdelta_"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"minColor_", ",", " ", "maxColor_"}], "}"}], ",", "   ", 
      RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"minVal", ",", " ", "maxVal"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"minVal", ",", " ", "maxVal"}], "}"}], "=", 
        RowBox[{"SimRange", "[", 
         RowBox[{"sim", ",", " ", "variable", ",", " ", 
          RowBox[{"{", 
           RowBox[{"tstart", ",", " ", "tend", ",", " ", "tdelta"}], "}"}]}], 
         "]"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"SimAnimate", "[", 
        RowBox[{"sim", ",", " ", "variable", ",", " ", "template", ",", " ", 
         RowBox[{"{", 
          RowBox[{"tstart", ",", " ", "tend", ",", " ", "tdelta"}], "}"}], 
         ",", " ", 
         RowBox[{"{", 
          RowBox[{"minColor", ",", " ", "maxColor"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"minVal", ",", " ", "maxVal"}], "}"}], ",", " ", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"AutoScaleTemplate", "[", "template", "]"}]}], ",", " ", 
         "opt"}], "]"}]}]}], "]"}]}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SimAnimate", "[", "u___", "]"}], ":=", 
   RowBox[{
   "Print", "[", 
    "\"\<Expecting one of the following:\\n\nSimAnimate[var, options]\\n\n\
SimAnimate[var, directory, options]\\n\nSimAnimate[sim, var, template, \
{t,start,delta}, {colormin,colormax},options] \\n\nSimAnimate[sim, var, \
template, {t,start,delta}, {colormin,colormax}, {PlotMin,PlotMax},options]\\n\
\nSimAnimate[sim, var, template, {t,start,delta}, {colormin,colormax}, \
{PlotMin,PlotMax}, {xmin, xmax}, {ymin, ymax} options]\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.452878417458704*^9, 3.4528784195843763`*^9}, {
   3.45287845425346*^9, 3.4528786565172977`*^9}, {3.452878744548737*^9, 
   3.4528787589148903`*^9}, {3.452879324720245*^9, 3.452879430705357*^9}, {
   3.452879512875032*^9, 3.452879521548798*^9}, {3.452879603582974*^9, 
   3.452879642710951*^9}, 3.453485088961165*^9, {3.4574544605679073`*^9, 
   3.457454515884303*^9}, {3.457454582879464*^9, 3.4574545837282887`*^9}, {
   3.706113629136877*^9, 3.706113733438533*^9}, {3.706113777193409*^9, 
   3.706113887579914*^9}, {3.706113919922813*^9, 
   3.706113956107806*^9}},ExpressionUUID->"a7b9dd70-f8e5-4d0f-8ad2-\
9914ecc4fbe6"]
}, Closed]],

Cell[CellGroupData[{

Cell["GetSimulationPoints,GetSimulationTissuePoints", "Subsection",
 CellChangeTimes->{{3.556744057405326*^9, 3.5567440600845203`*^9}, {
  3.566487918594783*^9, 
  3.566487923042592*^9}},ExpressionUUID->"d3d8debf-dcfd-4f7a-ab6b-\
14860d104169"],

Cell["\<\
\[OpenCurlyDoubleQuote]Frames\[CloseCurlyDoubleQuote] or \
\[OpenCurlyDoubleQuote]Points\[CloseCurlyDoubleQuote] may be used to specify \
the number of points 
\[OpenCurlyDoubleQuote]PlotTimes\[CloseCurlyDoubleQuote] specifies the range \
of times (or all times are used)\
\>", "Text",
 CellChangeTimes->{{3.5567497203589077`*^9, 3.556749729285924*^9}, {
  3.558186815504675*^9, 
  3.558186826383417*^9}},ExpressionUUID->"c6b98b64-40d8-438b-bc66-\
659bc9bcade4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetSimulationPoints", "[", 
     RowBox[{"opt___", "?", "OptionQ"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "d", "}"}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"d", "=", 
        RowBox[{"SystemDialogInput", "[", 
         RowBox[{"\"\<Directory\>\"", ",", 
          RowBox[{"ToFileName", "[", 
           RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ",", 
          RowBox[{
          "WindowTitle", "\[Rule]", 
           "\"\<Please select the folder that contains DTissue*.nb, \
Solution*.nb,etc.):\>\""}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SameQ", "[", 
          RowBox[{"d", ",", "$Canceled"}], "]"}], ",", " ", 
         RowBox[{"Return", "[", "$Canceled", "]"}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"GetSimulationPoints", "[", 
        RowBox[{"d", ",", " ", "opt"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], " "}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.574520394134873*^9, 3.5745204606943903`*^9}, {
  3.574520495174644*^9, 3.574520498427649*^9}, {3.577544042570119*^9, 
  3.577544045812311*^9}},ExpressionUUID->"a7600502-3bf7-4f65-9128-\
8fea8d71d294"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GetSimulationPoints", "[", 
    RowBox[{"d_", ",", " ", 
     RowBox[{"opt___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "GetTimeDomainFromFile", ",", " ", "TFiles", ",", "nT", ",", "SFiles", 
       ",", "nS", ",", "n", ",", " ", "TSFile", ",", "i", ",", "dt", ",", 
       "timespans", ",", "nTimespans", ",", "plottimes", ",", " ", "tstart", 
       ",", "tend", ",", "frames", ",", " ", "interval", ",", "tstarts", ",", 
       "times", ",", "whichtime", ",", "needed", ",", "j", ",", "jnext", ",", 
       "timespan", ",", "timeshere", ",", " ", "dbg", ",", " ", "dPrint"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dbg", " ", "=", " ", 
       RowBox[{
        RowBox[{"\"\<Debug\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Debug\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dPrint", "[", "x___", "]"}], ":=", " ", 
       RowBox[{"If", "[", 
        RowBox[{"dbg", ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<GetSimulationPoints: \>\"", ",", " ", "x"}], "]"}]}], 
        "]"}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"GetTimeDomainFromFile", "[", "f_", "]"}], ":=", 
       RowBox[{"CommonTimeDomain", "[", 
        RowBox[{"Get", "[", "f", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"d", "=", 
         RowBox[{"SystemDialogInput", "[", 
          RowBox[{"\"\<Directory\>\"", ",", 
           RowBox[{"ToFileName", "[", 
            RowBox[{"HomeDirectory", "[", "]"}], "]"}], ",", 
           RowBox[{
           "WindowTitle", "\[Rule]", 
            "\"\<Please select the folder that contains DTissue*.nb, \
Solution*.nb,etc.):\>\""}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"d", ",", "$Canceled"}], "]"}], ",", " ", 
          RowBox[{"Return", "[", "$Canceled", "]"}]}], "]"}], ";"}], " ", 
       "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"TFiles", "=", 
       RowBox[{"FileNames", "[", 
        RowBox[{"ToFileName", "[", 
         RowBox[{"d", ",", "\"\<DTissue*.nb\>\""}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nT", "=", 
       RowBox[{"Length", "[", "TFiles", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"SFiles", "=", 
       RowBox[{"FileNames", "[", 
        RowBox[{"ToFileName", "[", 
         RowBox[{"d", ",", "\"\<Solution*.nb\>\""}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nS", "=", 
       RowBox[{"Length", "[", "SFiles", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"nS", "\[Equal]", "0"}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SFiles", "=", 
          RowBox[{"FileNames", "[", 
           RowBox[{"ToFileName", "[", 
            RowBox[{"d", ",", "\"\<Solution*.mx\>\""}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"nS", "=", 
          RowBox[{"Length", "[", "SFiles", "]"}]}]}]}], "\[IndentingNewLine]",
        "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"nT", "\[Equal]", "0"}], ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<No Tissues found in \>\"", "<>", "d"}], "]"}], ";", 
         RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"nS", "\[Equal]", "0"}], ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<No Simulation results found in \>\"", "<>", "d"}], 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"Min", "[", 
        RowBox[{"{", 
         RowBox[{"nT", ",", "nS"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"n", "<", "1"}], ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Insufficient data found in \>\"", "<>", "d", "<>", 
           "\"\< to generate an animation.\>\""}], "]"}], ";", 
         RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"TSFile", "=", 
       RowBox[{"FileNames", "[", 
        RowBox[{"ToFileName", "[", 
         RowBox[{"d", ",", "\"\<TimeSpans.nb\>\""}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "TSFile", "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"TSFile", "=", 
          RowBox[{"First", "[", "TSFile", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"dPrint", "[", 
          RowBox[{"\"\<Reading TSFile \>\"", ",", "TSFile"}], "]"}], ";", " ",
          "\[IndentingNewLine]", 
         RowBox[{"timespans", "=", 
          RowBox[{"Get", "[", "TSFile", "]"}]}], ";"}], "\[IndentingNewLine]",
         ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<File \>\"", "<>", 
           RowBox[{"ToFileName", "[", 
            RowBox[{"d", ",", "\"\<TimeSpans.nb\>\""}], "]"}], "<>", 
           "\"\< not found. Attempting to determine timespans manually. This \
could take a while ... \>\""}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"timespans", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "1"}], ",", 
           RowBox[{"i", "\[LessEqual]", "n"}], ",", 
           RowBox[{"i", "=", 
            RowBox[{"i", "+", "1"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"dt", "=", 
             RowBox[{"GetTimeDomainFromFile", "[", 
              RowBox[{"SFiles", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"timespans", ",", "dt"}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<timespans: \>\"", ",", " ", "timespans"}], "]"}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{"nTimespans", "=", 
       RowBox[{"Length", "[", "timespans", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"nTimespans", ">", "n"}], ",", 
        RowBox[{"timespans", "=", 
         RowBox[{"Take", "[", 
          RowBox[{"timespans", ",", "n"}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"nTimespans", "<", "n"}], ",", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<Not enough timespans listed in timespan file; recovering by \
using only the data files that are listed.\>\"", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"n", "=", "nTimespans"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"plottimes", "=", 
       RowBox[{
        RowBox[{"\"\<PlotTimes\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<PlotTimes\>\"", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"First", "[", "timespans", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"Last", "[", "timespans", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<plottimes: \>\"", ",", " ", "plottimes"}], "]"}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tstart", ",", "tend"}], "}"}], "=", "plottimes"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"frames", "=", 
       RowBox[{
        RowBox[{"\"\<Frames\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Frames\>\"", "\[Rule]", "101"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"frames", "=", 
       RowBox[{
        RowBox[{"\"\<Frames\>\"", "/.", 
         RowBox[{"{", "opt", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"\"\<Frames\>\"", "\[Rule]", " ", "Indeterminate"}], 
         "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{"frames", ",", "Indeterminate"}], "]"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"frames", " ", "=", 
          RowBox[{
           RowBox[{"\"\<Points\>\"", "/.", 
            RowBox[{"{", "opt", "}"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{"\"\<Points\>\"", "\[Rule]", " ", "101"}], "}"}]}]}], 
         ";"}]}], " ", "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"interval", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"tend", "-", "tstart"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"frames", "-", "1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"tstarts", "=", 
       RowBox[{"First", "/@", "timespans"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"times", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"tstart", "+", 
          RowBox[{"i", "*", "interval"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", "frames"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whichtime", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Floor", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#", "-", "tstart"}], ")"}], "/", "interval"}], "]"}], 
           "+", "1"}], ")"}], "&"}], "/@", 
        RowBox[{"Append", "[", 
         RowBox[{"tstarts", ",", "tend"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"needed", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", "nTimespans"}], ",", 
        RowBox[{"i", "=", 
         RowBox[{"i", "+", "1"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"j", "=", 
          RowBox[{"whichtime", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"jnext", "=", 
          RowBox[{"whichtime", "[", 
           RowBox[{"[", 
            RowBox[{"i", "+", "1"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"jnext", "<", "1"}], ",", 
           RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"j", "=", 
          RowBox[{"Max", "[", 
           RowBox[{"j", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"j", ">", 
            RowBox[{"Length", "[", "times", "]"}]}], ",", 
           RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"jnext", " ", "=", " ", 
          RowBox[{"Min", "[", 
           RowBox[{"jnext", ",", 
            RowBox[{"Length", "[", "times", "]"}]}], "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"jnext", " ", "<", "j"}], ",", " ", 
           RowBox[{"Break", "[", "]"}]}], "]"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"timespan", "=", 
          RowBox[{"timespans", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"timeshere", "=", 
          RowBox[{"Take", "[", 
           RowBox[{"times", ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "jnext"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"timeshere", "=", 
          RowBox[{"Select", "[", 
           RowBox[{"timeshere", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"timespan", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", "#"}], 
                ")"}], "\[And]", 
               RowBox[{"(", 
                RowBox[{"#", "\[LessEqual]", 
                 RowBox[{"timespan", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], ")"}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "timeshere", "]"}], ">", "0"}], ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"needed", ",", 
             RowBox[{"i", "\[Rule]", "timeshere"}]}], "]"}]}], "]"}], ";"}]}],
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", "\"\<Exiting\>\"", "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<folder\>\"", "\[Rule]", " ", "d"}], ",", " ", 
        RowBox[{"\"\<needed\>\"", "\[Rule]", " ", "needed"}], ",", 
        RowBox[{"\"\<Tissues\>\"", "\[Rule]", " ", "TFiles"}], ",", 
        RowBox[{"\"\<Solutions\>\"", "\[Rule]", " ", "SFiles"}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5567430037965097`*^9, 3.5567430037973213`*^9}, {
   3.5567434187003937`*^9, 3.5567434442963552`*^9}, {3.55674349742939*^9, 
   3.556743661372993*^9}, {3.556743712443671*^9, 3.556743896378182*^9}, {
   3.556743991512104*^9, 3.556744019327076*^9}, {3.556744068206658*^9, 
   3.5567441468679943`*^9}, {3.556744199444216*^9, 3.556744217347846*^9}, 
   3.556744270617096*^9, {3.556744685155695*^9, 3.556744690041368*^9}, {
   3.556747372329619*^9, 3.556747442465928*^9}, {3.556749501766365*^9, 
   3.556749511279437*^9}, {3.556749577907564*^9, 3.5567495815756063`*^9}, {
   3.556750366383161*^9, 3.5567504255833693`*^9}, {3.559992513393812*^9, 
   3.5599926418437643`*^9}, {3.5599926795753613`*^9, 3.5599927340767117`*^9}, 
   3.566487170880437*^9, {3.5716905124510813`*^9, 3.5716905378376007`*^9}, {
   3.574520466318686*^9, 3.574520501589889*^9}, {3.5766801915694103`*^9, 
   3.5766802211481457`*^9}},ExpressionUUID->"4e2086de-4fcc-4222-8bbc-\
fb7e4e5858ac"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetSimulationTissuePoints", "[", 
   RowBox[{"opt___", "?", "OptionQ"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "stuff", ",", "f", ",", "which", ",", "tissues", ",", "indices", ",", 
      "times", ",", "solutions"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"stuff", "=", 
      RowBox[{"GetSimulationPoints", "[", "opt", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"f", "=", 
      RowBox[{"\"\<folder\>\"", "/.", "stuff"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"which", "=", 
      RowBox[{"\"\<needed\>\"", "/.", "stuff"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"indices", "=", 
      RowBox[{"First", "/@", "which"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"times", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Last", "/@", "which"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tissues", "=", 
      RowBox[{"\"\<Tissues\>\"", "/.", "stuff"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tissues", "=", 
      RowBox[{"tissues", "[", 
       RowBox[{"[", "indices", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"solutions", "=", 
      RowBox[{"\"\<Solutions\>\"", "/.", "stuff"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"solutions", "=", 
      RowBox[{"solutions", "[", 
       RowBox[{"[", "indices", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<folder\>\"", "\[Rule]", " ", "f"}], ",", 
       RowBox[{"\"\<indices\>\"", "\[Rule]", " ", "indices"}], ",", " ", 
       RowBox[{"\"\<times\>\"", "\[Rule]", " ", "times"}], ",", 
       RowBox[{"\"\<Tissues\>\"", "\[Rule]", " ", "tissues"}], ",", " ", 
       RowBox[{"\"\<Solutions\>\"", "\[Rule]", " ", "solutions"}]}], 
      "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.566487427703492*^9, 3.566487653504613*^9}, {
  3.566487714553347*^9, 3.5664877229594193`*^9}, {3.566488023005128*^9, 
  3.566488037760672*^9}},ExpressionUUID->"546a4e8c-1cc5-475d-983d-\
a603a7818aa3"]
}, Closed]],

Cell[CellGroupData[{

Cell["AutoScaleTemplate", "Subsection",
 CellChangeTimes->{{3.457454023470634*^9, 
  3.457454027309876*^9}},ExpressionUUID->"74f63b32-4e15-4bc9-8b58-\
ea4d49be6dae"],

Cell["fix 3.0.0 to remove infninty", "Text",
 CellChangeTimes->{{3.561813886335328*^9, 
  3.561813892495064*^9}},ExpressionUUID->"e4016f36-a532-4cd5-98ec-\
55ff70c37d2a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AutoScaleTemplate", "[", 
   RowBox[{"DT_DTissue", ",", " ", "x___"}], "]"}], ":=", " ", 
  RowBox[{"AutoScaleTemplate", "[", 
   RowBox[{
    RowBox[{"DTissue2Tissue", "[", "DT", "]"}], ",", "x"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AutoScaleTemplate", "[", 
   RowBox[{
    RowBox[{"template_", "?", "TissueQ"}], ",", " ", 
    RowBox[{"xpad_:", "10"}], ",", " ", 
    RowBox[{"ypad_:", "10"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "v", ",", " ", "x", ",", "y", ",", " ", "xmin", ",", " ", "xmax", ",", 
      " ", "ymin", ",", " ", "ymax", ",", " ", "width", ",", " ", "height", 
      ",", " ", "dx", ",", " ", "dl", ",", " ", "dy"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"v", "=", 
      RowBox[{"TissueVertices", "[", "template", "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}], "=", 
      RowBox[{"Transpose", "[", "v", "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"x", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{"x", ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}]}], 
       "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"y", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{"y", ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "\[Infinity]"}], ",", " ", "\[Infinity]"}], "}"}]}], 
       "]"}]}], ";", "  ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"xmin", ",", " ", "xmax"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Min", "[", "x", "]"}], ",", " ", 
        RowBox[{"Max", "[", "x", "]"}]}], "}"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ymin", ",", " ", "ymax"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Min", "[", "y", "]"}], ",", " ", 
        RowBox[{"Max", "[", "y", "]"}]}], "}"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"width", " ", "=", " ", 
      RowBox[{"xmax", "-", "xmin"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"height", " ", "=", " ", 
      RowBox[{"ymax", "-", "ymin"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"dx", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"xpad", "/", "100.0"}], ")"}], "*", "width"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"dy", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"ypad", "/", "100.0"}], ")"}], "*", "height"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"xmin", " ", "=", " ", 
      RowBox[{"xmin", " ", "-", " ", "dx"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"xmax", " ", "=", " ", 
      RowBox[{"xmax", " ", "+", " ", "dx"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"ymin", " ", "=", " ", 
      RowBox[{"ymin", "  ", "-", " ", "dy"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"ymax", " ", "=", " ", 
      RowBox[{"ymax", " ", "+", " ", "dy"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"xmin", ",", " ", "xmax"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"ymin", ",", " ", "ymax"}], "}"}]}], "}"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.452878911160081*^9, 3.452879240187145*^9}, {
   3.56181381519623*^9, 3.561813862994409*^9}, {3.574521060911285*^9, 
   3.574521108247149*^9}, {3.574521310158224*^9, 3.574521337557927*^9}, 
   3.5745213755484667`*^9},ExpressionUUID->"6cd05267-8847-4c3e-9dfe-\
889bb04f66e1"]
}, Closed]],

Cell[CellGroupData[{

Cell["SaveMovie (Save Frames), ToAVI, ToMOV", "Subsection",
 CellChangeTimes->{{3.4531487091108847`*^9, 3.453148726982319*^9}, {
  3.4531493723086433`*^9, 
  3.453149384884272*^9}},ExpressionUUID->"ad49cc86-019c-4573-aaab-\
800556ab8782"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SaveFrames", "[", 
     RowBox[{
      RowBox[{"pictures_", "?", "ListQ"}], ",", "type_", ",", " ", "size_", 
      ",", " ", 
      RowBox[{"movieType_:", "\"\<.avi\>\""}], ",", "  ", 
      RowBox[{"label_:", "\"\<MovieData-\>\""}], ",", " ", 
      RowBox[{"framerate_:", "16"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "dir", ",", "cwd", ",", " ", "labl", ",", "frnames", ",", " ", 
        "moviedir", ",", "framedir", ",", "  ", "moviefile", ",", " ", 
        "runstring", ",", "typ", ",", "error", ",", " ", "FrameName", ",", 
        " ", "FrameNames", ",", " ", "dotavi", ",", " ", "today", ",", " ", 
        "$TEMP", ",", " ", "rate", ",", "CellzillaHome"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CellzillaHome", "=", 
        RowBox[{"CreateHomeFolder", "[", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"$TEMP", " ", "=", " ", 
        RowBox[{"createTodaysFolder", "[", 
         RowBox[{"ToFileName", "[", 
          RowBox[{"CellzillaHome", ",", "\"\<Simulations-\>\""}], "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
       RowBox[{"(*", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"today", "=", 
          RowBox[{"DateString", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Day\>\"", ",", "\"\<-\>\"", ",", "\"\<MonthNameShort\>\"", 
             ",", "\"\<-\>\"", ",", "\"\<YearShort\>\""}], "}"}], "]"}]}], 
         ";", " ", "\[IndentingNewLine]", 
         RowBox[{"$TEMP", "=", 
          RowBox[{"ToFileName", "[", 
           RowBox[{"$HomeDirectory", ",", " ", 
            RowBox[{"\"\<Simulations-\>\"", "<>", "today"}]}], "]"}]}], ";"}],
         "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"dotavi", " ", "=", " ", "movieType"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"StringTake", "[", 
           RowBox[{"dotavi", ",", " ", "1"}], "]"}], "\[NotEqual]", " ", 
          "\"\<.\>\""}], ",", " ", 
         RowBox[{"dotavi", " ", "=", " ", 
          RowBox[{"\"\<.\>\"", "<>", "dotavi"}]}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"FrameName", "[", 
         RowBox[{"x_", ",", " ", 
          RowBox[{"type1_:", "\"\<EPS\>\""}]}], "]"}], ":=", " ", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"y", ",", " ", "ty"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ty", " ", "=", " ", 
            RowBox[{"ToString", "[", "type1", "]"}]}], ";", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{"ty", ",", " ", 
                RowBox[{"{", 
                 RowBox[{"1", ",", " ", "1"}], "}"}]}], "]"}], "\[NotEqual]", 
              " ", "\"\<.\>\""}], ",", " ", 
             RowBox[{"ty", "=", 
              RowBox[{"\"\<.\>\"", "<>", "ty"}]}]}], "]"}], ";", "  ", 
           "\[IndentingNewLine]", 
           RowBox[{"y", "=", 
            RowBox[{"ToString", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"StringLength", "[", "y", "]"}], "<", "4"}], ",", " ", 
             RowBox[{"y", "=", 
              RowBox[{"\"\<0\>\"", "<>", "y"}]}]}], "]"}], ";", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"Return", "[", 
            RowBox[{"ToUpperCase", "[", 
             RowBox[{"\"\<Frame\>\"", "<>", "y", "<>", "ty"}], "]"}], 
            "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"FrameNames", "[", 
         RowBox[{"number_", ",", " ", 
          RowBox[{"type1_:", "\"\<EPS\>\""}]}], "]"}], ":=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"FrameName", "[", 
           RowBox[{"#", ",", " ", "type1"}], "]"}], "&"}], "/@", 
         RowBox[{"Range", "[", "number", "]"}]}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"cwd", " ", "=", " ", 
        RowBox[{"Directory", "[", "]"}]}], ";", "  ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"SetDirectory", "[", "$TEMP", "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dir", "=", 
        RowBox[{"createUniqueFolder", "[", 
         RowBox[{"ToFileName", "[", 
          RowBox[{"$TEMP", ",", 
           RowBox[{"ToString", "[", "label", "]"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Created folder: \>\"", ",", " ", "dir"}], "]"}], ";", 
       " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"moviefile", "=", 
        RowBox[{
         RowBox[{"Last", "[", 
          RowBox[{"FileNameSplit", "[", "dir", "]"}], "]"}], "<>", 
         "dotavi"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"moviefile", "=", 
          RowBox[{"ToFileName", "[", 
           RowBox[{"dir", ",", "moviefile"}], "]"}]}], ";"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<movie file will be: \>\"", ",", " ", "moviefile"}], 
        "]"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<movie file will be in the folder: \>\"", ",", " ", "dir"}], 
        "]"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"SetDirectory", "[", "dir", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"framedir", "=", 
        RowBox[{"CreateDirectory", "[", "\"\<Frames\>\"", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Created directory: \>\"", ",", " ", "framedir"}], "]"}], 
       ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"SetDirectory", "[", "framedir", "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<Putting movie frames in  in \>\"", " ", ",", " ", "framedir"}], 
        "]"}], ";", " ", "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"frnames", "=", 
        RowBox[{"FrameNames", "[", 
         RowBox[{
          RowBox[{"Length", "[", "pictures", "]"}], ",", " ", 
          RowBox[{"ToString", "[", "type", "]"}]}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Export", "[", 
           RowBox[{"#1", ",", " ", "#2", ",", " ", 
            RowBox[{"ImageSize", "\[Rule]", " ", 
             RowBox[{"{", 
              RowBox[{"size", ",", "size"}], "}"}]}]}], "]"}], "&"}], ",", 
         " ", 
         RowBox[{"{", 
          RowBox[{"frnames", ",", " ", "pictures"}], "}"}]}], "]"}], ";", " ",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"typ", "=", "type"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"StringTake", "[", 
           RowBox[{"typ", ",", " ", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}]}], "]"}], "\[NotEqual]", " ", 
          "\"\<.\>\""}], ",", " ", 
         RowBox[{"typ", " ", "=", " ", 
          RowBox[{"\"\<.\>\"", "<>", "typ"}]}]}], "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"rate", "=", 
        RowBox[{"ToString", "[", 
         RowBox[{"Round", "[", "framerate", "]"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"runstring", "=", 
        RowBox[{
        "\"\<ffmpeg -r \>\"", "<>", "rate", "<>", "\"\< -i 'FRAME%4d\>\"", "<>",
          "typ", "<>", "\"\<' '\>\"", "<>", "moviefile", "<>", 
         "\"\<'\>\""}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "runstring", "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"error", "=", 
        RowBox[{"Run", "[", "runstring", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"error", "\[NotEqual]", " ", "0"}], ",", " ", 
         "\[IndentingNewLine]", "  ", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<ERROR: Unable to produce movie. ffmpeg return code is: \>\"", 
            ",", " ", "error", ",", 
            "\"\< On some versions of Mathematica (such as the version \
installed on this computer), the Kernel is unable to locate the correct path \
execute ffmpeg. You must do this manually:\\n\\nIn a command shell such as \
bash, terminal, or cmd, change your current working directory to (e.g., with \
the cd command):\\n cd \>\"", " ", ",", "dir", ",", 
            "\"\<\\nThen type the following:\\n\>\"", ",", "runstring", ",", 
            RowBox[{
            "\"\<\\nYou can change the last field to whatever you want the \
movie to actually be called. In this case, it will be called \>\"", "<>", 
             "moviefile", "<>", 
             "\"\< and be in the same folder as all the frames.\>\""}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], " ", "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Created Movie: \>\"", ",", " ", "#"}], "]"}], "&"}], "/@", 
        RowBox[{"FileNames", "[", "moviefile", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"SetDirectory", "[", "cwd", "]"}], ";"}]}], " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}], 
  " "}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.45314892966468*^9, 3.453148947607934*^9}, {
   3.4531491163898897`*^9, 3.4531491844030724`*^9}, {3.489591258411312*^9, 
   3.489591273734118*^9}, {3.4927190403767567`*^9, 3.492719093619687*^9}, {
   3.492723786312525*^9, 3.492723794593281*^9}, {3.494191957594047*^9, 
   3.494191992805647*^9}, {3.576082292190921*^9, 3.5760823494530487`*^9}, {
   3.5760829922627077`*^9, 3.576082995099399*^9}, {3.5925724065592737`*^9, 
   3.592572484839223*^9}, {3.592572531729491*^9, 3.592572617731532*^9}, {
   3.5925728512170057`*^9, 3.5925730875393677`*^9}, {3.5925732123379374`*^9, 
   3.5925733650807953`*^9}, {3.59257365004331*^9, 3.592573847790843*^9}, {
   3.7064563991416492`*^9, 3.7064563994830313`*^9}, {3.7064564643622837`*^9, 
   3.706456499616522*^9}, {3.706456544263665*^9, 3.7064565508689117`*^9}, {
   3.706456719519885*^9, 3.7064567528809023`*^9}, 3.706456975790474*^9, {
   3.706457024860375*^9, 3.7064570467434673`*^9}, {3.706457077786786*^9, 
   3.706457132713822*^9}, {3.706457315686183*^9, 3.706457412923224*^9}, {
   3.7064575182836037`*^9, 
   3.706457519534004*^9}},ExpressionUUID->"7f158c44-b36a-46d0-82f8-\
4745364a567c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ToAVI", "[", 
    RowBox[{
     RowBox[{"pics_", "?", "ListQ"}], ",", 
     RowBox[{"title_:", "\"\<MovieData\>\""}], ",", "  ", 
     RowBox[{"size_:", "400"}], ",", " ", 
     RowBox[{"rate_:", "16"}]}], "]"}], ":=", " ", 
   RowBox[{"SaveFrames", "[", 
    RowBox[{
    "pics", ",", " ", "\"\<JPG\>\"", ",", " ", "size", ",", "\"\<.avi\>\"", 
     ",", " ", "title", ",", " ", "rate"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ToMOV", "[", 
     RowBox[{
      RowBox[{"pics_", "?", "ListQ"}], ",", 
      RowBox[{"title_:", "\"\<MovieData\>\""}], ",", "  ", 
      RowBox[{"size_:", "400"}], ",", " ", 
      RowBox[{"rate_:", "16"}]}], "]"}], ":=", " ", 
    RowBox[{"SaveFrames", "[", 
     RowBox[{
     "pics", ",", " ", "\"\<JPG\>\"", ",", " ", "size", ",", "\"\<.mov\>\"", 
      ",", " ", "title", ",", " ", "rate"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ToAVI", "[", "___", "]"}], ":=", " ", 
    RowBox[{
    "Print", "[", 
     "\"\<Expecting[ToAVI[{picture, picture, ...}, title_:\\\"SomeTextLabel\\\
\", size_:400]\>\"", "]"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ToMOV", "[", "___", "]"}], ":=", " ", 
    RowBox[{
    "Print", "[", 
     "\"\<Expecting[ToMOV[{picture, picture, ...}, title_:\\\"SomeTextLabel\\\
\", size_:400]\>\"", "]"}]}], ";"}], " "}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.453149288723296*^9, 3.453149289147951*^9}, {
  3.453149322404305*^9, 3.4531493564976482`*^9}, {3.492719105709591*^9, 
  3.4927191211387453`*^9}, {3.494192184877049*^9, 
  3.494192188362782*^9}},ExpressionUUID->"d4ef9766-0bb9-4f1b-bda6-\
c73ff3909a06"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["File Input/Output", "Section",
 CellChangeTimes->{{3.517264602022152*^9, 3.5172646084371853`*^9}, {
  3.544268206432239*^9, 
  3.5442682071757393`*^9}},ExpressionUUID->"a672fdb7-e8d1-4863-b51a-\
e832f917f613"],

Cell[CellGroupData[{

Cell["CSVFile", "Subsection",
 CellChangeTimes->{{3.562440390485445*^9, 
  3.5624403917650537`*^9}},ExpressionUUID->"609c8f95-191b-40e6-9b3b-\
ed256520a428"],

Cell["\<\
CSVFile[Tissue, FileName, flat:False]
flat is optional
if flat=True, a flat tissue is written (no edge numbers, cells as sequences \
of vertex numbers)\
\>", "Text",
 CellChangeTimes->{{3.562598989032473*^9, 
  3.562599043449193*^9}},ExpressionUUID->"939581a7-dcf1-4995-9b8b-\
a0dff95d6178"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CSVFile", "[", 
    RowBox[{"w_", "?", "TissueQ"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "nv", ",", "ne", ",", "nf", ",", "nc", ",", "v", ",", " ", "e", ",", 
       " ", "f", ",", " ", "output", ",", 
       RowBox[{"dim", "=", "2"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"v", "=", 
       RowBox[{"TissueVertices", "[", "w", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dim", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"v", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"e", "=", 
       RowBox[{"TissueEdges", "[", "w", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"f", "=", 
       RowBox[{"TissueCells", "[", "w", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nv", "=", 
       RowBox[{"Length", "[", "v", "]"}]}], ";", 
      RowBox[{"ne", "=", 
       RowBox[{"Length", "[", "e", "]"}]}], ";", " ", 
      RowBox[{"nf", "=", 
       RowBox[{"Length", "[", "f", "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"nc", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"output", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"dim", ",", "\"\<dimensions\>\""}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"nv", ",", " ", "\"\<vertices\>\""}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"ne", ",", "\"\<edges\>\""}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"nf", ",", " ", "\"\<faces\>\""}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"output", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"output", ",", 
         RowBox[{"1.0", "*", "v"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"output", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"output", ",", "e"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"output", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"output", ",", "f"}], "]"}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CSVFile", "[", 
    RowBox[{
     RowBox[{"w_", "?", "TissueQ"}], ",", " ", 
     RowBox[{"f_", "?", "StringQ"}], ",", " ", 
     RowBox[{"flat_:", "False"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "r", ",", " ", "fname", ",", "n", ",", "output", ",", "actual"}], "}"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fname", "=", "f"}], ";", "\[IndentingNewLine]", 
      RowBox[{"n", "=", "0"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"r", "=", 
       RowBox[{"FileExistsQ", "[", "fname", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{"r", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"n", " ", "=", " ", 
          RowBox[{"n", "+", "1"}]}], ";", " ", "\[IndentingNewLine]", 
         RowBox[{"fname", " ", "=", "  ", 
          RowBox[{"f", "<>", 
           RowBox[{"ToString", "[", "n", "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"r", "=", 
          RowBox[{"FileExistsQ", "[", "fname", "]"}]}], ";"}]}], " ", 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"flat", ",", " ", "\[IndentingNewLine]", 
        RowBox[{"output", "=", 
         RowBox[{"CSVFlatFile", "[", "w", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"output", "=", 
         RowBox[{"CSVFile", "[", "w", "]"}]}]}], "\[IndentingNewLine]", "]"}],
       ";", " ", "\[IndentingNewLine]", 
      RowBox[{"actual", "=", 
       RowBox[{"Export", "[", 
        RowBox[{"fname", ",", "output", ",", "\"\<CSV\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ExpandFileName", "[", "actual", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CSVFile", "[", "x___", "]"}], ":=", " ", 
   RowBox[{
   "Print", "[", 
    "\"\<Expecting CSVFile[tissue] or CSVFile[tissue,filename]\>\"", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.56244040065027*^9, 3.5624405267992077`*^9}, {
  3.5624406213135233`*^9, 3.562440650464959*^9}, {3.562440689363501*^9, 
  3.5624407843684893`*^9}, {3.562440854654211*^9, 3.562440911185853*^9}, {
  3.5625989529130373`*^9, 
  3.562598980319357*^9}},ExpressionUUID->"e8b84e49-6269-4c3b-a733-\
66c73de58b10"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CSVFlatFile", "[", 
     RowBox[{"w_", "?", "TissueQ"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "nv", ",", "nf", ",", "nc", ",", "v", ",", "  ", "f", ",", " ", 
        "output", ",", 
        RowBox[{"dim", "=", "2"}], ",", " ", "cvn"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"v", "=", 
        RowBox[{"TissueVertices", "[", "w", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"cvn", " ", "=", " ", 
        RowBox[{"CellVertexNumbers", "[", "w", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"dim", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"v", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"f", "=", 
        RowBox[{"TissueCells", "[", "w", "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"nv", "=", 
        RowBox[{"Length", "[", "v", "]"}]}], ";", " ", 
       RowBox[{"nf", "=", 
        RowBox[{"Length", "[", "f", "]"}]}], ";", " ", "\[IndentingNewLine]", 
       
       RowBox[{"nc", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"output", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"dim", ",", "\"\<dimensions\>\""}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"nv", ",", " ", "\"\<vertices\>\""}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"nf", ",", " ", "\"\<faces\>\""}], "}"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"output", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"output", ",", 
          RowBox[{"1.0", "*", "v"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"output", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"output", ",", "cvn"}], "]"}]}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.562598776316451*^9, 3.562598866436985*^9}, 
   3.562598917989272*^9, 
   3.562599585130334*^9},ExpressionUUID->"53d2a7b5-71f3-4b69-b379-\
cb2b2aa6b573"]
}, Closed]],

Cell[CellGroupData[{

Cell["CSVToTissue", "Subsection",
 CellChangeTimes->{{3.562441094760427*^9, 
  3.562441096640314*^9}},ExpressionUUID->"13bb03d3-9c0f-4dd4-a881-\
2d399c6a1aa7"],

Cell["\<\
Expected format: (this is an example of a tissue with a single square cell, \
and the comments starting with # are not allowed)

\t2,dimensions\t\t# the word \[OpenCurlyDoubleQuote]dimensions\
\[CloseCurlyDoubleQuote] must be written out (without the quotation marks)
\t4,vertices\t\t# the word \[OpenCurlyDoubleQuote]vertices\
\[CloseCurlyDoubleQuote] is required
\t4,edges\t\t# the word \[OpenCurlyDoubleQuote]edges\[CloseCurlyDoubleQuote] \
is required <-- If this is omitted,  will look for a flat file
\t1,faces\t\t\t# the word \
\[OpenCurlyDoubleQuote]faces\[CloseCurlyDoubleQuote] is required
\t0.,0.\t\t\t# x,y for first vertex
\t1.,0.
\t0.,1.
\t1.,1.\t\t\t#x,y for last vertex
\t1,2\t\t\t#p,q, for first edge (p, q are vertex numbers)
\t1,3\t\t\t#p,q for second edge
\t2,4
\t3,4
\t1,3,4,2\t\t\t# edges in first cell 
\t..\t\t\t# edges in second cell
\t..\t\t\t# ect\
\>", "Text",
 CellChangeTimes->{{3.562442380735849*^9, 3.562442500998961*^9}, {
  3.5624425540875*^9, 3.562442724997779*^9}, {3.562599167896974*^9, 
  3.5625991861116533`*^9}},ExpressionUUID->"228a11e6-81ff-4776-9318-\
fe303f18ec4e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CSVToTissue", "[", "filename_", "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Q", ",", " ", "lens", ",", " ", "dim", ",", " ", "nv", ",", "ne", ",", 
       "nf", ",", " ", "nlines", ",", " ", "vertices", ",", " ", "edges", ",",
        " ", "vlens", ",", " ", "faces", ",", " ", "vmax", ",", " ", "pvmax", 
       ",", "vmin", ",", " ", "pvmin", ",", " ", "emin", ",", " ", "emax", 
       ",", " ", "pemin", ",", " ", "pemax", ",", " ", "dPrint", ",", " ", 
       RowBox[{"dbg", "=", "False"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"dPrint", "[", "x___", "]"}], ":=", 
       RowBox[{"If", "[", 
        RowBox[{"dbg", ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<CSVToTissue: \>\"", ",", " ", "x"}], "]"}]}], "]"}]}], 
      ";", " ", "\[IndentingNewLine]", 
      RowBox[{"AbortIf", "[", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{"FileExistsQ", "[", "filename", "]"}], "]"}], ",", " ", 
        RowBox[{"\"\<Unable to locate \>\"", "<>", 
         RowBox[{"ToString", "[", "filename", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Q", "=", 
       RowBox[{"Import", "[", "filename", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"lens", " ", "=", " ", 
       RowBox[{"Length", "/@", "Q"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dim", "=", 
       RowBox[{"Q", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AbortIf", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"dim", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "\[NotEqual]", " ", 
         "\"\<dimensions\>\""}], ",", " ", 
        "\"\<The first line of the file is not n,dimensions\>\""}], "]"}], 
      ";", " ", "\[IndentingNewLine]", 
      RowBox[{"dim", " ", "=", " ", 
       RowBox[{"dim", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"nv", "=", 
       RowBox[{"Q", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AbortIf", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"nv", "[", 
          RowBox[{"[", "2", "]"}], "]"}], " ", "\[NotEqual]", " ", 
         "\"\<vertices\>\""}], ",", " ", 
        "\"\<The second line of the file is not nv,vertices\>\""}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"nv", " ", "=", " ", 
       RowBox[{"nv", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"ne", "=", 
       RowBox[{"Q", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ToUpperCase", "[", 
          RowBox[{"ne", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}], "\[Equal]", 
         "\"\<FACES\>\""}], ",", " ", 
        RowBox[{"Return", "[", 
         RowBox[{"FlatCSVToTissue", "[", "filename", "]"}], "]"}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"AbortIf", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ne", "[", 
          RowBox[{"[", "2", "]"}], "]"}], " ", "\[NotEqual]", " ", 
         "\"\<edges\>\""}], ",", " ", 
        "\"\<The third line of the file is not ne,edges\>\""}], "]"}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{"ne", " ", "=", " ", 
       RowBox[{"ne", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"nf", "=", 
       RowBox[{"Q", "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"AbortIf", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"nf", "[", 
          RowBox[{"[", "2", "]"}], "]"}], " ", "\[NotEqual]", " ", 
         "\"\<faces\>\""}], ",", " ", 
        "\"\<The 4th line of the file is not nf,faces\>\""}], "]"}], ";", " ",
       "\[IndentingNewLine]", 
      RowBox[{"nf", " ", "=", " ", 
       RowBox[{"nf", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"nlines", " ", "=", " ", 
       RowBox[{"Length", "[", "lens", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"get", " ", "the", " ", "vertices"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Q", "=", 
       RowBox[{"Drop", "[", 
        RowBox[{"Q", ",", "4"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"AbortIf", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "Q", "]"}], "<", "nv"}], ",", " ", 
        RowBox[{"\"\<Early end to file after \>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"Length", "[", "Q", "]"}], "]"}], "<>", 
         "\"\< vertices, when \>\"", "<>", 
         RowBox[{"ToString", "[", "nv", "]"}], "<>", 
         "\"\< vertices were expected, followed by edges and faces.\>\""}]}], 
       "]"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"vertices", " ", "=", " ", 
       RowBox[{"Take", "[", 
        RowBox[{"Q", ",", "nv"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<vertices=\>\"", ",", " ", "vertices"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vlens", " ", "=", " ", 
       RowBox[{"Union", "[", 
        RowBox[{"Length", "/@", "vertices"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"AbortIf", "[", 
       RowBox[{
        RowBox[{"vlens", " ", "\[NotEqual]", " ", 
         RowBox[{"{", "dim", "}"}]}], ",", " ", 
        RowBox[{"\"\<Some of the vertices do not have dimension \>\"", "<>", 
         RowBox[{"ToString", "[", "dim", "]"}]}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"get", " ", "the", " ", "edges"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Q", "=", 
       RowBox[{"Drop", "[", 
        RowBox[{"Q", ",", "nv"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"AbortIf", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "Q", "]"}], "<", "ne"}], ",", " ", 
        RowBox[{"\"\<Early end to file after \>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"Length", "[", "Q", "]"}], "]"}], "<>", 
         "\"\< edges, when \>\"", "<>", 
         RowBox[{"ToString", "[", "ne", "]"}], "<>", 
         "\"\< edges were expected, followed by faces.\>\""}]}], "]"}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{"edges", "=", 
       RowBox[{"Take", "[", 
        RowBox[{"Q", ",", " ", "ne"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<edges: \>\"", ",", " ", "edges"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "make", " ", "sure", " ", "the", " ", "edges", " ", "only", " ", 
        "refer", " ", "to", " ", "allowed", " ", "vertex", " ", "numbers"}], 
       " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"vmax", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"Flatten", "[", "edges", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pvmax", " ", "=", " ", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"edges", ",", " ", "vmax"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"AbortIf", "[", 
       RowBox[{
        RowBox[{"vmax", ">", "nv"}], ",", " ", 
        RowBox[{"\"\<Edge \>\"", "<>", 
         RowBox[{"ToString", "[", "pvmax", "]"}], "<>", 
         "\"\< refers to vertex \>\"", "<>", 
         RowBox[{"ToString", "[", "vmax", "]"}], "<>", 
         "\"\< which is not defined.\>\""}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
      RowBox[{"vmin", "=", 
       RowBox[{"Min", "[", 
        RowBox[{"Flatten", "[", "edges", "]"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"pvmin", " ", "=", " ", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"edges", ",", " ", "vmin"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"AbortIf", "[", 
       RowBox[{
        RowBox[{"vmin", " ", "<", "1"}], ",", " ", 
        RowBox[{"\"\<Edge \>\"", "<>", 
         RowBox[{"ToString", "[", "pvmin", "]"}], "<>", 
         "\"\< refers to vertex \>\"", "<>", 
         RowBox[{"ToString", "[", "vmin", "]"}], "<>", 
         "\"\< which is not a valid vertex number\>\""}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Get", " ", "the", " ", "faces"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Q", "=", 
       RowBox[{"Drop", "[", 
        RowBox[{"Q", ",", " ", "ne"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"AbortIf", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "Q", "]"}], "<", "nf"}], ",", " ", 
        RowBox[{"\"\<Early end to file after \>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"Length", "[", "Q", "]"}], "]"}], "<>", 
         "\"\< faces, when \>\"", "<>", 
         RowBox[{"ToString", "[", "nf", "]"}], "<>", 
         "\"\< faces were expected.\>\""}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"faces", " ", "=", " ", 
       RowBox[{"Take", "[", 
        RowBox[{"Q", ",", "nf"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"dPrint", "[", 
       RowBox[{"\"\<faces: \>\"", ",", " ", "faces"}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Make", " ", "sure", " ", "the", " ", "faces", " ", "only", " ", 
        "refer", " ", "to", " ", "allowed", " ", "edge", " ", "numbers"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"emax", " ", "=", " ", 
       RowBox[{"Max", "[", 
        RowBox[{"Flatten", "[", "faces", "]"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"pemax", " ", "=", " ", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"faces", ",", " ", "emax"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"AbortIf", "[", 
       RowBox[{
        RowBox[{"emax", ">", "ne"}], ",", " ", 
        RowBox[{"\"\<Face \>\"", "<>", 
         RowBox[{"ToString", "[", "pemax", "]"}], "<>", 
         "\"\< refers to edge \>\"", "<>", 
         RowBox[{"ToString", "[", "emax", "]"}], "<>", 
         "\"\< which is not defined.\>\""}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"emin", " ", "=", " ", 
       RowBox[{"Min", "[", 
        RowBox[{"Flatten", "[", "faces", "]"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"pemin", " ", "=", " ", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"faces", ",", " ", "emin"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"AbortIf", "[", 
       RowBox[{
        RowBox[{"emin", " ", "<", "1"}], ",", " ", 
        RowBox[{"\"\<Face \>\"", "<>", 
         RowBox[{"ToString", "[", "pemin", "]"}], "<>", 
         "\"\< refers to edge \>\"", "<>", 
         RowBox[{"ToString", "[", "emin", "]"}], "<>", 
         "\"\< which is not a valid edge number\>\""}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Tissue", "[", 
       RowBox[{"vertices", ",", "edges", ",", " ", "faces"}], "]"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.562441099394803*^9, 3.562441161640916*^9}, {
  3.562441197213231*^9, 3.562442073657681*^9}, {3.56244212368993*^9, 
  3.562442147654231*^9}, {3.562442178023387*^9, 3.562442363075981*^9}, {
  3.5624427699964743`*^9, 3.562442810281272*^9}, {3.5624428660780077`*^9, 
  3.562442874553061*^9}, {3.562599822731522*^9, 3.5625998763537893`*^9}, {
  3.562600225378977*^9, 
  3.562600303598447*^9}},ExpressionUUID->"596df995-32ea-4cc2-8958-\
d5fcb31f87c4"],

Cell["\<\
Reads a flat CSV file, has only faces and vertices, no edge numbers
\t2,dimensions\t\t# the word \[OpenCurlyDoubleQuote]dimensions\
\[CloseCurlyDoubleQuote] must be written out (without the quotation marks)
\t4,vertices\t\t# the word \[OpenCurlyDoubleQuote]vertices\
\[CloseCurlyDoubleQuote] is required
\t1,faces\t\t\t# the word \
\[OpenCurlyDoubleQuote]faces\[CloseCurlyDoubleQuote] is required
\t0.,0.\t\t\t# x,y for first vertex
\t1.,0.
\t0.,1.
\t1.,1.\t\t\t
\t...
\t1,2,4,3\t\t\t# vertex indices for  first cell 
\t..\t\t\t# vertex indices for second cell
\t..\t\t\t# etc\
\>", "Text",
 CellChangeTimes->{{3.562599887970828*^9, 3.562599917382923*^9}, {
  3.562599986859056*^9, 
  3.5626000439859447`*^9}},ExpressionUUID->"62ee66e9-44fe-4220-bac4-\
21d0ea4ef90f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FlatCSVToTissue", "[", "filename_", "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "Q", ",", " ", "lens", ",", " ", "dim", ",", " ", "nv", ",", "nf", ",", 
      " ", "nlines", ",", " ", "vertices", ",", " ", "vlens", ",", " ", 
      "faces", ",", " ", "vmax", ",", " ", "pvmax", ",", "vmin", ",", " ", 
      "pvmin", ",", " ", "emin", ",", " ", "emax", ",", " ", "pemin", ",", 
      " ", "pemax", ",", " ", "dPrint", ",", " ", 
      RowBox[{"dbg", "=", "False"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"dPrint", "[", "x___", "]"}], ":=", 
      RowBox[{"If", "[", 
       RowBox[{"dbg", ",", " ", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<CSVToTissue: \>\"", ",", " ", "x"}], "]"}]}], "]"}]}], 
     ";", " ", "\[IndentingNewLine]", 
     RowBox[{"AbortIf", "[", 
      RowBox[{
       RowBox[{"Not", "[", 
        RowBox[{"FileExistsQ", "[", "filename", "]"}], "]"}], ",", " ", 
       RowBox[{"\"\<Unable to locate \>\"", "<>", 
        RowBox[{"ToString", "[", "filename", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Q", "=", 
      RowBox[{"Import", "[", "filename", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"lens", " ", "=", " ", 
      RowBox[{"Length", "/@", "Q"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dim", "=", 
      RowBox[{"Q", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"AbortIf", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"dim", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "\[NotEqual]", " ", 
        "\"\<dimensions\>\""}], ",", " ", 
       "\"\<The first line of the file is not n,dimensions\>\""}], "]"}], ";",
      " ", "\[IndentingNewLine]", 
     RowBox[{"dim", " ", "=", " ", 
      RowBox[{"dim", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"nv", "=", 
      RowBox[{"Q", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"AbortIf", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"nv", "[", 
         RowBox[{"[", "2", "]"}], "]"}], " ", "\[NotEqual]", " ", 
        "\"\<vertices\>\""}], ",", " ", 
       "\"\<The second line of the file is not nv,vertices\>\""}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"nv", " ", "=", " ", 
      RowBox[{"nv", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"nf", "=", 
      RowBox[{"Q", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"AbortIf", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"nf", "[", 
         RowBox[{"[", "2", "]"}], "]"}], " ", "\[NotEqual]", " ", 
        "\"\<faces\>\""}], ",", " ", 
       "\"\<The 3rd line of the file is not nf,faces, so this is not a flat \
file\>\""}], "]"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"nf", " ", "=", " ", 
      RowBox[{"nf", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"nlines", " ", "=", " ", 
      RowBox[{"Length", "[", "lens", "]"}]}], ";", " ", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"get", " ", "the", " ", "vertices"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Q", "=", 
      RowBox[{"Drop", "[", 
       RowBox[{"Q", ",", "3"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"AbortIf", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "Q", "]"}], "<", "nv"}], ",", " ", 
       RowBox[{"\"\<Early end to file after \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"Length", "[", "Q", "]"}], "]"}], "<>", 
        "\"\< vertices, when \>\"", "<>", 
        RowBox[{"ToString", "[", "nv", "]"}], "<>", 
        "\"\< vertices were expected, followed by edges and faces.\>\""}]}], 
      "]"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"vertices", " ", "=", " ", 
      RowBox[{"Take", "[", 
       RowBox[{"Q", ",", "nv"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vlens", " ", "=", " ", 
      RowBox[{"Union", "[", 
       RowBox[{"Length", "/@", "vertices"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"AbortIf", "[", 
      RowBox[{
       RowBox[{"vlens", " ", "\[NotEqual]", " ", 
        RowBox[{"{", "dim", "}"}]}], ",", " ", 
       RowBox[{"\"\<Some of the vertices do not have dimension \>\"", "<>", 
        RowBox[{"ToString", "[", "dim", "]"}]}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"get", " ", "the", " ", "edges"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Q", "=", 
      RowBox[{"Drop", "[", 
       RowBox[{"Q", ",", "nv"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Get", " ", "the", " ", "faces"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"AbortIf", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "Q", "]"}], "<", "nf"}], ",", " ", 
       RowBox[{"\"\<Early end to file after \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"Length", "[", "Q", "]"}], "]"}], "<>", 
        "\"\< faces, when \>\"", "<>", 
        RowBox[{"ToString", "[", "nf", "]"}], "<>", 
        "\"\< faces were expected.\>\""}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"faces", " ", "=", " ", 
      RowBox[{"Take", "[", 
       RowBox[{"Q", ",", "nf"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"dPrint", "[", 
      RowBox[{"\"\<faces: \>\"", ",", " ", "faces"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Make", " ", "sure", " ", "the", " ", "faces", " ", "only", " ", 
       "refer", " ", "to", " ", "allowed", " ", "vertex", " ", "numbers"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"vmax", "=", 
      RowBox[{"Max", "[", 
       RowBox[{"Flatten", "[", "faces", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pvmax", " ", "=", " ", 
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{"faces", ",", " ", "vmax"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"AbortIf", "[", 
      RowBox[{
       RowBox[{"vmax", ">", "nv"}], ",", " ", 
       RowBox[{"\"\<Face \>\"", "<>", 
        RowBox[{"ToString", "[", "pvmax", "]"}], "<>", 
        "\"\< refers to vertex \>\"", "<>", 
        RowBox[{"ToString", "[", "vmax", "]"}], "<>", 
        "\"\< which is not defined.\>\""}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
     RowBox[{"vmin", "=", 
      RowBox[{"Min", "[", 
       RowBox[{"Flatten", "[", "faces", "]"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"pvmin", " ", "=", " ", 
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{"faces", ",", " ", "vmin"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"AbortIf", "[", 
      RowBox[{
       RowBox[{"vmin", " ", "<", "1"}], ",", " ", 
       RowBox[{"\"\<Face \>\"", "<>", 
        RowBox[{"ToString", "[", "pvmin", "]"}], "<>", 
        "\"\< refers to vertex \>\"", "<>", 
        RowBox[{"ToString", "[", "vmin", "]"}], "<>", 
        "\"\< which is not a valid vertex number\>\""}]}], "]"}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"FlatTissue2Tissue", "[", 
      RowBox[{"FlatTissue", "[", 
       RowBox[{"vertices", ",", " ", "faces"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.562599210581312*^9, 3.562599364076582*^9}, {
  3.56259939412542*^9, 3.562599455002116*^9}, {3.562599504839259*^9, 
  3.562599538841158*^9}, {3.562599660295842*^9, 3.562599697273378*^9}, {
  3.562599736782548*^9, 
  3.562599772832066*^9}},ExpressionUUID->"fd49c95e-bb3f-40e2-84da-\
6cd8aa634b40"]
}, Closed]],

Cell[CellGroupData[{

Cell["FlatFile", "Subsection",
 CellChangeTimes->{{3.51726461622113*^9, 
  3.5172646174286346`*^9}},ExpressionUUID->"b63f629e-982c-4093-9c4c-\
9b5596c759f9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FlatFile", "[", 
    RowBox[{"w_", "?", "TissueQ"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "nv", ",", "ne", ",", "nf", ",", "nc", ",", "v", ",", " ", "e", ",", 
       " ", "f", ",", " ", "output", ",", 
       RowBox[{"dim", "=", "2"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"v", "=", 
       RowBox[{"TissueVertices", "[", "w", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dim", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"v", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"e", "=", 
       RowBox[{"TissueEdges", "[", "w", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"f", "=", 
       RowBox[{"TissueCells", "[", "w", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nv", "=", 
       RowBox[{"Length", "[", "v", "]"}]}], ";", 
      RowBox[{"ne", "=", 
       RowBox[{"Length", "[", "e", "]"}]}], ";", " ", 
      RowBox[{"nf", "=", 
       RowBox[{"Length", "[", "f", "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"nc", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"output", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", "dim", "}"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"nv", ",", "ne", ",", "nf", ",", "nc"}], "}"}], "}"}], ",", 
         RowBox[{"1.0", "*", "v"}], ",", "e", ",", "f"}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FlatFile", "[", 
    RowBox[{
     RowBox[{"w_", "?", "TissueQ"}], ",", " ", 
     RowBox[{"f_", "?", "StringQ"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "r", ",", " ", "fname", ",", "n", ",", "output", ",", "actual"}], "}"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fname", "=", "f"}], ";", "\[IndentingNewLine]", 
      RowBox[{"n", "=", "0"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"r", "=", 
       RowBox[{"FileExistsQ", "[", "fname", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{"r", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"n", " ", "=", " ", 
          RowBox[{"n", "+", "1"}]}], ";", " ", "\[IndentingNewLine]", 
         RowBox[{"fname", " ", "=", "  ", 
          RowBox[{"f", "<>", 
           RowBox[{"ToString", "[", "n", "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"r", "=", 
          RowBox[{"FileExistsQ", "[", "fname", "]"}]}], ";"}]}], " ", 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"output", "=", 
       RowBox[{"FlatFile", "[", "w", "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"actual", "=", 
       RowBox[{"Export", "[", 
        RowBox[{"fname", ",", "output", ",", "\"\<Table\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ExpandFileName", "[", "actual", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FlatFile", "[", "x___", "]"}], ":=", " ", 
   RowBox[{
   "Print", "[", 
    "\"\<Expecting FlatFile[tissue] or FlatFile[tissue,filename]\>\"", 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.517264619661923*^9, 3.5172647686549892`*^9}, {
  3.517264829780848*^9, 3.517264839952297*^9}, {3.5172649041914387`*^9, 
  3.517265085671732*^9}, {3.5172651165659857`*^9, 3.517265243320407*^9}, {
  3.517265328261961*^9, 3.5172653583250227`*^9}, {3.5172662534583473`*^9, 
  3.517266256662838*^9}, {3.5172663957212353`*^9, 3.517266396604711*^9}, {
  3.562440224211608*^9, 
  3.562440232492963*^9}},ExpressionUUID->"76b03700-522d-4969-a732-\
18acedbf2c38"]
}, Closed]],

Cell[CellGroupData[{

Cell["TissueToPLY", "Subsection",
 CellChangeTimes->{{3.517265462945681*^9, 
  3.517265464930039*^9}},ExpressionUUID->"2c5fd6f5-2a9e-4bea-b32c-\
4e0e4f26f0bb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TissueToPLY", "[", 
     RowBox[{"w_", "?", "TissueQ"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "nv", ",", "nc", ",", "ne", ",", "v", ",", "c", ",", "e", ",", 
        "efrom0", ",", "cfrom0", ",", "sub1", ",", "facelengths", ",", 
        "faces", ",", "output", ",", "header", ",", " ", "cvn", ",", 
        "cvnfrom0", ",", " ", "dim"}], "}"}], ",", 
      RowBox[{
       RowBox[{"v", "=", 
        RowBox[{"TissueVertices", "[", "w", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"e", "=", 
        RowBox[{"TissueEdges", "[", "w", "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"c", "=", 
        RowBox[{"TissueCells", "[", "w", "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"nv", "=", 
        RowBox[{"Length", "[", "v", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ne", "=", 
        RowBox[{"Length", "[", "e", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"nc", "=", 
        RowBox[{"Length", "[", "c", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"cvn", "=", 
        RowBox[{"CellVertexNumbers", "[", "w", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"cvn", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Append", "[", 
           RowBox[{"#", ",", 
            RowBox[{"First", "[", "#", "]"}]}], "]"}], "&"}], "/@", "cvn"}]}],
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sub1", "[", "list_", "]"}], ":=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"#", "-", "1"}], ")"}], "&"}], "/@", "list"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"efrom0", "=", 
        RowBox[{"sub1", "/@", "e"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"cfrom0", "=", 
        RowBox[{"sub1", "/@", "c"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"cvnfrom0", "=", 
        RowBox[{"sub1", "/@", "cvn"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"dim", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"v", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "  ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"facelengths", "=", 
        RowBox[{"Length", "/@", "cvnfrom0"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"cvnfrom0", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Prepend", "[", 
            RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"cvnfrom0", ",", "facelengths"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"dim", "\[Equal]", "2"}], ",", "\[IndentingNewLine]", 
         RowBox[{"header", "=", 
          RowBox[{"List", "/@", 
           RowBox[{"{", 
            RowBox[{
            "\"\<ply\>\"", ",", "\"\<format ascii 1.0\>\"", ",", 
             "\[IndentingNewLine]", 
             RowBox[{
             "\"\<comment Generated by Cellzilla2D \>\"", "<>", 
              "$Cellzilla2DVersion"}], ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<comment \>\"", "<>", 
              RowBox[{"DateString", "[", "]"}]}], ",", "\[IndentingNewLine]", 
             
             RowBox[{"\"\<element vertex \>\"", "<>", 
              RowBox[{"ToString", "[", "nv", "]"}]}], ",", 
             "\"\<property float x\>\"", ",", "\"\<property float y\>\"", ",", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"\"\<element edge \>\"", "<>", 
                RowBox[{"ToString", "[", "ne", "]"}]}], ",", 
               "\"\<property int vertex1\>\"", ",", 
               "\"\<property int vertex2\>\"", ","}], "*)"}], 
             RowBox[{"\"\<element face \>\"", "<>", 
              RowBox[{"ToString", "[", "nc", "]"}]}], ",", 
             "\"\<property list uchar int vertex_indices\>\"", ",", 
             "\"\<end_header\>\""}], "}"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"dim", "\[Equal]", "3"}], ",", "\[IndentingNewLine]", 
         RowBox[{"header", "=", 
          RowBox[{"List", "/@", 
           RowBox[{"{", 
            RowBox[{
            "\"\<ply\>\"", ",", "\"\<format ascii 1.0\>\"", ",", 
             "\[IndentingNewLine]", 
             RowBox[{
             "\"\<comment Generated by Cellzilla2D \>\"", "<>", 
              "$Cellzilla2DVersion"}], ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<comment \>\"", "<>", 
              RowBox[{"DateString", "[", "]"}]}], ",", "\[IndentingNewLine]", 
             
             RowBox[{"\"\<element vertex \>\"", "<>", 
              RowBox[{"ToString", "[", "nv", "]"}]}], ",", 
             "\"\<property float x\>\"", ",", "\"\<property float y\>\"", 
             ",", "\"\<property float z\>\"", ",", " ", 
             RowBox[{"\"\<element face \>\"", "<>", 
              RowBox[{"ToString", "[", "nc", "]"}]}], ",", 
             "\"\<property list uchar int vertex_indices\>\"", ",", 
             "\"\<end_header\>\""}], "}"}]}]}]}], "\[IndentingNewLine]", 
        "]"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"output", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"header", ",", 
          RowBox[{"v", "*", "1.0"}], ",", 
          RowBox[{"(*", 
           RowBox[{"efrom0", ",", "faces"}], "*)"}], " ", "cvnfrom0"}], 
         "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TissueToPLY", "[", 
     RowBox[{
      RowBox[{"w_", "?", "TissueQ"}], ",", " ", 
      RowBox[{"f_", "?", "StringQ"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "r", ",", " ", "fname", ",", "n", ",", "output", ",", "actual"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fname", "=", "f"}], ";", "\[IndentingNewLine]", 
       RowBox[{"n", "=", "0"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"r", "=", 
        RowBox[{"FileExistsQ", "[", "fname", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{"r", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"n", " ", "=", " ", 
           RowBox[{"n", "+", "1"}]}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"fname", " ", "=", "  ", 
           RowBox[{"f", "<>", 
            RowBox[{"ToString", "[", "n", "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"r", "=", 
           RowBox[{"FileExistsQ", "[", "fname", "]"}]}], ";"}]}], " ", 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"output", "=", 
        RowBox[{"TissueToPLY", "[", "w", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"actual", "=", 
        RowBox[{"Export", "[", 
         RowBox[{"fname", ",", "output", ",", "\"\<Table\>\""}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"ExpandFileName", "[", "actual", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TissueToPLY", "[", "x___", "]"}], ":=", " ", 
   RowBox[{
   "Print", "[", 
    "\"\<Expecting TissueToPLY[tissue] or TissueToPLY[tissue,filename]\>\"", 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.517265470555469*^9, 3.517265495003625*^9}, {
  3.5172655530201263`*^9, 3.517265555308612*^9}, {3.5172656075921288`*^9, 
  3.5172656481633377`*^9}, {3.517265716523437*^9, 3.517265778318181*^9}, {
  3.559001896782465*^9, 3.55900191294564*^9}, {3.559001971914164*^9, 
  3.559002040013253*^9}, {3.559003039582603*^9, 3.559003040286214*^9}, {
  3.559003799238591*^9, 3.559003876770266*^9}, {3.5590039287552843`*^9, 
  3.559003955910246*^9}, {3.559004071892111*^9, 3.559004072214367*^9}, {
  3.559004221785125*^9, 3.559004223851795*^9}, {3.559004411577462*^9, 
  3.559004424499523*^9}, {3.559004600590186*^9, 3.5590046049430647`*^9}, {
  3.559004648168874*^9, 3.559004658367558*^9}, {3.5590050604044456`*^9, 
  3.559005065464826*^9}},ExpressionUUID->"ef5e4fea-6d28-40cb-9066-\
1979819005c0"]
}, Closed]],

Cell[CellGroupData[{

Cell["PLYToTissue", "Subsection",
 CellChangeTimes->{{3.544268221695333*^9, 
  3.544268225096901*^9}},ExpressionUUID->"5bfa5574-be07-4c5b-b26b-\
599129724ea1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PLYToTissue", "[", 
   RowBox[{"filename_", ",", 
    RowBox[{"maxedges_:", " ", "100"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "u", ",", "nv", ",", "nf", ",", "EH", ",", "vertices", ",", "cells", ",",
       "Cells", ",", "cell", ",", "edges", ",", "EdgePairsInThisCell", ",", 
      "nextEdge", ",", "EdgesInThisCell", ",", "k", ",", "p", ",", "q", ",", 
      "vcell", ",", "centroid"}], "}"}], ",", 
    RowBox[{
     RowBox[{"u", "=", 
      RowBox[{"Import", "[", 
       RowBox[{"filename", ",", "\"\<table\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nv", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Cases", "[", 
        RowBox[{"u", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<element\>\"", ",", "\"\<vertex\>\"", ",", "_"}], 
          "}"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"ListQ", "[", "nv", "]"}], ",", 
       RowBox[{"nv", "=", 
        RowBox[{"Last", "[", "nv", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nf", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Cases", "[", 
        RowBox[{"u", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<element\>\"", ",", "\"\<face\>\"", ",", "_"}], "}"}]}],
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"ListQ", "[", "nf", "]"}], ",", 
       RowBox[{"nf", "=", 
        RowBox[{"Last", "[", "nf", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"EH", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Position", "[", 
        RowBox[{"u", ",", 
         RowBox[{"{", "\"\<end_header\>\"", "}"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"EH", "=", 
      RowBox[{"EH", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"u", "=", 
      RowBox[{"Drop", "[", 
       RowBox[{"u", ",", "EH"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vertices", "=", 
      RowBox[{"Take", "[", 
       RowBox[{"u", ",", "nv"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vertices", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Take", "[", 
          RowBox[{"#", ",", "2"}], "]"}], "&"}], ",", "vertices"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"cells", "=", 
      RowBox[{"Drop", "[", 
       RowBox[{"u", ",", "nv"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"edges", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Cells", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"c", "=", "1"}], ",", 
       RowBox[{"c", "\[LessEqual]", 
        RowBox[{"Length", "[", "cells", "]"}]}], ",", 
       RowBox[{"c", "++"}], ",", 
       RowBox[{
        RowBox[{"cell", "=", 
         RowBox[{"Rest", "[", 
          RowBox[{"cells", "[", 
           RowBox[{"[", "c", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "add", " ", "one", " ", "to", " ", "correct", " ", "for", " ", 
           "zero"}], "-", 
          RowBox[{"start", " ", "in", " ", "python"}]}], "*)"}], 
        RowBox[{"cell", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "+", "1"}], ")"}], "&"}], "/@", "cell"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"vcell", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"vertices", "[", 
            RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "cell"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"centroid", "=", 
         RowBox[{"Centroid", "[", "vertices", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"EdgePairsInThisCell", "=", 
         RowBox[{"Map", "[", 
          RowBox[{"Sort", ",", 
           RowBox[{"Partition", "[", 
            RowBox[{"cell", ",", "2", ",", "1", ",", "1"}], "]"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"ne", "=", 
         RowBox[{"Length", "[", "EdgePairsInThisCell", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ne", "<", "maxedges"}], ",", 
          RowBox[{
           RowBox[{"EdgesInThisCell", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"i", "=", "1"}], ",", 
             RowBox[{"i", "\[LessEqual]", "ne"}], ",", 
             RowBox[{"i", "++"}], ",", 
             RowBox[{
              RowBox[{"nextEdge", "=", 
               RowBox[{"EdgePairsInThisCell", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              
              RowBox[{
               RowBox[{"{", 
                RowBox[{"p", ",", "q"}], "}"}], "=", "nextEdge"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"p", "\[NotEqual]", "q"}], ",", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"MemberQ", "[", 
                    RowBox[{"edges", ",", "nextEdge"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"k", "=", 
                    RowBox[{"Position", "[", 
                    RowBox[{"edges", ",", "nextEdge"}], "]"}]}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{"ListQ", "[", "k", "]"}], ",", 
                    RowBox[{"k", "=", 
                    RowBox[{"k", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}]}], ",", 
                   RowBox[{
                    RowBox[{"edges", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"edges", ",", "nextEdge"}], "]"}]}], ";", 
                    RowBox[{"k", "=", 
                    RowBox[{"Length", "[", "edges", "]"}]}], ";"}]}], "]"}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{"EdgesInThisCell", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"EdgesInThisCell", ",", "k"}], "]"}]}], ";"}]}], 
               "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Cells", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"Cells", ",", "EdgesInThisCell"}], "]"}]}]}]}], "]"}], 
        ";"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Cells", " ", "=", " ", 
      RowBox[{"Select", "[", 
       RowBox[{"Cells", ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "#", "]"}], ">", "2"}], "&"}]}], "]"}]}], 
     ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Tissue", "[", 
      RowBox[{"vertices", ",", "edges", ",", "Cells"}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.544268251693266*^9, 3.5442682617418327`*^9}, {
  3.544268444286405*^9, 3.5442684448401423`*^9}, {3.559090988654175*^9, 
  3.559090990423973*^9}},ExpressionUUID->"6e706afa-dc51-4117-b060-\
8d9fc31c2cb1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PLYToTissue3D", "[", 
   RowBox[{"filename_", ",", 
    RowBox[{"maxedges_:", " ", "100"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "u", ",", "nv", ",", "nf", ",", "EH", ",", "vertices", ",", "cells", ",",
       "Cells", ",", "cell", ",", "edges", ",", "EdgePairsInThisCell", ",", 
      "nextEdge", ",", "EdgesInThisCell", ",", "k", ",", "p", ",", "q", ",", 
      "vcell", ",", "centroid", ",", " ", "vertices3D"}], "}"}], ",", 
    RowBox[{
     RowBox[{"u", "=", 
      RowBox[{"Import", "[", 
       RowBox[{"filename", ",", "\"\<table\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nv", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Cases", "[", 
        RowBox[{"u", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<element\>\"", ",", "\"\<vertex\>\"", ",", "_"}], 
          "}"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"ListQ", "[", "nv", "]"}], ",", 
       RowBox[{"nv", "=", 
        RowBox[{"Last", "[", "nv", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nf", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Cases", "[", 
        RowBox[{"u", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<element\>\"", ",", "\"\<face\>\"", ",", "_"}], "}"}]}],
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"ListQ", "[", "nf", "]"}], ",", 
       RowBox[{"nf", "=", 
        RowBox[{"Last", "[", "nf", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"EH", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Position", "[", 
        RowBox[{"u", ",", 
         RowBox[{"{", "\"\<end_header\>\"", "}"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"EH", "=", 
      RowBox[{"EH", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"u", "=", 
      RowBox[{"Drop", "[", 
       RowBox[{"u", ",", "EH"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vertices", "=", 
      RowBox[{"Take", "[", 
       RowBox[{"u", ",", "nv"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vertices3D", "=", "vertices"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"vertices", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Take", "[", 
          RowBox[{"#", ",", "2"}], "]"}], "&"}], ",", "vertices"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"cells", "=", 
      RowBox[{"Drop", "[", 
       RowBox[{"u", ",", "nv"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"edges", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Cells", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"c", "=", "1"}], ",", 
       RowBox[{"c", "\[LessEqual]", 
        RowBox[{"Length", "[", "cells", "]"}]}], ",", 
       RowBox[{"c", "++"}], ",", 
       RowBox[{
        RowBox[{"cell", "=", 
         RowBox[{"Rest", "[", 
          RowBox[{"cells", "[", 
           RowBox[{"[", "c", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "add", " ", "one", " ", "to", " ", "correct", " ", "for", " ", 
           "zero"}], "-", 
          RowBox[{"start", " ", "in", " ", "python"}]}], "*)"}], 
        RowBox[{"cell", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "+", "1"}], ")"}], "&"}], "/@", "cell"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"vcell", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"vertices", "[", 
            RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "cell"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"centroid", "=", 
         RowBox[{"Centroid", "[", "vertices", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"EdgePairsInThisCell", "=", 
         RowBox[{"Map", "[", 
          RowBox[{"Sort", ",", 
           RowBox[{"Partition", "[", 
            RowBox[{"cell", ",", "2", ",", "1", ",", "1"}], "]"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"ne", "=", 
         RowBox[{"Length", "[", "EdgePairsInThisCell", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ne", "<", "maxedges"}], ",", 
          RowBox[{
           RowBox[{"EdgesInThisCell", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"i", "=", "1"}], ",", 
             RowBox[{"i", "\[LessEqual]", "ne"}], ",", 
             RowBox[{"i", "++"}], ",", 
             RowBox[{
              RowBox[{"nextEdge", "=", 
               RowBox[{"EdgePairsInThisCell", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              
              RowBox[{
               RowBox[{"{", 
                RowBox[{"p", ",", "q"}], "}"}], "=", "nextEdge"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"p", "\[NotEqual]", "q"}], ",", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"MemberQ", "[", 
                    RowBox[{"edges", ",", "nextEdge"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"k", "=", 
                    RowBox[{"Position", "[", 
                    RowBox[{"edges", ",", "nextEdge"}], "]"}]}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{"ListQ", "[", "k", "]"}], ",", 
                    RowBox[{"k", "=", 
                    RowBox[{"k", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}]}], ",", 
                   RowBox[{
                    RowBox[{"edges", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"edges", ",", "nextEdge"}], "]"}]}], ";", 
                    RowBox[{"k", "=", 
                    RowBox[{"Length", "[", "edges", "]"}]}], ";"}]}], "]"}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{"EdgesInThisCell", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"EdgesInThisCell", ",", "k"}], "]"}]}], ";"}]}], 
               "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Cells", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"Cells", ",", "EdgesInThisCell"}], "]"}]}]}]}], "]"}], 
        ";"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"weed", " ", "out", " ", "spurious", " ", "cells"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Cells", " ", "=", " ", 
      RowBox[{"Select", "[", 
       RowBox[{"Cells", ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "#", "]"}], ">", "2"}], "&"}]}], "]"}]}], 
     ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Tissue", "[", 
      RowBox[{"vertices3D", ",", "edges", ",", "Cells"}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.558995082435341*^9, 3.558995112755479*^9}, {
  3.5590909578894043`*^9, 
  3.559090979465825*^9}},ExpressionUUID->"088763a2-ab4a-4e0f-9976-\
dab6f4067b2b"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Generate Help File", "Section",
 CellChangeTimes->{{3.437229378931288*^9, 3.437229383600165*^9}, {
  3.454152797897554*^9, 
  3.45415280646375*^9}},ExpressionUUID->"bdceb57b-1c71-40cc-ae22-\
879637722b6b"],

Cell["rev 1.0.5 to remove  link to MathSBML", "Text",
 CellChangeTimes->{{3.4541528575684223`*^9, 
  3.454152865920064*^9}},ExpressionUUID->"6f27a684-4840-4ffe-9380-\
ed1cb0e35eaa"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Help", "[", "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"names", ",", " ", "usagestrings", ",", " ", "print"}], "}"}], 
     ",", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"names", "=", 
       RowBox[{"decontextify", "/@", 
        RowBox[{"Names", "[", "\"\<Cellzilla2D`*\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"usagestrings", " ", "=", " ", 
       RowBox[{"ToExpression", "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<::usage\>\""}], 
            ")"}], "&"}], "/@", "names"}], ")"}]}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"print", "[", 
        RowBox[{"a_", ",", " ", "b_"}], "]"}], ":=", " ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"StringLength", "[", 
              RowBox[{"ToString", "[", "b", "]"}], "]"}], ">", "0"}], ",", 
            " ", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"StylePrint", "[", 
              RowBox[{"a", ",", " ", "\"\<Subsection\>\""}], "]"}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"Print", "[", "b", "]"}], ";"}]}], " ", 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"StylePrint", "[", 
       RowBox[{"\"\<Cellzilla2D Help\>\"", ",", " ", "\"\<Section\>\""}], 
       "]"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{
      "Print", "[", 
       "\"\<This is the Cellzilla2D Help file. It provides some reference \
information about each of the externally visible Cellzilla2D functions. It is \
not a users guide and does not provide any introduction to using Cellzilla2D. \
It also does not include plugin reference information. \\nPlease note that \
Cellzilla2D is experimental software and as such many of the functions may \
only contain partial implementations. And like a lot of software \
documentation in the cybersphere it does not always keep up with the latest \
implementation. Please check with the developer if you have any \
questions.\>\"", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<This file was generated by CelleratorML version \>\"", "<>", 
        "$Cellzilla2DVersion", "<>", "\"\< on \>\"", "<>", 
        RowBox[{"DateString", "[", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Day\>\"", ",", " ", "\"\< \>\"", ",", " ", 
           "\"\<MonthNameShort\>\"", ",", " ", "\"\< \>\"", ",", " ", 
           "\"\<Year\>\"", ",", " ", "\"\< at \>\"", ",", " ", "\"\<Hour\>\"",
            ",", " ", "\"\<:\>\"", ",", " ", "\"\<Minute\>\"", ",", " ", 
           "\"\<:\>\"", ",", " ", "\"\<Second\>\"", ",", " ", "\"\< (\>\"", 
           ",", " ", "\"\<TimeZone\>\"", ",", "\"\<)\>\""}], "}"}], "]"}], 
        "<>", "\"\< using Mathematica \>\"", "<>", "$Version", "<>", 
        "\"\< (Version \>\"", "<>", 
        RowBox[{"ToString", "[", " ", "$VersionNumber", "]"}], "<>", 
        "\"\<, Release \>\"", "<>", 
        RowBox[{"ToString", "[", " ", "$ReleaseNumber", "]"}], "<>", " ", 
        "\"\<)\>\""}], "]"}], ";", "  ", "\[IndentingNewLine]", 
      RowBox[{"MapThread", "[", 
       RowBox[{"print", ",", " ", 
        RowBox[{"{", 
         RowBox[{"names", ",", " ", "usagestrings"}], "}"}]}], "]"}], ";"}]}],
     " ", "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.43722971429759*^9, 3.437229817047864*^9}, {
  3.437230074667192*^9, 3.437230076859786*^9}, {3.437230120021682*^9, 
  3.437230167013853*^9}, {3.437230257536437*^9, 3.437230261971897*^9}, {
  3.454152810516652*^9, 3.454152826886998*^9}, {3.454613970335718*^9, 
  3.454614012015169*^9}},ExpressionUUID->"bff88457-0794-4d67-87d9-\
0c7d28b2b4a3"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["End", "Subtitle",
 CellChangeTimes->{{3.446838457221793*^9, 
  3.446838457621205*^9}},ExpressionUUID->"c7f9697f-38a9-428c-ac28-\
8a7e4345785f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
    "FLAGS`ECHOLOAD", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<Cellzilla2D\>\"", ",", " ", 
          RowBox[{"FontFamily", "\[Rule]", " ", "\"\<Ubuntu,Arial\>\""}], ",",
           " ", 
          RowBox[{"FontSize", "\[Rule]", " ", "12"}], ",", " ", 
          RowBox[{"FontWeight", "\[Rule]", " ", "\"\<Bold\>\""}]}], "]"}], 
        ",", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{
          "\"\< (\>\"", "<>", "$Cellzilla2DVersion", "<>", " ", 
           "\"\<) loaded \>\"", "<>", " ", 
           RowBox[{"DateString", "[", "]"}], "<>", "\"\<\\nusing \>\""}], ",",
           " ", 
          RowBox[{"FontSize", "\[Rule]", "12"}], ",", 
          RowBox[{"FontFamily", "\[Rule]", " ", "\"\<Ubuntu,Arial\>\""}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<xCellerator \>\"", ",", " ", 
          RowBox[{"FontSize", "\[Rule]", " ", "12"}], ",", " ", 
          RowBox[{"FontFamily", "\[Rule]", " ", "\"\<Ubuntu,Arial\>\""}], ",",
           " ", 
          RowBox[{"FontWeight", "\[Rule]", " ", "\"\<Bold\>\""}]}], "]"}], 
        ",", " ", "\[IndentingNewLine]", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"$XLR8RLOAD", "<>", "\"\< and \>\""}], ",", " ", 
          RowBox[{"FontSize", "\[Rule]", "12"}], ",", 
          RowBox[{"FontFamily", "\[Rule]", " ", "\"\<Ubuntu,Arial\>\""}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<XSSA \>\"", ",", " ", 
          RowBox[{"FontSize", "\[Rule]", " ", "12"}], ",", " ", 
          RowBox[{"FontFamily", "\[Rule]", " ", "\"\<Ubuntu,Arial\>\""}], ",",
           " ", 
          RowBox[{"FontWeight", "\[Rule]", " ", "\"\<Bold\>\""}]}], "]"}], 
        ",", " ", "\[IndentingNewLine]", 
        RowBox[{"Style", "[", 
         RowBox[{"$XSSALOAD", ",", " ", 
          RowBox[{"FontSize", "\[Rule]", "12"}], ",", 
          RowBox[{"FontFamily", "\[Rule]", " ", "\"\<Ubuntu,Arial\>\""}]}], 
         "]"}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<\\nGPL License Terms Apply\>\"", ",", " ", 
          RowBox[{"FontColor", "\[Rule]", " ", "Red"}], ",", " ", 
          RowBox[{"FontSize", "\[Rule]", " ", "12"}], ",", " ", 
          RowBox[{"FontFamily", "\[Rule]", " ", "\"\<Ubuntu,Arial\>\""}], ",",
           " ", 
          RowBox[{"FontWeight", "\[Rule]", " ", "Bold"}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
   ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EndPackage", "[", "]"}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.446837689894054*^9, 3.446837695445965*^9}, {
   3.447085558788908*^9, 3.447085617695861*^9}, {3.448672490094833*^9, 
   3.448672514106417*^9}, 3.448672552059649*^9, {3.448672635557018*^9, 
   3.448672646690786*^9}, {3.450720736224298*^9, 3.450720742608189*^9}, {
   3.452331499129917*^9, 3.452331508281535*^9}, {3.4544339448692503`*^9, 
   3.454433950618568*^9}, {3.454434724365127*^9, 3.454434727698444*^9}, {
   3.454435460064292*^9, 3.4544354671162987`*^9}, {3.4573544379309464`*^9, 
   3.4573544703100843`*^9}, {3.457354722272044*^9, 3.4573548056175423`*^9}, {
   3.4573548492878942`*^9, 3.4573548573112593`*^9}, {3.457447649965489*^9, 
   3.457447656036779*^9}, {3.556743051149753*^9, 3.556743054806107*^9}, {
   3.5567431052641*^9, 3.556743114350915*^9}, {3.5567431920485907`*^9, 
   3.5567432078707647`*^9}, {3.556743255358223*^9, 3.5567432658854313`*^9}, {
   3.556743308357128*^9, 3.556743374157586*^9}, {3.556804352719441*^9, 
   3.556804561521648*^9}, {3.56146418123414*^9, 3.561464223789256*^9}, {
   3.561464305904828*^9, 
   3.5614643063707123`*^9}},ExpressionUUID->"c89b4cfb-3443-4fbe-b8e9-\
8e337964b35e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"Cellzilla2D\"\>",
    StripOnInput->False,
    FontFamily->"Ubuntu,Arial",
    FontSize->12,
    FontWeight->"Bold"], "\[InvisibleSpace]", 
   StyleBox["\<\" (3.0.51 (05 June 2017)) loaded Mon 5 Jun 2017 \
22:05:39\\nusing \"\>",
    StripOnInput->False,
    FontFamily->"Ubuntu,Arial",
    FontSize->12], "\[InvisibleSpace]", 
   StyleBox["\<\"xCellerator \"\>",
    StripOnInput->False,
    FontFamily->"Ubuntu,Arial",
    FontSize->12,
    FontWeight->"Bold"], "\[InvisibleSpace]", 
   StyleBox["\<\"0.95 and \"\>",
    StripOnInput->False,
    FontFamily->"Ubuntu,Arial",
    FontSize->12], "\[InvisibleSpace]", 
   StyleBox["\<\"XSSA \"\>",
    StripOnInput->False,
    FontFamily->"Ubuntu,Arial",
    FontSize->12,
    FontWeight->"Bold"], "\[InvisibleSpace]", 
   StyleBox["\<\"** Not Found **\"\>",
    StripOnInput->False,
    FontFamily->"Ubuntu,Arial",
    FontSize->12], "\[InvisibleSpace]", 
   StyleBox["\<\"\\nGPL License Terms Apply\"\>",
    StripOnInput->False,
    FontFamily->"Ubuntu,Arial",
    FontSize->12,
    FontWeight->Bold,
    FontColor->RGBColor[1, 0, 0]]}],
  SequenceForm[
   Style["Cellzilla2D", FontFamily -> "Ubuntu,Arial", FontSize -> 12, 
    FontWeight -> "Bold"], 
   Style[" (3.0.51 (05 June 2017)) loaded Mon 5 Jun 2017 22:05:39\nusing ", 
    FontSize -> 12, FontFamily -> "Ubuntu,Arial"], 
   Style["xCellerator ", FontSize -> 12, FontFamily -> "Ubuntu,Arial", 
    FontWeight -> "Bold"], 
   Style["0.95 and ", FontSize -> 12, FontFamily -> "Ubuntu,Arial"], 
   Style["XSSA ", FontSize -> 12, FontFamily -> "Ubuntu,Arial", FontWeight -> 
    "Bold"], 
   Style["** Not Found **", FontSize -> 12, FontFamily -> "Ubuntu,Arial"], 
   Style["\nGPL License Terms Apply", FontColor -> RGBColor[1, 0, 0], 
    FontSize -> 12, FontFamily -> "Ubuntu,Arial", FontWeight -> Bold]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.705714339520094*^9},ExpressionUUID->"6a019fe2-9662-4239-bac2-\
78f4f8287920"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
PrintingStyleEnvironment->"Working",
WindowSize->{981, 630},
WindowMargins->{{65, Automatic}, {17, Automatic}},
PrintingCopies->1,
PrintingPageRange->{Automatic, Automatic},
PrintingOptions->{"PaperOrientation"->"Portrait",
"PaperSize"->{Automatic, Automatic},
"PostScriptOutputFile"->""},
Magnification:>1.5 Inherited,
FrontEndVersion->"11.1 for Mac OS X x86 (32-bit, 64-bit Kernel) (April 27, \
2017)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> 
     FrontEnd`FileName[{"Creative"}, "PastelColor.nb", CharacterEncoding -> 
       "UTF-8"]]], 
   Cell[
    StyleData["Input"]]}, Visible -> False, FrontEndVersion -> 
  "11.1 for Mac OS X x86 (32-bit, 64-bit Kernel) (April 27, 2017)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 335, 5, 100, "Title", "ExpressionUUID" -> \
"83d06029-506d-4ca4-88e5-5e669fd158c8"],
Cell[917, 29, 1314, 26, 230, "Text", "ExpressionUUID" -> \
"2aabce3b-9017-4d02-a97b-4d0c62f1aa72"],
Cell[CellGroupData[{
Cell[2256, 59, 165, 3, 37, "Subsubsection", "ExpressionUUID" -> \
"20cd7110-779d-4658-824e-42c695304a30"],
Cell[2424, 64, 707, 13, 2147483647, "Text", "ExpressionUUID" -> \
"ff17a2ec-1def-405e-b876-ec32276c49c0"]
}, Closed]],
Cell[CellGroupData[{
Cell[3168, 82, 186, 3, 26, "Subsubsection", "ExpressionUUID" -> \
"fb0e11bc-50c8-4f81-be46-613b2153433b"],
Cell[3357, 87, 873, 18, 2147483647, "Text", "ExpressionUUID" -> \
"d4adb370-3f17-4ce0-a079-050eacb7d130"]
}, Closed]],
Cell[CellGroupData[{
Cell[4267, 110, 192, 3, 26, "Subsubsection", "ExpressionUUID" -> \
"9d463271-d454-4d51-8efb-921c2909e08c"],
Cell[4462, 115, 32665, 461, 9822, "Text", "ExpressionUUID" -> \
"f3126382-f7a2-4fbc-b6ed-f6f2e53490d4"]
}, Closed]],
Cell[CellGroupData[{
Cell[37164, 581, 153, 3, 33, "Subtitle", "ExpressionUUID" -> \
"5270b78c-3cc1-4aff-b182-04ace7bff920"],
Cell[37320, 586, 11848, 164, 96, "Input", "ExpressionUUID" -> \
"2a0ca561-6b71-4679-88f6-835bac325486",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[49205, 755, 207, 4, 33, "Subtitle", "ExpressionUUID" -> \
"6837c32b-afc1-4f7e-b186-f8cf5abdb1d0"],
Cell[CellGroupData[{
Cell[49437, 763, 253, 8, 37, "Subsubsection", "ExpressionUUID" -> \
"bc40ed0d-c9f2-4447-8c7d-77a0c30e66e1"],
Cell[49693, 773, 1510, 38, 2147483647, "Input", "ExpressionUUID" -> \
"90578cbe-3f29-4f7e-8ca2-cad21dd85d84",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[51240, 816, 221, 4, 26, "Subsubsection", "ExpressionUUID" -> \
"d996549c-0024-4f85-83ff-e04cbeb82f03"],
Cell[51464, 822, 763, 16, 2147483647, "Input", "ExpressionUUID" -> \
"3ecc12ca-045a-47f2-885c-a648887c8ed8",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[52264, 843, 171, 3, 26, "Subsubsection", "ExpressionUUID" -> \
"57dede2b-12ea-4a25-971e-b46b47d28120"],
Cell[CellGroupData[{
Cell[52460, 850, 4558, 87, 2147483647, "Input", "ExpressionUUID" -> \
"e2f0ae0e-1b93-4f9a-a4f6-8a2443d31b26",
 InitializationCell->True],
Cell[57021, 939, 516, 7, 2147483647, "Output", "ExpressionUUID" -> \
"6e6bbaa3-66a8-4326-b209-e06c83ba0be5"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[57586, 952, 215, 4, 26, "Subsubsection", "ExpressionUUID" -> \
"034078c6-4c36-400c-9e8a-f7c7919adb1f"],
Cell[57804, 958, 9325, 214, 3723, "Input", "ExpressionUUID" -> \
"634819c7-e1c0-480d-8c02-41d040529c58",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[67166, 1177, 161, 3, 37, "Subsubsection", "ExpressionUUID" -> \
"7f7eb231-eeca-4a0e-a38e-2bdbee1f8a31"],
Cell[67330, 1182, 3211, 59, 10408, "Input", "ExpressionUUID" -> \
"120041ca-780e-4729-a6ac-6fcf720532d4",
 InitializationCell->True],
Cell[70544, 1243, 6952, 163, 17677, "Input", "ExpressionUUID" -> \
"f152c873-43c1-4cb3-adec-d1b863dab78e",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[77533, 1411, 160, 3, 26, "Subsubsection", "ExpressionUUID" -> \
"ad680f60-cc02-483f-93b5-6c00cc7ee682"],
Cell[77696, 1416, 5325, 119, 38200, "Input", "ExpressionUUID" -> \
"0cf1c740-6d37-4f14-b9d9-2062ff7d5fa9",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[83058, 1540, 210, 4, 26, "Subsubsection", "ExpressionUUID" -> \
"a6ce5bb6-2f60-4a53-b325-112936f453fa"],
Cell[83271, 1546, 1300, 32, 2147483647, "Input", "ExpressionUUID" -> \
"f576295d-a6e7-434f-9150-273b6a7647ae",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[84608, 1583, 172, 3, 26, "Subsubsection", "ExpressionUUID" -> \
"f6fcc6a4-5b59-4f8f-90cf-47b1d8c65b27"],
Cell[84783, 1588, 594, 16, 532, "Input", "ExpressionUUID" -> \
"9a4ab341-91f5-4f7c-9c41-e82b37132e08",
 InitializationCell->True],
Cell[85380, 1606, 27751, 667, 27211, "Input", "ExpressionUUID" -> \
"19798b20-1c8e-473c-b35a-2256aa30f525",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[113168, 2278, 201, 3, 26, "Subsubsection", "ExpressionUUID" -> \
"474d0aca-36a6-442f-8f1c-ea8f086ab9fb"],
Cell[113372, 2283, 2709, 71, 2147483647, "Input", "ExpressionUUID" -> \
"2a221bab-ecc6-4770-b401-379c29665611",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[116118, 2359, 162, 3, 26, "Subsubsection", "ExpressionUUID" -> \
"c85b6ec5-ba9a-4f7e-a4d8-a1a452db733c"],
Cell[116283, 2364, 17546, 377, 639861, "Input", "ExpressionUUID" -> \
"fc45fc17-4d39-4b2d-aa7e-c58580d352f9",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[133866, 2746, 164, 3, 26, "Subsubsection", "ExpressionUUID" -> \
"d41040b2-c582-4852-b493-e5383f9469d0"],
Cell[134033, 2751, 1973, 45, 2147483647, "Input", "ExpressionUUID" -> \
"6610808e-2fdb-4aa4-a1a0-1d97fb081feb",
 InitializationCell->True],
Cell[136009, 2798, 294, 9, 2147483647, "Input", "ExpressionUUID" -> \
"d7c03f35-acb0-4f44-b3d2-e6c8e74337fc",
 InitializationCell->True],
Cell[136306, 2809, 146, 3, 2147483647, "Text", "ExpressionUUID" -> \
"933c5951-257d-4176-8179-6713da1fb7e8"]
}, Closed]],
Cell[CellGroupData[{
Cell[136489, 2817, 168, 3, 26, "Subsubsection", "ExpressionUUID" -> \
"9277226d-1e00-4573-90de-f11872c0a490"],
Cell[136660, 2822, 2279, 49, 2147483647, "Input", "ExpressionUUID" -> \
"53c86dba-a865-4635-8d20-fb9a7760a4d1",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[138976, 2876, 187, 3, 26, "Subsubsection", "ExpressionUUID" -> \
"b3e6a710-65bc-44cf-b9ce-c94e2cfc77bb"],
Cell[139166, 2881, 1184, 29, 36540, "Input", "ExpressionUUID" -> \
"2bce2fe8-ae4e-4be8-af67-e67a049a3095",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[140387, 2915, 166, 3, 26, "Subsubsection", "ExpressionUUID" -> \
"77c0b875-dc9c-4137-891a-c877b3818f17"],
Cell[140556, 2920, 2714, 58, 2147483647, "Input", "ExpressionUUID" -> \
"5f1fadbd-1e2b-44cd-ae4f-a2ecba61587d",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[143307, 2983, 215, 4, 26, "Subsubsection", "ExpressionUUID" -> \
"0d845cc3-1bbe-4552-a3cb-bc0db3cb80c9"],
Cell[143525, 2989, 2943, 63, 2147483647, "Input", "ExpressionUUID" -> \
"0e1d50dc-1ff0-4537-906b-84d626c41635",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[146517, 3058, 199, 4, 33, "Subtitle", "ExpressionUUID" -> \
"ea186c1e-18a5-490d-b302-ce08b98d311f"],
Cell[CellGroupData[{
Cell[146741, 3066, 165, 3, 37, "Subsubsection", "ExpressionUUID" -> \
"fc29c71d-e3a2-43a2-b20f-8cf3b2b045cc"],
Cell[146909, 3071, 5016, 129, 2147483647, "Input", "ExpressionUUID" -> \
"5ac3a6ed-ee6f-41c6-833b-33180ac5b8e4",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[151962, 3205, 178, 3, 63, "Section", "ExpressionUUID" -> \
"60062061-bfea-49f3-a118-1f432871b2a4"],
Cell[152143, 3210, 1070, 30, 2147483647, "Input", "ExpressionUUID" -> \
"6c044596-20ae-448c-927a-f3e22ff5baac",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[153250, 3245, 152, 3, 63, "Section", "ExpressionUUID" -> \
"d4e5cfe1-bd05-4da9-b220-b760b264f5ce"],
Cell[CellGroupData[{
Cell[153427, 3252, 163, 3, 43606, "Subsection", "ExpressionUUID" -> \
"c291e662-420d-407f-8835-abe1de2acb5d"],
Cell[153593, 3257, 580, 16, 68485, "Input", "ExpressionUUID" -> \
"b6e36904-6a47-4e17-ad0d-2c06970a808c",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[154210, 3278, 158, 3, 43606, "Subsection", "ExpressionUUID" -> \
"fef76b5c-27ca-49ec-a700-19b027634fe6"],
Cell[154371, 3283, 405, 12, 2147483647, "Input", "ExpressionUUID" -> \
"13fe91e7-5478-4a17-91c8-9f34c20d1cf4",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[154813, 3300, 232, 4, 31983, "Subsection", "ExpressionUUID" -> \
"cd02afec-f6d2-4310-9e4d-f1b06ae642c1"],
Cell[155048, 3306, 2688, 83, 2147483647, "Input", "ExpressionUUID" -> \
"a41cd6c8-69ca-4b54-9cc7-a785a3347882",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[157773, 3394, 156, 3, 31983, "Subsection", "ExpressionUUID" -> \
"d79375ca-9d13-409c-8e49-377168f5e940"],
Cell[157932, 3399, 342, 10, 2147483647, "Input", "ExpressionUUID" -> \
"3601b1ca-e27f-4232-a707-9618c6754d5f",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[158311, 3414, 189, 3, 31983, "Subsection", "ExpressionUUID" -> \
"9eca98d9-ce7c-4491-9c50-0048b80ff7ec"],
Cell[158503, 3419, 1004, 25, 2147483647, "Input", "ExpressionUUID" -> \
"ee486556-ad4d-48b6-8126-542184a6b37d",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[159544, 3449, 156, 3, 31983, "Subsection", "ExpressionUUID" -> \
"14edb4cd-4acf-4455-aeed-a53790d59572"],
Cell[159703, 3454, 631, 14, 2147483647, "Input", "ExpressionUUID" -> \
"c2da9407-c5ed-4ae4-b9d6-7eddb4d8de88",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[160371, 3473, 210, 4, 31983, "Subsection", "ExpressionUUID" -> \
"5ccc7464-7d4b-46af-9465-10bff3462b86"],
Cell[160584, 3479, 3693, 85, 2147483647, "Input", "ExpressionUUID" -> \
"962f680e-01d6-47a1-9877-6bd0f81ad3a0",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[164302, 3568, 163, 3, 2147483647, "Subsubsection", "ExpressionUUID" -> \
"aefec1df-b4f6-4d2a-a0fe-e18dfd95191d"],
Cell[164468, 3573, 161, 3, 2147483647, "Text", "ExpressionUUID" -> \
"9edbde67-4d87-4cfc-aa0e-444083c8ef68"],
Cell[164632, 3578, 3429, 97, 2147483647, "Input", "ExpressionUUID" -> \
"9dfed5d2-2797-469b-9a2a-5f167b909636",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[168110, 3681, 160, 3, 31983, "Subsection", "ExpressionUUID" -> \
"af1df55e-c557-40b4-bacc-f2b130cb4a9d"],
Cell[168273, 3686, 883, 25, 2147483647, "Input", "ExpressionUUID" -> \
"b33a576e-46da-4e19-b1da-c286ef4ce13e",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[169193, 3716, 152, 3, 31983, "Subsection", "ExpressionUUID" -> \
"6f90126b-ec09-4950-bd8e-469986e2af8c"],
Cell[169348, 3721, 873, 25, 2147483647, "Input", "ExpressionUUID" -> \
"4c639142-3c27-40ce-b097-1e11d880a2bd",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[170258, 3751, 155, 3, 31983, "Subsection", "ExpressionUUID" -> \
"174cae2f-b40d-47c2-af74-893c4a17d708"],
Cell[170416, 3756, 2715, 63, 2147483647, "Input", "ExpressionUUID" -> \
"b0449264-e339-4457-8b82-dc19263ff56d",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[173168, 3824, 274, 5, 31983, "Subsection", "ExpressionUUID" -> \
"7fcfa019-b385-41ac-b15b-10dcb8480377"],
Cell[173445, 3831, 304, 9, 2147483647, "Input", "ExpressionUUID" -> \
"5b1e9899-f6c7-440c-8e9b-e4d0c2e74c66",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[173786, 3845, 298, 5, 31983, "Subsection", "ExpressionUUID" -> \
"2c493b6b-b2f2-4d89-a793-dd7793d69b18"],
Cell[174087, 3852, 2493, 69, 2147483647, "Input", "ExpressionUUID" -> \
"fa994547-4942-4563-bc7e-7fec1195aaef",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[176617, 3926, 166, 3, 31983, "Subsection", "ExpressionUUID" -> \
"6f5a8712-2a9f-4351-bca9-12b8abd7f1bd"],
Cell[176786, 3931, 337, 7, 59980, "Text", "ExpressionUUID" -> \
"eb75b3d6-cde1-4092-a944-4d4bdba9cf59"],
Cell[177126, 3940, 1929, 45, 357777, "Input", "ExpressionUUID" -> \
"b69dd458-2339-49c8-851e-d4d3f4b72c82",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[179092, 3990, 164, 3, 31983, "Subsection", "ExpressionUUID" -> \
"86b4142b-6587-4970-8e40-46bfc3bff14b"],
Cell[179259, 3995, 1803, 42, 268636, "Input", "ExpressionUUID" -> \
"b40d29d2-00a8-40f1-8464-3b408436a7c7",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[181099, 4042, 219, 4, 31983, "Subsection", "ExpressionUUID" -> \
"7bf31552-4f6b-491b-ac39-f5c1a4c437d5"],
Cell[181321, 4048, 1810, 45, 2147483647, "Input", "ExpressionUUID" -> \
"32a06456-c30e-444d-81ad-1660d6c3dfe6",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[183168, 4098, 162, 3, 31983, "Subsection", "ExpressionUUID" -> \
"0733a711-7d14-456f-84ba-1cff0d3d2973"],
Cell[183333, 4103, 2838, 71, 2147483647, "Input", "ExpressionUUID" -> \
"4adebb37-27fa-4045-be10-3980cebd21bc",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[186208, 4179, 159, 3, 31983, "Subsection", "ExpressionUUID" -> \
"562475cd-68b1-498a-834f-770cd1a09631"],
Cell[186370, 4184, 506, 16, 2147483647, "Input", "ExpressionUUID" -> \
"83b21852-0017-486c-9672-bdc0b4821135",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[186913, 4205, 154, 3, 31983, "Subsection", "ExpressionUUID" -> \
"2582523c-2952-4123-bcc2-f0bb635c0208"],
Cell[187070, 4210, 422, 12, 737997165, "Input", "ExpressionUUID" -> \
"d2da5ecc-ddc2-4ee7-aeec-cd954136d1d9",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[187529, 4227, 163, 3, 31983, "Subsection", "ExpressionUUID" -> \
"1d4d03f8-83c7-4b2d-aee5-0e11e5e5ca24"],
Cell[187695, 4232, 2486, 71, 2147483647, "Input", "ExpressionUUID" -> \
"fc08534e-88ef-4e6c-ac0f-b347a64a4f36",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[190218, 4308, 157, 3, 31983, "Subsection", "ExpressionUUID" -> \
"5d75aeba-c7ad-4f34-87ac-5a28a405d4f0"],
Cell[190378, 4313, 289, 7, 2147483647, "Text", "ExpressionUUID" -> \
"07ace70e-37e2-42b4-af9b-61eb6cbcc084"],
Cell[190670, 4322, 2254, 61, 2147483647, "Input", "ExpressionUUID" -> \
"d4e0c8af-39ce-42d6-88ba-56b4aeb8897d",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[192973, 4389, 201, 4, 63, "Section", "ExpressionUUID" -> \
"65920b74-659a-45a1-a367-0fce37e4b369"],
Cell[CellGroupData[{
Cell[193199, 4397, 156, 3, 2147483647, "Subsection", "ExpressionUUID" -> \
"2f89121c-84ff-4294-8024-c90570bdd9ee"],
Cell[193358, 4402, 1565, 44, 2147483647, "Input", "ExpressionUUID" -> \
"30dba2af-d11f-4410-8e8a-60eab52ae770",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[194960, 4451, 154, 3, 2147483647, "Subsection", "ExpressionUUID" -> \
"dd5cdea7-ad2f-4e94-9b07-6a1d0fc20aaa"],
Cell[195117, 4456, 673, 20, 2147483647, "Input", "ExpressionUUID" -> \
"efb96ded-e14b-4717-902d-84b1631275ac",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[195827, 4481, 158, 3, 2147483647, "Subsection", "ExpressionUUID" -> \
"151bf860-fc85-41cd-b0ff-107dff72380a"],
Cell[195988, 4486, 1066, 30, 2147483647, "Input", "ExpressionUUID" -> \
"d344e6f4-b739-469e-9256-3487b3f96a80",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[197091, 4521, 210, 4, 2147483647, "Subsection", "ExpressionUUID" -> \
"13e2db22-daed-4527-87bf-6457dcc7051b"],
Cell[197304, 4527, 2673, 79, 2147483647, "Input", "ExpressionUUID" -> \
"4be517c8-d3d6-4bf8-9b74-cd670f8a4f95",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[200014, 4611, 159, 3, 2147483647, "Subsection", "ExpressionUUID" -> \
"e6259a53-6769-4f6b-9969-2cc823641ca4"],
Cell[200176, 4616, 481, 13, 2147483647, "Input", "ExpressionUUID" -> \
"83eae8a8-62fc-45b0-84c5-6abd056372ef",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[200694, 4634, 166, 3, 2147483647, "Subsection", "ExpressionUUID" -> \
"b027c45c-52c1-4d62-9c73-ad49d5ac2465"],
Cell[200863, 4639, 324, 8, 2147483647, "Text", "ExpressionUUID" -> \
"73b86e53-3173-4c60-af12-8ba75b6e0d6c"],
Cell[201190, 4649, 6230, 155, 2147483647, "Input", "ExpressionUUID" -> \
"1114850e-7fd8-4b1b-aace-c97a0e34bb2b",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[207469, 4810, 175, 3, 63, "Section", "ExpressionUUID" -> \
"b261906f-67c2-4a68-81e1-eaa327454fbe"],
Cell[CellGroupData[{
Cell[207669, 4817, 155, 3, 2147483647, "Subsection", "ExpressionUUID" -> \
"a5e0e0b8-ac98-458d-a60c-75e578c804b8"],
Cell[207827, 4822, 2243, 60, 2147483647, "Input", "ExpressionUUID" -> \
"e691472c-112e-4b2d-a193-5d203ff04bcc",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[210107, 4887, 158, 3, 2147483647, "Subsection", "ExpressionUUID" -> \
"f6213cc8-9581-4f3e-96b2-c681dfce95e9"],
Cell[210268, 4892, 223, 5, 2147483647, "Text", "ExpressionUUID" -> \
"72b93a44-9106-41b1-b869-f623f6203838"],
Cell[210494, 4899, 6512, 155, 2147483647, "Input", "ExpressionUUID" -> \
"ceaa73c1-3a30-4997-abbe-a1fd8b24cab9",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[217043, 5059, 158, 3, 2147483647, "Subsection", "ExpressionUUID" -> \
"4d6ac615-8d34-4319-96b5-56ffe2392500"],
Cell[217204, 5064, 1520, 29, 2147483647, "Text", "ExpressionUUID" -> \
"f95607c4-cd61-4ce1-898e-92a6ce13ea13"],
Cell[218727, 5095, 2875, 68, 2147483647, "Input", "ExpressionUUID" -> \
"8cad2cb5-996b-4d8e-95da-e6f145649424",
 InitializationCell->True],
Cell[221605, 5165, 49299, 1062, 2147483647, "Input", "ExpressionUUID" -> \
"21573d01-9514-4fd4-9b97-795865fbdc16",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[270929, 6231, 168, 3, 2147483647, "Subsubsection", "ExpressionUUID" -> \
"c1aee495-843d-4b37-b763-98ea30daee36"],
Cell[271100, 6236, 487, 14, 2147483647, "Input", "ExpressionUUID" -> \
"19019aa6-7af7-4f12-9ec7-5f2d24400ae4",
 InitializationCell->True]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[271636, 6256, 231, 4, 2147483647, "Subsection", "ExpressionUUID" -> \
"288e3968-0d25-4763-93b0-38fbecab9628"],
Cell[271870, 6262, 2247, 60, 2147483647, "Input", "ExpressionUUID" -> \
"c8c2a5f1-e58d-49bc-bb6c-eb5e3b60875f",
 InitializationCell->True],
Cell[274120, 6324, 5914, 153, 2147483647, "Input", "ExpressionUUID" -> \
"3973617a-3b9f-4aba-a0d7-6090434dc0d2",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[280071, 6482, 139, 3, 2147483647, "Subsection", "ExpressionUUID" -> \
"b95531cd-7cb1-4842-9030-e9b4cf4d8e18"],
Cell[280213, 6487, 4259, 103, 2147483647, "Input", "ExpressionUUID" -> \
"75793ca0-6622-44f5-8c6b-acf6dd8393c2",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[284509, 6595, 165, 3, 2147483647, "Subsection", "ExpressionUUID" -> \
"94f9ebbd-b623-409a-9ba3-dafd0ab36231"],
Cell[284677, 6600, 344, 5, 2147483647, "Text", "ExpressionUUID" -> \
"894ef992-9503-4145-becd-f79abb134640"],
Cell[285024, 6607, 2413, 56, 2147483647, "Input", "ExpressionUUID" -> \
"fa22c944-8215-4b70-b3fd-add5cbe37c7e",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[287474, 6668, 168, 3, 2147483647, "Subsection", "ExpressionUUID" -> \
"8e0e4d6e-486c-4371-add7-3474342bedfa"],
Cell[287645, 6673, 2148, 57, 2147483647, "Input", "ExpressionUUID" -> \
"367825e0-d016-4c02-87e9-10f57a551943",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[289830, 6735, 158, 3, 2147483647, "Subsection", "ExpressionUUID" -> \
"a8c948e2-e6cf-4921-885d-e5af3df4d3e7"],
Cell[289991, 6740, 269, 6, 2147483647, "Text", "ExpressionUUID" -> \
"2b1d2790-557a-422b-9be2-38e52d72a19e"],
Cell[290263, 6748, 853, 26, 2147483647, "Input", "ExpressionUUID" -> \
"0439463d-1e08-45cb-9e8c-e6c5a28d1607",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[291165, 6780, 153, 3, 63, "Section", "ExpressionUUID" -> \
"60d40666-d85c-423f-89d5-793c1a48906e"],
Cell[CellGroupData[{
Cell[291343, 6787, 230, 4, 6702, "Subsection", "ExpressionUUID" -> \
"5c2f2ae3-f28d-46f2-a345-dc3b43ed822f"],
Cell[291576, 6793, 414, 12, 2147483647, "Input", "ExpressionUUID" -> \
"fcb9bdd3-6647-48a9-afa9-7c9920f32a5b",
 InitializationCell->True],
Cell[291993, 6807, 2353, 62, 2147483647, "Input", "ExpressionUUID" -> \
"fa4f30ec-b587-4086-bf60-570ff5f4b90a",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[294383, 6874, 157, 3, 4860, "Subsection", "ExpressionUUID" -> \
"6979c1e3-01ad-4ceb-842c-58097b6e890a"],
Cell[294543, 6879, 213, 4, 5679, "Text", "ExpressionUUID" -> \
"b2b4449c-8bad-4a04-866f-0ba98436fe11"],
Cell[294759, 6885, 6386, 149, 144072, "Input", "ExpressionUUID" -> \
"bdf32782-5076-4da4-a6eb-0c00fb480fba",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[301182, 7039, 154, 3, 4860, "Subsection", "ExpressionUUID" -> \
"3b57b968-1736-4546-821d-403dd81a03d5"],
Cell[301339, 7044, 163, 3, 2147483647, "Text", "ExpressionUUID" -> \
"6b320b84-c60b-4095-a441-5c8b4ea87be0"],
Cell[301505, 7049, 1393, 34, 2147483647, "Input", "ExpressionUUID" -> \
"2b6d37c4-7fab-49ad-a305-36a96da06302",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[302935, 7088, 165, 3, 4860, "Subsection", "ExpressionUUID" -> \
"6635f162-a16b-4f2a-99d1-2945aeb976b0"],
Cell[303103, 7093, 3446, 88, 2147483647, "Input", "ExpressionUUID" -> \
"7edbdd49-9728-4c39-825c-d4e0b37fa006",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[306598, 7187, 151, 3, 63, "Section", "ExpressionUUID" -> \
"2c758c77-8eb3-45ec-8d40-b6ceedf00a77"],
Cell[CellGroupData[{
Cell[306774, 7194, 236, 4, 883, "Subsection", "ExpressionUUID" -> \
"5ac4a78b-31d6-4733-a884-0aad6b2c7411"],
Cell[307013, 7200, 2669, 75, 60688, "Input", "ExpressionUUID" -> \
"94e60b2f-58a9-4cdf-a6cd-f41088b7b4b1",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[309719, 7280, 208, 4, 640, "Subsection", "ExpressionUUID" -> \
"90fa0851-c058-412f-bc90-a496e9704645"],
Cell[309930, 7286, 3458, 97, 2147483647, "Input", "ExpressionUUID" -> \
"94e53764-816e-436e-b02d-c15230631a3d",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[313425, 7388, 161, 3, 640, "Subsection", "ExpressionUUID" -> \
"ab1137b8-fd2e-4c3d-a7e7-124d7091772b"],
Cell[313589, 7393, 8220, 216, 2147483647, "Input", "ExpressionUUID" -> \
"689e9f4c-6407-478c-b37e-215a24a4a488",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[321846, 7614, 151, 3, 640, "Subsection", "ExpressionUUID" -> \
"54394051-ebfc-4790-9e6d-26717eb11d19"],
Cell[322000, 7619, 3918, 113, 2147483647, "Input", "ExpressionUUID" -> \
"34909300-ffde-4400-bd78-976da6170d16",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[325955, 7737, 225, 4, 640, "Subsection", "ExpressionUUID" -> \
"4cce845c-2238-4c39-af47-532c765cdabd"],
Cell[326183, 7743, 4274, 115, 15403, "Input", "ExpressionUUID" -> \
"032ebb94-cd73-40ad-a856-6876c5bac9e0",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[330494, 7863, 165, 3, 640, "Subsection", "ExpressionUUID" -> \
"e364f237-72e8-49c0-9d7b-9952c2a14687"],
Cell[330662, 7868, 2381, 60, 44604, "Input", "ExpressionUUID" -> \
"42f74a92-3087-48b6-b2ca-d36bb8f44168",
 InitializationCell->True],
Cell[333046, 7930, 2968, 76, 56592, "Input", "ExpressionUUID" -> \
"7a6a1788-77e6-4bb1-b509-a1c26a36390d",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[336051, 8011, 156, 3, 640, "Subsection", "ExpressionUUID" -> \
"05f3564f-d678-4671-94b1-0d26e941ca88"],
Cell[336210, 8016, 8732, 232, 173319, "Input", "ExpressionUUID" -> \
"38d42d55-823b-4a0b-88fb-272ec9738f0b",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[344979, 8253, 157, 3, 640, "Subsection", "ExpressionUUID" -> \
"f225e097-f678-4d36-9bf5-5bfaabfc0676"],
Cell[345139, 8258, 2098, 52, 2147483647, "Input", "ExpressionUUID" -> \
"ddec6e2d-4ce1-41b0-82e2-1417ca0841b7",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[347274, 8315, 166, 3, 640, "Subsection", "ExpressionUUID" -> \
"19181caa-74e4-46ef-9986-851deae058da"],
Cell[347443, 8320, 2845, 72, 2147483647, "Input", "ExpressionUUID" -> \
"570b9fde-695b-4f8e-85d5-88799ceaee67",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[350325, 8397, 164, 3, 640, "Subsection", "ExpressionUUID" -> \
"89185236-9c8c-4f63-b714-85b20377cd51"],
Cell[350492, 8402, 882, 25, 20440, "Input", "ExpressionUUID" -> \
"7e123abc-8da7-4785-b3c0-6a3562bbf519",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[351411, 8432, 238, 4, 640, "Subsection", "ExpressionUUID" -> \
"2c061600-108f-424c-80f1-3445a171647d"],
Cell[351652, 8438, 3049, 86, 84789, "Input", "ExpressionUUID" -> \
"110a1639-86c4-468c-abae-9b34082632e1",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[354738, 8529, 166, 3, 640, "Subsection", "ExpressionUUID" -> \
"462839ad-5d26-4fde-87ca-5ef08a9cf72b"],
Cell[354907, 8534, 3259, 87, 84789, "Input", "ExpressionUUID" -> \
"2583c168-9489-4d5f-968d-a90004a7b2b4",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[358203, 8626, 153, 3, 640, "Subsection", "ExpressionUUID" -> \
"2b98e7fb-2dde-45ce-9209-7e9bcd46eab2"],
Cell[358359, 8631, 6761, 176, 2147483647, "Input", "ExpressionUUID" -> \
"98341632-575d-4aa6-aaa9-07edf3172d58",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[365157, 8812, 157, 3, 640, "Subsection", "ExpressionUUID" -> \
"baf960bc-0bed-4ddc-90aa-3f4dbd26bdfc"],
Cell[365317, 8817, 192, 3, 2147483647, "Text", "ExpressionUUID" -> \
"da81c5e4-efca-4537-8efb-f763146a84c3"],
Cell[365512, 8822, 1352, 36, 2147483647, "Input", "ExpressionUUID" -> \
"347026c9-1c41-4e6e-891a-e41ad461ba19",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[366901, 8863, 159, 3, 640, "Subsection", "ExpressionUUID" -> \
"bffd3f36-a5a9-4488-b20f-203460896790"],
Cell[367063, 8868, 369, 8, 2147483647, "Text", "ExpressionUUID" -> \
"6bc86ef3-6983-45fc-8742-d25538136b3e"],
Cell[367435, 8878, 8203, 198, 2147483647, "Input", "ExpressionUUID" -> \
"5ffec901-fb22-4f1e-95e2-e62ba51cd061",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[375675, 9081, 166, 3, 640, "Subsection", "ExpressionUUID" -> \
"4c7bc802-9c85-4137-95a9-ddabbf3d4a1f"],
Cell[375844, 9086, 377, 8, 2147483647, "Text", "ExpressionUUID" -> \
"f80ce5bb-09bb-443c-9e24-6f80636955de"],
Cell[376224, 9096, 3701, 94, 2147483647, "Input", "ExpressionUUID" -> \
"6e9424d2-a825-4c11-8328-4823048e260b",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[379962, 9195, 158, 3, 640, "Subsection", "ExpressionUUID" -> \
"c755b0df-37d4-4e16-b2b6-1e11d51e6183"],
Cell[380123, 9200, 2819, 73, 76789, "Input", "ExpressionUUID" -> \
"812fcdbf-63db-41d3-8cfe-00ec1ab66635",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[382979, 9278, 168, 3, 640, "Subsection", "ExpressionUUID" -> \
"8bc32a26-7619-4d9f-acd3-90e5bfceadc3"],
Cell[383150, 9283, 635, 12, 2147483647, "Text", "ExpressionUUID" -> \
"00d40cd5-2cd7-47b9-bc7a-f2a8027266d8"],
Cell[383788, 9297, 12745, 318, 2147483647, "Input", "ExpressionUUID" -> \
"7be5a116-619c-4248-8560-c6bf4f6b4257",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[396570, 9620, 165, 3, 640, "Subsection", "ExpressionUUID" -> \
"190d1f79-ceaa-4eb4-bf1b-57e886454a6b"],
Cell[396738, 9625, 4477, 108, 2147483647, "Input", "ExpressionUUID" -> \
"c1997126-f1f7-4b83-bae7-f44544a25ee2",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[401252, 9738, 152, 3, 640, "Subsection", "ExpressionUUID" -> \
"392b9368-81ae-45b3-97ea-a8fd335ec2ff"],
Cell[401407, 9743, 510, 13, 2147483647, "Input", "ExpressionUUID" -> \
"85bf200e-31f7-4f84-a714-792a6ff25cd1",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[401954, 9761, 215, 4, 640, "Subsection", "ExpressionUUID" -> \
"820da3e6-4b5c-45ad-b033-9f7e2c01e86c"],
Cell[402172, 9767, 496, 10, 25397772, "Text", "ExpressionUUID" -> \
"3c799434-f470-4ce0-a634-86b488d7e188"],
Cell[402671, 9779, 1993, 47, 71084701, "Input", "ExpressionUUID" -> \
"d2d51b4c-312a-4d9b-b0e7-2463560ed01e",
 InitializationCell->True],
Cell[404667, 9828, 257, 6, 8757843, "Text", "ExpressionUUID" -> \
"16da5388-9b49-4696-8c7e-631685fb9a92"],
Cell[404927, 9836, 14183, 321, 476136550, "Input", "ExpressionUUID" -> \
"c24958be-e496-4fbb-8241-0fd964babca1",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[419147, 10162, 230, 4, 640, "Subsection", "ExpressionUUID" -> \
"c0d75ced-61a1-4ee6-bb50-06398ba61425"],
Cell[419380, 10168, 2435, 73, 2147483647, "Input", "ExpressionUUID" -> \
"a01fa62a-12d1-43bf-898e-77b352f41c64",
 InitializationCell->True],
Cell[421818, 10243, 9747, 230, 2147483647, "Input", "ExpressionUUID" -> \
"d3694e8b-c072-4149-b9cc-d9a409b61e7f",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[431602, 10478, 156, 3, 640, "Subsection", "ExpressionUUID" -> \
"72b65e62-274e-4d5e-93f3-8eaece8be182"],
Cell[431761, 10483, 5679, 152, 2147483647, "Input", "ExpressionUUID" -> \
"c496faf8-6394-4c4b-809d-5496c188a640",
 InitializationCell->True],
Cell[437443, 10637, 80, 0, 2147483647, "Subsubsection", "ExpressionUUID" -> \
"3e95eccc-6a72-4152-a147-712cb1d47ad0"]
}, Closed]],
Cell[CellGroupData[{
Cell[437560, 10642, 142, 3, 640, "Subsection", "ExpressionUUID" -> \
"dc483cf7-eaa4-48b9-bc0e-455511412e9d"],
Cell[437705, 10647, 797, 15, 36661, "Text", "ExpressionUUID" -> \
"774c8e21-2c74-40db-88a7-c0d25de4ea33"],
Cell[438505, 10664, 3293, 90, 72676, "Input", "ExpressionUUID" -> \
"7c742fc1-5a80-49b8-b682-dd242002197d",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[441835, 10759, 161, 3, 640, "Subsection", "ExpressionUUID" -> \
"7d5a516d-9912-4b04-9e91-43bcc3ba6cc6"],
Cell[441999, 10764, 247, 6, 2147483647, "Text", "ExpressionUUID" -> \
"43ad2970-4ae6-4a0b-b5c4-4c2d076afa00"],
Cell[442249, 10772, 5647, 138, 2147483647, "Input", "ExpressionUUID" -> \
"649e56b9-5bd0-47ad-9143-10c5b4256504",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[447933, 10915, 292, 4, 640, "Subsection", "ExpressionUUID" -> \
"dfc5647d-de2d-4429-a22c-c9e63dd3cef9"],
Cell[448228, 10921, 6734, 165, 145099, "Input", "ExpressionUUID" -> \
"9fa061bb-16eb-4183-945f-8d734ebe06d4",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[455011, 11092, 168, 3, 63, "Section", "ExpressionUUID" -> \
"b3a55a39-087e-4b6a-8bd8-0804e09d5518"],
Cell[CellGroupData[{
Cell[455204, 11099, 279, 4, 117, "Subsection", "ExpressionUUID" -> \
"0515f781-6d43-40f0-a4f1-aa96a1fc0a7d"],
Cell[455486, 11105, 1191, 37, 2147483647, "Input", "ExpressionUUID" -> \
"58651802-23ad-4e4e-98c7-758c346c3678",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[456714, 11147, 224, 4, 85, "Subsection", "ExpressionUUID" -> \
"c87b0ec4-65e3-41db-916c-5fdf9c383751"],
Cell[456941, 11153, 1359, 35, 951, "Input", "ExpressionUUID" -> \
"4e529ad1-d31b-4772-a93d-677ab63c55f0",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[458337, 11193, 156, 3, 85, "Subsection", "ExpressionUUID" -> \
"a83906a5-45d6-475a-9801-6f259d317158"],
Cell[458496, 11198, 909, 25, 427, "Input", "ExpressionUUID" -> \
"266e280b-6140-40ad-a2c6-f8496a6ec2c8",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[459442, 11228, 202, 4, 85, "Subsection", "ExpressionUUID" -> \
"93562c25-ee68-48bb-bc07-d3ef6d81ee9a"],
Cell[459647, 11234, 651, 13, 29769, "Text", "ExpressionUUID" -> \
"0464fc59-b739-4f05-b364-8b21081f2ccd"],
Cell[460301, 11249, 3488, 98, 72676, "Input", "ExpressionUUID" -> \
"3c4b5b8e-3a15-4b10-aa18-1df0f18d69e2",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[463826, 11352, 162, 3, 85, "Subsection", "ExpressionUUID" -> \
"083d469f-8fa7-4ae4-835e-356a7fa2373b"],
Cell[463991, 11357, 245, 6, 5679, "Text", "ExpressionUUID" -> \
"ddf5fbb2-16ec-4380-adda-39229189a64f"],
Cell[464239, 11365, 2431, 68, 48588, "Input", "ExpressionUUID" -> \
"18d3abb6-4da0-46e5-b791-ba7fefabc058",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[466707, 11438, 164, 3, 85, "Subsection", "ExpressionUUID" -> \
"95759bec-7baa-47e4-b96c-372593200af5"],
Cell[466874, 11443, 1379, 32, 99963, "Text", "ExpressionUUID" -> \
"7265fbf1-9858-44fa-90a4-187c26509836"],
Cell[468256, 11477, 1997, 50, 126090, "Input", "ExpressionUUID" -> \
"1655effe-5dc8-417a-9933-2f04e3637b3f",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[470290, 11532, 161, 3, 85, "Subsection", "ExpressionUUID" -> \
"6f26c7d1-6be0-47d1-a8b7-e946a87b9be4"],
Cell[470454, 11537, 1728, 42, 1161, "Input", "ExpressionUUID" -> \
"663675cd-5ddd-44ec-bd41-36f8bb18e487",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[472219, 11584, 159, 3, 85, "Subsection", "ExpressionUUID" -> \
"cf92fcf1-f91e-498a-a49f-842d7ee27999"],
Cell[472381, 11589, 892, 25, 2147483647, "Input", "ExpressionUUID" -> \
"426ac368-6252-4cd0-bde6-476bdcf503f4",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[473310, 11619, 163, 3, 85, "Subsection", "ExpressionUUID" -> \
"b34e7cc1-e4a8-46de-bf77-aa407a9ec7d8"],
Cell[473476, 11624, 1125, 31, 2147483647, "Input", "ExpressionUUID" -> \
"6c6d6087-e8a4-4ae3-a9ec-9c435b18ab93",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[474638, 11660, 158, 3, 85, "Subsection", "ExpressionUUID" -> \
"231bee83-f2f9-4214-a102-444c3e53ef21"],
Cell[474799, 11665, 8456, 204, 2147483647, "Input", "ExpressionUUID" -> \
"627c521f-3a93-4de2-b373-a7873d03172b",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[483304, 11875, 158, 3, 63, "Section", "ExpressionUUID" -> \
"938ef006-6605-4991-8cb8-8db0639000ae"],
Cell[CellGroupData[{
Cell[483487, 11882, 210, 3, 6702, "Subsection", "ExpressionUUID" -> \
"e27c7728-7983-459c-84a9-ad27f8422c7e"],
Cell[483700, 11887, 424, 8, 2147483647, "Text", "ExpressionUUID" -> \
"e96d336d-13d1-4715-bdc6-539c638ac630"],
Cell[484127, 11897, 4922, 127, 2147483647, "Input", "ExpressionUUID" -> \
"c6eeec6b-bbef-42c4-aa71-3587ca32c1b3",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[489086, 12029, 182, 3, 4860, "Subsection", "ExpressionUUID" -> \
"564b459d-1c5c-429d-874d-3025019b188d"],
Cell[489271, 12034, 741, 19, 13528, "Text", "ExpressionUUID" -> \
"684242c2-6ef0-453f-a82f-883ba2899059"],
Cell[490015, 12055, 2558, 69, 48295, "Input", "ExpressionUUID" -> \
"012b244d-868b-4564-8255-6f2ea191da14",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[492610, 12129, 162, 3, 6702, "Subsection", "ExpressionUUID" -> \
"bd28ae30-7169-47dc-9f04-2825cbedd895"],
Cell[492775, 12134, 3431, 80, 2147483647, "Input", "ExpressionUUID" -> \
"e4ed3dd4-8b3f-4c7d-947e-c22a98157b14",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[496243, 12219, 164, 3, 4860, "Subsection", "ExpressionUUID" -> \
"e748bae3-63f5-4d87-84c4-fdfee0d1b12f"],
Cell[496410, 12224, 323, 7, 2147483647, "Text", "ExpressionUUID" -> \
"c221b7fa-7d30-4f59-839e-3b20b375a987"],
Cell[496736, 12233, 30443, 685, 2147483647, "Input", "ExpressionUUID" -> \
"c93ba093-46ef-49b5-81da-811d16a36e94",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[527228, 12924, 152, 3, 63, "Section", "ExpressionUUID" -> \
"50ce2120-c178-4ae4-9bb3-455b74ca1bfd"],
Cell[CellGroupData[{
Cell[527405, 12931, 204, 4, 175, "Subsection", "ExpressionUUID" -> \
"d09f2eed-871b-41d1-b50d-3c0e39ca3dff"],
Cell[527612, 12937, 775, 17, 2147483647, "Input", "ExpressionUUID" -> \
"777e830a-2e92-43dc-b40d-b29a70ddad90",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[528424, 12959, 162, 3, 127, "Subsection", "ExpressionUUID" -> \
"3bb17198-c705-4b5b-b9ff-e56d1cec992a"],
Cell[528589, 12964, 394, 10, 2147483647, "Input", "ExpressionUUID" -> \
"0cf67fe9-120c-4ae5-bcc5-ed6903ccb5e0",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[529020, 12979, 249, 4, 127, "Subsection", "ExpressionUUID" -> \
"bc13dc1a-2469-4bed-be5a-f3babac73080"],
Cell[529272, 12985, 5317, 152, 2147483647, "Input", "ExpressionUUID" -> \
"3458ef91-29fe-4bb3-ae68-06afbffe5de9",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[534626, 13142, 242, 4, 127, "Subsection", "ExpressionUUID" -> \
"98e83a10-2c5a-41ac-8d0e-4d93bfc36707"],
Cell[534871, 13148, 1416, 39, 2147483647, "Input", "ExpressionUUID" -> \
"a4064c76-3fe4-4616-9475-c4dd4e68bd96",
 InitializationCell->True],
Cell[536290, 13189, 1659, 46, 2147483647, "Input", "ExpressionUUID" -> \
"5b116982-84b5-492e-97ab-d34eade8e503",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[537986, 13240, 276, 4, 127, "Subsection", "ExpressionUUID" -> \
"9bd2f52c-1c68-4b65-befd-b73a97279f92"],
Cell[538265, 13246, 223, 5, 2189418, "Text", "ExpressionUUID" -> \
"9bd0912a-7590-4508-9126-2417d2dc16fa"],
Cell[538491, 13253, 1814, 43, 20471341, "Input", "ExpressionUUID" -> \
"bc842eef-7285-4268-a5e5-2d3426974163",
 InitializationCell->True],
Cell[540308, 13298, 704, 20, 6969633, "Input", "ExpressionUUID" -> \
"b0c610e3-8a0a-4032-b2f6-02e413a3e4ff",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[541049, 13323, 241, 4, 127, "Subsection", "ExpressionUUID" -> \
"03e2d32d-d8a2-454f-92b6-a08c016fa02f"],
Cell[541293, 13329, 242, 5, 2147483647, "Text", "ExpressionUUID" -> \
"4ba4ded4-2034-4a6c-8d17-1b7aa3479f10"],
Cell[541538, 13336, 3061, 74, 2147483647, "Input", "ExpressionUUID" -> \
"a1783b0f-3db9-47a5-8fed-6ac75d62f43b",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[544636, 13415, 230, 4, 127, "Subsection", "ExpressionUUID" -> \
"67851bf7-285c-41a5-8ed0-1ffe18089016"],
Cell[544869, 13421, 7357, 178, 2147483647, "Input", "ExpressionUUID" -> \
"dc141b50-45e2-43fb-9be7-20302da8f811",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[552263, 13604, 177, 3, 127, "Subsection", "ExpressionUUID" -> \
"70418ce3-b55a-4e32-9ce0-f19c56aabf8a"],
Cell[552443, 13609, 8159, 224, 2147483647, "Input", "ExpressionUUID" -> \
"06375f2a-f069-425b-88a0-793be17abcbc",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[560639, 13838, 178, 3, 127, "Subsection", "ExpressionUUID" -> \
"d3ce5bc5-2299-4753-bba4-1acfbd68fb5a"],
Cell[560820, 13843, 957, 25, 2147483647, "Input", "ExpressionUUID" -> \
"1fe73ec6-2a49-4805-b25d-f3a5f5708ab8",
 InitializationCell->True],
Cell[561780, 13870, 5390, 145, 2147483647, "Input", "ExpressionUUID" -> \
"bb21435c-ab4d-469e-b27f-15667f0429c3",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[567207, 14020, 159, 3, 127, "Subsection", "ExpressionUUID" -> \
"8030b3a2-e261-4a8d-8626-1728e7e881ce"],
Cell[567369, 14025, 15795, 360, 2147483647, "Input", "ExpressionUUID" -> \
"d3244706-cfb1-4b2d-8db2-aaf004cccf6c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[583201, 14390, 227, 4, 127, "Subsection", "ExpressionUUID" -> \
"5f89d035-7bb6-4473-9d57-13186bf3c122"],
Cell[583431, 14396, 622, 17, 2147483647, "Input", "ExpressionUUID" -> \
"0cf4b89d-0e35-4df5-929a-61a383f674ce",
 InitializationCell->True],
Cell[584056, 14415, 653, 16, 2147483647, "Input", "ExpressionUUID" -> \
"0890c381-fd49-4326-a172-7c4e5ef4baf0",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[584746, 14436, 221, 4, 127, "Subsection", "ExpressionUUID" -> \
"0006591d-20eb-49e8-abe8-276d819b3577"],
Cell[584970, 14442, 401, 8, 325, "Text", "ExpressionUUID" -> \
"421e09fc-9f6e-4a34-b963-ca454e230a93"],
Cell[585374, 14452, 5313, 126, 4717, "Input", "ExpressionUUID" -> \
"bde3880d-b0c2-4ce0-92c4-95dc4ee849cb",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[590724, 14583, 159, 3, 127, "Subsection", "ExpressionUUID" -> \
"b8a9b6a7-85cc-47e1-9247-754bfcf02b59"],
Cell[590886, 14588, 230, 5, 2147483647, "Text", "ExpressionUUID" -> \
"6331c050-e817-4eba-9dc8-d76c75af7af0"],
Cell[591119, 14595, 1667, 44, 2147483647, "Input", "ExpressionUUID" -> \
"4317f11f-8afe-42dd-8fd6-ddb3555c1c6b",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[592823, 14644, 161, 3, 127, "Subsection", "ExpressionUUID" -> \
"2896684c-a495-4042-afcb-3bf4e808b323"],
Cell[592987, 14649, 167, 3, 35031501, "Text", "ExpressionUUID" -> \
"20da976b-bb97-4b74-8d7e-c869aaec7c78"],
Cell[593157, 14654, 1949, 49, 284339071, "Input", "ExpressionUUID" -> \
"f11db7a1-62e3-43be-ae18-99401778309a",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[595143, 14708, 230, 4, 127, "Subsection", "ExpressionUUID" -> \
"8c179d25-e036-4375-b376-cc24f441e272"],
Cell[595376, 14714, 166, 3, 2147483647, "Text", "ExpressionUUID" -> \
"e1f73258-68de-41be-84a0-871648c0f5ec"],
Cell[595545, 14719, 4911, 116, 2147483647, "Input", "ExpressionUUID" -> \
"bfd22ec1-d189-4852-8054-76cc5d06a244",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[600493, 14840, 162, 3, 127, "Subsection", "ExpressionUUID" -> \
"a557e1dd-57d5-4044-86ec-eb8c10b49ac1"],
Cell[600658, 14845, 1628, 43, 2147483647, "Input", "ExpressionUUID" -> \
"efc63f1a-4f3a-42bf-a076-97acb31b069b",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[602323, 14893, 212, 4, 127, "Subsection", "ExpressionUUID" -> \
"192b94be-13de-4c26-9ba8-4c7b4753493f"],
Cell[602538, 14899, 170, 3, 35031501, "Text", "ExpressionUUID" -> \
"5e1db84c-a9f0-44ea-a36e-babbd9414d03"],
Cell[602711, 14904, 1906, 49, 262736311, "Input", "ExpressionUUID" -> \
"a405ae7d-217b-4bfc-80f4-e2da158060af",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[604654, 14958, 160, 3, 127, "Subsection", "ExpressionUUID" -> \
"51c6cb84-88f0-4531-99a4-9701197bb322"],
Cell[604817, 14963, 2370, 66, 2147483647, "Input", "ExpressionUUID" -> \
"24038631-cf26-4f38-a600-994da6a8d4d1",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[607224, 15034, 284, 4, 127, "Subsection", "ExpressionUUID" -> \
"304b0183-d4d8-4cb8-b4b0-553c8f32e77c"],
Cell[607511, 15040, 5361, 147, 2147483647, "Input", "ExpressionUUID" -> \
"d3e34456-ab85-4731-ab8a-e729370ed759",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[612909, 15192, 198, 3, 127, "Subsection", "ExpressionUUID" -> \
"18465736-dda5-4337-9b98-9f8d354ce892"],
Cell[613110, 15197, 6247, 149, 673188835, "Input", "ExpressionUUID" -> \
"c59ef459-dc84-4d0a-a00a-246aee41e215",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[619394, 15351, 161, 3, 127, "Subsection", "ExpressionUUID" -> \
"837137ee-1fa1-4d80-850c-21607fec85c9"],
Cell[619558, 15356, 13458, 327, 98781385, "Input", "ExpressionUUID" -> \
"b7ab066a-1c9c-4361-86f9-652930f34008",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[633041, 15687, 187, 3, 2043436, "Subsubsection", "ExpressionUUID" -> \
"efc326c3-1da1-4408-bc26-283aae502b53"],
Cell[633231, 15692, 16593, 360, 132535846, "Input", "ExpressionUUID" -> \
"2aa5358c-9195-4dd0-909d-71768756fb63",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[649873, 16058, 188, 3, 127, "Subsection", "ExpressionUUID" -> \
"d78be728-5cae-4d6b-b433-c75bdbdf71d4"],
Cell[650064, 16063, 5070, 129, 2147483647, "Input", "ExpressionUUID" -> \
"9c62b4c3-6e75-410b-abe9-f7c7f4439d00",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[655171, 16197, 169, 3, 127, "Subsection", "ExpressionUUID" -> \
"5a0c7a9e-f594-4c8a-a7b9-38d6a163b6b3"],
Cell[655343, 16202, 6911, 172, 2147483647, "Input", "ExpressionUUID" -> \
"bbc59df5-4f0b-4197-92b2-cc2730316a1e",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[662291, 16379, 277, 4, 127, "Subsection", "ExpressionUUID" -> \
"a0a9bed5-ab5d-439e-a5f1-7c96c1cd1133"],
Cell[662571, 16385, 535, 11, 2147483647, "Text", "ExpressionUUID" -> \
"5a43ad5f-872b-4001-b23e-7923703ab1de"],
Cell[CellGroupData[{
Cell[663131, 16400, 165, 3, 2147483647, "Subsubsection", "ExpressionUUID" -> \
"6bff5257-c498-4407-a5fe-1e44099bcaa4"],
Cell[663299, 16405, 503, 9, 2147483647, "Text", "ExpressionUUID" -> \
"783d59a0-6b45-4da5-8cc9-f310949a350d"],
Cell[663805, 16416, 2629, 64, 2147483647, "Input", "ExpressionUUID" -> \
"63f16654-0ee0-440a-ba04-9f3cd05ed87a",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[666471, 16485, 169, 3, 2147483647, "Subsubsection", "ExpressionUUID" -> \
"baae1198-78dc-49cc-864c-2407efb279b1"],
Cell[666643, 16490, 804, 21, 2147483647, "Input", "ExpressionUUID" -> \
"e4c46f85-c2b9-4e47-81b4-0cd2d29c12bf",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[667484, 16516, 169, 3, 2147483647, "Subsubsection", "ExpressionUUID" -> \
"0a57cf57-bafe-4fd9-af07-21ba862c6edf"],
Cell[667656, 16521, 304, 7, 2147483647, "Text", "ExpressionUUID" -> \
"e17c6602-eed4-4c61-9d1e-8aac2c5ed32b"],
Cell[667963, 16530, 1592, 41, 2147483647, "Input", "ExpressionUUID" -> \
"e87d2c9e-0462-4d1b-b253-cb9ac53d07ba",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[669592, 16576, 172, 3, 2147483647, "Subsubsection", "ExpressionUUID" -> \
"4c2138d2-ddd7-465e-86c0-43189e55dfb5"],
Cell[669767, 16581, 849, 22, 2147483647, "Input", "ExpressionUUID" -> \
"16243632-3f94-44a0-bf76-0e935e0a0513",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[670653, 16608, 165, 3, 2147483647, "Subsubsection", "ExpressionUUID" -> \
"2aa46966-ef5c-4604-b977-4c68bf7d3c35"],
Cell[670821, 16613, 189, 3, 2147483647, "Text", "ExpressionUUID" -> \
"f4350397-4093-45e8-a61b-3f7c4c1a9742"],
Cell[671013, 16618, 3190, 85, 2147483647, "Input", "ExpressionUUID" -> \
"916d3514-3da0-492c-b9f8-f8baa2a84396",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[674240, 16708, 166, 3, 2147483647, "Subsubsection", "ExpressionUUID" -> \
"481d3c32-fc81-419a-87e0-b18b13e4fcb5"],
Cell[674409, 16713, 1910, 52, 2147483647, "Input", "ExpressionUUID" -> \
"8272f387-72b6-4cf4-b17c-d8f52af4201c",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[676368, 16771, 210, 4, 127, "Subsection", "ExpressionUUID" -> \
"a93de186-c78a-4e4e-a1f9-ba68528b110a"],
Cell[676581, 16777, 240, 6, 2147483647, "Text", "ExpressionUUID" -> \
"baf896a3-b22f-416c-968c-c80b7c0ae061"],
Cell[CellGroupData[{
Cell[676846, 16787, 221, 5, 2147483647, "Subsubsection", "ExpressionUUID" -> \
"c86bde1d-c46e-4a9d-811c-84394012a0ab"],
Cell[677070, 16794, 3098, 77, 2147483647, "Input", "ExpressionUUID" -> \
"0fbe2728-2171-46f5-be0e-e561a46836f9",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[680205, 16876, 197, 3, 2147483647, "Subsubsection", "ExpressionUUID" -> \
"27542171-e4d8-4c19-b005-5fe6214aa418"],
Cell[680405, 16881, 10743, 247, 2147483647, "Input", "ExpressionUUID" -> \
"df9bc658-b212-441f-b5d7-5c4c7275eb35",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[691185, 17133, 184, 3, 2147483647, "Subsubsection", "ExpressionUUID" -> \
"8dd6f298-f94e-494b-a7fa-39362ed67b2e"],
Cell[691372, 17138, 346, 7, 2147483647, "Text", "ExpressionUUID" -> \
"19286b87-5807-4561-afee-712fa6054384"],
Cell[691721, 17147, 4842, 120, 2147483647, "Input", "ExpressionUUID" -> \
"aebbf969-99b8-44c3-821d-316a65799af8",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[696600, 17272, 171, 3, 2147483647, "Subsubsection", "ExpressionUUID" -> \
"6a636bab-5b6f-4e21-923a-63fcfe93b439"],
Cell[696774, 17277, 639, 17, 2147483647, "Input", "ExpressionUUID" -> \
"cf8c2119-f47a-41dc-99f0-d8c433a644d8",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[697462, 17300, 185, 3, 127, "Subsection", "ExpressionUUID" -> \
"188ddb0c-021d-4727-96a3-e1ac8e5ac6ad"],
Cell[697650, 17305, 9478, 208, 2147483647, "Input", "ExpressionUUID" -> \
"98f8d7e0-36cd-4b64-877c-a9206fe3d6cb",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[707165, 17518, 161, 3, 127, "Subsection", "ExpressionUUID" -> \
"59805ba4-04b7-4803-8183-1937be1ab619"],
Cell[707329, 17523, 510, 9, 505, "Text", "ExpressionUUID" -> \
"a63dd3bb-3ad5-4919-9855-fe8d4a5bc867"],
Cell[707842, 17534, 8960, 215, 5449, "Input", "ExpressionUUID" -> \
"06803b8e-c282-4f85-8a9e-da94ef3623d7",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[716839, 17754, 158, 3, 127, "Subsection", "ExpressionUUID" -> \
"fa775827-422d-4b2d-9d5d-519aeec6e46a"],
Cell[717000, 17759, 513, 10, 2147483647, "Text", "ExpressionUUID" -> \
"1583c748-aee1-4109-8a02-d84b0b88b97c"],
Cell[717516, 17771, 41503, 892, 2147483647, "Input", "ExpressionUUID" -> \
"dfcaf207-12f5-4da5-8b3e-bbb911d46867",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[759056, 18668, 158, 3, 127, "Subsection", "ExpressionUUID" -> \
"e8d94990-0bcf-4b5c-95ab-6834c7abff02"],
Cell[759217, 18673, 6641, 167, 130054402, "Input", "ExpressionUUID" -> \
"d9245765-b79d-419f-bd5f-60eebf661aed",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[765895, 18845, 175, 3, 127, "Subsection", "ExpressionUUID" -> \
"91858adb-34e8-4316-bcc3-1c4462ace03a"],
Cell[766073, 18850, 240, 6, 35031501, "Text", "ExpressionUUID" -> \
"814a06f5-ae18-42fa-a36d-c81ecec3330a"],
Cell[766316, 18858, 1649, 47, 176325237, "Input", "ExpressionUUID" -> \
"9013f9f2-19ab-4d57-9f58-7069e8445966",
 InitializationCell->True],
Cell[767968, 18907, 2803, 74, 305941848, "Input", "ExpressionUUID" -> \
"dc7395a5-65d9-42ee-adfa-d92562796dac",
 InitializationCell->True],
Cell[770774, 18983, 2589, 67, 327544593, "Input", "ExpressionUUID" -> \
"d897e382-a356-45a6-a3ea-3e1853677003",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[773400, 19055, 266, 4, 127, "Subsection", "ExpressionUUID" -> \
"7e8652ff-f30c-40a9-bb59-4fef697ddb80"],
Cell[773669, 19061, 213, 5, 2147483647, "Text", "ExpressionUUID" -> \
"57fee702-9ec2-4402-9f5d-9789d3274c2b"],
Cell[773885, 19068, 3671, 84, 2147483647, "Input", "ExpressionUUID" -> \
"65062c82-b13d-41d6-aca0-5903962d4584",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[777593, 19157, 169, 3, 127, "Subsection", "ExpressionUUID" -> \
"4373574f-e8cd-4096-b80d-e62a4680fe5d"],
Cell[777765, 19162, 180, 3, 2147483647, "Text", "ExpressionUUID" -> \
"76538f34-58a9-4d64-a57a-d5cc39409202"],
Cell[777948, 19167, 13136, 288, 2147483647, "Input", "ExpressionUUID" -> \
"401eb19d-d4b5-484c-8ea0-a72717f05bfd",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[791121, 19460, 160, 3, 127, "Subsection", "ExpressionUUID" -> \
"e97e9988-add5-49b1-9099-f72050658f79"],
Cell[791284, 19465, 216, 5, 2189418, "Text", "ExpressionUUID" -> \
"100102eb-c5f4-4d03-b659-022e6fc3d42c"],
Cell[791503, 19472, 1585, 35, 6969633, "Input", "ExpressionUUID" -> \
"0910ae82-0d9b-4fed-b669-6c395b277e74",
 InitializationCell->True],
Cell[793091, 19509, 16768, 343, 164939989, "Input", "ExpressionUUID" -> \
"b8bdb6bf-119b-4b07-a842-de4f0a168da0",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[809896, 19857, 223, 4, 127, "Subsection", "ExpressionUUID" -> \
"335cd39e-3c72-4a4a-a93f-c1bf159b9b98"],
Cell[CellGroupData[{
Cell[810144, 19865, 164, 3, 2147483647, "Subsubsection", "ExpressionUUID" -> \
"233b2caf-32f9-4584-bbb0-fbf1b4a4c876"],
Cell[810311, 19870, 246, 6, 2147483647, "Text", "ExpressionUUID" -> \
"40ced38e-03cf-4d57-a684-8bc039e5abbd"],
Cell[810560, 19878, 6595, 162, 2147483647, "Input", "ExpressionUUID" -> \
"77b512c0-dd44-41e9-84bb-42d27a7d3a4f",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[817192, 20045, 161, 3, 2147483647, "Subsubsection", "ExpressionUUID" -> \
"fbcf3877-8328-40e0-b553-f7a4ef24321b"],
Cell[817356, 20050, 6387, 162, 2147483647, "Input", "ExpressionUUID" -> \
"acd8755a-4dc8-4ee0-86c5-a05de08db7fd",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[823780, 20217, 163, 3, 2147483647, "Subsubsection", "ExpressionUUID" -> \
"6707ecad-8680-4ed8-9160-a4dc98db743f"],
Cell[823946, 20222, 681, 20, 2147483647, "Input", "ExpressionUUID" -> \
"378ae14f-f980-4c2e-91fd-0466b6381c71",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[824676, 20248, 162, 3, 127, "Subsection", "ExpressionUUID" -> \
"5f6cb472-3af3-43cc-9692-f0366d565f27"],
Cell[824841, 20253, 9068, 211, 2147483647, "Input", "ExpressionUUID" -> \
"6833d526-9ee8-479d-a765-4fbde8faab69",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[833946, 20469, 165, 3, 127, "Subsection", "ExpressionUUID" -> \
"aa7572db-311e-4107-9334-4879621aef54"],
Cell[834114, 20474, 1733, 48, 2147483647, "Input", "ExpressionUUID" -> \
"b1111a1d-d967-4ff5-b333-92b073feb21e",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[835884, 20527, 163, 3, 127, "Subsection", "ExpressionUUID" -> \
"6d55501e-8bf6-43a6-9fc9-f35e669a117f"],
Cell[836050, 20532, 5576, 144, 2147483647, "Input", "ExpressionUUID" -> \
"8979613c-751f-4bd4-be19-04ce79c89730",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[841663, 20681, 257, 4, 127, "Subsection", "ExpressionUUID" -> \
"dde607c9-7fed-4b41-8171-4ad4c81988f0"],
Cell[841923, 20687, 15493, 383, 79510, "Input", "ExpressionUUID" -> \
"2ef5d7d2-7f98-4894-ac4e-e48ed2951827",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[857453, 21075, 164, 3, 127, "Subsection", "ExpressionUUID" -> \
"8fac0ea2-0070-4b05-885c-0add9a3f47ae"],
Cell[857620, 21080, 3692, 90, 2147483647, "Input", "ExpressionUUID" -> \
"9c0a8fb1-1f14-4542-bde8-a45a943605bb",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[861349, 21175, 137, 3, 127, "Subsection", "ExpressionUUID" -> \
"adaf52c7-6263-48df-aa2f-24221ecfec7a"],
Cell[861489, 21180, 1262, 34, 2147483647, "Input", "ExpressionUUID" -> \
"1bf82b6a-4034-4a58-b2f4-4f3ce42e3607",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[862788, 21219, 222, 4, 127, "Subsection", "ExpressionUUID" -> \
"bfa3d359-ba34-4669-9918-a3d6c6d13761"],
Cell[863013, 21225, 1818, 50, 2147483647, "Input", "ExpressionUUID" -> \
"30bf69bc-3c26-4365-b91f-613a2429fd55",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[864868, 21280, 167, 3, 127, "Subsection", "ExpressionUUID" -> \
"11a63e40-e000-4a8f-9fe0-145df01864a2"],
Cell[865038, 21285, 236, 6, 2147483647, "Text", "ExpressionUUID" -> \
"f7509f54-a7ae-4cc0-88bf-23b7248fa686"],
Cell[865277, 21293, 1751, 44, 2147483647, "Input", "ExpressionUUID" -> \
"520142bb-168d-4dfe-a50c-dbe3479b0b5d",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[867065, 21342, 298, 7, 208, "Subsection", "ExpressionUUID" -> \
"e5283fa9-13eb-46ce-84df-63315de47e5d"],
Cell[867366, 21351, 7218, 214, 2147483647, "Input", "ExpressionUUID" -> \
"9b2eb6a4-b132-4a03-ae03-eb4a1f74a099",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[874621, 21570, 189, 3, 127, "Subsection", "ExpressionUUID" -> \
"3ff00376-5127-4ee6-a808-3c6432feac7a"],
Cell[874813, 21575, 4224, 114, 2147483647, "Input", "ExpressionUUID" -> \
"1698fbf4-a9b1-47bf-945d-31d570da8975",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[879074, 21694, 160, 3, 127, "Subsection", "ExpressionUUID" -> \
"5a66ae08-fdaa-4104-9927-c0c6037d6eee"],
Cell[879237, 21699, 1082, 31, 2147483647, "Input", "ExpressionUUID" -> \
"4023a508-6b7f-4aab-b347-fb22690b6ada",
 InitializationCell->True],
Cell[880322, 21732, 328, 7, 2147483647, "Text", "ExpressionUUID" -> \
"5c02a600-76c9-4685-b7bc-18f5932c2b7a"],
Cell[880653, 21741, 1935, 50, 2147483647, "Input", "ExpressionUUID" -> \
"e8a2c2e1-adc4-42d2-bf51-4bf1bada2a06",
 InitializationCell->True],
Cell[882591, 21793, 988, 28, 2147483647, "Input", "ExpressionUUID" -> \
"27701e86-eed9-4112-94bc-476ac1ce6404",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[883616, 21826, 165, 3, 127, "Subsection", "ExpressionUUID" -> \
"a3c68114-e79c-4aaa-8c7b-78aa940fe8c9"],
Cell[883784, 21831, 3393, 90, 2147483647, "Input", "ExpressionUUID" -> \
"8aa1c2a8-e2cb-45ab-872c-566526f25185",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[887214, 21926, 167, 3, 127, "Subsection", "ExpressionUUID" -> \
"218ee287-0092-42e8-8d5d-cb219c9fabce"],
Cell[887384, 21931, 1084, 30, 2147483647, "Input", "ExpressionUUID" -> \
"db3aa5af-e399-4f93-960f-a6f538ec010d",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[888505, 21966, 160, 3, 127, "Subsection", "ExpressionUUID" -> \
"31105188-0e54-42cb-85d5-115ebb13d389"],
Cell[888668, 21971, 2497, 65, 2147483647, "Input", "ExpressionUUID" -> \
"ee5870dc-56e7-42a8-986a-c0dd4677a3da",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[891202, 22041, 160, 3, 127, "Subsection", "ExpressionUUID" -> \
"4b63ea81-7af3-43da-82af-4430618c2847"],
Cell[891365, 22046, 4214, 114, 2147483647, "Input", "ExpressionUUID" -> \
"ac19b43f-70e2-4271-a39a-98b5291900aa",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[895616, 22165, 160, 3, 127, "Subsection", "ExpressionUUID" -> \
"8c20f627-d103-4175-9e83-f176e76b0ead"],
Cell[895779, 22170, 198, 3, 2147483647, "Text", "ExpressionUUID" -> \
"733b0b24-77c5-4ea5-bd1e-449383c3f05d"],
Cell[895980, 22175, 1877, 49, 2147483647, "Input", "ExpressionUUID" -> \
"2fb91383-2608-42f4-bfde-37bf8b09c263",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[897894, 22229, 157, 3, 127, "Subsection", "ExpressionUUID" -> \
"aa5c8dc0-4a61-45ef-a9ea-55b4d0559105"],
Cell[898054, 22234, 1129, 31, 2147483647, "Input", "ExpressionUUID" -> \
"55f9d74b-65d2-4c09-99d0-5f830674db62",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[899220, 22270, 158, 3, 127, "Subsection", "ExpressionUUID" -> \
"59a1709c-9c2a-47ea-b00f-9715b52fc650"],
Cell[899381, 22275, 2353, 60, 19121278, "Input", "ExpressionUUID" -> \
"837557e5-7801-4fc4-ac23-66f5a3447b87",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[901771, 22340, 160, 3, 127, "Subsection", "ExpressionUUID" -> \
"6297f372-4483-4905-935c-cfab846ed5b2"],
Cell[901934, 22345, 222, 5, 2147483647, "Text", "ExpressionUUID" -> \
"2585dc93-3c99-491a-b12d-b0caf7a94da8"],
Cell[902159, 22352, 10363, 249, 2147483647, "Input", "ExpressionUUID" -> \
"29a067c6-1330-4bcc-a36b-fc13dc2090c3",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[912559, 22606, 217, 4, 127, "Subsection", "ExpressionUUID" -> \
"61b6607d-5559-4f7e-962e-4f1140be6ea0"],
Cell[912779, 22612, 7814, 188, 25467, "Input", "ExpressionUUID" -> \
"2343032d-ab50-4ac2-93ec-0807ee10c0b7",
 InitializationCell->True],
Cell[920596, 22802, 6132, 149, 157221, "Input", "ExpressionUUID" -> \
"ee81fee4-47be-4663-b9db-6206466d73aa",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[926765, 22956, 160, 3, 127, "Subsection", "ExpressionUUID" -> \
"4fed3a8b-1ac1-44cd-baf4-69b3fa5349b3"],
Cell[926928, 22961, 7617, 190, 27582, "Input", "ExpressionUUID" -> \
"24b71b86-1795-4173-a309-6b57ae4cc20e",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[934594, 23157, 187, 3, 63, "Section", "ExpressionUUID" -> \
"91016e88-1716-4dd5-b313-7e8fda0ec911"],
Cell[CellGroupData[{
Cell[934806, 23164, 161, 3, 2147483647, "Subsection", "ExpressionUUID" -> \
"730f4c6a-6811-460a-8ae3-ef6c0d4b476a"],
Cell[934970, 23169, 199, 3, 2147483647, "Text", "ExpressionUUID" -> \
"ddbcf2dd-3ba2-48dd-9c96-7faaa7aca326"],
Cell[935172, 23174, 2966, 73, 2147483647, "Input", "ExpressionUUID" -> \
"95cc6fce-8563-45d9-ba64-4ef837f57f26",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[938175, 23252, 161, 3, 2147483647, "Subsection", "ExpressionUUID" -> \
"da3029e4-ef78-4dee-9bee-16e46b934d6c"],
Cell[938339, 23257, 254, 6, 2147483647, "Text", "ExpressionUUID" -> \
"c31b2b0c-fdc0-42cf-ae77-f8dcfd3a59ed"],
Cell[938596, 23265, 2337, 57, 2147483647, "Input", "ExpressionUUID" -> \
"cadad009-1421-4dd3-8e67-657c74e76fc3",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[940970, 23327, 160, 3, 2147483647, "Subsection", "ExpressionUUID" -> \
"5144da57-5e6d-4317-bbca-71d84390c0a6"],
Cell[941133, 23332, 180, 3, 2147483647, "Text", "ExpressionUUID" -> \
"63644301-9d63-42c1-b01a-a2ea49f2c43d"],
Cell[941316, 23337, 2034, 50, 2147483647, "Input", "ExpressionUUID" -> \
"d99d67d1-e046-40eb-8054-60b3cc400b5d",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[943387, 23392, 167, 3, 2147483647, "Subsection", "ExpressionUUID" -> \
"94ae1bb8-075f-440c-b3fe-443dcef81bc9"],
Cell[943557, 23397, 665, 18, 2147483647, "Input", "ExpressionUUID" -> \
"00e9ca7b-dd3a-4958-b957-791b8985d3c4",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[944259, 23420, 147, 3, 2147483647, "Subsection", "ExpressionUUID" -> \
"da674bfc-aee1-4dd6-b318-6b67798cb050"],
Cell[944409, 23425, 13068, 294, 2147483647, "Input", "ExpressionUUID" -> \
"b33a8226-ed4e-4736-879e-c25af10e2faf",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[957514, 23724, 168, 3, 2147483647, "Subsection", "ExpressionUUID" -> \
"4b22bad4-47ab-45be-9554-0258f42a7fc8"],
Cell[957685, 23729, 4238, 108, 2147483647, "Input", "ExpressionUUID" -> \
"d9146ec4-738f-4bf4-b672-ba1874e9f20b",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[961960, 23842, 225, 4, 2147483647, "Subsection", "ExpressionUUID" -> \
"f5c95de6-53d6-4acf-83fe-e5933522db59"],
Cell[962188, 23848, 2810, 70, 2147483647, "Input", "ExpressionUUID" -> \
"4b1f5f9e-3b51-477b-b660-e3691c524af0",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[965047, 23924, 163, 3, 63, "Section", "ExpressionUUID" -> \
"fcda713a-3c9d-4cde-8efb-4a5e47a0c697"],
Cell[CellGroupData[{
Cell[965235, 23931, 170, 3, 621, "Subsubsection", "ExpressionUUID" -> \
"7514c90b-863c-4e8c-837f-e6eaeeb231d3"],
Cell[965408, 23936, 3726, 89, 2147483647, "Input", "ExpressionUUID" -> \
"e61e7226-f26e-415f-972a-15305abf12e6",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[969171, 24030, 102, 0, 438, "Subsubsection", "ExpressionUUID" -> \
"dc4b68be-52f2-4d7c-affd-f3a53ce85b69"],
Cell[969276, 24032, 332, 7, 2147483647, "Text", "ExpressionUUID" -> \
"05aaa16f-3c84-4aea-a701-4a85b994416a"],
Cell[969611, 24041, 5098, 122, 2147483647, "Input", "ExpressionUUID" -> \
"cca98535-a136-4043-83d7-e3529129f1b9",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[974746, 24168, 170, 3, 438, "Subsubsection", "ExpressionUUID" -> \
"14b343f4-74a6-471b-b7cb-a4e81a03c5b9"],
Cell[974919, 24173, 8662, 202, 2147483647, "Input", "ExpressionUUID" -> \
"72703f2f-62c7-43ff-b619-95907726d2ad",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[983618, 24380, 177, 3, 438, "Subsubsection", "ExpressionUUID" -> \
"70a0ffa0-3d82-4f22-838c-92fd1d95d050"],
Cell[983798, 24385, 13345, 302, 2147483647, "Input", "ExpressionUUID" -> \
"b469215b-f790-411d-94d5-b6108f16c8e0",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[997180, 24692, 172, 3, 438, "Subsubsection", "ExpressionUUID" -> \
"28de4ef7-9567-4f3b-a868-7d1aff352fb4"],
Cell[997355, 24697, 350, 8, 2147483647, "Text", "ExpressionUUID" -> \
"1b3e832b-ee07-431e-b219-f94e227dcfb8"],
Cell[997708, 24707, 4349, 104, 2147483647, "Input", "ExpressionUUID" -> \
"2c3d8470-ff01-4e8b-a6cd-d22df6cab8f6",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1002094, 24816, 171, 3, 438, "Subsubsection", "ExpressionUUID" -> \
"e9878e9a-127e-4537-afc6-deb2e7ede980"],
Cell[1002268, 24821, 259, 6, 2147483647, "Text", "ExpressionUUID" -> \
"4959d18b-2e1e-4860-9fd6-3f707a9941a7"],
Cell[1002530, 24829, 486, 13, 2147483647, "Input", "ExpressionUUID" -> \
"395d5945-decd-4a99-9561-2a7fdfa68919",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1003053, 24847, 176, 3, 438, "Subsubsection", "ExpressionUUID" -> \
"4ddd7bfb-6dee-437e-b9e3-1c85c836ca6a"],
Cell[1003232, 24852, 1543, 39, 27001, "Input", "ExpressionUUID" -> \
"5f2b9345-2780-4c5f-b9b9-66e0ee5e5290",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1004812, 24896, 182, 3, 438, "Subsubsection", "ExpressionUUID" -> \
"fbb1e16b-81b4-40d6-9f8d-6427678f3402"],
Cell[1004997, 24901, 12669, 268, 2147483647, "Input", "ExpressionUUID" -> \
"f9c4773a-dede-420a-9f82-55ac7f43616a",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1017703, 25174, 165, 3, 438, "Subsubsection", "ExpressionUUID" -> \
"568b8864-6c87-404f-a8e7-8244a8944661"],
Cell[1017871, 25179, 5434, 136, 70026, "Input", "ExpressionUUID" -> \
"3ea55550-f0c7-4401-a147-a35bd2f5373c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1023342, 25320, 216, 4, 438, "Subsubsection", "ExpressionUUID" -> \
"f1f18d75-2b03-41e5-a930-fc22df59a155"],
Cell[1023561, 25326, 9141, 213, 2147483647, "Input", "ExpressionUUID" -> \
"b20e47d7-9fc1-4c90-b892-d1e56c0efb9b",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1032739, 25544, 272, 4, 438, "Subsubsection", "ExpressionUUID" -> \
"07613b9c-be34-443a-b552-b01ccc2f611b"],
Cell[1033014, 25550, 18114, 404, 2147483647, "Input", "ExpressionUUID" -> \
"33bbbf33-bed0-4928-967f-c6f375f81ffc",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1051165, 25959, 176, 3, 438, "Subsubsection", "ExpressionUUID" -> \
"d66cee73-3349-40c8-ac39-3e1934ae6dbb"],
Cell[1051344, 25964, 9199, 203, 2147483647, "Input", "ExpressionUUID" -> \
"0c3fe9d2-113c-4f78-a138-0581ff311ae7",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1060580, 26172, 166, 3, 438, "Subsubsection", "ExpressionUUID" -> \
"afef08c5-5935-4f7c-93e6-772e717267c0"],
Cell[1060749, 26177, 273, 6, 2147483647, "Text", "ExpressionUUID" -> \
"4162e9d8-17e5-421d-9201-17ecc725882c"],
Cell[1061025, 26185, 4820, 115, 2147483647, "Input", "ExpressionUUID" -> \
"53cf5681-dd33-4a7d-8f0f-c8b4d2d8a4f7",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1065882, 26305, 177, 3, 438, "Subsubsection", "ExpressionUUID" -> \
"fbf21c32-39be-40ba-b8cd-48a816fec2b2"],
Cell[1066062, 26310, 15210, 328, 2147483647, "Input", "ExpressionUUID" -> \
"6b5f7fbe-1b67-47c8-8051-37f265f69e18",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1081309, 26643, 181, 3, 438, "Subsubsection", "ExpressionUUID" -> \
"f5ced8d1-a32b-4e31-98dc-a12519abc95c"],
Cell[1081493, 26648, 23230, 485, 399748, "Input", "ExpressionUUID" -> \
"198ed561-7c16-4ac0-b40d-b57a39195792",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1104760, 27138, 168, 3, 438, "Subsubsection", "ExpressionUUID" -> \
"fc8605b4-94e2-4d75-b391-619e3d49f324"],
Cell[1104931, 27143, 1614, 40, 24360, "Input", "ExpressionUUID" -> \
"a4734c3c-2567-4088-ae6b-cde7cf41025a",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1106582, 27188, 173, 3, 438, "Subsubsection", "ExpressionUUID" -> \
"0027d5a5-dd2d-4ed4-b441-15dd7a003642"],
Cell[1106758, 27193, 243, 6, 2147483647, "Text", "ExpressionUUID" -> \
"5f5a823d-dc77-4876-8c7f-5510e118b7a7"],
Cell[1107004, 27201, 8698, 202, 2147483647, "Input", "ExpressionUUID" -> \
"37311814-67b5-4c4b-ae37-063db15bfeab",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1115739, 27408, 216, 4, 640, "Subsection", "ExpressionUUID" -> \
"a9cc3b50-96ec-48be-9cc9-4835872af7d3"],
Cell[CellGroupData[{
Cell[1115980, 27416, 220, 4, 621, "Subsubsection", "ExpressionUUID" -> \
"0c526928-2746-470f-82c4-d275440b9248"],
Cell[1116203, 27422, 33606, 783, 103227, "Input", "ExpressionUUID" -> \
"9fce2b78-4f3a-47d1-ab49-0bf3b33ba63a",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1149846, 28210, 162, 3, 438, "Subsubsection", "ExpressionUUID" -> \
"e45910d5-76ce-45c6-b0f2-f6e218a7377c"],
Cell[1150011, 28215, 353, 8, 10705, "Text", "ExpressionUUID" -> \
"ba04ddf3-a1de-4633-b160-6ff10c9dc112"],
Cell[1150367, 28225, 1377, 37, 24360, "Input", "ExpressionUUID" -> \
"b7ed00e7-16dd-4782-a72d-d662ffd4b911",
 InitializationCell->True],
Cell[1151747, 28264, 260, 6, 6088, "Text", "ExpressionUUID" -> \
"2593a1fd-47d6-47c6-9fa4-aea0d454af6d"],
Cell[1152010, 28272, 39549, 826, 670315, "Input", "ExpressionUUID" -> \
"31d9b82c-5a47-4078-a247-f20e619fe68b",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1191596, 29103, 178, 3, 438, "Subsubsection", "ExpressionUUID" -> \
"969cf9b9-1c07-435f-b1b7-c4c21cab7ed1"],
Cell[1191777, 29108, 495, 11, 15472207, "Text", "ExpressionUUID" -> \
"5ca90b60-4dd3-40ae-8408-4c37b1531749"],
Cell[1192275, 29121, 8401, 201, 148956781, "Input", "ExpressionUUID" -> \
"1219eb9c-14b0-4358-966c-a8120c7b72c2",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1200713, 29327, 182, 3, 438, "Subsubsection", "ExpressionUUID" -> \
"ec1c607d-2a3b-4667-be10-3320ef295543"],
Cell[1200898, 29332, 604, 13, 9122706, "Text", "ExpressionUUID" -> \
"94d09b7e-3136-49d9-a27b-40ccab031791"],
Cell[1201505, 29347, 4953, 126, 40724065, "Input", "ExpressionUUID" -> \
"bf1d0847-7e37-4645-9d12-217a3cc8b96a",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1206495, 29478, 169, 3, 438, "Subsubsection", "ExpressionUUID" -> \
"fa4c338d-7e3f-4f89-ad19-d00ba9a6f556"],
Cell[1206667, 29483, 348, 8, 10705, "Text", "ExpressionUUID" -> \
"8491f30c-d522-4b36-8d36-de58adbbe9cf"],
Cell[1207018, 29493, 9170, 228, 123538, "Input", "ExpressionUUID" -> \
"7e052f7c-f648-410a-a3aa-86c4b7d2d85e",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1216225, 29726, 241, 4, 438, "Subsubsection", "ExpressionUUID" -> \
"cb2ff323-593b-4c98-97a6-348a65580f41"],
Cell[1216469, 29732, 6652, 165, 86022, "Input", "ExpressionUUID" -> \
"a4d37693-c172-4b80-9d54-830e535c7ae9",
 InitializationCell->True],
Cell[1223124, 29899, 6767, 167, 129033, "Input", "ExpressionUUID" -> \
"9d9d3667-66f1-43f0-a973-1ab3c6dbcc73",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1229928, 30071, 166, 3, 438, "Subsubsection", "ExpressionUUID" -> \
"b91f99d5-ef5d-4842-afbb-bbd2e8c37846"],
Cell[1230097, 30076, 270, 6, 2189418, "Text", "ExpressionUUID" -> \
"bac055d1-35f3-4486-bd33-59ab03a885a2"],
Cell[1230370, 30084, 9798, 229, 82579347, "Input", "ExpressionUUID" -> \
"8905f512-0e28-47c2-be78-f946ce08b54d",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1240205, 30318, 169, 3, 438, "Subsubsection", "ExpressionUUID" -> \
"b4bd828b-4d5f-4508-bd65-a04f9cdfb1b6"],
Cell[1240377, 30323, 3539, 83, 27222300, "Input", "ExpressionUUID" -> \
"2292553a-32e0-45ea-a25f-9523e8d30c68",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1243953, 30411, 169, 3, 438, "Subsubsection", "ExpressionUUID" -> \
"068f8672-f7b7-4d42-8787-1d3fa016a688"],
Cell[1244125, 30416, 343, 9, 6349299, "Text", "ExpressionUUID" -> \
"3efba510-8f7e-4720-a4cf-1d78a477ca00"],
Cell[1244471, 30427, 3217, 87, 21821584, "Input", "ExpressionUUID" -> \
"f4d42a54-31e3-4baf-a904-d10acafdba25",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1247725, 30519, 168, 3, 438, "Subsubsection", "ExpressionUUID" -> \
"2a7cfe3b-be39-4371-bf32-ede4ed43bbee"],
Cell[1247896, 30524, 660, 11, 4962741, "Text", "ExpressionUUID" -> \
"d41ae845-0876-4a97-8b20-fbdde9762515"],
Cell[1248559, 30537, 4176, 106, 29922628, "Input", "ExpressionUUID" -> \
"789890b6-b888-45b7-b2b6-af85274a1141",
 InitializationCell->True]
}, Closed]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[1252796, 30650, 175, 3, 63, "Section", "ExpressionUUID" -> \
"e0a0ef6f-fb1a-4278-8f31-c32f288c6853"],
Cell[CellGroupData[{
Cell[1252996, 30657, 165, 3, 621, "Subsubsection", "ExpressionUUID" -> \
"286af56f-66f1-4397-bbd1-983b2848da24"],
Cell[1253164, 30662, 267, 6, 1203, "Text", "ExpressionUUID" -> \
"d284af47-d5e6-40da-9f77-0a659ca6b4cf"],
Cell[1253434, 30670, 16043, 346, 48249, "Input", "ExpressionUUID" -> \
"92efc1fb-8a07-48fd-a043-e0ba965d00bf",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1269514, 31021, 166, 3, 438, "Subsubsection", "ExpressionUUID" -> \
"b8dea2e4-f020-4f1c-80a9-3347e91fc918"],
Cell[1269683, 31026, 593, 12, 2553, "Text", "ExpressionUUID" -> \
"d733f8ce-fa31-49cc-bc3d-7394b84fa3e5"],
Cell[1270279, 31040, 24802, 529, 78963, "Input", "ExpressionUUID" -> \
"c4107f26-9477-487d-aba5-3c5ec8d61611",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1295118, 31574, 173, 3, 438, "Subsubsection", "ExpressionUUID" -> \
"124ef091-a3db-4038-8479-81f301869888"],
Cell[1295294, 31579, 8613, 188, 233572, "Input", "ExpressionUUID" -> \
"ceb2f66b-e109-4439-8314-ddd0ed67e2ec",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1303944, 31772, 161, 3, 438, "Subsubsection", "ExpressionUUID" -> \
"9c92381e-273f-4793-9f19-27ee0ae303fd"],
Cell[1304108, 31777, 16946, 387, 53541, "Input", "ExpressionUUID" -> \
"35460dd9-131a-42e2-affc-2de4a85e2cb2",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1321091, 32169, 174, 3, 438, "Subsubsection", "ExpressionUUID" -> \
"db9812bf-4fb9-4b9d-a092-8a75be5a5c50"],
Cell[1321268, 32174, 8759, 214, 2147483647, "Input", "ExpressionUUID" -> \
"44bae9ac-8968-4286-acbd-eb47e4e293b5",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1330064, 32393, 163, 3, 438, "Subsubsection", "ExpressionUUID" -> \
"d8cf068a-c373-4437-bc73-838164e509d1"],
Cell[1330230, 32398, 5007, 132, 2147483647, "Input", "ExpressionUUID" -> \
"e712d07f-a8ad-4384-bd41-3062e7b9692c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1335274, 32535, 160, 3, 438, "Subsubsection", "ExpressionUUID" -> \
"0a97c730-b7a0-4d01-9e29-9f0ad1bd774c"],
Cell[1335437, 32540, 40720, 892, 136170, "Input", "ExpressionUUID" -> \
"cf8a03aa-73e6-4940-9292-776c4fab9660",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1376194, 33437, 217, 4, 438, "Subsubsection", "ExpressionUUID" -> \
"1944393f-658a-4c42-9005-5839ced54ac3"],
Cell[1376414, 33443, 4424, 115, 2147483647, "Input", "ExpressionUUID" -> \
"330dcbd1-099f-4627-a1ea-bb5d4b98a49e",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1380875, 33563, 176, 3, 438, "Subsubsection", "ExpressionUUID" -> \
"217dbc99-57f5-4f44-ac04-3185b4ea3ce7"],
Cell[1381054, 33568, 3176, 81, 2147483647, "Input", "ExpressionUUID" -> \
"e29c421e-3c15-42b2-aebf-c89a5f9ab307",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[1384279, 33655, 218, 4, 63, "Section", "ExpressionUUID" -> \
"81e1a38d-b08a-4fac-9163-6589e85abe32"],
Cell[1384500, 33661, 372, 7, 325, "Text", "ExpressionUUID" -> \
"7306b442-a205-47c2-967f-e2da0aaea95c"],
Cell[CellGroupData[{
Cell[1384897, 33672, 214, 4, 175, "Subsection", "ExpressionUUID" -> \
"c9588416-6c65-4a1c-9e07-fcefd62c47f6"],
Cell[1385114, 33678, 852, 24, 2147483647, "Input", "ExpressionUUID" -> \
"dccc3453-ec2b-4cc5-98d9-c9ad88c65b41",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1386003, 33707, 164, 3, 127, "Subsection", "ExpressionUUID" -> \
"912bf287-b5cd-44e8-8180-97d4363dd56c"],
Cell[1386170, 33712, 2654, 68, 2147483647, "Input", "ExpressionUUID" -> \
"487d307e-aa35-4dc7-8761-a646ebd69e52",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1388861, 33785, 164, 3, 127, "Subsection", "ExpressionUUID" -> \
"2971922f-6f1f-47d3-8c8b-7643e923d2b9"],
Cell[1389028, 33790, 3728, 93, 2147483647, "Input", "ExpressionUUID" -> \
"6374c587-9971-46ad-a5d9-42077aeb1fbf",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1392793, 33888, 159, 3, 127, "Subsection", "ExpressionUUID" -> \
"38567d7c-dcbb-4cbe-87cb-50a563e69d7c"],
Cell[1392955, 33893, 342, 9, 4962741, "Text", "ExpressionUUID" -> \
"a07cc77f-e2c7-4c56-bf02-4cd7f5999919"],
Cell[1393300, 33904, 3426, 79, 24522040, "Input", "ExpressionUUID" -> \
"474db993-bfc5-44ff-ad22-97b60e15805c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1396763, 33988, 164, 3, 127, "Subsection", "ExpressionUUID" -> \
"64462048-e7e6-4526-ae3a-d6a69de3bc37"],
Cell[1396930, 33993, 12805, 303, 41890, "Input", "ExpressionUUID" -> \
"96233783-a1b2-4022-b100-4c696309b907",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1409772, 34301, 160, 3, 127, "Subsection", "ExpressionUUID" -> \
"10a73768-8445-4928-9b43-be93c6386b95"],
Cell[1409935, 34306, 311, 7, 1203, "Text", "ExpressionUUID" -> \
"4ee2e740-16aa-4a29-8cc7-7117f6afeaca"],
Cell[1410249, 34315, 1753, 42, 4812, "Input", "ExpressionUUID" -> \
"6c82f3fb-1caa-48b4-bb40-dab598d187a4",
 InitializationCell->True],
Cell[1412005, 34359, 188, 3, 748, "Text", "ExpressionUUID" -> \
"f153ec80-7b70-4677-a343-848c1744315b"],
Cell[1412196, 34364, 2140, 55, 5334, "Input", "ExpressionUUID" -> \
"33d6e7bf-6314-45ba-9079-464f9fb8e458",
 InitializationCell->True],
Cell[1414339, 34421, 1798, 45, 5334, "Input", "ExpressionUUID" -> \
"3b365ef5-89bc-4246-b0ef-33ff55138009",
 InitializationCell->True],
Cell[1416140, 34468, 1751, 44, 5334, "Input", "ExpressionUUID" -> \
"9c5cfe9a-d52e-4bce-8145-6c2afd991001",
 InitializationCell->True],
Cell[1417894, 34514, 1707, 45, 3754, "Input", "ExpressionUUID" -> \
"1e09983b-90d2-4ebf-9389-f754529e7f99",
 InitializationCell->True],
Cell[1419604, 34561, 192, 3, 748, "Text", "ExpressionUUID" -> \
"a164cad1-cfd7-43ae-a18a-7b0c7a448191"],
Cell[1419799, 34566, 3412, 89, 11166, "Input", "ExpressionUUID" -> \
"59c8c247-6604-4359-8c1a-cb3bee8a1992",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1423248, 34660, 154, 3, 127, "Subsection", "ExpressionUUID" -> \
"cb0db941-c833-4ffd-a6f8-007402962455"],
Cell[1423405, 34665, 870, 18, 43578, "Text", "ExpressionUUID" -> \
"649214d0-f0cc-4acd-8b2d-d1dad9ae1326"],
Cell[1424278, 34685, 8947, 230, 193387, "Input", "ExpressionUUID" -> \
"2a9759db-22bd-4d4e-91c0-da16fd18065b",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1433262, 34920, 161, 3, 127, "Subsection", "ExpressionUUID" -> \
"b0c20073-81b0-4163-97a9-0a076aa90831"],
Cell[1433426, 34925, 234, 6, 9132, "Text", "ExpressionUUID" -> \
"4c7984c1-3add-40dc-960f-37382340a81a"],
Cell[1433663, 34933, 8989, 196, 153153, "Input", "ExpressionUUID" -> \
"94bcfc1c-8cda-4602-892c-ea861e54fae2",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1442689, 35134, 165, 3, 127, "Subsection", "ExpressionUUID" -> \
"aa80631d-7c5d-4075-8a45-9a67d9eed01f"],
Cell[1442857, 35139, 8934, 176, 283351, "Input", "ExpressionUUID" -> \
"0daffb8f-6556-4f7b-8809-534795af7340",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1451828, 35320, 166, 3, 127, "Subsection", "ExpressionUUID" -> \
"9e280456-d504-43f7-aa57-1ba6e12a8a26"],
Cell[1451997, 35325, 5398, 133, 175446, "Input", "ExpressionUUID" -> \
"dbd8d8d5-df85-42e9-8c3e-761fcc8fe0b8",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1457432, 35463, 165, 3, 127, "Subsection", "ExpressionUUID" -> \
"792607f4-712c-4069-815b-a72b00a7b475"],
Cell[1457600, 35468, 723, 15, 63108, "Text", "ExpressionUUID" -> \
"0e7e60fd-f7d9-4dda-a960-d18eaa588fed"],
Cell[1458326, 35485, 5932, 144, 265011, "Input", "ExpressionUUID" -> \
"926fbf3b-7fab-4708-a74b-cc9a4b71fe97",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1464295, 35634, 193, 3, 127, "Subsection", "ExpressionUUID" -> \
"d1b8d071-c6cf-4fcc-9e96-71f74d0cb036"],
Cell[1464491, 35639, 1586, 35, 88209, "Text", "ExpressionUUID" -> \
"d7e11b65-36bc-43b7-b16b-70bf9200ffef"],
Cell[1466080, 35676, 5814, 129, 141156, "Input", "ExpressionUUID" -> \
"cbfe4499-f6bb-4d91-a71a-f48318b65735",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1471931, 35810, 268, 4, 127, "Subsection", "ExpressionUUID" -> \
"9d05ff73-24f7-4f9c-874d-25c6dc82839e"],
Cell[1472202, 35816, 578, 12, 26286, "Text", "ExpressionUUID" -> \
"e89b950c-8e63-4ea2-bd5b-1610fcc4bcf7"],
Cell[1472783, 35830, 8440, 205, 225577, "Input", "ExpressionUUID" -> \
"f7be68a5-f398-4769-8829-fd701a7916e6",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1481260, 36040, 267, 4, 127, "Subsection", "ExpressionUUID" -> \
"e71879d3-a0a9-47c1-9775-7b36a3a65d39"],
Cell[1481530, 36046, 3339, 76, 2147483647, "Input", "ExpressionUUID" -> \
"ab4df51e-3a06-42f2-8e11-3121895d8366",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1484906, 36127, 222, 4, 127, "Subsection", "ExpressionUUID" -> \
"19becc08-df33-4ed7-80da-8aedc2daedf7"],
Cell[1485131, 36133, 3160, 75, 2147483647, "Input", "ExpressionUUID" -> \
"fb746f9a-4ded-4e62-9043-707c70140d46",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1488328, 36213, 162, 3, 127, "Subsection", "ExpressionUUID" -> \
"7a3cd68c-a2ba-47b6-91ba-569da62ffc45"],
Cell[1488493, 36218, 3080, 82, 2147483647, "Input", "ExpressionUUID" -> \
"a06a7627-237f-4596-9ab9-b92343e78ea6",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1491610, 36305, 231, 4, 127, "Subsection", "ExpressionUUID" -> \
"c00b6c15-6a25-430b-bbc9-e6aa7cf23fea"],
Cell[1491844, 36311, 371, 7, 2147483647, "Text", "ExpressionUUID" -> \
"ab0941c0-6a6f-4958-b00c-51ab6a6add43"],
Cell[CellGroupData[{
Cell[1492240, 36322, 176, 3, 2147483647, "Subsubsection", "ExpressionUUID" -> \
"5440c067-3dc1-4c43-8fd8-2058a085a725"],
Cell[1492419, 36327, 20729, 470, 2147483647, "Input", "ExpressionUUID" -> \
"3b76cb1f-7b05-4df8-be1f-f3529c1f35e6",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1513185, 36802, 170, 3, 2147483647, "Subsubsection", "ExpressionUUID" -> \
"de80dc89-0b88-42aa-9db8-bf18685f96a0"],
Cell[1513358, 36807, 19509, 405, 2147483647, "Input", "ExpressionUUID" -> \
"278a8bf4-67a1-43e7-be9f-6944e0dc7626",
 InitializationCell->True]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[1532916, 37218, 178, 3, 127, "Subsection", "ExpressionUUID" -> \
"c6ecf24e-5f81-479b-8a4c-184797e70f46"],
Cell[1533097, 37223, 9148, 229, 2147483647, "Input", "ExpressionUUID" -> \
"c33ce7ff-3445-4888-9730-a0fff3d0d273",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1542282, 37457, 174, 3, 127, "Subsection", "ExpressionUUID" -> \
"f2ebb64d-291e-4bf2-a2e2-60432f76b4c7"],
Cell[1542459, 37462, 488, 9, 4962741, "Text", "ExpressionUUID" -> \
"54aafc9e-eb77-425b-ae69-ec1fdcaddd23"],
Cell[1542950, 37473, 5893, 147, 43424325, "Input", "ExpressionUUID" -> \
"60f3ad8e-da78-407b-b697-05977282e713",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1548880, 37625, 175, 3, 127, "Subsection", "ExpressionUUID" -> \
"2fe73c14-cd7d-4237-88f3-f14946768bab"],
Cell[1549058, 37630, 17450, 350, 487014, "Input", "ExpressionUUID" -> \
"8f1bd3e4-1f61-4f82-93f8-1ead0f473461",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1566545, 37985, 161, 3, 127, "Subsection", "ExpressionUUID" -> \
"a5f395f8-2736-4a5c-ada4-88770d86231e"],
Cell[1566709, 37990, 360, 8, 12466, "Text", "ExpressionUUID" -> \
"ebe2fa27-98bc-467b-b2fb-49fdc10002bb"],
Cell[1567072, 38000, 3848, 94, 92875, "Input", "ExpressionUUID" -> \
"641ce843-828f-44ba-84c6-d506ac704796",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[1570969, 38100, 153, 3, 63, "Section", "ExpressionUUID" -> \
"6e9006e5-9e5c-4efc-8d67-7782681fee70"],
Cell[CellGroupData[{
Cell[1571147, 38107, 165, 3, 78, "Subsection", "ExpressionUUID" -> \
"8f5be396-0935-41a8-9cc1-7e0bd534f431"],
Cell[1571315, 38112, 1310, 29, 8446, "Text", "ExpressionUUID" -> \
"3c6c1338-1826-446b-9c56-f0df708867f4"],
Cell[1572628, 38143, 25625, 529, 83308, "Input", "ExpressionUUID" -> \
"3a5a47c5-b027-47bd-8fbf-7af2708a7df3",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1598290, 38677, 165, 3, 57, "Subsection", "ExpressionUUID" -> \
"f94efeb1-f007-4828-9ae3-01f6da168740"],
Cell[CellGroupData[{
Cell[1598480, 38684, 168, 3, 55, "Subsubsection", "ExpressionUUID" -> \
"6448b6d5-50d0-4add-8f65-ed0e8ed86ea5"],
Cell[1598651, 38689, 36353, 734, 119740, "Input", "ExpressionUUID" -> \
"82e80db0-33cc-4fed-a75f-eddb3dec6624",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1635041, 39428, 185, 3, 39, "Subsubsection", "ExpressionUUID" -> \
"39f5e3f5-f79d-42a1-9872-a5b6293698fa"],
Cell[1635229, 39433, 7989, 174, 24940, "Input", "ExpressionUUID" -> \
"d8e11c5d-cbbc-4d28-ac6b-dec3c0c2c3a8",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1643255, 39612, 179, 3, 39, "Subsubsection", "ExpressionUUID" -> \
"8a856129-9c5c-4d3c-bf5c-3eb598a29305"],
Cell[1643437, 39617, 16756, 372, 57246, "Input", "ExpressionUUID" -> \
"02eeeb0e-db79-4191-9aff-2dafb8100626",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1660230, 39994, 172, 3, 39, "Subsubsection", "ExpressionUUID" -> \
"705d5431-06a6-492d-be8a-2b5b9b0273b6"],
Cell[1660405, 39999, 10939, 246, 2147483647, "Input", "ExpressionUUID" -> \
"f01fe1a6-6ac2-432d-836b-fcc0fef8fbd2",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1671393, 40251, 384, 6, 78, "Subsection", "ExpressionUUID" -> \
"45f0a8e5-dedb-4e0f-bae2-7a6f06c6e519"],
Cell[1671780, 40259, 641, 13, 265, "Text", "ExpressionUUID" -> \
"7c36ccc5-9cf7-48b1-adba-a021a5759f29"],
Cell[CellGroupData[{
Cell[1672446, 40276, 182, 3, 55, "Subsubsection", "ExpressionUUID" -> \
"970e6993-a09f-4c8d-920b-73df404fedcf"],
Cell[1672631, 40281, 43635, 804, 46158, "Input", "ExpressionUUID" -> \
"8057f826-1732-4f89-af8a-59dbb90f629b",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1716303, 41090, 195, 3, 39, "Subsubsection", "ExpressionUUID" -> \
"ede74a8d-954d-43ea-b143-977816ab2a85"],
Cell[1716501, 41095, 62955, 1326, 192316, "Input", "ExpressionUUID" -> \
"acb5104e-e1d9-428d-9355-ecdc295e67cf",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1779493, 42426, 164, 3, 39, "Subsubsection", "ExpressionUUID" -> \
"e098a838-5e78-4d11-b55f-fef9cdcfe653"],
Cell[1779660, 42431, 26973, 584, 1546349239, "Input", "ExpressionUUID" -> \
"34466dde-22cb-410d-898c-298812db669a",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1806670, 43020, 195, 3, 48, "Subsubsection", "ExpressionUUID" -> \
"5839f751-3582-4f73-aedd-6115de1abc1c"],
Cell[1806868, 43025, 299, 7, 535, "Text", "ExpressionUUID" -> \
"41633360-6b1d-456d-a2e9-feec6cf05c2e"],
Cell[1807170, 43034, 3422, 81, 4963, "Input", "ExpressionUUID" -> \
"a3210bdb-3cb3-402b-bab6-5f4da915d4e5",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1810629, 43120, 132, 3, 39, "Subsubsection", "ExpressionUUID" -> \
"a82fbc92-f3a2-4e7e-af4c-0a2a05a85e1e"],
Cell[1810764, 43125, 5885, 138, 2147483647, "Input", "ExpressionUUID" -> \
"75f2ec6b-9c71-4c85-b949-e1d040ceb080",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[1816698, 43269, 163, 3, 57, "Subsection", "ExpressionUUID" -> \
"bd4e2141-6cd7-4c0a-88af-2a55b9c99335"],
Cell[1816864, 43274, 304, 7, 28609030, "Text", "ExpressionUUID" -> \
"b0b24dce-eaf2-420a-b22f-f55d884598a3"],
Cell[1817171, 43283, 3326, 63, 293388858, "Input", "ExpressionUUID" -> \
"9f5f9496-13cf-430e-b666-960ff9581996",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1820534, 43351, 177, 3, 57, "Subsection", "ExpressionUUID" -> \
"8b45a6d1-09e8-4f11-b2e4-dfe697405ed4"],
Cell[CellGroupData[{
Cell[1820736, 43358, 171, 3, 55, "Subsubsection", "ExpressionUUID" -> \
"37cea3f0-97e2-47d0-8cbb-5a039800f608"],
Cell[1820910, 43363, 4446, 106, 2147483647, "Input", "ExpressionUUID" -> \
"5456b50e-c755-4625-b066-52ea553682be",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1825393, 43474, 153, 2, 39, "Subsubsection", "ExpressionUUID" -> \
"eca03cb9-ed62-48e7-a271-92ac2073112c"],
Cell[1825549, 43478, 2783, 72, 2147483647, "Input", "ExpressionUUID" -> \
"05cb5bf7-5dfe-41fb-81f5-327275aca7da",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1828369, 43555, 173, 3, 39, "Subsubsection", "ExpressionUUID" -> \
"f60c0e05-7598-48f9-8e59-72f7539eb3a5"],
Cell[1828545, 43560, 2797, 65, 2147483647, "Input", "ExpressionUUID" -> \
"4fd7fc03-b204-4411-9b13-bfd28845467e",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1831379, 43630, 181, 3, 39, "Subsubsection", "ExpressionUUID" -> \
"3f53c575-1d11-45da-bdf0-4557fa789d5d"],
Cell[1831563, 43635, 3825, 83, 2147483647, "Input", "ExpressionUUID" -> \
"f28c6931-ac28-433d-a768-66447de5040e",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1835425, 43723, 242, 4, 39, "Subsubsection", "ExpressionUUID" -> \
"3a43ea4f-95ed-437a-b9a8-39046a724dd9"],
Cell[1835670, 43729, 3359, 88, 2147483647, "Input", "ExpressionUUID" -> \
"3ad0560d-a461-4bcd-95dd-579432fc3c72",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1839066, 43822, 172, 3, 39, "Subsubsection", "ExpressionUUID" -> \
"c2bfb372-6511-482f-aee8-ea543496bfad"],
Cell[1839241, 43827, 173, 3, 2147483647, "Text", "ExpressionUUID" -> \
"343954e1-6ef4-4d3a-a9d5-858424f2dbff"],
Cell[1839417, 43832, 1441, 34, 2147483647, "Input", "ExpressionUUID" -> \
"04bb18cf-e6a6-4816-8573-e7f96e76aeb9",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1840895, 43871, 175, 3, 39, "Subsubsection", "ExpressionUUID" -> \
"c0d90ef0-7845-4cbb-9088-f0db733358e8"],
Cell[1841073, 43876, 9447, 205, 2147483647, "Input", "ExpressionUUID" -> \
"edf1fd77-1d65-448e-a706-bfd21ee40a12",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1850557, 44086, 176, 3, 39, "Subsubsection", "ExpressionUUID" -> \
"9011fa33-571a-439b-8664-58f53267106a"],
Cell[1850736, 44091, 795, 15, 2115, "Text", "ExpressionUUID" -> \
"6a42274a-a59d-4988-b916-5862ccca8e4d"],
Cell[1851534, 44108, 64029, 1434, 186484, "Input", "ExpressionUUID" -> \
"30ca4419-8337-4f72-902d-3eae5deeb54b",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1915600, 45547, 160, 3, 39, "Subsubsection", "ExpressionUUID" -> \
"66bd9cc0-0235-49a2-a95b-fdbe4eebb729"],
Cell[1915763, 45552, 6754, 160, 2147483647, "Input", "ExpressionUUID" -> \
"0b2572e1-897e-486e-a7b1-320789a40684",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1922554, 45717, 183, 3, 39, "Subsubsection", "ExpressionUUID" -> \
"92aea813-205e-46cf-85a9-a8cb35794ce2"],
Cell[1922740, 45722, 16030, 334, 2147483647, "Input", "ExpressionUUID" -> \
"896fc7a2-8b27-42b9-95d8-4742c05ca1a1",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1938807, 46061, 203, 3, 39, "Subsubsection", "ExpressionUUID" -> \
"04adcc91-7f4f-4829-8ee8-9dfa83e1b416"],
Cell[1939013, 46066, 11534, 264, 2147483647, "Input", "ExpressionUUID" -> \
"0414336a-d624-47be-8724-01e08cd1c796",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1950584, 46335, 344, 9, 91, "Subsubsection", "ExpressionUUID" -> \
"381563b4-be9a-4793-9a0c-c60240b29d1c"],
Cell[1950931, 46346, 7051, 175, 2147483647, "Input", "ExpressionUUID" -> \
"81020aac-2c80-4584-bd24-58d9a469c076",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1958031, 46527, 179, 3, 78, "Subsection", "ExpressionUUID" -> \
"99840edd-e361-4eba-9846-118bbe05853a"],
Cell[1958213, 46532, 2544, 60, 4442508, "Input", "ExpressionUUID" -> \
"23011767-972f-4560-a4b0-7f70cae564d2",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1960794, 46597, 218, 4, 57, "Subsection", "ExpressionUUID" -> \
"4357585b-0c14-4954-ae41-2ea7779de468"],
Cell[1961015, 46603, 46941, 1097, 94229041, "Input", "ExpressionUUID" -> \
"c8c7672b-c03b-4c83-84b0-283f02839aa5",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2007993, 47705, 205, 4, 57, "Subsection", "ExpressionUUID" -> \
"dc92490c-4b3c-4a34-82e7-8383ab7c6057"],
Cell[CellGroupData[{
Cell[2008223, 47713, 157, 3, 55, "Subsubsection", "ExpressionUUID" -> \
"fbf20c82-5c92-43c2-bf40-dfd0f86eca8c"],
Cell[2008383, 47718, 234, 6, 5679, "Text", "ExpressionUUID" -> \
"c9cf83b8-2109-4a56-97e8-f7fd8ec124a9"],
Cell[2008620, 47726, 41803, 845, 925404, "Input", "ExpressionUUID" -> \
"e81ce2ca-170c-4539-88bc-f8846dd0e27d",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2050460, 48576, 220, 4, 39, "Subsubsection", "ExpressionUUID" -> \
"f54770c6-a937-4330-9a92-76b43040b275"],
Cell[2050683, 48582, 11336, 240, 89330311, "Input", "ExpressionUUID" -> \
"ed3433cb-509e-41ee-8c3d-d825cc086a0f",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2062056, 48827, 223, 4, 39, "Subsubsection", "ExpressionUUID" -> \
"7c2c26d6-7b1e-4d2b-ae92-b2e01ffd9bfc"],
Cell[2062282, 48833, 1056, 18, 2978146, "Text", "ExpressionUUID" -> \
"1a5b6883-b5e6-4236-ad2d-964eec859419"],
Cell[2063341, 48853, 9543, 246, 6531747, "Input", "ExpressionUUID" -> \
"4721d4f0-ec9e-41b7-837e-58a918c8578e"]
}, Closed]],
Cell[CellGroupData[{
Cell[2072921, 49104, 155, 3, 39, "Subsubsection", "ExpressionUUID" -> \
"60bef6b0-8ede-41bc-a6c1-827fa9adb577"],
Cell[CellGroupData[{
Cell[2073101, 49111, 315, 7, 66, "Text", "ExpressionUUID" -> \
"c79cc559-99ad-4209-828e-791b9384ced2",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[2073419, 49120, 5507, 88, 17407, "Text", "ExpressionUUID" -> \
"02afca92-546d-4a7f-aa61-c97944b4c129",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[2078929, 49210, 72573, 1419, 143038, "Input", "ExpressionUUID" -> \
"c7954815-f9d5-4d34-a238-c21449cd3dc9",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2151539, 50634, 441, 9, 135, "Text", "ExpressionUUID" -> \
"a0c8d4ed-ccc7-49e7-a864-ceb98d819e0e",
 CellGroupingRules->{GroupTogetherGrouping, 10001.}],
Cell[2151983, 50645, 20280, 450, 2147483647, "Input", "ExpressionUUID" -> \
"b5967a69-a8ce-42c9-bbc1-da6f3673de36",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2172300, 51100, 212, 4, 55, "Text", "ExpressionUUID" -> \
"20003b5d-0471-4ed4-89d1-f94e2407a97d",
 CellGroupingRules->{GroupTogetherGrouping, 10002.}],
Cell[2172515, 51106, 509, 12, 2147483647, "Input", "ExpressionUUID" -> \
"69e364e5-a51c-40d7-bc06-7cb01d955704",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2173061, 51123, 236, 4, 55, "Text", "ExpressionUUID" -> \
"ea38891a-3bec-4c87-b922-c6ae29138f4c",
 CellGroupingRules->{GroupTogetherGrouping, 10003.}],
Cell[2173300, 51129, 804, 20, 2147483647, "Input", "ExpressionUUID" -> \
"47934b6b-3c0f-40a6-be5b-37729f53afdf",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 InitializationCell->True],
Cell[2174107, 51151, 1292, 36, 2147483647, "Input", "ExpressionUUID" -> \
"ae7590a5-18ab-4eb5-bc30-41a582740378",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 InitializationCell->True],
Cell[2175402, 51189, 1099, 26, 2147483647, "Input", "ExpressionUUID" -> \
"b39a34fc-ec78-43a2-8270-506401a1e5a9",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[2176550, 51221, 174, 3, 55, "Subsubsection", "ExpressionUUID" -> \
"622bf18d-8449-48e3-9992-060e0302b72c"],
Cell[2176727, 51226, 14615, 325, 2147483647, "Input", "ExpressionUUID" -> \
"6294ad29-95e6-4b69-823a-52ef02fb8b50",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2191379, 51556, 165, 3, 39, "Subsubsection", "ExpressionUUID" -> \
"6fec917b-ba58-4a31-8f29-53e27c84568a"],
Cell[2191547, 51561, 247, 6, 9132, "Text", "ExpressionUUID" -> \
"54aa2303-5ebc-417c-ab0c-64225fbbc8a0"],
Cell[2191797, 51569, 379, 7, 12466, "Text", "ExpressionUUID" -> \
"8dcea196-0ab8-47c0-b793-2d7cc65241f7"],
Cell[2192179, 51578, 19623, 416, 487014, "Input", "ExpressionUUID" -> \
"5044b99e-6bb1-4ba5-9704-62cf70f23f20",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2211839, 51999, 187, 3, 39, "Subsubsection", "ExpressionUUID" -> \
"7b2151b7-a509-4d57-9a22-429a78973ed4"],
Cell[2212029, 52004, 690, 13, 2147483647, "Text", "ExpressionUUID" -> \
"e920af58-2956-4816-a4e0-9fd626e73244"],
Cell[2212722, 52019, 19363, 399, 2147483647, "Input", "ExpressionUUID" -> \
"a29b131e-f960-4a63-a2fc-14f662e55783",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2232122, 52423, 230, 4, 39, "Subsubsection", "ExpressionUUID" -> \
"22a1200d-53f6-4aeb-bc96-421390c09ee8"],
Cell[2232355, 52429, 13492, 295, 2147483647, "Input", "ExpressionUUID" -> \
"f8ef2404-a269-4921-b602-db47d8650918",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2245884, 52729, 160, 3, 39, "Subsubsection", "ExpressionUUID" -> \
"5eccadd9-6fe1-465f-b0fd-436990dddf0b"],
Cell[2246047, 52734, 981, 30, 2147483647, "Input", "ExpressionUUID" -> \
"888b9f5e-01ec-4b93-a01e-ef5748de316e",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[2247077, 52770, 232, 4, 78, "Subsection", "ExpressionUUID" -> \
"81fd7c5e-ed46-49e8-9aef-6c30dfec39c2"],
Cell[2247312, 52776, 945, 19, 2147483647, "Text", "ExpressionUUID" -> \
"3078a446-1ab8-4f6a-915d-ba264ad9afc7"],
Cell[2248260, 52797, 2673, 65, 2147483647, "Input", "ExpressionUUID" -> \
"9aa8534c-9a79-45c1-ade5-e4ec4e195c19",
 InitializationCell->True],
Cell[2250936, 52864, 3324, 83, 2147483647, "Input", "ExpressionUUID" -> \
"f5f31f5d-1511-475b-80ca-da1f39550db6",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2254297, 52952, 159, 3, 57, "Subsection", "ExpressionUUID" -> \
"6673cf43-2cf4-48f5-89ce-20b53872407f"],
Cell[2254459, 52957, 66286, 1453, 1697658, "Input", "ExpressionUUID" -> \
"80a090ce-6d2c-40d3-8dc2-0a2964e16ee6",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2320782, 54415, 163, 3, 57, "Subsection", "ExpressionUUID" -> \
"81fc0916-adff-4bf9-952a-db4a6ee75b4e"],
Cell[2320948, 54420, 607, 14, 29769, "Text", "ExpressionUUID" -> \
"f8e9f0a7-c116-4e76-bb43-dc3a84b08a34"],
Cell[2321558, 54436, 43130, 956, 1054107, "Input", "ExpressionUUID" -> \
"4c71b58c-5464-479c-b16a-3bae4bc4b6de",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2364725, 55397, 164, 3, 57, "Subsection", "ExpressionUUID" -> \
"8d26237f-79cb-43e7-bc16-84b5321e7c8d"],
Cell[2364892, 55402, 2316, 63, 3092143, "Input", "ExpressionUUID" -> \
"09515ee4-6d7c-4e32-95e9-3ba0a4be002f",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2367245, 55470, 165, 3, 57, "Subsection", "ExpressionUUID" -> \
"d6fce2cd-79db-4940-ae5f-f80db65cbd78"],
Cell[2367413, 55475, 26114, 541, 46297656, "Input", "ExpressionUUID" -> \
"0e6c2321-935e-46c7-9f89-c6d87f3eae21",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2393564, 56021, 207, 4, 57, "Subsection", "ExpressionUUID" -> \
"1d4e6329-5ff0-4624-a532-d80723bbf55b"],
Cell[2393774, 56027, 224, 4, 2147483647, "Text", "ExpressionUUID" -> \
"88406729-dd91-4c34-8c8a-f32b1bffd241"],
Cell[2394001, 56033, 1717, 37, 2147483647, "Input", "ExpressionUUID" -> \
"2a592611-e0d4-461b-a35f-1d3b3b44eef8",
 InitializationCell->True],
Cell[2395721, 56072, 172, 3, 2147483647, "Text", "ExpressionUUID" -> \
"4c9343a2-ce02-40ca-a741-52bd14e22e9e"],
Cell[2395896, 56077, 1175, 26, 2147483647, "Input", "ExpressionUUID" -> \
"2cc33c77-9c85-4c4c-8637-d426b790fb15",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2397108, 56108, 156, 3, 57, "Subsection", "ExpressionUUID" -> \
"82bf7ba7-c34e-4ad8-a6bf-cb467229e793"],
Cell[2397267, 56113, 1312, 28, 6216, "Text", "ExpressionUUID" -> \
"bad10578-d042-4566-a077-3b44268c116b"],
Cell[2398582, 56143, 17936, 394, 63604, "Input", "ExpressionUUID" -> \
"e1a0a872-38ee-43d9-bf9a-48c956e9ac45",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2416555, 56542, 207, 4, 57, "Subsection", "ExpressionUUID" -> \
"c4c4fce1-76c8-46b8-9de2-2d6a140e70ad"],
Cell[2416765, 56548, 1221, 27, 2147483647, "Input", "ExpressionUUID" -> \
"d80423ff-7e6a-488a-a2a0-f7e3a6eef6dc",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2418023, 56580, 164, 3, 57, "Subsection", "ExpressionUUID" -> \
"1babd567-f2d4-4c8f-b83f-44ee386b58fb"],
Cell[2418190, 56585, 1778, 30, 2147483647, "Text", "ExpressionUUID" -> \
"7ee2b24b-a148-4112-a419-8e9e3697d0ab"],
Cell[2419971, 56617, 18938, 440, 2147483647, "Input", "ExpressionUUID" -> \
"f846aefd-6594-448e-b8f7-31bd7451dbc1",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2438946, 57062, 206, 4, 57, "Subsection", "ExpressionUUID" -> \
"0bcf4079-db95-4ee5-a7eb-5d69a047f79f"],
Cell[2439155, 57068, 2894, 73, 2147483647, "Input", "ExpressionUUID" -> \
"070cbaad-81b0-4166-8815-0b977c1c04a5",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2442086, 57146, 158, 3, 57, "Subsection", "ExpressionUUID" -> \
"427810be-1fab-4bb2-b214-79e67a351212"],
Cell[2442247, 57151, 1073, 27, 2147483647, "Text", "ExpressionUUID" -> \
"6641bfc3-8f51-4ed0-afe2-fbc1e6201641"],
Cell[2443323, 57180, 21286, 446, 2147483647, "Input", "ExpressionUUID" -> \
"d0211f82-8522-4b92-a107-2f85efcb7170",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2464646, 57631, 158, 3, 57, "Subsection", "ExpressionUUID" -> \
"1651eec3-164c-4237-b9d9-aa9d9faeb262"],
Cell[2464807, 57636, 621, 14, 2147483647, "Text", "ExpressionUUID" -> \
"61895fb7-5ab3-48eb-b660-451adc832a4c"],
Cell[2465431, 57652, 12008, 245, 2147483647, "Input", "ExpressionUUID" -> \
"e4f1712f-7ab1-4397-ae4e-4d4532d45353",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2477476, 57902, 219, 4, 57, "Subsection", "ExpressionUUID" -> \
"d3c8bc04-e426-4e04-9f26-965db917ae10"],
Cell[CellGroupData[{
Cell[2477720, 57910, 294, 4, 82, "Subsubsection", "ExpressionUUID" -> \
"3b8c1d09-d63f-42c9-8b14-b403d17bae67"],
Cell[2478017, 57916, 378, 7, 2147483647, "Text", "ExpressionUUID" -> \
"2ec6945b-f1f3-4ac6-9228-2f73c33d635e"],
Cell[2478398, 57925, 5344, 132, 2147483647, "Input", "ExpressionUUID" -> \
"a13ffb56-be30-4ff5-b53b-80b3440ba8d9",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2483779, 58062, 197, 3, 58, "Subsubsection", "ExpressionUUID" -> \
"55f3bdd8-c5c6-46c5-b7bb-a853e9b3122e"],
Cell[2483979, 58067, 2750, 69, 2147483647, "Input", "ExpressionUUID" -> \
"d73e1cab-20b0-4ddf-9904-9bea85f70b1d",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2486766, 58141, 271, 4, 58, "Subsubsection", "ExpressionUUID" -> \
"8f8201bd-2d03-4211-805a-12256eb4871d"],
Cell[2487040, 58147, 1415, 35, 2147483647, "Input", "ExpressionUUID" -> \
"a90f2d74-57e3-4903-847c-90d4c7c86725",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2488492, 58187, 237, 4, 58, "Subsubsection", "ExpressionUUID" -> \
"b6b1a907-0865-4aa6-9165-d037afaa72ab"],
Cell[2488732, 58193, 2841, 68, 2147483647, "Input", "ExpressionUUID" -> \
"1d6b3bd6-56af-42a9-b336-401c763bfe5c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2491610, 58266, 175, 3, 58, "Subsubsection", "ExpressionUUID" -> \
"44e5db67-9836-4f25-ac7f-bde228974f09"],
Cell[2491788, 58271, 2140, 49, 2147483647, "Input", "ExpressionUUID" -> \
"7290ccc7-967e-402f-b477-a55313a91ec7",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2493965, 58325, 164, 3, 58, "Subsubsection", "ExpressionUUID" -> \
"3c93587a-6d90-4bcc-a0cd-10c1cd4e8868"],
Cell[2494132, 58330, 688, 17, 2147483647, "Input", "ExpressionUUID" -> \
"00b0f85e-647c-4aa0-a725-9ee78ae544cd",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2494857, 58352, 247, 4, 58, "Subsubsection", "ExpressionUUID" -> \
"249f56cd-7b9a-47b7-a502-2f6ea88607f3"],
Cell[2495107, 58358, 16308, 358, 2147483647, "Input", "ExpressionUUID" -> \
"b923e716-746a-41f6-8f69-93d75c690427",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[2511464, 58722, 171, 3, 57, "Subsection", "ExpressionUUID" -> \
"81d93ab7-9f6b-4e92-b242-d1436471442f"],
Cell[2511638, 58727, 1519, 38, 2147483647, "Input", "ExpressionUUID" -> \
"87cbceff-4ccf-4f4b-9d52-abd11179778e",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2513194, 58770, 164, 3, 57, "Subsection", "ExpressionUUID" -> \
"20fad786-ba53-4382-8766-81669d55b458"],
Cell[2513361, 58775, 1912, 47, 2147483647, "Input", "ExpressionUUID" -> \
"9789e219-d71a-4f69-8f74-6d5c750cfac4",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2515310, 58827, 156, 3, 57, "Subsection", "ExpressionUUID" -> \
"d4821bfe-4f30-41b2-8faa-a6a1ab606f73"],
Cell[2515469, 58832, 622, 20, 2147483647, "Input", "ExpressionUUID" -> \
"d8e416ee-7fe8-4265-ac93-d1c526d294b6",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2516128, 58857, 159, 3, 57, "Subsection", "ExpressionUUID" -> \
"b06b2894-c3de-4120-be7e-ace147d29047"],
Cell[2516290, 58862, 6678, 154, 2147483647, "Input", "ExpressionUUID" -> \
"3d984982-a3f7-47c7-94c1-91484e6bd588",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2523005, 59021, 225, 4, 57, "Subsection", "ExpressionUUID" -> \
"fdb06b5a-dac0-429c-94c2-ce624e1b132b"],
Cell[2523233, 59027, 405, 10, 2147483647, "Text", "ExpressionUUID" -> \
"05acbb79-f6e3-46c3-b701-34762d5c096b"],
Cell[CellGroupData[{
Cell[2523663, 59041, 209, 4, 2147483647, "Subsubsection", "ExpressionUUID" -> \
"618b7085-a6aa-4765-a5fa-9c4eaf537b5c"],
Cell[2523875, 59047, 3134, 70, 2147483647, "Input", "ExpressionUUID" -> \
"0582509d-b5b2-4297-a8eb-1eaee4279fbc",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2527046, 59122, 248, 6, 2147483647, "Subsubsection", "ExpressionUUID" -> \
"a8b4b74f-3714-4174-9eec-0e59c96c5e81"],
Cell[2527297, 59130, 3424, 78, 2147483647, "Input", "ExpressionUUID" -> \
"fe206cb7-9bb8-48e4-99c2-8d8bb3e031aa",
 InitializationCell->True],
Cell[2530724, 59210, 18748, 399, 2147483647, "Input", "ExpressionUUID" -> \
"4fd334d4-58e0-4f45-86aa-e70953f1f4e3",
 InitializationCell->True],
Cell[2549475, 59611, 2684, 67, 2147483647, "Input", "ExpressionUUID" -> \
"6cd302af-6902-4362-9f60-3a1362d1f280",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2552196, 59683, 315, 7, 2147483647, "Subsubsection", "ExpressionUUID" -> \
"08b8bec9-a6ee-4bcc-af1d-5da8dac215a3"],
Cell[2552514, 59692, 4094, 92, 2147483647, "Input", "ExpressionUUID" -> \
"72e7cb79-9413-43ce-ba44-4df00bbbb4ed",
 InitializationCell->True],
Cell[2556611, 59786, 9000, 213, 2147483647, "Input", "ExpressionUUID" -> \
"aa46ef4c-f0ba-44be-88fa-8f40551c9610",
 InitializationCell->True],
Cell[2565614, 60001, 3640, 91, 2147483647, "Input", "ExpressionUUID" -> \
"6f3cd078-c471-4db5-bf57-afbf9c3f7005",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2569291, 60097, 199, 5, 2147483647, "Subsubsection", "ExpressionUUID" -> \
"b350770d-b5cf-43ad-9035-08fcde07eaa0"],
Cell[2569493, 60104, 1998, 48, 2147483647, "Input", "ExpressionUUID" -> \
"71c13994-5b54-446f-9a67-abbb96b9ca3a",
 InitializationCell->True],
Cell[2571494, 60154, 5246, 132, 2147483647, "Input", "ExpressionUUID" -> \
"4e2bdc33-95c9-4ed4-b362-ae325380d749"]
}, Closed]],
Cell[CellGroupData[{
Cell[2576777, 60291, 249, 4, 2147483647, "Subsubsection", "ExpressionUUID" -> \
"112d9cec-81dd-492e-8a67-e0cafff61e15"],
Cell[2577029, 60297, 1077, 20, 2147483647, "Text", "ExpressionUUID" -> \
"da7ba837-da1a-49f5-a976-45b124c95169"],
Cell[2578109, 60319, 17992, 382, 2147483647, "Input", "ExpressionUUID" -> \
"f89905bf-5492-4dab-9e43-9ad0c8d06a82",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[2596138, 60706, 166, 3, 2147483647, "Subsubsection", "ExpressionUUID" -> \
"18bde9b6-9b86-49ec-a278-896d8d6e2d08"],
Cell[2596307, 60711, 635, 16, 2147483647, "Input", "ExpressionUUID" -> \
"39d1cbe7-83b0-4ba4-afb4-1440b04a9a5e",
 InitializationCell->True]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[2596991, 60733, 166, 3, 57, "Subsection", "ExpressionUUID" -> \
"46b861f1-d871-451c-b719-e533f714604c"],
Cell[2597160, 60738, 152, 3, 2147483647, "Text", "ExpressionUUID" -> \
"87e74abc-2ee7-437b-b64f-2fee047d6c41"],
Cell[2597315, 60743, 2694, 70, 2147483647, "Input", "ExpressionUUID" -> \
"e9082f06-273f-44c1-b008-41273fcbde8a",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2600046, 60818, 162, 3, 38, "Subsection", "ExpressionUUID" -> \
"a49bc2ca-beba-47eb-90aa-5dbf4e3c3136"],
Cell[2600211, 60823, 212, 5, 2147483647, "Text", "ExpressionUUID" -> \
"38a88ea9-3245-48f8-b1c1-b1aabaf9ba32"],
Cell[2600426, 60830, 3896, 94, 2147483647, "Input", "ExpressionUUID" -> \
"37991137-9c0b-4bfc-b3bb-ccd0db678a1e",
 InitializationCell->True],
Cell[2604325, 60926, 216, 4, 2147483647, "Text", "ExpressionUUID" -> \
"b5883383-8666-42b9-b249-c4e3cee6c0aa"],
Cell[2604544, 60932, 5015, 122, 2147483647, "Input", "ExpressionUUID" -> \
"32be1d4e-d326-472f-b371-76b198bea8ae",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2609596, 61059, 209, 4, 38, "Subsection", "ExpressionUUID" -> \
"66b48b2b-212c-4b35-a8ca-ad5dc33e2b4e"],
Cell[2609808, 61065, 204, 4, 2147483647, "Text", "ExpressionUUID" -> \
"ce2c3908-816b-411d-9b33-1b522a5b51cc"],
Cell[2610015, 61071, 1587, 36, 2147483647, "Input", "ExpressionUUID" -> \
"b0c465bb-aedf-4a04-8069-e2b29f3ec6dd",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2611639, 61112, 169, 3, 38, "Subsection", "ExpressionUUID" -> \
"c221036c-69f9-49bd-a05f-8137e17b6034"],
Cell[2611811, 61117, 8476, 199, 2147483647, "Input", "ExpressionUUID" -> \
"e59daf24-c064-4325-aaef-189ec064d682",
 InitializationCell->True],
Cell[2620290, 61318, 4968, 118, 2147483647, "Input", "ExpressionUUID" -> \
"eb00417c-0988-4e10-9b7e-26d104365426",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2625295, 61441, 159, 3, 38, "Subsection", "ExpressionUUID" -> \
"c4f2a242-8b93-4030-8cdc-a57944c05ea2"],
Cell[2625457, 61446, 2148, 53, 2147483647, "Input", "ExpressionUUID" -> \
"2d9bd3e5-5491-40b1-ab76-526ee45057eb",
 InitializationCell->True],
Cell[2627608, 61501, 2233, 55, 2147483647, "Input", "ExpressionUUID" -> \
"c2708343-390e-4dd4-affe-1730e6c1c689",
 InitializationCell->True],
Cell[2629844, 61558, 7472, 162, 2147483647, "Input", "ExpressionUUID" -> \
"cbcce615-1059-42f4-9f77-2921f87c90ef",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2637353, 61725, 207, 4, 38, "Subsection", "ExpressionUUID" -> \
"a392625a-7d0c-4aed-8efd-3080235a560f"],
Cell[2637563, 61731, 2066, 52, 2147483647, "Input", "ExpressionUUID" -> \
"3e7c5d4f-f671-4cbd-b204-0fccf9728fcf",
 InitializationCell->True],
Cell[2639632, 61785, 4268, 94, 2147483647, "Input", "ExpressionUUID" -> \
"d7a38eaa-b083-4982-8a80-8c6506289efe",
 InitializationCell->True],
Cell[2643903, 61881, 1837, 46, 2147483647, "Input", "ExpressionUUID" -> \
"148c7424-d378-427c-9e32-ae02acdbf259",
 InitializationCell->True],
Cell[2645743, 61929, 3053, 67, 2147483647, "Input", "ExpressionUUID" -> \
"cf0bfc69-ca71-427b-a798-f3dca066c312",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2648833, 62001, 168, 3, 38, "Subsection", "ExpressionUUID" -> \
"0addaa07-a96f-4800-a740-6f3f2747b990"],
Cell[2649004, 62006, 3399, 86, 80739, "Input", "ExpressionUUID" -> \
"ddcaf687-ad28-4998-83fe-9683ea7d15e8",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2652440, 62097, 215, 4, 38, "Subsection", "ExpressionUUID" -> \
"d661c30b-cdf3-4324-9e6b-6dd8911932d2"],
Cell[2652658, 62103, 2777, 70, 2147483647, "Input", "ExpressionUUID" -> \
"8a213095-aba6-4588-abb3-60d02dda2c27",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2655472, 62178, 255, 4, 38, "Subsection", "ExpressionUUID" -> \
"09549a3c-caee-4403-b4b1-3be8542525de"],
Cell[2655730, 62184, 1287, 32, 2147483647, "Input", "ExpressionUUID" -> \
"8b4512c8-6c60-4dfb-b265-1c6d8455fc34",
 InitializationCell->True],
Cell[2657020, 62218, 1951, 53, 2147483647, "Input", "ExpressionUUID" -> \
"36e17595-7179-44bd-92fe-e7c281e318f1",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2659008, 62276, 207, 4, 38, "Subsection", "ExpressionUUID" -> \
"dcf547c5-18c1-41a6-82ca-9d9e2a984362"],
Cell[2659218, 62282, 21611, 424, 8515, "Input", "ExpressionUUID" -> \
"0caf0a23-78fd-497a-9ad0-771b23b9c88a",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2680866, 62711, 155, 3, 38, "Subsection", "ExpressionUUID" -> \
"5be24ca4-66fa-4026-afad-93703d4e11a0"],
Cell[2681024, 62716, 9909, 228, 333519, "Input", "ExpressionUUID" -> \
"5391be32-999a-4caa-8836-571e34e9849b",
 InitializationCell->True],
Cell[2690936, 62946, 71, 0, 10158, "Text", "ExpressionUUID" -> \
"3c723230-ff3e-4246-bf6a-8dd900a08303"]
}, Closed]],
Cell[CellGroupData[{
Cell[2691044, 62951, 191, 3, 38, "Subsection", "ExpressionUUID" -> \
"d171ea8f-8fca-4780-98b3-b4421dc7d1fa"],
Cell[2691238, 62956, 1486, 39, 2147483647, "Input", "ExpressionUUID" -> \
"0397d013-b810-4c25-9aee-38ecb21a21b6",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2692761, 63000, 164, 3, 38, "Subsection", "ExpressionUUID" -> \
"993ba7a9-8568-4461-b4ba-643b95123675"],
Cell[2692928, 63005, 27511, 540, 10608, "Input", "ExpressionUUID" -> \
"b03b46dc-2b6a-4473-a0e2-b680f57df9c8",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2720476, 63550, 163, 3, 38, "Subsection", "ExpressionUUID" -> \
"a7727cda-a0c1-4844-b1aa-54faa0b83494"],
Cell[2720642, 63555, 826, 22, 2147483647, "Input", "ExpressionUUID" -> \
"6c5e1355-7c7f-4074-9a6e-127c1ed458a1",
 InitializationCell->True],
Cell[2721471, 63579, 3819, 94, 2147483647, "Input", "ExpressionUUID" -> \
"588530f5-fbf6-4541-ad3d-26386a4f0312",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2725327, 63678, 157, 3, 38, "Subsection", "ExpressionUUID" -> \
"fd3e03cc-8cbb-40f3-a06e-06a842b2eb75"],
Cell[2725487, 63683, 2615, 48, 1710, "Text", "ExpressionUUID" -> \
"fd2edea7-7394-472d-bb16-7b70f98794de"],
Cell[2728105, 63733, 23437, 476, 9213, "Input", "ExpressionUUID" -> \
"001bda4e-1d69-4361-a3c3-1ba637a509fc",
 InitializationCell->True],
Cell[2751545, 64211, 6076, 137, 2866, "Input", "ExpressionUUID" -> \
"a7b9dd70-f8e5-4d0f-8ad2-9914ecc4fbe6",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2757658, 64353, 244, 4, 38, "Subsection", "ExpressionUUID" -> \
"d3d8debf-dcfd-4f7a-ab6b-14860d104169"],
Cell[2757905, 64359, 472, 10, 2147483647, "Text", "ExpressionUUID" -> \
"c6b98b64-40d8-438b-bc66-659bc9bcade4"],
Cell[2758380, 64371, 1326, 32, 2147483647, "Input", "ExpressionUUID" -> \
"a7600502-3bf7-4f65-9128-8fea8d71d294",
 InitializationCell->True],
Cell[2759709, 64405, 15122, 358, 2147483647, "Input", "ExpressionUUID" -> \
"4e2086de-4fcc-4222-8bbc-fb7e4e5858ac",
 InitializationCell->True],
Cell[2774834, 64765, 2126, 47, 2147483647, "Input", "ExpressionUUID" -> \
"546a4e8c-1cc5-475d-983d-a603a7818aa3",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2776997, 64817, 165, 3, 38, "Subsection", "ExpressionUUID" -> \
"74f63b32-4e15-4bc9-8b58-ea4d49be6dae"],
Cell[2777165, 64822, 170, 3, 2147483647, "Text", "ExpressionUUID" -> \
"e4016f36-a532-4cd5-98ec-55ff70c37d2a"],
Cell[2777338, 64827, 3909, 99, 2147483647, "Input", "ExpressionUUID" -> \
"6cd05267-8847-4c3e-9dfe-889bb04f66e1",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2781284, 64931, 238, 4, 38, "Subsection", "ExpressionUUID" -> \
"ad49cc86-019c-4573-aaab-800556ab8782"],
Cell[2781525, 64937, 11358, 242, 2855, "Input", "ExpressionUUID" -> \
"7f158c44-b36a-46d0-82f8-4745364a567c",
 InitializationCell->True],
Cell[2792886, 65181, 1832, 49, 468, "Input", "ExpressionUUID" -> \
"d4ef9766-0bb9-4f1b-bda6-c73ff3909a06",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[2794767, 65236, 215, 4, 63, "Section", "ExpressionUUID" -> \
"a672fdb7-e8d1-4863-b51a-e832f917f613"],
Cell[CellGroupData[{
Cell[2795007, 65244, 157, 3, 43606, "Subsection", "ExpressionUUID" -> \
"609c8f95-191b-40e6-9b3b-ed256520a428"],
Cell[2795167, 65249, 301, 8, 2147483647, "Text", "ExpressionUUID" -> \
"939581a7-dcf1-4995-9b8b-a0dff95d6178"],
Cell[2795471, 65259, 4562, 112, 2147483647, "Input", "ExpressionUUID" -> \
"e8b84e49-6269-4c3b-a733-66c73de58b10",
 InitializationCell->True],
Cell[2800036, 65373, 2220, 58, 2147483647, "Input", "ExpressionUUID" -> \
"53d2a7b5-71f3-4b69-b379-cb2b2aa6b573",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2802293, 65436, 159, 3, 31983, "Subsection", "ExpressionUUID" -> \
"13bb03d3-9c0f-4dd4-a881-2d399c6a1aa7"],
Cell[2802455, 65441, 1119, 27, 1773868, "Text", "ExpressionUUID" -> \
"228a11e6-81ff-4776-9318-fe303f18ec4e"],
Cell[2803577, 65470, 12629, 288, 7747102, "Input", "ExpressionUUID" -> \
"596df995-32ea-4cc2-8958-d5fcb31f87c4",
 InitializationCell->True],
Cell[2816209, 65760, 777, 20, 1199187, "Text", "ExpressionUUID" -> \
"62ee66e9-44fe-4220-bac4-21d0ea4ef90f"],
Cell[2816989, 65782, 8398, 194, 5701551, "Input", "ExpressionUUID" -> \
"fd49c95e-bb3f-40e2-84da-6cd8aa634b40",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2825424, 65981, 157, 3, 31983, "Subsection", "ExpressionUUID" -> \
"b63f629e-982c-4093-9c4c-9b5596c759f9"],
Cell[2825584, 65986, 3904, 95, 2147483647, "Input", "ExpressionUUID" -> \
"76b03700-522d-4969-a732-18acedbf2c38",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2829525, 66086, 159, 3, 31983, "Subsection", "ExpressionUUID" -> \
"2c5fd6f5-2a9e-4bea-b32c-4e0e4f26f0bb"],
Cell[2829687, 66091, 8378, 190, 2147483647, "Input", "ExpressionUUID" -> \
"ef5e4fea-6d28-40cb-9066-1979819005c0",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2838102, 66286, 159, 3, 31983, "Subsection", "ExpressionUUID" -> \
"5bfa5574-be07-4c5b-b26b-599129724ea1"],
Cell[2838264, 66291, 7315, 182, 2147483647, "Input", "ExpressionUUID" -> \
"6e706afa-dc51-4117-b060-8d9fc31c2cb1",
 InitializationCell->True],
Cell[2845582, 66475, 7534, 186, 2147483647, "Input", "ExpressionUUID" -> \
"088763a2-ab4a-4e0f-9976-dab6f4067b2b",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[2853165, 66667, 211, 4, 63, "Section", "ExpressionUUID" -> \
"bdceb57b-1c71-40cc-ae22-879637722b6b"],
Cell[2853379, 66673, 181, 3, 2147483647, "Text", "ExpressionUUID" -> \
"6f27a684-4840-4ffe-9380-ed1cb0e35eaa"],
Cell[2853563, 66678, 4140, 88, 2147483647, "Input", "ExpressionUUID" -> \
"bff88457-0794-4d67-87d9-0c7d28b2b4a3",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[2857752, 66772, 149, 3, 33, "Subtitle", "ExpressionUUID" -> \
"c7f9697f-38a9-428c-ac28-8a7e4345785f"],
Cell[CellGroupData[{
Cell[2857926, 66779, 4112, 82, 685, "Input", "ExpressionUUID" -> \
"c89b4cfb-3443-4fbe-b8e9-8e337964b35e",
 InitializationCell->True],
Cell[2862041, 66863, 2008, 53, 717, "Print", "ExpressionUUID" -> \
"6a019fe2-9662-4239-bac2-78f4f8287920"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

